<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Some notes on lattices, automorphic forms, constant term approximations</title>
  <link rel="stylesheet" href="tex.css">
  <style>
      .my-links-container {
        position: absolute;
        top: 0;
        right: 0;
        padding-right: 20px;
        padding-top: 10px;
      }
      .my-link {
        margin-left: 10px;
      }
      .my-links-container-2 { /* new CSS class for the second row */
        position: absolute;
        top: 40px; /* adjust this value based on the height of your links */
        right: 0;
        padding-right: 20px;
      }
      .my-link-2 {
        margin-left: 10px;
      }

    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    div.abstract {
      margin: 2em 2em 2em 2em;
      text-align: left;
      font-size: 85%;
    }
    div.abstract-title {
      font-weight: bold;
      text-align: center;
      padding: 0;
      margin-bottom: 0.5em;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
    <div class="my-links-container">
2024-03-11 18:04:42
      <a href="20240311T164944--notes-on-lattices-automorphic-forms-constant-terms__course.tex" class="my-link">tex</a>
      <a href="20240311T164944--notes-on-lattices-automorphic-forms-constant-terms__course.pdf" class="my-link">pdf</a>
      <a href="https://github.com/ultronozm/math/commits/main/20240311T164944--notes-on-lattices-automorphic-forms-constant-terms__course.tex" class="my-link">history</a>
      <a href="." class="my-link">home</a>
    </div>
<header id="title-block-header">
<h1 class="title">Some notes on lattices, automorphic forms, constant
term approximations</h1>
<div class="abstract">
<div class="abstract-title">Abstract</div>
<p>Notes for parts of a course on the spectral theory of Eisenstein
series for <span class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span>,
taught at ETH Z<span>ü</span>rich in Spring 2021.</p>
</div>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#sec:orga2c9264" id="toc-sec:orga2c9264">Introduction and
motivation</a>
<ul>
<li><a href="#sec:org93d6839" id="toc-sec:org93d6839">The space of
lattices</a></li>
</ul></li>
<li><a href="#sec:org5af6785" id="toc-sec:org5af6785">Basics on the
space of lattices</a>
<ul>
<li><a href="#sec:" id="toc-sec:">References</a></li>
<li><a href="#sec:" id="toc-sec:">Module-theoretic
preliminaries</a></li>
<li><a href="#sec:org729f490" id="toc-sec:org729f490">The
two-dimensional case</a></li>
<li><a href="#sec:org485b167" id="toc-sec:org485b167">Iwasawa
decomposition</a></li>
<li><a href="#sec:org0d39d27" id="toc-sec:org0d39d27">Reduced bases and
Siegel domains</a></li>
<li><a href="#sec:org2326c58" id="toc-sec:org2326c58">Haar
measure</a></li>
<li><a href="#sec:finiteness-volume"
id="toc-sec:finiteness-volume">Finiteness of the volume</a></li>
<li><a href="#sec:orge0ceafc" id="toc-sec:orge0ceafc">How many vectors
does a random lattice have in a given region?</a></li>
<li><a href="#sec:conv-eisenst-seri"
id="toc-sec:conv-eisenst-seri">Convergence of Eisenstein series</a>
<ul>
<li><a href="#statement-of-result"
id="toc-statement-of-result">Statement of result</a></li>
<li><a href="#sec:recap-finite-dimens"
id="toc-sec:recap-finite-dimens">Recap on the finite-dimensional
representation theory of <span
class="math inline">\({\mathop{\mathrm{SL}}}_n\)</span></a></li>
<li><a href="#geometric-lemmas" id="toc-geometric-lemmas">Geometric
lemmas</a></li>
<li><a href="#proof-of-theorem-thm2"
id="toc-proof-of-theorem-thm2">Proof of Theorem 21</a></li>
</ul></li>
</ul></li>
<li><a href="#basics-on-automorphic-forms"
id="toc-basics-on-automorphic-forms">Basics on automorphic forms</a>
<ul>
<li><a href="#motivation" id="toc-motivation">Motivation</a></li>
<li><a href="#sec:defin-with-expl"
id="toc-sec:defin-with-expl">Definition without explanation</a></li>
<li><a href="#norms-on-g" id="toc-norms-on-g">Norms on <span
class="math inline">\(G\)</span></a></li>
<li><a href="#sec:funct-moder-growth"
id="toc-sec:funct-moder-growth">Functions of moderate growth</a></li>
<li><a href="#finite-functions" id="toc-finite-functions">Finite
functions</a>
<ul>
<li><a href="#generalities" id="toc-generalities">Generalities</a></li>
<li><a href="#sec:isotyp-decomp" id="toc-sec:isotyp-decomp">Isotypic
decomposition</a></li>
</ul></li>
<li><a href="#sec:univ-envel-algebra"
id="toc-sec:univ-envel-algebra">Universal enveloping algebra</a>
<ul>
<li><a href="#sec:gener-defin-constr"
id="toc-sec:gener-defin-constr">General definition and
construction</a></li>
<li><a href="#sec:construction-via-lie"
id="toc-sec:construction-via-lie">Construction via Lie theory</a></li>
<li><a href="#the-center" id="toc-the-center">The center</a></li>
</ul></li>
<li><a href="#sec:Z-g-finiteness"
id="toc-sec:Z-g-finiteness">Finiteness</a></li>
<li><a href="#sec:relat-class-modul"
id="toc-sec:relat-class-modul">Relation to classical modular
forms</a></li>
<li><a href="#some-basic-properties" id="toc-some-basic-properties">Some
basic properties</a></li>
</ul></li>
<li><a href="#constant-terms" id="toc-constant-terms">Constant terms</a>
<ul>
<li><a href="#sec:reduction-from-gl_n"
id="toc-sec:reduction-from-gl_n">Reduction from <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> to <span
class="math inline">\({\mathop{\mathrm{SL}}}_n\)</span></a></li>
<li><a href="#sec:stand-parab-subgr"
id="toc-sec:stand-parab-subgr">Standard parabolic subgroups</a></li>
<li><a href="#sec:appr-const-terms"
id="toc-sec:appr-const-terms">Approximation by constant terms</a>
<ul>
<li><a href="#sec:approx-const-terms-informal-discussion"
id="toc-sec:approx-const-terms-informal-discussion">Informal
discussion</a></li>
<li><a href="#rigorous-formulation"
id="toc-rigorous-formulation">Rigorous formulation</a></li>
<li><a href="#sec:proof-when-n=2" id="toc-sec:proof-when-n=2">Proof when
<span class="math inline">\(n=2\)</span></a></li>
<li><a href="#the-general-argument" id="toc-the-general-argument">The
general argument</a></li>
</ul></li>
<li><a href="#properties-of-the-constant-term"
id="toc-properties-of-the-constant-term">Properties of the constant
term</a></li>
<li><a href="#eisenstein-series-defined-via-series"
id="toc-eisenstein-series-defined-via-series">Eisenstein series defined
via series</a></li>
<li><a href="#cuspidal-functions" id="toc-cuspidal-functions">Cuspidal
functions</a></li>
</ul></li>
<li><a href="#some-further-facts" id="toc-some-further-facts">Some
further facts</a>
<ul>
<li><a href="#finiteness-theorems"
id="toc-finiteness-theorems">Finiteness theorems</a></li>
<li><a
href="#convolution-operators-and-decomposition-of-the-space-of-cusp-forms"
id="toc-convolution-operators-and-decomposition-of-the-space-of-cusp-forms">Convolution
operators and decomposition of the space of cusp forms</a></li>
</ul></li>
</ul>
</nav>
<h1 id="sec:orga2c9264">§1. Introduction and motivation</h1>
<h2 id="sec:org93d6839">§1.1. The space of lattices</h2>
<div class="definition">
<p><strong>Definition 1</strong>. A <em>lattice</em> <span
class="math inline">\(L \subseteq \mathbb{R}^n\)</span> is a subgroup of
the form <span class="math inline">\(L = \oplus_{i=1}^n \mathbb{Z}
v_i\)</span> for some basis <span
class="math inline">\(v_1,\dotsc,v_n\)</span> of <span
class="math inline">\(\mathbb{R}^n\)</span>.</p>
</div>
<p>For example, there is the standard lattice <span
class="math inline">\(\mathbb{Z}^n \subseteq \mathbb{R}^n\)</span>
generated by the standard basis elements <span
class="math inline">\(e_1,\dotsc,e_n\)</span>.</p>
<p>We denote by <span class="math inline">\(X_n\)</span> the space of
lattices in <span class="math inline">\(\mathbb{R}^n\)</span>.</p>
<p>We regard <span class="math inline">\(\mathbb{R}^n\)</span> as a
space of row vectors. The group <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span> acts
on <span class="math inline">\(\mathbb{R}^n\)</span> by right matrix
multiplication: <span class="math inline">\((v,g) \mapsto v g\)</span>.
This induces an action on the space <span
class="math inline">\(X_n\)</span> of lattices. The stabilizer of the
standard lattice <span class="math inline">\(\mathbb{Z}^n\)</span> is
the group <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z})\)</span>, so we
may identify <span class="math display">\[X_n =
{\mathop{\mathrm{GL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\]</span> <span
class="math display">\[\mathbb{Z}^n g \leftrightarrow
{\mathop{\mathrm{GL}}}_n(\mathbb{Z}) g.\]</span></p>
<p>We equip <span class="math inline">\(X_n\)</span> with the quotient
topology coming from the surjective map <span
class="math inline">\((v_1,\dotsc,v_n) \mapsto X_n\)</span> sending an
ordered basis for <span class="math inline">\(\mathbb{R}^n\)</span> to
the lattice it generates, or equivalently, with the quotient topology
coming from the surjective map <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R}) \rightarrow
{\mathop{\mathrm{GL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. Thus a sequence <span
class="math inline">\(\mathcal{L}^{(j)}\)</span> of lattices converge to
<span class="math inline">\(\mathcal{L}\)</span> if there are bases
<span class="math inline">\(v_1^{(j)}, \dotsc, v_n^{(j)}\)</span> of
<span class="math inline">\(\mathcal{L}^{(j)}\)</span> and <span
class="math inline">\(v_1,\dotsc,v_n\)</span> of <span
class="math inline">\(\mathcal{L}\)</span> so that <span
class="math inline">\(v_i^{(j)} \rightarrow v_i\)</span>.</p>
<div class="definition">
<p><strong>Definition 2</strong>. We say that a lattice <span
class="math inline">\(L \in X_n\)</span> is <em>unimodular</em> if <span
class="math inline">\(\mathop{\mathrm{vol}}(\mathbb{R}^n/L) =
1\)</span>.</p>
</div>
<p>We denote by <span class="math inline">\(X_n^{(1)} \subseteq
X_n\)</span> the space of unimodular lattices. A lattice <span
class="math inline">\(L\)</span> is unimodular if and only if it may be
written <span class="math inline">\(L = \mathbb{Z}^n g\)</span> for some
<span class="math inline">\(g \in
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>. Thus we may identify <span
class="math display">\[X_n^{(1)} = {\mathop{\mathrm{SL}}}_n(\mathbb{Z})
\backslash {\mathop{\mathrm{SL}}}_n(\mathbb{R}).\]</span></p>
<p>The group <span class="math inline">\(\mathbb{R}^\times\)</span> acts
on the space of lattices by scaling. Scaling a lattice by <span
class="math inline">\(t\)</span> multiplies the volume by <span
class="math inline">\(|t|^{n}\)</span>. We may thus identify <span
class="math display">\[X_n / \mathbb{R}^\times \cong X_n^{(1)}.\]</span>
Here the LHS consists of scaling classes of lattices, while the RHS
consists of unimodular lattices; the bijection assigns to each scaling
class the unique unimodular representative.</p>
<p>One advantage of working with the space <span
class="math inline">\(X_n^{(1)}\)</span> of unimodular lattices rather
than the larger space <span class="math inline">\(X_n\)</span> of all
lattices is that <span class="math inline">\(X_n^{(1)}\)</span> admits a
(unique) <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>-invariant
probability measure. (We will verify this fact soon.) We may thus
meaningfully speak of a “random unimodular lattice.”</p>
<p>Many problems in number theory, Diophantine analysis, <span
class="math inline">\(\dotsc\)</span> may be recast in terms of the
space of lattices. We record a typical example:</p>
<div class="example">
<p><strong>Example 3</strong>. The <em>Littlewood conjecture</em>
asserts that for all real numbers <span
class="math inline">\(\alpha\)</span> and <span
class="math inline">\(\beta\)</span>, <span
class="math display">\[\liminf _{n \rightarrow \infty } n \|n \alpha \|
\|n \beta \| = 0,\]</span> where <span
class="math inline">\(\|x\|\)</span> denotes the distance from <span
class="math inline">\(x\)</span> to the closest integer.</p>
<p>Let <span class="math inline">\(A \leq
{\mathop{\mathrm{SL}}}_3(\mathbb{R})\)</span> denote the diagonal
subgroup. It is known that the Littlewood conjecture would follow from
the following conjectural implication concerning lattices <span
class="math inline">\(L \in X_3^{(1)}\)</span>: if the orbit <span
class="math inline">\(L A \subseteq X_3^{(1)}\)</span> is precompact,
then that orbit is closed.</p>
<p>The basic idea underlying the the relationship between these two
statements is that <span class="math inline">\(n \|n \alpha \| \|n \beta
\|\)</span> is the smallest number of the form <span
class="math inline">\(n (n \alpha + m ) (n \beta + \ell)\)</span>. Such
numbers are values taken by the trilinear form <span
class="math inline">\((x,y,z) \mapsto x y z\)</span> on the lattice
<span class="math inline">\(L_{\alpha \beta }\)</span> generated by
<span class="math inline">\((1,0,0), (\alpha, 1, 0), (\beta, 0,
1)\)</span>. The group <span class="math inline">\(A\)</span> stabilizes
that trilinear form.</p>
</div>
<h1 id="sec:org5af6785">§2. Basics on the space of lattices</h1>
<p>We continue to regard <span
class="math inline">\(\mathbb{R}^n\)</span> as a space of row
vectors.</p>
<h2 class="unnumbered" id="sec:">References</h2>
<p>Some expositions are Borel <a href="#ref-MR3970984" class="citation"
data-cites="MR3970984">(Borel 2019)</a>, Morris <a href="#ref-MR3307755"
class="citation" data-cites="MR3307755">(Morris 2015)</a>, and
Platonov–Rapinchuk <a href="#ref-MR1278263" class="citation"
data-cites="MR1278263">(Platonov and Rapinchuk 1994)</a>, while
historical references include Siegel <a href="#ref-MR3003" class="citation"
data-cites="MR3003">(Siegel 1940)</a> and Borel–Harish-Chandra <a href="#ref-MR141670 MR147566"
class="citation" data-cites="MR141670 MR147566">(Borel and
Harish-Chandra 1961, 1962)</a>.</p>
<h2 id="sec:">§2.1. Module-theoretic preliminaries</h2>
<p>(Not presented in lecture.) Here we summarize some standard facts
from abstract algebra and their consequences, to be used implicitly in
what follows. (The proofs, omitted here, boil down to the fact that any
<span class="math inline">\(n\)</span>-tuple <span
class="math inline">\((a_1,\dotsc,a_n)\in \mathbb{Z}^n\)</span> of
integers with relatively prime entries extends to a basis of <span
class="math inline">\(\mathbb{Z}^n\)</span>, or equivalently, arises as
the top row of some element of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z})\)</span>. The
proof of the latter fact is a good exercise.)</p>
<p>First, the standard facts, which hold more generally with <span
class="math inline">\(\mathbb{Z}\)</span> replaced by any principal
ideal domain:</p>
<div class="theorem">
<p><strong>Theorem 4</strong>. <em>A submodule <span
class="math inline">\(M\)</span> of a free <span
class="math inline">\(\mathbb{Z}\)</span>-module <span
class="math inline">\(L\)</span> is free, with the rank of <span
class="math inline">\(M\)</span> at most that of <span
class="math inline">\(L\)</span>.</em></p>
</div>
<div id="thm:torsion-free-implies-free" class="theorem">
<p><strong>Theorem 5</strong>. <em>A finitely-generated torsion-free
<span class="math inline">\(\mathbb{Z}\)</span>-module is free.</em></p>
</div>
<p>Next, the consequences. Let <span class="math inline">\(L\)</span> be
a finitely-generated free <span
class="math inline">\(\mathbb{Z}\)</span>-module.</p>
<div id="defn:" class="definition">
<p><strong>Definition 6</strong>. A submodule <span
class="math inline">\(M\)</span> of <span
class="math inline">\(L\)</span> is called <em>primitive</em> if <span
class="math inline">\(\mathbb{Q} M \cap L = \mathbb{Z} M\)</span>; here
<span class="math inline">\(\mathbb{Q} M\)</span> and <span
class="math inline">\(\mathbb{Z} M\)</span> denote the respective spans
under <span class="math inline">\(\mathbb{Q}\)</span> and <span
class="math inline">\(\mathbb{Z}\)</span> of <span
class="math inline">\(M\)</span> inside <span class="math inline">\(L
\otimes_{\mathbb{Z}} \mathbb{Q}\)</span>. A vector <span
class="math inline">\(v \in L\)</span> is called <em>primitive</em> if
it generates a primitive submodule, or equivalently, if <span
class="math inline">\(\mathbb{Q} v \cap L = \mathbb{Z} v\)</span>.</p>
</div>
<div class="lemma">
<p><strong>Lemma 7</strong>. The following are equivalent for a
submodule <span class="math inline">\(M \subseteq L\)</span>:</p>
<ol type="i">
<li><p><span class="math inline">\(M\)</span> is primitive.</p></li>
<li><p><span class="math inline">\(L/M\)</span> is
torsion-free.</p></li>
<li><p><span class="math inline">\(L/M\)</span> is free.</p></li>
<li><p><span class="math inline">\(M\)</span> admits a complement, i.e.,
a submodule <span class="math inline">\(M&#39;\)</span> of <span
class="math inline">\(L\)</span> for which <span class="math inline">\(L
= M \oplus M&#39;\)</span>.</p></li>
</ol>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> The equivalence of (i) and (ii) follows readily from
the definition, while that of (ii) and (iii) follows from Theorem <a
href="#thm:torsion-free-implies-free" data-reference-type="ref"
data-reference="thm:torsion-free-implies-free">5</a>. (iv) implies (iii)
because <span class="math inline">\(M&#39;\)</span> is free, while (iii)
implies (iv) because the lift to <span class="math inline">\(L\)</span>
of any basis for <span class="math inline">\(L/M\)</span> generates the
required complement. ◻</p>
</span></div>
<p>In particular, we may construct a basis for <span
class="math inline">\(L\)</span> by iterated application of the lemma,
as follows. We inductively construct <span
class="math inline">\(v_1,\dotsc,v_n\)</span> so that for each <span
class="math inline">\(k \in \{1, \dotsc, n\}\)</span>, the module <span
class="math inline">\(\langle v_1,\dotsc,v_k \rangle\)</span> is
primitive. First, we choose any primitive vector <span
class="math inline">\(v_1 \in L\)</span>. Clearly <span
class="math inline">\(\langle v_1 \rangle\)</span> is primitive. For
<span class="math inline">\(k \geq 2\)</span>, we choose any <span
class="math inline">\(v_k \in L\)</span> whose image in the free module
<span class="math inline">\(L / \langle v_1,\dotsc, v_{k-1}
\rangle\)</span> is primitive. By induction on <span
class="math inline">\(k\)</span>, we see that <span
class="math inline">\(\langle v_1, \dotsc, v_k \rangle\)</span> is
primitive. The construction stops at <span
class="math inline">\(k=n\)</span> with <span
class="math inline">\(\langle v_1, \dotsc, v_n \rangle = L\)</span>.</p>
<div class="exercise">
<p><strong>Exercise 1</strong>. Let <span
class="math inline">\(M\)</span> be a submodule of <span
class="math inline">\(L\)</span>. Write <span
class="math inline">\(m\)</span> and <span
class="math inline">\(n\)</span> for the respective ranks of <span
class="math inline">\(M\)</span> and <span
class="math inline">\(L\)</span>. Choose a basis of <span
class="math inline">\(L\)</span>, so that we may identify <span
class="math inline">\(L\)</span> with <span
class="math inline">\(\mathbb{Z}^n\)</span> and speak of coordinates.
Let <span class="math inline">\(v_1,\dotsc,v_m \in \mathbb{Z}^n\)</span>
be a basis of <span class="math inline">\(M\)</span>. Let <span
class="math inline">\(A\)</span> denote the <span
class="math inline">\(m \times n\)</span> matrix with rows <span
class="math inline">\(v_1,\dotsc,v_m\)</span>. Show that <span
class="math inline">\(M\)</span> is primitive if and only if the
greatest common divisors of the maximal minors of <span
class="math inline">\(A\)</span> is one.</p>
</div>
<h2 id="sec:org729f490">§2.2. The two-dimensional case</h2>
<p>Let <span class="math inline">\(\mathcal{L} \subseteq
\mathbb{R}^2\)</span> be a lattice. Choose a nonzero lattice vector
<span class="math inline">\(v_2\)</span> of minimal length. By rotating
and scaling the lattice, we may assume that <span
class="math inline">\(v_2 = (1,0)\)</span> and that all other vectors
have length <span class="math inline">\(\geq 1\)</span>. Note that <span
class="math inline">\(v_2\)</span> is primitive, i.e., <span
class="math inline">\(\mathcal{L} \cap \mathbb{R} v_2 = \mathbb{Z}
v_2\)</span>, as we would otherwise have <span
class="math inline">\(v_2/N \in \mathcal{L}\)</span>, contrary to the
minimality of the length of <span class="math inline">\(v_2\)</span>.
Choose a vector <span class="math inline">\(v_1 \in \mathcal{L} -
\mathbb{Z} v_1\)</span> of shortest length. Write <span
class="math inline">\(v_1 = (x,y)\)</span>. By replacing <span
class="math inline">\(v_1\)</span> with its negative, we may assume that
<span class="math inline">\(y &gt; 0\)</span>. Then <span
class="math inline">\(\|v_1\| \geq 1\)</span>. Also, <span
class="math inline">\(-1/2 \leq x \leq 1/2\)</span>, as otherwise we
could translate <span class="math inline">\(v_1\)</span> by a multiple
of <span class="math inline">\(v_2\)</span> to produce a shorter
vector.</p>
<p>Thus we may classify lattices in <span
class="math inline">\(\mathbb{R}^2\)</span> up to scaling and rotation
by points <span class="math inline">\((x,y)\)</span> with <span
class="math inline">\(y &gt; 0\)</span>, <span
class="math inline">\(-1/2 \leq x \leq 1/2\)</span> and <span
class="math inline">\(x^2 + y^2 \geq 1\)</span>. (There is some mild
ambiguity in this description when <span
class="math inline">\((x,y)\)</span> lies on the “boundary.”) We obtain
the picture of the standard fundamental domain of the modular group
<span
class="math inline">\({\mathop{\mathrm{SL}}}_2(\mathbb{Z})\)</span>.</p>
<h2 id="sec:org485b167">§2.3. Iwasawa decomposition</h2>
<p>Let <span class="math inline">\(v_1,\dotsc, v_n\)</span> be a basis
for <span class="math inline">\(\mathbb{R}^n\)</span>. There is a unique
<em>orthogonal</em> basis <span class="math inline">\(v_1&#39;, \dotsc,
v_n&#39;\)</span> so that <span class="math display">\[v_i = v_i&#39; +
\sum_{j &lt; i} x_{i j} v_j&#39;\]</span> for some scalars <span
class="math inline">\(x_{i j}\)</span>. Indeed, we are forced to take
for <span class="math inline">\(v_m&#39;\)</span> the orthogonal
projection of <span class="math inline">\(v_m\)</span> onto <span
class="math inline">\(\langle v_{m+1},\dotsc, v_n
\rangle^\perp\)</span>, which may be constructed explicitly using the
Gram–Schmidt procedure. Said another way, one has the matrix identity
<span class="math display">\[\begin{pmatrix}
    v_1  \\
    v_2  \\
    \dotsb  \\
    v_{n-1} \\
    v_n
  \end{pmatrix}
  =
  \begin{pmatrix}
    1 &amp; x_{12} &amp; x_{1 3} &amp; \dotsb &amp; x_{1, n} \\
      &amp; 1 &amp; x_{23}  &amp; \ddots &amp; \vdots \\
      &amp;  &amp; \ddots &amp; x_{n-2,n-1} &amp; x_{n-2,n} \\
      &amp;  &amp;  &amp; 1 &amp; x_{n-1, n}\\
      &amp; &amp; &amp; &amp; 1
  \end{pmatrix}
  \begin{pmatrix}
    v_1&#39;  \\
    v_2&#39;  \\
    \dotsb  \\
    v_{n-1}&#39;  \\
    v _n &#39;
  \end{pmatrix}\]</span> where each entry <span
class="math inline">\(x_{i j}\)</span> is uniquely determined.</p>
<p>Set <span class="math inline">\(a_j := |v_j&#39;| &gt; 0\)</span>, so
that <span class="math inline">\(v_j&#39; = a_j v_j&#39;&#39;\)</span>
where <span class="math inline">\(v_j&#39;&#39;\)</span> is a unit
vector. Then we have the matrix identity <span
class="math display">\[\begin{pmatrix}
    v_1  \\
    v_2  \\
    \dotsb  \\
    v_{n-1} \\
    v_n
  \end{pmatrix}
  =
  \begin{pmatrix}
    1 &amp; x_{12} &amp; x_{1 3} &amp; \dotsb &amp; x_{1, n} \\
      &amp; 1 &amp; x_{23}  &amp; \ddots &amp; \vdots \\
      &amp;  &amp; \ddots &amp; x_{n-2,n-1} &amp; x_{n-2,n} \\
      &amp;  &amp;  &amp; 1 &amp; x_{n-1, n}\\
      &amp; &amp; &amp; &amp; 1
  \end{pmatrix}
  \begin{pmatrix}
    a_1 &amp;  &amp;  &amp;  &amp;  \\
        &amp; a_2 &amp;  &amp;  &amp;  \\
        &amp;  &amp;   \ddots &amp; &amp; \\
        &amp;  &amp;  &amp; a_{n-1} &amp;  \\
        &amp; &amp; &amp; &amp; a_n
  \end{pmatrix}
  \begin{pmatrix}
    v_1&#39;&#39;  \\
    v_2&#39;&#39;  \\
    \dotsb  \\
    v_{n-1}&#39;&#39;  \\
    v _n &#39;&#39;
  \end{pmatrix}
  .\]</span> The rows of the rightmost matrix are orthogonal, and so
that matrix lies in the orthogonal group <span
class="math inline">\(\operatorname{O}(n)\)</span>.</p>
<p>This way of describing a basis may be interpreted
group-theoretically. Ordered bases as above correspond to elements of
<span class="math inline">\(G := {\mathop{\mathrm{GL}}}_n (\mathbb{R}
)\)</span>, with <span class="math inline">\((v_1,\dotsc,v_n)\)</span>
corresponding to the element <span class="math inline">\(g\)</span>
having <span class="math inline">\(j\)</span>th row <span
class="math inline">\(v_j\)</span>, or equivalently, for which <span
class="math inline">\(e_j g = v_j\)</span>. Denote by <span
class="math inline">\(N\)</span> the group of strictly upper-triangular
matrices, <span class="math inline">\(A^+\)</span> the group of diagonal
matrices with positive entries, and <span class="math inline">\(K =
\operatorname{O}(n)\)</span>. Then every <span class="math inline">\(g
\in G\)</span> may be written uniquely as <span class="math inline">\(g
= x a k\)</span> with <span class="math inline">\(x \in N, a \in A^+, k
\in K\)</span>. Symbolically, <span class="math inline">\(G = N A^+
K\)</span>, and the map <span class="math inline">\(N \times A^+ \times
K \rightarrow G\)</span> is a diffeomorphism. This is known as the
<em>Iwasawa decomposition</em>.</p>
<h2 id="sec:org0d39d27">§2.4. Reduced bases and Siegel domains</h2>
<p>Let <span class="math inline">\(L \subseteq \mathbb{R}^n\)</span> be
a lattice. Then <span class="math inline">\({L}\)</span> admits many
different ordered bases.</p>
<div class="definition">
<p><strong>Definition 8</strong>. We call an ordered basis <span
class="math inline">\(v_1,\dotsc,v_n\)</span> of <span
class="math inline">\(\mathbb{R}^n\)</span> <em>reduced</em> if, in
Iwasawa coordinates as above,</p>
<ul>
<li><p><span class="math inline">\(|x_{i j}| \leq 1/2\)</span> for <span
class="math inline">\(1 \leq i &lt; j \leq n\)</span>, and</p></li>
<li><p><span class="math inline">\(a_{j} / a_{j+1} \geq
\sqrt{3}/2\)</span> for <span class="math inline">\(1 \leq j &lt;
n\)</span>.</p></li>
</ul>
</div>
<p>What matters in this definition is that <span
class="math inline">\(1/2 &lt; \infty\)</span> and <span
class="math inline">\(\sqrt{3}/2 &gt; 0\)</span> are fixed; the precise
numerical values will not be of much significance for us.</p>
<p>We summarize some of the basic facts concerning reduced bases of
lattices, due to Minkowski and Siegel. In what follows the notation
<span class="math inline">\(A \ll B\)</span> signifies that <span
class="math inline">\(|A| \leq C |B|\)</span> where <span
class="math inline">\(C\)</span> depends only upon <span
class="math inline">\(n\)</span>, while <span class="math inline">\(A
\asymp B\)</span> means that <span class="math inline">\(A \ll B \ll
A\)</span>.</p>
<div id="item:siegel-finitely-many-gamma" class="theorem">
<p><strong>Theorem 9</strong>. <em><span
id="thm:existence-reduced-basis"
label="thm:existence-reduced-basis"></span> Let <span
class="math inline">\(L \subseteq \mathbb{R}^n\)</span> be a
lattice.</em></p>
<ol type="i">
<li><p><em>There is at least one reduced basis.</em></p></li>
<li><p><em>Let <span class="math inline">\(v_1,\dotsc,v_n\)</span> be
any reduced basis, with accompanying notation as above. Let <span
class="math inline">\(T\)</span> be the linear transformation sending
<span class="math inline">\(v_i&#39;\)</span> to <span
class="math inline">\(v_i\)</span>. Then <span
class="math inline">\(T\)</span> and its inverse have operator norm
<span class="math inline">\(\ll 1\)</span>; equivalently, for all <span
class="math inline">\(c = (c_1,\dotsc,c_n) \in \mathbb{R}^n\)</span>, we
have <span id="eqn:reduced-basis-approx-orth" class="math display">\[\label{eqn:reduced-basis-approx-orth}\tag{1}
      \|\sum c_i v_i\| \asymp
      \|\sum c_i v_i&#39;\|
      \asymp \max_{1 \leq i \leq n} a_i |c_i|.\]</span> In particular,
<span class="math inline">\(|v_i| \asymp |v_i&#39;| =
a_i\)</span>.</em></p></li>
<li><p><em>If <span class="math inline">\(v_1,\dotsc,v_n\)</span> and
<span class="math inline">\(w_1,\dotsc,w_n\)</span> are two reduced
bases, then <span class="math inline">\(|v_i&#39;| \asymp
|w_i&#39;|\)</span>. Thus the Iwasawa coordinates <span
class="math inline">\(a_i\)</span> of a lattice are “well-defined up to
constants depending only upon <span
class="math inline">\(n\)</span>.”</em></p></li>
<li><p><em>Let <span class="math inline">\(C \geq 1\)</span> be large
enough in terms of <span class="math inline">\(n\)</span>. Suppose that
<span class="math inline">\(v_1,\dotsc,v_n\)</span> is a reduced basis.
Let <span class="math inline">\(i \in \{1, \dotsc, n-1\}\)</span>.
Suppose that <span class="math display">\[a_i / a_{i+1} &gt; C.\]</span>
Then the <span class="math inline">\(\mathbb{Z}\)</span>-module <span
class="math display">\[\langle v_{i+1},\dotsc,v_n \rangle\]</span>
depends only upon <span class="math inline">\(L\)</span>, not upon the
choice of reduced basis.</em></p></li>
<li><p><em>Let <span class="math inline">\(v_1,\dotsc,v_n\)</span> and
<span class="math inline">\(w_1,\dotsc,w_n\)</span> be reduced bases of
the same lattice. Let <span class="math inline">\(\gamma \in
{\mathop{\mathrm{GL}}}_n(\mathbb{Z})\)</span> be the change of basis
matrix relating the two bases, thus <span class="math display">\[w_i =
\sum_{j} \gamma_{i j} v_j.\]</span> Then each entry <span
class="math inline">\(\gamma_{i j}\)</span> is <span
class="math inline">\(\ll 1\)</span>.</em></p></li>
</ol>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> <span><strong>We start with part
(i).</strong></span></p>
<p>Let <span class="math inline">\(v_n \in \mathcal{L}\)</span> be a
shortest vector (i.e., a nonzero vector of minimal length). Such a
vector exists in view of the discreteness of <span
class="math inline">\(\mathcal{L}\)</span>, and is necessarily
primitive. By definition, <span class="math inline">\(v_n&#39; =
v_n\)</span>.</p>
<p>Let <span class="math inline">\(\mathcal{L}_{n-1}\)</span> denote the
image of <span class="math inline">\(\mathcal{L}\)</span> under
orthogonal projection to <span class="math inline">\(v_n^\perp\)</span>;
it is a lattice of rank <span class="math inline">\(n-1\)</span>. Let
<span class="math inline">\(v_{n-1}&#39; \in \mathcal{L}_{n-1}\)</span>
be a shortest vector (which exists, as <span
class="math inline">\(\mathcal{L}_{n-1}\)</span> is again discrete).
Lift it to a vector <span class="math inline">\(v_{n-1} \in
\mathcal{L}\)</span> of shortest length. This lift is primitive. (The
superscripted “prime” notation is consistent: by construction, <span
class="math inline">\(v_{n-1}&#39;\)</span> is the orthogonal projection
of <span class="math inline">\(v_{n-1}\)</span> to <span
class="math inline">\(\langle v_n \rangle^\perp\)</span>.) By the <span
class="math inline">\(n=2\)</span> discussion, we have <span
class="math inline">\(|v_{n-1}&#39;| \geq \frac{\sqrt{3}}{2}
|v_n&#39;|\)</span>.</p>
<p>Next, let <span class="math inline">\(\mathcal{L}_{n-2}\)</span>
denote the orthogonal projection of <span
class="math inline">\(\mathcal{L}\)</span> to <span
class="math inline">\(\langle v_{n-1}, v_n \rangle^\perp\)</span>, let
<span class="math inline">\(v_{n-2}&#39; \in \mathcal{L}_{n-2}\)</span>
be a shortest vector, and let <span class="math inline">\(v_{n-2} \in
\mathcal{L}\)</span> be any lift (necessarily primitive). Then <span
class="math display">\[v_{n-2} = v_{n-2}&#39; + a v_{n-1}&#39; + b
v_n&#39;\]</span> for some real numbers <span
class="math inline">\(a\)</span> and <span
class="math inline">\(b\)</span>. (We have used here that <span
class="math inline">\(\langle v_{n-1}, v_n \rangle_{\mathbb{R}} =
\langle v_{n-1}&#39;, v_n&#39; \rangle_{\mathbb{R}}\)</span>.) We are
free to translate <span class="math inline">\(v_{n-2}\)</span> by any
integral multiple of <span class="math inline">\(v_{n-1}\)</span> or
<span class="math inline">\(v_n\)</span>. Adjusting first by <span
class="math inline">\(v_{n-1}\)</span>, we may arrange that <span
class="math inline">\(|a| \leq 1/2\)</span>. Adjusting further by <span
class="math inline">\(v_n\)</span>, we may arrange further that <span
class="math inline">\(|b| \leq 1/2\)</span>. We observe now that <span
class="math inline">\(u := v_{n-2}&#39; + a v_{n-1}&#39;\)</span> is the
orthogonal projection of <span class="math inline">\(v_{n-2}\)</span> to
<span class="math inline">\(\mathcal{L}_{n-1}\)</span>. By the
minimality of <span class="math inline">\(v_{n-1}&#39;\)</span>, we have
<span class="math display">\[|v_{n-1}&#39;|^2 \leq |u|^2 =
|v_{n-2}&#39;|^2 + a^2 | v_{n-1}&#39;|^2.\]</span> Using that <span
class="math inline">\(|a| \leq 1/2\)</span>, it follows readily that
<span class="math inline">\(|v_{n-2}&#39;| \geq \frac{\sqrt{3}}{2} |
v_{n-1}&#39;|\)</span>.</p>
<p>Continuing in this way, we obtain the desired reduced basis.</p>
<p><span><strong>We turn to part (ii).</strong></span> By definition,
<span class="math inline">\(v_i &#39; T = v_i = v_i&#39; + \sum_{j &gt;
i} x_{i j} v_j&#39;\)</span>. Let us express this relation in terms of
the orthonormal basis <span
class="math inline">\(\{v_i&#39;&#39;\}\)</span>: <span
class="math display">\[v_i&#39;&#39; T = v_i&#39;&#39; + \sum _{j &gt; i
} x_{i j} \frac{a_j}{a_i} v_j&#39;&#39;.\]</span> Thus in this basis,
the matrix of <span class="math inline">\(T\)</span> is strictly
upper-triangular, with each entry <span class="math inline">\(\ll
1\)</span>. The same is then true for the inverse of <span
class="math inline">\(T\)</span>. By computing <span
class="math inline">\(\|v\|\)</span> and <span class="math inline">\(\|T
v\|\)</span> with respect to <span
class="math inline">\(\{v_i&#39;&#39;\}\)</span>, we deduce the desired
estimate.</p>
<p><span><strong>We turn to part (iii).</strong></span> Let <span
class="math inline">\(v_1,\dotsc,v_n\)</span> and <span
class="math inline">\(w_1,\dotsc,w_n\)</span> be reduced bases. By (ii)
and symmetry, it is enough to show that for each <span
class="math inline">\(k \in \{1, \dotsc, n\}\)</span>, <span
class="math display">\[|w_k| \gg |v_k|.\]</span> To that end, write
<span class="math inline">\(w_i = \sum_j c_{ij} v_j\)</span> for some
integers <span class="math inline">\(c_{i j}\)</span>. Since the vectors
<span class="math inline">\(w_k,\dotsc,w_n\)</span> are linearly
independent, they cannot all be contained in the span of the vectors
<span class="math inline">\(v_{k+1},\dotsc,v_n\)</span>. We may thus
find <span class="math inline">\(\ell \in \{k,\dotsc,n\}\)</span> and
<span class="math inline">\(m \in \{1,\dotsc,k\}\)</span> so that <span
class="math inline">\(c_{\ell m} \neq 0\)</span>. By <a
href="#eqn:reduced-basis-approx-orth" data-reference-type="eqref"
data-reference="eqn:reduced-basis-approx-orth">\((1)\)</a>
and the integrality of <span class="math inline">\(c_{\ell m}\)</span>,
we then have <span class="math display">\[|w_k| \geq \left(
\frac{\sqrt{3}}{2} \right)^{\ell-k} |w_{\ell}| \gg |w_{\ell}| \asymp
\max_j |c_{\ell j} v_j&#39;| \gg |v_m&#39;| \geq \left(
\frac{\sqrt{3}}{2} \right)^{k-j} |v_k| \gg |v_k|,\]</span> as
required.</p>
<p><span><strong>We turn to part (iv).</strong></span> Let <span
class="math inline">\(v_1,\dotsc,v_n\)</span> and <span
class="math inline">\(w_1,\dotsc,w_n\)</span> be reduced bases. Suppose
that <span id="eqn:sublattices-are-distinct" class="math display">\[\label{eqn:sublattices-are-distinct}\tag{2}
    \langle v_{i+1},\dotsc,v_n \rangle \neq \langle
    w_{i+1},\dotsc, w_n \rangle.\]</span> Without loss of generality,
suppose more precisely that <span class="math inline">\(w_j \notin
\langle v_{i+1},\dotsc,v_n \rangle\)</span> for some <span
class="math inline">\(j \in \{i+1,\dotsc,m\}\)</span>. We may write
<span class="math inline">\(w_j = \sum_k c_k v_k\)</span> with <span
class="math inline">\(c_k \in \mathbb{Z}\)</span>. By hypothesis, there
exists <span class="math inline">\(k \in \{1, \dotsc, i\}\)</span> with
<span class="math inline">\(c_k \neq 0\)</span>. By <a
href="#eqn:reduced-basis-approx-orth" data-reference-type="eqref"
data-reference="eqn:reduced-basis-approx-orth">\((1)\)</a>
and part (iii), we have <span class="math display">\[a_{i+1} \asymp
|w_{i+1}| \gg |w_j| \gg |v_k| \gg |v_i| \asymp |w_i| \asymp
a_i.\]</span> Thus there exists <span class="math inline">\(C \geq
1\)</span>, depending only upon <span class="math inline">\(n\)</span>,
so that <span class="math inline">\(a_{i+1}/a_i \leq C\)</span> whenever
<a href="#eqn:sublattices-are-distinct" data-reference-type="eqref"
data-reference="eqn:sublattices-are-distinct">\((2)\)</a>
holds. Taking contrapositives, we obtain the required implication.</p>
<p><span><strong>We turn, finally, to part (v).</strong></span></p>
<p>Let <span class="math inline">\(a_i = |v_i&#39;|\)</span> denote the
Iwasawa coordinates of the first reduced basis. By part (iii), they are
approximately those of the second basis: <span class="math inline">\(a_i
\asymp |w_i&#39;|\)</span>. By part (ii), we have <span
class="math inline">\(a_i \asymp |w_i| \asymp \sum_j a_j |\gamma_{i
j}|\)</span>. In particular, there is a constant <span
class="math inline">\(C\)</span>, depending only upon <span
class="math inline">\(n\)</span>, so that <span id="eqn:gamma-ij-C-ai-aj" class="math display">\[\label{eqn:gamma-ij-C-ai-aj}\tag{3}
    |\gamma_{i j}| \leq C a_i / a_j.\]</span></p>
<p>A key observation (implicit already in the proof of (iv)) is that if
<span class="math inline">\(a_j / a_{i} &gt; C\)</span>, then <span
class="math inline">\(C a_i / a_j &lt; 1\)</span>. Since <span
class="math inline">\(\gamma\)</span> has integral entries, this forces
<span class="math inline">\(\gamma_{i j} = 0\)</span>. This feature
motivates that our argument will depend upon how far apart the
neighboring <span class="math inline">\(a_i\)</span>’s are from one
another.</p>
<p>Recall that <span class="math inline">\(a_1 \gg \dotsb \gg
a_n\)</span>.</p>
<p>Consider first the case that all <span
class="math inline">\(a_i\)</span> are roughly of the same size: <span
class="math display">\[a_1 \asymp \dotsb \asymp a_n.\]</span> Then <a
href="#eqn:gamma-ij-C-ai-aj" data-reference-type="eqref"
data-reference="eqn:gamma-ij-C-ai-aj">\((3)\)</a> implies
that each <span class="math inline">\(\gamma_{i j} \ll 1\)</span>, which
was the desired conclusion.</p>
<p>Suppose next that, for some <span class="math inline">\(m \in \{1,
\dotsc, n\}\)</span>, the numbers <span
class="math inline">\(a_1,\dotsc,a_m\)</span> are all of the same size,
as are the numbers <span
class="math inline">\(a_{m+1},\dotsc,a_n\)</span>, but those in the
first group are significantly larger than those in the second: <span id="eqn:two-groups-ai" class="math display">\[\label{eqn:two-groups-ai}\tag{4}
    a_1 \asymp \dotsb \asymp a_m,
    \quad
    a_{m+1} \asymp \dotsb \asymp a_n,
    \quad
    a_i / a_j &gt; C
    \text{ for } i \leq m, j &gt; m.\]</span> Then <a
href="#eqn:gamma-ij-C-ai-aj" data-reference-type="eqref"
data-reference="eqn:gamma-ij-C-ai-aj">\((3)\)</a> implies
that</p>
<ul>
<li><p><span class="math inline">\(\gamma_{i j} \ll 1\)</span> whenever
<span class="math inline">\(i,j\)</span> are both <span
class="math inline">\(\leq m\)</span> or both <span
class="math inline">\(&gt; m\)</span>, and</p></li>
<li><p><span class="math inline">\(\gamma_{i j} = 0\)</span> whenever
<span class="math inline">\(i &gt; m\)</span> and <span
class="math inline">\(j \leq m\)</span>,</p></li>
</ul>
<p>but does not immediately usefully constrain the remaining variables
<span class="math inline">\(\gamma_{i j}\)</span> for <span
class="math inline">\(i \leq m, j &gt; m\)</span>. We may in any event
write <span class="math inline">\(\gamma\)</span> in block-diagonal form
as <span class="math display">\[\gamma =
    \begin{pmatrix}
      \Gamma_{1 1} &amp;  \Gamma_{1 2} \\
      0 &amp; \Gamma_{2 2}
    \end{pmatrix}\]</span> where <span class="math inline">\(\Gamma_{11}
\in {\mathop{\mathrm{GL}}}_m(\mathbb{Z})\)</span> and <span
class="math inline">\(\Gamma_{2 2} \in
{\mathop{\mathrm{GL}}}_{n-m}(\mathbb{Z})\)</span> have entries <span
class="math inline">\(\ll 1\)</span>. Note that the inverses of these
last matrices are also of size <span class="math inline">\(\ll
1\)</span>, in view of Cramer’s rule and the fact that <span
class="math inline">\(\det(\Gamma_{i i}) = \pm 1\)</span>. Our remaining
task is to estimate the entries of the <span class="math inline">\(m
\times (n-m)\)</span> matrix <span class="math inline">\(\Gamma_{1
2}\)</span>; we wish to show that those entries are <span
class="math inline">\(\ll 1\)</span>.</p>
<p>To that end, let <span class="math inline">\(g \in
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span> denote the matrix with rows
<span class="math inline">\(e_j g = v_j\)</span>. Then <span
class="math inline">\(\gamma g\)</span> has rows <span
class="math inline">\(e_j \gamma g = w_j\)</span>. The Iwasawa
decomposition of <span class="math inline">\(g\)</span> reads <span
class="math inline">\(g = x a k\)</span> where <span
class="math inline">\(|x_{i j}| \leq 1/2\)</span>, <span
class="math inline">\(a =
\mathop{\mathrm{diag}}(a_1,\dotsc,a_n)\)</span> and <span
class="math inline">\(k \in \operatorname{O}(n)\)</span>. The Iwasawa
decomposition of <span class="math inline">\(\gamma g\)</span> satisfies
similar bounds. We wish to combine the known bounds on <span
class="math inline">\(g\)</span> and <span class="math inline">\(\gamma
g\)</span> to constrain <span
class="math inline">\(\Gamma_{12}\)</span>. To that end, it is
convenient to write the Iwasawa components in block-diagonal form, like
for <span class="math inline">\(\gamma\)</span>. First, write <span
class="math display">\[x =
    \begin{pmatrix}
      U_{ 1 1}  &amp;  U_{1 2} \\
      0 &amp; U_{2 2}
    \end{pmatrix}
    ,\]</span> where <span class="math inline">\(U_{1 1}, U_{2
2}\)</span> are strictly upper-triangular. Next, taking into account
that the numbers <span class="math inline">\(a_1,\dotsc,a_m\)</span> and
also <span class="math inline">\(a_{m+1},\dotsc,a_n\)</span> are of
similar size, we write <span
class="math display">\[\mathop{\mathrm{diag}}(a_1,\dotsc,a_m) = A_1
M_1,\]</span> <span class="math display">\[A_1 :=
\mathop{\mathrm{diag}}(a_1,\dotsc,a_1), \quad M_1 :=
\mathop{\mathrm{diag}}(a_1/a_1,a_2/a_1,\dotsc,a_m/a_1)\]</span> and
<span class="math display">\[\mathop{\mathrm{diag}}(a_{m+1},\dotsc,a_n)
= A_2 M_2,\]</span> <span class="math display">\[A_2 =
\mathop{\mathrm{diag}}(a_{n},\dotsc,a_n), \quad M_1 =
\mathop{\mathrm{diag}}(a_{m+1}/a_n,\dotsc,a_{n-1}/a_n,a_n/a_n),\]</span>
say. The precise choice of the scalar matrices <span
class="math inline">\(A_1,A_2\)</span> is unimportant; what matters is
just that each entry of <span class="math inline">\(M_1\)</span> or
<span class="math inline">\(M_2\)</span> has size <span
class="math inline">\(\asymp 1\)</span>. Thus <span
class="math display">\[g =
    \begin{pmatrix}
      U_{11} &amp; U_{1 2} \\
      0 &amp; U_{2 2}
    \end{pmatrix}
    \begin{pmatrix}
      A_1 M_1 &amp; 0 \\
      0 &amp; A_2 M_2
    \end{pmatrix}
    k.\]</span> After a bit of matrix multiplication, we find that <span
class="math display">\[\gamma g =
    \begin{pmatrix}
      1 &amp; B \\
      0 &amp; 1
    \end{pmatrix}
    \begin{pmatrix}
      \Gamma_{1 1} U_{1 1} M_1 A_1 &amp; 0 \\
      0 &amp; \Gamma_{2 2} U_{2 2} M_2 A_2
    \end{pmatrix}
    k,\]</span> where <span class="math display">\[B := \Gamma_{1 2}
\Gamma_{2 2}^{-1} + \Gamma_{1 1} U_{12} U_{22}^{-1}
\Gamma_{22}^{-1}.\]</span> Since the matrices <span
class="math inline">\(\Gamma_{11}, \Gamma_{22}, U_{12}, U_{22}\)</span>
and their inverses are of size <span class="math inline">\(\ll
1\)</span>, our goal of showing that <span
class="math inline">\(\Gamma_{12}\)</span> is of size <span
class="math inline">\(\ll 1\)</span> will be achieved if we can verify
that <span class="math inline">\(B\)</span> is of size <span
class="math inline">\(\ll 1\)</span>.</p>
<p>To that end, we compute the Iwasawa decomposition of <span
class="math inline">\(\gamma g\)</span>. Note that the matrices <span
class="math inline">\(\Gamma_{i i} U_i M_i\)</span> and their inverses
are each of size <span class="math inline">\(\ll 1\)</span>, so the same
holds for their Iwasawa components, say <span
class="math inline">\(\Gamma_{i i} U_i M_i = u^{(i)} a^{(i)}
k^{(i)}\)</span>. The Iwasawa decomposition of <span
class="math inline">\(\gamma g\)</span> thus reads <span
class="math display">\[\gamma g = u&#39;
    \begin{pmatrix}
      a^{(1)} A_1 &amp; 0 \\
      0 &amp; a^{(2)} A_2
    \end{pmatrix}
    \begin{pmatrix}
      k^{(1)} &amp;  \\
              &amp; k^{(2)}
    \end{pmatrix}
    k,\]</span> where <span class="math display">\[u&#39; =
    \begin{pmatrix}
      u^{(1)} &amp; B u^{(2)}
      \\
      0 &amp; u^{(2)}
    \end{pmatrix}
    .\]</span> Since the basis <span
class="math inline">\(w_1,\dotsc,w_n\)</span> is reduced, we know that
the individual above-diagonal entries of <span
class="math inline">\(u&#39;\)</span> are of size at most <span
class="math inline">\(1/2\)</span>. Since <span
class="math inline">\(u^{(1)}, u^{(2)}\)</span> and their inverses are
of size <span class="math inline">\(\ll 1\)</span>, it follows that
<span class="math inline">\(B\)</span> is likewise of size <span
class="math inline">\(\ll 1\)</span>, as required.</p>
<p>This completes the proof in the special case <a
href="#eqn:two-groups-ai" data-reference-type="eqref"
data-reference="eqn:two-groups-ai">\((4)\)</a>. The general
case is similar. We may write <span class="math inline">\(n = \alpha_1 +
\dotsb + \alpha_r\)</span> in such a way that, setting <span
class="math inline">\(n_0 := 0\)</span> and <span
class="math inline">\(n_k := \alpha_1 + \dotsb + \alpha_k\)</span>, we
have</p>
<ul>
<li><p><span class="math inline">\(a_i \asymp a_j\)</span> whenever
<span class="math inline">\(i,j\)</span> lie in the same segment, i.e.,
<span class="math inline">\(n_{k-1} &lt; i, j \leq n_k\)</span> for some
<span class="math inline">\(k\)</span>, and</p></li>
<li><p><span class="math inline">\(a_i / a_j &gt; C\)</span> whenever
<span class="math inline">\(i &gt; j\)</span> and <span
class="math inline">\(i,j\)</span> lie in distinct segments.</p></li>
</ul>
<p>We then write our matrices in terms of <span class="math inline">\(r
\times r\)</span> blocks and argue as above. ◻</p>
</span></div>
<div id="defn:standard-siegel-domain" class="definition">
<p><strong>Definition 10</strong>. Let <span
class="math inline">\(\mathfrak{S}\)</span> denote the set of all <span
class="math inline">\(g \in {\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>
for which the corresponding basis <span class="math inline">\(e_1 g,
\dotsc, e_n g\)</span> of <span
class="math inline">\(\mathbb{R}^n\)</span> is reduced. Thus <span
class="math inline">\(\mathfrak{S}\)</span> consists of those <span
class="math inline">\(g\)</span> whose Iwasawa coordinates <span
class="math inline">\(g = x a k \in N \times A^+ \times K\)</span>
satisfy <span class="math inline">\(|x_{i j}| \leq 1/2\)</span> (<span
class="math inline">\(i &lt; j\)</span>) and <span
class="math inline">\(a_i / a_{i+1} \geq \sqrt{3}/2\)</span>.</p>
</div>
<div id="thm:siegel-domain-basics" class="theorem">
<p><strong>Theorem 11</strong>. <em>We have <span id="eqn:siegel-domain-big" class="math display">\[\label{eqn:siegel-domain-big}\tag{5}
    {\mathop{\mathrm{GL}}}_n(\mathbb{Z}) \mathfrak{S}  =
{\mathop{\mathrm{GL}}}_n(\mathbb{R}).\]</span> Moreover, <span id="eqn:siegel-domain-not-too-big" class="math display">\[\label{eqn:siegel-domain-not-too-big}\tag{6}
    \# \{\gamma \in {\mathop{\mathrm{GL}}}_n(\mathbb{Z}) :
    \gamma \mathfrak{S} \cap \mathfrak{S} \neq \emptyset \}
    &lt; \infty.\]</span></em></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We apply Theorem <a
href="#thm:existence-reduced-basis" data-reference-type="ref"
data-reference="thm:existence-reduced-basis">9</a>.</p>
<p>Part (i) implies <a href="#eqn:siegel-domain-big"
data-reference-type="eqref"
data-reference="eqn:siegel-domain-big">\((5)\)</a>.
Indeed, let <span class="math inline">\(g \in
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. Let <span
class="math inline">\(\mathbb{Z}^n g\)</span> denote the corresponding
lattice, with basis <span class="math inline">\(e_1 g, \dotsc, e_n
g\)</span> given by the rows of <span class="math inline">\(g\)</span>.
Choose a reduced basis <span
class="math inline">\(v_1,\dotsc,v_n\)</span> of <span
class="math inline">\(g\)</span>. Let <span class="math inline">\(\gamma
\in {\mathop{\mathrm{GL}}}_n(\mathbb{Z})\)</span> denote the corresponding
change of basis matrix, characterized by <span class="math inline">\(v_i
= \sum_j \gamma_{i j} e_j g = e_i \gamma g\)</span>. Then <span
class="math inline">\(\gamma g \in \mathfrak{S}\)</span>, as
required.</p>
<p>Part (v) implies <a href="#eqn:siegel-domain-not-too-big"
data-reference-type="eqref"
data-reference="eqn:siegel-domain-not-too-big">\((6)\)</a>.
Indeed, suppose <span class="math inline">\(\gamma \in \Gamma\)</span>
satisfies <span class="math inline">\(\gamma g \in \mathfrak{S}\)</span>
for some <span class="math inline">\(g \in \mathfrak{S}\)</span>. Let
<span class="math inline">\(v_1,\dotsc,v_n\)</span> and <span
class="math inline">\(w_1,\dotsc,w_n\)</span> denote the rows of <span
class="math inline">\(\gamma\)</span> and <span
class="math inline">\(\gamma g\)</span>, respectively. These define
reduced bases of the same lattice <span
class="math inline">\(\mathbb{Z}^n g\)</span>. The hypotheses for part
(v) are thus satisfied, and we obtain <span
class="math inline">\(|\gamma_{i j}| \leq C\)</span> where <span
class="math inline">\(C\)</span> depends only upon <span
class="math inline">\(n\)</span>. The set of integral matrices
satisfying this last condition is finite. ◻</p>
</span></div>
<p>We call <span class="math inline">\(\mathfrak{S}\)</span> the
standard <em>Siegel domain</em> for <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z})\)</span>. It
contains a fundamental domain for <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>, but is “not much bigger”
than a fundamental domain in the sense quantified by the above results.
The same results apply to the larger domains defined like <span
class="math inline">\(\mathfrak{S}\)</span>, but with <span
class="math inline">\(1/2\)</span> replaced by something larger and
<span class="math inline">\(\sqrt{3}/2\)</span> by something
smaller.</p>
<p>There are obvious analogues of Definition <a
href="#defn:standard-siegel-domain" data-reference-type="ref"
data-reference="defn:standard-siegel-domain">10</a> and Theorem <a
href="#thm:siegel-domain-basics" data-reference-type="ref"
data-reference="thm:siegel-domain-basics">11</a> for <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>.</p>
<p>For future reference, we introduce the following terminology.</p>
<div id="defn:siegel-domain" class="definition">
<p><strong>Definition 12</strong>. Let <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span> or <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>. Write
<span class="math inline">\(G = N A K\)</span> for its Iwasawa
decomposition, where now <span class="math inline">\(A\)</span> consists
of diagonal elements with positive entries. A <em>Siegel domain</em> for
<span class="math inline">\(G\)</span> is a subset of the form <span
class="math inline">\(\mathfrak{S} = \omega A_t K\)</span>, where <span
class="math inline">\(\omega \subseteq N\)</span> is compact and <span
class="math inline">\(A_T := \{a \in A : a_i/a_{i+1} \geq
t\}\)</span>.</p>
</div>
<p>The examples above arise by taking <span class="math inline">\(\omega
= \{u \in N : |u_{i j} | \leq B \text{ for all } i &lt;
j\}\)</span>.</p>
<div class="exercise">
<p><strong>Exercise 2</strong>. Adapt the proof of Theorem <a
href="#thm:existence-reduced-basis" data-reference-type="ref"
data-reference="thm:existence-reduced-basis">9</a>
to show that any discrete subgroup <span class="math inline">\(\Lambda
\subseteq \mathbb{R}^n\)</span> is of the form <span
class="math inline">\(\Lambda = \oplus_{i=1}^m \mathbb{Z} v_i\)</span>
for some linearly independent subset <span
class="math inline">\(\{v_1,\dotsc,v_m\} \subseteq
\mathbb{R}^n\)</span>. Deduce that the following conditions on a
subgroup <span class="math inline">\(\Lambda \subseteq
\mathbb{R}^n\)</span> are equivalent.</p>
<ol type="i">
<li><p><span class="math inline">\(\Lambda\)</span> is a lattice in the
sense defined earlier (i.e., it is the <span
class="math inline">\(\mathbb{Z}\)</span>-module generated by some <span
class="math inline">\(\mathbb{R}\)</span>-basis of <span
class="math inline">\(\mathbb{R}^n\)</span>).</p></li>
<li><p><span class="math inline">\(\Lambda\)</span> is discrete and
cocompact.</p></li>
</ol>
</div>
<div class="exercise">
<p><strong>Exercise 3</strong> (Minkowski’s theorem). Let <span
class="math inline">\(L\)</span> be a lattice with reduced basis <span
class="math inline">\(v_1,\dotsc,v_n\)</span>. As usual, set <span
class="math inline">\(a_i = |v_i&#39;|\)</span>.</p>
<ol type="i">
<li><p>Show that <span
class="math inline">\(\mathop{\mathrm{vol}}(\mathbb{R}^n/L) \asymp a_1
\dotsb a_n\)</span>,</p></li>
<li><p>Show that <span class="math inline">\(L\)</span> contains a
nonzero vector of length <span class="math inline">\(\ll
\mathop{\mathrm{vol}}(\mathbb{R}^n/L)^{1/n}\)</span>.</p></li>
</ol>
</div>
<div class="exercise">
<p><strong>Exercise 4</strong>. Give an explicit example of a lattice
<span class="math inline">\(\mathcal{L} \subseteq \mathbb{R}^2\)</span>
with reduced bases <span class="math inline">\(v_1, v_2\)</span> and
<span class="math inline">\(w_1, w_2\)</span> so that <span
class="math inline">\(v_1, v_2\)</span> is not a permutation of <span
class="math inline">\(\pm w_1, \pm w_2\)</span> for any combination of
signs.</p>
</div>
<div class="exercise">
<p><strong>Exercise 5</strong> (Mahler’s theorem). Let <span
class="math inline">\(L\)</span> be a lattice. The <em>successive
minima</em> of <span class="math inline">\(L\)</span> are the numbers
<span class="math inline">\(M_1 \leq \dotsb \leq M_n\)</span> described
as follows: <span class="math inline">\(M_{k}\)</span> is the smallest
positive real for which <span class="math inline">\(L\)</span> contains
a <span class="math inline">\(k\)</span>-element linearly independent
subset <span class="math inline">\(\{w_1,\dotsc,w_k\}\)</span> with each
<span class="math inline">\(|w_i| \leq M_k\)</span>. Show that for any
reduced basis <span class="math inline">\(v_1,\dotsc,v_n\)</span> of
<span class="math inline">\(L\)</span>, we have <span
class="math inline">\(M_k \asymp a_{n-k+1}\)</span>, where as usual
<span class="math inline">\(a_k = |v_k&#39;|\)</span>.</p>
</div>
<div id="thm:mahler-criterion" class="exercise">
<p><strong>Exercise 6</strong> (Mahler compactness criterion). Let <span
class="math inline">\(S\)</span> be a subset of the space of unimodular
lattices. Show that the following are equivalent.</p>
<ol type="i">
<li><p><span class="math inline">\(S\)</span> is precompact.</p></li>
<li><p>There exists <span class="math inline">\(\delta &gt; 0\)</span>
so <span class="math inline">\(|v| \geq \delta\)</span> for all <span
class="math inline">\(0 \neq v \in L \in S\)</span>.</p></li>
</ol>
</div>
<h2 id="sec:org2326c58">§2.5. Haar measure</h2>
<p>For a summary with references, see <a href="#ref-MR1482800" class="citation"
data-cites="MR1482800">(Borel 1997, vol. 130, sec. 2.9)</a>.</p>
<p>On any locally compact group <span class="math inline">\(G\)</span>,
there is a unique (up to scaling) measure <span
class="math inline">\(d^L g\)</span> (resp. <span
class="math inline">\(d^R g\)</span>) on <span
class="math inline">\(G\)</span> invariant under left (resp. right)
translation by <span class="math inline">\(G\)</span>. These are called
left (resp. right) Haar measures. If <span
class="math inline">\(G\)</span> is a Lie group and <span
class="math inline">\(\omega^L\)</span> is a nonzero volume form
invariant under left translation, then one may construct such a Haar
measure explicitly by <span class="math inline">\(\int f (g) \, d ^L g =
\int f \cdot \omega^L\)</span> (and similarly with “left” replaced by
“right”). The left and right Haar measures are related (up to scaling)
by <span class="math inline">\(d^R g = \delta(g) \, d^L g\)</span>,
where <span class="math inline">\(\delta : G \rightarrow
\mathbb{R}^\times_+\)</span> is the continuous homomorphism given by the
magnitude of the determinant of the adjoint representation: <span
class="math display">\[\delta(g) := |\det \mathop{\mathrm{Ad}}(g)|,
\quad \mathop{\mathrm{Ad}}: G \rightarrow
  \mathop{\mathrm{GL}}(\mathfrak{g}).\]</span> We call <span
class="math inline">\(\delta\)</span> the <em>modulus character</em> of
<span class="math inline">\(G\)</span>.</p>
<p>We call <span class="math inline">\(G\)</span> <em>unimodular</em> if
<span class="math inline">\(\delta\)</span> is trivial, i.e., <span
class="math inline">\(\delta(g) = 1\)</span> for all <span
class="math inline">\(g \in G\)</span>; in that case, we may take <span
class="math inline">\(d^L g = d^R g\)</span> and speak unambiguously of
a (left and right) Haar measure <span class="math inline">\(d
g\)</span>.</p>
<div class="example">
<p><strong>Example 13</strong>. Any abelian group is unimodular. In
particular,</p>
<ul>
<li><p>the additive group <span class="math inline">\(G =
\mathbb{R}\)</span> is unimodular, with a Haar measure given by the
Lebesgue measure <span class="math inline">\(d x\)</span>, and</p></li>
<li><p>the multiplicative group <span class="math inline">\(G =
\mathbb{R}^\times\)</span> is unimodular, with a Haar measure is given
by <span class="math inline">\(d^\times x := \frac{d
x}{|x|}\)</span>.</p></li>
</ul>
</div>
<div class="example">
<p><strong>Example 14</strong>. Any nilpotent Lie group is unimodular:
the adjoint representation admits a basis with respect to which it is
strictly upper-triangular, hence has determinant one.</p>
</div>
<div id="exa:compact-group-haar" class="example">
<p><strong>Example 15</strong>. Any compact group <span
class="math inline">\(G\)</span> is unimodular. Indeed, since <span
class="math inline">\(\delta : G \rightarrow
\mathbb{R}^\times_+\)</span> defines a continuous homomorphism and <span
class="math inline">\(G\)</span> is compact, the image of <span
class="math inline">\(\delta\)</span> is a compact subgroup of <span
class="math inline">\(\mathbb{R}^\times_+\)</span>, but the only such
subgroup is <span class="math inline">\(\{1\}\)</span>. Compact groups
are moreover of finite volume, so they admit a unique probability Haar
measure.</p>
</div>
<div class="example">
<p><strong>Example 16</strong>. <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>, <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span> and,
more generally, all reductive algebraic groups <span
class="math inline">\(G\)</span> are unimodular. Indeed, the adjoint
determinant is identically one. One can see this directly in these
examples using the Iwasawa decomposition and the preceding examples.
Alternatively, it suffices to check this at the level of complex points
(e.g., for <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{C})\)</span>), in
which case it follows from the fact that <span
class="math inline">\(G\)</span> possesses a Zariski dense compact
subgroup <span class="math inline">\(K\)</span> (e.g., <span
class="math inline">\(\mathop{\mathrm{U}}(n)\)</span>); Example <a
href="#exa:compact-group-haar" data-reference-type="ref"
data-reference="exa:compact-group-haar">15</a> implies that <span
class="math inline">\(\delta\)</span> is trivial on <span
class="math inline">\(K\)</span>, hence also on <span
class="math inline">\(G\)</span>.</p>
</div>
<div class="example">
<p><strong>Example 17</strong>. The two-dimensional affine group <span
class="math inline">\(B = \left\{ b =
    \begin{pmatrix}
      y &amp; x \\
      0 &amp; 1
    \end{pmatrix}
    : x \in \mathbb{R}, y \in \mathbb{R}^\times \right\}\)</span> is not
unimodular; we have <span class="math inline">\(\delta(b) = |y|\)</span>
and may take <span class="math display">\[d^L b = \frac{d x \, d
y}{|y|^2}, \quad d^R b = \frac{d x \, d y}{|y|}.\]</span></p>
</div>
<div id="exa:borel-haar" class="example">
<p><strong>Example 18</strong>. Consider the group <span
class="math inline">\(B = N A\)</span> of upper-triangular matrices in
<span class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>.
A Haar measure on <span class="math inline">\(N\)</span> is given by the
product of Lebesgue measures in coordinates: <span
class="math inline">\(d x = \prod_{i &lt; j} d x_{i j}\)</span>. A Haar
measure on <span class="math inline">\(A\)</span> is given by <span
class="math inline">\(d a = \prod_{i} d^\times a_i\)</span>, where as
before <span class="math inline">\(d^\times x := \frac{d x}{
|x|}\)</span> denotes the Haar measure on the multiplicative group. The
modulus character is given by <span class="math inline">\(\delta(x a) =
\prod_{i &lt; j} a_i / a_j\)</span>, since for <span
class="math inline">\(z = (z_{i j})_{i \leq j} \in
\mathop{\mathrm{Lie}}(B)\)</span> we have <span
class="math inline">\(\mathop{\mathrm{Ad}}(x a) z = (a_i a_j^{-1} z_{i
j})_{i \leq j}\)</span>. As left and right Haar measures on <span
class="math inline">\(B\)</span>, we may take <span
class="math display">\[d^R (x a) = d x \, d a, \quad d^L (x a) = d x \,
\frac{d a}{\delta(a)}.\]</span></p>
</div>
<div class="example">
<p><strong>Example 19</strong>. Let <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>, let <span
class="math inline">\(B = N A\)</span> be as above, and let <span
class="math inline">\(K = \operatorname{O}(n)\)</span>. Then a Haar
measure <span class="math inline">\(d g\)</span> on <span
class="math inline">\(G\)</span> is given by <span
class="math display">\[\int_G f(g) \, d g = \int _{b \in B} \int _{k \in
K} f(b k) \, d^L b \, d k,\]</span> where <span
class="math inline">\(d^L b\)</span> is a left Haar measure on <span
class="math inline">\(B\)</span> (as described above) and <span
class="math inline">\(d k\)</span> is a Haar measure on <span
class="math inline">\(K\)</span>.</p>
<p>To see this, observe first that the RHS defines a measure <span
class="math inline">\(\mu\)</span> on <span
class="math inline">\(G\)</span>. Using that the map <span
class="math inline">\(B \times K \rightarrow G\)</span> has surjective
differential (as observed in our discussion of the Iwasawa
decomposition), we see that <span class="math inline">\(\mu\)</span> is
absolutely continuous with respect to any Haar measure <span
class="math inline">\(d g\)</span> on <span
class="math inline">\(G\)</span>, say <span class="math inline">\(\mu =
\alpha \, d g\)</span> for some function <span
class="math inline">\(\alpha\)</span> on <span
class="math inline">\(G\)</span>. The invariance properties of <span
class="math inline">\(d^L b\)</span> and <span class="math inline">\(d
k\)</span> imply that <span class="math inline">\(\alpha\)</span> is
left <span class="math inline">\(B\)</span>-invariant and right <span
class="math inline">\(K\)</span>-invariant, hence <span
class="math inline">\(\alpha(b k) = \alpha(1)\)</span> for all <span
class="math inline">\((b,k) \in B \times K\)</span>. Since <span
class="math inline">\(B K = G\)</span>, it follows that <span
class="math inline">\(\alpha\)</span> is constant.</p>
<p>We might as well take <span class="math inline">\(d^L b\)</span> as
in Example <a href="#exa:borel-haar" data-reference-type="ref"
data-reference="exa:borel-haar">18</a> and <span class="math inline">\(d
k\)</span> as in Example <a href="#exa:compact-group-haar"
data-reference-type="ref"
data-reference="exa:compact-group-haar">15</a>.</p>
</div>
<div id="exa:2" class="example">
<p><strong>Example 20</strong>. A Haar measure on <span
class="math inline">\(G = {\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>
may be constructed similarly; we take <span class="math inline">\(k \in
\mathop{\mathrm{SO}}(n)\)</span>, restrict to <span
class="math inline">\(a\)</span> with <span class="math inline">\(a_1
\dotsb a_n = 1\)</span>, and omit the factor <span
class="math inline">\(d^\times a_n\)</span>. Explicitly, we may take
<span id="eq:int_g-f-=-3" class="math display">\[\label{eq:int_g-f-=-3}\tag{7}
    \int_G f
    =
    \int _{x \in N}
    \int _{ \substack{
        a_1, \dotsc, a_n &gt; 0 : \\
        a_1 \dotsb a_n = 1
      }
    }
    \int_{k \in K}
    f(x a k)
    \, d x \, \frac{d a}{\delta(a)} \, d k,
    \quad
    d a = \frac{d a_1}{a_1} \dotsb \frac{d a_{n-1}}{a
_{n-1}}.\]</span></p>
</div>
<p>Given a locally group <span class="math inline">\(G\)</span> and a
closed subgroup <span class="math inline">\(H\)</span>, both unimodular
and equipped with Haar measures <span class="math inline">\(d g\)</span>
and <span class="math inline">\(d h\)</span>, the quotient space <span
class="math inline">\(G/H\)</span> admits a unique <span
class="math inline">\(G\)</span>-invariant quotient measure <span
class="math inline">\(d \bar{g}\)</span> for which <span
class="math inline">\(d g = d \, \bar{g} \cdot d h\)</span>; this last
identity means that for any <span class="math inline">\(f \in
C_c(G)\)</span>, <span class="math display">\[\int _{G} f(g) \, d g =
\int _{G/H} \left( f(\bar{g} h) \, d h \right) \, d \bar{g}.\]</span>
Similar considerations apply to <span class="math inline">\(H \backslash
G\)</span>. We will refer to such quotient measures simply as Haar
measures.</p>
<p>In particular, for any choices of Haar measures on <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> and
<span class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>,
we obtain quotient measures on <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>, <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>; here the discrete subgroups
<span class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{Z})\)</span>
and <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z})\)</span> are
equipped with counting measure.</p>
<div id="exe:2" class="exercise">
<p><strong>Exercise 7</strong>. Let <span
class="math inline">\(\mu\)</span> be a Haar measure on <span
class="math inline">\({\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>. Show that there exists
<span class="math inline">\(c &gt; 0\)</span> with the following
property. Let <span class="math inline">\(f \in
C_c({\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_2(\mathbb{R}))\)</span>. Suppose that <span
class="math inline">\(f\)</span> is right-invariant under <span
class="math inline">\(\mathop{\mathrm{SO}}(2)\)</span>, so that it may
be identified with a function <span class="math inline">\(\varphi :
{\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash \mathbb{H} \rightarrow
\mathbb{C}\)</span>. Then <span id="eq:int_sl_2m-backsl-sl_" class="math display">\[\label{eq:int_sl_2m-backsl-sl_}\tag{8}
    \int_{{\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_2(\mathbb{R})} f \, d \mu
    =
    c
    \int _{{\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash \mathbb{H} }
    \varphi(x + i y) \, \frac{d x \, d y}{y^2}.\]</span></p>
</div>
<h2 id="sec:finiteness-volume">§2.6. Finiteness of the volume</h2>
<div id="thm:2" class="theorem">
<p><strong>Theorem 21</strong>. <em>The quotient <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> has finite volume with
respect to any Haar measure.</em></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Let <span class="math inline">\(\mathfrak{S}
\subseteq {\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> denote the
standard Siegel domain, defined as in Definition <a
href="#defn:standard-siegel-domain" data-reference-type="ref"
data-reference="defn:standard-siegel-domain">10</a>. By Theorem <a
href="#thm:siegel-domain-basics" data-reference-type="ref"
data-reference="thm:siegel-domain-basics">11</a>, it is enough to verify
that <span class="math inline">\(\mathfrak{S}\)</span> has finite volume
with respect to the given Haar measure. Since all Haar measures are
multiples of one another, it doesn’t matter which we work with, so let’s
use the Haar measure given by <a href="#eq:int_g-f-=-3"
data-reference-type="eqref"
data-reference="eq:int_g-f-=-3">\((7)\)</a>. The volume of
<span class="math inline">\(\mathfrak{S}\)</span> with respect to this
measure is <span id="eq:int-_substack-a_1-6" class="math display">\[\label{eq:int-_substack-a_1-6}\tag{9}
    \int _{\substack{
        a_1 \dotsb a_n = 1, \\
        a _i / a _{i + 1} \geq \sqrt{3}/2
      }
    }
    \frac{d a}{\delta (a) },\]</span> so our task is to verify that this
last integral converges absolutely.</p>
<p>We introduce the change of variables <span class="math display">\[y_1
= a_1/a_2, \quad y_2 = a_2/a_3, \dotsc, y_{n-1} = a_{n-1}/a_n.\]</span>
We can recover the <span class="math inline">\(a_i\)</span>’s from the
<span class="math inline">\(y_j\)</span>’s and <span
class="math inline">\(a_n\)</span>: for <span class="math inline">\(1
\leq i \leq n-1\)</span>, <span class="math display">\[a_i = y_i y_{i+1}
\dotsb y_{n-1} a_n.\]</span> We can determine <span
class="math inline">\(a_n\)</span> by calculating <span
class="math display">\[1 = a_1 a_2 \dotsb a_n = (y_1 \dotsb y_{n-1} a_n)
(y_2 \dotsb y_{n-1} a_n) \dotsb a_n = y_1 y_2^2 y_3^3 \dotsb
y_{n-1}^{n-1} a_n^n,\]</span> from which we deduce that <span id="eq:a_n-=-prod_i" class="math display">\[\label{eq:a_n-=-prod_i}\tag{10}
    a_n =
    \prod_i y_i^{i/n}.\]</span> Up to the constant factor coming from
the Jacobian of the change of variables <span
class="math inline">\((a_i) \mapsto (y_j)\)</span>, we may rewrite the
integral <a href="#eq:int-_substack-a_1-6" data-reference-type="eqref"
data-reference="eq:int-_substack-a_1-6">\((9)\)</a> as
<span id="eq:int-_y_1-dotsc-2" class="math display">\[\label{eq:int-_y_1-dotsc-2}\tag{11}
    \int _{y_1, \dotsc, y_{n-1} = \sqrt{3}/2}^{\infty}
    \frac{1}{\delta(a(y))}
    \, d^\times y_1 \dotsb d^\times y_{n-1},\]</span> where <span
class="math display">\[\delta (a (y) ) :=
    \begin{pmatrix}
      y _1 \dotsb y _{n - 1} a _n  &amp;  &amp;  &amp;  &amp;  \\
                                   &amp; y _2 \dotsb y _{n - 1} a _n
&amp;  &amp;  &amp;  \\
                                   &amp;  &amp; \dotsb &amp;  &amp;  \\
                                   &amp;  &amp;  &amp; y _{n - 1 } a
_n  &amp;  \\
                                   &amp; &amp; &amp; &amp; a _n,
    \end{pmatrix}\]</span> where <span
class="math inline">\(a_n\)</span> is defined as in <a
href="#eq:a_n-=-prod_i" data-reference-type="eqref"
data-reference="eq:a_n-=-prod_i">\((10)\)</a>, so that <span
class="math inline">\(\det (a(y)) = 1\)</span>. The point is now just
that we may write <span class="math display">\[\delta(a(y)) = y _1
^{\beta _1 } \dotsb y _{n - 1 } ^{\beta _{n - 1 }}\]</span> for some
<em>positive</em> real numbers <span class="math inline">\(\beta _1,
\dotsc, \beta _{n - 1}\)</span>, given explicitly by <span id="eq:beta_j-=-j" class="math display">\[\label{eq:beta_j-=-j}\tag{12}
    \beta_j = j ( n - j).\]</span> To see his, note that for <span
class="math inline">\(x = (x_{i j})_{i \leq j} \in \mathfrak{g} =
\mathop{\mathrm{Lie}}(B)\)</span>, we have <span
class="math inline">\(\mathop{\mathrm{Ad}}(a(y)) x = (y_i \dotsb y_{j-1}
x_{i j})_{i \leq j}\)</span>. For example, when <span
class="math inline">\(n = 3\)</span>, <span
class="math display">\[\mathop{\mathrm{Ad}}(a(y)) x =
    \begin{pmatrix}
      x _{1 1} &amp; y_1 x_{1 2} &amp; y _1 y _2 x _{1 3} &amp;  y _1 y
_2 y _3 x _{1 4} \\
      0 &amp; x _{2 2} &amp; y _2 x _{2 3 } &amp; y _2 y _3 x _{2 4} \\
      0 &amp; 0 &amp; x _{3 3} &amp; y _3 x _{3 4} \\
      0 &amp; 0 &amp; 0 &amp; x _{4 4}
    \end{pmatrix}
    .\]</span> The matrix of eigenvalues of <span
class="math inline">\(\mathop{\mathrm{Ad}}(a(y))|_{\mathop{\mathrm{Lie}}(B)}\)</span>
is thus given by <span class="math display">\[\begin{pmatrix}
      1 &amp; y_1 &amp; y _1 y _2  &amp;  y _1 y _2 y _3  \\
        &amp; 1 &amp; y _2  &amp; y _2 y _3  \\
        &amp;  &amp; 1  &amp; y _3  \\
        &amp; &amp; &amp; 1
    \end{pmatrix}
    .\]</span> The appearances of <span
class="math inline">\(y_j\)</span> form a square of dimensions <span
class="math inline">\(j \times (n-j)\)</span>, whence the claim <a
href="#eq:beta_j-=-j" data-reference-type="eqref"
data-reference="eq:beta_j-=-j">\((12)\)</a>.</p>
<p>Since <span class="math inline">\(\int_{\sqrt{3}/2} y^{-\beta} \,
\frac{d y}{y} &lt; \infty\)</span> for each <span
class="math inline">\(\beta &gt; 0\)</span>, it follows that the
integral <a href="#eq:int-_y_1-dotsc-2" data-reference-type="eqref"
data-reference="eq:int-_y_1-dotsc-2">\((11)\)</a> converges
absolutely, as required. ◻</p>
</span></div>
<h2 id="sec:orge0ceafc">§2.7. How many vectors does a random lattice have in a
given region?</h2>
<p>Let <span class="math inline">\(\mathbb{E}_{L}\)</span> denote an
integral over unimodular lattices <span class="math inline">\(L\)</span>
respect to the probability Haar measure on <span
class="math inline">\(X_n^{(1)} = {\mathop{\mathrm{SL}}}_n(\mathbb{Z})
\backslash {\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> (<span
class="math inline">\(\mathcal{E}\)</span> stands for
“expectation”).</p>
<p>As further illustration of the content of this section, we sketch a
proof of the following theorem of Siegel.</p>
<div class="theorem">
<p><strong>Theorem 22</strong>. <em>Let <span
class="math inline">\(\Omega\)</span> be a bounded open subset of <span
class="math inline">\(\mathbb{R}^n\)</span> with <span
class="math inline">\(0 \notin \Omega\)</span>. Then <span
class="math display">\[\mathbb{E}_L | L \cap \Omega| =
\mathop{\mathrm{vol}}(\Omega),\]</span> where the volume of <span
class="math inline">\(\Omega\)</span> is computing using the usual
Lebesgue measure. In words, for a random unimodular lattice, the
expected number of lattice points in <span
class="math inline">\(\Omega\)</span> is given by its volume.</em></p>
</div>
<p>It is not <em>a priori</em> obvious that the expectation in question
is finite, in view of the following simple exercise.</p>
<div class="exercise">
<p><strong>Exercise 8</strong>. Assume <span class="math inline">\(n
\geq 2\)</span>. Show that for each nonempty open <span
class="math inline">\(\Omega \subseteq \mathbb{R}^n\)</span> and <span
class="math inline">\(N \geq 0\)</span>, there is a unimodular lattice
<span class="math inline">\(L\)</span> with <span
class="math inline">\(|L \cap \Omega| \geq N\)</span>.</p>
</div>
<p>The proof requires a couple lemmas. First, we give some basic
estimates and check that the integral converges. For <span
class="math inline">\(R &gt; 0\)</span>, let <span
class="math inline">\(B_R \subseteq \mathbb{R}^n\)</span> denote the
ball of radius <span class="math inline">\(R\)</span>.</p>
<div id="lem:bound-L-cap-B-R-individual" class="lemma">
<p><strong>Lemma 23</strong>. Let <span class="math inline">\(L
\subseteq \mathbb{R}^n\)</span>. Choose a reduced basis, hence Iwasawa
coordinates <span id="eq:a_1-gg-dotsb" class="math display">\[\label{eq:a_1-gg-dotsb}\tag{13}
    a_1 \gg \dotsb \gg a_n\]</span> as usual. Then <span id="eq:l-cap-b_r" class="math display">\[\label{eq:l-cap-b_r}\tag{14}
    |L \cap B_R| - 1
    \ll
    \frac{R}{a_n}
    + \frac{R^2}{a_n a_{n-1}} + \dotsb
    + \frac{R^n}{a_n \dotsb a_1}.\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> The LHS counts the number of nonzero lattice vectors
of size at most <span class="math inline">\(R\)</span>. Let <span
class="math inline">\(v_1,\dotsc,v_n\)</span> be a reduced basis. Any
nonzero element of <span class="math inline">\(L\)</span> may be written
<span class="math inline">\(x = \sum x_i v_i\)</span> where the <span
class="math inline">\(x_i\)</span> are integers, not all zero. By the
estimate <a href="#eqn:reduced-basis-approx-orth"
data-reference-type="eqref"
data-reference="eqn:reduced-basis-approx-orth">\((1)\)</a>,
we have <span class="math inline">\(|x| \asymp \max_{1 \leq i \leq n}
a_i |x_i|\)</span>. Thus, after enlarging <span
class="math inline">\(R\)</span> by a constant multiple, our task is to
estimate <span class="math display">\[| \{ 0 \neq x \in \mathbb{Z}^n :
\max_{1 \leq i \leq n} a_i |x_i| \leq R \} |.\]</span> The number of
possibilities for <span class="math inline">\(x_i\)</span> is at most
<span class="math inline">\(1 + R/a_i\)</span>, so the number of
possibilities for <span class="math inline">\(x\)</span> (excluding
<span class="math inline">\(x = 0\)</span>) is <span
class="math display">\[\prod_{i=1}^n \left( 1 + \frac{R}{a_i} \right) -
1.\]</span> We expand out the product and note that, thanks to <a
href="#eq:a_1-gg-dotsb" data-reference-type="eqref"
data-reference="eq:a_1-gg-dotsb">\((13)\)</a>, each term in the
expansion is majorized by a corresponding term in <a
href="#eq:l-cap-b_r" data-reference-type="eqref"
data-reference="eq:l-cap-b_r">\((14)\)</a>. We are done. ◻</p>
</span></div>
<div id="lem:we-have--1" class="lemma">
<p><strong>Lemma 24</strong>. We have <span
class="math display">\[\mathbb{E} _{L} (|L \cap B_R| - 1) \ll R +
R^n.\]</span> In particular, the indicated expectation is finite.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> It suffices to bound the corresponding integral taken
over the standard Siegel domain. By lemma <a
href="#lem:bound-L-cap-B-R-individual" data-reference-type="ref"
data-reference="lem:bound-L-cap-B-R-individual">23</a>, we reduce to
verifying for each <span class="math inline">\(0 \leq m \leq
n-1\)</span> that <span class="math display">\[\int_{\substack{
        a_1 \dotsb a_n = 1 \\
        a_i / a_{i+1} \geq \sqrt{3}/2 } } \frac{1}{a_{n} \dotsb a_{m+1}}
\, \frac{d a}{\delta(a)} &lt; \infty.\]</span></p>
<p>We introduce the change of variables <span class="math inline">\(a =
a(y)\)</span> as in the proof of Theorem <a href="#thm:2"
data-reference-type="ref" data-reference="thm:2">21</a>. The key point
is once again that <span id="eq:frac1a_n-dotsb-a_m+1" class="math display">\[\label{eq:frac1a_n-dotsb-a_m+1}\tag{15}
    \frac{1}{a_{n} \dotsb a_{m+1}}
    \frac{1}{\delta(a)} = y_1^{-\beta_1} \dotsb
y_{n-1}^{-\beta_n-1}\]</span> where each <span
class="math inline">\(\beta_j &gt; 0\)</span>.</p>
<p>To compute the <span class="math inline">\(\beta_j\)</span>, it is
convenient to rewrite <span class="math display">\[\frac{1}{a_{n} \dotsb
a_{m+1}} = a_1 \dotsb a_m,\]</span> using here that <span
class="math inline">\(a_1 \dotsb a_n = 1\)</span>. We compute as before
that <span class="math display">\[a_n = \prod_{j=1}^{n-1}
y_j^{-j/n},\]</span> so that <span class="math display">\[a_{m+1} =
\prod_{j \leq m} y_j^{-j/n} \prod_{j &gt; m} y_j^{(n-j)/n}.\]</span>
Using the definition <span class="math inline">\(y_i = a_i /
a_{i+1}\)</span>, we compute moreover that <span
class="math display">\[a_1 \dotsb a_m = y_1 y_2^2 \dotsb y_m^m a_{m+1}^m
= \prod_{j \leq m} y_j^{j ( 1 - m/n)} \prod_{j &gt; m}
y_j^{(n-j)/n}.\]</span> Recall, finally, that <span
class="math display">\[\delta(a(y)) = \prod_{j} y_j^{j ( n -
j)}.\]</span> We obtain in summary that <a
href="#eq:frac1a_n-dotsb-a_m+1" data-reference-type="eqref"
data-reference="eq:frac1a_n-dotsb-a_m+1">\((15)\)</a>
holds with <span class="math display">\[j \leq m \implies \beta_j =
j(n-j) - j(1-m/n) = j(n - j - 1 + m/n),\]</span> <span
class="math display">\[j &gt; m \implies \beta_j = j(n-j) - (n-j)/n =
(n-j) (j - 1/n).\]</span> In either case, since <span
class="math inline">\(1 \leq j \leq n-1\)</span>, we have <span
class="math inline">\(\beta_j &gt; 0\)</span>, as required. ◻</p>
</span></div>
<div id="exe:1" class="exercise">
<p><strong>Exercise 9</strong>. Show that <span
class="math display">\[\mathbb{E}_{L} (|L \cap B_R| - 1)^2 =
\infty.\]</span></p>
</div>
<div class="remark">
<p><strong>Remark 25</strong>. In the case <span
class="math inline">\(n=2\)</span>, the calculations of Lemma <a
href="#lem:we-have--1" data-reference-type="ref"
data-reference="lem:we-have--1">24</a> and Exercise <a href="#exe:1"
data-reference-type="ref" data-reference="exe:1">9</a> boil down to the
following (cf. Exercise <a href="#exe:2" data-reference-type="ref"
data-reference="exe:2">7</a>): <span class="math display">\[\int _{y =
\sqrt{3}/2}^{\infty} y^{1/2} \frac{d y}{y^2} &lt; \infty, \quad \int _{y
= \sqrt{3}/2}^{\infty} y \frac{d y}{y^2} = \infty.\]</span></p>
</div>
<p>Next, for a measurable function <span
class="math inline">\(f\)</span> on <span
class="math inline">\(\mathbb{R}^n\)</span>, define (if convergent)
<span class="math inline">\(\mathop{\mathrm{Eis}}[f] : X_n^{(1)}
\rightarrow \mathbb{C}\)</span> by <span
class="math inline">\(\mathop{\mathrm{Eis}}[f](L) := \sum _{0 \neq v \in
L} f(v)\)</span>. Taking for <span class="math inline">\(f\)</span> the
characteristic function <span class="math inline">\(1_{\Omega}\)</span>
of a set <span class="math inline">\(\Omega\)</span> as above, we then
have <span class="math inline">\(\mathop{\mathrm{Eis}}[1_{\Omega}](L) =
|L \cap \Omega| - 1\)</span>.</p>
<p>Suppose now that <span class="math inline">\(f \in
C_c(\mathbb{R}^n)\)</span>. The sums defining <span
class="math inline">\(\mathop{\mathrm{Eis}}[f]\)</span> are then finite.
Lemma <a href="#lem:we-have--1" data-reference-type="ref"
data-reference="lem:we-have--1">24</a> (applied with <span
class="math inline">\(R\)</span> large enough that <span
class="math inline">\(B_R\)</span> contains the support of <span
class="math inline">\(f\)</span>) implies that <span
class="math inline">\(\mathop{\mathrm{Eis}}[f]\)</span> defines an
integrable function on <span class="math inline">\(X_n^{(1)}\)</span>.
The map <span class="math display">\[C_c(\mathbb{R}^n) \ni f \mapsto
\mathbb{E} _{L} \mathop{\mathrm{Eis}}[f](L),\]</span> being finite on
its domain and nonnegative whenever <span
class="math inline">\(f\)</span> is, defines a measure <span
class="math inline">\(\mu\)</span> on <span
class="math inline">\(\mathbb{R}^n\)</span>.</p>
<p>For <span class="math inline">\(g \in
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>, set <span
class="math inline">\(R(g) f(v) := f(v g)\)</span>. Then <span
class="math inline">\(\mathop{\mathrm{Eis}}[R(g) f](L) =
\mathop{\mathrm{Eis}}(f)(L g)\)</span>. Thus the <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>-invariance
of the Haar measure on <span class="math inline">\(X_n^{(1)}\)</span>
implies the <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>-invariance
of <span class="math inline">\(\mu\)</span>.</p>
<p>By arguments similar to those used to establish the uniqueness
properties of Haar measure, one can verify that any <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>-invairant
measure <span class="math inline">\(\mu\)</span> on <span
class="math inline">\(\mathbb{R}^n\)</span> is of the form <span id="eq:mu-=-c" class="math display">\[\label{eq:mu-=-c}\tag{16}
  \mu = c _0 \delta _0 + c _1  \lambda,\]</span> where <span
class="math inline">\(c_0,c_1\)</span> are scalars, <span
class="math inline">\(\delta\)</span> is the <span
class="math inline">\(\delta\)</span>-mass at the origin, and <span
class="math inline">\(\lambda\)</span> denotes Lebesgue measure. The
main point in completing the proof is to verify that <span
class="math inline">\(c_0 = 0\)</span> and <span
class="math inline">\(c_1 = 1\)</span>.</p>
<div id="lem:c_1-=-1" class="lemma">
<p><strong>Lemma 26</strong>. <span class="math inline">\(c_1 =
1\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We consider the <span class="math inline">\(R
\rightarrow \infty\)</span> asymptotics of <span
class="math inline">\(\mu(f_R)\)</span>, where <span
class="math inline">\(f_R\)</span> denotes the normalized characteristic
function of <span class="math inline">\(B_R\)</span>, i.e., <span
class="math inline">\(f_R = 1_{B_R} /
\mathop{\mathrm{vol}}(B_R)\)</span>. We see first from Lemma <a
href="#lem:we-have--1" data-reference-type="ref"
data-reference="lem:we-have--1">24</a> that <span
class="math inline">\(\limsup_{R \rightarrow \infty} \mu(f_R) &lt;
\infty\)</span>.</p>
<p>On the other hand, for each unimodular lattice <span
class="math inline">\(L\)</span>, it follows from Riemann integration in
<span class="math inline">\(\mathbb{R}^n\)</span> that <span
class="math inline">\(\mathop{\mathrm{Eis}}[f_R](L) \rightarrow
1\)</span> as <span class="math inline">\(R \rightarrow \infty\)</span>.
(Indeed, <span
class="math inline">\(\mathop{\mathrm{Eis}}[f_R](L)\)</span> is one less
than the number of points of <span class="math inline">\(L\)</span> in
the ball <span class="math inline">\(B_R\)</span>, divided by the volume
of <span class="math inline">\(B_R\)</span>. Equivalently, it is one
less than the number of points of the rescaled lattice <span
class="math inline">\(R^{-1} L\)</span> in the ball <span
class="math inline">\(B_1\)</span>, divided by <span
class="math inline">\(R^n \mathop{\mathrm{vol}}(B_1)\)</span>. Since
<span class="math inline">\(L\)</span> is unimodular, the count <span
class="math inline">\(R^{-n} | R^{-1} L \cap B_1 |\)</span> is a Riemann
sum approximation to the volume of <span
class="math inline">\(B_1\)</span>. Thus <span
class="math inline">\(\mathop{\mathrm{Eis}}[f_R](L) \rightarrow
1\)</span>.)</p>
<p>We see moreover from the proof of lemma <a href="#lem:we-have--1"
data-reference-type="ref" data-reference="lem:we-have--1">24</a> that
the functions <span
class="math inline">\(\mathop{\mathrm{Eis}}[f_R]\)</span> are all
majorized on the standard Siegel domain by the same integrable function,
a constant multiple of <span class="math inline">\(\max_{1 \leq m \leq
n} a_1 \dotsb a_m\)</span>. By the dominated convergence theorem, we
deduce that <span class="math inline">\(\mu(f_R) = \mathbb{E}_{L}
\mathop{\mathrm{Eis}}[f_R](L) \rightarrow 1\)</span> as <span
class="math inline">\(R \rightarrow \infty\)</span>.</p>
<p>On the other hand, it is clear from <a href="#eq:mu-=-c"
data-reference-type="eqref" data-reference="eq:mu-=-c">\((16)\)</a>
that <span class="math inline">\(\mu(f_R) \rightarrow c_1\)</span> as
<span class="math inline">\(R \rightarrow \infty\)</span>. Therefore
<span class="math inline">\(c_1 = 1\)</span>. ◻</p>
</span></div>
<div class="lemma">
<p><strong>Lemma 27</strong>. <span class="math inline">\(c_0 =
0\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> The proof is similar to that of lemma <a
href="#lem:c_1-=-1" data-reference-type="ref"
data-reference="lem:c_1-=-1">26</a>, but we instead consider the
behavior as <span class="math inline">\(R \rightarrow 0\)</span> of
<span class="math inline">\(\mu(f_R)\)</span> with <span
class="math inline">\(f_R := 1_{B_R}\)</span> the unnormalized
characteristic function. We see as before that the <span
class="math inline">\(\mathop{\mathrm{Eis}}[f_R]\)</span> are majorized
by a common integrable function. On the other hand, for each unimodular
lattice <span class="math inline">\(L\)</span>, we have <span
class="math inline">\(\mathop{\mathrm{Eis}}[f_R](L) \rightarrow
0\)</span> as <span class="math inline">\(R \rightarrow 0\)</span>.
Therefore <span class="math inline">\(\mu(f_R) = \mathbb{E}_L
\mathop{\mathrm{Eis}}[f_R](L)\)</span> converges to <span
class="math inline">\(0\)</span> as <span class="math inline">\(R
\rightarrow \infty\)</span>. On the other hand, it also converges to
<span class="math inline">\(c_0\)</span>. ◻</p>
</span></div>
<h2 id="sec:conv-eisenst-seri">§2.8. Convergence of Eisenstein series</h2>
<p>Here I largely follow the exposition of Borel <a href="#ref-MR2331343" class="citation"
data-cites="MR2331343">(Borel 2007, secs. 11–12)</a>.</p>
<h3 id="statement-of-result">Statement of result</h3>
<p>Let <span class="math inline">\((G,\Gamma)\)</span> be either <span
class="math display">\[({\mathop{\mathrm{GL}}}_n(\mathbb{R}),
{\mathop{\mathrm{GL}}}_n(\mathbb{Z})) \text{ or }
({\mathop{\mathrm{SL}}}_n(\mathbb{R}),
{\mathop{\mathrm{SL}}}_n(\mathbb{Z})).\]</span> We write as usual <span
class="math inline">\(G = N A K\)</span> for the Iwasawa decomposition,
here with <span class="math inline">\(A\)</span> the group of diagonal
matrices having positive entries.</p>
<p>Each <span class="math inline">\(n\)</span>-tuple <span
class="math inline">\(s = (s_1,\dotsc,s_n) \in \mathbb{C}^n\)</span> of
complex numbers defines a character of <span
class="math inline">\(A\)</span>, i.e., a continuous homomorphism <span
class="math inline">\(A \rightarrow \mathbb{C}^\times\)</span>, given by
<span class="math display">\[a \mapsto a^s := a_1^{s_1} \dotsb
a_n^{s_n}.\]</span> This character extends to a character of the group
<span class="math inline">\(B = N A\)</span>, given by <span
class="math inline">\(u a \mapsto a^s\)</span>, having trivial
restriction to the subgroup <span class="math inline">\(\Gamma_B :=
\Gamma \cap B\)</span> of elements with integral entries.</p>
<div class="definition">
<p><strong>Definition 28</strong>. We call <span class="math inline">\(s
\in \mathbb{C}^n\)</span> <em>dominant</em> if <span
class="math display">\[\Re(s_1) \geq \dotsb \geq \Re(s_n)\]</span> and
<em>strictly dominant</em> if <span class="math display">\[\Re(s_1) &gt;
\dotsb &gt; \Re(s_n).\]</span></p>
</div>
<p>We recall from §<a href="#sec:org2326c58" data-reference-type="ref"
data-reference="sec:org2326c58">2.5</a> that the modulus character <span
class="math inline">\(\delta_B\)</span> of <span
class="math inline">\(B\)</span> is given by <span
class="math display">\[\delta(u a) = \prod_{i &lt; j} a_i / a_j =
a_1^{n-1} a_2^{n-3} \dotsb a_n^{1-n}.\]</span> With the notation
introduced above, we may write <span class="math inline">\(\delta(u a) =
a^{2 \rho}\)</span>, where <span class="math inline">\(\rho \in
\mathbb{R}^n\)</span> is the dominant element defined by <span
class="math display">\[\quad \rho = \left( \frac{n-1}{2}, \frac{n-3}{2},
\dotsc, \frac{1-n}{2} \right).\]</span></p>
<p>For <span class="math inline">\(g \in G\)</span>, let us write <span
class="math inline">\(a(g) \in A\)</span> for its Iwasawa component, so
that <span class="math inline">\(g \in N a(g) K\)</span>.</p>
<div id="thm:convergence-eisenstein-series" class="theorem">
<p><strong>Theorem 29</strong>. <em>For <span class="math inline">\(s
\in \mathbb{C}^n\)</span> with <span class="math inline">\(s - 2
\rho\)</span> strictly dominant and <span class="math inline">\(g \in
G\)</span>, the series <span class="math display">\[\sum _{\gamma \in
\Gamma_B \backslash \Gamma } a(\gamma g)^{s}\]</span> converges
absolutely, locally uniformly.</em></p>
</div>
<p>We note that, since the character <span class="math inline">\(B \ni u
a \mapsto a^s\)</span> has trivial restriction to <span
class="math inline">\(\Gamma_B\)</span>, the function <span
class="math inline">\(\Gamma \ni \gamma \mapsto a(\gamma g)^s\)</span>
is left-invariant under <span class="math inline">\(\Gamma_B\)</span>.
Thus the terms in the above series are well-defined.</p>
<div class="corollary">
<p><strong>Corollary 30</strong>. <em>For given <span
class="math inline">\(g\)</span>, the above series defines a holomorphic
of <span class="math inline">\(s\)</span> in the indicated
domain.</em></p>
</div>
<p>The idea of the proof, developed leisurely over the next few
subsections, is to compare the sum to an integral.</p>
<div class="exercise">
<p><strong>Exercise 10</strong>. Assuming that the theorem holds for
<span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>, deduce it for <span
class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>.</p>
</div>
<p>We henceforth focus on the case <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>.</p>
<h3 id="sec:recap-finite-dimens">§2.8.2. Recap on the finite-dimensional
representation theory of <span
class="math inline">\({\mathop{\mathrm{SL}}}_n\)</span></h3>
<p>Here we recall the classification of finite-dimensional
representations of <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>. The full contents of this
section are not necessary for our immediate aims, but help place some of
our arguments in context.</p>
<div class="definition">
<p><strong>Definition 31</strong>. By a <em>weight</em> we mean an
equivalence class of elements <span
class="math inline">\(\omega\)</span> of <span
class="math inline">\(\mathbb{Z}^n\)</span>, with two such elements
declared equivalent if their difference is a multiple of <span
class="math inline">\((1,1,\dotsc,1)\)</span>.</p>
</div>
<p>We observe that if two elements of <span
class="math inline">\(\mathbb{Z}^n\)</span> are equivalent, then they
define the same character of <span class="math inline">\(A \leq
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>, since any element <span
class="math inline">\(a \in A\)</span> satisfies <span
class="math inline">\(a_1 \dotsb a_n = 1\)</span>. The map <span
class="math inline">\(\omega \mapsto [a \mapsto a^\omega]\)</span>
identifies weights with polynomial characters of <span
class="math inline">\(A\)</span>.</p>
<div class="example">
<p><strong>Example 32</strong>. For <span class="math inline">\(1 \leq m
\leq n-1\)</span>, the element <span class="math display">\[\beta_m :=
(\underbrace{1,\dotsc,1}_{m},0,\dotsc,0) : a \mapsto a_1 \dotsb
a_m\]</span> is a nontrivial dominant weight. These are called the
<em>fundamental weights</em>.</p>
</div>
<div class="exercise">
<p><strong>Exercise 11</strong>. The set of weights is a free <span
class="math inline">\(\mathbb{Z}\)</span>-module with basis given by the
set <span class="math inline">\(\{\beta_1, \dotsc,
\beta_{m-1}\}\)</span> of fundamental weights. A weight <span
class="math inline">\(\omega\)</span> is dominant iff <span
class="math inline">\(\omega \in \sum_{m} \mathbb{Z}_{\geq 0}
\beta_m\)</span>.</p>
</div>
<div class="definition">
<p><strong>Definition 33</strong>. We say that <span
class="math inline">\(a \in A\)</span> is <em>dominant</em> if <span
class="math inline">\(a_1 \geq \dotsb \geq a_n\)</span>. Given weights
<span class="math inline">\(\omega_1\)</span> and <span
class="math inline">\(\omega_2\)</span>, we say that <span
class="math inline">\(\omega_1\)</span> is <em>higher than</em> <span
class="math inline">\(\omega_2\)</span>, and write <span
class="math inline">\(\omega_1 \geq \omega_2\)</span>, if <span
class="math inline">\(a^{\omega_1} \geq a^{\omega_2}\)</span> for all
dominant <span class="math inline">\(a \in A\)</span>. We say that a
weight <span class="math inline">\(\omega\)</span> is <em>positive</em>
if <span class="math inline">\(\omega \geq 0\)</span>.</p>
</div>
<p>The relation <span class="math inline">\(\omega_1 \geq
\omega_2\)</span> defines a partial order on the set of weights. We note
that if <span class="math inline">\(\omega\)</span> is dominant, then it
is positive, but not conversely; for instance, <span
class="math inline">\(\omega = (1,-1,0)\)</span> is positive but not
dominant.</p>
<div class="definition">
<p><strong>Definition 34</strong>. By a <em>representation</em> of <span
class="math inline">\(G = {\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>,
we mean a pair <span class="math inline">\((\sigma,V)\)</span>, where
<span class="math inline">\(V\)</span> is a finite-dimensional complex
vector space and <span class="math inline">\(\sigma : G \rightarrow
\mathop{\mathrm{GL}}(V)\)</span> is a continuous homomorphism. Such a
representation is <em>irreducible</em> if it is nonzero and if it has,
other than <span class="math inline">\(\{0\}\)</span> and <span
class="math inline">\(V\)</span>, no invariant subspaces (i.e.,
subspaces <span class="math inline">\(W \leq V\)</span> with <span
class="math inline">\(\sigma(G) W \subseteq W\)</span>). As a matter of
notation, one often abbreviates <span class="math inline">\(g v :=
\sigma(g) v\)</span> for <span class="math inline">\(g \in G\)</span>
and <span class="math inline">\(v \in V\)</span> when the homomorphism
<span class="math inline">\(\sigma\)</span> is understood from
context.</p>
</div>
<div class="definition">
<p><strong>Definition 35</strong>. Let <span
class="math inline">\((\sigma,V)\)</span> be a representation of <span
class="math inline">\(G\)</span>. A nonzero vector <span
class="math inline">\(v \in V\)</span> is said to be a <em>weight vector
of weight <span class="math inline">\(\omega\)</span></em> if <span
class="math inline">\(\sigma(a) v = a^{\omega} v\)</span> for all <span
class="math inline">\(a \in A\)</span>.</p>
</div>
<div class="example">
<p><strong>Example 36</strong>. The <em>standard representation</em>
<span class="math inline">\((\sigma,V)\)</span> is <span
class="math inline">\(V = \mathbb{C}^n\)</span>, with <span
class="math inline">\(\sigma\)</span> the “identity” map. The standard
basis vectors <span class="math inline">\(e_1,e_2,\dotsc,e_n\)</span>
satisfy <span class="math display">\[a e_j = a_j e_j\]</span> and are
thus weight vectors, with weights <span class="math inline">\(\beta_1 =
(1,0,\dotsc,0), (0,1,0,\dotsc,0), 0,\dotsc,0,1)\)</span>. Note that the
weight of <span class="math inline">\(e_1\)</span> is higher than the
weights of all the other basis elements.</p>
</div>
<div id="example:stoes2021:more-generally-1" class="example">
<p><strong>Example 37</strong>. More generally, for <span
class="math inline">\(1 \leq m \leq n-1\)</span>, the <span
class="math inline">\(m\)</span>th exterior power <span
class="math inline">\(\Lambda^m \mathbb{C}^n\)</span> of the standard
representation admits the basis of weight vectors <span
class="math display">\[e_{i_1} \wedge \dotsb \wedge e _{i _m} \quad (1
\leq i_1 &lt; \dotsb &lt; i_m \leq n)\]</span> with weights given by
elements of <span class="math inline">\(\mathbb{Z}^n\)</span> consisting
of <span class="math inline">\(m\)</span> ones and <span
class="math inline">\(n-m\)</span> zeros, corresponding to the
characters <span class="math inline">\(a \mapsto a_{i_1} \dotsb
a_{i_m}\)</span>. The vector <span class="math inline">\(e_1 \wedge
\dotsb \wedge e_m\)</span> has weight <span
class="math inline">\(\beta_m\)</span>, which is higher than all the
other weights.</p>
</div>
<p>The previous examples are special cases of a more general result,
most of which is known as the theorem of the highest weight.</p>
<div class="theorem">
<p><strong>Theorem 38</strong>. <em>For each dominant weight <span
class="math inline">\(\omega\)</span>, there is an irreducible
representation <span
class="math inline">\((\sigma_\omega,V_\omega)\)</span>, unique up to
isomorphism, with the following properties.</em></p>
<ol>
<li><p><em><span class="math inline">\(V_\omega\)</span> contains a
unique (up to scaling) weight vector <span
class="math inline">\(e_\omega\)</span> of weight <span
class="math inline">\(\omega\)</span> that is moreover <span
class="math inline">\(N\)</span>-invariant.</em></p></li>
<li><p><em><span class="math inline">\(V_\omega\)</span> admits a basis
of weight vectors of weight <span class="math inline">\(\leq
\omega\)</span>.</em></p></li>
</ol>
<p><em>This association defines a bijection <span
class="math display">\[\{\text{dominant weights}\} \leftrightarrow
\{\text{irreducible representations up to isomorphism}\}.\]</span> Each
<span class="math inline">\(V_\omega\)</span> admits an “integral
structure,” i.e., a <span
class="math inline">\(\mathbb{Z}\)</span>-submodule <span
class="math inline">\(E_\omega \subseteq V_\omega\)</span> which is
invariant by <span class="math inline">\(\Gamma =
{\mathop{\mathrm{SL}}}_n(\mathbb{Z})\)</span> and for which <span
class="math inline">\(V_{\omega} = E_{\omega} \otimes_{\mathbb{Z}}
\mathbb{C}\)</span>. We can choose <span
class="math inline">\(e_\omega\)</span> to lie in <span
class="math inline">\(E_\omega\)</span>.</em></p>
</div>
<p>The weight <span class="math inline">\(\omega\)</span> is referred to
as the highest weight of the representation, and <span
class="math inline">\(e_\omega\)</span> as a highest weight vector.</p>
<div id="example:stoes2021:suppose-that-omega" class="example">
<p><strong>Example 39</strong>. Suppose that <span
class="math inline">\(\omega = \beta_m\)</span> is a fundamental weight.
Then, following Example <a href="#example:stoes2021:more-generally-1"
data-reference-type="ref"
data-reference="example:stoes2021:more-generally-1">37</a>, we may take
<span class="math inline">\(V_\omega = \Lambda^m \mathbb{C}^n\)</span>.
An integral structure <span class="math inline">\(E_\omega\)</span> is
given by <span class="math inline">\(\mathbb{Z}\)</span>-span of the
basis elements <span class="math inline">\(e_{i_1} \wedge \dotsb \wedge
e_{i_m}\)</span>. The highest weight vector <span
class="math inline">\(e_\omega := e_1 \wedge \dotsb \wedge e_m\)</span>
then lies in <span class="math inline">\(E_\omega\)</span>.</p>
</div>
<p>We equip each such <span class="math inline">\(V_\omega\)</span> with
a <span class="math inline">\(K\)</span>-invariant inner product, hence
a <span class="math inline">\(K\)</span>-invariant Euclidean norm. By
the discreteness of the submodule <span
class="math inline">\(E_\omega\)</span>, we see that the numbers <span
class="math inline">\(\|v\|\)</span> for <span class="math inline">\(0
\neq v \in E_\omega\)</span> are bounded away from zero. For instance,
in the setting of Example <a
href="#example:stoes2021:suppose-that-omega" data-reference-type="ref"
data-reference="example:stoes2021:suppose-that-omega">39</a>, we may
take the inner product with respect to which the indicated basis is
orthonormal; we then have <span class="math inline">\(\|v\| \geq
1\)</span> for all <span class="math inline">\(0 \neq v \in
E_\omega\)</span>. We assume that the highest weight vector <span
class="math inline">\(e_\omega\)</span> is a unit vector. We then have
the following useful formula:</p>
<div id="lem:stoes2021:agomega-=-g" class="lemma">
<p><strong>Lemma 40</strong>. <span class="math inline">\(a(g)^{\omega}
= \|g^{-1} e_\omega \|^{-1}\)</span> for all <span
class="math inline">\(g \in G\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Write <span class="math inline">\(g = u a k\)</span>.
Then <span class="math inline">\(g^{-1} e_\omega = k^{-1} a^{-1} u^{-1}
e_\omega\)</span>. Recalling that</p>
<ul>
<li><p><span class="math inline">\(u^{-1} e_\omega =
e_\omega\)</span>,</p></li>
<li><p><span class="math inline">\(a^{-1} e_\omega = a^{-\omega}
e_\omega\)</span>,</p></li>
<li><p><span class="math inline">\(\|.\|\)</span> is <span
class="math inline">\(K\)</span>-invariant, and</p></li>
<li><p><span class="math inline">\(e_\omega\)</span> is a unit
vector,</p></li>
</ul>
<p>we obtain <span class="math display">\[\|g^{-1} e_\omega \| =
\|k^{-1} a^{-1} e_\omega \| = a^{-\omega} \|k^{-1} e_\omega \| =
a^{-\omega},\]</span> as required. ◻</p>
</span></div>
<h3 id="geometric-lemmas">Geometric lemmas</h3>
<div id="lem:stoes2021:each-dominant-weight" class="lemma">
<p><strong>Lemma 41</strong>. For each dominant weight <span
class="math inline">\(\omega\)</span> and each <span
class="math inline">\(\gamma \in \Gamma\)</span>, we have <span
class="math inline">\(a(\gamma)^{\omega} \leq 1\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Since the dominant weights are nonnegative integral
combinations of the fundamental weights, it suffice to consider the case
that <span class="math inline">\(\omega\)</span> is a fundamental weight
<span class="math inline">\(\beta_m\)</span>. We’ve seen then that <span
class="math inline">\(\|v\| \geq 1\)</span> for all <span
class="math inline">\(0 \neq v \in E_\omega\)</span>. Since <span
class="math inline">\(E_\omega\)</span> contains <span
class="math inline">\(e_\omega\)</span> and is <span
class="math inline">\(\Gamma\)</span>-invariant, we have in particular
<span class="math inline">\(\|\gamma^{-1} e_\omega \| \geq 1\)</span>
for all <span class="math inline">\(\gamma \in \Gamma\)</span>. The
required inequality follows now from Lemma <a
href="#lem:stoes2021:agomega-=-g" data-reference-type="ref"
data-reference="lem:stoes2021:agomega-=-g">40</a>. ◻</p>
</span></div>
<div class="example">
<p><strong>Example 42</strong>. Take <span class="math inline">\(n =
2\)</span> and <span class="math inline">\(\gamma =
  \begin{pmatrix}
    a &amp; b \\
    c &amp; d
  \end{pmatrix}
  \in \Gamma = {\mathop{\mathrm{SL}}}_2(\mathbb{Z})\)</span>. One can
check directly that <span class="math display">\[a (\gamma ) =
    \begin{pmatrix}
      1/ \sqrt{c^2 + d^2} &amp; 0 \\
      0 &amp; \sqrt{c^2 + d^2}
    \end{pmatrix}
    , \quad a(\gamma)^{\beta_1} = 1/ \sqrt{c^2 + d^2}.\]</span> In the
setting of the above proof, this amounts to noting that <span
class="math display">\[\gamma^{-1} =
    \begin{pmatrix}
      d &amp; -b \\
      -c &amp; a
    \end{pmatrix}
    , \quad \gamma^{-1} e_1 =
    \begin{pmatrix}
      d  \\
      -c
    \end{pmatrix}
    , \|\gamma^{-1} e_1\| = \sqrt{c^2 + d^2}.\]</span> The inequality
<span class="math inline">\(a(\gamma)^{\beta_1} \leq 1\)</span> thus
amounts to that <span class="math inline">\(c^2 + d^2 \geq 1\)</span>
for integers <span class="math inline">\(c\)</span> and <span
class="math inline">\(d\)</span>, not both zero.</p>
</div>
<div class="definition">
<p><strong>Definition 43</strong>. The <em>negative cone</em> <span
class="math inline">\({}^-A \subseteq A\)</span> is defined by <span
class="math display">\[{}^- A := \{a \in A : a^{\omega} \leq 1 \text{
for all dominant weights } \omega \}.\]</span></p>
</div>
<p>Using the relation between dominant and fundamental weights, we see
that <span class="math inline">\({}^- A\)</span> may be described by the
smaller set of conditions <span class="math display">\[a^{\beta_m} = a_1
\dotsb a_m \leq 1 \quad \text{ for } 1 \leq m \leq n-1.\]</span></p>
<div class="corollary">
<p><strong>Corollary 44</strong> (of Lemma <a
href="#lem:stoes2021:each-dominant-weight" data-reference-type="ref"
data-reference="lem:stoes2021:each-dominant-weight">41</a>). <em>For
each <span class="math inline">\(\gamma \in \Gamma\)</span>, we have
<span class="math inline">\(a(\gamma ) \in {}^- A\)</span>.</em></p>
</div>
<div class="exercise">
<p><strong>Exercise 12</strong>. Let <span
class="math inline">\(\mathfrak{S} \subseteq G\)</span> be a Siegel
domain. Let <span class="math inline">\(\omega\)</span> be a dominant
weight. Verify that <span class="math display">\[a(g x)^{\omega} \ll
a(g)^{\omega} a(x)^{\omega} \quad \text{ for all } g \in G, x \in
\mathfrak{S},\]</span> where the implied constant may depend upon <span
class="math inline">\((n,\mathfrak{S},\omega)\)</span> but not <span
class="math inline">\((g,x)\)</span>.</p>
<p>[Hint: using the Iwasawa decomposition, reduce to the case <span
class="math inline">\(g \in K\)</span>, then further to the case that
<span class="math inline">\(g\)</span> lies in a fixed compact set and
<span class="math inline">\(x\)</span> is a dominant element of <span
class="math inline">\(A\)</span>. Then apply Lemma <a
href="#lem:stoes2021:agomega-=-g" data-reference-type="ref"
data-reference="lem:stoes2021:agomega-=-g">40</a>.]</p>
</div>
<div class="exercise">
<p><strong>Exercise 13</strong>. Interpret the result of the previous
exercise as follows. Let <span class="math inline">\(L\)</span> be a
unimodular lattice. Let <span class="math inline">\(1 \leq m \leq
n-1\)</span>.</p>
<ol type="i">
<li><p>With notation as in Theorem <a
href="#thm:existence-reduced-basis" data-reference-type="ref"
data-reference="thm:existence-reduced-basis">9</a>,
let <span class="math inline">\(v_n,\dotsc,v_1\)</span> be a reduced
basis of <span class="math inline">\(L\)</span> (it will be convenient
to reverse the usual numbering) and <span class="math inline">\(a_j :=
|v_j&#39;|\)</span> the corresponding Iwasawa coordinates, so that <span
class="math inline">\(a_1 \ll \dotsb \ll a_n\)</span>. Verify that <span
class="math inline">\(a_1 \dotsb a_m\)</span> is the covolume of the
lattice <span class="math inline">\(\oplus_{j=1}^m \mathbb{Z}
v_j\)</span> (inside its real span, equipped with the volume form
induced by the restriction of the standard Euclidean metric on <span
class="math inline">\(\mathbb{R}^n\)</span>).</p></li>
<li><p>Let <span class="math inline">\(w_1,\dotsc,w_n\)</span> be any
basis of <span class="math inline">\(L\)</span>. Show that the covolume
of the lattice <span class="math inline">\(\oplus_{j=1}^m \mathbb{Z}
w_j\)</span> is <span class="math inline">\(\gg a_1 \dotsb
a_m\)</span>.</p></li>
</ol>
<p>Thus a reduced basis <span
class="math inline">\(v_n,\dotsc,v_1\)</span> simultaneously minimizes
(up to constants) the covolumes of each of the lattices <span
class="math inline">\(\oplus_{j=1}^m \mathbb{Z} v_j\)</span> for <span
class="math inline">\(1 \leq m \leq n-1\)</span>.</p>
</div>
<p>It may be instructive at this point to draw a picture depicting the
various conditions in play here.</p>
<figure>
<img src="map-A-SL3.png" />
<figcaption> A “map” of the diagonal subgroup <span
class="math inline">\(A \leq
{\mathop{\mathrm{SL}}}_3(\mathbb{R})\)</span>. </figcaption>
</figure>
<p>One more easy lemma:</p>
<div id="lem:stoes2021:let-omega-be" class="lemma">
<p><strong>Lemma 45</strong>. Let <span
class="math inline">\(\Omega\)</span> be a compact subset of <span
class="math inline">\(G\)</span>. Then there is a compact subset <span
class="math inline">\(\Omega _A\)</span> of <span
class="math inline">\(A\)</span> so that <span class="math inline">\(a(x
g) \in a(x) \Omega_A\)</span> for all <span class="math inline">\(x \in
G\)</span> and <span class="math inline">\(g \in \Omega\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By enlarging <span
class="math inline">\(\Omega\)</span> if necessary, we may assume that
it is closed under left and right multiplication by the compact subgroup
<span class="math inline">\(K\)</span> of <span
class="math inline">\(G\)</span>. Write <span class="math inline">\(x =
u a k\)</span> (Iwasawa decomposition). Then <span
class="math inline">\(x g = u a k g\)</span> with <span
class="math inline">\(k g \in \Omega\)</span>. By the Iwasawa
decomposition, we may find a compact subset <span
class="math inline">\(\Omega_A \subseteq A\)</span> so that <span
class="math inline">\(\Omega \subseteq N \Omega_A K\)</span>. Then <span
class="math inline">\(k g\)</span> admits the Iwasawa decomposition
<span class="math inline">\(u&#39; a&#39; k&#39;\)</span> with <span
class="math inline">\(a&#39; \in \Omega_A\)</span>. We have <span
class="math inline">\(x g = u (a u&#39; a^{-1}) a a&#39;
k&#39;\)</span>. Since <span class="math inline">\(A\)</span> normalizes
<span class="math inline">\(N\)</span>, this shows that <span
class="math inline">\(a(x g) = a a&#39; \in a \Omega_A\)</span>, as
required. ◻</p>
</span></div>
<h3 id="proof-of-theorem-thm2">Proof of Theorem <a href="#thm:2"
data-reference-type="ref" data-reference="thm:2">21</a></h3>
<p>We must show that if <span class="math inline">\(g\)</span> belongs
to a fixed compact subset of <span class="math inline">\(G\)</span> and
<span class="math inline">\(s\)</span> belongs to a fixed compact subset
of the region <span class="math inline">\(\{s : s - 2 \rho \text{
strictly dominant}\}\)</span>, then <span class="math inline">\(\sum
_{\gamma \in \Gamma_B \backslash \Gamma } a(\gamma g)^s \ll
1\)</span>.</p>
<p>By Lemma <a href="#lem:stoes2021:let-omega-be"
data-reference-type="ref"
data-reference="lem:stoes2021:let-omega-be">45</a>, we have for <span
class="math inline">\(g\)</span> and <span
class="math inline">\(s\)</span> as above and all <span
class="math inline">\(\gamma \in \Gamma\)</span> the estimate <span
class="math display">\[a(\gamma g) ^s  \asymp a (\gamma) ^s\]</span>
Moreover, if <span class="math inline">\(s\)</span> lies in <span
class="math inline">\(\mathbb{R}^n\)</span>, then each of the above
quantities is positive. The theorem will thus follow if we can show that
for each <span class="math inline">\(s \in \mathbb{R}^n\)</span> with
<span class="math inline">\(s - 2 \rho\)</span> strictly dominant, <span
class="math display">\[\sum _{\gamma \in \Gamma_B \backslash \Gamma } a
(\gamma ) ^s &lt; \infty.\]</span></p>
<p>Since the subgroup <span class="math inline">\(\Gamma\)</span> of
<span class="math inline">\(G\)</span> is discrete, we may find a
nonempty bounded neighborhood <span class="math inline">\(\Omega
\subseteq G\)</span> of the identity element such that the translates
<span class="math inline">\(\gamma \Omega\)</span> for <span
class="math inline">\(\gamma \in \Gamma\)</span> are disjoint from one
another. By another application of Lemma <a
href="#lem:stoes2021:let-omega-be" data-reference-type="ref"
data-reference="lem:stoes2021:let-omega-be">45</a>, we have <span
class="math display">\[a(\gamma)^s \asymp a(\gamma g)^s\]</span> for all
<span class="math inline">\(\gamma \in \Gamma\)</span> and <span
class="math inline">\(g \in \Omega\)</span>. We thereby reduce to
verifying that <span class="math display">\[\int _{g \in \Omega }\sum
_{\gamma \in \Gamma_B \backslash \Gamma } a (\gamma g ) ^s \, d g &lt;
\infty.\]</span></p>
<p>The sets <span class="math inline">\(\Gamma_B \gamma \Omega\)</span>
for coset representatives <span class="math inline">\(\gamma \in
\Gamma_B \backslash \Gamma\)</span> are disjoint from one another, so it
is enough to verify that <span class="math display">\[\int _{g \in
\Gamma_B \backslash \Gamma \Omega} a (g) ^s \,d g &lt; \infty ,\]</span>
where now <span class="math inline">\(d g\)</span> denotes the quotient
Haar measure on <span class="math inline">\(\Gamma _B \backslash
G\)</span>.</p>
<p>Let <span class="math inline">\(\gamma \in \Gamma\)</span> and <span
class="math inline">\(g \in \Omega\)</span>. Let <span
class="math inline">\(\omega\)</span> be a dominant weight. By Lemma <a
href="#lem:stoes2021:let-omega-be" data-reference-type="ref"
data-reference="lem:stoes2021:let-omega-be">45</a>, we have <span
class="math inline">\(a(\gamma g)^{\omega} \ll a(\gamma)^{\omega}
a(g)^{\omega}\)</span>. Recalling from Lemma <a
href="#lem:stoes2021:each-dominant-weight" data-reference-type="ref"
data-reference="lem:stoes2021:each-dominant-weight">41</a> that <span
class="math inline">\(a(\gamma)^{\omega} \leq 1\)</span> and from, e.g.,
Lemma <a href="#lem:stoes2021:let-omega-be" data-reference-type="ref"
data-reference="lem:stoes2021:let-omega-be">45</a> that <span
class="math inline">\(a(\gamma)^{\omega} \ll 1\)</span>, we obtain <span
class="math display">\[a(\gamma g)^{\omega} \ll 1.\]</span></p>
<p>This last estimate tells us that each <span class="math inline">\(g
\in \Gamma \Omega\)</span> satisfies <span class="math inline">\(a(g)
\in c \cdot {}^- A\)</span> for some fixed <span class="math inline">\(c
\in A\)</span>, depending at most upon <span
class="math inline">\(\Omega\)</span>. In other words, <span
class="math display">\[\Gamma \Omega \subseteq N \cdot c \cdot {}^- A
\cdot K.\]</span> We thereby reduce to verifying that <span
class="math display">\[\int _{g \in \Gamma_B \backslash N \cdot c \cdot
{}^- A \cdot K} a(g)^s \, d g &lt; \infty.\]</span></p>
<p>We now recall from Example <a href="#exa:2" data-reference-type="ref"
data-reference="exa:2">20</a> that a Haar measure <span
class="math inline">\(d g\)</span> may be given in Iwasawa coordinates
<span class="math inline">\(g = u a k\)</span> by <span
class="math inline">\(d u \, \frac{d a}{a^{2 \rho}} \, d k\)</span>. The
quotient <span class="math inline">\(\Gamma_N \backslash N\)</span> is
compact because it is the image of the compact set <span
class="math inline">\(\{u \in N : |u_{i j}| \leq 1/2 \forall i &lt;
j\}\)</span>, as one verifies readily either directly or by adopting the
proof of Theorem <a href="#thm:existence-reduced-basis"
data-reference-type="ref"
data-reference="thm:existence-reduced-basis">9</a>.
The group <span class="math inline">\(K\)</span> is compact. We thereby
reduce to verifying the finiteness of <span class="math display">\[\int
_{a \in {}^- A}
  a^{s - 2 \rho}
  \, d a\]</span> whenever <span class="math inline">\(s - 2
\rho\)</span> is strictly dominant, where as usual <span
class="math inline">\(d a\)</span> denotes a Haar measure on <span
class="math inline">\(A\)</span>, e.g., that given by <span
class="math display">\[d a = \frac{d a _1 \dotsb d a _{n - 1}}{a_1
\dotsb a_{n-1}}.\]</span></p>
<p>At this point, we might as well substitute <span
class="math inline">\(s \mapsto s + 2 \rho\)</span> to reduce to
verifying that <span id="eq:int-_a-in" class="math display">\[\label{eq:int-_a-in}\tag{18}
  \int _{a \in {}^- A}
  a^{s}
  \, d a\]</span> is finite whenever <span
class="math inline">\(s\)</span> is strictly dominant.</p>
<p>To understand the last integral <a href="#eq:int-_a-in"
data-reference-type="eqref"
data-reference="eq:int-_a-in">\((18)\)</a>, we change coordinates
to <span class="math display">\[t_m = a_1 \dotsb a_m \quad (1 \leq m
\leq n - 1 ).\]</span> In these coordinates, the domain <span
class="math inline">\({}^- A\)</span> is described by the conditions
<span class="math inline">\(t_m \leq 1\)</span> for all <span
class="math inline">\(m\)</span>. Moreover, if define <span
class="math inline">\(\nu_1, \dotsc, \nu_{n-1}\)</span> by <span
class="math display">\[\nu_m := s_m - s_{m+1} &gt; 0,\]</span> then we
have <span class="math display">\[s_m = \nu_m + \nu_{m+1} + \dotsb +
\nu_{n-1} + s_n\]</span> and <span class="math display">\[a^s =
\prod_{m=1}^{n-1} t_m^{\nu_m}.\]</span> The integral <a
href="#eq:int-_a-in" data-reference-type="eqref"
data-reference="eq:int-_a-in">\((18)\)</a> of interest thus
factors as the product of one-dimensional integrals <span
class="math display">\[\int _{t_m = 0}^1 t_m^{\nu_m} \, \frac{d
t_m}{t_m},\]</span> each of which converge. The proof is thus
complete.</p>
<div class="exercise">
<p><strong>Exercise 14</strong>. For <span class="math inline">\(\gamma
\in \Gamma = {\mathop{\mathrm{SL}}}_n(\mathbb{Z})\)</span>, write <span
class="math inline">\(a_1(\gamma), \dotsc, a_n(\gamma) &gt; 0\)</span>
for the Iwasawa coordinates. Note that these depend only upon the coset
<span class="math inline">\(\Gamma_B \gamma\)</span>. For <span
class="math inline">\(1 \leq m \leq n-1\)</span>, define <span
class="math inline">\(t_m(\gamma) := a_1(\gamma) a_2(\gamma) \dotsb
a_m(\gamma)\)</span>.</p>
<p>Show that for <span class="math inline">\(X_1, \dotsc, X_{n-1} \geq
1\)</span>, <span class="math display">\[\# \left\{ \gamma \in \Gamma_B
\backslash \Gamma : t_m(\gamma) \geq 1/X_m \text{ for all } 1 \leq m
\leq n-1 \right\} \ll (X_1 \dotsb X_{n-1})^2.\]</span> Show also that
for <span class="math inline">\(X \geq 1\)</span>, <span
class="math display">\[\# \left\{ \gamma \in \Gamma_B \backslash \Gamma
: a_i(\gamma) / a_{i+1}(\gamma) \geq 1/X \text{ for all } 1 \leq i \leq
n-1 \right\} \ll X^p\]</span> for some <span class="math inline">\(p =
p(n) &gt; 0\)</span>.</p>
</div>
<div class="exercise">
<p><strong>Exercise 15</strong>. Let <span
class="math inline">\(\mathfrak{S} \leq G\)</span> be a Siegel domain,
and <span class="math inline">\(\Omega \subseteq G\)</span> a compact
subset.</p>
<ol>
<li><p>Show that there exists <span class="math inline">\(c \geq
1\)</span> with the following property. Let <span
class="math inline">\(x \in \mathfrak{S}\)</span> and <span
class="math inline">\(\gamma \in \Gamma\)</span>. Suppose that <span
class="math inline">\(\gamma x \in N x \Omega\)</span>. Let <span
class="math inline">\(1 \leq i &lt; j \leq n\)</span> be indices such
that the Iwasawa coordinates <span
class="math inline">\(a_1,\dotsc,a_n\)</span> of <span
class="math inline">\(x\)</span> satisfy <span class="math inline">\(a_i
/ a_j \geq c\)</span>. Then <span class="math inline">\(\gamma_{j i} =
0\)</span>.</p></li>
<li><p>Show that for each <span class="math inline">\(g \in
\mathfrak{S}\)</span>, <span class="math display">\[\# \{ \gamma \in
\Gamma : g^{-1} \gamma g \in \Omega \} \ll a(g)^{2
\rho}.\]</span></p></li>
<li><p>Show that there is a bounded subset of <span
class="math inline">\(\mathfrak{S}\)</span> containing all <span
class="math inline">\(g \in \mathfrak{S}\)</span> for which <span
class="math inline">\(\gamma g \in N \Omega\)</span> for some <span
class="math inline">\(\gamma \in \Gamma\)</span>.</p></li>
</ol>
</div>
<h1 id="basics-on-automorphic-forms">Basics on automorphic forms</h1>
<p>At least initially, we’ll follow in large part the exposition of
Borel <a href="#ref-MR2331343" class="citation" data-cites="MR2331343">(Borel 2007, sec.
2)</a>.</p>
<h2 id="motivation">Motivation</h2>
<p>Sometimes it’s useful to break problems up into analytic and
algebraic parts. For instance, as a first step towards the analysis of
spaces of functions on the circle group <span
class="math inline">\(\mathbb{R} / \mathbb{Z}\)</span>, one can study
the algebraically-flavored space of trigonometric polynomials, i.e.,
finite linear combinations of the functions <span
class="math inline">\(x \mapsto e(n x)\)</span> (<span
class="math inline">\(n \in \mathbb{Z}\)</span>). It’s straightforward
to verify that the Fourier inversion formula and the Parseval relation
hold for such functions. One can then deduce the corresponding
assertions for more analytically-flavored spaces (e.g., the space <span
class="math inline">\(L^2(\mathbb{R}/\mathbb{Z})\)</span> of
square-integrable functions the space <span
class="math inline">\(C^\infty(\mathbb{R}/\mathbb{Z})\)</span> of smooth
functions, etc.) via limiting arguments. Similarly, on the real line,
one can approach analytic questions concerning function spaces (<span
class="math inline">\(L^2(\mathbb{R})\)</span>, the Schwartz space <span
class="math inline">\(\mathcal{S}(\mathbb{R})\)</span>, etc.) by first
studying algebraic questions concerning finite linear combinations of
Fourier modes <span class="math inline">\(x \mapsto e(\xi x)\)</span>
(<span class="math inline">\(\xi \in \mathbb{R}\)</span>), or finite
linear combinations of hermite functions, i.e., functions of the form
<span class="math inline">\(x \mapsto P(x) e^{- \pi x^2}\)</span> for a
polynomial <span class="math inline">\(P\)</span>.</p>
<p>Automorphic forms are algebraically-flavored spaces of functions on
<span class="math inline">\(\Gamma \backslash G\)</span>.</p>
<h2 id="sec:defin-with-expl">§3.2. Definition without explanation</h2>
<p>We continue to focus on the examples <span
class="math inline">\(\Gamma \backslash G = {\mathop{\mathrm{SL}}}_n
(\mathbb{Z}) \backslash {\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> or
<span class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z})
\backslash {\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. We accordingly
let <span class="math inline">\(K\)</span> denote <span
class="math inline">\(\mathop{\mathrm{SO}}(n)\)</span> or <span
class="math inline">\(\operatorname{O}(n)\)</span>.</p>
<div id="defn:an-emph-form" class="definition">
<p><strong>Definition 46</strong>. An <em>automorphic form</em> <span
class="math inline">\(\varphi : G \rightarrow \mathbb{C}\)</span> is a
continuous function such that</p>
<ol>
<li><p><span class="math inline">\(\varphi(\gamma x) = \varphi
(x)\)</span> for all <span class="math inline">\(\gamma \in
\Gamma\)</span>, <span class="math inline">\(x \in G\)</span></p></li>
<li><p><span class="math inline">\(\varphi\)</span> is <em>right <span
class="math inline">\(K\)</span>-finite</em>, i.e., the span of <span
class="math inline">\(\{\varphi(\cdot k) : k \in K\}\)</span> is
finite-dimensional.</p></li>
<li><p><span class="math inline">\(\varphi\)</span> is <em><span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-finite</em>,
where <span class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>
denotes the center of the universal enveloping algebra.</p></li>
<li><p><span class="math inline">\(\varphi\)</span> is of <em>moderate
growth</em>.</p></li>
</ol>
</div>
<p>The conditions in this definition are elaborated below.</p>
<h2 id="norms-on-g">Norms on <span class="math inline">\(G\)</span></h2>
<p>For <span class="math inline">\(x \in G\)</span>, we define <span
class="math display">\[\|x\|^2 := \sum _{i, j } \left(|x_{i j}|^2 +
|(x^{-1})_{i j}|^2\right).\]</span> We observe that <span
class="math display">\[\|x y\| \leq \|x\| . \|y\|, \quad \|x\| =
\|x^{-1}\|,\]</span> that <span class="math inline">\(\{x \in G : \|x\|
\leq c\}\)</span> is compact for each <span class="math inline">\(c &gt;
0\)</span>, and that for each compact subset <span
class="math inline">\(\Omega\)</span> of <span
class="math inline">\(G\)</span>, <span id="eq:u-x-u" class="math display">\[\label{eq:u-x-u}\tag{19}
  \|u x u&#39;\| \asymp \|x\| \quad (u, u&#39; \in \Omega, x \in
G).\]</span></p>
<div class="exercise">
<p><strong>Exercise 16</strong>. Let <span
class="math inline">\(\mathfrak{S} \subseteq G =
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> be a Siegel domain
(Definition <a href="#defn:siegel-domain" data-reference-type="ref"
data-reference="defn:siegel-domain">12</a>). Let <span
class="math inline">\(\omega\)</span> be a dominant weight (§<a
href="#sec:recap-finite-dimens" data-reference-type="ref"
data-reference="sec:recap-finite-dimens">2.8.2</a>). Show that there
exists <span class="math inline">\(m &gt; 0\)</span> such that for each
compact subset <span class="math inline">\(\Omega \subseteq G\)</span>
there exists <span class="math inline">\(C\)</span> so that for all
<span class="math inline">\(\gamma \in \Gamma\)</span>, <span
class="math inline">\(x \in \mathfrak{S}\)</span> and <span
class="math inline">\(g \in \Omega\)</span>, <span
class="math display">\[a(x)^{\omega} \leq C \|\gamma x g\|^m.\]</span>
[Hint: use that <span class="math inline">\(\|h\| \asymp \|h
g\|\)</span> for <span class="math inline">\(g \in \Omega\)</span> and
that if <span class="math inline">\(x \in B\)</span>, then <span
class="math inline">\(a(x)^{\omega} = \|x e_\omega \|\)</span>.]</p>
</div>
<h2 id="sec:funct-moder-growth">§3.4. Functions of moderate growth</h2>
<p>We say that a function <span class="math inline">\(f : G \rightarrow
\mathbb{C}\)</span> is of <em>moderate growth</em> if there exists <span
class="math inline">\(m \in \mathbb{Z}\)</span> so that <span id="eq:fx-ll-xm" class="math display">\[\label{eq:fx-ll-xm}\tag{20}
  f(x) \ll \|x\|^m
  \quad (x \in G).\]</span> We say that <span
class="math inline">\(f\)</span> is of <em>rapid decay</em> if the
estimate <a href="#eq:fx-ll-xm" data-reference-type="eqref"
data-reference="eq:fx-ll-xm">\((20)\)</a> holds for all <span
class="math inline">\(m \in \mathbb{Z}\)</span>.</p>
<p>It is clear that a sum or product of functions of moderate growth or
rapid decay has the same property, while the product of one function of
moderate growth with another function of rapid decay is of rapid decay.
Thus the functions of moderate growth form a ring which contains the
functions of rapid decay as an ideal.</p>
<h2 id="finite-functions">Finite functions</h2>
<h3 id="generalities">Generalities</h3>
<div class="lemma">
<p><strong>Lemma 47</strong>. Let <span class="math inline">\(G\)</span>
be a locally compact group. Let <span class="math inline">\(f : G
\rightarrow \mathbb{C}\)</span> be a continuous function (measurability
would also suffice). The following conditions are equivalent:</p>
<ol type="i">
<li><p>The span of the right <span
class="math inline">\(G\)</span>-translates of <span
class="math inline">\(f\)</span> is finite-dimensional.</p></li>
<li><p>The span of the left <span
class="math inline">\(G\)</span>-translates of <span
class="math inline">\(f\)</span> is finite-dimensional.</p></li>
<li><p>The span of the <span class="math inline">\(G \times
G\)</span>-translates of <span class="math inline">\(f\)</span> is
finite-dimensional.</p></li>
<li><p><span class="math inline">\(f\)</span> arises as a matrix
coefficient for some finite-dimensional representation <span
class="math inline">\((\pi,V)\)</span> of <span
class="math inline">\(G\)</span>: there exists <span
class="math inline">\(\alpha \in \mathop{\mathrm{End}}(V)^*\)</span> so
that <span class="math inline">\(f(g) =
\alpha(\pi(g))\)</span>.</p></li>
</ol>
</div>
<div class="definition">
<p><strong>Definition 48</strong>. A <em>finite function</em> on <span
class="math inline">\(G\)</span> is one satisfying the equivalent
conditions of the lemma.</p>
</div>
<div class="example">
<p><strong>Example 49</strong>. For <span class="math inline">\(G =
\mathbb{R} = \mathbb{R} / \mathbb{Z}\)</span>, the finite functions are
the trigonometric polynomials, i.e., the finite linear combinations of
<span class="math inline">\(x \mapsto e(n x)\)</span>.</p>
</div>
<div class="example">
<p><strong>Example 50</strong>. For a compact group <span
class="math inline">\(G\)</span>, any finite-dimensional representation
decomposes as a direct sum of irreducible representations, so the finite
functions are the finite linear combinations of matrix coefficients of
irreducible finite-dimensional representations. The Peter–Weyl theorem
says that these are dense in <span
class="math inline">\(L^2(G)\)</span>.</p>
</div>
<div class="example">
<p><strong>Example 51</strong>. For <span class="math inline">\(G =
\mathbb{R}\)</span>, the finite functions are the finite linear
combinations of the <em>exponential polynomials</em> <span
class="math display">\[x \mapsto e^{\alpha x} x^{\beta}\]</span> defined
for <span class="math inline">\(\alpha \in \mathbb{C}\)</span> and <span
class="math inline">\(\beta \in \mathbb{Z}_{\geq 0}\)</span>.</p>
<p>These are also the generalized eigenfunctions of the differentiation
operator <span class="math inline">\(\partial_x = \frac{d}{d
x}\)</span>, i.e., the function <span class="math inline">\(f\)</span>
for which <span class="math inline">\((\partial_x - \alpha )^{\beta+1} f
= 0\)</span>.</p>
</div>
<div id="exa:g-=-mathbbrtimes_+" class="example">
<p><strong>Example 52</strong>. For <span class="math inline">\(G =
\mathbb{R}^\times_+ \xrightarrow{\log} \mathbb{R}\)</span>, the finite
functions are those of the form <span class="math display">\[y \mapsto
y^{\alpha} (\log y)^{\beta},\]</span> with <span
class="math inline">\(\alpha\)</span> and <span
class="math inline">\(\beta\)</span> as above. These are also called
exponential polynomials.</p>
</div>
<h3 id="sec:isotyp-decomp">§3.5.2. Isotypic decomposition</h3>
<p>Let <span class="math inline">\(K\)</span> and <span
class="math inline">\(G\)</span> be as in Definition <a
href="#defn:an-emph-form" data-reference-type="ref"
data-reference="defn:an-emph-form">46</a>. Let <span
class="math inline">\(\varphi : G \rightarrow \mathbb{C}\)</span> be a
right <span class="math inline">\(K\)</span>-finite continuous function.
Write <span class="math inline">\(V\)</span> for the
(finite-dimensional) span of the right translates of <span
class="math inline">\(\varphi\)</span>. Then <span
class="math inline">\(K\)</span> acts on <span
class="math inline">\(V\)</span> via right translation. By Maschke’s
theorem, we may decompose <span class="math inline">\(V\)</span> as a
direct sum of irreducible representations of <span
class="math inline">\(K\)</span>.</p>
<p>Let <span class="math inline">\(\sigma\)</span> be an irreducible
representation of <span class="math inline">\(K\)</span>. We say that
<span class="math inline">\(\varphi\)</span> has <em><span
class="math inline">\(K\)</span>-type <span
class="math inline">\(\sigma\)</span></em> if <span
class="math inline">\(V\)</span> is isomorphic to a direct sum of copies
of <span class="math inline">\(\sigma\)</span>. Define <span
class="math inline">\(e_\sigma \in C^\infty(K)\)</span> by the formula
<span class="math display">\[e_\sigma(k) := (\dim \sigma)
\chi_\sigma(k),\]</span> where <span
class="math inline">\(\chi_\sigma(k) :=
\mathop{\mathrm{trace}}(\sigma(k))\)</span> denotes the character of
<span class="math inline">\(\sigma\)</span>. Using the Schur
orthogonality relations, we may check that <span
class="math inline">\(\varphi\)</span> has <span
class="math inline">\(K\)</span>-type <span
class="math inline">\(\sigma\)</span> if and only if the convolution
<span class="math display">\[\varphi \ast e_\sigma : g \mapsto \int_{k
\in K} \varphi(g k^{-1}) e_\sigma(k) \, d k,\]</span> defined using the
probability Haar measure <span class="math inline">\(d k\)</span> on
<span class="math inline">\(K\)</span>, coincides with <span
class="math inline">\(\varphi\)</span>, i.e., <span
class="math inline">\(\varphi \ast e _\sigma = \varphi\)</span>.</p>
<p>We say that <span class="math inline">\(V\)</span> is <em><span
class="math inline">\(K\)</span>-isotypic</em> if it has <span
class="math inline">\(K\)</span>-type <span
class="math inline">\(\sigma\)</span> for some <span
class="math inline">\(\sigma\)</span>. In general, we may write any
<span class="math inline">\(K\)</span>-finite <span
class="math inline">\(\varphi\)</span> as a finite sum of <span
class="math inline">\(K\)</span>-isotypic vectors, indexed by <span
class="math inline">\(\sigma\)</span> in some finite collection <span
class="math inline">\(\Xi\)</span> of (isomorphism classes of)
irreducible representations of <span class="math inline">\(K\)</span>.
For any such <span class="math inline">\(\Xi\)</span>, set <span
class="math display">\[e _{\Xi } := \sum _{\sigma \in \Xi } e
_\sigma.\]</span> Then a continuous function <span
class="math inline">\(\varphi\)</span> on <span
class="math inline">\(G\)</span> is <span
class="math inline">\(K\)</span>-finite if and only if it satisfies
<span class="math inline">\(\varphi \ast e _{\Xi } = \varphi\)</span>
for some such <span class="math inline">\(\Xi\)</span>.</p>
<h2 id="sec:univ-envel-algebra">§3.6. Universal enveloping algebra</h2>
<h3 id="sec:gener-defin-constr">§3.6.1. General definition and construction</h3>
<p>Let <span class="math inline">\(\mathfrak{g}\)</span> be a Lie
algebra.</p>
<div class="definition">
<p><strong>Definition 53</strong>. A <em>universal enveloping
algebra</em> <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span> is a unital
associative algebra equipped with a morphism of Lie algebras <span
class="math inline">\(\mathfrak{g} \rightarrow
\mathfrak{U}(\mathfrak{g})\)</span> that is universal among such
morphisms in the following sense: for each morphism of Lie algebras
<span class="math inline">\(\mathfrak{g} \rightarrow A\)</span> whose
target is unital associative algebra <span
class="math inline">\(A\)</span>, there is a unique morphism of
associative algebras <span
class="math inline">\(\mathfrak{U}(\mathfrak{g}) \rightarrow A\)</span>
such that the composition <span class="math inline">\(\mathfrak{g}
\rightarrow \mathfrak{U}(\mathfrak{g}) \rightarrow A\)</span> is the
given map <span class="math inline">\(\mathfrak{g} \rightarrow
A\)</span>.</p>
</div>
<p>By the usual arguments, if such an algebra exists, then it is unique.
For this reason we typically speak of “the” universal enveloping
algebra. We may construct <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span> explicitly as
the quotient <span class="math inline">\(T(\mathfrak{g})/I\)</span>,
where</p>
<ul>
<li><p><span class="math inline">\(T(\mathfrak{g})\)</span> denotes the
tensor algebra of <span class="math inline">\(\mathfrak{g}\)</span>,
i.e., the graded algebra <span class="math inline">\(\oplus_{k \in
\mathbb{Z}_{\geq 0}} \mathfrak{g}^{\otimes k}\)</span> equipped with the
multiplication <span class="math display">\[(x_1 \otimes \dotsb \otimes
x_{k_1}) \cdot (y_1 \otimes \dotsb \otimes y_{k_2}) = x_1 \otimes \dotsb
\otimes x_{k_1} \otimes y_1 \otimes \dotsb \otimes y_{k_2},\]</span>
and</p></li>
<li><p><span class="math inline">\(I\)</span> denotes the ideal of <span
class="math inline">\(T(\mathfrak{g})\)</span> generated by the elements
<span class="math inline">\(x \otimes y - y \otimes x - [x,y]\)</span>
for <span class="math inline">\(x, y \in \mathfrak{g}\)</span>.</p></li>
</ul>
<p>In other words, <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span> may be
regarded as the non-commutative polynomial ring generated by elements
<span class="math inline">\(X \in \mathfrak{g}\)</span> subject to the
relations <span class="math inline">\(X Y - Y X = [X,Y]\)</span>.</p>
<p>The proof that this construction defines a universal enveloping
algebra is the same as the proof that, e.g., the usual construction of
the tensor product of a pair of vector spaces satisfies its universal
property.</p>
<h3 id="sec:construction-via-lie">§3.6.2. Construction via Lie theory</h3>
<p>Let <span class="math inline">\(G\)</span> be a Lie group. We’ll
assume that it’s a closed subgroup of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. Then
<span class="math inline">\(\mathfrak{g} :=
\mathop{\mathrm{Lie}}(\mathfrak{g})\)</span> may be identified with a
Lie subalgebra of the algebra <span
class="math inline">\(M_n(\mathbb{R})\)</span> of <span
class="math inline">\(n \times n\)</span> matrices.</p>
<p>The group <span class="math inline">\(G\)</span> acts on itself by
left and right translation, hence also on functions on <span
class="math inline">\(G\)</span>. For <span class="math inline">\(g \in
G\)</span> and <span class="math inline">\(f : G \rightarrow
\mathbb{C}\)</span>, we set <span class="math display">\[r_g f(x) := f(x
g), \quad \ell_g f(x) := f(g^{-1} x).\]</span> These define the right
and left regular representations of <span
class="math inline">\(G\)</span>.</p>
<div class="exercise">
<p><strong>Exercise 17</strong>. Verify that <span
class="math inline">\(r_{g_1} r_{g_2} = r_{g_1 g_2}\)</span> and <span
class="math inline">\(\ell_{g_1} \ell_{g_2} = \ell_{g_1
g_2}\)</span>.</p>
</div>
<p>For <span class="math inline">\(X \in \mathfrak{g}\)</span>, we write
<span class="math inline">\(e^X = \exp(X) \in G\)</span> for its
exponential, which may be defined by the usual series. Thus <span
class="math display">\[e^{t X} = \sum _{n \geq 0} \frac{t^n
X^n}{n!}.\]</span></p>
<p>The group <span class="math inline">\(G\)</span> acts on itself by
conjugation. This induces the adjoint representation of <span
class="math inline">\(G\)</span> on <span
class="math inline">\(\mathfrak{g}\)</span>, denoted <span
class="math inline">\(\mathop{\mathrm{Ad}}: G \rightarrow
\mathop{\mathrm{GL}}(\mathfrak{g})\)</span>. We have <span
class="math display">\[g e^{t X} g^{-1} = e^{t \mathop{\mathrm{Ad}}(g)
X}.\]</span></p>
<p>Each <span class="math inline">\(X \in \mathfrak{g}\)</span> defines
a left-invariant differential operator on <span
class="math inline">\(G\)</span>, i.e., an element <span
class="math inline">\([f \mapsto X f]\)</span> of <span
class="math inline">\(\mathop{\mathrm{End}}(C^\infty(G))\)</span> given
by <span class="math display">\[X f(g) := \partial_{t=0} f(g e^{t
X}).\]</span> In other words, <span class="math inline">\(X f =
\partial_{t=0} r_{e^{t X}} f\)</span> is obtained by differentiating the
right regular representation of <span class="math inline">\(G\)</span>.
The Lie bracket <span class="math inline">\([,]\)</span> on <span
class="math inline">\(\mathfrak{g}\)</span> is characterized by the
identity <span id="eq:x-y-f" class="math display">\[\label{eq:x-y-f}\tag{21}
  X (Y  f) - Y (X f) = [X,Y] f
  \quad (f \in C^\infty(G)).\]</span> The map <span
class="math inline">\(\mathfrak{g} \rightarrow
\mathop{\mathrm{End}}(C^\infty(G))\)</span> is thus a Lie algebra
homomorphism. This map is readily seen to be injective (consider the
first order Taylor coefficients of <span
class="math inline">\(f\)</span> at the identity), so we may identify
<span class="math inline">\(\mathfrak{g}\)</span> with its image.</p>
<p>The universal enveloping algebra <span
class="math inline">\(\mathcal{U}(\mathfrak{g})\)</span> may be defined
as the subalgebra of <span
class="math inline">\(\mathop{\mathrm{End}}(C^\infty(G))\)</span>
generated by <span class="math inline">\(\mathfrak{g}\)</span>. (It is
clear from the universal propetry that <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span>, as
constructed in §<a href="#sec:gener-defin-constr"
data-reference-type="ref"
data-reference="sec:gener-defin-constr">3.6.1</a>, admits a map to <span
class="math inline">\(\mathop{\mathrm{End}}(C^\infty(G))\)</span>. The
point is just that this map is injective.) We may also identify <span
class="math inline">\(\mathcal{U}(\mathfrak{g})\)</span> with the
algebra of left-invariant differential operators on <span
class="math inline">\(G\)</span>, or with the convolution algebra of
distributions on <span class="math inline">\(G\)</span> supported at the
identity element.</p>
<h3 id="the-center">The center</h3>
<div class="definition">
<p><strong>Definition 54</strong>. We denote by <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span> the center of
<span class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span>.</p>
</div>
<div class="definition">
<p><strong>Definition 55</strong>. In the setting of §<a
href="#sec:defin-with-expl" data-reference-type="ref"
data-reference="sec:defin-with-expl">3.2</a>, we say that <span
class="math inline">\(\varphi : G \rightarrow \mathbb{C}\)</span> is
<em><span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-finite</em> if
the image of its span under the action of <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span> described in
§<a href="#sec:construction-via-lie" data-reference-type="ref"
data-reference="sec:construction-via-lie">3.6.2</a> is
finite-dimensional.</p>
</div>
<div id="example:stoes2021:g-=-gl_nmathbbr" class="example">
<p><strong>Example 56</strong>. For <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>, <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span> is isomorphic
to a polynomial ring in <span class="math inline">\(n\)</span>
variables, described explicitly via the Harish–Chandra isomorphism <a href="#ref-MR855239"
class="citation" data-cites="MR855239">(Knapp 1986, 36:220)</a>.</p>
</div>
<div id="exa:g-=-sl_2mathbbr" class="example">
<p><strong>Example 57</strong>. For <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>, <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span> is isomorphic
to a polynomial ring in one variable. It is freely generated by the
element <span id="eq:omega-=-e" class="math display">\[\label{eq:omega-=-e}\tag{22}
    \Omega
    = e f + f e + \frac{1}{2} h ^2,\]</span> where <span
class="math display">\[e =
    \begin{pmatrix}
      0 &amp; 1 \\
      0 &amp; 0
    \end{pmatrix}
    , \quad f =
    \begin{pmatrix}
      0 &amp; 0 \\
      1 &amp; 0
    \end{pmatrix}
    , \quad h =
    \begin{pmatrix}
      1 &amp; 0 \\
      0 &amp; -1
    \end{pmatrix}
    .\]</span> This is the simplest example of a “Casimir element.” Note
that in <a href="#eq:omega-=-e" data-reference-type="eqref"
data-reference="eq:omega-=-e">\((22)\)</a>, the products <span
class="math inline">\(ef, f e, h^2\)</span> take place inside <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span>, not inside
the space of <span class="math inline">\(2 \times 2\)</span>
matrices.</p>
</div>
<h2 id="sec:Z-g-finiteness">§3.7. Finiteness</h2>
<p>The algebra <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span> acts on the
space of smooth functions <span class="math inline">\(\varphi\)</span>
on <span class="math inline">\(G\)</span> (and also on, e.g., the space
of distributions). The space <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g}) \varphi = \{D \varphi :
D \in \mathfrak{Z}(\mathfrak{g})\}\)</span> is isomorphic to the
quotient algebra <span class="math inline">\(\mathfrak{Z}(\mathfrak{g})
/ \mathop{\mathrm{Ann}}(\varphi)\)</span>, where <span
class="math inline">\(\mathop{\mathrm{Ann}}(\varphi) = \{D : D \varphi =
0\}\)</span> denotes the annihilator ideal of <span
class="math inline">\(\varphi\)</span>. Thus that space is
finite-dimensional if and only if that ideal is of finite codimension.
In particular, <span class="math inline">\(\varphi\)</span> is <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-finite if and
only if it is annihilated by some ideal <span
class="math inline">\(J\)</span> in <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span> of finite
codimension. We say in the latter case that <span
class="math inline">\(\varphi\)</span> has <em><span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-type <span
class="math inline">\(J\)</span></em>.</p>
<h2 id="sec:relat-class-modul">§3.8. Relation to classical modular forms</h2>
<p>Take <span class="math inline">\(\Gamma \backslash G =
{\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>, <span
class="math inline">\(K = \mathop{\mathrm{SO}}(2)\)</span>. Then <span
class="math inline">\(G/K\)</span> identifies with the upper half-plane
<span class="math inline">\(\mathbb{H} = \{x + i y : y &gt; 0\}\)</span>
via the map <span class="math inline">\(g K \mapsto g \cdot i\)</span>,
where <span class="math inline">\(G\)</span> acts on <span
class="math inline">\(\mathbb{H}\)</span> via fractional linear
transformations: <span class="math display">\[\begin{pmatrix}
    a &amp; b \\
    c &amp; d
  \end{pmatrix}
  \cdot z = \frac{a z + b }{c z + d}.\]</span></p>
<div id="defn:function-f-:" class="definition">
<p><strong>Definition 58</strong>. A function <span
class="math inline">\(f : \mathbb{H} \rightarrow \mathbb{C}\)</span> is
a <em>modular form of weight <span class="math inline">\(m\)</span></em>
if</p>
<ol>
<li><p><span class="math inline">\(f (\gamma z) = (c z + d) ^m f
(z)\)</span> for all <span class="math inline">\(\gamma =
    \begin{pmatrix}
      a &amp; b \\
      c &amp; d
    \end{pmatrix}
    \in \Gamma\)</span> and <span class="math inline">\(z \in
\mathbb{H}\)</span>.</p></li>
<li><p><span class="math inline">\(f\)</span> is holomorphic.</p></li>
<li><p><span class="math inline">\(f\)</span> is “regular at the
cusp.”</p></li>
</ol>
</div>
<p>Explanation of (<span class="math inline">\(M_3\)</span>): from
(<span class="math inline">\(M_1\)</span>) we see that <span
class="math inline">\(f(z+1) = f(z)\)</span>, then from (<span
class="math inline">\(M _2\)</span>) that <span
class="math inline">\(f(z) = \sum _{n \in \mathbb{Z} } a_n e(n
z)\)</span>, where as usual <span class="math inline">\(e(z) := e^{2 \pi
i z}\)</span>. The factor <span class="math inline">\(e (n z)\)</span>
blows up as <span class="math inline">\(y \rightarrow \infty\)</span> if
<span class="math inline">\(n &lt; 0\)</span>. Condition (<span
class="math inline">\(M_3\)</span>) says that <span
class="math inline">\(a_n = 0\)</span> unless <span
class="math inline">\(n \geq 0\)</span>, so that such blow-up does not
occur.</p>
<p>The relation between Definition <a href="#defn:function-f-:"
data-reference-type="ref" data-reference="defn:function-f-:">58</a> and
Definition <a href="#defn:an-emph-form" data-reference-type="ref"
data-reference="defn:an-emph-form">46</a> is as follows. Given a modular
form <span class="math inline">\(f\)</span> of weight <span
class="math inline">\(m\)</span>, define a function <span
class="math inline">\(\varphi : G \rightarrow \mathbb{C}\)</span> by
<span class="math display">\[\varphi (g) := (c i + d)^{-m} f (g \cdot i)
\quad \text{ if } g =
  \begin{pmatrix}
    a &amp; b \\
    c &amp; d
  \end{pmatrix}
  .\]</span></p>
<div class="exercise">
<p><strong>Exercise 18</strong>. Show that (<span
class="math inline">\(M_1\)</span>) implies (<span
class="math inline">\(A_1\)</span>).</p>
</div>
<div class="exercise">
<p><strong>Exercise 19</strong>. Show that (<span
class="math inline">\(M_1\)</span>) implies (<span
class="math inline">\(A_2\)</span>); more precisely, verify that <span
class="math display">\[\varphi \left( g
      \begin{pmatrix}
        \cos \theta  &amp; \sin \theta  \\
        -\sin \theta &amp; \cos \theta
      \end{pmatrix}
    \right) = e (m \theta ) \varphi (\gamma).\]</span></p>
</div>
<div class="exercise">
<p><strong>Exercise 20</strong>. Show that (<span
class="math inline">\(M_2\)</span>) implies (<span
class="math inline">\(A_3\)</span>); more precisely, with <span
class="math inline">\(\Omega\)</span> as in Example <a
href="#exa:g-=-sl_2mathbbr" data-reference-type="ref"
data-reference="exa:g-=-sl_2mathbbr">57</a>, verify that <span
class="math inline">\(\Omega \varphi = c \varphi\)</span> for some real
number <span class="math inline">\(c\)</span> depending only upon <span
class="math inline">\(m\)</span>.</p>
</div>
<div class="exercise">
<p><strong>Exercise 21</strong>. Show that (<span
class="math inline">\(M_3\)</span>) implies (<span
class="math inline">\(A_4\)</span>).</p>
</div>
<div id="exe:let-f-:" class="exercise">
<p><strong>Exercise 22</strong>. Let <span class="math inline">\(f :
\mathbb{H} \rightarrow \mathbb{C}\)</span> be a smooth function on the
upper half-plane that is an eigenfunction for the hyperbolic Laplacian
<span class="math inline">\(\Delta = y^2 (\partial_{x x} + \partial_{y
y})\)</span>. Define <span class="math inline">\(\varphi\)</span> as
above, taking <span class="math inline">\(m = 0\)</span>. Verify that
(<span class="math inline">\(A_3\)</span>) holds for <span
class="math inline">\(\varphi\)</span>; more precisely, show that <span
class="math inline">\(\varphi\)</span> is an eigenfunction for <span
class="math inline">\(\Omega\)</span>, with eigenvalue deterimined by
that for <span class="math inline">\(f\)</span> with respect to <span
class="math inline">\(\Lambda\)</span>.</p>
</div>
<h2 id="some-basic-properties">Some basic properties</h2>
<p>Recall that a Lie group <span class="math inline">\(G\)</span> comes
with natural analytic charts, given by local exponential coordinates. We
state here, without proof, some basic consequences of Definition <a
href="#defn:an-emph-form" data-reference-type="ref"
data-reference="defn:an-emph-form">46</a>.</p>
<p>Let <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> or <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>.</p>
<div class="theorem">
<p><strong>Theorem 59</strong>. <em>Any automorphic form is
analytic.</em></p>
</div>
<p>More generally, any function <span class="math inline">\(G
\rightarrow \mathbb{C}\)</span> that is right <span
class="math inline">\(K\)</span>-finite and <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-finite is
analytic. The idea of the proof is that the <span
class="math inline">\(K\)</span>-finiteness and <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-finiteness
conditions imply that <span class="math inline">\(\varphi\)</span>
satisfies an elliptic PDE. See for instance <a href="#ref-MR1482800" class="citation"
data-cites="MR1482800">(Borel 1997, Theorem 2.13)</a> or <a href="#ref-MR2331343"
class="citation" data-cites="MR2331343">(Borel 2007, sec.
3.1)</a>.</p>
<div id="thm:harish-chandra-existence-reproducing-kernels"
class="theorem">
<p><strong>Theorem 60</strong> (Harish–Chandra). <em>For any automorphic
form <span class="math inline">\(\varphi\)</span> we may find <span
class="math inline">\(f \in C_c^\infty(G)\)</span>, supported
arbitrarily close to the identity element, so that <span
class="math inline">\(\varphi\)</span> equals the convolution <span
class="math inline">\(\varphi \ast f\)</span> defined as usual by <span
class="math display">\[\varphi \ast f(x) := \int _{g \in G} \varphi(x
g^{-1}) f(g) \, d g.\]</span> We may arrange moreover that <span
class="math inline">\(f(k^{-1} g k) = f(g)\)</span> for all <span
class="math inline">\(k \in K, g \in G\)</span>.</em></p>
</div>
<p>This result again applies more generally to any right <span
class="math inline">\(K\)</span>-finite and <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-finite
function on <span class="math inline">\(G\)</span>. See for instance
<a href="#ref-MR1482800" class="citation" data-cites="MR1482800">(Borel 1997, Theorem
2.14)</a>, which develops a detailed proof in the special case <span
class="math inline">\(G = {\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>,
and <a href="#ref-MR855239" class="citation" data-cites="MR855239">(Knapp 1986, Corollary
8.41)</a> or <a href="#ref-MR2331343" class="citation" data-cites="MR2331343">(Borel
2007, sec. 3.2)</a> concerning the general case.</p>
<div class="exercise">
<p><strong>Exercise 23</strong>. Assuming the statement of <a href="#ref-MR1942691"
class="citation" data-cites="MR1942691">(Iwaniec 2002, Theorem
1.14)</a>, deduce the conclusion of Theorem <a
href="#thm:harish-chandra-existence-reproducing-kernels"
data-reference-type="ref"
data-reference="thm:harish-chandra-existence-reproducing-kernels">60</a>
in the setting of Exercise <a href="#exe:let-f-:"
data-reference-type="ref" data-reference="exe:let-f-:">22</a>.</p>
</div>
<div id="defn:we-say-that-uniform-moderate-growth" class="definition">
<p><strong>Definition 61</strong>. We say that a function <span
class="math inline">\(\varphi : G \rightarrow \mathbb{C}\)</span> has
<em>uniform moderate growth</em> if there exists <span
class="math inline">\(m\)</span> so that for each <span
class="math inline">\(D \in \mathcal{U}(\mathfrak{g})\)</span>, the
function <span class="math inline">\(D f\)</span>, defined as in §<a
href="#sec:construction-via-lie" data-reference-type="ref"
data-reference="sec:construction-via-lie">3.6.2</a>, satisfies <a
href="#eq:fx-ll-xm" data-reference-type="eqref"
data-reference="eq:fx-ll-xm">\((20)\)</a>.</p>
</div>
<div class="proposition">
<p><strong>Proposition 62</strong>. <em>Any automorphic form <span
class="math inline">\(\varphi\)</span> has uniform moderate
growth.</em></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Write <span class="math inline">\(\varphi = \varphi
\ast f\)</span> with <span class="math inline">\(f \in
C_c^\infty(G)\)</span>. By elementary calculations with the definitions,
we verify that <span class="math display">\[D \varphi = D (\varphi \ast
f) = \varphi \ast D f.\]</span> On the other hand, using <a
href="#eq:u-x-u" data-reference-type="eqref"
data-reference="eq:u-x-u">\((19)\)</a>, we see that <span
class="math display">\[\varphi(g) \ll \|g\|^m
    \implies
    (\varphi \ast D f) \ll \|g\|^m.\]</span> Therefore <span
class="math inline">\(D \varphi(g) \ll \|g\|^m\)</span>, as
required. ◻</p>
</span></div>
<h1 id="constant-terms">Constant terms</h1>
<p>The main purpose of this section is to generalize the basic estimate
<span id="eq:sum_n-geq-0" class="math display">\[\label{eq:sum_n-geq-0}\tag{23}
  \sum_{n \geq 0} a_n e^{2 \pi i n z} \sim a_0\]</span> describing the
asymptotic behavior as <span class="math inline">\(y \rightarrow
\infty\)</span> of classical modular forms. More precisely, we initiate
the study of the asymptotics “near infinity” in <span
class="math inline">\(\Gamma \backslash G\)</span> of an automorphic
form. In this section <span class="math inline">\(\Gamma \backslash
G\)</span> is either <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> or <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. We loosely follow the
exposition of <a href="#ref-MR2331343" class="citation" data-cites="MR2331343">(Borel 2007,
secs. 5–6)</a>.</p>
<h2 id="sec:reduction-from-gl_n">§4.1. Reduction from <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> to <span
class="math inline">\({\mathop{\mathrm{SL}}}_n\)</span></h2>
<p>Recall from Example <a href="#exa:g-=-mathbbrtimes_+"
data-reference-type="ref" data-reference="exa:g-=-mathbbrtimes_+">52</a>
that the finite functions on <span
class="math inline">\(\mathbb{R}^\times_+\)</span> are the exponential
polynomials. The finite functions on <span
class="math inline">\(\mathbb{R}^\times\)</span> will also be referred
to as exponential polynomials (they are given on each of the two
connected components by an exponential polynomial).</p>
<p>Take <span class="math inline">\(G :=
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. We may identify the center
<span class="math inline">\(Z\)</span> of <span
class="math inline">\(G\)</span> with <span
class="math inline">\(\mathbb{R}^\times\)</span> via the map <span
class="math display">\[\begin{pmatrix}
    z &amp;  &amp;  &amp;  &amp;  \\
      &amp; z &amp;  &amp;  &amp;  \\
      &amp;  &amp; \ddots &amp;  &amp;  \\
      &amp;  &amp;  &amp; z &amp;  \\
      &amp;  &amp;  &amp;  &amp; z
  \end{pmatrix}
  \mapsto z.\]</span> Using that <span class="math inline">\(G\)</span>
commutes with <span class="math inline">\(Z\)</span>, we deduce that the
Lie algebra <span class="math inline">\(\mathfrak{z}\)</span> of <span
class="math inline">\(Z\)</span>, regarded as a subspace of the
universal enveloping algebra <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span>, lies in the
center <span class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>.
Thus any automorphic form <span class="math inline">\(\varphi\)</span>
on <span class="math inline">\(\Gamma \backslash G\)</span> is in
particular <span class="math inline">\(\mathfrak{z}\)</span>-finite. By
analyticity, it is also <span class="math inline">\(Z\)</span>-finite.
Therefore for each <span class="math inline">\(g \in G\)</span>, the
function <span class="math inline">\(Z \ni z \mapsto \varphi(z
g)\)</span> is an exponential polynomial. We get a slightly stronger
conclusion by taking into account also the <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-finiteness of
<span class="math inline">\(\varphi\)</span> (see <a href="#ref-MR2331343" class="citation"
data-cites="MR2331343">(Borel 2007, sec. 5.6)</a> and
references):</p>
<div class="lemma">
<p><strong>Lemma 63</strong>. For each smooth <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-finite
function <span class="math inline">\(\varphi : G \rightarrow
\mathbb{C}\)</span>, there are exponential polynomials <span
class="math inline">\(Q_i\)</span> on <span
class="math inline">\(Z\)</span> and elements <span
class="math inline">\(P_i \in \mathfrak{Z}(\mathfrak{g})\)</span> such
that for all <span class="math inline">\(z \in Z\)</span> and <span
class="math inline">\(g \in G\)</span>, we have <span
class="math display">\[\varphi (z g) = \sum _{i} Q_i(z) \cdot P_i
f(g),\]</span> with <span class="math inline">\(P_i f\)</span> defined
as in §<a href="#sec:construction-via-lie" data-reference-type="ref"
data-reference="sec:construction-via-lie">3.6.2</a>.</p>
</div>
<p>Since the multiplication map <span class="math inline">\(Z \times
{\mathop{\mathrm{SL}}}_n(\mathbb{R}) \rightarrow
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span> has image of finite index
and since exponential polynomials may be regarded as well-understood, we
see that the study of the behavior near infinity of automorphic forms on
<span class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z})
\backslash {\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span> largely reduces
to that of automorphic forms on <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>.</p>
<h2 id="sec:stand-parab-subgr">§4.2. Standard parabolic subgroups</h2>
<p>Fix a Siegel domain <span class="math inline">\(\mathfrak{S}\)</span>
for <span class="math inline">\(\Gamma \backslash G\)</span> (§<a
href="#sec:org0d39d27" data-reference-type="ref"
data-reference="sec:org0d39d27">2.4</a>).</p>
<div class="question">
<p><strong>Question 64</strong>. How can a sequence <span
class="math inline">\(x^{(\ell)} \in \mathfrak{S}\)</span> (<span
class="math inline">\(\ell=1,2,3,\dotsc\)</span>) tend off to <span
class="math inline">\(\infty\)</span>?</p>
</div>
<p>Recall that we may write <span class="math inline">\(x^{(\ell)} =
u^{(\ell)} a^{(\ell)} k^{(\ell)}\)</span>, where <span
class="math inline">\(u^{(\ell)}\)</span> lies in some fixed compact
subset of <span class="math inline">\(N\)</span>, <span
class="math inline">\(k^{(\ell)}\)</span> lies in <span
class="math inline">\(K\)</span>, and <span
class="math inline">\(a^{(\ell)}\)</span> is a diagonal matrix with
positive entries for which each ratio <span
class="math inline">\(a_i^{(\ell)} / a_{i+1}^{(\ell)}\)</span> is
bounded from below by some fixed positive quantity. Thus after passing
to a subsequence, we may assume that each such ratio either remains
bounded or tends off to infinity as <span class="math inline">\(\ell
\rightarrow \infty\)</span>. Let <span class="math inline">\(I \subseteq
\{1, \dotsc, n-1\}\)</span> denote the set of indices for which the
ratio in question remains bounded. Then <span
class="math inline">\(I\)</span> describes the “directions” in which
<span class="math inline">\(x^{(\ell)}\)</span> remains bounded in <span
class="math inline">\(\mathfrak{S}\)</span>, while the complement of
<span class="math inline">\(I\)</span> describes those in which it tends
off to infinity.</p>
<p>It is often convenient to think of the set <span
class="math inline">\(I\)</span> in terms of a related equivalence
relation <span class="math inline">\(\sim\)</span> on <span
class="math inline">\(\{1,\dotsc,n\}\)</span>. We declare <span
class="math inline">\(i \sim j\)</span> when the ratio <span
class="math inline">\(a_i^{(\ell)} / a_j^{(\ell)}\)</span> is bounded
from above and below by fixed positive quantities, independent of <span
class="math inline">\(\ell\)</span>. Thus for <span
class="math inline">\(i \leq j\)</span>, we have <span
class="math inline">\(i \sim j\)</span> precisely when <span
class="math inline">\(\{i,i+1,\dotsc,j-1\} \subseteq I\)</span>. Such
equivalence relations have the property that their equivalence classes
consist of intervals of integers. Let us call such relations
<em>continguous</em>. We obtain a natural bijection <span
class="math display">\[\{\text{subsets } I \subseteq \{1,\dotsc,n-1\}\}
  \leftrightarrow
  \{\text{contiguous equivalence relations $\sim$ on } \{1,\dotsc,n
\}\}.\]</span> We may, in turn, identify a continguous equivalence
relation with the <em>composition</em> of <span
class="math inline">\(n\)</span> describing the cardinalities of each
equivalence class. For instance, if <span class="math inline">\(n =
8\)</span> and <span class="math inline">\(I = \{1,3,4,7\}\)</span>,
then the equivalence classes of <span
class="math inline">\(\sim\)</span> are <span
class="math inline">\(\{1,2\}\)</span>, <span
class="math inline">\(\{3,4,5\}\)</span>, <span
class="math inline">\(\{6\}\)</span> and <span
class="math inline">\(\{7,8\}\)</span>, and the corresponding
composition is <span class="math inline">\(n = 2 + 3 + 1 +
2\)</span>.</p>
<p>(In the lecture, the following definition was given a bit later, when
it seemed better motivated.)</p>
<div class="definition">
<p><strong>Definition 65</strong>. Given an equivalence relation <span
class="math inline">\(\sim\)</span> on <span class="math inline">\(\{1,
\dotsc, n\}\)</span> (or equivalently, a subset of <span
class="math inline">\(\{1, \dotsc, n-1\}\)</span>, or a composition of
<span class="math inline">\(n\)</span>), the corresponding <em>standard
parabolic subgroup</em> <span class="math inline">\(P\)</span> of <span
class="math inline">\(G\)</span> is defined by <span
class="math display">\[P := \{g \in G : g_{i j} = 0 \text{ if } i &gt; j
\text{ and } i \not \sim j \}.\]</span> The corresponding <em>standard
Levi subgroup</em> <span class="math inline">\(M\)</span> of <span
class="math inline">\(P\)</span> is defined by <span
class="math display">\[M := \{g \in G : g_{i j} = 0 \text{ if } i \not
\sim j\}.\]</span> The <em>unipotent radical</em> <span
class="math inline">\(U\)</span> of <span
class="math inline">\(P\)</span> is given by <span
class="math display">\[U := \{g \in N : g_{i j}  = 0 \text{ if } i \sim
j\}.\]</span></p>
</div>
<p>Such subgroups have already appeared implicitly: in our discussion of
the shape of Siegel domains (see handwritten notes from Lecture 2) and
in our proof of Theorem <a href="#thm:existence-reduced-basis"
data-reference-type="ref"
data-reference="thm:existence-reduced-basis">9</a>,
part <a href="#item:siegel-finitely-many-gamma"
data-reference-type="eqref"
data-reference="item:siegel-finitely-many-gamma">\((v)\)</a>.</p>
<div class="exercise">
<p><strong>Exercise 24</strong>. With notation as above, we have <span
class="math inline">\(P = M U\)</span>. More precisely, <span
class="math inline">\(P\)</span> is the semidirect product of <span
class="math inline">\(M\)</span> and <span
class="math inline">\(U\)</span>, with <span
class="math inline">\(U\)</span> normal.</p>
</div>
<div id="itm:stoes2021:2" class="example">
<p><strong>Example 66</strong>. <span id="example:stoes2021:take-g-="
label="example:stoes2021:take-g-="></span> Take <span
class="math inline">\(G = {\mathop{\mathrm{SL}}}_4\)</span>. Given a
sequence <span class="math inline">\(x^{(\ell)}\)</span>, we get an
equivalence relation <span class="math inline">\(\sim\)</span>
(equivalently, a subset of <span
class="math inline">\(\{0,1,2,3\}\)</span>, or a composition of <span
class="math inline">\(4\)</span>), hence a standard parabolic subgroup
<span class="math inline">\(P = M U\)</span>.</p>
<ol type="i">
<li><p>If <span class="math inline">\(x^{(\ell)} =
\mathop{\mathrm{diag}}(\ell^2, \ell, \ell^{-1}, \ell^{-2})\)</span>,
then <span class="math display">\[P =
      \begin{pmatrix}
        \ast &amp; \ast &amp; \ast &amp; \ast \\
             &amp; \ast &amp; \ast &amp; \ast \\
             &amp;  &amp; \ast &amp; \ast \\
             &amp; &amp; &amp; \ast
      \end{pmatrix}
      , \quad M =
      \begin{pmatrix}
        \ast &amp;  &amp;  &amp;  \\
             &amp; \ast &amp;  &amp;  \\
             &amp;  &amp; \ast &amp;  \\
             &amp; &amp; &amp; \ast
      \end{pmatrix}
      , \quad U =
      \begin{pmatrix}
        1 &amp; \ast &amp; \ast &amp; \ast \\
          &amp; 1 &amp; \ast &amp; \ast \\
          &amp;  &amp; 1 &amp; \ast \\
          &amp; &amp; &amp; 1
      \end{pmatrix}
      .\]</span> The corresponding subset and composition are <span
class="math display">\[\emptyset \subseteq \{0,1,2,3\},
      \quad
      4 = 1 + 1 + 1 +1.\]</span></p></li>
<li><p>If <span class="math inline">\(x^{(\ell)} :=
\mathop{\mathrm{diag}}(\ell^2, \ell^2, \ell^{-1}, \ell^{-3})\)</span>,
then <span class="math display">\[P =
      \begin{pmatrix}
        \ast &amp; \ast &amp; \ast &amp; \ast \\
        \ast &amp; \ast &amp; \ast &amp; \ast \\
             &amp;  &amp; \ast &amp; \ast \\
             &amp; &amp;  &amp; \ast
      \end{pmatrix}
      , \quad M =
      \begin{pmatrix}
        \ast &amp; \ast &amp;  &amp;  \\
        \ast &amp; \ast &amp;  &amp;  \\
             &amp;  &amp; \ast &amp; \\
             &amp; &amp;  &amp; \ast
      \end{pmatrix}
      , \quad U =
      \begin{pmatrix}
        1 &amp;  &amp; \ast &amp; \ast \\
          &amp; 1 &amp; \ast &amp; \ast \\
          &amp;  &amp; 1 &amp; \ast \\
          &amp; &amp; &amp; 1
      \end{pmatrix}
      .\]</span> The corresponding subset and composition are <span
class="math display">\[\{0\} \subseteq \{1,2,3\},
      \quad
      4 = 2 + 1+1.\]</span></p></li>
<li><p><span id="itm:stoes2021:1" label="itm:stoes2021:1"></span> If
<span class="math inline">\(x^{(\ell)} := \mathop{\mathrm{diag}}(\ell,
\ell, \ell^{-1}, \ell^{-1})\)</span>, then <span
class="math display">\[P =
      \begin{pmatrix}
        \ast &amp; \ast &amp; \ast &amp; \ast \\
        \ast &amp; \ast &amp; \ast &amp; \ast \\
             &amp;  &amp; \ast &amp; \ast \\
             &amp; &amp; \ast &amp; \ast
      \end{pmatrix}
      , \quad M =
      \begin{pmatrix}
        \ast &amp; \ast &amp;  &amp;  \\
        \ast &amp; \ast &amp;  &amp;  \\
             &amp;  &amp; \ast &amp; \ast \\
             &amp; &amp; \ast &amp; \ast
      \end{pmatrix}
      , \quad U =
      \begin{pmatrix}
        1 &amp;  &amp; \ast &amp; \ast \\
          &amp; 1 &amp; \ast &amp; \ast \\
          &amp;  &amp; 1 &amp;  \\
          &amp; &amp; &amp; 1
      \end{pmatrix}
      .\]</span> The corresponding subset and composition are <span
class="math display">\[\{1,3\} \subseteq \{0,1,2,3\},
      \quad
      4 = 2 + 2.\]</span></p></li>
<li><p>If <span class="math inline">\(x^{(\ell)} :=
\mathop{\mathrm{diag}}(\ell, \ell, \ell, \ell^{-3})\)</span>, then <span
class="math display">\[P =
      \begin{pmatrix}
        \ast &amp; \ast &amp; \ast &amp; \ast \\
        \ast &amp; \ast &amp; \ast &amp; \ast \\
        \ast &amp; \ast &amp; \ast &amp; \ast \\
             &amp; &amp;  &amp; \ast
      \end{pmatrix}
      , \quad M =
      \begin{pmatrix}
        \ast &amp; \ast &amp; \ast &amp;  \\
        \ast &amp; \ast &amp; \ast  &amp;  \\
        \ast &amp; \ast  &amp; \ast &amp;  \\
             &amp; &amp; &amp; \ast
      \end{pmatrix}
      , \quad U =
      \begin{pmatrix}
        1 &amp;  &amp;  &amp; \ast \\
          &amp; 1 &amp;  &amp; \ast \\
          &amp;  &amp; 1 &amp; \ast \\
          &amp; &amp; &amp; 1
      \end{pmatrix}
      .\]</span> The corresponding subset and composition are <span
class="math display">\[\{1,2\} \subseteq \{1,2,3\},
      \quad
      4 = 3 + 1.\]</span></p></li>
<li><p>If <span class="math inline">\(x^{(\ell)} = 1\)</span> for all
<span class="math inline">\(\ell\)</span>, then <span
class="math inline">\(P = M = G\)</span> and <span
class="math inline">\(U = \{1\}\)</span>. The corresponding subset and
composition are <span class="math display">\[\{1,2,3\} \subseteq
\{1,2,3\},
      \quad
      4 = 4.\]</span></p></li>
</ol>
</div>
<div id="lem:let-mathfraks-be" class="lemma">
<p><strong>Lemma 67</strong>. Let <span
class="math inline">\(\mathfrak{S}\)</span> be a Siegel domain for <span
class="math inline">\(\Gamma \backslash G\)</span>. Let <span
class="math inline">\(x^{(\ell)} \in \mathfrak{S}\)</span> be a
sequence. After passing to a subsequence, let <span
class="math inline">\(\sim\)</span> denote the corresponding equivalence
relation describing the directions along which the <span
class="math inline">\(A\)</span>-coordinates of this sequence escape to
infinity. Let <span class="math inline">\(P = M U\)</span> denote the
corresponding standard parabolic subgroup. Let <span
class="math inline">\(v \in U\)</span>. Define the sequence <span
class="math inline">\(g^{(\ell)} \in G\)</span> by writing <span
class="math display">\[v x^{(\ell)} = x^{(\ell)} g^{(\ell)}.\]</span>
Then <span class="math inline">\(g^{(\ell)}\)</span> tends to the
identity element <span class="math inline">\(1\)</span> of <span
class="math inline">\(G\)</span> as <span class="math inline">\(\ell
\rightarrow \infty\)</span>. The conclusion remains valid if we replace
<span class="math inline">\(v\)</span> by a sequence <span
class="math inline">\(v^{(\ell)}\)</span> that traverses some fixed
compact subset of <span class="math inline">\(U\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Consider the Iwasawa decomposition <span
class="math inline">\(x^{(\ell)} = u^{(\ell)} a^{(\ell)}
k^{(\ell)}\)</span>. For notational simplicity in what follows, we drop
the superscripted <span class="math inline">\({\ell}\)</span>’s and
write simply <span class="math inline">\(x = u a k\)</span>, keeping in
mind that all matrices considered may depend upon <span
class="math inline">\(\ell\)</span>. We write <span
class="math display">\[v x
    =
    u v&#39; a k
    =
    u a v&#39;&#39; k
    =
    u a k v&#39;&#39;&#39;,\]</span> where <span
class="math display">\[v u = v&#39; u,\]</span> <span
class="math display">\[v&#39; a = a v&#39;&#39;,\]</span> <span
class="math display">\[v&#39;&#39; k = k v&#39;&#39;&#39;.\]</span> Thus
<span class="math inline">\(g^{(\ell)} = v&#39;&#39;&#39;\)</span>. Our
aim is to show that <span
class="math inline">\(v&#39;&#39;&#39;\)</span> tends to the identity
element of <span class="math inline">\(G\)</span> as <span
class="math inline">\(\ell \rightarrow \infty\)</span>.</p>
<p>Since <span class="math inline">\(x\)</span> lies in a fixed Siegel
domain, we know that <span class="math inline">\(u\)</span> lies in a
fixed compact subset of <span class="math inline">\(N\)</span>. Since
<span class="math inline">\(N\)</span> normalizes <span
class="math inline">\(U\)</span> (check this), it follows that <span
class="math inline">\(v&#39;\)</span> lies in a fixed compact subset of
<span class="math inline">\(U\)</span>.</p>
<p>Next, we deduce by matrix multiplication that <span
class="math display">\[v&#39;&#39;_{i j} = \frac{a_j}{a_i} v&#39;_{i
j}.\]</span> Since <span class="math inline">\(v&#39; \in U\)</span>, we
have for <span class="math inline">\(i &gt; j\)</span> that <span
class="math inline">\(v_{i j}&#39; \neq 0\)</span> only if <span
class="math inline">\(i \not \sim j\)</span>; in that case, by the
construction of the equivalence relation <span
class="math inline">\(\sim\)</span>, we know that the ratio <span
class="math inline">\(a_j / a_i\)</span> tends to zero as <span
class="math inline">\(\ell \rightarrow \infty\)</span>. Thus <span
class="math inline">\(v&#39;&#39;\)</span> tends to the identity element
<span class="math inline">\(1\)</span> of <span
class="math inline">\(U\)</span> as <span class="math inline">\(\ell
\rightarrow \infty\)</span>.</p>
<p>Since <span class="math inline">\(k\)</span> lies in the fixed
compact subset <span class="math inline">\(K\)</span> of <span
class="math inline">\(G\)</span>, we conclude as required that <span
class="math inline">\(v&#39;&#39;&#39;\)</span> tends to the identity
element of <span class="math inline">\(G\)</span>. ◻</p>
</span></div>
<h2 id="sec:appr-const-terms">§4.3. Approximation by constant terms</h2>
<h3 id="sec:approx-const-terms-informal-discussion">§4.3.1. Informal
discussion</h3>
<p>Let <span class="math inline">\(\varphi : \Gamma \backslash G
\rightarrow \mathbb{C}\)</span> be an automorphic form. We have noted
that we may then write <span class="math inline">\(\varphi = \varphi
\ast f\)</span> for some <span class="math inline">\(f \in
C_c^\infty(G)\)</span>. Let us encode this relationship informally as
the assertion that <span id="eq:varphix-g-approx" class="math display">\[\label{eq:varphix-g-approx}\tag{25}
  \varphi(x g) \approx \varphi(x)\]</span> for all <span
class="math inline">\(x \in \Gamma \backslash G\)</span> and all
<em>small</em> <span class="math inline">\(g \in G\)</span>, or in
words, that <span class="math inline">\(\varphi\)</span> enjoys some
form of uniform continuity under right translation by <span
class="math inline">\(G\)</span>. The precise meaning is that this
approximation becomes an identity when integrated against <span
class="math inline">\(f(g) \, d g\)</span>. We then have the following
informal lemma.</p>
<div class="lemma">
<p><strong>Lemma 68</strong> (Informal). Let <span
class="math inline">\(\mathfrak{S}\)</span> be a Siegel domain. Let
<span class="math inline">\(x^{(\ell)} \in \mathfrak{S}\)</span> be a
sequence. Let <span class="math inline">\(P = M U\)</span> denote the
standard parabolic subgroup of <span class="math inline">\(G\)</span>
attached to <span class="math inline">\(x^{(\ell)}\)</span>, as in Lemma
<a href="#lem:let-mathfraks-be" data-reference-type="ref"
data-reference="lem:let-mathfraks-be">67</a>, after passing to a
suitable subsequence. Then for large <span
class="math inline">\(\ell\)</span> and all <span
class="math inline">\(u \in U\)</span>, we have <span
class="math display">\[\varphi(x^{(\ell)}) \approx \varphi(u
x^{(\ell)}).\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Since <span class="math inline">\(\varphi\)</span> is
left-invariant under <span class="math inline">\(\Gamma_U\)</span> and
the quotient <span class="math inline">\(\Gamma_U \backslash U\)</span>
is compact, we may take <span class="math inline">\(u\)</span> to lie in
a fixed compact fundamental domain for that quotient (e.g., that
obtained by requiring that each above-diagonal entry have magnitude
bounded by <span class="math inline">\(1/2\)</span>). Then, writing
<span class="math inline">\(u x^{(\ell)} = x^{(\ell)}
g^{(\ell)}\)</span>, we have by Lemma <a href="#lem:let-mathfraks-be"
data-reference-type="ref" data-reference="lem:let-mathfraks-be">67</a>
that <span class="math inline">\(g^{(\ell)} \rightarrow 1\)</span> as
<span class="math inline">\(\ell \rightarrow \infty\)</span>. The claim
then follows from <a href="#eq:varphix-g-approx"
data-reference-type="eqref"
data-reference="eq:varphix-g-approx">\((25)\)</a>. ◻</p>
</span></div>
<p>By averaging the above estimate over <span
class="math inline">\(u\)</span> in the compact group <span
class="math inline">\(\Gamma_U \backslash U\)</span> with respect to a
probability Haar measure <span class="math inline">\(d u\)</span>, we
obtain:</p>
<div id="cor:with-notat-assumpt" class="corollary">
<p><strong>Corollary 69</strong> (Informal). <em>With notation and
assumptions as above, we have <span
class="math display">\[\varphi(x^{(\ell)}) \approx \int_{u \in \Gamma_U
\backslash U} \varphi(u x^{(\ell)}) \, d u.\]</span></em></p>
</div>
<p>In the following subsections, we formulate a rigorous result in the
spirit of the above informal discussion.</p>
<h3 id="rigorous-formulation">Rigorous formulation</h3>
<p>Let <span class="math inline">\(\varphi : \Gamma \backslash G
\rightarrow \mathbb{C}\)</span> be an automorphic form, and <span
class="math inline">\(\mathfrak{S}\)</span> a Siegel domain. Let <span
class="math inline">\(m\)</span> be such that <span
class="math inline">\(\varphi\)</span> satisfies the “uniform moderate
growth” condition (Definition <a
href="#defn:we-say-that-uniform-moderate-growth"
data-reference-type="ref"
data-reference="defn:we-say-that-uniform-moderate-growth">61</a>) with
exponent <span class="math inline">\(m\)</span>.</p>
<p>Let <span class="math inline">\(\mathfrak{S}\)</span> be a Siegel
domain, and suppose now that <span class="math inline">\(\Gamma
\backslash G = {\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> (cf. §<a
href="#sec:reduction-from-gl_n" data-reference-type="ref"
data-reference="sec:reduction-from-gl_n">4.1</a>). Let <span
class="math inline">\(x \in \mathfrak{S}\)</span>, and write <span
class="math inline">\(x = u a k\)</span>. Then <span
class="math inline">\(a_1 \gg \dotsb \gg a_n\)</span> and <span
class="math inline">\(a_1 \dotsb a_n = 1\)</span>. On the other hand,
since <span class="math inline">\(u\)</span> and <span
class="math inline">\(k\)</span> lie in fixed compact sets, we have (by
Exercise <a href="#eq:u-x-u" data-reference-type="ref"
data-reference="eq:u-x-u">19</a>) <span
class="math display">\[\|x\| \asymp \|a\| \asymp
\max(a_1,\dotsc,a_n,1/a_1,\dotsc,1/a_n) \asymp \max(a_1,1/a_n) \ll
a_1/a_n,\]</span> say. In particular, <span
class="math inline">\(\|x\|^m \ll a(x)^{\lambda}\)</span> with <span
class="math inline">\(\lambda\)</span> the dominant weight defined by
<span class="math inline">\(a^{\lambda} := a_1/a_n\)</span>. The uniform
moderate growth condition on <span
class="math inline">\(\varphi\)</span> thus implies that <span id="eq:d-varphix-ll" class="math display">\[\label{eq:d-varphix-ll}\tag{26}
  D \varphi(x) \ll a(x)^{\lambda}\]</span> for fixed <span
class="math inline">\(D \in \mathfrak{U}(\mathfrak{g})\)</span> and all
<span class="math inline">\(x \in \mathfrak{S}\)</span>.</p>
<p>Let <span class="math inline">\(P = M U\)</span> be a standard
parabolic subgroup of <span class="math inline">\(G\)</span>.</p>
<div id="defn:stoes2021:emphc-term-varphi" class="definition">
<p><strong>Definition 70</strong>. The <em>constant term</em> of <span
class="math inline">\(\varphi\)</span> with respect to <span
class="math inline">\(P\)</span> is the function <span
class="math inline">\(\varphi_P : G \rightarrow \mathbb{C}\)</span>
defined by <span class="math display">\[\varphi_P(g) := \int _{u \in
\Gamma_U \backslash U} \varphi(u g) \, d u,\]</span> where <span
class="math inline">\(d u\)</span> denotes the probability Haar measure
on <span class="math inline">\(\Gamma_U \backslash U\)</span>.</p>
</div>
<div class="example">
<p><strong>Example 71</strong>. If <span class="math inline">\(P =
G\)</span>, then <span class="math inline">\(M = G\)</span> and <span
class="math inline">\(U = \{1\}\)</span>, so <span
class="math inline">\(\varphi_P = \varphi_G = \varphi\)</span>. In the
remaining cases <span class="math inline">\(P \subsetneq G\)</span>,
this definition is more interesting.</p>
</div>
<p>The group <span class="math inline">\(A\)</span> acts on <span
class="math inline">\(U\)</span> and its Lie algebra <span
class="math inline">\(\mathfrak{u}\)</span> by conjugation. We denote
below by <span class="math inline">\(\beta\)</span> one of the
(dominant) weights describing an eigenvalue for the latter action.
Explicitly, <span class="math inline">\(\beta\)</span> is uniquely of
the form <span class="math inline">\(a^\beta = a_i / a_j\)</span> for
some <span class="math inline">\(i &lt; j\)</span> with <span
class="math inline">\(i \not \simeq j\)</span> in the equivalence
relation attached to <span class="math inline">\(P\)</span>.</p>
<div id="prop:let-varphi-be" class="proposition">
<p><strong>Proposition 72</strong>. <em>Let <span
class="math inline">\(\varphi\)</span> be an automorphic form. Then for
each fixed <span class="math inline">\(N \geq 0\)</span> and all <span
class="math inline">\(x \in \mathfrak{S}\)</span>, <span id="eq:varphi-x-varphi_px" class="math display">\[\label{eq:varphi-x-varphi_px}\tag{27}
    \varphi (x) - \varphi_P(x) \ll \max _{\beta } a(x)^{\lambda - N
\beta },\]</span> where <span class="math inline">\(\beta\)</span> runs
over eigenvalues for <span class="math inline">\(A \circlearrowright
\mathfrak{u}\)</span> as above.</em></p>
</div>
<div class="example">
<p><strong>Example 73</strong>. Suppose <span
class="math inline">\(P\)</span> is <em>maximal</em> among proper
standard parabolic subgroups. Thus <span
class="math inline">\(P\)</span> corresponds to a composition of the
form <span class="math inline">\(n = n_1 + n_2\)</span> with <span
class="math inline">\(n_1, n_2 \geq 1\)</span> (as in cases <a
href="#itm:stoes2021:1" data-reference-type="eqref"
data-reference="itm:stoes2021:1">\((iii)\)</a> and <a
href="#itm:stoes2021:2" data-reference-type="eqref"
data-reference="itm:stoes2021:2">\((iv)\)</a> of Example <a
href="#example:stoes2021:take-g-=" data-reference-type="ref"
data-reference="example:stoes2021:take-g-=">66</a>,
but not the other cases). Then every <span
class="math inline">\(\beta\)</span> as in Proposition <a
href="#prop:let-varphi-be" data-reference-type="ref"
data-reference="prop:let-varphi-be">72</a> is an integer multiple of the
element <span class="math inline">\(\alpha\)</span> given by <span
class="math inline">\(a^{\alpha} = a_{n_1} / a_{n_1+1}\)</span>, and so
the conclusion may be formulated equivalently as the estimate <span id="eq:varphi-x-varphi_px-maximal" class="math display">\[\label{eq:varphi-x-varphi_px-maximal}\tag{28}
    \varphi (x) - \varphi_P(x) \ll a(x)^{\lambda - N \alpha
}.\]</span></p>
</div>
<p>Before giving the proof of Proposition <a href="#prop:let-varphi-be"
data-reference-type="ref" data-reference="prop:let-varphi-be">72</a>,
let us indicate how one might apply this lemma in practice. Given <span
class="math inline">\(x \in \mathfrak{S}\)</span>, we may define (e.g.,
as in the above discussion concerning a sequence <span
class="math inline">\(x^{(\ell)}\)</span>) an equivalence relation <span
class="math inline">\(\sim\)</span> on <span class="math inline">\(\{1,
\dotsc, n\}\)</span> describing which ratios <span
class="math inline">\(a_i/a_j\)</span> are considered “large” and which
are considered “small.” We then form the corresponding standard
parabolic subgroup <span class="math inline">\(P = M U\)</span>. By
construction, the quantities <span
class="math inline">\(a(x)^{\beta}\)</span> are all “large.” Since <span
class="math inline">\(N\)</span> can be taken arbitrarily large, it
follows that the RHS of <a href="#eq:varphi-x-varphi_px"
data-reference-type="eqref"
data-reference="eq:varphi-x-varphi_px">\((27)\)</a> is
“small” – that is to say, that <span
class="math inline">\(\varphi\)</span> is well-approximated by its
constant term <span class="math inline">\(\varphi_P\)</span> on such
elements <span class="math inline">\(x\)</span>. Such conclusions may be
understood as rigorous versions of Corollary <a
href="#cor:with-notat-assumpt" data-reference-type="ref"
data-reference="cor:with-notat-assumpt">69</a>.</p>
<h3 id="sec:proof-when-n=2">§4.3.3. Proof when <span
class="math inline">\(n=2\)</span></h3>
<p>Here we record the proof of Proposition <a href="#prop:let-varphi-be"
data-reference-type="ref" data-reference="prop:let-varphi-be">72</a> in
the simplest nontrivial case, in which <span class="math inline">\(n =
2\)</span> and <span class="math inline">\(P\)</span> is the group of
upper-triangular matrices. It will be convenient to introduce, for <span
class="math inline">\(x \in \mathbb{R}\)</span> and <span
class="math inline">\(y \in \mathbb{R}^\times_+\)</span>, the notation
<span class="math display">\[u(x) :=
  \begin{pmatrix}
    1 &amp; x \\
    0 &amp; 1
  \end{pmatrix}
  ,
  \quad
  a(y) :=
  \begin{pmatrix}
    y^{1/2} &amp; 0 \\
    0 &amp; y^{-1/2}
  \end{pmatrix}
  .\]</span> There is only one relevant value of <span
class="math inline">\(\beta\)</span>, for which <span
class="math inline">\(a(y)^{\beta} = y\)</span>. Our Siegel domain
consists of elements <span class="math inline">\(g = u(x) a(y)
k\)</span> with <span class="math inline">\(|x| \leq 1/2\)</span> and
<span class="math inline">\(y \geq t &gt; 0\)</span>, say. Our
hypothesis is that <span class="math inline">\(\varphi\)</span> and its
derivatives are majorized on such elements by <span
class="math inline">\(y^{\lambda}\)</span> for some <span
class="math inline">\(\lambda \geq 0\)</span>. Our task is thus to show,
for <span class="math inline">\(y \gg 1\)</span>, that <span id="eq:varphig-varphi_pg-ll" class="math display">\[\label{eq:varphig-varphi_pg-ll}\tag{29}
  \varphi(g) - \varphi_P(g) \ll  y^{\lambda - N \beta}.\]</span> for
each fixed <span class="math inline">\(N\)</span>. Note that this
translates, via the recipe of §<a href="#sec:relat-class-modul"
data-reference-type="ref"
data-reference="sec:relat-class-modul">3.8</a>, to weaker forms of
estimates like <a href="#eq:sum_n-geq-0" data-reference-type="eqref"
data-reference="eq:sum_n-geq-0">\((23)\)</a>.</p>
<p>Define the function <span class="math inline">\(\phi :
\mathbb{R}/\mathbb{Z} \rightarrow \mathbb{C}\)</span> by <span
class="math display">\[\phi (t)  := \varphi(n(t) g).\]</span> Then <span
class="math inline">\(\varphi_P(g) = \int \phi := \int_0^1 \phi(t) \, d
t\)</span>, so the quantity to be estimated in <a
href="#eq:varphig-varphi_pg-ll" data-reference-type="eqref"
data-reference="eq:varphig-varphi_pg-ll">\((29)\)</a>
is <span id="eq:phi0-int-phi" class="math display">\[\label{eq:phi0-int-phi}\tag{30}
  \phi(0) - \int \phi =
  \int _{0}^1 (\phi(0) - \phi(t) ) \, d t
  = - \int_{0}^1 \int_0^t \phi &#39; (s) \, d s \, d t
  = - \int_0^1 (1-s) \phi &#39;(s) \, d s.\]</span> It will thus suffice
to show that <span class="math display">\[\phi &#39;(t) \ll y^{\lambda -
N \beta}\]</span> for all <span class="math inline">\(t\)</span>.</p>
<p>Our hypotheses <a href="#eq:d-varphix-ll" data-reference-type="eqref"
data-reference="eq:d-varphix-ll">\((26)\)</a> on <span
class="math inline">\(\phi\)</span> concerns its derivatives with
respect to left-invariant differential operators, induced by the action
of <span class="math inline">\(G\)</span> on <span
class="math inline">\(\Gamma \backslash G\)</span> via right
translation. To apply these here, we need to express the “ordinary”
derivative <span class="math inline">\(\phi &#39;(t)\)</span> in terms
of such differential operators. This is achieved as follows. First, the
Lie algebra element <span class="math display">\[X :=
  \begin{pmatrix}
    0 &amp; 1 \\
    0 &amp; 0
  \end{pmatrix}\]</span> of <span class="math inline">\(\mathfrak{g} =
\mathop{\mathrm{Lie}}(G)\)</span> is an infinitesimal generator of the
subgroup <span class="math inline">\(N\)</span>. We indeed have <span
class="math display">\[\phi&#39;(t) = \frac{d}{d t} \varphi(e^{t X}
g).\]</span> The RHS of this last identity may be understood as the
evaluation of the derivative of <span
class="math inline">\(\varphi\)</span> at the tangent vector to <span
class="math inline">\(G\)</span> at <span
class="math inline">\(g\)</span> given by <span class="math display">\[X
u(x) a(y) k.\]</span> We can rewrite this tangent vector as <span
class="math display">\[y^{-1} u(x) a(y)  X k,\]</span> using here the
matrix conjugation identities <span class="math inline">\(u(x) X = X
u(x)\)</span> and <span class="math inline">\(a(y)^{-1} X a(y) = y^{-1}
X\)</span>, and then further as <span class="math display">\[y^{-1} g (
k^{-1} X k).\]</span> In other words, we have shown that <span
class="math display">\[\phi &#39;(t) = y^{-1} \frac{d}{d t} \varphi(g
e^{t X^k}),
  \quad
  X^k := k^{-1} X k.\]</span> Now since <span
class="math inline">\(k\)</span> lies in the fixed compact subgroup
<span class="math inline">\(\mathop{\mathrm{SO}}(2)\)</span>, we know
that <span class="math inline">\(X^k\)</span> lies in some fixed compact
subset of <span class="math inline">\(\mathfrak{g}\)</span>. Therefore
the uniform moderate growth condition <a href="#eq:d-varphix-ll"
data-reference-type="eqref"
data-reference="eq:d-varphix-ll">\((26)\)</a> implies that
<span class="math display">\[\phi &#39;(t) \ll y^{\lambda -1}.\]</span>
This gives the required estimate in the special case <span
class="math inline">\(N = 1\)</span>. In general, we iterate the
argument. We verify first, exactly as above, that <span
class="math display">\[\phi^{(N)}(t) \ll y^{\lambda - N}.\]</span> We
then use the integral formulas, for <span class="math inline">\(j=1,
\dotsc, N-1\)</span>, <span class="math display">\[\phi^{(j)}(t) = -
\int_0^1 (1 - s) \phi^{(j+1)} (s + t) \,d s,\]</span> proved in the same
way as <a href="#eq:phi0-int-phi" data-reference-type="eqref"
data-reference="eq:phi0-int-phi">\((30)\)</a>, to show by
descending induction on <span class="math inline">\(j=N,
N-1,\dotsc,2,1\)</span> that <span class="math display">\[\phi^{(j)}(t)
\ll y^{\lambda - N}.\]</span> The same estimate then holds for <span
class="math inline">\(\phi(t)\)</span> thanks again to <a
href="#eq:phi0-int-phi" data-reference-type="eqref"
data-reference="eq:phi0-int-phi">\((30)\)</a>. The proof is now
complete.</p>
<div class="remark">
<p><strong>Remark 74</strong>. Another useful way to analyze differences
as in <a href="#eq:phi0-int-phi" data-reference-type="eqref"
data-reference="eq:phi0-int-phi">\((30)\)</a> is via Fourier
inversion, which gives for a smooth function <span
class="math inline">\(\phi : \mathbb{R} / \mathbb{Z} \rightarrow
\mathbb{C}\)</span> the identity <span class="math display">\[\phi(0) =
\sum _{n \in \mathbb{Z} } a_n, \quad
    a_n := \int _{\mathbb{R}/\mathbb{Z}} \phi (x) e (n x ) \,d
x.\]</span> We have <span class="math inline">\(a_0 = \int
\phi\)</span>. On the other hand, integration by parts gives for any
<span class="math inline">\(j \in \mathbb{Z}_{\geq 0}\)</span> that
<span class="math display">\[a_n = (-2 \pi i n)^{-j} \int _{\mathbb{R} /
\mathbb{Z} } \phi^{(j)} e(n x) \, d x,\]</span> so that in particular
<span class="math display">\[|a_n| \leq |2 \pi n|^{-j}
\|\phi^{(j)}\|_{\infty}.\]</span> Thus for <span
class="math inline">\(j\)</span> large enough that <span
class="math inline">\(\sum_{n \neq 0} |n|^{-j} &lt; \infty\)</span>
(i.e., <span class="math inline">\(j \geq 2\)</span>), we have <span
class="math display">\[\phi (0) - \int \phi \ll
\|\phi^{(j)}\|_{\infty}.\]</span> This last estimate may be applied in
the above argument and in many other situations.</p>
</div>
<h3 id="the-general-argument">The general argument</h3>
<p>In general, we find a filtration of <span
class="math inline">\(U\)</span> by subgroups <span
class="math display">\[U = U_1 &gt; U_2 &gt; \dotsb &gt; U_q &gt;
U_{q+1} = \{1\},\]</span> with dimensions decreasing by one, in such a
way that</p>
<ul>
<li><p>each Lie-algebraic quotient <span
class="math inline">\(\mathop{\mathrm{Lie}}(U_j) /
\mathop{\mathrm{Lie}}(U_{j+1})\)</span> corresponds to some eigenvalue
<span class="math inline">\(\beta_j\)</span> for <span
class="math inline">\(A \circlearrowright \mathfrak{u}\)</span> as
above, and</p></li>
<li><p>each group-theoretic quotient <span class="math inline">\(U_j /
U_{j+1}\)</span> is central in <span class="math inline">\(U /
U_{j+1}\)</span>.</p></li>
</ul>
<div id="exa:case--g" class="example">
<p><strong>Example 75</strong>. In the case <span
class="math display">\[G = {\mathop{\mathrm{SL}}}_3(\mathbb{R}), \quad
    P =
    \begin{pmatrix}
      \ast &amp; \ast &amp; \ast \\
           &amp; \ast &amp; \ast \\
           &amp;  &amp; \ast
    \end{pmatrix}
    ,
    \quad
    U =
    \begin{pmatrix}
      1 &amp; \ast &amp; \ast \\
        &amp; 1 &amp; \ast \\
        &amp;  &amp; 1
    \end{pmatrix}
    ,\]</span> we may take <span class="math inline">\(q = 3\)</span>
and <span class="math display">\[U_2 =
    \begin{pmatrix}
      1 &amp; 0 &amp; \ast \\
        &amp; 1 &amp; \ast \\
        &amp;  &amp; 1
    \end{pmatrix}
    ,
    \quad
    U_3 =
    \begin{pmatrix}
      1 &amp; 0 &amp; \ast \\
        &amp; 1 &amp; 0 \\
        &amp;  &amp; 1
    \end{pmatrix}
    .\]</span></p>
</div>
<div class="exercise">
<p><strong>Exercise 25</strong>. Verify in general that such a
filtration exists.</p>
</div>
<p>We then define <span class="math display">\[\varphi_{q+1} :=
\varphi\]</span> and, by descending induction on <span
class="math inline">\(j = q, q-1, \dotsc, 1\)</span>, <span
class="math display">\[\varphi_{j}(g) := \int _{u \in \Gamma_{U_j}
\backslash U_j} \varphi_{j+1}(u g) \, d u.\]</span></p>
<div class="exercise">
<p><strong>Exercise 26</strong>. Verify that <span
class="math inline">\(\varphi_P = \varphi_1\)</span>.</p>
</div>
<p>Since <span class="math inline">\(\varphi = \varphi_{q+1}\)</span>,
we have <span class="math display">\[\varphi  - \varphi_P = \sum
_{j=1}^q (\varphi_{j+1} - \varphi_j),\]</span> and our task reduces to
verifying for each fixed <span class="math inline">\(N \geq 0\)</span>
and all <span class="math inline">\(x \in \mathfrak{S}\)</span> that
<span id="eq:varph-varph-ll" class="math display">\[\label{eq:varph-varph-ll}\tag{35}
  \varphi_{j+1}(x) - \varphi_j(x) \ll a(x)^{\lambda - N
\beta_j}.\]</span> The groups <span class="math inline">\(U_j /
U_{j+1}\)</span> are isomorphic to <span
class="math inline">\(\mathbb{R}\)</span>, while the further quotients
<span class="math inline">\(\Gamma_j \backslash U_j / U_{j+1}\)</span>
are isomorphic to <span
class="math inline">\(\mathbb{R}/\mathbb{Z}\)</span>. Indeed, if we let
<span class="math inline">\(X_j \in \mathfrak{u}\)</span> denote the
elementary matrix with eigenvalue <span
class="math inline">\(\beta_j\)</span> under the adjoint action of <span
class="math inline">\(A\)</span>, then the map <span
class="math display">\[\mathbb{R} / \mathbb{Z} \ni t  \mapsto u_j(t) :=
e^{t X_j}  U_j\]</span> induces an isomorphism onto <span
class="math inline">\(\Gamma_j \backslash U_j / U_{j+1}\)</span>.</p>
<div class="example">
<p><strong>Example 76</strong>. In the setting of Example <a
href="#exa:case--g" data-reference-type="ref"
data-reference="exa:case--g">75</a>, <span class="math display">\[u_3(t)
=
    \begin{pmatrix}
      1 &amp; 0 &amp; t \\
        &amp; 1 &amp; 0 \\
        &amp;  &amp; 1
    \end{pmatrix}
    ,
    \quad
    u_2(t) =
    \begin{pmatrix}
      1 &amp; 0 &amp; 0 \\
        &amp; 1 &amp; t \\
        &amp;  &amp; 1
    \end{pmatrix}
    ,
    \quad
    u_1(t) =
    \begin{pmatrix}
      1 &amp; t &amp; 0 \\
        &amp; 1 &amp; 0 \\
        &amp;  &amp; 1
    \end{pmatrix}
    .\]</span></p>
</div>
<p>Now, given <span class="math inline">\(j \in \{1, \dotsc,
q\}\)</span> and <span class="math inline">\(x \in
\mathfrak{S}\)</span>, define <span class="math inline">\(\phi :
\mathbb{R}/\mathbb{Z} \rightarrow \mathbb{C}\)</span> by <span
class="math display">\[\phi(t) := \varphi_{j+1}(u_j(t) x).\]</span>
Clearly <span class="math inline">\(\phi(0) =
\varphi_{j+1}(x)\)</span>.</p>
<div class="exercise">
<p><strong>Exercise 27</strong>. Verify that <span
class="math inline">\(\int \phi = \varphi_{j}(x)\)</span>.</p>
</div>
<p>Our task <a href="#eq:varph-varph-ll" data-reference-type="eqref"
data-reference="eq:varph-varph-ll">\((35)\)</a> thereby
reduces to showing that <span id="eq:phi0-int-phi-1" class="math display">\[\label{eq:phi0-int-phi-1}\tag{36}
  \phi(0) - \int \phi \ll a(x)^{\lambda - N \beta_j}.\]</span> This last
estimate may be proved by the same argument as in §<a
href="#sec:proof-when-n=2" data-reference-type="ref"
data-reference="sec:proof-when-n=2">4.3.3</a> (see <a href="#ref-MR2331343"
class="citation" data-cites="MR2331343">(Borel 2007, sec. 6.7)</a> or
<a href="#ref-MR1361168" class="citation" data-cites="MR1361168">(Mœglin and Waldspurger
1995, vol. 113, sec. I.2.10)</a> for detailed expositions).</p>
<h2 id="properties-of-the-constant-term">Properties of the constant
term</h2>
<p>Above, we defined for each reasonable function <span
class="math inline">\(\varphi : \Gamma \backslash G \rightarrow
\mathbb{C}\)</span> and each standard parabolic subgroup <span
class="math inline">\(P = M U\)</span> of <span
class="math inline">\(G\)</span> the constant term <span
class="math inline">\(\varphi _P\)</span>. Here we summarize some of its
basic properties.</p>
<p>Observe that <span class="math inline">\(U\)</span> is a normal
subgroup of <span class="math inline">\(P\)</span>, so <span
class="math inline">\(\Gamma_P U\)</span> is a group, and we may form
the quotient <span class="math inline">\(\Gamma_P U \backslash
G\)</span>. This quotient fits into the fiber bundle <span
class="math display">\[\begin{CD}         
    \Gamma_M \backslash M @&gt;&gt;&gt; \Gamma_P U \backslash G \\
    @.  @VVV \\
    @. P \backslash G. \\
  \end{CD}\]</span> The quotient space <span class="math inline">\(P
\backslash G\)</span> is compact, by the Iwasawa decomposition <span
class="math inline">\(G = P K\)</span>.</p>
<p>Suppose for instance that <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. Then <span
class="math inline">\(M \cong \prod_{j=1}^k
{\mathop{\mathrm{GL}}}_{n_k}(\mathbb{R})\)</span> (see the examples of §<a
href="#sec:stand-parab-subgr" data-reference-type="ref"
data-reference="sec:stand-parab-subgr">4.2</a>), <span
class="math inline">\(\Gamma_M \backslash M \cong \prod_{j=1}^k
{\mathop{\mathrm{GL}}}_{n_j}(\mathbb{Z}) \backslash
{\mathop{\mathrm{GL}}}_{n_j}(\mathbb{R})\)</span>. If <span
class="math inline">\(P\)</span> is a <em>proper</em> parabolic (i.e.,
<span class="math inline">\(P \neq G\)</span>), then each <span
class="math inline">\(n_j &lt; n\)</span>. One has a similar but
slightly more complicated description when <span class="math inline">\(G
= {\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>. In either case, we can
understand <span class="math inline">\(\Gamma_P U \backslash G\)</span>
as the total space of a fiber bundle with compact base and fibers given
by products of quotients much like <span class="math inline">\(\Gamma
\backslash G\)</span>, but with <span class="math inline">\(n\)</span>
replaced by something smaller. This feature often permits us to
establish properties of <span class="math inline">\(\Gamma \backslash
G\)</span> (or spaces of functions on it, etc.) by induction on <span
class="math inline">\(n\)</span>; we will see a first example later
today.</p>
<div class="lemma">
<p><strong>Lemma 77</strong>. <span
class="math inline">\(\varphi_P\)</span> is left-invariant under <span
class="math inline">\(\Gamma_P U\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Left-invariance under <span
class="math inline">\(U\)</span> follows from the right-invariance of
the Haar measure <span class="math inline">\(d u\)</span> on <span
class="math inline">\(\Gamma_U \backslash U\)</span>: for <span
class="math inline">\(x \in G\)</span> and <span class="math inline">\(g
\in U\)</span>, <span class="math display">\[\varphi_P(g x) =
    \int _{u \in \Gamma_U \backslash U}
    \varphi(u g x) \, d u
    =
    \int _{u \in \Gamma_U \backslash U}
    \varphi(u x) \, d u
    = \varphi_P(x).\]</span> To see the left invariance under <span
class="math inline">\(\gamma \in \Gamma_P\)</span>, use the left
invariance of <span class="math inline">\(\varphi\)</span> under <span
class="math inline">\(\Gamma\)</span> to write <span
class="math display">\[\varphi_P(\gamma x)
    = \int _{u \in \Gamma_U \backslash U}
    \varphi(u \gamma x) \, d u
    = \int _{u \in \Gamma_U \backslash U}
    \varphi(\gamma^{-1} u \gamma x) \, d u
    =
    |c|
    \int _{u \in \Gamma_U \backslash U}
    \varphi(u x) \, d u,\]</span> where <span class="math inline">\(c
\in \mathbb{R}^\times\)</span> denotes the determinant of the adjoint
action of <span class="math inline">\(\gamma\)</span> on the Lie algebra
<span class="math inline">\(\mathfrak{u}\)</span> of <span
class="math inline">\(U\)</span>. We may compute this determinant
explicitly: writing <span class="math inline">\(M =
{\mathop{\mathrm{GL}}}_{n_1}(\mathbb{R}) \times \dotsb \times
{\mathop{\mathrm{GL}}}_{n_k}(\mathbb{R})\)</span> with <span
class="math inline">\(n_1 + \dotsb + n_k = n\)</span> and writing <span
class="math inline">\(\gamma_j \in
{\mathop{\mathrm{GL}}}_{n_j}(\mathbb{R})\)</span> for the image of the
projection of <span class="math inline">\(\gamma\)</span> to <span
class="math inline">\(M\)</span>, we see that <span
class="math inline">\(c = \prod_{j=1}^k \det(\gamma_j)^{b_i}\)</span>
for some integers <span class="math inline">\(b_i\)</span>. On the other
hand, since <span class="math inline">\(\gamma\)</span> lies in <span
class="math inline">\(\Gamma_P\)</span>, we have <span
class="math inline">\(\gamma_j \in
{\mathop{\mathrm{GL}}}_{n_j}(\mathbb{Z})\)</span>, so <span
class="math inline">\(\det(\gamma_j) \in \{\pm 1\}\)</span>. Thus <span
class="math inline">\(|c| = 1\)</span>, as required. ◻</p>
</span></div>
<div class="definition">
<p><strong>Definition 78</strong>. We say that a function <span
class="math inline">\(f : \Gamma_P U \backslash G \rightarrow
\mathbb{C}\)</span> is an <em>automorphic form</em> if it satisfies the
following conditions, analogous to those in Definition <a
href="#defn:an-emph-form" data-reference-type="ref"
data-reference="defn:an-emph-form">46</a>.</p>
<ol>
<li><p><span class="math inline">\(f\)</span> is right <span
class="math inline">\(K\)</span>-finite.</p></li>
<li><p><span class="math inline">\(f\)</span> is <span
class="math inline">\(\mathfrak{Z}(\mathfrak{m})\)</span>-finite, where
<span class="math inline">\(\mathfrak{Z}(\mathfrak{m})\)</span> denotes
the center of the universal enveloping algebra of <span
class="math inline">\(\mathfrak{m} =
\mathop{\mathrm{Lie}}(M)\)</span>.</p></li>
<li><p><span class="math inline">\(f\)</span> is of moderate
growth.</p></li>
</ol>
</div>
<div class="lemma">
<p><strong>Lemma 79</strong>. Let <span
class="math inline">\(\varphi\)</span> be an automorphic form on <span
class="math inline">\(\Gamma \backslash G\)</span>. Then <span
class="math inline">\(\varphi_P\)</span> is an automorphic form on <span
class="math inline">\(\Gamma_P U \backslash G\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Right <span
class="math inline">\(K\)</span>-finiteness follows immediately from
that of <span class="math inline">\(\varphi\)</span> (note that <span
class="math inline">\(\varphi_P\)</span> is defined as an average of
left translates of <span class="math inline">\(\varphi\)</span> and that
left translation commutes with right translation). The moderate growth
property follows from that of <span class="math inline">\(f\)</span>
thanks to the observation <a href="#eq:u-x-u"
data-reference-type="eqref" data-reference="eq:u-x-u">\((19)\)</a> and
the compactness of <span class="math inline">\(\Gamma_U \backslash
U\)</span>. It remains to verify the <span
class="math inline">\(\mathfrak{Z}(\mathfrak{m})\)</span>-finiteness
property.</p>
<p>We observe first what this amounts to in the case that <span
class="math inline">\(G = {\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>
and <span class="math inline">\(\varphi = \varphi_f\)</span> for some
classical holomorphic modular form <span class="math inline">\(f :
\mathbb{H} \rightarrow \mathbb{C}\)</span> of weight <span
class="math inline">\(m\)</span> (see §<a href="#sec:relat-class-modul"
data-reference-type="ref"
data-reference="sec:relat-class-modul">3.8</a>) and <span
class="math inline">\(P =
  \begin{pmatrix}
    \ast &amp; \ast \\
    0 &amp; \ast
  \end{pmatrix}\)</span>. Then <span
class="math inline">\(\varphi_P\)</span> is described in Iwasawa
coordinates by the classical constant term <span
class="math inline">\(a_0(z) := \int _{u \in \mathbb{R}/\mathbb{Z} }
f(z+u) \,d u\)</span>. Of course <span class="math inline">\(a_0(x + i
y) = a_0(i y)\)</span>, so <span class="math inline">\(a_0\)</span> is
really a function of one variable. On the other hand, it is well-known
that the holomorphy of <span class="math inline">\(f\)</span> implies
that <span class="math inline">\(a_0(i y)\)</span> is independent of
<span class="math inline">\(y\)</span>; it is the constant term in the
<span class="math inline">\(q\)</span>-expansion <span
class="math inline">\(f(z) = \sum_{n \geq 0} a_n e(n z)\)</span>. To
obtain a direct proof of this independence, one writes down the
Cauchy–Riemann equations describing the holomorphy of <span
class="math inline">\(f\)</span> in Cartesian coordinates, and separates
variables; one deduces in this way that the real and imaginary parts of
<span class="math inline">\(a_0(i y)\)</span> have vanishing derivative
with respect to <span class="math inline">\(y\)</span>, hence that <span
class="math inline">\(a_0\)</span> is indeed constant.</p>
<p>The general proof is similar, but requires a more explicit
description of <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span> than we have
given thus far (see Example <a href="#example:stoes2021:g-=-gl_nmathbbr"
data-reference-type="ref"
data-reference="example:stoes2021:g-=-gl_nmathbbr">56</a> and
references). ◻</p>
</span></div>
<h2 id="eisenstein-series-defined-via-series">Eisenstein series defined
via series</h2>
<div class="definition">
<p><strong>Definition 80</strong>. Let <span class="math inline">\(P = M
U\)</span> be a parabolic subgroup of <span
class="math inline">\(G\)</span>. Let <span class="math inline">\(f :
\Gamma_P U \backslash G \rightarrow \mathbb{C}\)</span> and let <span
class="math inline">\(g \in G\)</span>. We define <span id="eq:eisfg-:=-sum" class="math display">\[\label{eq:eisfg-:=-sum}\tag{37}
    \mathop{\mathrm{Eis}}(f)(g) := \sum _{\gamma \in \Gamma_P \backslash
\Gamma } f(\gamma g),\]</span> provided that the series converges
absolutely; in that case, we obtain a function <span
class="math display">\[\mathop{\mathrm{Eis}}(f) : \Gamma \backslash G
\rightarrow \mathbb{C}.\]</span></p>
</div>
<div class="example">
<p><strong>Example 81</strong>. Verify that if <span
class="math inline">\(f\)</span> is supported in a compact subset of
<span class="math inline">\(\Gamma_P U \backslash G\)</span>, then</p>
<ol type="i">
<li><p>each sum <a href="#eq:eisfg-:=-sum" data-reference-type="eqref"
data-reference="eq:eisfg-:=-sum">\((37)\)</a> has only finitely
many nonzero terms, and</p></li>
<li><p><span class="math inline">\(\mathop{\mathrm{Eis}}(f)\)</span> is
supported in a compact subset of <span class="math inline">\(\Gamma
\backslash G\)</span>.</p></li>
</ol>
<p>[A simpler version of the arguments of §<a
href="#sec:conv-eisenst-seri" data-reference-type="ref"
data-reference="sec:conv-eisenst-seri">2.8</a> should suffice.]</p>
</div>
<div id="lem:stoes2021:f-in-c_cgamma_p-1" class="lemma">
<p><strong>Lemma 82</strong>. For <span class="math inline">\(f \in
C_c(\Gamma_P U \backslash G)\)</span> and <span
class="math inline">\(\varphi : \Gamma \backslash G \rightarrow
\mathbb{C}\)</span> locally integrable, we have <span id="eq:int-_gamma-backslash" class="math display">\[\label{eq:int-_gamma-backslash}\tag{38}
    \int _{\Gamma \backslash G} \mathop{\mathrm{Eis}}(f) \varphi = \int
_{\Gamma_P U \backslash G} f \varphi_P,\]</span> where the measures are
defined as follows:</p>
<ul>
<li><p>The quotient <span class="math inline">\(\Gamma \backslash
G\)</span> is equipped with the Haar measure coming from a given Haar
measure <span class="math inline">\(d g\)</span> on <span
class="math inline">\(G\)</span> and the counting measure on <span
class="math inline">\(\Gamma\)</span>.</p></li>
<li><p>The quotient <span class="math inline">\(\Gamma_P \backslash
G\)</span> is equipped with the Haar measure defined in the same way, so
that Fubini’s theorem holds with respect to the fiber bundle <span id="eq:begincd-gamm-backsl" class="math display">\[\label{eq:begincd-gamm-backsl}\tag{39}
      \begin{CD}         
        \Gamma_P \backslash \Gamma  @&gt;&gt;&gt;  \Gamma_P \backslash G
\\
        @.  @VVV \\
        @. \Gamma \backslash G \\
      \end{CD}\]</span> with the counting measure on the fiber, i.e.,
for <span class="math inline">\(\Phi \in C_c(\Gamma_P \backslash
G)\)</span>, <span class="math display">\[\int _{\Gamma_P \backslash G}
\Phi
      =
      \int _{g \in \Gamma \backslash G} (\sum _{\gamma \in \Gamma_P
\backslash \Gamma } \Phi(\gamma g)) \, d g.\]</span></p></li>
<li><p>The Haar measure on <span class="math inline">\(\Gamma_P U
\backslash G\)</span> is characterized by requiring that Fubini’s
theorem holds for the fiber bundle <span id="eq:begincd-gamm-backsl-1" class="math display">\[\label{eq:begincd-gamm-backsl-1}\tag{40}
      \begin{CD}         
        \Gamma_U \backslash U  @&gt;&gt;&gt;  \Gamma_P \backslash G \\
        @.  @VVV \\
        @. \Gamma_P U \backslash G, \\
      \end{CD}\]</span> where, as in Definition <a
href="#defn:stoes2021:emphc-term-varphi" data-reference-type="ref"
data-reference="defn:stoes2021:emphc-term-varphi">70</a>, the compact
quotient <span class="math inline">\(\Gamma_U \backslash U\)</span> is
equipped with the probability Haar measure.</p></li>
</ul>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We first use the left invariance of <span
class="math inline">\(\varphi\)</span> under <span
class="math inline">\(\Gamma\)</span> to write the LHS of <a
href="#eq:int-_gamma-backslash" data-reference-type="eqref"
data-reference="eq:int-_gamma-backslash">\((38)\)</a>
as <span class="math display">\[\int _{g \in \Gamma \backslash G} \sum
_{\varphi \in \Gamma_P \backslash \Gamma } \varphi(\gamma g) f(\gamma g)
\, d g.\]</span> We then apply Fubin’s theorem twice, first for the
fiber bundle <a href="#eq:begincd-gamm-backsl"
data-reference-type="eqref"
data-reference="eq:begincd-gamm-backsl">\((39)\)</a> and
then for <a href="#eq:begincd-gamm-backsl-1" data-reference-type="eqref"
data-reference="eq:begincd-gamm-backsl-1">\((40)\)</a>,
giving that the above is <span class="math display">\[\int _{\Gamma_P
\backslash G} \varphi(g) f(g) \,d g
    = \int _{g \in \Gamma_P U \backslash G} \left( \int _{u \in \Gamma_U
\backslash U} \varphi (u g) \,d u \right) f(g) \, d g,\]</span> which in
turn evaluates to the RHS of <a href="#eq:int-_gamma-backslash"
data-reference-type="eqref"
data-reference="eq:int-_gamma-backslash">\((38)\)</a>. ◻</p>
</span></div>
<p>Lemma <a href="#lem:stoes2021:f-in-c_cgamma_p-1"
data-reference-type="ref"
data-reference="lem:stoes2021:f-in-c_cgamma_p-1">82</a> may be
understood as asserting the adjointness of the two maps <span
class="math display">\[{}  [\varphi \mapsto \varphi_P] :
\{\text{functions on } \Gamma \backslash G\} \rightarrow
\{\text{functions on } \Gamma_P U \backslash G\}\]</span> and <span
class="math display">\[{} [f \mapsto \mathop{\mathrm{Eis}}(f)]
:\{\text{functions on } \Gamma_P U \backslash G\}  \rightarrow
\{\text{functions on } \Gamma \backslash G\},\]</span> when they are
defined. This observation gives a sense in which the definition <a
href="#eq:eisfg-:=-sum" data-reference-type="eqref"
data-reference="eq:eisfg-:=-sum">\((37)\)</a> of the Eisenstein
series is inevitable: it describes the adjoint of the constant term map,
which arose naturally in our study (e.g., §<a
href="#sec:approx-const-terms-informal-discussion"
data-reference-type="ref"
data-reference="sec:approx-const-terms-informal-discussion">4.3.1</a>)
of the asymptotics of automorphic forms near the boundary of the
quotient <span class="math inline">\(\Gamma \backslash P\)</span>.</p>
<h2 id="cuspidal-functions">Cuspidal functions</h2>
<div class="definition">
<p><strong>Definition 83</strong>. We say that a measurable, locally
integrable function <span class="math inline">\(\varphi : \Gamma
\backslash G \rightarrow \mathbb{C}\)</span> is <em>cuspidal</em> if for
all standard parabolic subgroups <span class="math inline">\(P
\subsetneq G\)</span>, we have <span class="math inline">\(\varphi_P =
0\)</span> almost everywhere. We write <span
class="math inline">\(L^2_0(\Gamma \backslash G)\)</span> for the space
of cuspidal elements of <span class="math inline">\(L^2(\Gamma
\backslash G)\)</span>. A <em>cusp form</em> is a cuspidal automorphic
form.</p>
</div>
<p>For now, let us abbreviate these last two spaces simply by <span
class="math inline">\(L^2_0\)</span> and <span
class="math inline">\(L^2\)</span>, respectively.</p>
<div class="lemma">
<p><strong>Lemma 84</strong>. <span class="math inline">\(L^2_0\)</span>
is a closed subspace of <span class="math inline">\(L^2\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> This is similar to the following simple consequence
of Fubini’s theorem: the subspace <span class="math inline">\(V\)</span>
of <span class="math inline">\(L^2(\mathbb{R}^2)\)</span>, consisting of
all <span class="math inline">\(\varphi\)</span> for which <span
class="math inline">\(\int \varphi(x,y) \, d x = 0\)</span> for almost
all <span class="math inline">\(y\)</span>, is closed. This fact is
contained in Fubini’s theorem (or its proof). One way to understand this
observation is as follows: <span class="math inline">\(V\)</span> is the
orthogonal complement in <span
class="math inline">\(L^2(\mathbb{R}^2)\)</span> of the space of all
functions of the form <span class="math inline">\(\Phi_f(x,y) :=
f(y)\)</span> for some <span class="math inline">\(f \in
C_c(\mathbb{R})\)</span>.</p>
<p>A similar argument applies in the setting of the lemma. Using Lemma
<a href="#lem:stoes2021:f-in-c_cgamma_p-1" data-reference-type="ref"
data-reference="lem:stoes2021:f-in-c_cgamma_p-1">82</a>, we see that
<span class="math inline">\(L^2_0\)</span> is the orthogonal complement
of the set of Eisenstein series <span
class="math inline">\(\mathop{\mathrm{Eis}}(f)\)</span> attached to
<span class="math inline">\(f \in C_c(\Gamma_P U \backslash G)\)</span>
for some standard parabolic <span class="math inline">\(P \subsetneq
G\)</span>. Being an orthogonal complement, it is thus closed. ◻</p>
</span></div>
<div class="lemma">
<p><strong>Lemma 85</strong>. Any cusp form is of rapid decay
(Definition <a href="#sec:funct-moder-growth" data-reference-type="ref"
data-reference="sec:funct-moder-growth">3.4</a>).</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We use that the constant terms <span
class="math inline">\(\varphi_P\)</span> of a cusp form <span
class="math inline">\(\varphi\)</span> vanish for each <span
class="math inline">\(P \subsetneq G\)</span>, and appeal to the
approximation of automorphic forms by their constant terms. See <a href="#ref-MR1482800"
class="citation" data-cites="MR1482800">(Borel 1997, Cor 7.9)</a> or
<a href="#ref-MR2331343" class="citation" data-cites="MR2331343">(Borel 2007, Thm
6.9)</a> or <a href="#ref-MR1361168" class="citation" data-cites="MR1361168">(Mœglin and
Waldspurger 1995, 113:I.2.12, I.2.18)</a> for details. ◻</p>
</span></div>
<h1 id="some-further-facts">Some further facts</h1>
<h2 id="finiteness-theorems">Finiteness theorems</h2>
<p>Here we record a generalization of the fact that the spaces <span
class="math inline">\(M_k({\mathop{\mathrm{SL}}}_2(\mathbb{Z}))\)</span>
of holomorphic modular forms of given weight <span
class="math inline">\(k\)</span> are finite-dimensional.</p>
<p>Let <span class="math inline">\(\Gamma \backslash G\)</span> be
either <span class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{Z})
\backslash {\mathop{\mathrm{SL}}}_n (\mathbb{R})\)</span> or <span
class="math inline">\({\mathop{\mathrm{GL}}}_n (\mathbb{Z}) \backslash
{\mathop{\mathrm{GL}}}_n (\mathbb{R})\)</span>. (Like almost all results
presented in this course, these results are valid for much more general
quotients; see the references below.) Given a finite collection <span
class="math inline">\(\Xi\)</span> of (isomorphism classes of)
irreducible representations of <span class="math inline">\(K\)</span>
and a finite codimension ideal <span class="math inline">\(J\)</span> of
<span class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>, we
denote by <span class="math display">\[\mathcal{A} (\Gamma \backslash G,
\Xi, J)\]</span> the space of automorphic forms on <span
class="math inline">\(\Gamma \backslash G\)</span> having <span
class="math inline">\(K\)</span>-type <span
class="math inline">\(\Xi\)</span> and <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g})\)</span>-type <span
class="math inline">\(J\)</span> (§<a href="#sec:isotyp-decomp"
data-reference-type="ref" data-reference="sec:isotyp-decomp">3.5.2</a>,
§<a href="#sec:univ-envel-algebra" data-reference-type="ref"
data-reference="sec:univ-envel-algebra">3.6</a>). The space of
automorphic forms is itself the union of these subspaces.</p>
<div class="theorem">
<p><strong>Theorem 86</strong> (Harish–Chandra). <em>Each of the above
subspaces is finite-dimensional.</em></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We refer for now to <a href="#ref-MR1482800" class="citation"
data-cites="MR1482800">(Borel 1997, vol. 130, sec. 8)</a> for the
special case <span class="math inline">\(n=2\)</span> and to <a href="#ref-MR2331343"
class="citation" data-cites="MR2331343">(Borel 2007, Thm 7.4)</a> for
the general case. ◻</p>
</span></div>
<h2
id="convolution-operators-and-decomposition-of-the-space-of-cusp-forms">Convolution
operators and decomposition of the space of cusp forms</h2>
<p>We closely follow <a href="#ref-MR1482800" class="citation"
data-cites="MR1482800">(Borel 1997, vol. 130, sec. 9)</a> and <a href="#ref-MR2331343"
class="citation" data-cites="MR2331343">(Borel 2007, sec. 8)</a>. We
refer to those references for summaries, with references, of relevant
terminology from functional analysis, as well as proofs.</p>
<div class="theorem">
<p><strong>Theorem 87</strong>. <em>Let <span
class="math inline">\(\Gamma \backslash G =
{\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>, <span
class="math inline">\(f \in C_c^\infty(G)\)</span>. Then the operator
<span class="math inline">\(T_f\)</span> on <span
class="math inline">\(L^2_0(\Gamma \backslash G)\)</span> is trace class
(and in particular, compact).</em></p>
</div>
<p>The key ingredient in the proof is the following estimate, proved by
arguments similar to those in §<a href="#sec:appr-const-terms"
data-reference-type="ref"
data-reference="sec:appr-const-terms">4.3</a>.</p>
<div class="theorem">
<p><strong>Theorem 88</strong>. <em>For <span
class="math inline">\(\varphi \in L^2_0(\Gamma \backslash G)\)</span>
and <span class="math inline">\(f \in C _c ^\infty (G)\)</span>, we have
<span class="math inline">\(\|\varphi \ast f\| _\infty \leq C (f)
\|\varphi \| _2\)</span>, where <span
class="math inline">\(C(f)\)</span> depends at most upon <span
class="math inline">\(f\)</span>.</em></p>
</div>
<p>For the precise statement and proof of the following result, we refer
for now to <a href="#ref-MR1482800" class="citation" data-cites="MR1482800">(Borel 1997,
Thm 16.2)</a>, <a href="#ref-MR2331343" class="citation" data-cites="MR2331343">(Borel
2007, sec. 9)</a>, or <a href="#ref-MR3468638" class="citation"
data-cites="MR3468638">(Gelfand, Graev, and Pyatetskii-Shapiro 2016,
sec. 1.6)</a>.</p>
<div class="theorem">
<p><strong>Theorem 89</strong>. <em>The Hilbert space <span
class="math inline">\(L^2_0(\Gamma \backslash G)\)</span>, as a unitary
representation of <span class="math inline">\(G\)</span>, decomposes as
a Hilbert direct sum of irreducible subrepresentations, each occurring
with finite multiplicity.</em></p>
</div>
<p>The main point of the proof was to show that there exist irreducible
subrepresentations. By contrast, the regular representation of <span
class="math inline">\(\mathbb{R}\)</span> on <span
class="math inline">\(L^2(\mathbb{R})\)</span> has no irreducible
subrepresentations. The result may be understood as an analogue for
<span class="math inline">\(\Gamma \backslash G\)</span> of the density
of the space of trigonometric polynomials inside <span
class="math inline">\(L^2(\mathbb{R}/\mathbb{Z})\)</span>.</p>
<div id="refs" class="references csl-bib-body hanging-indent"
role="list">
<div id="ref-MR1482800" class="csl-entry" role="listitem">
Borel, Armand. 1997. <em>Automorphic Forms on <span><span
class="math inline">\({\rm SL}_2({\bf R})\)</span></span></em>. Vol.
130. Cambridge Tracts in Mathematics. Cambridge University Press,
Cambridge. <a
href="https://doi.org/10.1017/CBO9780511896064">https://doi.org/10.1017/CBO9780511896064</a>.
</div>
<div id="ref-MR2331343" class="csl-entry" role="listitem">
———. 2007. <span>“Automorphic Forms on Reductive Groups.”</span> In
<em>Automorphic Forms and Applications</em>, 12:7–39. IAS/Park City
Math. Ser. Amer. Math. Soc., Providence, RI. <a
href="https://doi.org/10.1090/pcms/012/02">https://doi.org/10.1090/pcms/012/02</a>.
</div>
<div id="ref-MR3970984" class="csl-entry" role="listitem">
———. 2019. <em>Introduction to Arithmetic Groups</em>. Vol. 73.
University Lecture Series. American Mathematical Society, Providence,
RI. <a
href="https://doi.org/10.1090/ulect/073">https://doi.org/10.1090/ulect/073</a>.
</div>
<div id="ref-MR141670" class="csl-entry" role="listitem">
Borel, Armand, and Harish-Chandra. 1961. <span>“Arithmetic Subgroups of
Algebraic Groups.”</span> <em>Bull. Amer. Math. Soc.</em> 67: 579–83. <a
href="https://doi.org/10.1090/S0002-9904-1961-10699-X">https://doi.org/10.1090/S0002-9904-1961-10699-X</a>.
</div>
<div id="ref-MR147566" class="csl-entry" role="listitem">
———. 1962. <span>“Arithmetic Subgroups of Algebraic Groups.”</span>
<em>Ann. Of Math. (2)</em> 75: 485–535. <a
href="https://doi.org/10.2307/1970210">https://doi.org/10.2307/1970210</a>.
</div>
<div id="ref-MR3468638" class="csl-entry" role="listitem">
Gelfand, I. M., M. I. Graev, and I. I. Pyatetskii-Shapiro. 2016.
<em>Generalized Functions. <span>V</span>ol. 6</em>. AMS Chelsea
Publishing, Providence, RI. <a
href="https://doi.org/10.1090/chel/382">https://doi.org/10.1090/chel/382</a>.
</div>
<div id="ref-MR1942691" class="csl-entry" role="listitem">
Iwaniec, Henryk. 2002. <em>Spectral Methods of Automorphic Forms</em>.
Second. Vol. 53. Graduate Studies in Mathematics. Providence, RI:
American Mathematical Society.
</div>
<div id="ref-MR855239" class="csl-entry" role="listitem">
Knapp, Anthony W. 1986. <em>Representation Theory of Semisimple
Groups</em>. Vol. 36. Princeton Mathematical Series. Princeton
University Press, Princeton, NJ. <a
href="https://doi.org/10.1515/9781400883974">https://doi.org/10.1515/9781400883974</a>.
</div>
<div id="ref-MR1361168" class="csl-entry" role="listitem">
Mœglin, C., and J.-L. Waldspurger. 1995. <em>Spectral Decomposition and
<span>E</span>isenstein Series</em>. Vol. 113. Cambridge Tracts in
Mathematics. Cambridge University Press, Cambridge. <a
href="https://doi.org/10.1017/CBO9780511470905">https://doi.org/10.1017/CBO9780511470905</a>.
</div>
<div id="ref-MR3307755" class="csl-entry" role="listitem">
Morris, Dave Witte. 2015. <em>Introduction to Arithmetic Groups</em>.
Deductive Press, [place of publication not identified]. <a
href="https://arxiv.org/abs/math/0106063">https://arxiv.org/abs/math/0106063</a>.
</div>
<div id="ref-MR1278263" class="csl-entry" role="listitem">
Platonov, Vladimir, and Andrei Rapinchuk. 1994. <em>Algebraic Groups and
Number Theory</em>. Vol. 139. Pure and Applied Mathematics. Academic
Press, Inc., Boston, MA.
</div>
<div id="ref-MR3003" class="csl-entry" role="listitem">
Siegel, Carl Ludwig. 1940. <span>“Einheiten Quadratischer
<span>F</span>ormen.”</span> <em>Abh. Math. Sem. Hansischen Univ.</em>
13: 209–39.
</div>
</div>
<script>
document.querySelectorAll(".toggle-proof").forEach(function(toggle) {
  toggle.addEventListener("click", function(e) {
    e.preventDefault();
    const content = this.nextElementSibling;
    const em = this.querySelector('em');
    if (window.getComputedStyle(content).display === "none") {
      content.style.display = "inline";
      em.textContent = em.dataset.defaultText;
    } else {
      content.style.display = "none";
      em.textContent = em.dataset.foldedText;
    }
  });
});
</script>
<script>
document.querySelector("#toggle-all-proofs").addEventListener("click", function(e) {
  e.preventDefault();
  const proofs = document.querySelectorAll(".proof-content");
  proofs.forEach(function(proof) {
    const proofToggle = proof.previousElementSibling;
    if (window.getComputedStyle(proof).display === "none") {
      proof.style.display = "inline";
      proofToggle.innerHTML = `<em>${proofToggle.dataset.defaultText}</em>`;
    } else {
      proof.style.display = "none";
      proofToggle.innerHTML = `<em>${proofToggle.dataset.foldedText}</em>`;
    }
  });
});
</script>

<script src="https://giscus.app/client.js"
        data-repo="Ultronozm/math"
        data-repo-id="R_kgDOJlhjqQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOJlhjqc4CWo21"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</body>
</html>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Aarhus Automorphic Forms Summer School</title>
  <link rel="stylesheet" href="tex.css">
  <style>
      .my-links-container {
        position: absolute;
        top: 0;
        right: 0;
        padding-right: 20px;
        padding-top: 10px;
      }
      .my-link {
        margin-left: 10px;
      }
      .my-links-container-2 { /* new CSS class for the second row */
        position: absolute;
        top: 40px; /* adjust this value based on the height of your links */
        right: 0;
        padding-right: 20px;
      }
      .my-link-2 {
        margin-left: 10px;
      }

    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    div.abstract {
      margin: 2em 2em 2em 2em;
      text-align: left;
      font-size: 85%;
    }
    div.abstract-title {
      font-weight: bold;
      text-align: center;
      padding: 0;
      margin-bottom: 0.5em;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
    <div class="my-links-container">
2025-08-06 11:39:17
      <a href="20250804T091631--aarhus-summer-school.tex" class="my-link">tex</a>
      <a href="20250804T091631--aarhus-summer-school.pdf" class="my-link">pdf</a>
      <a href="https://github.com/ultronozm/math/commits/main/20250804T091631--aarhus-summer-school.tex" class="my-link">history</a>
      <a href="." class="my-link">home</a>
    </div>
<header id="title-block-header">
<h1 class="title">Aarhus Automorphic Forms Summer School</h1>
<div class="abstract">
<div class="abstract-title">Abstract</div>
<p>Notes in progress on lectures taking place there.</p>
</div>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#gebhard-boeckles-lectures"
id="toc-gebhard-boeckles-lectures">Gebhard Boeckle’s lectures</a></li>
<li><a href="#chris-skinners-lectures"
id="toc-chris-skinners-lectures">Chris Skinner’s lectures</a></li>
</ul>
</nav>
<h3 id="gebhard-boeckles-lectures">Gebhard Boeckle’s lectures</h3>
<h4 id="galois-representations-and-congruences">Galois representations
and congruences</h4>
<p>We first discuss profinite groups. Let <span
class="math inline">\(G\)</span> be a topological group.</p>
<div class="theorem">
<p><strong>Theorem 1</strong>. <em>The following are
equivalent:</em></p>
<ol type="a">
<li><p><em><span id="enumerate:cq6r3e8dsb"
label="enumerate:cq6r3e8dsb"></span> <span
class="math inline">\(G\)</span> is compact, Hausdorff, and totally
disconnected.</em></p></li>
<li><p><em><span id="enumerate:cq6r3e8eqf"
label="enumerate:cq6r3e8eqf"></span> <span
class="math inline">\(G\)</span> is compact, and admits a neighborhood
basis of the identity by open normal subgroups.</em></p></li>
<li><p><em><span id="enumerate:cq6r3e8f6g"
label="enumerate:cq6r3e8f6g"></span> There is a directed poset <span
class="math inline">\(I\)</span> and an inverse system <span
class="math inline">\((G_i)\)</span> of finite (discrete) groups such
that <span class="math inline">\(G = \varprojlim_I
G_i\)</span>.</em></p></li>
</ol>
</div>
<p>We say that <span class="math inline">\(G\)</span> is
<em>profinite</em> if the above conditions hold. The topology on <span
class="math inline">\(\varprojlim G_i\)</span> is that obtained by
regarding it as a closed subgroup of the product <span
class="math inline">\(\prod G_i\)</span>.</p>
<p>Constructions:</p>
<ol type="a">
<li><p><span id="enumerate:cq6r3e8b0y"
label="enumerate:cq6r3e8b0y"></span> If <span
class="math inline">\(G\)</span> is discrete, then we equip it with the
profinite topology <span class="math inline">\(G^{\mathrm{pf}} :=
\varprojlim G / N\)</span>, where <span class="math inline">\(N\)</span>
runs over the finite index subgroups.</p></li>
<li><p><span id="enumerate:cq6r3e8cou"
label="enumerate:cq6r3e8cou"></span> If <span class="math inline">\(G =
\varprojlim G_i\)</span> is profinite, then</p>
<ol type="i">
<li><p><span id="enumerate:cq6r3fehbe"
label="enumerate:cq6r3fehbe"></span> The abelianization is given by
<span class="math display">\[G^{\mathrm{ab}} = G / \overline{[G, G]} =
\varprojlim G_i^{\mathrm{ab}},\]</span> and in particular, is
profinite.</p></li>
<li><p><span id="enumerate:cq6r3feivc"
label="enumerate:cq6r3feivc"></span> For <span
class="math inline">\(H\)</span> finite, write <span
class="math inline">\(H_p\)</span> for its maximal <span
class="math inline">\(p\)</span>-group quotient. Then <span
class="math display">\[G_p = \varprojlim(G_i)_p\]</span> is a pro-<span
class="math inline">\(p\)</span>-group (and in particular,
profinite).</p></li>
<li><p><span id="enumerate:cq6r3fej61"
label="enumerate:cq6r3fej61"></span> If <span class="math inline">\(N
\leq G\)</span> is closed and normal, then <span class="math inline">\(G
/N\)</span> is profinite.</p></li>
</ol></li>
</ol>
<div class="example">
<p><strong>Example 2</strong>. </p>
<ol type="a">
<li><p><span id="enumerate:cq6r3fjkt4"
label="enumerate:cq6r3fjkt4"></span> Let <span
class="math inline">\(F\)</span> be a field. Set <span
class="math inline">\(G_F := {\mathop{\mathrm{Aut}}}_F(F^{\mathrm{sep}}) =
\mathop{\mathrm{Gal}}(F^{\mathrm{sep}} / F)\)</span> profinite. Define
the poset <span class="math display">\[\mathcal{I}_F := \left\{ L
\subseteq F^{\mathrm{sep}} : L \supseteq F \text{ finite Galois},
\subseteq \right\}.\]</span> Then <span class="math display">\[G_F
\xrightarrow{\cong} \varprojlim_{L \in \mathcal{I}_F}
\mathop{\mathrm{Gal}}(L / F).\]</span></p></li>
<li><p><span id="enumerate:cq6r3fm1jw"
label="enumerate:cq6r3fm1jw"></span> Let <span
class="math inline">\(F&#39; \subseteq F^{\mathrm{sep}}\)</span> be a
normal extension of <span class="math inline">\(F\)</span>. Then <span
class="math inline">\(G_{F&#39;} \leq G_F\)</span> is closed and normal.
We may thus write <span class="math display">\[\mathop{\mathrm{Gal}}(F
&#39; / F) \cong G_F / G_{F&#39;} = \lim_{
        \substack{
          L \in \mathcal{I}_F,  \\
          L \subseteq F&#39;          
        }
      }
      \mathop{\mathrm{Gal}}(L /F).\]</span></p></li>
<li><p><span id="enumerate:cq6r3fm4tn"
label="enumerate:cq6r3fm4tn"></span> Let <span
class="math inline">\(\mathbb{N}\)</span> denote the natural numbers,
ordered by divisibility. Then <span
class="math display">\[\hat{\mathbb{Z}} = \varprojlim \mathbb{Z} / n =
\prod_{p} \mathbb{Z}_p,\]</span> where the last step is the Chinese
remainder theorem. We sometimes need a slight modification: <span
class="math display">\[\hat{\mathbb{Z}}^{(p)} = \varprojlim_{p \nmid n}
\mathbb{Z} / n = \prod_{\ell \text{ prime}, \\ \ell \neq p }
\mathbb{Z}_{\ell}.\]</span></p>
<p>Let’s fix some notation:</p>
<ol>
<li><p><span id="enumerate:cq6r3f3t8d"
label="enumerate:cq6r3f3t8d"></span> Let <span
class="math inline">\(K\)</span> be a number field, <span
class="math inline">\(\mathcal{O}_K\)</span> its ring of integers. Let
<span class="math inline">\(\mathrm{P l}_K = \mathrm{P l}_K^\infty
\sqcup \mathrm{P l}_K^{\mathrm{fin}}\)</span> denote the set of places
<span class="math inline">\(v\)</span> of <span
class="math inline">\(K\)</span>. Let <span
class="math inline">\(v\)</span> be a finite place. We may then attach
to it a maximal ideal <span
class="math inline">\(\mathfrak{q}_v\)</span> of <span
class="math inline">\(\mathcal{O}_K\)</span>, giving a bijection <span
class="math display">\[\mathrm{P l}_K^{\mathrm{fin}} \leftrightarrow
\operatorname{Max}(\mathcal{O}_K).\]</span> We may form the residue
field <span class="math inline">\(k_v := \mathcal{O}_K /
\mathfrak{q}_v\)</span>. We denote <span
class="math inline">\(q_v\)</span> for the cardinality of <span
class="math inline">\(k_v\)</span>. We write <span
class="math inline">\(\operatorname{char}(v)\)</span> for the
characteristic of <span class="math inline">\(k_v\)</span>. We denote by
<span class="math inline">\(\mathcal{O}_v = \varprojlim \mathcal{O} /
\mathfrak{q}_v^n\)</span>, with fraction field <span
class="math inline">\(K_v\)</span>. Also, we have a short exact sequence
<span class="math display">\[1 \rightarrow I_v \rightarrow G_v :=
{\mathop{\mathrm{Gal}}}_{K_v} \rightarrow {\mathop{\mathrm{Gal}}}_{k_v}
\rightarrow 1.\]</span> A topological generator for <span
class="math inline">\({\mathop{\mathrm{Gal}}}_{k_v}\)</span> is given by
<span class="math display">\[\mathrm{Fr}_v : \alpha \mapsto
\alpha^{q_v}.\]</span> We denote by <span
class="math inline">\(\mathrm{Frob}_v \in G_v\)</span> some lift of
<span class="math inline">\(\mathrm{Fr}_v\)</span>.</p>
<p>We write <span class="math inline">\(S_\infty := \mathrm{P
l}_K^\infty\)</span> for the set of archimedean places, so that <span
class="math inline">\(K \otimes_{\mathbb{Q}} \mathbb{R} \cong \prod_{v
\in S_\infty} K_v\)</span>. For a rational prime <span
class="math inline">\(p\)</span>, we write <span
class="math inline">\(S_p\)</span> for the set of places <span
class="math inline">\(v\)</span> of <span
class="math inline">\(K\)</span> such that <span class="math inline">\(v
\mid p\)</span>.</p></li>
<li><p>We also need some local analogues for <span
class="math inline">\(E \supseteq \mathbb{Q}_p\)</span> a <span
class="math inline">\(p\)</span>-adic field. Let <span
class="math inline">\(\mathcal{O} = \mathcal{O}_E\)</span> denote the
ring of integers, <span class="math inline">\(\pi = \pi_E\)</span> a
uniformizer, and <span class="math inline">\(\mathbb{F} = \mathcal{O}_E
/ \pi\)</span> the residue field, with <span class="math inline">\(q =
\# \mathbb{F}\)</span>. Then <span class="math inline">\(E \supseteq
\mathbb{Q}_q = \mathbb{Q}_p[\zeta_{q - 1}] \supseteq
\mathbb{Q}_p\)</span>. We have <span class="math inline">\(W(\mathbb{F})
= \mathbb{Z}_q = \mathbb{Z}_p[\zeta_{q - 1}]\)</span>.</p></li>
</ol>
<p>Contiuing the examples, which may serve as exercises:</p></li>
<li><p><span id="enumerate:cq6r3g5d9c"
label="enumerate:cq6r3g5d9c"></span> Let <span
class="math inline">\(\zeta_t\)</span> be a primitive <span
class="math inline">\(t\)</span>th root of <span
class="math inline">\(1\)</span>. For <span
class="math inline">\(k\)</span> a finite field, we have <span
class="math inline">\(G_k \cong \hat{\mathbb{Z}} = \overline{\langle
\mathrm{Fr}_k \rangle}\)</span>, where <span
class="math inline">\(\mathrm{Fr}_k : \alpha \mapsto \alpha^{\lvert k
\rvert}\)</span>.</p></li>
<li><p><span id="enumerate:cq6r3g5e7y"
label="enumerate:cq6r3g5e7y"></span> Let <span class="math inline">\(E
\supseteq \mathbb{Q}_p\)</span> (finite extension). Then <span
class="math inline">\(G_E\)</span> (Jannsen–Wingberg for <span
class="math inline">\(p \geq 2\)</span>). Local class field theory: the
Artin map <span class="math inline">\(E^\times \rightarrow
G_E^{\mathrm{ab}}\)</span> is a continuous inclusion with dense image.
Writing <span class="math inline">\(E^\times = \pi_E^{\mathbb{Z}} \times
\mathcal{O}_E^\times = \pi_E^{\mathbb{Z}} \times \mathbb{F}^\times
\times \mathcal{U}_E^1\)</span>. Since the units are known to be a
finitely generated <span
class="math inline">\(\mathbb{Z}_p\)</span>-module, we get as a
corollary that <span
class="math display">\[{\mathop{\mathrm{Hom}}}_{\mathrm{cts}}(G_E,
\mathbb{F}_p) = H^1_{\mathrm{cts}}(G_E, \mathbb{F}_p)\]</span> is
finite.</p></li>
<li><p><span id="enumerate:cq6r3g5cxb"
label="enumerate:cq6r3g5cxb"></span> We turn to the case of a number
field <span class="math inline">\(K\)</span>. We fix an embedding <span
class="math inline">\(K^{\mathrm{sep}} \subseteq
K_v^{\mathrm{sep}}\)</span> for each place <span
class="math inline">\(v\)</span>, which gives an embedding of Galois
groups <span class="math inline">\(G_v \rightarrow G_K\)</span>. For
<span class="math inline">\(S \subseteq \mathrm{P l}_K\)</span> finite,
we write <span class="math display">\[K_S := \left\{ \alpha \in
K^{\mathrm{sep}} : K(\alpha) \text{ is unramified outside } S
\right\},\]</span> which is a normal (typically infinite) extension of
<span class="math inline">\(K\)</span>. We write <span
class="math display">\[G_{K, S} := \mathop{\mathrm{Gal}}(K_S / K) = G_K
/ G_{K_S}\]</span> for its Galois group. We remark that if we take <span
class="math inline">\(v \notin S\)</span>, then since <span
class="math inline">\(v\)</span> does not ramify in <span
class="math inline">\(K_S\)</span>, we know that the map <span
class="math inline">\(G_v \rightarrow G_{K, S}\)</span> factors via the
quotient <span class="math inline">\(G_v / I_v \cong G_{k_v}\)</span>,
so that <span class="math inline">\(\mathrm{Frob}_v \in G_{K,
S}\)</span> is independent of the choice of lift. On the other hand, if
<span class="math inline">\(v \in S\)</span>, then we might ask whether
the map <span class="math inline">\(G_v \hookrightarrow G_{K,
S}\)</span> (see the work of Cheniever–Clozel). The structure of <span
class="math inline">\(G_{K, S}\)</span> is unknown, but global class
field theory describes <span class="math inline">\(G_{K,
S}^{\mathrm{ab}}\)</span>. A corollary is that <span
class="math display">\[H^{1}_{\mathrm{cts}}(G_{K, S}, \mathbb{F}_p) =
{\mathop{\mathrm{Hom}}}_{\mathrm{cts}}(G_{K, S}, \mathbb{F}_p)\]</span> is
finite whenever <span class="math inline">\(S\)</span> is finite. (One
can appeal to Hermite–Minkowski, or class field theory.)</p></li>
<li><p><span id="enumerate:cq6r3g5bmp"
label="enumerate:cq6r3g5bmp"></span> Consider the tame quotient of <span
class="math inline">\(G_E\)</span>, for <span class="math inline">\(E
\supseteq \mathbb{Q}_p\)</span>. Given <span class="math inline">\(E
\supseteq \mathbb{Q}_p\)</span>, we form the tower of extensions <span
class="math inline">\(E^{\mathrm{tame}} / E^{\mathrm{unr}} / E\)</span>,
where <span class="math display">\[E^{\mathrm{unr}} = \cup \left\{
E(\zeta_n) : p \nmid n \right\},\]</span> <span
class="math display">\[E^{\mathrm{tame}} = \cup \left\{
E^{\mathrm{unr}}(\sqrt[n]{\pi_E}) : p \nmid n \right\}.\]</span> It’s a
fact that <span class="math inline">\(G_E^{\mathrm{tame}}\)</span> may
be expressed as the profinite completion of <span
class="math inline">\(\langle s t : s t s^{-1} = t^q
\rangle\)</span>.</p></li>
</ol>
</div>
<p>We finally come to <strong>Galois representations</strong>. They will
typically be called <span class="math inline">\(\rho : G \rightarrow
\mathrm{GL}_n(A)\)</span>, where <span class="math inline">\(G\)</span>
is a topological group, <span class="math inline">\(A\)</span> is a
topological ring, and <span class="math inline">\(\rho\)</span> is a
continuous map. The topology on <span
class="math inline">\(\mathrm{GL}_n(A)\)</span> is the subspace topology
coming from embedding inside <span class="math inline">\(M_n(A) \times
A\)</span> via <span class="math inline">\(g \mapsto(g,
\det(g)^{-1})\)</span>, for instance. We call <span
class="math inline">\(\rho\)</span> a Galois representation if <span
class="math inline">\(G = G_F\)</span> for some field <span
class="math inline">\(F\)</span>. The main examples of interest for
<span class="math inline">\(A\)</span> will be <span
class="math inline">\(\mathbb{C}\)</span>, finite fields, and <span
class="math inline">\(p\)</span>-adic fields, to interpolate <span
class="math inline">\(\mathrm{C N L}_{\mathcal{O}}\)</span> (complete
Noetherian local <span
class="math inline">\(\mathcal{O}\)</span>-algebras).</p>
<div class="exercise">
<p><strong>Exercise 1</strong>. Let <span
class="math inline">\(G\)</span> be profinite, and <span
class="math inline">\(\rho\)</span> as above.</p>
<ol type="a">
<li><p>If <span class="math inline">\(A = \mathbb{C}\)</span>, then
<span class="math inline">\(\rho(G)\)</span> is finite.</p></li>
<li><p>If <span class="math inline">\(A =
\overline{\mathcal{O}_p}\)</span>, then there is a finite extension
<span class="math inline">\(E \supseteq \mathbb{Q}_p\)</span> such that
<span class="math inline">\(\rho(G) \subseteq \mathrm{GL}_n(E)\)</span>
up to conjugation.</p></li>
<li><p><span id="enumerate:cq6r3j15cy"
label="enumerate:cq6r3j15cy"></span> If <span class="math inline">\(A =
E \supseteq \mathbb{Q}_p\)</span> (finite extension), then after
conjugation, we can assume that <span class="math inline">\(\rho(G)
\subseteq \mathrm{GL}_n(\mathcal{O})\)</span>.</p></li>
</ol>
</div>
<p>In case <a href="#enumerate:cq6r3j15cy" data-reference-type="eqref"
data-reference="enumerate:cq6r3j15cy">\((c)\)</a>, we
have a <span class="math inline">\(G\)</span>-stable lattice <span
class="math inline">\(\Lambda \cong \mathcal{O}^n \subseteq
E^n\)</span>. We can apply reduction <span
class="math inline">\(\mathcal{O} \rightarrow \mathbb{F}\)</span>. This
gives a reduction <span class="math display">\[\overline{\rho}_\Lambda :
G \rightarrow \mathrm{GL}_n(\mathbb{F}).\]</span> Let’s use the notation
<span class="math inline">\(\mathrm{c p}_\alpha\)</span> for the
characteristic polynomial of <span class="math inline">\(\alpha \in
M_n(A)\)</span>.</p>
<div class="theorem">
<p><strong>Theorem 3</strong>. </p>
<ol type="a">
<li><p><em>Given a representation <span class="math inline">\(r : G
\rightarrow \mathrm{GL}_n(\mathbb{F})\)</span>. Then there exists a
semisimple representation <span class="math inline">\(r^{\mathrm{ss}} :
G \rightarrow \mathrm{GL}_n(\mathbb{F})\)</span> such that <span
class="math inline">\(\mathrm{c p}_r = \mathrm{c
p}_{r^{\mathrm{ss}}}\)</span> (Brauer–Nesbitt), where <span
class="math inline">\(r^{\mathrm{ss}}\)</span> is unique up to
isomorphism.</em></p></li>
<li><p><em>We have <span class="math inline">\(\mathrm{c p}_{\rho} \in
\mathcal{O}[X]\)</span> and <span class="math inline">\(\mathrm{c
p}_{\bar{\rho}_\Lambda} \in \mathbb{F}[X]\)</span>, independent of <span
class="math inline">\(\Lambda\)</span>.</em></p></li>
</ol>
</div>
<div class="theorem">
<p><strong>Theorem 4</strong>. <em>For <span class="math inline">\(\rho,
\rho &#39; : G_{K, S} \rightarrow \mathrm{GL}_n(E)\)</span> semisimple,
we have that <span class="math inline">\(\rho \sim \rho &#39;\)</span>
(conjugate) if and only if for all <span class="math inline">\(v \in
\mathrm{P l}_K^{\mathrm{fin}} \setminus S\)</span>, we have <span
class="math display">\[\mathrm{c p}_{\rho({\mathop{\mathrm{Frob}}}_v)} =
\mathrm{c p}_{\rho &#39;({\mathop{\mathrm{Frob}}}_v)}.\]</span></em></p>
</div>
<div class="example">
<p><strong>Example 6</strong>. </p>
<ol>
<li><p><span id="enumerate:cq6r3ki8zp"
label="enumerate:cq6r3ki8zp"></span> <span
class="math inline">\(p\)</span>-adic cyclotomic character <span
class="math inline">\(\chi_p^{\mathrm{cyc}} : G_{\mathbb{Q}} \rightarrow
\mathbb{Z}_p^\times\)</span>. We have <span
class="math display">\[G_{\mathbb{Q}} \circlearrowright \mu_{p^n} =
\left\langle \zeta_{p^n} \right\rangle \cong \mathbb{Z} / p^n,\]</span>
<span class="math inline">\((\mathbb{Z} / p^n)^\times =
{\mathop{\mathrm{Aut}}}_{\mathbb{Z}}(\mathbb{Z} / p^n)\)</span>.
<strong>Facts</strong>:</p>
<ul>
<li><p><span class="math inline">\(\chi_p^{\mathrm{cyc}}
\mid_{G_K}\)</span>: unramified outside <span class="math inline">\(S_p
\cup S_\infty\)</span>.</p></li>
<li><p><span
class="math inline">\(\chi_p^{\mathrm{cyc}}({\mathop{\mathrm{Frob}}}_v) =
q_v \in \mathbb{Z}_p^\times\)</span>.</p></li>
</ul></li>
<li><p><span id="enumerate:cq6r3ki7yl"
label="enumerate:cq6r3ki7yl"></span> The Tate module of an elliptic
curve <span class="math inline">\(\mathcal{E}_{/ K}\)</span>. We again
have <span class="math inline">\(G_K \circlearrowright
\mathcal{E}[p^n](\bar{K}) \cong(\mathbb{Z} / p^n)^{\oplus 2}\)</span>,
which gives rise to <span class="math inline">\(G_K \rightarrow
\mathrm{GL}_2(\mathbb{Z} / p^n)\)</span>. In the limit, we get <span
class="math display">\[\rho_{\mathcal{E}, p} : G_K \rightarrow
\mathrm{GL}_2(\mathbb{Z}_p) \hookrightarrow
\mathrm{GL}_2(\mathbb{Q}_p).\]</span> <strong>Facts</strong>:</p>
<ul>
<li><p><span class="math inline">\(\rho_{\mathcal{E},p}\)</span> is
unramified outside <span class="math inline">\(S_\infty \cup S_p \cup
\mathrm{Bad}\)</span>.</p></li>
<li><p>For <span class="math inline">\(v\)</span> outside those places,
we have <span class="math display">\[\mathrm{c p}_{\rho_{\mathcal{E},
p}}({\mathop{\mathrm{Frob}}}_v) = X^2 - a_v(\mathcal{E}) X + q_v,\]</span>
where <span class="math display">\[a_v := \# \mathcal{E}(k_v).\]</span>
This shows the geometric meaning of Frobenius.</p></li>
</ul></li>
<li><p><span id="enumerate:cq6sj47m05"
label="enumerate:cq6sj47m05"></span> Let <span class="math inline">\(f =
q + \sum_{n \geq 2} a_n q^n\)</span> be the <span
class="math inline">\(q\)</span>-expansion of a cuspidal Hecke eigenform
<span class="math inline">\(f \in S_k(N, \varepsilon)\)</span>, <span
class="math inline">\(k \geq 1\)</span>, <span
class="math inline">\(\varepsilon:(\mathbb{Z} / N)^\times \rightarrow
\mathbb{C}^\times\)</span>.</p>
<div class="theorem">
<p><strong>Theorem 5</strong>. </p>
<ol type="a">
<li><p><em><span id="enumerate:cq6sj5bs5p"
label="enumerate:cq6sj5bs5p"></span> <span class="math inline">\(E_f =
\mathbb{Q}(a_n : n \geq 1)\)</span> is a number field, with <span
class="math inline">\(a_n \in \mathcal{O}_{E_f}\)</span> for all <span
class="math inline">\(n\)</span>.</em></p></li>
<li><p><em><span id="enumerate:cq6sj5bt7j"
label="enumerate:cq6sj5bt7j"></span> (Eichler–Shimura, Deligne,
Deligne–Serre) For all finite places <span
class="math inline">\(\lambda\)</span> of <span
class="math inline">\(E_f\)</span> (with <span
class="math inline">\(E_\lambda\)</span> the completion of <span
class="math inline">\(\lambda\)</span> and <span
class="math inline">\(p\)</span> the characteristic of <span
class="math inline">\(k_\lambda\)</span>) there exists an absolutely
irreducible representation <span class="math display">\[\rho_{f,
\lambda} : G_{\mathbb{Q}, N \cup \{p, \infty\}} \rightarrow
\mathrm{GL}_2(\bar{E}_\lambda)\]</span> and for all primes <span
class="math inline">\(\ell \nmid N p\)</span>, we have the relation that
we just saw in Chris’s talk: <span class="math display">\[\mathrm{c
p}_{\rho_{f , \lambda}}(\mathrm{Frob}_{\ell}) = X^2 - a_{\ell} X +
\varepsilon(\ell) \ell^{k - 1}.\]</span></em></p></li>
</ol>
</div>
<p>This characterizes the representation and maybe gives the main link
to Galois representation.</p></li>
</ol>
</div>
<p>Now, we want to study congruences. To do this, we first go from</p>
<ul>
<li><p>cusp forms that start life over the complex numbers on the upper
half plane, to</p></li>
<li><p>Fourier coefficients, that live over the integers.</p></li>
</ul>
<p>(For simplicity, assume that nebentypus is trivial: <span
class="math inline">\(\varepsilon= 1\)</span>.) Let <span
class="math inline">\(S_k(N, \mathbb{Z})\)</span> denote the set of all
<span class="math inline">\(f = \sum_{n \geq 1} a_n q^n\)</span> such
that <span class="math inline">\(a_n \in \mathbb{Z}\)</span> for all
<span class="math inline">\(n\)</span>.</p>
<div class="fact">
<p><strong>Fact 7</strong>. <em><span class="math inline">\(S_k(N,
\mathbb{Z})\)</span> is a <span
class="math inline">\(\mathbb{Z}\)</span>-module of rank equal to <span
class="math inline">\(\dim_{\mathbb{C}} S_k(N)\)</span>.</em></p>
</div>
<p>For any ring <span class="math inline">\(A\)</span>, we have <span
class="math display">\[\underline{S}_{A} = S_k(N, \mathbb{Z})
\otimes_{\mathbb{Z}} A \circlearrowleft \mathbb{T}_A = \mathbb{T}(N,
A).\]</span></p>
<div class="definition">
<p><strong>Definition 8</strong>. For Hecke eigenforms <span
class="math inline">\(f = \sum a_n q^n\)</span> and <span
class="math inline">\(g = b_n q^n \in S_k(N,
\bar{\mathbb{Z}}_p)\)</span>, we say that <span class="math inline">\(f
\equiv g \pmod{p}\)</span> if the following equivalent conditions
hold:</p>
<ul>
<li><p>for all primes <span class="math inline">\(\ell \nmid N
p\)</span>, we have <span class="math inline">\(a_{\ell} \equiv b_{\ell}
\pmod{\mathfrak{m}_{\overline{\mathbb{Z}_p}}}\)</span>.</p></li>
<li><p><span class="math inline">\(\rho_f \equiv \rho_g
\pmod{\mathfrak{m} \bar{\mathbb{Z}}_p}\)</span> as maps <span
class="math inline">\(G_{\mathbb{Q}} \rightarrow
\mathrm{GL}_2(\bar{\mathbb{F}}_p)\)</span>.</p></li>
</ul>
</div>
<p>We pass to the same Hecke algebra. Let <span
class="math inline">\(\mathbb{T}_A &#39;\)</span> denote the subalgebra
of <span class="math inline">\(\mathbb{T}_A\)</span> generated by <span
class="math inline">\(T_{\ell}\)</span> for all <span
class="math inline">\(\ell \nmid N\)</span>. This is acted on by <span
class="math inline">\(\underline{S}_A\)</span>.</p>
<div class="fact">
<p><strong>Fact 9</strong>. <em>We have bijections between the
following:</em></p>
<ul>
<li><p><em><span class="math inline">\(\mathbb{T} &#39;\)</span>-Hecke
eigensystems of forms in <span
class="math inline">\(S_k(N)\)</span>.</em></p></li>
<li><p><em><span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathbb{C}}(\mathbb{T}_{\mathbb{C}}&#39;,
\mathbb{C})\)</span>.</em></p></li>
<li><p><em><span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathcal{O}}(\mathbb{T}_{\mathcal{O}}&#39;,
\mathcal{O})\)</span>, where we choose <span
class="math inline">\(E\)</span> large enough with <span
class="math inline">\(\mathbb{C} \supseteq \bar{\mathbb{Q}} \subseteq
\bar{\mathbb{Q}}_p \supseteq E \supseteq \mathcal{O}\)</span>, where
<span class="math inline">\(\mathcal{O}\)</span> always denotes the ring
of integers of <span class="math inline">\(E\)</span>.</em></p></li>
</ul>
<p><em>We also have a bijection between</em></p>
<ul>
<li><p><em><span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathcal{O}}(\mathbb{T}_{\mathcal{O}},
\mathbb{F})\)</span>, and</em></p></li>
<li><p><em>The set of <span class="math inline">\(\bar{\rho} :
G_{\mathbb{Q}} \rightarrow \mathrm{GL}_2(\mathbb{F})\)</span> that are
semisimple reductions from some <span
class="math inline">\(\rho_f\)</span>, with <span
class="math inline">\(f \in S_k(N)\)</span>.</em></p></li>
</ul>
<p><em><span class="math inline">\(\mathbb{T} &#39;\)</span> is a finite
free <span class="math inline">\(\mathcal{O}\)</span>-algebra. For any
<span class="math inline">\(\bar{\rho}\)</span>, we get a maximal ideal
<span class="math inline">\(\mathfrak{m}_{\bar{\rho}} \subseteq
\mathbb{T} &#39;_{\mathcal{O}}\)</span>. For a given <span
class="math inline">\(\bar{\rho}\)</span>, if we take <span
class="math display">\[(\mathbb{T}_{\mathcal{O}}&#39;)_{\mathfrak{m}_{\bar{\rho}}},\]</span>
then this is the relevant Hecke algebra for understanding the forms
congruent to <span class="math inline">\(\bar{\rho}\)</span>.</em></p>
</div>
<div class="theorem">
<p><strong>Theorem 10</strong> (Carayol, Serre). <em>Assume that <span
class="math inline">\(\bar{\rho}\)</span> is absolutely irreducible.
Then there exists a continuous representation <span id="eq:cq6sj6h73f" class="math display">\[\label{eq:cq6sj6h73f}\tag{1}
    \rho_{\bar{\rho}}^{\mathrm{mod}} : G_{\mathbb{Q}, N \cup \{p,
\infty\}} \rightarrow \mathrm{GL}_2 \left((\mathbb{T}_0
&#39;)_{\mathfrak{m}_{\bar{\rho}}} \right)\]</span> “built” from the
<span class="math inline">\(\rho_f\)</span>, for <span
class="math inline">\(f \in S_k(N, \bar{\mathbb{Z}}_p)\)</span>, with
<span class="math inline">\(\rho_f \equiv \bar{\rho}\)</span> modulo
<span
class="math inline">\(\mathfrak{m}_{\bar{\mathbb{Z}}_p}\)</span>.</em></p>
</div>
<p>(One can write down a characteristic polynomial, similar to the
above.) Maybe one should also say that <span id="eq:cq6sj6d3yn" class="math display">\[\label{eq:cq6sj6d3yn}\tag{2}
  \left( \mathbb{T} &#39;_{\mathcal{O}}
\right)_{\mathfrak{m}_{\bar{\rho}}} \subseteq \prod_{f, \rho_f \equiv
\bar{\rho}} \mathcal{O},\]</span> where the left hand side is generated
by all the <span class="math display">\[\left\{
\mathop{\mathrm{trace}}\rho_f({\mathop{\mathrm{Frob}}}_{\ell}) : \rho_f
\equiv \bar{\rho}, \ell \nmid N p \right\}.\]</span> Now, is the
inclusion <a href="#eq:cq6sj6d3yn" data-reference-type="eqref"
data-reference="eq:cq6sj6d3yn">\((2)\)</a> strict? If you take
twice the same form, then you get twice the same value.</p>
<p><strong>Vision of Mazur</strong>? Can <span
class="math inline">\(\rho_{\bar{\rho}}^{\mathrm{mod}}\)</span> be
characterized purely in terms of “Galois” theory, maybe at least once
<span class="math inline">\(\bar{\rho}\)</span> is given? You need to
start somewhere. Start with the mod <span
class="math inline">\(p\)</span> representation. Then there’s a sort of
<span class="math inline">\(p\)</span>-adic representation <a
href="#eq:cq6sj6h73f" data-reference-type="eqref"
data-reference="eq:cq6sj6h73f">\((1)\)</a> that you get here,
which sees all forms congruent to <span
class="math inline">\(\bar{\rho}\)</span>. Can you see this sort of
thing from a purely Galois-theoretic perspective? This might have been
the starting point for the study of deformations of Galois
representations. Mazur maybe had one example in mind: Hida had just
written down his Hida families, which are much bigger than things of
fixed weight and level.</p>
<p>Let’s now turn to <em>deformation functors</em>. In many ways, what
we’re doing now at the beginning is very formal, and maybe in the next
lecture it gets a bit more Galois-theoretic. Let <span
class="math inline">\(G\)</span> be a profinite group – think of some
global Galois group. Let <span class="math inline">\(E \supseteq
\mathcal{O} \rightarrow \mathbb{F}\)</span> be a local field, with
uniformizer <span class="math inline">\(\pi\)</span> and residue field
cardinality <span class="math inline">\(q\)</span>. In what natural
category do these <span
class="math inline">\(\mathcal{O}\)</span>-algebras <span
class="math inline">\(\mathbb{T}_{\mathcal{O}}&#39;\)</span> live?</p>
<div class="definition">
<p><strong>Definition 11</strong>. <span class="math inline">\(\mathrm{C
N L }_{\mathcal{O}}\)</span> is the category of complete noetherian
<span class="math inline">\(\mathcal{O}\)</span>-algebras <span
class="math inline">\((A, \mathfrak{m}_{A})\)</span> with residue field
<span class="math inline">\(\mathbb{F}\)</span> and with local
homomorphisms.</p>
</div>
<p>Typical rings: <span class="math inline">\(\mathcal{O} [[ X_1,
\dotsc, X_r\rrbracket / I\)</span>. Some structure theorem tells you
that this is all you can get. There is a finite subcategory <span
class="math display">\[\mathrm{Ar}_{\mathcal{O}} \subseteq \mathrm{C N
L}_{\mathcal{O}}\]</span> consisting of Artin objects.</p>
<div class="question">
<p><strong>Question 12</strong>. For <span
class="math inline">\(\bar{\rho} : G \rightarrow
\mathrm{GL}_n(\mathbb{F})\)</span>, when is the functor <span
class="math display">\[D_{\bar{\rho}} : \mathrm{C N L}_{\mathcal{O}}
\rightarrow \mathrm{Set}\]</span> <span class="math display">\[(A,
\mathfrak{m}_A) \mapsto \left\{ \rho_A : G \rightarrow \mathrm{GL}_n(A)
\mid \rho \mod{ \mathfrak{m}_A } \equiv \bar{\rho}\right\} /
\sim\]</span> representable by <span
class="math inline">\(R_{\bar{\rho}} \in \mathrm{C N
L}_{\mathcal{O}}\)</span>?</p>
</div>
<p>To fill in some terminology:</p>
<div class="definition">
<p><strong>Definition 13</strong>. </p>
<ol type="a">
<li><p>For <span class="math inline">\(A \in \mathrm{C N
L}_{\mathcal{O}}\)</span>, set <span class="math display">\[F_A :=
{\mathop{\mathrm{Hom}}}_{\mathrm{C N L}_{\mathcal{O}}}(A, \bullet) :
\mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set}.\]</span></p></li>
<li><p>Say that a functor <span class="math inline">\(F : \mathrm{C N
L}_{\mathcal{O}} \rightarrow \mathrm{Set}\)</span> is</p>
<ol type="i">
<li><p><em>representable</em> if there exists <span
class="math inline">\(A \in \mathrm{C N L }_{\mathcal{O}}\)</span> such
that <span class="math inline">\(F \cong F_A\)</span>, and</p></li>
<li><p><em>continuous</em> if for all <span class="math inline">\((A,
\mathfrak{m}_A) \in \mathrm{C N L}_{\mathcal{O}}\)</span>, the map <span
class="math inline">\(F(A) \rightarrow \lim_{n} F(A /
\mathfrak{m}_A^n)\)</span> is an isomorphism.</p></li>
</ol></li>
</ol>
</div>
<div class="exercise">
<p><strong>Exercise 2</strong>. </p>
<ol type="a">
<li><p>The fiber product of the diagram <span
class="math inline">\(\Delta\)</span> given by <span
class="math display">\[\begin{CD}
        @. B \\
        @. @V{\psi}VV \\
        A @&gt;{\varphi}&gt;&gt; C
      \end{CD}\]</span> inside <span class="math inline">\(\mathrm{A
r}_{\mathcal{O}}\)</span> is <span class="math display">\[\left\{(a, b)
\in A \times B \mid \varphi(a) \equiv \psi(b)
\right\}.\]</span></p></li>
<li><p><span class="math inline">\(\mathrm{C N L}_{\mathcal{O}}\)</span>
"has no fiber products".</p></li>
</ol>
</div>
<div class="exercise">
<p><strong>Exercise 3</strong>. Suppose <span class="math inline">\(F =
F_A\)</span> for <span class="math inline">\(A \in \mathrm{C N
L}_{\mathcal{O}}\)</span>. Then</p>
<ol type="a">
<li><p><span class="math inline">\(F(\mathbb{F}) = \{\ast\}\)</span>,
and <span class="math inline">\(F\)</span> is continuous.</p></li>
<li><p>The Mayer–Vietoris property (MV) holds for <span
class="math inline">\(F\)</span>, i.e., for all diagrams <span
class="math inline">\(\Delta\)</span>, the induced map <span
class="math inline">\((\ast)_\Delta\)</span> is bijective, where <span
class="math display">\[(\ast)_\Delta : F(A \times_{C} B) \rightarrow
F(A) \times_{F(C)} F(B),\]</span> where on the right hand side, we take
the fiber product in <span
class="math inline">\(\mathrm{Set}\)</span>.</p></li>
</ol>
</div>
<div class="notation">
<p><strong>Notation 14</strong>. </p>
<ul>
<li><p><span class="math inline">\(\mathbb{F}[\varepsilon] :=
\mathbb{F}[X] /(X^2)\)</span>.</p></li>
<li><p>Call <span class="math inline">\(\varphi : A \twoheadrightarrow A
&#39;\)</span> in <span
class="math inline">\(\mathrm{CNL}_{\mathcal{O}}\)</span> <em>small</em>
if <span class="math inline">\(\mathfrak{m}_{A&#39;}
\cdot(\ker(\varphi)) = 0\)</span>. (e.g., <span
class="math inline">\(\mathbb{F}[\varepsilon] \rightarrow
\mathbb{F}\)</span>)</p></li>
<li><p>For <span class="math inline">\(F : \mathrm{C N L}_{\mathcal{O}}
\rightarrow \mathrm{Set}\)</span>, define the <span
class="math inline">\(T_F := F(\mathbb{F}[\varepsilon])\)</span>, the
<em>tangent space</em> of <span
class="math inline">\(F\)</span>.</p></li>
</ul>
</div>
<p>You can translate this back into rings. Here are some more
exercises:</p>
<div class="exercise">
<p><strong>Exercise 4</strong>. If the functor <span
class="math inline">\(F\)</span> satisfies</p>
<ul>
<li><p><span class="math inline">\(F(\mathbb{F}) = \{\ast\}\)</span>,
and</p></li>
<li><p><span class="math inline">\((\ast)_{T_F} :
F(\mathbb{F}[\varepsilon] \times_{\mathbb{F}} \mathbb{F}[\varepsilon])
\rightarrow T_F \times T_F\)</span> is bijective,</p></li>
</ul>
<p>then <span class="math inline">\(T_F\)</span> is an <span
class="math inline">\(\mathbb{F}\)</span>-vector space.</p>
</div>
<div class="example">
<p><strong>Example 15</strong>. For <span class="math inline">\(F =
F_A\)</span>, we have <span class="math display">\[T_F =
{\mathop{\mathrm{Hom}}}_{\mathrm{C N L}_{\mathcal{O}}}(A,
\mathbb{F}[\varepsilon]) = {\mathop{\mathrm{Hom}}}_{\mathbb{F} } \left(
\mathfrak{m}_A /(\mathfrak{m}_{A}^2 , \pi), \mathbb{F} \right) =:
T_A.\]</span></p>
</div>
<div class="exercise">
<p><strong>Exercise 5</strong>. For <span class="math inline">\(\varphi
: A \rightarrow B\)</span> in <span class="math inline">\(\mathrm{C N
L}_{\mathcal{O}}\)</span>, the map <span
class="math inline">\(\varphi\)</span> is surjective if and only if
<span class="math inline">\(T_\varphi : T_B \rightarrow T_A\)</span> is
injective.</p>
</div>
<div class="theorem">
<p><strong>Theorem 16</strong> (Grothendieck). <em>Suppose <span
class="math inline">\(F : \mathrm{C N L}_{\mathcal{O}} \rightarrow
\mathrm{Set}\)</span> is continuous, satisfies <span
class="math inline">\(F(\mathbb{F}) = \{\ast\}\)</span>, the MV-property
holds, and <span class="math inline">\(\dim_{\mathbb{F}} T_F &lt;
\infty\)</span>. Then <span class="math inline">\(F\)</span> is
representable.</em></p>
</div>
<div class="remark">
<p><strong>Remark 17</strong>. For this last theorem, there are
simplifications by Schlessinger, <em>Functors of Artin rings</em>.
Schlessinger realized that these axioms of Grothendieck may be hard to
verify in concrete situations, so he gave a simple (but somewhat long)
list of axioms to verify. See Mazur ’87, and Gouvêa’s survey.</p>
</div>
<p>Let’s now turn to <em>Galois deformations functors</em>. We have our
usual <span class="math display">\[\bar{\rho} : G \rightarrow
\mathrm{GL}_n(\mathbb{F}).\]</span> We can do something about the
conjugation.</p>
<p><span class="math display">\[\Gamma_n(A) := \ker \left(
\mathrm{GL}_n(A) \rightarrow \mathrm{GL}_n(\mathbb{F}) \right).\]</span>
We define the <em>lifting</em> and <em>deformation</em> functors <span
class="math display">\[D_{\bar{\rho}}^{\square}, \, D_{\bar{\rho}} :
\mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set},\]</span> <span
class="math display">\[(A, \mathfrak{m}_A) \mapsto \left\{ \rho_A : G
\rightarrow \mathrm{GL}_n(A) \mid \rho_A \equiv \bar{\rho}
\mod{\mathfrak{m}_A} \right\}\]</span> (“lifting functor” or “framed
deformation functor”), and where for <span
class="math inline">\(D_{\bar{\rho}}\)</span>, we take things modulo
<span class="math inline">\(\Gamma_n(A)\)</span>-conjugacy (i.e.,
“deformations are lifts modulo conjugacy”).</p>
<div class="theorem">
<p><strong>Theorem 18</strong>. <em>Suppose <span
class="math inline">\(\Phi_\rho\)</span> holds, i.e., <span
class="math inline">\(\# \mathop{\mathrm{Hom}}(G, \mathbb{F}_p) &lt;
\infty\)</span>. Then:</em></p>
<ol type="a">
<li><p><em><span class="math inline">\(D_{\bar{\rho}}\)</span> always
has a “hull”.</em></p></li>
<li><p><em>If <span
class="math inline">\({\mathop{\mathrm{End}}}_G(\bar{\rho}) =
\mathbb{F}\)</span>, then <span
class="math inline">\(D_{\bar{\rho}}\)</span> is representable (uses
Schlessinger). This gives rise to <span
class="math inline">\(R_{\bar{\rho}}\)</span>.</em></p></li>
<li><p><em><span id="enumerate:cq6skams6j"
label="enumerate:cq6skams6j"></span> (Always) <span
class="math inline">\(D_{\bar{\rho}}^{\square}\)</span> is representable
(Kisin, Magid–Lubotzki). Gives rise to <span
class="math inline">\(R_{\bar{\rho}}^{\square}\)</span>.</em></p></li>
</ol>
</div>
<p>Here <a href="#enumerate:cq6skams6j" data-reference-type="eqref"
data-reference="enumerate:cq6skams6j">\((c)\)</a> is an
exercise you can do.</p>
<div class="example">
<p><strong>Example 19</strong>. Take <span class="math inline">\(n =
1\)</span>. Le <span class="math inline">\(\bar{\rho} : G \rightarrow
\mathrm{GL}_1(\mathbb{F}) = \mathbb{F}^\times\)</span>.
<strong>Fact</strong> (Teichmüller lift): there exists <span
class="math inline">\(\hat{\rho} : G \rightarrow
\mathrm{GL}_1(W(\mathbb{F}))\)</span>, a lift of <span
class="math inline">\(\bar{\rho}\)</span> such that <span
class="math inline">\(\hat{\rho}(G) \xrightarrow{\mathrm{red}}
\bar{\rho}(G)\)</span>.</p>
</div>
<div class="exercise">
<p><strong>Exercise 6</strong>. Suppose that <span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathrm{cts}}(G^{\mathrm{ab}},
\mathbb{F})\)</span> is finite. Then the universal deformation ring
<span class="math inline">\(R_{\bar{\rho}}\)</span> (which for <span
class="math inline">\(n = 1\)</span> is the same as the universal
lifting ring <span
class="math inline">\(R_{\bar{\rho}}^{\square}\)</span>) is isomorphic
to <span class="math display">\[\mathcal{O} [[(G^{\mathrm{ab}})_p
\rrbracket = \varprojlim
    \mathcal{O} \left[(G^{\mathrm{a b}})_p \right].\]</span> The
universal lifting is <span class="math display">\[\hat{\rho} \otimes
\left( G \rightarrow(G^{\mathrm{a b}})_p
      \hookrightarrow
      \mathcal{O} [[(G^{\mathrm{a b}})_p \rrbracket^\times.
    \right)\]</span></p>
</div>
<p>Special cases:</p>
<ol type="i">
<li><p><span id="enumerate:cq6skmixcf"
label="enumerate:cq6skmixcf"></span> <span class="math inline">\(G =
G_F\)</span>, <span class="math inline">\(F \supseteq
\mathbb{Q}_p\)</span> finite extension, then by local class field
theory, <span class="math display">\[(G^{\mathrm{a b}})_p \cong
\mu_{p^\infty}(F) \times \mathbb{Z}^{1 +[F :
\mathbb{Q}_p]}.\]</span></p></li>
<li><p><span id="enumerate:cq6skmix6w"
label="enumerate:cq6skmix6w"></span> <span class="math inline">\(G =
G_{K, S}\)</span>, <span class="math inline">\(S \supseteq
S_{\mathfrak{p}}\)</span> finite, then global class field theory gives
<span class="math display">\[(G^{\mathrm{a b}})_p \cong \frac{A_{K,
S}}{\text{finite $p$-group}}
    \times \mathbb{Z}_p^{r_2 + \delta},\]</span> where <span
class="math inline">\(r_2\)</span> denotes the number of complex places
and <span class="math inline">\(\delta = \delta_{K, p}\)</span> is the
<em>Leopoldt defect</em>, which the Leopoldt conjecture says is
zero.</p></li>
</ol>
<p>We turn to cohomology. For <span class="math inline">\(\bar{\rho} : G
\rightarrow \mathrm{GL}_n(\mathbb{F})\)</span>, define <span
class="math display">\[{\mathop{\mathrm{ad}}}_{\bar{\rho}} = M_{n \times
n}(\mathbb{F})\]</span> with the “adjoint action”: for <span
class="math inline">\(g \in A\)</span> and <span
class="math inline">\(\alpha \in M_{n \times n}\)</span>, we take <span
class="math display">\[g \cdot \alpha := \bar{\rho}(g) \cdot \alpha
\cdot \bar{\rho}(g)^{-1}.\]</span> (We remark that <span
class="math inline">\({\mathop{\mathrm{ad}}}_{\bar{\rho}} \cong \bar{\rho}
\otimes \bar{\rho}^\vee\)</span>.)</p>
<div class="proposition">
<p><strong>Proposition 20</strong>. </p>
<ol type="a">
<li><p><em>We have <span class="math inline">\(T_{D_\rho^{\square}} =
D_{\bar{\rho}}^{\square}(\mathbb{F}[\varepsilon]) \xleftarrow{\cong}
Z^1(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span>, where the map sends
a cocycle <span class="math inline">\(c : G \rightarrow
{\mathop{\mathrm{ad}}}_{\bar{\rho}}\)</span> to <span
class="math display">\[\rho_c : g \mapsto(1 + \varepsilon c(g))
\bar{\rho}(g).\]</span></em></p></li>
<li><p><em>The above map induces an isomorphism <span
class="math inline">\(H^1(G, \mathop{\mathrm{ad}}\bar{\rho})
\xrightarrow{\cong} T_{D_{\bar{\rho}}}\)</span>.</em></p></li>
<li><p><em>We have <span class="math inline">\(\dim B^1(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}}) = h^2 - h^0(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span>. (We use the notation <span
class="math inline">\(h^i := \dim H^i\)</span> and <span
class="math inline">\(z^i = \dim Z^i\)</span>.)</em></p></li>
</ol>
</div>
<div class="corollary">
<p><strong>Corollary 21</strong>. <em>For <span class="math inline">\(r
= h^1(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span>, <span
class="math inline">\(r^{\square} = z^1(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span>, we have surjections <span
class="math display">\[\mathcal{O} [[ X_1, \dotsc, X_r \rrbracket
\rightarrow R_{\bar{\rho}}\]</span> and <span
class="math display">\[\mathcal{O} [[ X_1, \dotsc, X_{r^{\square}}
\rrbracket \rightarrow R_{\bar{\rho}}^{\square},\]</span> and <span
class="math inline">\(r\)</span>, <span
class="math inline">\(r^{\square}\)</span> are optimal.</em></p>
</div>
<p>What’s the relevance of <span class="math inline">\(H^2\)</span>? Let
<span class="math inline">\(\varphi : A^1 \rightarrow A\)</span> be a
small extension, and let <span class="math inline">\(I :=
\ker(\varphi)\)</span>.</p>
<div class="question">
<p><strong>Question 22</strong>. Is the map <span
class="math inline">\(D_{\bar{\rho}}(A&#39;) \rightarrow
D_{\bar{\rho}}(A)\)</span> surjective?</p>
</div>
<p>Let <span class="math inline">\(\rho_A : G \rightarrow
\mathrm{GL}_n(A)\)</span> be as in the right hand side.</p>
<div class="fact">
<p><strong>Fact 23</strong>. <em>There exists a set-theoretic lift <span
class="math inline">\(\rho &#39; : G \rightarrow
\mathrm{GL}_n(A&#39;)\)</span> of <span
class="math inline">\(\rho_A\)</span> (i.e., <span
class="math inline">\(\varphi \circ \rho &#39; =
\rho_A\)</span>).</em></p>
</div>
<div class="definition">
<p><strong>Definition 24</strong>. Set <span
class="math display">\[c_{\rho &#39;} : G \times G \rightarrow
{\mathop{\mathrm{ad}}}_{\bar{\rho}} \otimes_{\mathbb{F}} I,\]</span> <span
class="math display">\[(g, h) \mapsto(\rho &#39;(g, h) \cdot \rho
&#39;(h)^{-1} \cdot \rho &#39;(g)^{-1}),\]</span> where this last
quantity lies in <span class="math inline">\(1 + M_{n \times
n}(I)\)</span>. We note that <span
class="math inline">\(({\mathop{\mathrm{ad}}}_{\bar{\rho}}
\otimes_{\mathbb{F}} I) \cong M_{n \times n}(I)\)</span>. To get back,
subtract <span class="math inline">\(1\)</span>.</p>
</div>
<div class="proposition">
<p><strong>Proposition 25</strong>. </p>
<ol type="a">
<li><p><em><span id="enumerate:cq6sknji3b"
label="enumerate:cq6sknji3b"></span> <span class="math inline">\(c_{\rho
&#39;} \in Z^2(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}} \otimes I)\)</span>,
<span class="math inline">\(\mathrm{Obs}(\rho_A, \varphi) =[ c_{\rho
&#39;} ] \in H^2(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}} \otimes
I)\)</span> is independent of <span class="math inline">\(\rho
&#39;\)</span>!</em></p></li>
<li><p><em><span id="enumerate:cq6sknjiey"
label="enumerate:cq6sknjiey"></span> We have <span
class="math inline">\(\mathrm{Obs}(\rho_A, \varphi) = 0\)</span> if and
only if there exists <span class="math inline">\(\rho_{A&#39;} \in
D_{\bar{\rho}}(A&#39;)\)</span> lifting <span
class="math inline">\(\rho\)</span>.</em></p></li>
</ol>
</div>
<p>We give a proof of <a href="#enumerate:cq6sknjiey"
data-reference-type="eqref"
data-reference="enumerate:cq6sknjiey">\((b)\)</a>. If
<span class="math inline">\(c_{\rho &#39;} = \partial^2 f\)</span> for
some <span class="math inline">\(f : G \rightarrow
{\mathop{\mathrm{ad}}}_{\bar{\rho}} \otimes I\)</span>, then you can check
that if you take your <span class="math inline">\(\rho &#39;\)</span>
and multiply it on the left with <span class="math inline">\(1 +
f\)</span>, we get an element <span class="math inline">\((1 + f) \rho
&#39; : G \rightarrow \mathrm{GL}_n(A&#39;)\)</span> that is a lift of
<span class="math inline">\(\rho_A\)</span> (to <span
class="math inline">\(D_{\bar{\rho}}^{\square}(A&#39;)\)</span>).</p>
<p>Mazur observed that you can do something with this obstruction
theory: you can prove something more about these projections on the top
line here. But you have a very coarse control over the kernel ideal
<span class="math inline">\(I\)</span> of the surjection.</p>
<div class="theorem">
<p><strong>Theorem 26</strong>. <em>Consider <span
class="math inline">\(\mathcal{R}  = \mathcal{O} [[  X_1, \dotsc, X_r
\rrbracket\)</span> projecting via something called <span
class="math inline">\(\pi\)</span> to <span
class="math inline">\(R_{\bar{\rho}}\)</span> (<span
class="math inline">\(r = h&#39;(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}}
1)\)</span>), with kernel <span class="math inline">\(J\)</span>. Then
<span class="math display">\[\mathcal{R} / \mathfrak{m}_{\mathcal{R}} J
\rightarrow R_{\bar{\rho}}\]</span> is small with kernel <span
class="math inline">\(J / \mathfrak{m}_{\mathcal{R}} J\)</span>, and
<span class="math display">\[\mathrm{o b} : \mathop{\mathrm{Hom}}(J /
\mathfrak{m}_R J, \mathbb{F}) \cong H^2(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}}),\]</span> <span
class="math display">\[\psi \mapsto(1 \otimes \psi) \operatorname{o b s}
\left( \rho_{\bar{\rho}}^{\mathrm{univ}}, \pi \right)\]</span> is
injective!</em></p>
</div>
<div class="corollary">
<p><strong>Corollary 27</strong>. <em>With <span
class="math inline">\(r, r^{\square}\)</span> from above and <span
class="math inline">\(s = h^2(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span> have presentations <span
class="math inline">\(R_{\bar{\rho}} := \mathcal{O} [[ x_1, \dotsc,
x_{r^{\square}} ]] /(f_1, \dotsc, f_s)\)</span>.</em></p>
</div>
<div class="definition">
<p><strong>Definition 28</strong> (ad hoc). The <em>expected
cohomological dimension</em> is <span
class="math display">\[\operatorname{e c d} \operatorname{i
m}(\bar{\rho}) = z^1(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}}) - h^2(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}}) = h^2 - \sum_{i = 0}^2(-1)^{i} h^i(G,
\mathop{\mathrm{ad}}\bar{\rho}).\]</span></p>
</div>
<div class="proposition">
<p><strong>Proposition 29</strong>. <em>If <span id="eq:cq6skreori" class="math display">\[\label{eq:cq6skreori}\tag{3}
    \dim_{\mathrm{\operatorname{s}}} R \frac{\square}{\rho} / \pi \leq
\mathrm{ec dim(\bar{\rho})},\]</span> then <span
class="math inline">\(R_{\bar{\rho}}^{\square}\)</span> is <span
class="math inline">\(0\)</span>-flat, of relative dimension <span
class="math inline">\(\operatorname{e c dim}(\bar{\rho})\)</span> over
<span class="math inline">\(\mathcal{O}\)</span>, and a complete
intersection.</em></p>
</div>
<div class="example">
<p><strong>Example 30</strong>. </p>
<ol type="a">
<li><p><span class="math inline">\(G = G_F\)</span>, where <span
class="math inline">\(F \supseteq \mathbb{Q}_{\ell}\)</span> is finite
and <span class="math inline">\(\ell \neq p\)</span>. Then <a
href="#eq:cq6skreori" data-reference-type="eqref"
data-reference="eq:cq6skreori">\((3)\)</a> holds. <span
class="math inline">\(\mathrm{e c dim} = 4^2\)</span>.</p></li>
<li><p><span class="math inline">\(G = G_F\)</span>, <span
class="math inline">\(F \supseteq \mathbb{Q}_p\)</span>. Then <a
href="#eq:cq6skreori" data-reference-type="eqref"
data-reference="eq:cq6skreori">\((3)\)</a> holds and each <span
class="math inline">\(\operatorname{ec dim} = n^2(1 +[F :
\mathbb{Q}_p])\)</span>.</p></li>
<li><p>If <span class="math inline">\(G = G_{K, S}\)</span>, then we
have many examples for <a href="#eq:cq6skreori"
data-reference-type="eqref"
data-reference="eq:cq6skreori">\((3)\)</a> if <span
class="math inline">\(k\)</span> is not totally real, <span
class="math inline">\(k\)</span> is totaly odd, and <span
class="math inline">\(\bar{\rho}\)</span> is totally odd, and <span
class="math inline">\(n \geq 2\)</span>. (Have to be careful. Use that
<span class="math inline">\(S \supseteq S_\infty \cup S_p sup
\dotsb\)</span>)</p></li>
<li><p>We have <span class="math display">\[\dim_{\mathrm{Krull}}
R_{\bar{\rho}}^n / \pi \leq \operatorname{ecdim}(\bar{\rho})\]</span>
for <span class="math inline">\(G = G_{K, S}\)</span>, with <span
class="math inline">\(G\)</span> and <span class="math inline">\(G_{K,
S}\)</span>, if and only if <span class="math inline">\(\delta =
0\)</span>.</p></li>
</ol>
</div>
<div class="remark">
<p><strong>Remark 31</strong>. To avoid the reliance on <span
class="math inline">\(\delta = 0\)</span> (often) by fixing a lift <span
class="math inline">\(\mu : G \rightarrow
\mathcal{O}^\times\)</span>.</p>
</div>
<p><em>Mazur’s vision</em>: for <span class="math inline">\(v \in
S\)</span>, define “geometric” subfunctors <span
class="math inline">\(D_v^{\square} \subseteq D_{\bar{\rho} / G_{K,
v}}^{\square}\)</span> and the pullback in <span
class="math inline">\((\underline{S} =(\bar{\rho}, S,(D_v^0)_{v \in
S}))\)</span> to get a diagram involving, for <span
class="math inline">\(G = G_{k , S}\)</span>, <span
class="math display">\[D_{\bar{\rho}}^{\square} \rightarrow \sqcup_{v
\in S} D_{\bar{\rho} \mid G_v}^{\square}\]</span> and <span
class="math display">\[D_{\underline{S}}^{\square} \rightarrow \sqcup_{v
\in S} D_v^{\square}.\]</span></p>
<p>Removing frames at right point, we get a <span
class="math display">\[R_{\mathcal{I}} \twoheadleftarrow
R_{\bar{\rho}}.\]</span></p>
<div class="question">
<p><strong>Question 32</strong>. Can we choose <span
class="math inline">\(\mathcal{I}\)</span> in such a way that some
natural map <span class="math display">\[R_{\rho} \rightarrow
\mathbb{T}_k(N, \varepsilon,
\mathcal{O})_{\mathfrak{m}_{\bar{\rho}}}\]</span> is an isomorphism?</p>
</div>
<p>We turn now to <em>local deformation problems</em>. How to get a more
geometric side of deformation rings? Fix <span
class="math display">\[\bar{\rho} : G_{K, S} \rightarrow
\mathrm{GL}_n(\mathbb{F}).\]</span> Write <span
class="math inline">\(\bar{\rho}_v := \bar{\rho} \mid_{G_v}\)</span>.
Fix a character <span class="math inline">\(\mu : G_{K, S} \rightarrow
\mathcal{O}^\times\)</span> lifting <span class="math inline">\(\det
\bar{\rho}\)</span>. Our next aim is to identify interesting special
loci in <span class="math display">\[X_{\bar{\rho}_v}^{\square} :=
\mathop{\mathrm{Spec}}(R_{\bar{\rho}_v}^{\square}).\]</span></p>
<div class="definition">
<p><strong>Definition 33</strong> (Thorne, who gave a compact
description). A <em>local deformation problem</em> is a subfunctor <span
class="math inline">\(D_v \subseteq D_{\bar{\rho}_v}^{\square,
\mu_v}\)</span> (possibly with fixed determinant, i.e., <span
class="math inline">\(\det(\rho) = \mu\)</span> – that’s what the
superscripted <span class="math inline">\(\mu_v\)</span> means) such
that</p>
<ol>
<li><p><span id="enumerate:cq6s0pdihm"
label="enumerate:cq6s0pdihm"></span> <span class="math inline">\(D_v
\cong F_{R_v}\)</span> for a quotient <span
class="math inline">\(R_v\)</span> of <span
class="math inline">\(R_{\bar{\rho}_v}^{\square, \mu}\)</span>.</p></li>
<li><p><span id="enumerate:cq6s0pgpcr"
label="enumerate:cq6s0pgpcr"></span> For all <span
class="math inline">\(A \in \mathrm{CNL}_{\mathcal{O}}\)</span> and
<span class="math inline">\(g \in \Gamma_n(A)\)</span>, <span
class="math display">\[\rho \in D_v(A) \implies g \rho g^{-1} \in
D_v(A).\]</span></p></li>
</ol>
</div>
<div class="remark">
<p><strong>Remark 34</strong>. <span
class="math inline">\(\Gamma_n(R_{\bar{\rho}_v^{\square}})\)</span> acts
by conjugation on <span
class="math inline">\(D_{\bar{\rho}_v}^{\square}(R_{\bar{\rho}_v}^{\square})\)</span>,
and hence (by universality of <span
class="math inline">\(R_{\bar{\rho}_v}^{\square}\)</span>), it acts on
<span class="math inline">\(R_{\bar{\rho}_v}^{\square}\)</span>.</p>
</div>
<div class="proposition">
<p><strong>Proposition 35</strong> (BLGHT, Potential Automorphy 2, Lemma
3.2). <em>Let <span class="math inline">\(R_v\)</span> be a quotient
<span class="math inline">\(R_{\bar{\rho}_v}^{\square, \mu}
\xrightarrow{\alpha_v} R_v\)</span> such that</em></p>
<ol type="a">
<li><p><em><span id="enumerate:cq6s0pxwwm"
label="enumerate:cq6s0pxwwm"></span> <span
class="math inline">\(\ker(\alpha_v)\)</span> is invariant under <span
class="math inline">\(\Gamma_n(R_{\bar{\rho}_v}^{\square})\)</span>,
and</em></p></li>
<li><p><em><span id="enumerate:cq6s0pxv8b"
label="enumerate:cq6s0pxv8b"></span> <span
class="math inline">\(R_v\)</span> is reduced and not isomorphic to
<span class="math inline">\(\mathbb{F}\)</span>.</em></p></li>
</ol>
<p><em>Then <span class="math inline">\(F_{R_v} \subseteq
D_{\bar{\rho}_v}^{\square}\)</span> is a local deformation
problem.</em></p>
</div>
<p><strong>Construction of the</strong> <span
class="math inline">\(R_v&#39;s\)</span>? <strong>(Kisin)</strong>: Let
<span class="math inline">\(X_v \subseteq
X_{\bar{\rho}_v}^{\square}(\bar{\mathbb{Q}}_p)\)</span> be <span
class="math inline">\(\Gamma_n(\bar{\mathbb{Q}}_p)\)</span>-invariant.
Each <span class="math inline">\(x \in
X_{\bar{\rho}_v}^{\square}(\bar{\mathbb{Q}}_p)\)</span> gives a map
<span class="math display">\[\rho_x : G_v \rightarrow
\mathrm{GL}_n(\bar{\mathbb{Q}}_p),\]</span> and also <span
class="math display">\[\alpha_x : R_{\bar{\rho}_v}^{\square} \rightarrow
\bar{\mathbb{Q}}_p.\]</span> Then <span class="math display">\[J :=
\cap_{x \in X_v} \ker(\alpha_x)\]</span> is <span
class="math inline">\(\Gamma_n(R_{\bar{\rho}_v}^{\square})\)</span>-invariant.
(Need to check whether condition <a href="#enumerate:cq6s0pxv8b"
data-reference-type="eqref"
data-reference="enumerate:cq6s0pxv8b">\((b)\)</a> above
holds to get the local deformation problem, but at least there is a good
starting point for something.) You can define some <span
class="math display">\[R_{X_v} := R_{\bar{\rho}_v}^{\square} /
I.\]</span> Then <span
class="math inline">\(\mathop{\mathrm{Spec}}R_{X_v}\)</span> “is” the
schematic closure of <span class="math inline">\(X_v\)</span> in <span
class="math inline">\(X_{\bar{\rho}_v}^{\square}\)</span>.</p>
<p>For a classification of the <span class="math inline">\(\rho : G_v
\rightarrow \mathop{\mathrm{GL}}(V)\)</span> with <span
class="math inline">\(V \simeq \bar{\mathbb{Q}}_p^n\)</span>, with <span
class="math inline">\(v \neq \infty\)</span> and <span
class="math inline">\(\ell = \operatorname{char}(v) \neq p\)</span>, use
the <strong>Grothendieck monodromy theorem</strong>. Choose a surjection
<span class="math display">\[t_p : I_v \rightarrow I_v^{\mathrm{tame}}
\simeq \hat{\mathbb{Z}}^{(\ell)} \xrightarrow{\text{surj}}
\mathbb{Z}_p.\]</span></p>
<ol type="a">
<li><p><span id="enumerate:cq6s0sm0js"
label="enumerate:cq6s0sm0js"></span> There is a unique <span
class="math inline">\(N = N_\rho \in
\operatorname{End}_{\bar{\mathbb{Q}}_p}(V)\)</span> and an open subgroup
<span class="math inline">\(I \subseteq I_v\)</span> so that <span
class="math display">\[\rho \mid_I = \exp \left(
      t_p(\bullet) N
    \right) \mid_I.\]</span></p></li>
<li><p><span id="enumerate:cq6s0sm7x5"
label="enumerate:cq6s0sm7x5"></span> For <span
class="math inline">\(N\)</span> from <a href="#enumerate:cq6s0sm0js"
data-reference-type="eqref"
data-reference="enumerate:cq6s0sm0js">\((a)\)</a>, <span
class="math display">\[r = r_\rho : I_v \rightarrow
\mathrm{GL}(V),\]</span> <span class="math display">\[g \mapsto \rho(g)
\exp(- t_p(\bullet) N)\]</span> is a continuous representation with
finite image. Call <span class="math display">\[\tau =(r, N) = \mathrm{W
D}(\rho)\]</span> the (inertial) Galois type of <span
class="math inline">\(\rho\)</span>.</p></li>
</ol>
<p>Let <span class="math display">\[X_\tau := \left\{ x \in
X_{\bar{\rho}_v}^{\square}(\bar{\mathbb{Q}}_p) \mid \mathrm{WD}(\rho)
\simeq \tau \right\}.\]</span> Note that <span class="math display">\[\#
\left\{ \tau \mid \tau \text{ arises from }
X_{\bar{\rho}_v}^{\square}(\bar{\mathbb{Q}}_p) \right\}_{/ \cong}
  &lt; \infty.\]</span> Define <span
class="math display">\[R_{\bar{\rho}_v}^{\square, \tau} := R_{X_\tau}
\twoheadleftarrow R_{\bar{\rho}_v}^{\square}.\]</span></p>
<div class="theorem">
<p><strong>Theorem 36</strong> (Sholton, Proposition 3.6). </p>
<ol type="a">
<li><p><em><span id="enumerate:cq6s0szq5l"
label="enumerate:cq6s0szq5l"></span> <span
class="math inline">\(R_{\bar{\rho}_v}^{\square, \tau}\)</span> defines
a local deformation problem at <span
class="math inline">\(v\)</span>.</em></p></li>
<li><p><em><span id="enumerate:cq6s0szrtp"
label="enumerate:cq6s0szrtp"></span> <span
class="math inline">\(\mathop{\mathrm{Spec}}(R_{\bar{\rho}_v}^{\square,
\tau})\)</span> is a union of irreducible components of <span
class="math inline">\(X_{\bar{\rho}_v}^{\square}\)</span>, and
equidimensional (<span
class="math inline">\(n^2\)</span>).</em></p></li>
<li><p><em><span id="enumerate:cq6s0s13y6"
label="enumerate:cq6s0s13y6"></span> <span
class="math inline">\(R_{\bar{\rho}_v}^{\square,
\tau}[\tfrac{1}{p}]\)</span> is reduced, contains a dense set of
(generic) smooth points.</em></p></li>
</ol>
</div>
<p><strong>Warning</strong> (depending upon how much you are interested
in singularities of schemes, or not): <span
class="math inline">\(R_{\bar{\rho}_v}^{\square}\)</span> is a complete
intersection, but the components <span
class="math inline">\(R_{\bar{\rho}_v}^{\square, \tau}\)</span> can
apparently have much worse singularieties – they need not even be
Cohen–Macaulay.</p>
<p>Let’s say a bit about the case <span class="math inline">\(v \mid
p\)</span>, where things get a bit vaguer. Now take <span
class="math inline">\(K_v \supseteq \mathbb{Q}_p\)</span> finite, and
consider the set of all representations <span id="eq:cq6s0s7n4f" class="math display">\[\label{eq:cq6s0s7n4f}\tag{4}
  \left\{ \rho : G_v \rightarrow \mathrm{GL}_n(\bar{\mathbb{Q}}_p)
\right\}.\]</span> By <span class="math inline">\(p\)</span>-adic Hodge
theory, this contains the following set of representations that are
“geometric” in some sense: <span id="eq:cq6s0s8j3o" class="math display">\[\label{eq:cq6s0s8j3o}\tag{5}
  \left\{ \rho : G_v \rightarrow \mathrm{GL}_n(\bar{\mathbb{Q}}_p) \mid
\rho \text{ is potentially semistable}\right\}.\]</span> Fontaine
attaches invariants to these <span
class="math inline">\(\rho\)</span>’s. One thing he attaches is a Galois
type <span class="math display">\[\operatorname{WD}(\rho) =(r_\rho,
N_\rho),\]</span> although in a very different way than before: in this
case, where <span class="math inline">\(K_v\)</span> is a <span
class="math inline">\(p\)</span>-adic field, the pro-<span
class="math inline">\(p\)</span>-part of the inertia is not this
harmless <span class="math inline">\(\mathbb{Z}_p\)</span>, but is
instead a huge group that can be complicated, so one really needs to use
<span class="math inline">\(p\)</span>-adic Hodge theory to get
something here. Here, as before, <span
class="math inline">\(N_\rho\)</span> is a nilpotent operator and <span
class="math inline">\(r_\rho : I_v \rightarrow
\mathrm{GL}_n(\bar{\mathbb{Q}}_p)\)</span> is a finite-dimensional
representation. Fontaine also attaches a set of Hodge–Tate weights <span
class="math display">\[\nu = \underline{\mathrm{H T}}(\rho) = \left\{
\mathrm{H T}_{\iota} \right\}_{\iota : K_v \rightarrow
\bar{\mathbb{Q}}_p}.\]</span> We attach some <span
class="math display">\[X_{\tau, \nu} = \left\{ \rho : G_v \rightarrow
\mathrm{GL}_n(\bar{\mathbb{Q}}_p) \text{ potentially semistable } \mid
    \operatorname{W D}(\rho) \simeq \tau,
    \,
    \underline{\operatorname{H T}}(\rho) = \nu
  \right\}.\]</span> Kisin then attaches potentially semistable
deformation rings <span class="math inline">\(R_{\bar{\rho}_v}^{\square,
\tau, \nu}\)</span>.</p>
<div class="remark">
<p><strong>Remark 37</strong>. If <span class="math inline">\(n =
2\)</span> and <span class="math inline">\(K = \mathbb{Q}\)</span>, and
if you somehow have <span class="math inline">\(\mathrm{H
T}\)</span>-weights <span class="math inline">\(\nu =(k = 1,
0)\)</span>, <span class="math inline">\(k\)</span> “small”, (<span
class="math inline">\(k \geq 2\)</span>), <span
class="math inline">\(\tau = (\mathrm{triv}, 0)\)</span> (giving rise to
<span class="math inline">\(\rho\)</span> crystalline), then <span
class="math display">\[R_{\bar{\rho}_p}^{\square, \nu, \tau} \simeq
\mathcal{O} [[ X_1, \dotsc, X_5]].\]</span> (Alternative: use ordinary
deformation rings.)</p>
</div>
<p><strong>Global deformation rings</strong>. Fix <span
class="math inline">\(f \in S_k(N, \varepsilon, \mathbb{F})\)</span>,
take <span class="math inline">\(E\)</span> sufficiently large. We get
<span class="math display">\[\bar{\rho} : G_{\mathbb{Q}, N p \infty}
\rightarrow \mathrm{GL}_2(\mathbb{F}).\]</span> We found <span
class="math display">\[\mathfrak{m}_{\bar{\rho}} \leq
\mathbb{T}_{\mathfrak{o}} \rightsquigarrow
\rho_{\bar{\rho}}^{\mathrm{mod}} : G_{\mathbb{Q}, N p \infty}
  \rightarrow \mathrm{GL}_2
\left((\mathbb{T}_{\mathcal{O}})_{\mathfrak{m}_p} \right).\]</span> Now,
for the ramified primes <span class="math inline">\(\ell \mid N
p\)</span>, local Langlands gives a list <span
class="math inline">\(T_{\ell}\)</span> of Galois types that arise from
(forms parametrized by) <span
class="math inline">\((\mathbb{T}&#39;_{\mathcal{O}})_{\mathfrak{m}_{\bar{\rho}}}\)</span>.
At <span class="math inline">\(p\)</span>, you also get <span
class="math inline">\(\mathrm{H T}\)</span>-weights <span
class="math inline">\((k - 1, 0)\)</span> (papers of Faltings and of
Saito). From this dta, you now get a local deformation problem <span
class="math display">\[D_{\ell} = D_{\bar{\rho}_{\ell}}^{\square,
T_{\ell}} \subseteq D_{\bar{\rho}_{\ell}}^{\square}
  \quad \text{and} \quad
  D_{\bar{\rho}_p}^{\square, T_p, \nu}.\]</span> You form the pullback
functor for a list <span class="math display">\[\underline{S}
=(\bar{\rho}, N, S,(D_{\ell})_{\ell \mid N p}),\]</span> where <span
class="math inline">\(S\)</span> is the divisor of <span
class="math inline">\(N p \infty\)</span>. (Let’s suppose <span
class="math inline">\(p &gt; 2\)</span>.) Get a restriction from global
to local: <span class="math display">\[D_{\bar{\rho}}^{\square, \mu}
  \xrightarrow{\mathop{\mathrm{res}}}
  \prod_{\ell \mid N p}
  D_{\bar{\rho}_{\ell}}^{\square, \mu}.\]</span></p>
<p><span class="math display">\[\begin{CD}         
    D_{\bar{\rho}}^{\square, \mu} @&gt; \mathop{\mathrm{res}}&gt;&gt;
\prod_{\ell \mid N p}
    D_{\bar{\rho}_{\ell}}^{\square, \mu}\\
    @AAA  @AAA \\
    D_{\underline{S}}    @&gt;&gt;&gt; \prod_{\ell \mid N p} D_{\ell}\\
  \end{CD}\]</span> which gives rise to <span
class="math inline">\(R_{\underline{S}}\)</span> as a quotient of <span
class="math inline">\(R_{\bar{\rho}}^{\square, \mu}\)</span>, with <span
class="math display">\[\rho_{\underline{S}}^{\mathrm{univ}} :
G_{\mathbb{Q}, N p \infty} \rightarrow
\mathrm{GL}_2(R_{\underline{S}}).\]</span> Universality of <span
class="math inline">\(R_{\underline{S}}\)</span> (using local Langlands
and <span class="math inline">\(p\)</span>-adic Hodge theory) gives a
surjection <span id="eq:cq6s0uhkx2" class="math display">\[\label{eq:cq6s0uhkx2}\tag{6}
  \alpha : R_{\underline{S}}
\rightarrow(\mathbb{T}_{\mathcal{O}})_{\mathfrak{m}_{\bar{\rho}}},\]</span>
<em>assuming</em> that <span class="math inline">\(\bar{\rho}\)</span>
is absolutely irreducible.</p>
<div class="conjecture">
<p><strong>Conjecture 38</strong>. <em><span
class="math inline">\(\alpha\)</span> is an isomorphism under suitable
hypothesis.</em></p>
</div>
<p>The hope is that one can find a Galois-theoretic representation that
completely describes this thing coming from automorphic representations.
This was all first put into some definite form by Wiles and Taylor–Wiles
in their proof of Fermat’s last theorem. Their work gave the first great
supply of such isomorphisms. Then there was
Breuil–Conrad–Diamond–Taylor, proving Taniyama–Shimura–Weil conjecture.
Then there was Clozel–Harris–Taylor, and Khare–Winterberger proving the
Serre conjecture. One thing about why this thing could be important, and
why it was important in many of these cases. What helps you sometimes is
that being modular is “contagious”. What is often relatively easy, maybe
if the representation (a <span class="math inline">\(p\)</span>-adic
Galois representation) comes from the ring on the left hand side of <a
href="#eq:cq6s0uhkx2" data-reference-type="eqref"
data-reference="eq:cq6s0uhkx2">\((6)\)</a>, and now if you have
the full isomorphism <a href="#eq:cq6s0uhkx2"
data-reference-type="eqref"
data-reference="eq:cq6s0uhkx2">\((6)\)</a>, then you know it
also comes form the right hand side. But in practice, this isomoprhism
doesn’t tell you modularity of one just form in the class giving rise to
the right hand side, but all of them. That’s all.</p>
<h1 id="chris-skinners-lectures">Chris Skinner’s lectures</h1>
<p><strong>Integral representations, Euler systems, and multiplicity
one</strong>.</p>
<p>My choice of these topics is motivated by my interest in special
values of <span class="math inline">\(L\)</span>-functions, and in
particular problems like the BSD conjecture. We’ll focus on some
representation theory, that plays a role in both the analytic and the
algebraic sides of these problems. You can possibly view this as a
bridge between the talks at the start and at the end of the week.</p>
<p>Let’s start by talking about <em>integral representations</em>. It’s
helpful to think <span class="math display">\[\text{$L$-function} =
  \int_{\text{symmetric space } X}
  (\text{automorphic form}),\]</span> where perhaps the automorphic form
starts on some larger symmetric space <span class="math inline">\(Y
\supseteq X\)</span>. This is useful because it’s our main tool for
studying <span class="math inline">\(L\)</span>-functions.</p>
<p>The next part of my title is <em>Euler systems</em>. This is going to
seem like something different. What are Euler systems? One starts off
with a continuous action <span class="math display">\[G_k =
\mathop{\mathrm{Gal}}(\bar{k} / k) \circlearrowright V,\]</span> where
<span class="math inline">\(V\)</span> is a <span
class="math inline">\(\mathbb{Q}_p\)</span>-space of finite dimension
(with <span class="math inline">\(\mathbb{Q}_p\)</span> acting linearly
and continuously). At least conjecturally, there’s a fairly general
framework for producing such <span class="math inline">\(V\)</span> from
automorphic forms or representations. This Galois representation
captures something about the automorphic form that can be expressed in
terms of the <span class="math inline">\(L\)</span>-function. All of
these things are thus related to one another, even if they are
frequently encountered separately. Here <span
class="math inline">\(V\)</span> often stabilizes in a <span
class="math inline">\(\mathbb{Z}_p\)</span>-submodule (lattice), which
might yield a good exercise for later. An Euler system is a collection
of classes in Galois cohomology <span class="math inline">\(c_F \in
H^1(F, T)\)</span>, where <span class="math inline">\(F / k\)</span> are
certain abelian extensions of <span class="math inline">\(k\)</span>
satisfying certain compatibilities: for <span
class="math inline">\(F&#39; \supseteq F\)</span>, <span
class="math display">\[\operatorname{cores}_{F&#39; / F}(c_{F &#39;}) =
? c_F,\]</span> where <span class="math inline">\(?\)</span> often seems
the local Euler factors of <span class="math inline">\(V\)</span> (or
some <span class="math inline">\(L\)</span>-function attached to <span
class="math inline">\(V\)</span>, depending upon the setting).</p>
<p>Both of these settings have been useful for exploring special values
of <span class="math inline">\(L\)</span>-functions (Kolyvagin,
Gross–Zagier, ...). What we’ll focus on in these lectures is the role
that multiplicity one plays in seeing these <span
class="math inline">\(L\)</span>-functions and in producing these Euler
systems. We’ll see that they essentially play the same role, which is
further evidence for what people say, to the effect that Euler systems
are some sort of algebraic incarnation of <span
class="math inline">\(L\)</span>-functions.</p>
<p>What do we mean by “multiplicity one”? One frequently encounters this
term in the theory of automorphic forms, in various guises:</p>
<ol>
<li><p><span id="enumerate:cq6r3ndbhy"
label="enumerate:cq6r3ndbhy"></span> Uniqueness of a representation in
some space of functions, e.g.:</p>
<ol type="a">
<li><p><span id="enumerate:cq6r3m96yd"
label="enumerate:cq6r3m96yd"></span> A cuspidal automorphic
representation of <span class="math inline">\(\mathrm{GL}_2\)</span>
shows up with multiplicity one <span
class="math inline">\(L^2(\mathrm{GL}_2(k) \backslash
\mathrm{GL}_2(\mathbb{A}_k))\)</span>.</p></li>
<li><p><span id="enumerate:cq6r3m98gf"
label="enumerate:cq6r3m98gf"></span> Uniqueness of (local) Whittaker
models for <span class="math inline">\(\mathrm{GL}_2\)</span>.</p></li>
</ol></li>
<li><p><span id="enumerate:cq6r3ndama"
label="enumerate:cq6r3ndama"></span> Uniqueness of some (invariant)
linear functional: for <span class="math inline">\(H \leq G\)</span> and
<span class="math inline">\(\pi\)</span> a representation of <span
class="math inline">\(G\)</span>, <span class="math display">\[\dim
{\mathop{\mathrm{Hom}}}_H(\pi, \mathbb{C}) \leq 1.\]</span> Or, for <span
class="math inline">\(\sigma\)</span> a representation of <span
class="math inline">\(H\)</span>, as the assertion that <span
class="math inline">\(\dim {\mathop{\mathrm{Hom}}}_H(\pi, \sigma) \leq
1\)</span>.</p></li>
</ol>
<p>The first examples can be understood in terms of the latter. The
latter will be a useful framework for us.</p>
<p>Let’s now turn to integral representations and give some examples.
The first integral representation we see is that of the Riemann zeta
function. Let <span id="eq:cq6r3qe33m" class="math display">\[\label{eq:cq6r3qe33m}\tag{7}
  \psi(t) = \sum_{n = 1}^\infty e^{- \pi n^2 t}.\]</span> Then for <span
class="math inline">\(\Re s\)</span> sufficiently large, <span id="eq:cq6r3p0tmc" class="math display">\[\label{eq:cq6r3p0tmc}\tag{8}
  \int_0^\infty \psi(t) t^{\frac{1}{2} s - 1} \, d t
  = \pi^{- s/2} \Gamma(\tfrac{s}{2}) \zeta(s).\]</span> We see this by
bringing the summation outside the integral. This gives a Mellin
transform.</p>
<p>What’s the automorphic side of this? If we look at, for <span
class="math inline">\(\tau = x + i y\)</span>, <span
class="math display">\[\theta(\tau) = \sum_{n \in \mathbb{Z}} e^{- 2 \pi
i n^2 \tau}.\]</span> This is an automorphic form, and we have <span
class="math display">\[(\tfrac{1}{2}(\theta(i y) - 1)) = \psi(2
y),\]</span> so <a href="#eq:cq6r3p0tmc" data-reference-type="eqref"
data-reference="eq:cq6r3p0tmc">\((8)\)</a> is an integral
representation for the Riemann zeta function coming from the symmetric
space for a torus embedded inside <span
class="math inline">\(\mathrm{GL}_2\)</span>. One has similar integral
representations for the Dirichlet <span
class="math inline">\(L\)</span>-functions. (No multiplicity one that we
can see thus far.)</p>
<p>This gets souped up in the work of Hecke and Iwasawa–Tate, which
inspired how automorphic <span
class="math inline">\(L\)</span>-functions have been studied
subsequently. Let’s recall how that goes. Let <span
class="math inline">\(k\)</span> be a number field. We have the adeles
<span class="math inline">\(\mathbb{A}_k\)</span> and the ideles <span
class="math inline">\(\mathbb{A}_k^\times\)</span>. We have a Hecke
character <span class="math display">\[\chi : k^\times \backslash
\mathbb{A}_k^\times \rightarrow \mathbb{C}^\times,\]</span> which
factors as a product <span class="math inline">\(\chi = \prod
\chi_v\)</span> of characters <span class="math inline">\(\chi_v :
k_v^\times \rightarrow \mathbb{C}^\times\)</span> indexed by the places
<span class="math inline">\(v\)</span> of <span
class="math inline">\(k\)</span>. (This is of course very useful, but is
specific for <span class="math inline">\(\mathrm{GL}_1\)</span>, and so
obscures some of the more general features.) Let <span
class="math inline">\(\phi \in \mathcal{S}(\mathbb{A})\)</span> be a
Schwartz function, which could also be a product <span
class="math inline">\(\phi = \prod \phi_v\)</span> of local Schwartz
functions <span class="math inline">\(\phi_v \in
\mathcal{S}(k_v)\)</span>. We recall that this means that</p>
<ul>
<li><p>when <span class="math inline">\(v\)</span> is finite, <span
class="math inline">\(\phi_v\)</span> is smooth and compactly-supported,
and</p></li>
<li><p>when <span class="math inline">\(v\)</span> is archimedean, all
derivatives decay faster than any polynomial, e.g., <span
class="math inline">\(e^{- \pi t^2}\)</span>.</p></li>
</ul>
<p>Furthermore, <span class="math inline">\(\phi_v =
1_{\mathcal{O}_{k_v}}\)</span> for almost all finite <span
class="math inline">\(v\)</span>. We then form <span
class="math display">\[\theta(x) = \sum_{\alpha \in k} \phi(\alpha
x).\]</span> (It’s a good exercise to see how to specialize this to
obtain something like <a href="#eq:cq6r3qe33m"
data-reference-type="eqref"
data-reference="eq:cq6r3qe33m">\((7)\)</a>.) We then form the
integral <span class="math display">\[\int_{k^\times \backslash
\mathbb{A}_k^\times} \chi(x) \lvert x \rvert^s \theta(x) \,d^\times
x.\]</span> These integrals converge absolutely for <span
class="math inline">\(\Re s\)</span> sufficiently large and unfold in
the usual way, giving (at least for <span
class="math inline">\(\chi\)</span> not a power of the absolute value,
so that we don’t need to worry about the contribution of <span
class="math inline">\(\alpha = 0\)</span>) <span
class="math display">\[\int_{\mathbb{A}_k^\times} \chi(x) \lvert x
\rvert^s \phi(x) \, d x.\]</span> If <span class="math inline">\(\phi =
\prod \phi_v\)</span>, then these factor further as <span id="eq:cq6r32qpe5" class="math display">\[\label{eq:cq6r32qpe5}\tag{9}
  \prod \int_{k_v^\times} \chi_v(x) \lvert x \rvert_v^s \phi_v(x) \, d
x.\]</span> One can show that the local integrals at non-archimedean
places are rational functions, form the greatest common divisor of their
denominators, and this turns out to be the way you can define the local
<span class="math inline">\(L\)</span>-function. This is Tate’s thesis.
We haven’t yet really made any reference to multiplicity one. This shows
up when you try to generalize to other settings.</p>
<p>We may think of <span
class="math inline">\(\mathbb{A}_k^\times\)</span> as <span
class="math inline">\(\mathrm{GL}_1(\mathbb{A}_k)\)</span>. Let’s now
consider <span
class="math inline">\(\mathrm{GL}_n(\mathbb{A}_k)\)</span>. We discuss
Godement–Jacquet theory, which is a generalization of what Tate did to
<span class="math inline">\(\mathrm{GL}_n\)</span>. Let <span
class="math inline">\(\pi\)</span> be a cuspidal automorphic
representation (by convention, irreducible). Abstractly, this is
isomorphic to a restricted tensor product <span
class="math inline">\(\otimes \pi_v\)</span> of irreducible local
representations <span class="math inline">\(\pi_v\)</span> of <span
class="math inline">\(\mathrm{GL}_n(k_v)\)</span>. We can thus identify
an element <span class="math inline">\(\varphi \in \pi\)</span> with a
sum of tensor products of vectors (although, unlike in the case of
characters, it will not pointwise be a product of local functions). Now,
mimicking what was done before, we take a Schwartz function <span
class="math inline">\(\phi \in \mathcal{S}(M_n(\mathbb{A}_k))\)</span>,
and form a theta function <span class="math display">\[\theta(x)
  =
  \sum_{\alpha \in M_n(k)}
  \phi(\alpha x).\]</span> We then form <span
class="math display">\[\int_{\mathrm{GL}_n(k) \backslash
\mathrm{GL}_n(\mathbb{A}_k)}
  \varphi(x) \lvert \det(x) \rvert^s \theta(x) \,d^\times x.\]</span>
This unfolds to <span
class="math display">\[\int_{\mathrm{GL}_n(\mathbb{A})} \varphi(x)
\lvert \det x \rvert^s \phi(x) \, d^\times x.\]</span> But does it
factor? Not obviously.</p>
<p>Let’s now form <span class="math display">\[\theta(h, g) =
\sum_{\alpha \in M_n(k)} \phi(h^{-1} \alpha g)\]</span> and consider
<span class="math display">\[\int_{[\mathrm{GL}_n]} \varphi(g) \lvert
\det g \rvert^s \theta(h, g) \, d g.\]</span> This is now automorphic as
a function of <span class="math inline">\(h\)</span>, so we can
decompose it with respect to the automorphic spectrum. To compute the
coefficients in that decomposition, we consider, for <span
class="math inline">\(\tilde{\varphi}\)</span> in the contragredient (or
dual) <span class="math inline">\(\tilde{\pi}\)</span> of <span
class="math inline">\(\pi\)</span>, the iterated integral <span
class="math display">\[\int_{[\mathrm{GL}_n^1]}
  \left(  \int_{[\mathrm{GL}_n]} \varphi(g) \lvert \det g \rvert^s
\theta(h, g) \, d g \right)
  \tilde{\varphi}(h) \, d h,\]</span> where <span
class="math inline">\(\mathrm{GL}_n^1\)</span> means either that we mod
out by the center or that we restrict to <span
class="math inline">\(\lvert \det \rvert = 1\)</span>. Then, reordering
terms and unfolding, we obtain <span
class="math display">\[\int_{\mathrm{GL}_n(\mathbb{A})} \phi(g) \lvert
\det g \rvert^s
  \left( \int_{[\mathrm{GL}_n^1]} \tilde{\varphi}(h)
    \varphi(h g) \,d h
  \right) \, d g.\]</span> We can understand the parenthetical inner
integral as <span class="math display">\[\langle \tilde{\varphi}, \pi(g)
\varphi \rangle,\]</span> where <span class="math display">\[\langle
\varphi_1, \varphi_2 \rangle = \int_{[\mathrm{GL}_n^1]} \varphi_1(h)
\varphi_2(h) \, d h.\]</span> This pairing defines a <span
class="math inline">\(G\)</span>-invariant functional <span
class="math inline">\(\langle , \rangle :  \tilde{\pi} \times \pi
\rightarrow \mathbb{C}\)</span>, which is locally unique, hence factors
as a product of local invariant functionals <span
class="math inline">\(\langle , \rangle_v : \tilde{\pi}_v \times \pi_v
\rightarrow \mathbb{C}\)</span>, thus <span
class="math display">\[\langle , \rangle =(\ast) \prod_v \langle ,
\rangle_v.\]</span> The leading constant <span
class="math inline">\((\ast)\)</span> will depend upon our
normalizations of the local and global integrals, and our normalization
of the comparison between <span class="math inline">\(\pi\)</span> and
<span class="math inline">\(\otimes \pi_v\)</span>.</p>
<p>This is the first example where multiplicity one shows up in what
we’ve discussed. In the afternoon talk, we’ll very quickly describe a
few other automorphic <span class="math inline">\(L\)</span>-function
settings where we see multiplicity one, and then start to move to the
Euler system side of things.</p>
<p><strong>Afternoon talk</strong>.</p>
<p>Factoring the integral is only one step towards understanding the
<span class="math inline">\(L\)</span>-functions. The next thing one
needs to do is to compute these local integrals. This of course seems
more tractable than working globally, which is the point. For instance,
in the Iwasawa–Tate setting, when all of the data is unramified (meaning
<span class="math inline">\(\chi_v\)</span> is an unramified character
and <span class="math inline">\(\phi_v\)</span> is the characteristic
function of the ring of integers), then the local factor in <a
href="#eq:cq6r32qpe5" data-reference-type="eqref"
data-reference="eq:cq6r32qpe5">\((9)\)</a> is easy to compute,
and gives a local zeta function. This is more complicated in the
Godement–Jacquet setting, but still doable. Then in the ramified
situations, there is the question of how to choose good vectors so that
one gets the <span class="math inline">\(L\)</span>-function on the
nose. This is useful for many of the applications that the speaker makes
of these kinds of functions. In some settings it’s still much of an art
and there are lots of interesting questions.</p>
<p>Let’s turn to Rankin–Selberg convolutions. We’ll begin classically,
say with holomorphic modular eigenforms <span
class="math inline">\(f\)</span> and <span
class="math inline">\(g\)</span> of weights <span
class="math inline">\(k_f \geq k_g\)</span>, say of level <span
class="math inline">\(1\)</span>, i.e., on <span
class="math inline">\(\mathrm{SL}_2(\mathbb{Z})\)</span>. Write <span
class="math display">\[f = \sum a_n q^n, \qquad g = \sum b_n
q^n.\]</span> We’ll consider the Dirichlet series <span id="eq:cq6r32z05j" class="math display">\[\label{eq:cq6r32z05j}\tag{10}
  \sum_n \overline{a_n} b_n n^{- s}.\]</span> The integral
representation is <span id="eq:cq6r32zyac" class="math display">\[\label{eq:cq6r32zyac}\tag{11}
  \int_{\mathrm{SL}_2(\mathbb{Z}) \backslash \mathbb{H}}
\overline{f(\tau)} g(\tau)
  E_k(\tau, s)
  y^{k_f}
  \, d \mathop{\mathrm{vol}}(\tau),\]</span> where <span
class="math inline">\(k := k_f - k_g\)</span> and <span id="eq:cq6r320zyb" class="math display">\[\label{eq:cq6r320zyb}\tag{12}
  E_k(\tau, s)
  := \sum_{\gamma \in
    \begin{pmatrix}
      \ast      &amp; \ast \\
      0             &amp; \ast \\
    \end{pmatrix} \backslash \mathrm{SL}_2(\mathbb{Z})}
  j(\gamma, \tau)^{- k} \lvert y(\gamma(\tau)) \rvert^k.\]</span> The
way you get from <a href="#eq:cq6r32zyac" data-reference-type="eqref"
data-reference="eq:cq6r32zyac">\((11)\)</a> to <a
href="#eq:cq6r32z05j" data-reference-type="eqref"
data-reference="eq:cq6r32z05j">\((10)\)</a> is to unfold the sum
in <a href="#eq:cq6r320zyb" data-reference-type="eqref"
data-reference="eq:cq6r320zyb">\((12)\)</a> with the integral in
<a href="#eq:cq6r32zyac" data-reference-type="eqref"
data-reference="eq:cq6r32zyac">\((11)\)</a>, which yields an
integral over <span class="math inline">\(\begin{pmatrix}
  \ast  &amp; \ast \\
  0     &amp; \ast \\
\end{pmatrix} \backslash \mathbb{H}\)</span>. This is a nice exercise if
you haven’t done it.</p>
<p>What does this have to do with multiplicity one? Maybe we try to set
this up a bit more automorphically. Let <span
class="math inline">\(\pi_1\)</span> and <span
class="math inline">\(\pi_2\)</span> be cuspidal automorphic
representations of <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A}_k)\)</span>. Let <span
class="math inline">\(\chi_1, \chi_2\)</span> be Hecke characters <span
class="math inline">\(\chi_i : k^\times \backslash \mathbb{A}_k^\times
\rightarrow \mathbb{C}\)</span> such that <span
class="math inline">\(\chi_1 \chi_2 =(\chi_{\pi_1}
\chi_{\pi_2})^{-1}\)</span>. Let <span class="math inline">\(I_s(\chi_1,
\chi_2)\)</span> denote the space of functions <span
class="math inline">\(f : \mathrm{GL}_2(\mathbb{A}) \rightarrow
\mathbb{C}\)</span> that are smooth (meaning the usual thing at
archimedean places and “fixed by an open subgroup” at finite places) and
“<span class="math inline">\(K\)</span>-finite” and satisfying <span
class="math display">\[f_s \left(
    \begin{pmatrix}
      a &amp; b \\
      0 &amp; d \\
    \end{pmatrix} g \right) =
  \chi_1(a) \chi_2(d)
  \left\lvert \frac{a}{d} \right\rvert^{s + \frac{1}{2}}
  f_s(g).\]</span> We then define an Eisenstein series by averaging:
<span class="math display">\[E(f_s, g) := \sum_{\gamma \in B(\mathbb{Q})
\backslash \mathrm{GL}_2(\mathbb{Q})} f_s(\gamma g).\]</span> The
Rankin–Selberg integral is now just the integral <span
class="math display">\[\int_{[\mathrm{GL}_2]} \varphi_1(g) \varphi_2(g)
E(f_s, g) \, d g.\]</span> We can unfold this to obtain <span
class="math display">\[\int_{Z(\mathbb{A})B(\mathbb{Q}) \backslash
\mathrm{GL}_2(\mathbb{A})} \varphi_1(g) \varphi_2(g) f_s(g) \, d
g.\]</span> Let’s replace <span class="math inline">\(\varphi_i\)</span>
by its Whittaker expansion <span class="math display">\[\varphi_1(g) =
\sum_{a \in k^\times} W_{\psi} \left(
    \begin{pmatrix}
      a      &amp;  \\
             &amp; 1 \\
    \end{pmatrix} g \right).\]</span> Then, unfolding a bit further, we
arrive at <span class="math display">\[\int_{Z(\mathbb{A}) N(\mathbb{A})
\backslash \mathrm{GL}_2(\mathbb{A})} W_{\psi}(g) \varphi_2(g) f_s(g) \,
d g
  =
  \int_{Z(\mathbb{A}) N(\mathbb{A}) \backslash
\mathrm{GL}_2(\mathbb{A})}
  W_\psi(g) W_{\bar{\psi}} &#39;(g) f_s(g) \, d g,\]</span> where <span
class="math inline">\(W_{\psi}&#39;\)</span> is the Whittaker function
for <span class="math inline">\(\varphi_2\)</span> with respect to the
conjugate character. This last integrand is a product of local
functions, so the integral factors, assuming that all vectors in our
representations are pure tensors.</p>
<p>Where’s the multiplicity one? It’s hidden, because, just like in the
case of <span class="math inline">\(\mathrm{GL}_1\)</span> characters,
we have taken for one of our automorphic forms something particularly
special, namely an Eisenstein series. The picture that might be better
is, to give something slightly more complicated, there’s something
called the <strong>triple product integral</strong>. Now we’ll take
<span class="math inline">\(\varphi_i \in \pi_i\)</span> for <span
class="math inline">\(i = 1, 2, 3\)</span>, where it’ll be slightly
simpler to assume that at least one is cuspidal. Look at the function
<span class="math display">\[\int_{[Z \backslash \mathrm{GL}_2]}
  \varphi_1(g) \varphi_2(g) \varphi_3(g) \, d g.\]</span> This integral
defines a trilinear form on the product of the three representations
that is invariant by the diagonal action of <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A})\)</span>, or
equivalently, a <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A})\)</span>-invariant
functional <span class="math inline">\(\Lambda\)</span> on the tensor
product <span class="math inline">\(\pi_1 \otimes \pi_2 \otimes
\pi_3\)</span>, i.e, an element <span class="math display">\[\Lambda \in
{\mathop{\mathrm{Hom}}}_{\mathrm{GL}_2(\mathbb{A})}(\pi_1 \otimes \pi_2
\otimes \pi_3, \mathbb{C}).\]</span> This space is one-dimensional, as
are its local avatars: <span class="math display">\[\dim
{\mathop{\mathrm{Hom}}}_{\mathrm{GL}_2(k_v)}(\pi_{1, v} \otimes \pi_{2, v}
\otimes \pi_{3, v}) \leq 1.\]</span> We can thus factor <span
class="math inline">\(\Lambda = \prod \Lambda_v\)</span>, where each
<span class="math inline">\(\Lambda_v \in
{\mathop{\mathrm{Hom}}}_{\mathrm{GL}_2(k_v)}(\pi_{1, v} \otimes \pi_{2, v}
\otimes \pi_{3, v})\)</span>. Suppose <span
class="math inline">\(v\)</span> is a place for which <span
class="math inline">\(\pi_{i, v}\)</span> is unramified for each <span
class="math inline">\(i\)</span>. Then we can take <span
class="math display">\[\Lambda_v =
  \int_{Z N(k_v) \backslash \mathrm{GL}_2(k_v)}
  W_{\psi_v} W_{\overline{\psi_v}}(g) f_v(g) \, d g.\]</span> Here,
locally, we’re realizing the unramified representation <span
class="math inline">\(\pi_{3, v}\)</span> as an induced representation
<span class="math inline">\(\pi_{3, v} = \pi_v(\chi_{1, v}, \chi_{2,
v})\)</span>. We didn’t unfold to this computation; this was all
local.</p>
<p>There’s one more example we’d like to emphasize: <em>toric
integrals</em>. Let <span class="math inline">\(K /k\)</span> be a
quadratic extension. We can then think of <span
class="math inline">\(K\)</span> as a two-dimensional <span
class="math inline">\(k\)</span>-space, which gives a way to identify
<span class="math display">\[{\mathrm{GL}_2}{/ k} \cong
{\mathop{\mathrm{Aut}}}_k(K) \hookleftarrow K^\times.\]</span> We might
for simplicity that <span class="math inline">\(\pi\)</span> is a
cuspidal automorphic representation of <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A}_k)\)</span>, and let
<span class="math inline">\(\varphi \in \pi\)</span> be a cusp form. Let
<span class="math inline">\(\chi : K^\times \backslash
\mathbb{A}_{K}^\times \rightarrow \mathbb{C}^\times\)</span> be a Hecke
character for our extension. Let’s assume that <span
class="math inline">\(\chi \mid_{\mathbb{A}_k^\times} =
\chi_\pi^{-1}\)</span>, i.e., the restriction is the inverse of the
central character. We are then going to think of the integral <span
class="math display">\[\int_{\mathbb{A}_k^\times K^\times \backslash
\mathbb{A}_K^\times} \varphi(t) \chi(t) \,d^\times t\]</span> as
defining an element of the space <span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathbb{A}_k^\times}(\pi,
\mathbb{C}(\chi^{-1}))\)</span>, which has dimensional <span
class="math inline">\(\leq 1\)</span>. Such integrals will thus factor
as prodcuts of local linear functionals.</p>
<p>Some of these can be computed quickly in terms of integrals we
already know. Suppose <span class="math inline">\(\pi_v\)</span> is
unramified and <span class="math inline">\(v\)</span> splits in <span
class="math inline">\(K /k\)</span>. Then <span
class="math display">\[K_v^\times = k_v^\times \times k_v^\times \cong
\left\{
    \begin{pmatrix}
      a      &amp;  \\
                                                                              &amp;
b \\
    \end{pmatrix} \right\} \subseteq \mathrm{GL}_2(k).\]</span> We may
thus identify <span class="math inline">\(\chi_v\)</span> with a pair of
characters <span class="math inline">\((\chi_{1, v}, \chi_{2,
v})\)</span>. We can define the local functional <span
class="math display">\[\int_{k_v^\times} W_\psi
  \begin{pmatrix}
    t    &amp;  \\
                                                                      &amp;
1 \\
  \end{pmatrix} \chi_{1, v}(t) \,d^\times t,\]</span> which defines an
element of <span
class="math inline">\({\mathop{\mathrm{Hom}}}_{K_v^\times}(\pi_v,
\mathbb{C}(\chi_v^{-1}))\)</span>. For unramified data, this evaluates
to <span class="math inline">\(L(\pi_v, \chi_{1, v})\)</span>. It turns
out that (Waldspurger’s formula) <span
class="math display">\[\left\lvert \int \varphi(t) \chi(t) \,d^\times y
\right\rvert^2 \sim L(\mathrm{B C}_{K/k}(\pi) \otimes \chi,
\tfrac{1}{2}).\]</span> There’s a similar relation in the triple product
case, which we can guess using the Rankin–Selberg unfolding that we saw
earlier.</p>
<div class="remark">
<p><strong>Remark 39</strong>. This doesn’t make sense for general
arguments other than <span class="math inline">\(s =
\tfrac{1}{2}\)</span>, except in some form when <span
class="math inline">\(\varphi\)</span> is an Eisenstein series (“formula
of Damerell”). One needs to be able to vary <span
class="math inline">\(\varphi\)</span> (or <span
class="math inline">\(\chi\)</span>) in a family, preserving the central
character compatibility condition.</p>
</div>
<p>All of these examples are special cases of the Gan–Gross–Prasad
conjectures, which we’ll hear more about later in the week.</p>
<p>We’ll now begin by giving one example of an Euler system. Tomorrow,
we’ll explore this in greater generality and more detail. The simplest
case is that of cyclotomic units. Let <span
class="math inline">\(F\)</span> be a number field or a local field.
Kummer theory gives an isomorphism <span class="math display">\[F^\times
/ F^{\times N} \rightarrow H^1(F, \mu_N),\]</span> as follows. Let <span
class="math inline">\(\alpha \in F^\times\)</span>. Choose an <span
class="math inline">\(n\)</span>th root <span
class="math inline">\(\alpha^{1/N}\)</span>. The ambiguity in this
choice is an element of <span class="math inline">\(\mu_N\)</span>,
i.e., an <span class="math inline">\(n\)</span>th root of unity. For any
<span class="math inline">\(\sigma \in G_F\)</span>, we can look at
<span class="math inline">\(\sigma(\alpha^{1/N}) /
\alpha^{1/N}\)</span>. Since the numerator and denominator are both
<span class="math inline">\(N\)</span>th roots of <span
class="math inline">\(1\)</span>, the ratio must lie in <span
class="math inline">\(\mu_N\)</span>. This gives us a way of
constructing elements of <span class="math inline">\(H^1\)</span> very
concretely. The classes we obtain are unramified away from <span
class="math inline">\(N \alpha\)</span>.</p>
<p>Let’s now restrict ourselves to the field <span
class="math inline">\(\mathbb{Q}[\mu_N]\)</span>. Restrict the above map
to the unit group of that field: <span
class="math display">\[\mathcal{O}_{\mathbb{Q}[\mu_N]}^\times
\rightarrow H^1(\mathbb{Q}(\mu_N), \mu_{p^n}).\]</span> Taking inverse
limits, we obtain, with <span class="math inline">\(\mathbb{Z}_p(1) =
\varprojlim\mu_{p^n}\)</span> (where the Galois group acts via the
cyclotomic character), a map <span
class="math display">\[\mathcal{O}_{\mathbb{Q}[\mu_N]}^\times \otimes
\mathbb{Z}_p \rightarrow H^1(\mathbb{Q}(\mu_N),
\mathbb{Z}_p(1)).\]</span> Thus, for any <span class="math inline">\((a,
N) = 1\)</span>, we get , say with <span class="math inline">\(\zeta_N =
e^{2 \pi i / N}\)</span>, <span class="math display">\[\frac{\zeta_N^a -
1}{\zeta_N - 1} \mapsto z_N,\]</span> say. If we look at the
corestriction <span
class="math display">\[\operatorname{cores}_{\mathbb{Q}[\mu_{N \ell}] /
\mathbb{Q}[\mu_N]}(z_{N \ell}) =
  \begin{cases}
    z_N    
    &amp; \text{ if } \ell \mid N \\
    (1 - \mathrm{Fr}_{\ell}^{-1}) z_N
                                                                                     &amp;
\text{ if } \ell \nmid N.
  \end{cases}\]</span> We look at <span class="math display">\[\det
\left( 1 - \mathrm{Fr}_{\ell}^{-1} X \mid \mathbb{Z}_p(1)^\ast \right)
\mid X = \mathrm{Fr}_{\ell}^{-1}.\]</span></p>
<p>Some idea for checking this: <span class="math inline">\((\mathbb{Z}
/ \ell \mathbb{Z})^\times \subset(\mathbb{Z} / \ell N \mathbb{Z})^\times
\cong \mathop{\mathrm{Gal}}(\mathbb{Q}(\mu_{N \ell}) / \mathbb{Q}
)\)</span>, where the last map sends <span class="math inline">\(a
\mapsto \sigma_\alpha(\zeta_{N \ell}) = \zeta_{N \ell}^a\)</span>.</p>
<div class="remark">
<p><strong>Remark 40</strong>. Given <span
class="math inline">\(f\)</span> a holomorphic modular form, say of
weight <span class="math inline">\(2\)</span>, we have <span
class="math inline">\(\omega_f = f(\tau) \, d \tau \in H^0(X,
\Omega_X^1) \subseteq H^1(X, \mathbb{C})\)</span>. Then <span
class="math inline">\(\lVert f \rVert^2 = \int_X\omega_f \wedge
\overline{\omega_f}\)</span>.</p>
<p>Similarly, for <span class="math inline">\(X \hookrightarrow X \times
X \times X\)</span>, we get some particular values of the Rankin–Selberg
convolution by looking at <span class="math inline">\(\int_X
\overline{\omega_f} \wedge \omega_g \wedge \omega_{E_k}\)</span>. Then
from the rational structure on cohomology, one can get something like
rational structure on the <span
class="math inline">\(L\)</span>-values.</p>
</div>
<div class="remark">
<p><strong>Remark 41</strong>. Let’s talk about the corestriction map in
this setting. Abstractly, it’s a map <span
class="math display">\[H^1(\mathbb{Q}[\mu_{N \ell}], \mathbb{Z}_p(1))
\rightarrow H^1(\mathbb{Q}[\mu_N], \mathbb{Z}_p(1)).\]</span> How are we
going to understand this? We could of course write it down at the level
of cocycles, or something. But what’s it’s really doing is that if we
restrict back, i.e., compose with the restriction map <span id="eq:cq6r4knx6r" class="math display">\[\label{eq:cq6r4knx6r}\tag{13}
    H^1(\mathbb{Q}[\mu_N], \mathbb{Z}_p(1)) \rightarrow
H^1(\mathbb{Q}[\mu_{N \ell}], \mathbb{Z}_p(1)),\]</span> then the
composition is just the trace map, given by <span
class="math display">\[\sum_{\sigma \in
\mathop{\mathrm{Gal}}(\mathbb{Q}[\mu_{N \ell}] / \mathbb{Q}[\mu_N])}
\sigma.\]</span> The restriction map <a href="#eq:cq6r4knx6r"
data-reference-type="eqref"
data-reference="eq:cq6r4knx6r">\((13)\)</a> is actually an
injection because there are no Galois invariants of <span
class="math inline">\(\mathbb{Z}_p(1)\)</span>.</p>
<p>Also, we have the Kummer map <span
class="math display">\[\mathbb{Q}[\mu_{N \ell}]^\times
\xrightarrow{\mathrm{Kummer}} H^1(\mathbb{Q}[\mu_{N \ell}],
\mathbb{Z}_p(1)).\]</span> And this construction is Galois-invariant. We
have the trace map <span class="math inline">\(\alpha \mapsto
\prod_\sigma \sigma(\alpha)\)</span> from <span
class="math inline">\(\mathbb{Q}[\mu_{N \ell}]^\times \rightarrow
\mathbb{Q}[\mu_N]^\times\)</span>. We claim that this induces the
corestriction map via the Kummer map. This remains the case when we
tensor with <span class="math inline">\(\mathbb{Z}_p\)</span>.</p>
<p>So when we’re dealing with corestriction, what we really want to
understand is what is the norm of the particular <span
class="math inline">\(\alpha\)</span> that we’re working with.</p>
<p>All of this is fairly formal applied to a specific setting. The
Kummer map is also a connecting map in a long exact sequence of Galois
cohomology, associated to <span class="math display">\[0 \rightarrow
\mu_{p^n} \rightarrow \bar{F}^\times \xrightarrow{\alpha \mapsto
\alpha^{p^n}} \bar{F}^\times \rightarrow 0.\]</span> From the formal
stuff, we have an arithmetic question. We take <span
class="math display">\[\alpha = \frac{\zeta_{N \ell}^a - 1}{\zeta_{N
\ell} - 1},\]</span> and we want to know, what is the norm of this
element? Look at <span
class="math display">\[\operatorname{norm}_{\mathbb{Q}(\mu_{N \ell}) /
\mathbb{Q}(\mu_N)}(\alpha).\]</span> We have <span
class="math display">\[\mathop{\mathrm{Gal}}(\mathbb{Q}(\mu_{N \ell}) /
\mathbb{Q}(\mu_N))
    \subseteq \mathop{\mathrm{Gal}}(\mathbb{Q}(\mu_{N \ell}) /
\mathbb{Q})
    \cong(\mathbb{Z} / N \ell)^\times,\]</span> The subgroup here will
be identified with congruence classes <span
class="math inline">\(b\)</span> satisfying <span
class="math inline">\(b \equiv 1 \pmod{N}\)</span>. The last isomorphism
is given by <span class="math inline">\(\sigma_c \mapsto c\)</span>,
where <span class="math inline">\(\sigma_c(\zeta_{N \ell}) = \zeta_{N
\ell}^c\)</span>. Now, suppose for instance that <span
class="math inline">\(\ell \nmid N\)</span>. Then <span
class="math inline">\(\zeta_{N \ell}^{b \ell} = \zeta_N^b =
\zeta_N\)</span>. As <span class="math inline">\(b \in(\mathbb{Z} / N
\ell )^\times\)</span> runs over <span class="math inline">\(\ell -
1\)</span> residue classes modulo <span class="math inline">\(\equiv 1
\pmod{N}\)</span>, then <span class="math inline">\(\zeta_{N
\ell}^b\)</span> runs over <span class="math inline">\(\ell\)</span>th
roots of <span class="math inline">\(\zeta_N\)</span>, but excluding
<span class="math inline">\(\zeta_N^{\ell^{-1}}\)</span>. A short
calculation then gives the claim corestriction formula. In the other
case where <span class="math inline">\(\ell \mid N\)</span>, <span
class="math inline">\(b\)</span> runs over <span
class="math inline">\(\ell\)</span> classes, and we get the other
answer.</p>
</div>
<p>We’re going to continue our discussion of Euler systems. We turn to
the example given by Heegner points. Let <span class="math inline">\(K /
\mathbb{Q}\)</span> be an imaginary quadratic field, with ring of
integers <span class="math inline">\(\mathcal{O}_K\)</span>. Let <span
class="math inline">\(N\)</span> be a positive integer such that all
primes <span class="math inline">\(\ell \mid N\)</span> split in <span
class="math inline">\(K /\mathbb{Q}\)</span>. We take <span
class="math display">\[X_0(N) = \Gamma_0(N) \backslash[\mathfrak{h}
\sqcup \mathbb{P}^1(\mathbb{Q})],\]</span> and write <span
class="math inline">\(\tau \in \mathfrak{h}\)</span>. This classifies
elliptic curves together with an isogeny of order <span
class="math inline">\(N\)</span>, e.g., <span class="math display">\[E
:= \mathbb{C} / \mathbb{Z} \oplus \mathbb{Z} \tau \rightarrow E&#39;
:=  \mathbb{C} / \tfrac{1}{N}(\mathbb{Z} + N \tau \mathbb{Z}) \cong
\mathbb{C} / \mathbb{Z} + N \tau \mathbb{Z},\]</span> whose kernel is
<span class="math inline">\(\tfrac{1}{N} \mathbb{Z} /
\mathbb{Z}\)</span>.</p>
<p>We’re going to produce some points on <span
class="math inline">\(X_0(N)\)</span>. Let <span
class="math inline">\(c\)</span> be positive integer. We can have an
order <span class="math display">\[\mathcal{O}_c := \mathbb{Z} + c
\mathcal{O}_K \subseteq \mathcal{O}_K.\]</span> This gives us a lattice
inside the complex numbers (having chosen a complex embedding of <span
class="math inline">\(K\)</span>). We can then form the quotient <span
class="math inline">\(\mathbb{C} / \mathcal{O}_c\)</span>. To produce a
lattice that is slightly larger, we will use that each <span
class="math inline">\(\ell \mid N\)</span> splits to <em>choose</em> an
ideal <span class="math inline">\(\mathfrak{n} \subseteq
\mathcal{O}_K\)</span> such that <span
class="math inline">\(\mathcal{O}_K / \mathfrak{n} \cong \mathbb{Z} / N
\mathbb{Z}\)</span>. We then obtain an isogeny of elliptic curves <span
class="math display">\[\left[ \mathbb{C} / \mathcal{O}_c \rightarrow
\mathbb{C} / \mathfrak{n}^{-1} \mathcal{O}_c \right] \in
X_0(N)(K[c]),\]</span> where <span class="math inline">\(K[c]\)</span>
denotes the <em>ring class field</em> of <span
class="math inline">\(K\)</span> of conductor <span
class="math inline">\(c\)</span>. To explain what this means, we
introduce some notation. For a module <span
class="math inline">\(M\)</span>, write <span
class="math inline">\(\hat{M} := M \otimes \hat{\mathbb{Z}}\)</span>,
where <span class="math inline">\(\hat{\mathbb{Z}} = \prod_{\ell}
\mathbb{Z}_{\ell}\)</span>. (For instance, if <span
class="math inline">\(M\)</span> is a <span
class="math inline">\(\mathbb{Q}\)</span>-module, then we may also write
<span class="math inline">\(\hat{M}\)</span> as <span
class="math inline">\(M \otimes_{\mathbb{Q}} \mathbb{A}_f\)</span>.)
Class field theory tells us that <span
class="math display">\[\mathop{\mathrm{Pic}}(\mathcal{O}_c) = K^\times
\backslash \hat{K}^\times / \hat{\mathcal{O}}_c^\times
\xrightarrow{\mathrm{rec}} \mathop{\mathrm{Gal}}(K[c] / K),\]</span>
<span class="math display">\[\mapsto \sigma_{\mathfrak{b}}.\]</span>
More generally, for any fractional ideal <span
class="math inline">\(\mathfrak{a}\)</span> of <span
class="math inline">\(\mathcal{O}_c\)</span>, we get a point <span
class="math display">\[x_{c}(\mathfrak{a}) := \left[ \mathbb{C} /
\mathfrak{a} \rightarrow \mathbb{C} / \mathfrak{n}^{-1} \mathfrak{a}
\right] \in X_0(N)(K[c]).\]</span> The action of <span
class="math inline">\(\mathop{\mathrm{Gal}}(K[c] / K)\)</span> on <span
class="math inline">\(X_0(N)(K[c])\)</span> on these points is described
by the relation <span id="eq:cq6sjz7g2n" class="math display">\[\label{eq:cq6sjz7g2n}\tag{14}
  \sigma_{\mathfrak{b}} x_c(\mathfrak{a}) = x_c(\mathfrak{b}^{-1}
\mathfrak{a}).\]</span> This is the content of CM theory.</p>
<p>Now we’re going to look at the divisors <span
class="math display">\[y_c(\mathfrak{a}) := x_c(\mathfrak{a}) -
\infty\]</span> obtained by subtracting off the cusp at infinity, which
is defined over <span class="math inline">\(\mathbb{Q}\)</span>. This
difference defines an element of the Jacobian <span
class="math inline">\(J_0(N) := \mathop{\mathrm{Jac}}(X_0(N))\)</span>,
defined over <span class="math inline">\(K[c]\)</span>. The Jacobian is
an abelian variety. For abelian varieties, there is a construction very
similar to Kummer theory that gives us an analogue of the Kummer map
defined yesterday, <span class="math display">\[J_0(N)(K[c]) \rightarrow
H^1(K[c], J_0(N)[p^m]),\]</span> where <span
class="math inline">\(J_0(N)[p^m]\)</span> is the <span
class="math inline">\(p^m\)</span>-torsion subgroup of the Jacobian. The
map is defined as follows. Given <span class="math inline">\(y \in
J_0(N)(K[c])\)</span>, let us choose <span class="math inline">\(y
&#39;\)</span> so that <span class="math inline">\(p^m y&#39; =
y\)</span>. We send this to the class of the cocycle <span
class="math inline">\(\sigma \mapsto \sigma(y&#39;) - y&#39;\)</span>.
Applying this map to <span
class="math inline">\(y_c(\mathfrak{a})\)</span> gives us a cohomology
class <span class="math display">\[z_c(\mathfrak{a}) \in H^1(K[c],
J_0(N)[p^m]).\]</span> In the special case where <span
class="math inline">\(\mathfrak{a} = \mathcal{O}_c\)</span>, we drop it
from the notation and write simply <span
class="math inline">\(z_c\)</span>.</p>
<p>Suppose now that <span class="math inline">\(\ell \nmid c D_K
N\)</span>. Then we’re going to look at what happens when we take the
point <span class="math inline">\(z_{c \ell}\)</span> (attached as above
to the order <span class="math inline">\(\mathcal{O}_{c \ell}\)</span>)
and form the norm <span class="math display">\[\sum_{\sigma \in
\mathop{\mathrm{Gal}}(K[c \ell] / K[c])} \sigma z_{c \ell}.\]</span> We
can write this as the sum <span
class="math display">\[\sum_{\mathfrak{b} \in
\ker(\mathop{\mathrm{Pic}}\mathcal{O}_{c \ell} \rightarrow
\mathop{\mathrm{Pic}}\mathcal{O}_c)} \sigma_{\mathfrak{b}} z_{c
\ell}.\]</span> We can in turn rewrite <span
class="math inline">\(\sigma_{\mathfrak{b}} z_{c \ell}\)</span> as <span
class="math inline">\(\sum_{\mathfrak{b}} y_{c \ell}(\mathfrak{b}^{-1})
- \infty\)</span>, summing over the same <span
class="math inline">\(\mathfrak{b}\)</span> as before. Now, how many
<span class="math inline">\(\mathfrak{b}\)</span>’s are there, and what
is this sum?</p>
<p>Suppose that <span class="math inline">\(\ell\)</span> is inert in
<span class="math inline">\(K\)</span>. Comparing what happens with
<span class="math inline">\(c\)</span> and <span class="math inline">\(c
\ell\)</span>, we get <span class="math display">\[\frac{(\mathcal{O}_K
\otimes \mathbb{Z}_{\ell})^\times}{((\mathbb{Z} + \ell \mathcal{O}_K)
\otimes \mathbb{Z}_{\ell})^\times},\]</span> which is cyclic of order
<span class="math inline">\(\ell + 1\)</span>. Now, <span
class="math inline">\(\mathfrak{b}\)</span> lying in the kernel of the
above map means that <span class="math inline">\(\mathfrak{b}
\mathcal{O}_c\)</span> is a principal ideal, say <span
class="math inline">\(\beta \mathcal{O}_c\)</span> with <span
class="math inline">\(\beta \in K^\times\)</span>. If we look at <span
class="math inline">\(\beta \mathfrak{b}^{-1} \mathcal{O}_c\)</span>,
then we see that inside <span
class="math inline">\(\mathcal{O}_c\)</span>, it has index <span
class="math inline">\(\ell\)</span>. As <span
class="math inline">\(\mathfrak{b}\)</span> varies, this exhausts all
lattices of index <span class="math inline">\(\ell\)</span>. By
definition of the Hecke operator <span
class="math inline">\(T_{\ell}\)</span>, we see that <span
class="math display">\[\sum_{\mathfrak{b}} \left( y_{c
\ell}(\mathfrak{b}^{-1}) - \infty \right) = T_{\ell}(y_c -
\infty).\]</span> Under the Kummer map, this tells us that <span
class="math display">\[\operatorname{cor}_{K[c \ell] / K[c]} z_{c \ell}
  = T_{\ell} z_c.\]</span></p>
<p>Kolyvagin used these relations as follows. <span
class="math display">\[y_K = {\mathop{\mathrm{trace}}}_{K[1] / K} y_1 \in
J_0(N)(K) \xrightarrow{\phi_E} E(K),\]</span> where <span
class="math inline">\(E\)</span> is an elliptic curve of conductor <span
class="math inline">\(N\)</span> with a modular parametrization <span
class="math inline">\(\phi_N : X_0(N) \rightarrow E\)</span> sending
<span class="math inline">\(\infty\)</span> to <span
class="math inline">\(0\)</span>. Using relations, Kolyvagin could show
that if the point is not torsion, then the rank of the elliptic curve is
<span class="math inline">\(1\)</span>. Around the same time,
Gross–Zagier showed that the Néron–Tate height of this point is nonzero
if and only if <span class="math inline">\(L\)</span>-function for <span
class="math inline">\(E/K\)</span> vanishes exactly to order one. This
gave some of the first theoretical evidence for the Birch and
Swinnerton-Dyer conjecture. This was a spectacular application by
Kolyvagin that got people interested in Euler systems.</p>
<p>You can also run Kolyvagin’s argument in another way. You can look at
the primes <span class="math inline">\(\ell\)</span> that are
<em>split</em> in <span class="math inline">\(K\)</span>, say <span
class="math inline">\(\ell = \lambda \bar{\lambda}\)</span>. Then <span
class="math display">\[\frac{(\mathcal{O}_K \otimes
\mathbb{Z}_{\ell})^\times}{((\mathbb{Z} + \ell \mathcal{O}_K) \otimes
\mathbb{Z}_{\ell})^\times}
  =
  \frac{\mathcal{O}_\lambda^\times \times
\mathcal{O}_{\bar{\lambda}}^\times}{\{(a, b) : a \equiv
b(\ell)\}},\]</span> where the numerator is really <span
class="math inline">\(\mathbb{Z}_{\ell}^\times \times
\mathbb{Z}_{\ell}^\times\)</span>. Arguing as above, we’re no longer
summing over all the lattices, but instead we miss two of them: <span
class="math inline">\(\lambda \mathcal{O}_c\)</span> and <span
class="math inline">\(\bar{\lambda} \mathcal{O}_c\)</span>. One obtains
<span class="math display">\[\sum_{\mathfrak{b}} (y_{c
\ell}(\mathfrak{b}^{-1}) - \infty )
  =
  T_{\ell}(y_c - \infty)
  - (\mathrm{Fr}_\lambda^{-1} + \mathrm{Fr}_{\bar{\lambda}}^{-1})(y_c -
\infty).\]</span> (The inverses come from <a href="#eq:cq6sjz7g2n"
data-reference-type="eqref"
data-reference="eq:cq6sjz7g2n">\((14)\)</a>.)</p>
<p>Work of the speaker and Jetchev and Wan used the split primes to do
something like what Kolyvagin did.</p>
<p>Let <span class="math inline">\(\mathfrak{c} = \lambda_1 \dotsb
\lambda_r\)</span> be a squarefree product of ideals <span
class="math inline">\(\lambda_i \nmid N D_K\)</span> of degree <span
class="math inline">\(1\)</span> in <span
class="math inline">\(K\)</span>, with <span
class="math inline">\(\lambda_i =\overline{\lambda_i}\)</span>. Let
<span class="math inline">\(c\)</span> be the integer such that <span
class="math inline">\((c) = \mathfrak{c} \cap \mathbb{Z}\)</span>. Let
<span class="math inline">\(z(\mathfrak{c})\)</span> be basically the
class that we were just analyzing, but let’s modify it slightly: <span id="eq:cq6sj3hg5b" class="math display">\[\label{eq:cq6sj3hg5b}\tag{15}
  z(\mathfrak{c}) := \prod_{i = 1}^r \left( - \mathrm{Fr}_{\lambda_i}
\right) z_c \in H^1(K[c], T_p J_0(N)),\]</span> where <span
class="math inline">\(T_p J_0(N) = \varprojlim J_0(N)[p^m]\)</span>. We
obtain now, for <span class="math inline">\(\lambda \mid
\ell\)</span>,</p>
<p><span id="eq:cq6sj0iiz3" class="math display">\[\label{eq:cq6sj0iiz3}\tag{16}
  \operatorname{cores}_{K[c \ell] / K[c]} z(\mathfrak{c} \lambda) =
\left( \mathrm{Fr}_\lambda^{- 2} - T_{\ell} \mathrm{Fr}_\lambda^{-1} + 1
\right) z(\mathfrak{c}).\]</span> Let’s think about this last expression
in terms of the Hecke polynomial <span class="math inline">\(X^2 -
T_{\ell} X + \ell\)</span>. You can see that if we evaluate this at
<span class="math inline">\(\lambda^{-1}\)</span>, we almost get the
quantity appearing on the right hand side of <a href="#eq:cq6sj0iiz3"
data-reference-type="eqref"
data-reference="eq:cq6sj0iiz3">\((16)\)</a>: <span
class="math display">\[(X^2 - T_{\ell} X + \ell) \mid_{X =
\mathrm{Fr}_\lambda^{-1}}.\]</span> They are congruent modulo <span
class="math inline">\(\ell - 1\)</span>, which is <span
class="math inline">\(N(\lambda) - 1\)</span>. When working with Euler
systems, it’s acceptable to work with congruences modulo <span
class="math inline">\(\ell - 1\)</span>. There’s a general way to
massage those classes so that they give the relations on the nose, but
there’s no need to do so. Later, we’ll pose a question that will suggest
that this comparison is a feature of some integral representation
theory, once we see where these norm relations come from in those terms.
In any event, once you have these relations, you can take these objects
and run Kolyvagin’s argument and reprove Kolyvagin’s theorem.</p>
<p>We next want to explain how to set up the construction of the
Kolyvagin system in such a way that some representation theory naturally
shows up, with this Galois relation <a href="#eq:cq6sj0iiz3"
data-reference-type="eqref"
data-reference="eq:cq6sj0iiz3">\((16)\)</a> showing up as
something like a Hecke module, which in turn is closely related to
representation theory. The argument we’re going to give generalizes
quite significantly, for instance, it produces an Euler system in the
sense of these split primes for the diagonal cycles coming from the
arithmetic Gan–Gross–Prasad settings, and one can generalize Kolyvagin’s
statement to a rank one statement about Selmer groups for certain
Rankin–Selberg convolutions of <span class="math inline">\(\mathrm{GL}_n
\times\mathrm{GL}_{n + 1}\)</span>. With Euler systems, we’re trying to
bound the orders of Selmer groups of elliptic curves, something like
<span class="math inline">\(H^1_f(\mathbb{Q}, E[p^N])\)</span>, where
the subscript <span class="math inline">\(f\)</span> denotes some sort
of Block–Kato condition coming from the geometry of the elliptic curve.
One way to bound a Selmer group like this is to use global duality to
give classes in the arithmetic dual, i.e., <span
class="math inline">\(H_f^1(\mathbb{Q}, E[p^N]^\ast )\)</span>, where
<span id="eq:cq6sj3fh1h" class="math display">\[\label{eq:cq6sj3fh1h}\tag{17}
  E[p^N]^\ast = \mathop{\mathrm{Hom}}(E[p^N], \mathbb{Q}_p /
\mathbb{Z}_p(1)).\]</span> Here one wants to allow ramification at good
primes <span class="math inline">\(\ell\)</span>, chosen to capture the
orders of classes that we want to control. One can then reduce to
looking at <span id="eq:cq6sj3eqsx" class="math display">\[\label{eq:cq6sj3eqsx}\tag{18}
  H^1_{\mathrm{ur}}(\mathbb{Q}_{\ell}, E[p^N]).\]</span> The local
duality relates this to <span class="math inline">\(H^1(I_{\ell},
E[p^N]^\ast)^{G_{\mathbb{Q}_{\ell}}}\)</span>. So if we can produce a
class in the latter that is highly ramified (of large order), then we
can force the class in <a href="#eq:cq6sj3eqsx"
data-reference-type="eqref"
data-reference="eq:cq6sj3eqsx">\((18)\)</a> to have small order.
That, in a nutshell, is how Selmer groups are bounded. The whole trick
is to produce ramified classes in <a href="#eq:cq6sj3fh1h"
data-reference-type="eqref"
data-reference="eq:cq6sj3fh1h">\((17)\)</a> that you can measure
the size of in some way. Now, producing things that are provably
ramified is a hard problem. There are few cases where we can do this.
It’s much easier to check that something is unramified (think of the
criterion of Néron–Ogg–Shafarevich or something like that). What
Kolyvagin’s argument does is, he says well, let’s start off with classes
<a href="#eq:cq6sj3hg5b" data-reference-type="eqref"
data-reference="eq:cq6sj3hg5b">\((15)\)</a> that are over
ramified extensions. If they are truly over that ramified extension and
not, say, defined over some extension with less ramification, then
Kolyvagin can use that to produce ramified classes, and it is exactly
these relations <a href="#eq:cq6sj0iiz3" data-reference-type="eqref"
data-reference="eq:cq6sj0iiz3">\((16)\)</a> that allow him to
understand how ramified these classes actually are. These norm relations
are thus crucial for producing ramified classes with controlled or
measurable ramification. That’s sort of the algebra background for why
one is interested in Euler systems.</p>
<p>We’ll now describe a more representation-theoretic picture that
produces these Kolyvagin classes. Recall the situation. We have the
modular curve <span class="math inline">\(X_0(N)\)</span> and the
Heegner point <span class="math inline">\(x_c \in X_0(N)(K[c])\)</span>,
corresponding to an isogeny <span class="math inline">\([\mathbb{C} /
\mathcal{O}_c \rightarrow \mathbb{C} / \mathfrak{n}
\mathcal{O}_c]\)</span>. The modular curve is a curve defined over <span
class="math inline">\(\mathbb{Q}\)</span>, so we can think of this point
as defining a map <span
class="math display">\[\mathop{\mathrm{Spec}}K[c] \rightarrow
X_0(N).\]</span> We can base our curve to a curve over <span
class="math inline">\(K[c]\)</span>, yielding the following map of
varieties over <span class="math inline">\(K [c]\)</span>: <span
class="math display">\[\mathop{\mathrm{Spec}}K[c] \xrightarrow{x_c}
X_0(N) \times \mathop{\mathrm{Spec}}K[c].\]</span> The left hand side
has dimension <span class="math inline">\(0\)</span>, while the right
hand side has dimension <span class="math inline">\(1\)</span>. There is
thus a cycle class map <span
class="math display">\[H^0(\mathop{\mathrm{Spec}}K[c])
  \xrightarrow{\mathrm{cyc}}
  H^{2}(X_0(N) / \mathop{\mathrm{Spec}}K[c], \mathbb{Z}_p(1)).\]</span>
(In general, the exponent is <span class="math inline">\(2 d\)</span>,
where <span class="math inline">\(d\)</span> is the codimension.)</p>
<p>This is a single point. What we did before was to take the difference
between two points, <span id="eq:cq6s0hup34" class="math display">\[\label{eq:cq6s0hup34}\tag{19}
  \operatorname{cyc}(x_c) - \operatorname{cyc}(\infty) \in
  H^2(X_0(N) \times \mathop{\mathrm{Spec}}K[c],
\mathbb{Z}_p(1))_0,\]</span> but it’s now homologically trivial in the
sense that if we pass to the algebraic closure, i.e., we consider the
degree map <span class="math display">\[H^2(X_0(N) \times
\mathop{\mathrm{Spec}}K[c], \mathbb{Z}_p(1))_0
  \xrightarrow{\deg}
  H^2(X_0(N) \times \mathop{\mathrm{Spec}}\bar{K}[c], \mathbb{Z}_p(1))_0
  \cong \mathbb{Z}_p\]</span> which the difference <a
href="#eq:cq6s0hup34" data-reference-type="eqref"
data-reference="eq:cq6s0hup34">\((19)\)</a> lies in the kernel
of, then we obtain the element <span class="math display">\[y_c \in
  H^1(K[c], H^1(X_0(N) / \bar{K}, \mathbb{Z}_p(1)))
  =H^1(K[c], T_p J_0(N)).\]</span></p>
<p>Now, we don’t want to keep tracking the field of definition, so let’s
think of <span class="math inline">\(x_c\)</span> as a map over <span
class="math inline">\(K\)</span>. Starting with <span
class="math display">\[\mathop{\mathrm{Spec}}K[c](\bar{K})
  = \left\{ \sigma : K[c] \hookrightarrow \bar{K} \right\} \simeq
\mathop{\mathrm{Gal}}(K[c] / K)
  = K^\times \backslash \hat{K}^\times /
\hat{\mathcal{O}}_c^\times,\]</span> we can think of <span
class="math display">\[H^0(K^\times \backslash \hat{K}^\times /
\hat{\mathcal{O}}_c^\times)
  \xrightarrow{\mathrm{cyc}}
  H^2(X_0(N) \times K^\times \backslash \hat{K}^\times /
\hat{\mathcal{O}}_c^\times,
  \mathbb{Z}_p(1)).\]</span> There is an action of <span
class="math inline">\(\mathop{\mathrm{Gal}}(K[c] / K)\)</span> on <span
class="math inline">\(X_0(N) \times K^\times \backslash \hat{K}^\times /
\hat{\mathcal{O}}_c^\times\)</span> that we may reinterpret as
multiplication by <span
class="math inline">\(\hat{K}^\times\)</span>.</p>
<p>Now, let’s take an embedding <span class="math inline">\(K
\hookrightarrow M_2(\mathbb{Q})\)</span> such that <span
class="math inline">\(\mathcal{O}_K = K \cap M_2(\mathbb{Z})\)</span>.
This induces <span class="math inline">\(K^\times \hookrightarrow
\mathrm{GL}_2(\mathbb{Q})\)</span>. We fix <span
class="math inline">\(\tau_0 \in \mathfrak{h}\)</span> such that <span
class="math inline">\({\mathop{\mathrm{Stab}}}_{\mathrm{GL}_2^+(\mathbb{Q})}(\tau)
= K^\times\)</span>. For a compact open subgroup <span
class="math inline">\(U\)</span> of <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A}_f)\)</span>, we set <span
class="math display">\[X_U := \mathrm{GL}_2(\mathbb{Q})
\backslash[\mathfrak{h}^{\pm, \ast} \times \mathrm{GL}_2(\mathbb{A}_f) /
U],\]</span> where <span class="math inline">\(\ast\)</span> means “add
the cusps” so as to obtain a compactification. The above contains the
set of “CM points” <span class="math display">\[\left\{[\tau_0, g] : g
\in \mathrm{GL}_2(\mathbb{A}_f) \right\},\]</span> which comes with with
an action of <span class="math inline">\(\hat{K}^\times\)</span> via the
reciprocity map <span class="math inline">\(\hat{K}^\times
\xrightarrow{\mathrm{rec}} G_K^{\mathrm{ab}}\)</span> defined by <span
class="math display">\[\operatorname{rec}(\alpha)[\tau_0, g]
  =[\tau_0, \alpha g].\]</span> We might as well take <span
class="math display">\[U = U_0(N) = \mathrm{GL}_2(\hat{\mathbb{Z}}) \cap
  \begin{pmatrix}
    \ast    &amp; \ast \\
    N \ast            &amp;  \ast \\
  \end{pmatrix}.\]</span></p>
<p>In that case, <span class="math inline">\(x_c =[\tau_0, g_c]\)</span>
for a particular choice of <span class="math inline">\(g_c\)</span>.</p>
<p>This is the classical picture of Heegner points. We’re going to
change the picture just a little bit. Think <span id="eq:cq6s0mlq0m" class="math display">\[\label{eq:cq6s0mlq0m}\tag{20}
  H := \mathbb{Q}^\times \backslash K^\times \rightarrow G :=
\frac{\mathrm{GL}_2 \times K^\times}{\mathbb{Q}^\times}.\]</span> (The
right hand side may be thought of as <span
class="math inline">\(\mathrm{GU}(1, 1)\)</span>, if you’d like.) We get
<span class="math display">\[X_{U_0(N)} \rightarrow
  \mathrm{S h}_G(U) := G(\mathbb{Q}) \backslash G(\mathbb{A}) / K_\infty
U, \quad U := U_0(N) \times V.\]</span> We also get <span
class="math display">\[\mathrm{S h}_H(V) := \hat{\mathbb{Q}}^\times
K^\times \backslash \hat{K}^\times / V.\]</span>&lt;++&gt; There is a
map <span class="math display">\[\mathrm{S h}_G(U) \rightarrow
\mathrm{Sh}_H(V).\]</span> In the interest of time, we’re going to cut
to the chase here. Look at compactly supported functions on <span
class="math inline">\(H(\mathbb{A}_f) \backslash
G(\mathbb{A}_f)\)</span>, valued in <span
class="math inline">\(\mathbb{Z}_p\)</span>. We’ll produce elements in
the Shimura variety of <span class="math inline">\(G\)</span> (over
<span class="math inline">\(K\)</span>) valued in <span
class="math inline">\(\mathbb{Z}_p(1)\)</span>: <span id="eq:cq6s0i3k4v" class="math display">\[\label{eq:cq6s0i3k4v}\tag{21}
  C_c(H(\mathbb{A}_f) \backslash G(\mathbb{A}_f), \mathbb{Z}_p)
  \rightarrow H^2_{\mathrm{ct}}(\mathrm{S h}_{G /K},
\mathbb{Z}_p(1))\]</span> <span class="math display">\[\mathbf{1}(g U)
\mapsto U_H = \hat{H}^\times g U g^{-1}.\]</span> Now we have <span
class="math display">\[\mathrm{Sh}_H(U_H) \xrightarrow{\mathrm{cyc}}
  H^2(\mathrm{Sh}_G(g U g^{-1}), \mathbb{Z}_p(1)) \xrightarrow{g}
  H^2(\mathrm{Sh}_G(U), \mathbb{Z}_p(1)).\]</span> These maps are <span
class="math inline">\(G(\mathbb{A}_f)\)</span>-equivariant, or “Hecke
equivariant”.</p>
<div class="exercise">
<p><strong>Exercise 7</strong>. Recover the Heegner point Euler system
that we wrote down before by taking the right open compact and the right
elements <span class="math inline">\(g_c\)</span>, with <span
class="math inline">\(V\)</span> coming from <span
class="math inline">\(\mathcal{O}_c\)</span>.</p>
</div>
<p>The point is that through this process, the Galois action has been
subsumed into some kind of group action. What’s really going on in some
ways is that the Shimura varieties for these unitary groups are just
some copies of modular curves, where the number of copies is just the
class group of some ring class extension. Once you have this picture,
the Euler system should just be the image of a bunch of elements on the
left hand side of <a href="#eq:cq6s0i3k4v" data-reference-type="eqref"
data-reference="eq:cq6s0i3k4v">\((21)\)</a>, and you just have to
choose the elements: <span class="math display">\[\text{Euler system} =
\text{ image of elements in } C_c((H \backslash G)(\mathbb{A}_f) /
\mathbb{Z}_p).\]</span> This can factor. Suppose <span
class="math inline">\(c = \ell_1 \dotsb \ell_r\)</span> is ap roduct of
primes. We might then take <span class="math display">\[\varphi_c =
\varphi_S \otimes \bigotimes_{\ell_i} \varphi_{\ell_i} \otimes
\bigotimes_{
    \substack{
      \ell \neq \ell_i  \\
      \ell \notin S      
    }
  }
  \varphi_{\ell}^0 \in \Bigl(C_c(X(\mathbb{Z}_S), \mathbb{Z}_p) \otimes
C_c(X(\mathbb{A}_f^S), \mathbb{Z}_p)\Bigr)^{U_c},\]</span> where <span
class="math inline">\(U_c := U_0(N) \times
\hat{\mathcal{O}}_c^\times\)</span>, the <span
class="math inline">\(\varphi_{\ell_i}\)</span> are chosen well and
<span class="math inline">\(\varphi_{\ell}^0 :=
\mathbf{1}(G(\mathbb{Z}_{\ell}))\)</span> is the unramified choice. By
choosing <span class="math inline">\(\varphi_S\)</span> appropriately,
we can even arrange that we’re in the homologically trivial classes,
hence giving rise to <span class="math display">\[z_c =
\mathrm{cyc}(\varphi_c)\]</span> in Galois cohomology; this is easy to
arrange by just choosing the right section for <span
class="math inline">\(\varphi_S\)</span>, which amounts to acting by a
Hecke operator of degree zero or something like that. The norm relations
are all about the <span class="math inline">\(\varphi_{\ell_i}\)</span>.
We have <span class="math display">\[\mathrm{cor}_{K[c \ell] / K[c]}
z_{c \ell} =
  \operatorname{cyc}
  \left(
    \sum_{
      t \in (\mathcal{O}_c \otimes \mathbb{Z}_{\ell} )^\times
/(\hat{\mathcal{O}}_{c \ell} \otimes \mathbb{Z}_{\ell})^\times
    }
    (1, t) \varphi_{c \ell}
  \right)
  \in C_c(X(\mathbb{A}_f), \mathbb{Z}_p)^{U_c}.\]</span> Suppose <span
class="math inline">\(\ell \nmid c\)</span>. Then we have <span
class="math display">\[\varphi_{\ell}^0 =
\mathbf{1}(X(\mathbb{Z}_{\ell}))\]</span> and <span
class="math display">\[\varphi_{\ell} &#39; :=
\mathop{\mathrm{trace}}\varphi_{\ell} = \sum_t \varphi_{\ell}(x(1,
t)).\]</span> What we’re interested in is, how to compare these two?
Both of the above define elements of <span class="math display">\[C_c(H
\backslash G(\mathbb{Q}_{\ell}), \mathbb{Z}_p)^{G(\mathbb{Z}_\ell)}
  =
  C_c(H \backslash G(\mathbb{Q}_{\ell}) / G(\mathbb{Z}_\ell),
\mathbb{Z}_p).\]</span> This space is cyclic for the action of the Hecke
algebra (at least after tensoring by <span
class="math inline">\(\mathbb{Q}_p\)</span>) <span
class="math display">\[\mathcal{H}(G /\!\!/G(\mathbb{Z}_{\ell}),
\mathbb{Q}_p)\]</span> generated with respect to that action by the
<span class="math inline">\(\varphi_{\ell}^0\)</span>. So we can write
<span class="math display">\[\varphi_{\ell} &#39; = P_{\ell} \ast
\varphi_{\ell}^0.\]</span> In the remaining minutes, let’s say something
about how that calculation might go.</p>
<p>Let <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\chi\)</span> be unramified representations of
<span class="math inline">\(\mathrm{GL}_2(\mathbb{Q}_{\ell})\)</span>
and <span class="math inline">\(K_{\ell}^\times\)</span>, respectively,
with <span class="math inline">\(\chi_\pi \chi
\mid_{\mathbb{Q}_{\ell}^\times} = 1\)</span>. This pair defines a
representation of the group <span class="math inline">\(G\)</span> as in
<a href="#eq:cq6s0mlq0m" data-reference-type="eqref"
data-reference="eq:cq6s0mlq0m">\((20)\)</a>. Take a spherical
vector <span class="math inline">\(\theta \in \pi\)</span>. Maybe we
realize <span class="math inline">\(\pi\)</span> in the Whittaker model.
Let’s also assume that <span class="math inline">\(\ell\)</span> splits.
The sort of functional we’re looking at is <span
class="math display">\[\int_{(g, t_0) \in H \backslash
G(\mathbb{Q}_{\ell})}
  \int_{t \in \mathbb{Q}_{\ell}^\times \backslash K_{\ell}^\times}
  \theta(t g)
  \chi(t t_0)
  \varphi(g, t_0)
  \,d^\times t
  = \Lambda(\varphi).\]</span> Taking <span
class="math display">\[\varphi = \varphi_{\ell} &#39; = P_{\ell} \ast
\varphi_{\ell}^0,\]</span> we obtain <span
class="math display">\[\Lambda(\varphi_{\ell} &#39;) = \xi_{(\pi,
\chi)}(P_{\ell}) \cdot \Lambda(\varphi_{\ell}^0),\]</span> where <span
class="math display">\[\Lambda(\varphi_{\ell}^0) =
\int_{\mathbb{Q}_{\ell}^\times \backslash K_{\ell}^\times} \theta(t)
\chi(t) \,d^\times t.\]</span> We might want to arrange that <span
class="math inline">\(1 = \Lambda(\varphi_{\ell} &#39;)\)</span>. Since
<span class="math inline">\(\Lambda(\varphi_{\ell}^0)\)</span> is the
<span class="math inline">\(L\)</span>-factor, this motivates taking
<span class="math inline">\(\xi(P_{\ell})\)</span> to be the Hecke
polynomial of which the <span class="math inline">\(L\)</span>-factor is
the inverse. Here we’re assuming that <span
class="math inline">\(\ell\)</span> splits in <span
class="math inline">\(K / \mathbb{Q}\)</span>.</p>
<p>Locally, we can think <span class="math display">\[K_{\ell}^\times =
\mathcal{O}_{\ell}^\times \times \mathcal{O}_{\ell}^\times
\hookrightarrow \mathrm{GL}_2(\mathbb{Q}_{\ell}),\]</span> where the
inclusion is the diagonal embedding. We can take <span
class="math display">\[g_{\ell} =
  \begin{pmatrix}
    1 &amp; \frac{1}{\ell} \\
    0 &amp; 1 \\
  \end{pmatrix}.\]</span> Then <span
class="math display">\[\varphi_{\ell} &#39;
  = \sum
  _{a \in(\mathbb{Z} / \ell)^\times}
  \varphi_{\ell}^0 \left(
    \begin{pmatrix}
    1      &amp; \frac{a}{\ell} \\
    0             &amp; 1 \\
    \end{pmatrix} \right).\]</span> You end up with something that’s not
quite what you want, but is <em>congruent</em> to what you want modulo
<span class="math inline">\(\ell - 1\)</span>. Anyway, the norm relation
from before falls out.</p>
<p>You can do this more generally for <span class="math inline">\(H
\subset G\)</span> defining Shimura varieties. One can is to take <span
class="math display">\[G = G\bigl(\mathop{\mathrm{U}}(n, 1) \times
\mathop{\mathrm{U}}(n - 1, 1) \times
\mathop{\mathrm{U}}(1)\bigr),\]</span> which contains <span
class="math display">\[H = G \bigl( \mathop{\mathrm{U}}(n - 1, 1) \times
\mathop{\mathrm{U}}(1) \bigr).\]</span> (This belongs to the “GGP”
setting.) We have a corresponding map of Shimura varieties <span
class="math display">\[\mathrm{Sh}_H \rightarrow \mathrm{Sh}_G\]</span>
of dimensions <span class="math inline">\(n - 1\)</span> and <span
class="math inline">\(n + n - 1 = 2 n - 1\)</span>, so the codimension
is <span class="math inline">\(n\)</span>, and we get a cycle class map
<span class="math display">\[H^0(\mathrm{Sh}_H)
\xrightarrow{\mathrm{cyc}} H^{2 n}(\mathrm{Sh}_G, n).\]</span> This
leads to <span class="math display">\[H^1(\text{ring class fields}, H^{2
n - 1}(\mathrm{Sh}_{\mathop{\mathrm{U}}(n - 1, 1) \times
\mathop{\mathrm{U}}(n, 1)})).\]</span> See the work of the speaker and
Xinwen Wan.</p>
<div class="remark">
<p><strong>Remark 42</strong>. We consider <span
class="math display">\[C_c(X(\mathbb{Q}_{\ell}),
\mathbb{Z}_p)^{G(\mathbb{Z}_{\ell})}
    \supseteq \mathop{\mathrm{trace}}C_c(X(\mathbb{Q}_{\ell}),
\mathbb{Z}_p)^{G_{\ell}(\mathbb{Z}_{\ell})},\]</span> for some subgroup
<span class="math inline">\(G_{\ell}(\mathbb{Z}_{\ell}) \subseteq
G(\mathbb{Z}_{\ell})\)</span>. What is the right hand side? Contains
<span class="math display">\[\left( P_{\ell} ,(\ell - 1)
C_c(\dotsb)^{G(\mathbb{Z}_{\ell})} \right).\]</span></p>
</div>
<div class="remark">
<p><strong>Remark 43</strong>. See paper of David Loeffler regarding the
ramified primes</p>
</div>
<script>
document.querySelectorAll(".toggle-proof").forEach(function(toggle) {
  toggle.addEventListener("click", function(e) {
    e.preventDefault();
    const content = this.nextElementSibling;
    const em = this.querySelector('em');
    if (window.getComputedStyle(content).display === "none") {
      content.style.display = "inline";
      em.textContent = em.dataset.defaultText;
    } else {
      content.style.display = "none";
      em.textContent = em.dataset.foldedText;
    }
  });
});
</script>
<script>
document.querySelector("#toggle-all-proofs").addEventListener("click", function(e) {
  e.preventDefault();
  const proofs = document.querySelectorAll(".proof-content");
  proofs.forEach(function(proof) {
    const proofToggle = proof.previousElementSibling;
    if (window.getComputedStyle(proof).display === "none") {
      proof.style.display = "inline";
      proofToggle.innerHTML = `<em>${proofToggle.dataset.defaultText}</em>`;
    } else {
      proof.style.display = "none";
      proofToggle.innerHTML = `<em>${proofToggle.dataset.foldedText}</em>`;
    }
  });
});
</script>

<script src="https://giscus.app/client.js"
        data-repo="Ultronozm/math"
        data-repo-id="R_kgDOJlhjqQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOJlhjqc4CWo21"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</body>
</html>

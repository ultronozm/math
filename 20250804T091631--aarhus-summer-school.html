<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Aarhus Automorphic Forms Summer School</title>
  <link rel="stylesheet" href="tex.css">
  <style>
      .my-links-container {
        position: absolute;
        top: 0;
        right: 0;
        padding-right: 20px;
        padding-top: 10px;
      }
      .my-link {
        margin-left: 10px;
      }
      .my-links-container-2 { /* new CSS class for the second row */
        position: absolute;
        top: 40px; /* adjust this value based on the height of your links */
        right: 0;
        padding-right: 20px;
      }
      .my-link-2 {
        margin-left: 10px;
      }

    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    div.abstract {
      margin: 2em 2em 2em 2em;
      text-align: left;
      font-size: 85%;
    }
    div.abstract-title {
      font-weight: bold;
      text-align: center;
      padding: 0;
      margin-bottom: 0.5em;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
    <div class="my-links-container">
2025-08-09 14:36:19
      <a href="20250804T091631--aarhus-summer-school.tex" class="my-link">tex</a>
      <a href="20250804T091631--aarhus-summer-school.pdf" class="my-link">pdf</a>
      <a href="https://github.com/ultronozm/math/commits/main/20250804T091631--aarhus-summer-school.tex" class="my-link">history</a>
      <a href="." class="my-link">home</a>
    </div>
<header id="title-block-header">
<h1 class="title">Aarhus Automorphic Forms Summer School</h1>
<div class="abstract">
<div class="abstract-title">Abstract</div>
<p>Notes in progress on lectures taking place there.</p>
</div>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#sec:cq6tho1n9f" id="toc-sec:cq6tho1n9f">Gebhard Boeckle’s
lectures</a></li>
<li><a href="#sec:cq6tho1vem" id="toc-sec:cq6tho1vem">Chris Skinner’s
lectures</a></li>
<li><a href="#sec:cq6tho1wyu" id="toc-sec:cq6tho1wyu">Jayce Getz’s
lectures</a>
<ul>
<li><a href="#sec:cq6tho1xqr" id="toc-sec:cq6tho1xqr">Langlands <span
class="math inline">\(L\)</span>-functions and converse theorem</a></li>
<li><a href="#sec:cq6tho1yti" id="toc-sec:cq6tho1yti">Rankin–Selberg
products and triple products</a></li>
<li><a href="#sec:cq6tho1zlh" id="toc-sec:cq6tho1zlh">Poisson summation
conjecture</a>
<ul>
<li><a href="#sec:cq6tho17py" id="toc-sec:cq6tho17py">Global
setting</a></li>
<li><a href="#sec:cq6tho3bu5" id="toc-sec:cq6tho3bu5">Local harmonic
analysis</a></li>
<li><a href="#sec:cq6txpqnif" id="toc-sec:cq6txpqnif">Poisson summation
formula</a></li>
</ul></li>
<li><a href="#sec:cq6txpqmpx" id="toc-sec:cq6txpqmpx">The spectral
argument</a>
<ul>
<li><a href="#sec:cq6txpqlp7" id="toc-sec:cq6txpqlp7">Plancherel
decomposition</a></li>
<li><a href="#sec:cq6txpqktt" id="toc-sec:cq6txpqktt"><span
class="math inline">\(L\)</span>-functions</a></li>
<li><a href="#sec:cq6txpqjrw" id="toc-sec:cq6txpqjrw">Construction of a
Schwartz space</a></li>
<li><a href="#sec:cq6txpqe90" id="toc-sec:cq6txpqe90">The spectral
argument</a></li>
</ul></li>
<li><a href="#sec:cq6ud4pku1" id="toc-sec:cq6ud4pku1">Producing new
Poisson summation formulae from old</a>
<ul>
<li><a href="#sec:cq6ud4pjsa"
id="toc-sec:cq6ud4pjsa">Restriction</a></li>
<li><a href="#sec:cq6ud4ph5c"
id="toc-sec:cq6ud4ph5c">Coinvariant</a></li>
<li><a href="#fiber-bundle-method" id="toc-fiber-bundle-method">Fiber
bundle method</a></li>
</ul></li>
<li><a href="#integral-representations-of-triple-product-l-functions"
id="toc-integral-representations-of-triple-product-l-functions">Integral
representations of triple product <span
class="math inline">\(L\)</span>-functions</a></li>
</ul></li>
<li><a href="#sec:cq6tho3cpy" id="toc-sec:cq6tho3cpy">Chen Wan’s
lectures</a></li>
<li><a href="#sec:cq6tho1cgx" id="toc-sec:cq6tho1cgx">Raphael
Beuzart-Plessis’s lectures</a>
<ul>
<li><a href="#sec:cq6tho1blx" id="toc-sec:cq6tho1blx">RTF in general</a>
<ul>
<li><a href="#sec:cq6tho1auw" id="toc-sec:cq6tho1auw">Periods</a></li>
<li><a href="#sec:cq6thpxagu" id="toc-sec:cq6thpxagu">Theta
series</a></li>
<li><a href="#sec:cq6thp1yjb" id="toc-sec:cq6thp1yjb">RTF
formally</a></li>
<li><a href="#sec:cq6thubysx" id="toc-sec:cq6thubysx">RTF and theta
series</a></li>
</ul></li>
<li><a href="#sec:cq6tyal5g1" id="toc-sec:cq6tyal5g1">Waldspurger
theorem via Jacquet’s comparison of RTF</a>
<ul>
<li><a href="#sec:cq6tyal962" id="toc-sec:cq6tyal962">Reminder on Hecke
periods</a></li>
<li><a href="#sec:cq6tyama80" id="toc-sec:cq6tyama80">Waldspurger’s
formula</a></li>
<li><a href="#sec:cq6tyamby0" id="toc-sec:cq6tyamby0">Quaternion
algebras</a></li>
<li><a href="#sec:cq6tyamcm6"
id="toc-sec:cq6tyamcm6">Non-vanishing</a></li>
<li><a href="#sec:cq6tyamdej" id="toc-sec:cq6tyamdej">RTF
approach</a></li>
<li><a href="#sec:cq6tyamec3" id="toc-sec:cq6tyamec3">Geometric
expansions</a></li>
<li><a href="#sec:cq6uerkd57" id="toc-sec:cq6uerkd57">Local
transfer</a></li>
<li><a href="#sec:cq6uewy7rr" id="toc-sec:cq6uewy7rr">Global
comparison</a></li>
</ul></li>
<li><a href="#sec:cq6uewy6d8"
id="toc-sec:cq6uewy6d8">Gan–Gross–Prasad</a></li>
</ul></li>
</ul>
</nav>
<h1 id="sec:cq6tho1n9f">§1. Gebhard Boeckle’s lectures</h1>
<p><strong>Galois representations and congruences</strong>.</p>
<p>We first discuss profinite groups. Let <span
class="math inline">\(G\)</span> be a topological group.</p>
<div id="theorem:cq6thpngt0" class="theorem">
<p><strong>Theorem 1</strong>. <em>The following are
equivalent:</em></p>
<ol type="a">
<li><p><em><span id="enumerate:cq6r3e8dsb"
label="enumerate:cq6r3e8dsb"></span> <span
class="math inline">\(G\)</span> is compact, Hausdorff, and totally
disconnected.</em></p></li>
<li><p><em><span id="enumerate:cq6r3e8eqf"
label="enumerate:cq6r3e8eqf"></span> <span
class="math inline">\(G\)</span> is compact, and admits a neighborhood
basis of the identity by open normal subgroups.</em></p></li>
<li><p><em><span id="enumerate:cq6r3e8f6g"
label="enumerate:cq6r3e8f6g"></span> There is a directed poset <span
class="math inline">\(I\)</span> and an inverse system <span
class="math inline">\((G_i)\)</span> of finite (discrete) groups such
that <span class="math inline">\(G = \varprojlim_I
G_i\)</span>.</em></p></li>
</ol>
</div>
<p>We say that <span class="math inline">\(G\)</span> is
<em>profinite</em> if the above conditions hold. The topology on <span
class="math inline">\(\varprojlim G_i\)</span> is that obtained by
regarding it as a closed subgroup of the product <span
class="math inline">\(\prod G_i\)</span>.</p>
<p>Constructions:</p>
<ol type="a">
<li><p><span id="enumerate:cq6r3e8b0y"
label="enumerate:cq6r3e8b0y"></span> If <span
class="math inline">\(G\)</span> is discrete, then we equip it with the
profinite topology <span class="math inline">\(G^{\mathrm{pf}} :=
\varprojlim G / N\)</span>, where <span class="math inline">\(N\)</span>
runs over the finite index subgroups.</p></li>
<li><p><span id="enumerate:cq6r3e8cou"
label="enumerate:cq6r3e8cou"></span> If <span class="math inline">\(G =
\varprojlim G_i\)</span> is profinite, then</p>
<ol type="i">
<li><p><span id="enumerate:cq6r3fehbe"
label="enumerate:cq6r3fehbe"></span> The abelianization is given by
<span class="math display">\[G^{\mathrm{ab}} = G / \overline{[G, G]} =
\varprojlim G_i^{\mathrm{ab}},\]</span> and in particular, is
profinite.</p></li>
<li><p><span id="enumerate:cq6r3feivc"
label="enumerate:cq6r3feivc"></span> For <span
class="math inline">\(H\)</span> finite, write <span
class="math inline">\(H_p\)</span> for its maximal <span
class="math inline">\(p\)</span>-group quotient. Then <span
class="math display">\[G_p = \varprojlim(G_i)_p\]</span> is a pro-<span
class="math inline">\(p\)</span>-group (and in particular,
profinite).</p></li>
<li><p><span id="enumerate:cq6r3fej61"
label="enumerate:cq6r3fej61"></span> If <span class="math inline">\(N
\leq G\)</span> is closed and normal, then <span class="math inline">\(G
/N\)</span> is profinite.</p></li>
</ol></li>
</ol>
<div id="example:cq6thpnfb9" class="example">
<p><strong>Example 2</strong>. </p>
<ol type="a">
<li><p><span id="enumerate:cq6r3fjkt4"
label="enumerate:cq6r3fjkt4"></span> Let <span
class="math inline">\(F\)</span> be a field. Set <span
class="math inline">\(G_F := {\mathop{\mathrm{Aut}}}_F(F^{\mathrm{sep}}) =
\mathop{\mathrm{Gal}}(F^{\mathrm{sep}} / F)\)</span> profinite. Define
the poset <span class="math display">\[\mathcal{I}_F := \left\{ L
\subseteq F^{\mathrm{sep}} : L \supseteq F \text{ finite Galois},
\subseteq \right\}.\]</span> Then <span class="math display">\[G_F
\xrightarrow{\cong} \varprojlim_{L \in \mathcal{I}_F}
\mathop{\mathrm{Gal}}(L / F).\]</span></p></li>
<li><p><span id="enumerate:cq6r3fm1jw"
label="enumerate:cq6r3fm1jw"></span> Let <span
class="math inline">\(F&#39; \subseteq F^{\mathrm{sep}}\)</span> be a
normal extension of <span class="math inline">\(F\)</span>. Then <span
class="math inline">\(G_{F&#39;} \leq G_F\)</span> is closed and normal.
We may thus write <span class="math display">\[\mathop{\mathrm{Gal}}(F
&#39; / F) \cong G_F / G_{F&#39;} = \lim_{
        \substack{
          L \in \mathcal{I}_F,  \\
          L \subseteq F&#39;          
        }
      }
      \mathop{\mathrm{Gal}}(L /F).\]</span></p></li>
<li><p><span id="enumerate:cq6r3fm4tn"
label="enumerate:cq6r3fm4tn"></span> Let <span
class="math inline">\(\mathbb{N}\)</span> denote the natural numbers,
ordered by divisibility. Then <span
class="math display">\[\hat{\mathbb{Z}} = \varprojlim \mathbb{Z} / n =
\prod_{p} \mathbb{Z}_p,\]</span> where the last step is the Chinese
remainder theorem. We sometimes need a slight modification: <span
class="math display">\[\hat{\mathbb{Z}}^{(p)} = \varprojlim_{p \nmid n}
\mathbb{Z} / n = \prod_{\ell \text{ prime}, \\ \ell \neq p }
\mathbb{Z}_{\ell}.\]</span></p>
<p>Let’s fix some notation:</p>
<ol>
<li><p><span id="enumerate:cq6r3f3t8d"
label="enumerate:cq6r3f3t8d"></span> Let <span
class="math inline">\(K\)</span> be a number field, <span
class="math inline">\(\mathcal{O}_K\)</span> its ring of integers. Let
<span class="math inline">\(\mathrm{P l}_K = \mathrm{P l}_K^\infty
\sqcup \mathrm{P l}_K^{\mathrm{fin}}\)</span> denote the set of places
<span class="math inline">\(v\)</span> of <span
class="math inline">\(K\)</span>. Let <span
class="math inline">\(v\)</span> be a finite place. We may then attach
to it a maximal ideal <span
class="math inline">\(\mathfrak{q}_v\)</span> of <span
class="math inline">\(\mathcal{O}_K\)</span>, giving a bijection <span
class="math display">\[\mathrm{P l}_K^{\mathrm{fin}} \leftrightarrow
\operatorname{Max}(\mathcal{O}_K).\]</span> We may form the residue
field <span class="math inline">\(k_v := \mathcal{O}_K /
\mathfrak{q}_v\)</span>. We denote <span
class="math inline">\(q_v\)</span> for the cardinality of <span
class="math inline">\(k_v\)</span>. We write <span
class="math inline">\(\operatorname{char}(v)\)</span> for the
characteristic of <span class="math inline">\(k_v\)</span>. We denote by
<span class="math inline">\(\mathcal{O}_v = \varprojlim \mathcal{O} /
\mathfrak{q}_v^n\)</span>, with fraction field <span
class="math inline">\(K_v\)</span>. Also, we have a short exact sequence
<span class="math display">\[1 \rightarrow I_v \rightarrow G_v :=
{\mathop{\mathrm{Gal}}}_{K_v} \rightarrow {\mathop{\mathrm{Gal}}}_{k_v}
\rightarrow 1.\]</span> A topological generator for <span
class="math inline">\({\mathop{\mathrm{Gal}}}_{k_v}\)</span> is given by
<span class="math display">\[\mathrm{Fr}_v : \alpha \mapsto
\alpha^{q_v}.\]</span> We denote by <span
class="math inline">\(\mathrm{Frob}_v \in G_v\)</span> some lift of
<span class="math inline">\(\mathrm{Fr}_v\)</span>.</p>
<p>We write <span class="math inline">\(S_\infty := \mathrm{P
l}_K^\infty\)</span> for the set of archimedean places, so that <span
class="math inline">\(K \otimes_{\mathbb{Q}} \mathbb{R} \cong \prod_{v
\in S_\infty} K_v\)</span>. For a rational prime <span
class="math inline">\(p\)</span>, we write <span
class="math inline">\(S_p\)</span> for the set of places <span
class="math inline">\(v\)</span> of <span
class="math inline">\(K\)</span> such that <span class="math inline">\(v
\mid p\)</span>.</p></li>
<li><p>We also need some local analogues for <span
class="math inline">\(E \supseteq \mathbb{Q}_p\)</span> a <span
class="math inline">\(p\)</span>-adic field. Let <span
class="math inline">\(\mathcal{O} = \mathcal{O}_E\)</span> denote the
ring of integers, <span class="math inline">\(\pi = \pi_E\)</span> a
uniformizer, and <span class="math inline">\(\mathbb{F} = \mathcal{O}_E
/ \pi\)</span> the residue field, with <span class="math inline">\(q =
\# \mathbb{F}\)</span>. Then <span class="math inline">\(E \supseteq
\mathbb{Q}_q = \mathbb{Q}_p[\zeta_{q - 1}] \supseteq
\mathbb{Q}_p\)</span>. We have <span class="math inline">\(W(\mathbb{F})
= \mathbb{Z}_q = \mathbb{Z}_p[\zeta_{q - 1}]\)</span>.</p></li>
</ol>
<p>Contiuing the examples, which may serve as exercises:</p></li>
<li><p><span id="enumerate:cq6r3g5d9c"
label="enumerate:cq6r3g5d9c"></span> Let <span
class="math inline">\(\zeta_t\)</span> be a primitive <span
class="math inline">\(t\)</span>th root of <span
class="math inline">\(1\)</span>. For <span
class="math inline">\(k\)</span> a finite field, we have <span
class="math inline">\(G_k \cong \hat{\mathbb{Z}} = \overline{\langle
\mathrm{Fr}_k \rangle}\)</span>, where <span
class="math inline">\(\mathrm{Fr}_k : \alpha \mapsto \alpha^{\lvert k
\rvert}\)</span>.</p></li>
<li><p><span id="enumerate:cq6r3g5e7y"
label="enumerate:cq6r3g5e7y"></span> Let <span class="math inline">\(E
\supseteq \mathbb{Q}_p\)</span> (finite extension). Then <span
class="math inline">\(G_E\)</span> (Jannsen–Wingberg for <span
class="math inline">\(p \geq 2\)</span>). Local class field theory: the
Artin map <span class="math inline">\(E^\times \rightarrow
G_E^{\mathrm{ab}}\)</span> is a continuous inclusion with dense image.
Writing <span class="math inline">\(E^\times = \pi_E^{\mathbb{Z}} \times
\mathcal{O}_E^\times = \pi_E^{\mathbb{Z}} \times \mathbb{F}^\times
\times \mathcal{U}_E^1\)</span>. Since the units are known to be a
finitely generated <span
class="math inline">\(\mathbb{Z}_p\)</span>-module, we get as a
corollary that <span
class="math display">\[{\mathop{\mathrm{Hom}}}_{\mathrm{cts}}(G_E,
\mathbb{F}_p) = H^1_{\mathrm{cts}}(G_E, \mathbb{F}_p)\]</span> is
finite.</p></li>
<li><p><span id="enumerate:cq6r3g5cxb"
label="enumerate:cq6r3g5cxb"></span> We turn to the case of a number
field <span class="math inline">\(K\)</span>. We fix an embedding <span
class="math inline">\(K^{\mathrm{sep}} \subseteq
K_v^{\mathrm{sep}}\)</span> for each place <span
class="math inline">\(v\)</span>, which gives an embedding of Galois
groups <span class="math inline">\(G_v \rightarrow G_K\)</span>. For
<span class="math inline">\(S \subseteq \mathrm{P l}_K\)</span> finite,
we write <span class="math display">\[K_S := \left\{ \alpha \in
K^{\mathrm{sep}} : K(\alpha) \text{ is unramified outside } S
\right\},\]</span> which is a normal (typically infinite) extension of
<span class="math inline">\(K\)</span>. We write <span
class="math display">\[G_{K, S} := \mathop{\mathrm{Gal}}(K_S / K) = G_K
/ G_{K_S}\]</span> for its Galois group. We remark that if we take <span
class="math inline">\(v \notin S\)</span>, then since <span
class="math inline">\(v\)</span> does not ramify in <span
class="math inline">\(K_S\)</span>, we know that the map <span
class="math inline">\(G_v \rightarrow G_{K, S}\)</span> factors via the
quotient <span class="math inline">\(G_v / I_v \cong G_{k_v}\)</span>,
so that <span class="math inline">\(\mathrm{Frob}_v \in G_{K,
S}\)</span> is independent of the choice of lift. On the other hand, if
<span class="math inline">\(v \in S\)</span>, then we might ask whether
the map <span class="math inline">\(G_v \hookrightarrow G_{K,
S}\)</span> (see the work of Cheniever–Clozel). The structure of <span
class="math inline">\(G_{K, S}\)</span> is unknown, but global class
field theory describes <span class="math inline">\(G_{K,
S}^{\mathrm{ab}}\)</span>. A corollary is that <span
class="math display">\[H^{1}_{\mathrm{cts}}(G_{K, S}, \mathbb{F}_p) =
{\mathop{\mathrm{Hom}}}_{\mathrm{cts}}(G_{K, S}, \mathbb{F}_p)\]</span> is
finite whenever <span class="math inline">\(S\)</span> is finite. (One
can appeal to Hermite–Minkowski, or class field theory.)</p></li>
<li><p><span id="enumerate:cq6r3g5bmp"
label="enumerate:cq6r3g5bmp"></span> Consider the tame quotient of <span
class="math inline">\(G_E\)</span>, for <span class="math inline">\(E
\supseteq \mathbb{Q}_p\)</span>. Given <span class="math inline">\(E
\supseteq \mathbb{Q}_p\)</span>, we form the tower of extensions <span
class="math inline">\(E^{\mathrm{tame}} / E^{\mathrm{unr}} / E\)</span>,
where <span class="math display">\[E^{\mathrm{unr}} = \cup \left\{
E(\zeta_n) : p \nmid n \right\},\]</span> <span
class="math display">\[E^{\mathrm{tame}} = \cup \left\{
E^{\mathrm{unr}}(\sqrt[n]{\pi_E}) : p \nmid n \right\}.\]</span> It’s a
fact that <span class="math inline">\(G_E^{\mathrm{tame}}\)</span> may
be expressed as the profinite completion of <span
class="math inline">\(\langle s t : s t s^{-1} = t^q
\rangle\)</span>.</p></li>
</ol>
</div>
<p>We finally come to <strong>Galois representations</strong>. They will
typically be called <span class="math inline">\(\rho : G \rightarrow
\mathrm{GL}_n(A)\)</span>, where <span class="math inline">\(G\)</span>
is a topological group, <span class="math inline">\(A\)</span> is a
topological ring, and <span class="math inline">\(\rho\)</span> is a
continuous map. The topology on <span
class="math inline">\(\mathrm{GL}_n(A)\)</span> is the subspace topology
coming from embedding inside <span class="math inline">\(M_n(A) \times
A\)</span> via <span class="math inline">\(g \mapsto(g,
\det(g)^{-1})\)</span>, for instance. We call <span
class="math inline">\(\rho\)</span> a Galois representation if <span
class="math inline">\(G = G_F\)</span> for some field <span
class="math inline">\(F\)</span>. The main examples of interest for
<span class="math inline">\(A\)</span> will be <span
class="math inline">\(\mathbb{C}\)</span>, finite fields, and <span
class="math inline">\(p\)</span>-adic fields, to interpolate <span
class="math inline">\(\mathrm{C N L}_{\mathcal{O}}\)</span> (complete
Noetherian local <span
class="math inline">\(\mathcal{O}\)</span>-algebras).</p>
<div id="exercise:cq6thpnece" class="exercise">
<p><strong>Exercise 1</strong>. Let <span
class="math inline">\(G\)</span> be profinite, and <span
class="math inline">\(\rho\)</span> as above.</p>
<ol type="a">
<li><p>If <span class="math inline">\(A = \mathbb{C}\)</span>, then
<span class="math inline">\(\rho(G)\)</span> is finite.</p></li>
<li><p>If <span class="math inline">\(A =
\overline{\mathcal{O}_p}\)</span>, then there is a finite extension
<span class="math inline">\(E \supseteq \mathbb{Q}_p\)</span> such that
<span class="math inline">\(\rho(G) \subseteq \mathrm{GL}_n(E)\)</span>
up to conjugation.</p></li>
<li><p><span id="enumerate:cq6r3j15cy"
label="enumerate:cq6r3j15cy"></span> If <span class="math inline">\(A =
E \supseteq \mathbb{Q}_p\)</span> (finite extension), then after
conjugation, we can assume that <span class="math inline">\(\rho(G)
\subseteq \mathrm{GL}_n(\mathcal{O})\)</span>.</p></li>
</ol>
</div>
<p>In case <a href="#enumerate:cq6r3j15cy" data-reference-type="eqref"
data-reference="enumerate:cq6r3j15cy">\((c)\)</a>, we
have a <span class="math inline">\(G\)</span>-stable lattice <span
class="math inline">\(\Lambda \cong \mathcal{O}^n \subseteq
E^n\)</span>. We can apply reduction <span
class="math inline">\(\mathcal{O} \rightarrow \mathbb{F}\)</span>. This
gives a reduction <span class="math display">\[\overline{\rho}_\Lambda :
G \rightarrow \mathrm{GL}_n(\mathbb{F}).\]</span> Let’s use the notation
<span class="math inline">\(\mathrm{c p}_\alpha\)</span> for the
characteristic polynomial of <span class="math inline">\(\alpha \in
M_n(A)\)</span>.</p>
<div id="theorem:cq6thpnb2h" class="theorem">
<p><strong>Theorem 3</strong>. <em></em></p>
<ol type="a">
<li><p><em>Given a representation <span class="math inline">\(r : G
\rightarrow \mathrm{GL}_n(\mathbb{F})\)</span>. Then there exists a
semisimple representation <span class="math inline">\(r^{\mathrm{ss}} :
G \rightarrow \mathrm{GL}_n(\mathbb{F})\)</span> such that <span
class="math inline">\(\mathrm{c p}_r = \mathrm{c
p}_{r^{\mathrm{ss}}}\)</span> (Brauer–Nesbitt), where <span
class="math inline">\(r^{\mathrm{ss}}\)</span> is unique up to
isomorphism.</em></p></li>
<li><p><em>We have <span class="math inline">\(\mathrm{c p}_{\rho} \in
\mathcal{O}[X]\)</span> and <span class="math inline">\(\mathrm{c
p}_{\bar{\rho}_\Lambda} \in \mathbb{F}[X]\)</span>, independent of <span
class="math inline">\(\Lambda\)</span>.</em></p></li>
</ol>
</div>
<div id="theorem:cq6thpnc4r" class="theorem">
<p><strong>Theorem 4</strong>. <em>For <span class="math inline">\(\rho,
\rho &#39; : G_{K, S} \rightarrow \mathrm{GL}_n(E)\)</span> semisimple,
we have that <span class="math inline">\(\rho \sim \rho &#39;\)</span>
(conjugate) if and only if for all <span class="math inline">\(v \in
\mathrm{P l}_K^{\mathrm{fin}} \setminus S\)</span>, we have <span
class="math display">\[\mathrm{c p}_{\rho({\mathop{\mathrm{Frob}}}_v)} =
\mathrm{c p}_{\rho &#39;({\mathop{\mathrm{Frob}}}_v)}.\]</span></em></p>
</div>
<div id="example:cq6thpna68" class="example">
<p><strong>Example 6</strong>. </p>
<ol>
<li><p><span id="enumerate:cq6r3ki8zp"
label="enumerate:cq6r3ki8zp"></span> <span
class="math inline">\(p\)</span>-adic cyclotomic character <span
class="math inline">\(\chi_p^{\mathrm{cyc}} : G_{\mathbb{Q}} \rightarrow
\mathbb{Z}_p^\times\)</span>. We have <span
class="math display">\[G_{\mathbb{Q}} \circlearrowright \mu_{p^n} =
\left\langle \zeta_{p^n} \right\rangle \cong \mathbb{Z} / p^n,\]</span>
<span class="math inline">\((\mathbb{Z} / p^n)^\times =
{\mathop{\mathrm{Aut}}}_{\mathbb{Z}}(\mathbb{Z} / p^n)\)</span>.
<strong>Facts</strong>:</p>
<ul>
<li><p><span class="math inline">\(\chi_p^{\mathrm{cyc}}
\mid_{G_K}\)</span>: unramified outside <span class="math inline">\(S_p
\cup S_\infty\)</span>.</p></li>
<li><p><span
class="math inline">\(\chi_p^{\mathrm{cyc}}({\mathop{\mathrm{Frob}}}_v) =
q_v \in \mathbb{Z}_p^\times\)</span>.</p></li>
</ul></li>
<li><p><span id="enumerate:cq6r3ki7yl"
label="enumerate:cq6r3ki7yl"></span> The Tate module of an elliptic
curve <span class="math inline">\(\mathcal{E}_{/ K}\)</span>. We again
have <span class="math inline">\(G_K \circlearrowright
\mathcal{E}[p^n](\bar{K}) \cong(\mathbb{Z} / p^n)^{\oplus 2}\)</span>,
which gives rise to <span class="math inline">\(G_K \rightarrow
\mathrm{GL}_2(\mathbb{Z} / p^n)\)</span>. In the limit, we get <span
class="math display">\[\rho_{\mathcal{E}, p} : G_K \rightarrow
\mathrm{GL}_2(\mathbb{Z}_p) \hookrightarrow
\mathrm{GL}_2(\mathbb{Q}_p).\]</span> <strong>Facts</strong>:</p>
<ul>
<li><p><span class="math inline">\(\rho_{\mathcal{E},p}\)</span> is
unramified outside <span class="math inline">\(S_\infty \cup S_p \cup
\mathrm{Bad}\)</span>.</p></li>
<li><p>For <span class="math inline">\(v\)</span> outside those places,
we have <span class="math display">\[\mathrm{c p}_{\rho_{\mathcal{E},
p}}({\mathop{\mathrm{Frob}}}_v) = X^2 - a_v(\mathcal{E}) X + q_v,\]</span>
where <span class="math display">\[a_v := \# \mathcal{E}(k_v).\]</span>
This shows the geometric meaning of Frobenius.</p></li>
</ul></li>
<li><p><span id="enumerate:cq6sj47m05"
label="enumerate:cq6sj47m05"></span> Let <span class="math inline">\(f =
q + \sum_{n \geq 2} a_n q^n\)</span> be the <span
class="math inline">\(q\)</span>-expansion of a cuspidal Hecke eigenform
<span class="math inline">\(f \in S_k(N, \varepsilon)\)</span>, <span
class="math inline">\(k \geq 1\)</span>, <span
class="math inline">\(\varepsilon:(\mathbb{Z} / N)^\times \rightarrow
\mathbb{C}^\times\)</span>.</p>
<div class="theorem">
<p><strong>Theorem 5</strong>. </p>
<ol type="a">
<li><p><em><span id="enumerate:cq6sj5bs5p"
label="enumerate:cq6sj5bs5p"></span> <span class="math inline">\(E_f =
\mathbb{Q}(a_n : n \geq 1)\)</span> is a number field, with <span
class="math inline">\(a_n \in \mathcal{O}_{E_f}\)</span> for all <span
class="math inline">\(n\)</span>.</em></p></li>
<li><p><em><span id="enumerate:cq6sj5bt7j"
label="enumerate:cq6sj5bt7j"></span> (Eichler–Shimura, Deligne,
Deligne–Serre) For all finite places <span
class="math inline">\(\lambda\)</span> of <span
class="math inline">\(E_f\)</span> (with <span
class="math inline">\(E_\lambda\)</span> the completion of <span
class="math inline">\(\lambda\)</span> and <span
class="math inline">\(p\)</span> the characteristic of <span
class="math inline">\(k_\lambda\)</span>) there exists an absolutely
irreducible representation <span class="math display">\[\rho_{f,
\lambda} : G_{\mathbb{Q}, N \cup \{p, \infty\}} \rightarrow
\mathrm{GL}_2(\bar{E}_\lambda)\]</span> and for all primes <span
class="math inline">\(\ell \nmid N p\)</span>, we have the relation that
we just saw in Chris’s talk: <span class="math display">\[\mathrm{c
p}_{\rho_{f , \lambda}}(\mathrm{Frob}_{\ell}) = X^2 - a_{\ell} X +
\varepsilon(\ell) \ell^{k - 1}.\]</span></em></p></li>
</ol>
</div>
<p>This characterizes the representation and maybe gives the main link
to Galois representation.</p></li>
</ol>
</div>
<p>Now, we want to study congruences. To do this, we first go from</p>
<ul>
<li><p>cusp forms that start life over the complex numbers on the upper
half plane, to</p></li>
<li><p>Fourier coefficients, that live over the integers.</p></li>
</ul>
<p>(For simplicity, assume that nebentypus is trivial: <span
class="math inline">\(\varepsilon= 1\)</span>.) Let <span
class="math inline">\(S_k(N, \mathbb{Z})\)</span> denote the set of all
<span class="math inline">\(f = \sum_{n \geq 1} a_n q^n\)</span> such
that <span class="math inline">\(a_n \in \mathbb{Z}\)</span> for all
<span class="math inline">\(n\)</span>.</p>
<div id="fact:cq6thpm98m" class="fact">
<p><strong>Fact 7</strong>. <em><span class="math inline">\(S_k(N,
\mathbb{Z})\)</span> is a <span
class="math inline">\(\mathbb{Z}\)</span>-module of rank equal to <span
class="math inline">\(\dim_{\mathbb{C}} S_k(N)\)</span>.</em></p>
</div>
<p>For any ring <span class="math inline">\(A\)</span>, we have <span
class="math display">\[\underline{S}_{A} = S_k(N, \mathbb{Z})
\otimes_{\mathbb{Z}} A \circlearrowleft \mathbb{T}_A = \mathbb{T}(N,
A).\]</span></p>
<div id="definition:cq6thpm876" class="definition">
<p><strong>Definition 8</strong>. For Hecke eigenforms <span
class="math inline">\(f = \sum a_n q^n\)</span> and <span
class="math inline">\(g = b_n q^n \in S_k(N,
\bar{\mathbb{Z}}_p)\)</span>, we say that <span class="math inline">\(f
\equiv g \pmod{p}\)</span> if the following equivalent conditions
hold:</p>
<ul>
<li><p>for all primes <span class="math inline">\(\ell \nmid N
p\)</span>, we have <span class="math inline">\(a_{\ell} \equiv b_{\ell}
\pmod{\mathfrak{m}_{\overline{\mathbb{Z}_p}}}\)</span>.</p></li>
<li><p><span class="math inline">\(\rho_f \equiv \rho_g
\pmod{\mathfrak{m} \bar{\mathbb{Z}}_p}\)</span> as maps <span
class="math inline">\(G_{\mathbb{Q}} \rightarrow
\mathrm{GL}_2(\bar{\mathbb{F}}_p)\)</span>.</p></li>
</ul>
</div>
<p>We pass to the same Hecke algebra. Let <span
class="math inline">\(\mathbb{T}_A &#39;\)</span> denote the subalgebra
of <span class="math inline">\(\mathbb{T}_A\)</span> generated by <span
class="math inline">\(T_{\ell}\)</span> for all <span
class="math inline">\(\ell \nmid N\)</span>. This is acted on by <span
class="math inline">\(\underline{S}_A\)</span>.</p>
<div class="fact">
<p><strong>Fact 9</strong>. <em>We have bijections between the
following:</em></p>
<ul>
<li><p><em><span class="math inline">\(\mathbb{T} &#39;\)</span>-Hecke
eigensystems of forms in <span
class="math inline">\(S_k(N)\)</span>.</em></p></li>
<li><p><em><span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathbb{C}}(\mathbb{T}_{\mathbb{C}}&#39;,
\mathbb{C})\)</span>.</em></p></li>
<li><p><em><span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathcal{O}}(\mathbb{T}_{\mathcal{O}}&#39;,
\mathcal{O})\)</span>, where we choose <span
class="math inline">\(E\)</span> large enough with <span
class="math inline">\(\mathbb{C} \supseteq \bar{\mathbb{Q}} \subseteq
\bar{\mathbb{Q}}_p \supseteq E \supseteq \mathcal{O}\)</span>, where
<span class="math inline">\(\mathcal{O}\)</span> always denotes the ring
of integers of <span class="math inline">\(E\)</span>.</em></p></li>
</ul>
<p><em>We also have a bijection between</em></p>
<ul>
<li><p><em><span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathcal{O}}(\mathbb{T}_{\mathcal{O}},
\mathbb{F})\)</span>, and</em></p></li>
<li><p><em>The set of <span class="math inline">\(\bar{\rho} :
G_{\mathbb{Q}} \rightarrow \mathrm{GL}_2(\mathbb{F})\)</span> that are
semisimple reductions from some <span
class="math inline">\(\rho_f\)</span>, with <span
class="math inline">\(f \in S_k(N)\)</span>.</em></p></li>
</ul>
<p><em><span class="math inline">\(\mathbb{T} &#39;\)</span> is a finite
free <span class="math inline">\(\mathcal{O}\)</span>-algebra. For any
<span class="math inline">\(\bar{\rho}\)</span>, we get a maximal ideal
<span class="math inline">\(\mathfrak{m}_{\bar{\rho}} \subseteq
\mathbb{T} &#39;_{\mathcal{O}}\)</span>. For a given <span
class="math inline">\(\bar{\rho}\)</span>, if we take <span
class="math display">\[(\mathbb{T}_{\mathcal{O}}&#39;)_{\mathfrak{m}_{\bar{\rho}}},\]</span>
then this is the relevant Hecke algebra for understanding the forms
congruent to <span class="math inline">\(\bar{\rho}\)</span>.</em></p>
</div>
<div id="theorem:cq6thpm721" class="theorem">
<p><strong>Theorem 10</strong> (Carayol, Serre). <em>Assume that <span
class="math inline">\(\bar{\rho}\)</span> is absolutely irreducible.
Then there exists a continuous representation <span id="eq:cq6sj6h73f" class="math display">\[\label{eq:cq6sj6h73f}\tag{1.1}
    \rho_{\bar{\rho}}^{\mathrm{mod}} : G_{\mathbb{Q}, N \cup \{p,
\infty\}} \rightarrow \mathrm{GL}_2 \left((\mathbb{T}_0
&#39;)_{\mathfrak{m}_{\bar{\rho}}} \right)\]</span> “built” from the
<span class="math inline">\(\rho_f\)</span>, for <span
class="math inline">\(f \in S_k(N, \bar{\mathbb{Z}}_p)\)</span>, with
<span class="math inline">\(\rho_f \equiv \bar{\rho}\)</span> modulo
<span
class="math inline">\(\mathfrak{m}_{\bar{\mathbb{Z}}_p}\)</span>.</em></p>
</div>
<p>(One can write down a characteristic polynomial, similar to the
above.) Maybe one should also say that <span id="eq:cq6sj6d3yn" class="math display">\[\label{eq:cq6sj6d3yn}\tag{1.2}
  \left( \mathbb{T} &#39;_{\mathcal{O}}
\right)_{\mathfrak{m}_{\bar{\rho}}} \subseteq \prod_{f, \rho_f \equiv
\bar{\rho}} \mathcal{O},\]</span> where the left hand side is generated
by all the <span class="math display">\[\left\{
\mathop{\mathrm{trace}}\rho_f({\mathop{\mathrm{Frob}}}_{\ell}) : \rho_f
\equiv \bar{\rho}, \ell \nmid N p \right\}.\]</span> Now, is the
inclusion <a href="#eq:cq6sj6d3yn" data-reference-type="eqref"
data-reference="eq:cq6sj6d3yn">\((1.2)\)</a> strict? If you take
twice the same form, then you get twice the same value.</p>
<p><strong>Vision of Mazur</strong>? Can <span
class="math inline">\(\rho_{\bar{\rho}}^{\mathrm{mod}}\)</span> be
characterized purely in terms of “Galois” theory, maybe at least once
<span class="math inline">\(\bar{\rho}\)</span> is given? You need to
start somewhere. Start with the mod <span
class="math inline">\(p\)</span> representation. Then there’s a sort of
<span class="math inline">\(p\)</span>-adic representation <a
href="#eq:cq6sj6h73f" data-reference-type="eqref"
data-reference="eq:cq6sj6h73f">\((1.1)\)</a> that you get here,
which sees all forms congruent to <span
class="math inline">\(\bar{\rho}\)</span>. Can you see this sort of
thing from a purely Galois-theoretic perspective? This might have been
the starting point for the study of deformations of Galois
representations. Mazur maybe had one example in mind: Hida had just
written down his Hida families, which are much bigger than things of
fixed weight and level.</p>
<p>Let’s now turn to <em>deformation functors</em>. In many ways, what
we’re doing now at the beginning is very formal, and maybe in the next
lecture it gets a bit more Galois-theoretic. Let <span
class="math inline">\(G\)</span> be a profinite group – think of some
global Galois group. Let <span class="math inline">\(E \supseteq
\mathcal{O} \rightarrow \mathbb{F}\)</span> be a local field, with
uniformizer <span class="math inline">\(\pi\)</span> and residue field
cardinality <span class="math inline">\(q\)</span>. In what natural
category do these <span
class="math inline">\(\mathcal{O}\)</span>-algebras <span
class="math inline">\(\mathbb{T}_{\mathcal{O}}&#39;\)</span> live?</p>
<div id="definition:cq6thpm6f8" class="definition">
<p><strong>Definition 11</strong>. <span class="math inline">\(\mathrm{C
N L }_{\mathcal{O}}\)</span> is the category of complete noetherian
<span class="math inline">\(\mathcal{O}\)</span>-algebras <span
class="math inline">\((A, \mathfrak{m}_{A})\)</span> with residue field
<span class="math inline">\(\mathbb{F}\)</span> and with local
homomorphisms.</p>
</div>
<p>Typical rings: <span class="math inline">\(\mathcal{O} [[ X_1,
\dotsc, X_r\rrbracket / I\)</span>. Some structure theorem tells you
that this is all you can get. There is a finite subcategory <span
class="math display">\[\mathrm{Ar}_{\mathcal{O}} \subseteq \mathrm{C N
L}_{\mathcal{O}}\]</span> consisting of Artin objects.</p>
<div id="question:cq6thpm42q" class="question">
<p><strong>Question 12</strong>. For <span
class="math inline">\(\bar{\rho} : G \rightarrow
\mathrm{GL}_n(\mathbb{F})\)</span>, when is the functor <span
class="math display">\[D_{\bar{\rho}} : \mathrm{C N L}_{\mathcal{O}}
\rightarrow \mathrm{Set}\]</span> <span class="math display">\[(A,
\mathfrak{m}_A) \mapsto \left\{ \rho_A : G \rightarrow \mathrm{GL}_n(A)
\mid \rho \mod{ \mathfrak{m}_A } \equiv \bar{\rho}\right\} /
\sim\]</span> representable by <span
class="math inline">\(R_{\bar{\rho}} \in \mathrm{C N
L}_{\mathcal{O}}\)</span>?</p>
</div>
<p>To fill in some terminology:</p>
<div id="definition:cq6thpm4aq" class="definition">
<p><strong>Definition 13</strong>. </p>
<ol type="a">
<li><p>For <span class="math inline">\(A \in \mathrm{C N
L}_{\mathcal{O}}\)</span>, set <span class="math display">\[F_A :=
{\mathop{\mathrm{Hom}}}_{\mathrm{C N L}_{\mathcal{O}}}(A, \bullet) :
\mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set}.\]</span></p></li>
<li><p>Say that a functor <span class="math inline">\(F : \mathrm{C N
L}_{\mathcal{O}} \rightarrow \mathrm{Set}\)</span> is</p>
<ol type="i">
<li><p><em>representable</em> if there exists <span
class="math inline">\(A \in \mathrm{C N L }_{\mathcal{O}}\)</span> such
that <span class="math inline">\(F \cong F_A\)</span>, and</p></li>
<li><p><em>continuous</em> if for all <span class="math inline">\((A,
\mathfrak{m}_A) \in \mathrm{C N L}_{\mathcal{O}}\)</span>, the map <span
class="math inline">\(F(A) \rightarrow \lim_{n} F(A /
\mathfrak{m}_A^n)\)</span> is an isomorphism.</p></li>
</ol></li>
</ol>
</div>
<div id="exercise:cq6thpm3gt" class="exercise">
<p><strong>Exercise 2</strong>. </p>
<ol type="a">
<li><p>The fiber product of the diagram <span
class="math inline">\(\Delta\)</span> given by <span
class="math display">\[\begin{CD}
        @. B \\
        @. @V{\psi}VV \\
        A @&gt;{\varphi}&gt;&gt; C
      \end{CD}\]</span> inside <span class="math inline">\(\mathrm{A
r}_{\mathcal{O}}\)</span> is <span class="math display">\[\left\{(a, b)
\in A \times B \mid \varphi(a) \equiv \psi(b)
\right\}.\]</span></p></li>
<li><p><span class="math inline">\(\mathrm{C N L}_{\mathcal{O}}\)</span>
"has no fiber products".</p></li>
</ol>
</div>
<div id="exercise:cq6thpm2ek" class="exercise">
<p><strong>Exercise 3</strong>. Suppose <span class="math inline">\(F =
F_A\)</span> for <span class="math inline">\(A \in \mathrm{C N
L}_{\mathcal{O}}\)</span>. Then</p>
<ol type="a">
<li><p><span class="math inline">\(F(\mathbb{F}) = \{\ast\}\)</span>,
and <span class="math inline">\(F\)</span> is continuous.</p></li>
<li><p>The Mayer–Vietoris property (MV) holds for <span
class="math inline">\(F\)</span>, i.e., for all diagrams <span
class="math inline">\(\Delta\)</span>, the induced map <span
class="math inline">\((\ast)_\Delta\)</span> is bijective, where <span
class="math display">\[(\ast)_\Delta : F(A \times_{C} B) \rightarrow
F(A) \times_{F(C)} F(B),\]</span> where on the right hand side, we take
the fiber product in <span
class="math inline">\(\mathrm{Set}\)</span>.</p></li>
</ol>
</div>
<div class="notation">
<p><strong>Notation 14</strong>. </p>
<ul>
<li><p><span id="itemize:cq6thpmzgo" label="itemize:cq6thpmzgo"></span>
<span class="math inline">\(\mathbb{F}[\varepsilon] := \mathbb{F}[X]
/(X^2)\)</span>.</p></li>
<li><p>Call <span class="math inline">\(\varphi : A \twoheadrightarrow A
&#39;\)</span> in <span
class="math inline">\(\mathrm{CNL}_{\mathcal{O}}\)</span> <em>small</em>
if <span class="math inline">\(\mathfrak{m}_{A&#39;}
\cdot(\ker(\varphi)) = 0\)</span>. (e.g., <span
class="math inline">\(\mathbb{F}[\varepsilon] \rightarrow
\mathbb{F}\)</span>)</p></li>
<li><p>For <span class="math inline">\(F : \mathrm{C N L}_{\mathcal{O}}
\rightarrow \mathrm{Set}\)</span>, define the <span
class="math inline">\(T_F := F(\mathbb{F}[\varepsilon])\)</span>, the
<em>tangent space</em> of <span
class="math inline">\(F\)</span>.</p></li>
</ul>
</div>
<p>You can translate this back into rings. Here are some more
exercises:</p>
<div id="exercise:cq6thpm07x" class="exercise">
<p><strong>Exercise 4</strong>. If the functor <span
class="math inline">\(F\)</span> satisfies</p>
<ul>
<li><p><span class="math inline">\(F(\mathbb{F}) = \{\ast\}\)</span>,
and</p></li>
<li><p><span class="math inline">\((\ast)_{T_F} :
F(\mathbb{F}[\varepsilon] \times_{\mathbb{F}} \mathbb{F}[\varepsilon])
\rightarrow T_F \times T_F\)</span> is bijective,</p></li>
</ul>
<p>then <span class="math inline">\(T_F\)</span> is an <span
class="math inline">\(\mathbb{F}\)</span>-vector space.</p>
</div>
<div id="example:cq6thpmybt" class="example">
<p><strong>Example 15</strong>. For <span class="math inline">\(F =
F_A\)</span>, we have <span class="math display">\[T_F =
{\mathop{\mathrm{Hom}}}_{\mathrm{C N L}_{\mathcal{O}}}(A,
\mathbb{F}[\varepsilon]) = {\mathop{\mathrm{Hom}}}_{\mathbb{F} } \left(
\mathfrak{m}_A /(\mathfrak{m}_{A}^2 , \pi), \mathbb{F} \right) =:
T_A.\]</span></p>
</div>
<div id="exercise:cq6thpmxcy" class="exercise">
<p><strong>Exercise 5</strong>. For <span class="math inline">\(\varphi
: A \rightarrow B\)</span> in <span class="math inline">\(\mathrm{C N
L}_{\mathcal{O}}\)</span>, the map <span
class="math inline">\(\varphi\)</span> is surjective if and only if
<span class="math inline">\(T_\varphi : T_B \rightarrow T_A\)</span> is
injective.</p>
</div>
<div id="theorem:cq6thper60" class="theorem">
<p><strong>Theorem 16</strong> (Grothendieck). <em>Suppose <span
class="math inline">\(F : \mathrm{C N L}_{\mathcal{O}} \rightarrow
\mathrm{Set}\)</span> is continuous, satisfies <span
class="math inline">\(F(\mathbb{F}) = \{\ast\}\)</span>, the MV-property
holds, and <span class="math inline">\(\dim_{\mathbb{F}} T_F &lt;
\infty\)</span>. Then <span class="math inline">\(F\)</span> is
representable.</em></p>
</div>
<div id="remark:cq6thpengd" class="remark">
<p><strong>Remark 17</strong>. For this last theorem, there are
simplifications by Schlessinger, <em>Functors of Artin rings</em>.
Schlessinger realized that these axioms of Grothendieck may be hard to
verify in concrete situations, so he gave a simple (but somewhat long)
list of axioms to verify. See Mazur ’87, and Gouvêa’s survey.</p>
</div>
<p>Let’s now turn to <em>Galois deformations functors</em>. We have our
usual <span class="math display">\[\bar{\rho} : G \rightarrow
\mathrm{GL}_n(\mathbb{F}).\]</span> We can do something about the
conjugation.</p>
<p><span class="math display">\[\Gamma_n(A) := \ker \left(
\mathrm{GL}_n(A) \rightarrow \mathrm{GL}_n(\mathbb{F}) \right).\]</span>
We define the <em>lifting</em> and <em>deformation</em> functors <span
class="math display">\[D_{\bar{\rho}}^{\square}, \, D_{\bar{\rho}} :
\mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set},\]</span> <span
class="math display">\[(A, \mathfrak{m}_A) \mapsto \left\{ \rho_A : G
\rightarrow \mathrm{GL}_n(A) \mid \rho_A \equiv \bar{\rho}
\mod{\mathfrak{m}_A} \right\}\]</span> (“lifting functor” or “framed
deformation functor”), and where for <span
class="math inline">\(D_{\bar{\rho}}\)</span>, we take things modulo
<span class="math inline">\(\Gamma_n(A)\)</span>-conjugacy (i.e.,
“deformations are lifts modulo conjugacy”).</p>
<div id="theorem:cq6thpeky4" class="theorem">
<p><strong>Theorem 18</strong>. <em>Suppose <span
class="math inline">\(\Phi_\rho\)</span> holds, i.e., <span
class="math inline">\(\# \mathop{\mathrm{Hom}}(G, \mathbb{F}_p) &lt;
\infty\)</span>. Then:</em></p>
<ol type="a">
<li><p><em><span class="math inline">\(D_{\bar{\rho}}\)</span> always
has a “hull”.</em></p></li>
<li><p><em>If <span
class="math inline">\({\mathop{\mathrm{End}}}_G(\bar{\rho}) =
\mathbb{F}\)</span>, then <span
class="math inline">\(D_{\bar{\rho}}\)</span> is representable (uses
Schlessinger). This gives rise to <span
class="math inline">\(R_{\bar{\rho}}\)</span>.</em></p></li>
<li><p><em><span id="enumerate:cq6skams6j"
label="enumerate:cq6skams6j"></span> (Always) <span
class="math inline">\(D_{\bar{\rho}}^{\square}\)</span> is representable
(Kisin, Magid–Lubotzki). Gives rise to <span
class="math inline">\(R_{\bar{\rho}}^{\square}\)</span>.</em></p></li>
</ol>
</div>
<p>Here <a href="#enumerate:cq6skams6j" data-reference-type="eqref"
data-reference="enumerate:cq6skams6j">\((c)\)</a> is an
exercise you can do.</p>
<div id="example:cq6thpeiz4" class="example">
<p><strong>Example 19</strong>. Take <span class="math inline">\(n =
1\)</span>. Le <span class="math inline">\(\bar{\rho} : G \rightarrow
\mathrm{GL}_1(\mathbb{F}) = \mathbb{F}^\times\)</span>.
<strong>Fact</strong> (Teichmüller lift): there exists <span
class="math inline">\(\hat{\rho} : G \rightarrow
\mathrm{GL}_1(W(\mathbb{F}))\)</span>, a lift of <span
class="math inline">\(\bar{\rho}\)</span> such that <span
class="math inline">\(\hat{\rho}(G) \xrightarrow{\mathrm{red}}
\bar{\rho}(G)\)</span>.</p>
</div>
<div id="exercise:cq6thpehqo" class="exercise">
<p><strong>Exercise 6</strong>. Suppose that <span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathrm{cts}}(G^{\mathrm{ab}},
\mathbb{F})\)</span> is finite. Then the universal deformation ring
<span class="math inline">\(R_{\bar{\rho}}\)</span> (which for <span
class="math inline">\(n = 1\)</span> is the same as the universal
lifting ring <span
class="math inline">\(R_{\bar{\rho}}^{\square}\)</span>) is isomorphic
to <span class="math display">\[\mathcal{O} [[(G^{\mathrm{ab}})_p
\rrbracket = \varprojlim
    \mathcal{O} \left[(G^{\mathrm{a b}})_p \right].\]</span> The
universal lifting is <span class="math display">\[\hat{\rho} \otimes
\left( G \rightarrow(G^{\mathrm{a b}})_p
      \hookrightarrow
      \mathcal{O} [[(G^{\mathrm{a b}})_p \rrbracket^\times.
    \right)\]</span></p>
</div>
<p>Special cases:</p>
<ol type="i">
<li><p><span id="enumerate:cq6skmixcf"
label="enumerate:cq6skmixcf"></span> <span class="math inline">\(G =
G_F\)</span>, <span class="math inline">\(F \supseteq
\mathbb{Q}_p\)</span> finite extension, then by local class field
theory, <span class="math display">\[(G^{\mathrm{a b}})_p \cong
\mu_{p^\infty}(F) \times \mathbb{Z}^{1 +[F :
\mathbb{Q}_p]}.\]</span></p></li>
<li><p><span id="enumerate:cq6skmix6w"
label="enumerate:cq6skmix6w"></span> <span class="math inline">\(G =
G_{K, S}\)</span>, <span class="math inline">\(S \supseteq
S_{\mathfrak{p}}\)</span> finite, then global class field theory gives
<span class="math display">\[(G^{\mathrm{a b}})_p \cong \frac{A_{K,
S}}{\text{finite $p$-group}}
    \times \mathbb{Z}_p^{r_2 + \delta},\]</span> where <span
class="math inline">\(r_2\)</span> denotes the number of complex places
and <span class="math inline">\(\delta = \delta_{K, p}\)</span> is the
<em>Leopoldt defect</em>, which the Leopoldt conjecture says is
zero.</p></li>
</ol>
<p>We turn to cohomology. For <span class="math inline">\(\bar{\rho} : G
\rightarrow \mathrm{GL}_n(\mathbb{F})\)</span>, define <span
class="math display">\[{\mathop{\mathrm{ad}}}_{\bar{\rho}} = M_{n \times
n}(\mathbb{F})\]</span> with the “adjoint action”: for <span
class="math inline">\(g \in A\)</span> and <span
class="math inline">\(\alpha \in M_{n \times n}\)</span>, we take <span
class="math display">\[g \cdot \alpha := \bar{\rho}(g) \cdot \alpha
\cdot \bar{\rho}(g)^{-1}.\]</span> (We remark that <span
class="math inline">\({\mathop{\mathrm{ad}}}_{\bar{\rho}} \cong \bar{\rho}
\otimes \bar{\rho}^\vee\)</span>.)</p>
<div id="proposition:cq6thpeed2" class="proposition">
<p><strong>Proposition 20</strong>. <em></em></p>
<ol type="a">
<li><p><em>We have <span class="math inline">\(T_{D_\rho^{\square}} =
D_{\bar{\rho}}^{\square}(\mathbb{F}[\varepsilon]) \xleftarrow{\cong}
Z^1(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span>, where the map sends
a cocycle <span class="math inline">\(c : G \rightarrow
{\mathop{\mathrm{ad}}}_{\bar{\rho}}\)</span> to <span
class="math display">\[\rho_c : g \mapsto(1 + \varepsilon c(g))
\bar{\rho}(g).\]</span></em></p></li>
<li><p><em>The above map induces an isomorphism <span
class="math inline">\(H^1(G, \mathop{\mathrm{ad}}\bar{\rho})
\xrightarrow{\cong} T_{D_{\bar{\rho}}}\)</span>.</em></p></li>
<li><p><em>We have <span class="math inline">\(\dim B^1(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}}) = h^2 - h^0(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span>. (We use the notation <span
class="math inline">\(h^i := \dim H^i\)</span> and <span
class="math inline">\(z^i = \dim Z^i\)</span>.)</em></p></li>
</ol>
</div>
<div id="corollary:cq6thpefo9" class="corollary">
<p><strong>Corollary 21</strong>. <em>For <span class="math inline">\(r
= h^1(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span>, <span
class="math inline">\(r^{\square} = z^1(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span>, we have surjections <span
class="math display">\[\mathcal{O} [[ X_1, \dotsc, X_r \rrbracket
\rightarrow R_{\bar{\rho}}\]</span> and <span
class="math display">\[\mathcal{O} [[ X_1, \dotsc, X_{r^{\square}}
\rrbracket \rightarrow R_{\bar{\rho}}^{\square},\]</span> and <span
class="math inline">\(r\)</span>, <span
class="math inline">\(r^{\square}\)</span> are optimal.</em></p>
</div>
<p>What’s the relevance of <span class="math inline">\(H^2\)</span>? Let
<span class="math inline">\(\varphi : A^1 \rightarrow A\)</span> be a
small extension, and let <span class="math inline">\(I :=
\ker(\varphi)\)</span>.</p>
<div id="question:cq6thpebye" class="question">
<p><strong>Question 22</strong>. Is the map <span
class="math inline">\(D_{\bar{\rho}}(A&#39;) \rightarrow
D_{\bar{\rho}}(A)\)</span> surjective?</p>
</div>
<p>Let <span class="math inline">\(\rho_A : G \rightarrow
\mathrm{GL}_n(A)\)</span> be as in the right hand side.</p>
<div id="fact:cq6thpec2o" class="fact">
<p><strong>Fact 23</strong>. <em>There exists a set-theoretic lift <span
class="math inline">\(\rho &#39; : G \rightarrow
\mathrm{GL}_n(A&#39;)\)</span> of <span
class="math inline">\(\rho_A\)</span> (i.e., <span
class="math inline">\(\varphi \circ \rho &#39; =
\rho_A\)</span>).</em></p>
</div>
<div id="definition:cq6thpeaqx" class="definition">
<p><strong>Definition 24</strong>. Set <span
class="math display">\[c_{\rho &#39;} : G \times G \rightarrow
{\mathop{\mathrm{ad}}}_{\bar{\rho}} \otimes_{\mathbb{F}} I,\]</span> <span
class="math display">\[(g, h) \mapsto(\rho &#39;(g, h) \cdot \rho
&#39;(h)^{-1} \cdot \rho &#39;(g)^{-1}),\]</span> where this last
quantity lies in <span class="math inline">\(1 + M_{n \times
n}(I)\)</span>. We note that <span
class="math inline">\(({\mathop{\mathrm{ad}}}_{\bar{\rho}}
\otimes_{\mathbb{F}} I) \cong M_{n \times n}(I)\)</span>. To get back,
subtract <span class="math inline">\(1\)</span>.</p>
</div>
<div id="proposition:cq6thpd7zv" class="proposition">
<p><strong>Proposition 25</strong>. <em></em></p>
<ol type="a">
<li><p><em><span id="enumerate:cq6sknji3b"
label="enumerate:cq6sknji3b"></span> <span class="math inline">\(c_{\rho
&#39;} \in Z^2(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}} \otimes I)\)</span>,
<span class="math inline">\(\mathrm{Obs}(\rho_A, \varphi) =[ c_{\rho
&#39;} ] \in H^2(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}} \otimes
I)\)</span> is independent of <span class="math inline">\(\rho
&#39;\)</span>!</em></p></li>
<li><p><em><span id="enumerate:cq6sknjiey"
label="enumerate:cq6sknjiey"></span> We have <span
class="math inline">\(\mathrm{Obs}(\rho_A, \varphi) = 0\)</span> if and
only if there exists <span class="math inline">\(\rho_{A&#39;} \in
D_{\bar{\rho}}(A&#39;)\)</span> lifting <span
class="math inline">\(\rho\)</span>.</em></p></li>
</ol>
</div>
<p>We give a proof of <a href="#enumerate:cq6sknjiey"
data-reference-type="eqref"
data-reference="enumerate:cq6sknjiey">\((b)\)</a>. If
<span class="math inline">\(c_{\rho &#39;} = \partial^2 f\)</span> for
some <span class="math inline">\(f : G \rightarrow
{\mathop{\mathrm{ad}}}_{\bar{\rho}} \otimes I\)</span>, then you can check
that if you take your <span class="math inline">\(\rho &#39;\)</span>
and multiply it on the left with <span class="math inline">\(1 +
f\)</span>, we get an element <span class="math inline">\((1 + f) \rho
&#39; : G \rightarrow \mathrm{GL}_n(A&#39;)\)</span> that is a lift of
<span class="math inline">\(\rho_A\)</span> (to <span
class="math inline">\(D_{\bar{\rho}}^{\square}(A&#39;)\)</span>).</p>
<p>Mazur observed that you can do something with this obstruction
theory: you can prove something more about these projections on the top
line here. But you have a very coarse control over the kernel ideal
<span class="math inline">\(I\)</span> of the surjection.</p>
<div id="theorem:cq6thpd9ja" class="theorem">
<p><strong>Theorem 26</strong>. <em>Consider <span
class="math inline">\(\mathcal{R}  = \mathcal{O} [[  X_1, \dotsc, X_r
\rrbracket\)</span> projecting via something called <span
class="math inline">\(\pi\)</span> to <span
class="math inline">\(R_{\bar{\rho}}\)</span> (<span
class="math inline">\(r = h&#39;(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}}
1)\)</span>), with kernel <span class="math inline">\(J\)</span>. Then
<span class="math display">\[\mathcal{R} / \mathfrak{m}_{\mathcal{R}} J
\rightarrow R_{\bar{\rho}}\]</span> is small with kernel <span
class="math inline">\(J / \mathfrak{m}_{\mathcal{R}} J\)</span>, and
<span class="math display">\[\mathrm{o b} : \mathop{\mathrm{Hom}}(J /
\mathfrak{m}_R J, \mathbb{F}) \cong H^2(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}}),\]</span> <span
class="math display">\[\psi \mapsto(1 \otimes \psi) \operatorname{o b s}
\left( \rho_{\bar{\rho}}^{\mathrm{univ}}, \pi \right)\]</span> is
injective!</em></p>
</div>
<div id="corollary:cq6thpd6nv" class="corollary">
<p><strong>Corollary 27</strong>. <em>With <span
class="math inline">\(r, r^{\square}\)</span> from above and <span
class="math inline">\(s = h^2(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}})\)</span> have presentations <span
class="math inline">\(R_{\bar{\rho}} := \mathcal{O} [[ x_1, \dotsc,
x_{r^{\square}} ]] /(f_1, \dotsc, f_s)\)</span>.</em></p>
</div>
<div id="definition:cq6thpd4m6" class="definition">
<p><strong>Definition 28</strong> (ad hoc). The <em>expected
cohomological dimension</em> is <span
class="math display">\[\operatorname{e c d} \operatorname{i
m}(\bar{\rho}) = z^1(G, {\mathop{\mathrm{ad}}}_{\bar{\rho}}) - h^2(G,
{\mathop{\mathrm{ad}}}_{\bar{\rho}}) = h^2 - \sum_{i = 0}^2(-1)^{i} h^i(G,
\mathop{\mathrm{ad}}\bar{\rho}).\]</span></p>
</div>
<div id="proposition:cq6thpd5k9" class="proposition">
<p><strong>Proposition 29</strong>. <em>If <span id="eq:cq6skreori" class="math display">\[\label{eq:cq6skreori}\tag{1.3}
    \dim_{\mathrm{\operatorname{s}}} R \frac{\square}{\rho} / \pi \leq
\mathrm{ec dim(\bar{\rho})},\]</span> then <span
class="math inline">\(R_{\bar{\rho}}^{\square}\)</span> is <span
class="math inline">\(0\)</span>-flat, of relative dimension <span
class="math inline">\(\operatorname{e c dim}(\bar{\rho})\)</span> over
<span class="math inline">\(\mathcal{O}\)</span>, and a complete
intersection.</em></p>
</div>
<div id="example:cq6thpd1g4" class="example">
<p><strong>Example 30</strong>. </p>
<ol type="a">
<li><p><span class="math inline">\(G = G_F\)</span>, where <span
class="math inline">\(F \supseteq \mathbb{Q}_{\ell}\)</span> is finite
and <span class="math inline">\(\ell \neq p\)</span>. Then <a
href="#eq:cq6skreori" data-reference-type="eqref"
data-reference="eq:cq6skreori">\((1.3)\)</a> holds. <span
class="math inline">\(\mathrm{e c dim} = 4^2\)</span>.</p></li>
<li><p><span class="math inline">\(G = G_F\)</span>, <span
class="math inline">\(F \supseteq \mathbb{Q}_p\)</span>. Then <a
href="#eq:cq6skreori" data-reference-type="eqref"
data-reference="eq:cq6skreori">\((1.3)\)</a> holds and each <span
class="math inline">\(\operatorname{ec dim} = n^2(1 +[F :
\mathbb{Q}_p])\)</span>.</p></li>
<li><p>If <span class="math inline">\(G = G_{K, S}\)</span>, then we
have many examples for <a href="#eq:cq6skreori"
data-reference-type="eqref"
data-reference="eq:cq6skreori">\((1.3)\)</a> if <span
class="math inline">\(k\)</span> is not totally real, <span
class="math inline">\(k\)</span> is totaly odd, and <span
class="math inline">\(\bar{\rho}\)</span> is totally odd, and <span
class="math inline">\(n \geq 2\)</span>. (Have to be careful. Use that
<span class="math inline">\(S \supseteq S_\infty \cup S_p sup
\dotsb\)</span>)</p></li>
<li><p>We have <span class="math display">\[\dim_{\mathrm{Krull}}
R_{\bar{\rho}}^n / \pi \leq \operatorname{ecdim}(\bar{\rho})\]</span>
for <span class="math inline">\(G = G_{K, S}\)</span>, with <span
class="math inline">\(G\)</span> and <span class="math inline">\(G_{K,
S}\)</span>, if and only if <span class="math inline">\(\delta =
0\)</span>.</p></li>
</ol>
</div>
<div id="remark:cq6thpd214" class="remark">
<p><strong>Remark 31</strong>. To avoid the reliance on <span
class="math inline">\(\delta = 0\)</span> (often) by fixing a lift <span
class="math inline">\(\mu : G \rightarrow
\mathcal{O}^\times\)</span>.</p>
</div>
<p><em>Mazur’s vision</em>: for <span class="math inline">\(v \in
S\)</span>, define “geometric” subfunctors <span
class="math inline">\(D_v^{\square} \subseteq D_{\bar{\rho} / G_{K,
v}}^{\square}\)</span> and the pullback in <span
class="math inline">\((\underline{S} =(\bar{\rho}, S,(D_v^0)_{v \in
S}))\)</span> to get a diagram involving, for <span
class="math inline">\(G = G_{k , S}\)</span>, <span
class="math display">\[D_{\bar{\rho}}^{\square} \rightarrow \sqcup_{v
\in S} D_{\bar{\rho} \mid G_v}^{\square}\]</span> and <span
class="math display">\[D_{\underline{S}}^{\square} \rightarrow \sqcup_{v
\in S} D_v^{\square}.\]</span></p>
<p>Removing frames at right point, we get a <span
class="math display">\[R_{\mathcal{I}} \twoheadleftarrow
R_{\bar{\rho}}.\]</span></p>
<div id="question:cq6thpc16r" class="question">
<p><strong>Question 32</strong>. Can we choose <span
class="math inline">\(\mathcal{I}\)</span> in such a way that some
natural map <span class="math display">\[R_{\rho} \rightarrow
\mathbb{T}_k(N, \varepsilon,
\mathcal{O})_{\mathfrak{m}_{\bar{\rho}}}\]</span> is an isomorphism?</p>
</div>
<p>We turn now to <em>local deformation problems</em>. How to get a more
geometric side of deformation rings? Fix <span
class="math display">\[\bar{\rho} : G_{K, S} \rightarrow
\mathrm{GL}_n(\mathbb{F}).\]</span> Write <span
class="math inline">\(\bar{\rho}_v := \bar{\rho} \mid_{G_v}\)</span>.
Fix a character <span class="math inline">\(\mu : G_{K, S} \rightarrow
\mathcal{O}^\times\)</span> lifting <span class="math inline">\(\det
\bar{\rho}\)</span>. Our next aim is to identify interesting special
loci in <span class="math display">\[X_{\bar{\rho}_v}^{\square} :=
\mathop{\mathrm{Spec}}(R_{\bar{\rho}_v}^{\square}).\]</span></p>
<div id="definition:cq6thpcze8" class="definition">
<p><strong>Definition 33</strong> (Thorne, who gave a compact
description). A <em>local deformation problem</em> is a subfunctor <span
class="math inline">\(D_v \subseteq D_{\bar{\rho}_v}^{\square,
\mu_v}\)</span> (possibly with fixed determinant, i.e., <span
class="math inline">\(\det(\rho) = \mu\)</span> – that’s what the
superscripted <span class="math inline">\(\mu_v\)</span> means) such
that</p>
<ol>
<li><p><span id="enumerate:cq6s0pdihm"
label="enumerate:cq6s0pdihm"></span> <span class="math inline">\(D_v
\cong F_{R_v}\)</span> for a quotient <span
class="math inline">\(R_v\)</span> of <span
class="math inline">\(R_{\bar{\rho}_v}^{\square, \mu}\)</span>.</p></li>
<li><p><span id="enumerate:cq6s0pgpcr"
label="enumerate:cq6s0pgpcr"></span> For all <span
class="math inline">\(A \in \mathrm{CNL}_{\mathcal{O}}\)</span> and
<span class="math inline">\(g \in \Gamma_n(A)\)</span>, <span
class="math display">\[\rho \in D_v(A) \implies g \rho g^{-1} \in
D_v(A).\]</span></p></li>
</ol>
</div>
<div class="remark">
<p><strong>Remark 34</strong>. <span
class="math inline">\(\Gamma_n(R_{\bar{\rho}_v^{\square}})\)</span> acts
by conjugation on <span
class="math inline">\(D_{\bar{\rho}_v}^{\square}(R_{\bar{\rho}_v}^{\square})\)</span>,
and hence (by universality of <span
class="math inline">\(R_{\bar{\rho}_v}^{\square}\)</span>), it acts on
<span class="math inline">\(R_{\bar{\rho}_v}^{\square}\)</span>.</p>
</div>
<div id="proposition:cq6thpcxtk" class="proposition">
<p><strong>Proposition 35</strong> (BLGHT, Potential Automorphy 2, Lemma
3.2). <em>Let <span class="math inline">\(R_v\)</span> be a quotient
<span class="math inline">\(R_{\bar{\rho}_v}^{\square, \mu}
\xrightarrow{\alpha_v} R_v\)</span> such that</em></p>
<ol type="a">
<li><p><em><span id="enumerate:cq6s0pxwwm"
label="enumerate:cq6s0pxwwm"></span> <span
class="math inline">\(\ker(\alpha_v)\)</span> is invariant under <span
class="math inline">\(\Gamma_n(R_{\bar{\rho}_v}^{\square})\)</span>,
and</em></p></li>
<li><p><em><span id="enumerate:cq6s0pxv8b"
label="enumerate:cq6s0pxv8b"></span> <span
class="math inline">\(R_v\)</span> is reduced and not isomorphic to
<span class="math inline">\(\mathbb{F}\)</span>.</em></p></li>
</ol>
<p><em>Then <span class="math inline">\(F_{R_v} \subseteq
D_{\bar{\rho}_v}^{\square}\)</span> is a local deformation
problem.</em></p>
</div>
<p><strong>Construction of the</strong> <span
class="math inline">\(R_v&#39;s\)</span>? <strong>(Kisin)</strong>: Let
<span class="math inline">\(X_v \subseteq
X_{\bar{\rho}_v}^{\square}(\bar{\mathbb{Q}}_p)\)</span> be <span
class="math inline">\(\Gamma_n(\bar{\mathbb{Q}}_p)\)</span>-invariant.
Each <span class="math inline">\(x \in
X_{\bar{\rho}_v}^{\square}(\bar{\mathbb{Q}}_p)\)</span> gives a map
<span class="math display">\[\rho_x : G_v \rightarrow
\mathrm{GL}_n(\bar{\mathbb{Q}}_p),\]</span> and also <span
class="math display">\[\alpha_x : R_{\bar{\rho}_v}^{\square} \rightarrow
\bar{\mathbb{Q}}_p.\]</span> Then <span class="math display">\[J :=
\cap_{x \in X_v} \ker(\alpha_x)\]</span> is <span
class="math inline">\(\Gamma_n(R_{\bar{\rho}_v}^{\square})\)</span>-invariant.
(Need to check whether condition <a href="#enumerate:cq6s0pxv8b"
data-reference-type="eqref"
data-reference="enumerate:cq6s0pxv8b">\((b)\)</a> above
holds to get the local deformation problem, but at least there is a good
starting point for something.) You can define some <span
class="math display">\[R_{X_v} := R_{\bar{\rho}_v}^{\square} /
I.\]</span> Then <span
class="math inline">\(\mathop{\mathrm{Spec}}R_{X_v}\)</span> “is” the
schematic closure of <span class="math inline">\(X_v\)</span> in <span
class="math inline">\(X_{\bar{\rho}_v}^{\square}\)</span>.</p>
<p>For a classification of the <span class="math inline">\(\rho : G_v
\rightarrow \mathop{\mathrm{GL}}(V)\)</span> with <span
class="math inline">\(V \simeq \bar{\mathbb{Q}}_p^n\)</span>, with <span
class="math inline">\(v \neq \infty\)</span> and <span
class="math inline">\(\ell = \operatorname{char}(v) \neq p\)</span>, use
the <strong>Grothendieck monodromy theorem</strong>. Choose a surjection
<span class="math display">\[t_p : I_v \rightarrow I_v^{\mathrm{tame}}
\simeq \hat{\mathbb{Z}}^{(\ell)} \xrightarrow{\text{surj}}
\mathbb{Z}_p.\]</span></p>
<ol type="a">
<li><p><span id="enumerate:cq6s0sm0js"
label="enumerate:cq6s0sm0js"></span> There is a unique <span
class="math inline">\(N = N_\rho \in
\operatorname{End}_{\bar{\mathbb{Q}}_p}(V)\)</span> and an open subgroup
<span class="math inline">\(I \subseteq I_v\)</span> so that <span
class="math display">\[\rho \mid_I = \exp \left(
      t_p(\bullet) N
    \right) \mid_I.\]</span></p></li>
<li><p><span id="enumerate:cq6s0sm7x5"
label="enumerate:cq6s0sm7x5"></span> For <span
class="math inline">\(N\)</span> from <a href="#enumerate:cq6s0sm0js"
data-reference-type="eqref"
data-reference="enumerate:cq6s0sm0js">\((a)\)</a>, <span
class="math display">\[r = r_\rho : I_v \rightarrow
\mathrm{GL}(V),\]</span> <span class="math display">\[g \mapsto \rho(g)
\exp(- t_p(\bullet) N)\]</span> is a continuous representation with
finite image. Call <span class="math display">\[\tau =(r, N) = \mathrm{W
D}(\rho)\]</span> the (inertial) Galois type of <span
class="math inline">\(\rho\)</span>.</p></li>
</ol>
<p>Let <span class="math display">\[X_\tau := \left\{ x \in
X_{\bar{\rho}_v}^{\square}(\bar{\mathbb{Q}}_p) \mid \mathrm{WD}(\rho)
\simeq \tau \right\}.\]</span> Note that <span class="math display">\[\#
\left\{ \tau \mid \tau \text{ arises from }
X_{\bar{\rho}_v}^{\square}(\bar{\mathbb{Q}}_p) \right\}_{/ \cong}
  &lt; \infty.\]</span> Define <span
class="math display">\[R_{\bar{\rho}_v}^{\square, \tau} := R_{X_\tau}
\twoheadleftarrow R_{\bar{\rho}_v}^{\square}.\]</span></p>
<div id="theorem:cq6thpcsuh" class="theorem">
<p><strong>Theorem 36</strong> (Sholton, Proposition 3.6). <em></em></p>
<ol type="a">
<li><p><em><span id="enumerate:cq6s0szq5l"
label="enumerate:cq6s0szq5l"></span> <span
class="math inline">\(R_{\bar{\rho}_v}^{\square, \tau}\)</span> defines
a local deformation problem at <span
class="math inline">\(v\)</span>.</em></p></li>
<li><p><em><span id="enumerate:cq6s0szrtp"
label="enumerate:cq6s0szrtp"></span> <span
class="math inline">\(\mathop{\mathrm{Spec}}(R_{\bar{\rho}_v}^{\square,
\tau})\)</span> is a union of irreducible components of <span
class="math inline">\(X_{\bar{\rho}_v}^{\square}\)</span>, and
equidimensional (<span
class="math inline">\(n^2\)</span>).</em></p></li>
<li><p><em><span id="enumerate:cq6s0s13y6"
label="enumerate:cq6s0s13y6"></span> <span
class="math inline">\(R_{\bar{\rho}_v}^{\square,
\tau}[\tfrac{1}{p}]\)</span> is reduced, contains a dense set of
(generic) smooth points.</em></p></li>
</ol>
</div>
<p><strong>Warning</strong> (depending upon how much you are interested
in singularities of schemes, or not): <span
class="math inline">\(R_{\bar{\rho}_v}^{\square}\)</span> is a complete
intersection, but the components <span
class="math inline">\(R_{\bar{\rho}_v}^{\square, \tau}\)</span> can
apparently have much worse singularieties – they need not even be
Cohen–Macaulay.</p>
<p>Let’s say a bit about the case <span class="math inline">\(v \mid
p\)</span>, where things get a bit vaguer. Now take <span
class="math inline">\(K_v \supseteq \mathbb{Q}_p\)</span> finite, and
consider the set of all representations <span id="eq:cq6s0s7n4f" class="math display">\[\label{eq:cq6s0s7n4f}\tag{1.4}
  \left\{ \rho : G_v \rightarrow \mathrm{GL}_n(\bar{\mathbb{Q}}_p)
\right\}.\]</span> By <span class="math inline">\(p\)</span>-adic Hodge
theory, this contains the following set of representations that are
“geometric” in some sense: <span id="eq:cq6s0s8j3o" class="math display">\[\label{eq:cq6s0s8j3o}\tag{1.5}
  \left\{ \rho : G_v \rightarrow \mathrm{GL}_n(\bar{\mathbb{Q}}_p) \mid
\rho \text{ is potentially semistable}\right\}.\]</span> Fontaine
attaches invariants to these <span
class="math inline">\(\rho\)</span>’s. One thing he attaches is a Galois
type <span class="math display">\[\operatorname{WD}(\rho) =(r_\rho,
N_\rho),\]</span> although in a very different way than before: in this
case, where <span class="math inline">\(K_v\)</span> is a <span
class="math inline">\(p\)</span>-adic field, the pro-<span
class="math inline">\(p\)</span>-part of the inertia is not this
harmless <span class="math inline">\(\mathbb{Z}_p\)</span>, but is
instead a huge group that can be complicated, so one really needs to use
<span class="math inline">\(p\)</span>-adic Hodge theory to get
something here. Here, as before, <span
class="math inline">\(N_\rho\)</span> is a nilpotent operator and <span
class="math inline">\(r_\rho : I_v \rightarrow
\mathrm{GL}_n(\bar{\mathbb{Q}}_p)\)</span> is a finite-dimensional
representation. Fontaine also attaches a set of Hodge–Tate weights <span
class="math display">\[\nu = \underline{\mathrm{H T}}(\rho) = \left\{
\mathrm{H T}_{\iota} \right\}_{\iota : K_v \rightarrow
\bar{\mathbb{Q}}_p}.\]</span> We attach some <span
class="math display">\[X_{\tau, \nu} = \left\{ \rho : G_v \rightarrow
\mathrm{GL}_n(\bar{\mathbb{Q}}_p) \text{ potentially semistable } \mid
    \operatorname{W D}(\rho) \simeq \tau,
    \,
    \underline{\operatorname{H T}}(\rho) = \nu
  \right\}.\]</span> Kisin then attaches potentially semistable
deformation rings <span class="math inline">\(R_{\bar{\rho}_v}^{\square,
\tau, \nu}\)</span>.</p>
<div id="remark:cq6thpcqah" class="remark">
<p><strong>Remark 37</strong>. If <span class="math inline">\(n =
2\)</span> and <span class="math inline">\(K = \mathbb{Q}\)</span>, and
if you somehow have <span class="math inline">\(\mathrm{H
T}\)</span>-weights <span class="math inline">\(\nu =(k = 1,
0)\)</span>, <span class="math inline">\(k\)</span> “small”, (<span
class="math inline">\(k \geq 2\)</span>), <span
class="math inline">\(\tau = (\mathrm{triv}, 0)\)</span> (giving rise to
<span class="math inline">\(\rho\)</span> crystalline), then <span
class="math display">\[R_{\bar{\rho}_p}^{\square, \nu, \tau} \simeq
\mathcal{O} [[ X_1, \dotsc, X_5]].\]</span> (Alternative: use ordinary
deformation rings.)</p>
</div>
<p><strong>Global deformation rings</strong>. Fix <span
class="math inline">\(f \in S_k(N, \varepsilon, \mathbb{F})\)</span>,
take <span class="math inline">\(E\)</span> sufficiently large. We get
<span class="math display">\[\bar{\rho} : G_{\mathbb{Q}, N p \infty}
\rightarrow \mathrm{GL}_2(\mathbb{F}).\]</span> We found <span
class="math display">\[\mathfrak{m}_{\bar{\rho}} \leq
\mathbb{T}_{\mathfrak{o}} \rightsquigarrow
\rho_{\bar{\rho}}^{\mathrm{mod}} : G_{\mathbb{Q}, N p \infty}
  \rightarrow \mathrm{GL}_2
\left((\mathbb{T}_{\mathcal{O}})_{\mathfrak{m}_p} \right).\]</span> Now,
for the ramified primes <span class="math inline">\(\ell \mid N
p\)</span>, local Langlands gives a list <span
class="math inline">\(T_{\ell}\)</span> of Galois types that arise from
(forms parametrized by) <span
class="math inline">\((\mathbb{T}&#39;_{\mathcal{O}})_{\mathfrak{m}_{\bar{\rho}}}\)</span>.
At <span class="math inline">\(p\)</span>, you also get <span
class="math inline">\(\mathrm{H T}\)</span>-weights <span
class="math inline">\((k - 1, 0)\)</span> (papers of Faltings and of
Saito). From this dta, you now get a local deformation problem <span
class="math display">\[D_{\ell} = D_{\bar{\rho}_{\ell}}^{\square,
T_{\ell}} \subseteq D_{\bar{\rho}_{\ell}}^{\square}
  \quad \text{and} \quad
  D_{\bar{\rho}_p}^{\square, T_p, \nu}.\]</span> You form the pullback
functor for a list <span class="math display">\[\underline{S}
=(\bar{\rho}, N, S,(D_{\ell})_{\ell \mid N p}),\]</span> where <span
class="math inline">\(S\)</span> is the divisor of <span
class="math inline">\(N p \infty\)</span>. (Let’s suppose <span
class="math inline">\(p &gt; 2\)</span>.) Get a restriction from global
to local: <span class="math display">\[D_{\bar{\rho}}^{\square, \mu}
  \xrightarrow{\mathop{\mathrm{res}}}
  \prod_{\ell \mid N p}
  D_{\bar{\rho}_{\ell}}^{\square, \mu}.\]</span></p>
<p><span class="math display">\[\begin{CD}         
    D_{\bar{\rho}}^{\square, \mu} @&gt; \mathop{\mathrm{res}}&gt;&gt;
\prod_{\ell \mid N p}
    D_{\bar{\rho}_{\ell}}^{\square, \mu}\\
    @AAA  @AAA \\
    D_{\underline{S}}    @&gt;&gt;&gt; \prod_{\ell \mid N p} D_{\ell}\\
  \end{CD}\]</span> which gives rise to <span
class="math inline">\(R_{\underline{S}}\)</span> as a quotient of <span
class="math inline">\(R_{\bar{\rho}}^{\square, \mu}\)</span>, with <span
class="math display">\[\rho_{\underline{S}}^{\mathrm{univ}} :
G_{\mathbb{Q}, N p \infty} \rightarrow
\mathrm{GL}_2(R_{\underline{S}}).\]</span> Universality of <span
class="math inline">\(R_{\underline{S}}\)</span> (using local Langlands
and <span class="math inline">\(p\)</span>-adic Hodge theory) gives a
surjection <span id="eq:cq6s0uhkx2" class="math display">\[\label{eq:cq6s0uhkx2}\tag{1.6}
  \alpha : R_{\underline{S}}
\rightarrow(\mathbb{T}_{\mathcal{O}})_{\mathfrak{m}_{\bar{\rho}}},\]</span>
<em>assuming</em> that <span class="math inline">\(\bar{\rho}\)</span>
is absolutely irreducible.</p>
<div id="conjecture:cq6thpclm1" class="conjecture">
<p><strong>Conjecture 38</strong>. <em><span
class="math inline">\(\alpha\)</span> is an isomorphism under suitable
hypothesis.</em></p>
</div>
<p>The hope is that one can find a Galois-theoretic representation that
completely describes this thing coming from automorphic representations.
This was all first put into some definite form by Wiles and Taylor–Wiles
in their proof of Fermat’s last theorem. Their work gave the first great
supply of such isomorphisms. Then there was
Breuil–Conrad–Diamond–Taylor, proving Taniyama–Shimura–Weil conjecture.
Then there was Clozel–Harris–Taylor, and Khare–Winterberger proving the
Serre conjecture. One thing about why this thing could be important, and
why it was important in many of these cases. What helps you sometimes is
that being modular is “contagious”. What is often relatively easy, maybe
if the representation (a <span class="math inline">\(p\)</span>-adic
Galois representation) comes from the ring on the left hand side of <a
href="#eq:cq6s0uhkx2" data-reference-type="eqref"
data-reference="eq:cq6s0uhkx2">\((1.6)\)</a>, and now if you have
the full isomorphism <a href="#eq:cq6s0uhkx2"
data-reference-type="eqref"
data-reference="eq:cq6s0uhkx2">\((1.6)\)</a>, then you know it
also comes form the right hand side. But in practice, this isomoprhism
doesn’t tell you modularity of one just form in the class giving rise to
the right hand side, but all of them. That’s all.</p>
<h1 id="sec:cq6tho1vem">§2. Chris Skinner’s lectures</h1>
<p><strong>Integral representations, Euler systems, and multiplicity
one</strong>.</p>
<p>My choice of these topics is motivated by my interest in special
values of <span class="math inline">\(L\)</span>-functions, and in
particular problems like the BSD conjecture. We’ll focus on some
representation theory, that plays a role in both the analytic and the
algebraic sides of these problems. You can possibly view this as a
bridge between the talks at the start and at the end of the week.</p>
<p>Let’s start by talking about <em>integral representations</em>. It’s
helpful to think <span class="math display">\[\text{$L$-function} =
  \int_{\text{symmetric space } X}
  (\text{automorphic form}),\]</span> where perhaps the automorphic form
starts on some larger symmetric space <span class="math inline">\(Y
\supseteq X\)</span>. This is useful because it’s our main tool for
studying <span class="math inline">\(L\)</span>-functions.</p>
<p>The next part of my title is <em>Euler systems</em>. This is going to
seem like something different. What are Euler systems? One starts off
with a continuous action <span class="math display">\[G_k =
\mathop{\mathrm{Gal}}(\bar{k} / k) \circlearrowright V,\]</span> where
<span class="math inline">\(V\)</span> is a <span
class="math inline">\(\mathbb{Q}_p\)</span>-space of finite dimension
(with <span class="math inline">\(\mathbb{Q}_p\)</span> acting linearly
and continuously). At least conjecturally, there’s a fairly general
framework for producing such <span class="math inline">\(V\)</span> from
automorphic forms or representations. This Galois representation
captures something about the automorphic form that can be expressed in
terms of the <span class="math inline">\(L\)</span>-function. All of
these things are thus related to one another, even if they are
frequently encountered separately. Here <span
class="math inline">\(V\)</span> often stabilizes in a <span
class="math inline">\(\mathbb{Z}_p\)</span>-submodule (lattice), which
might yield a good exercise for later. An Euler system is a collection
of classes in Galois cohomology <span class="math inline">\(c_F \in
H^1(F, T)\)</span>, where <span class="math inline">\(F / k\)</span> are
certain abelian extensions of <span class="math inline">\(k\)</span>
satisfying certain compatibilities: for <span
class="math inline">\(F&#39; \supseteq F\)</span>, <span
class="math display">\[\operatorname{cores}_{F&#39; / F}(c_{F &#39;}) =
? c_F,\]</span> where <span class="math inline">\(?\)</span> often seems
the local Euler factors of <span class="math inline">\(V\)</span> (or
some <span class="math inline">\(L\)</span>-function attached to <span
class="math inline">\(V\)</span>, depending upon the setting).</p>
<p>Both of these settings have been useful for exploring special values
of <span class="math inline">\(L\)</span>-functions (Kolyvagin,
Gross–Zagier, ...). What we’ll focus on in these lectures is the role
that multiplicity one plays in seeing these <span
class="math inline">\(L\)</span>-functions and in producing these Euler
systems. We’ll see that they essentially play the same role, which is
further evidence for what people say, to the effect that Euler systems
are some sort of algebraic incarnation of <span
class="math inline">\(L\)</span>-functions.</p>
<p>What do we mean by “multiplicity one”? One frequently encounters this
term in the theory of automorphic forms, in various guises:</p>
<ol>
<li><p><span id="enumerate:cq6r3ndbhy"
label="enumerate:cq6r3ndbhy"></span> Uniqueness of a representation in
some space of functions, e.g.:</p>
<ol type="a">
<li><p><span id="enumerate:cq6r3m96yd"
label="enumerate:cq6r3m96yd"></span> A cuspidal automorphic
representation of <span class="math inline">\(\mathrm{GL}_2\)</span>
shows up with multiplicity one <span
class="math inline">\(L^2(\mathrm{GL}_2(k) \backslash
\mathrm{GL}_2(\mathbb{A}_k))\)</span>.</p></li>
<li><p><span id="enumerate:cq6r3m98gf"
label="enumerate:cq6r3m98gf"></span> Uniqueness of (local) Whittaker
models for <span class="math inline">\(\mathrm{GL}_2\)</span>.</p></li>
</ol></li>
<li><p><span id="enumerate:cq6r3ndama"
label="enumerate:cq6r3ndama"></span> Uniqueness of some (invariant)
linear functional: for <span class="math inline">\(H \leq G\)</span> and
<span class="math inline">\(\pi\)</span> a representation of <span
class="math inline">\(G\)</span>, <span class="math display">\[\dim
{\mathop{\mathrm{Hom}}}_H(\pi, \mathbb{C}) \leq 1.\]</span> Or, for <span
class="math inline">\(\sigma\)</span> a representation of <span
class="math inline">\(H\)</span>, as the assertion that <span
class="math inline">\(\dim {\mathop{\mathrm{Hom}}}_H(\pi, \sigma) \leq
1\)</span>.</p></li>
</ol>
<p>The first examples can be understood in terms of the latter. The
latter will be a useful framework for us.</p>
<p>Let’s now turn to integral representations and give some examples.
The first integral representation we see is that of the Riemann zeta
function. Let <span id="eq:cq6r3qe33m" class="math display">\[\label{eq:cq6r3qe33m}\tag{2.1}
  \psi(t) = \sum_{n = 1}^\infty e^{- \pi n^2 t}.\]</span> Then for <span
class="math inline">\(\Re s\)</span> sufficiently large, <span id="eq:cq6r3p0tmc" class="math display">\[\label{eq:cq6r3p0tmc}\tag{2.2}
  \int_0^\infty \psi(t) t^{\frac{1}{2} s - 1} \, d t
  = \pi^{- s/2} \Gamma(\tfrac{s}{2}) \zeta(s).\]</span> We see this by
bringing the summation outside the integral. This gives a Mellin
transform.</p>
<p>What’s the automorphic side of this? If we look at, for <span
class="math inline">\(\tau = x + i y\)</span>, <span
class="math display">\[\theta(\tau) = \sum_{n \in \mathbb{Z}} e^{- 2 \pi
i n^2 \tau}.\]</span> This is an automorphic form, and we have <span
class="math display">\[(\tfrac{1}{2}(\theta(i y) - 1)) = \psi(2
y),\]</span> so <a href="#eq:cq6r3p0tmc" data-reference-type="eqref"
data-reference="eq:cq6r3p0tmc">\((2.2)\)</a> is an integral
representation for the Riemann zeta function coming from the symmetric
space for a torus embedded inside <span
class="math inline">\(\mathrm{GL}_2\)</span>. One has similar integral
representations for the Dirichlet <span
class="math inline">\(L\)</span>-functions. (No multiplicity one that we
can see thus far.)</p>
<p>This gets souped up in the work of Hecke and Iwasawa–Tate, which
inspired how automorphic <span
class="math inline">\(L\)</span>-functions have been studied
subsequently. Let’s recall how that goes. Let <span
class="math inline">\(k\)</span> be a number field. We have the adeles
<span class="math inline">\(\mathbb{A}_k\)</span> and the ideles <span
class="math inline">\(\mathbb{A}_k^\times\)</span>. We have a Hecke
character <span class="math display">\[\chi : k^\times \backslash
\mathbb{A}_k^\times \rightarrow \mathbb{C}^\times,\]</span> which
factors as a product <span class="math inline">\(\chi = \prod
\chi_v\)</span> of characters <span class="math inline">\(\chi_v :
k_v^\times \rightarrow \mathbb{C}^\times\)</span> indexed by the places
<span class="math inline">\(v\)</span> of <span
class="math inline">\(k\)</span>. (This is of course very useful, but is
specific for <span class="math inline">\(\mathrm{GL}_1\)</span>, and so
obscures some of the more general features.) Let <span
class="math inline">\(\phi \in \mathcal{S}(\mathbb{A})\)</span> be a
Schwartz function, which could also be a product <span
class="math inline">\(\phi = \prod \phi_v\)</span> of local Schwartz
functions <span class="math inline">\(\phi_v \in
\mathcal{S}(k_v)\)</span>. We recall that this means that</p>
<ul>
<li><p>when <span class="math inline">\(v\)</span> is finite, <span
class="math inline">\(\phi_v\)</span> is smooth and compactly-supported,
and</p></li>
<li><p>when <span class="math inline">\(v\)</span> is archimedean, all
derivatives decay faster than any polynomial, e.g., <span
class="math inline">\(e^{- \pi t^2}\)</span>.</p></li>
</ul>
<p>Furthermore, <span class="math inline">\(\phi_v =
1_{\mathcal{O}_{k_v}}\)</span> for almost all finite <span
class="math inline">\(v\)</span>. We then form <span
class="math display">\[\theta(x) = \sum_{\alpha \in k} \phi(\alpha
x).\]</span> (It’s a good exercise to see how to specialize this to
obtain something like <a href="#eq:cq6r3qe33m"
data-reference-type="eqref"
data-reference="eq:cq6r3qe33m">\((2.1)\)</a>.) We then form the
integral <span class="math display">\[\int_{k^\times \backslash
\mathbb{A}_k^\times} \chi(x) \lvert x \rvert^s \theta(x) \,d^\times
x.\]</span> These integrals converge absolutely for <span
class="math inline">\(\Re s\)</span> sufficiently large and unfold in
the usual way, giving (at least for <span
class="math inline">\(\chi\)</span> not a power of the absolute value,
so that we don’t need to worry about the contribution of <span
class="math inline">\(\alpha = 0\)</span>) <span
class="math display">\[\int_{\mathbb{A}_k^\times} \chi(x) \lvert x
\rvert^s \phi(x) \, d x.\]</span> If <span class="math inline">\(\phi =
\prod \phi_v\)</span>, then these factor further as <span id="eq:cq6r32qpe5" class="math display">\[\label{eq:cq6r32qpe5}\tag{2.3}
  \prod \int_{k_v^\times} \chi_v(x) \lvert x \rvert_v^s \phi_v(x) \, d
x.\]</span> One can show that the local integrals at non-archimedean
places are rational functions, form the greatest common divisor of their
denominators, and this turns out to be the way you can define the local
<span class="math inline">\(L\)</span>-function. This is Tate’s thesis.
We haven’t yet really made any reference to multiplicity one. This shows
up when you try to generalize to other settings.</p>
<p>We may think of <span
class="math inline">\(\mathbb{A}_k^\times\)</span> as <span
class="math inline">\(\mathrm{GL}_1(\mathbb{A}_k)\)</span>. Let’s now
consider <span
class="math inline">\(\mathrm{GL}_n(\mathbb{A}_k)\)</span>. We discuss
Godement–Jacquet theory, which is a generalization of what Tate did to
<span class="math inline">\(\mathrm{GL}_n\)</span>. Let <span
class="math inline">\(\pi\)</span> be a cuspidal automorphic
representation (by convention, irreducible). Abstractly, this is
isomorphic to a restricted tensor product <span
class="math inline">\(\otimes \pi_v\)</span> of irreducible local
representations <span class="math inline">\(\pi_v\)</span> of <span
class="math inline">\(\mathrm{GL}_n(k_v)\)</span>. We can thus identify
an element <span class="math inline">\(\varphi \in \pi\)</span> with a
sum of tensor products of vectors (although, unlike in the case of
characters, it will not pointwise be a product of local functions). Now,
mimicking what was done before, we take a Schwartz function <span
class="math inline">\(\phi \in \mathcal{S}(M_n(\mathbb{A}_k))\)</span>,
and form a theta function <span class="math display">\[\theta(x)
  =
  \sum_{\alpha \in M_n(k)}
  \phi(\alpha x).\]</span> We then form <span
class="math display">\[\int_{\mathrm{GL}_n(k) \backslash
\mathrm{GL}_n(\mathbb{A}_k)}
  \varphi(x) \lvert \det(x) \rvert^s \theta(x) \,d^\times x.\]</span>
This unfolds to <span
class="math display">\[\int_{\mathrm{GL}_n(\mathbb{A})} \varphi(x)
\lvert \det x \rvert^s \phi(x) \, d^\times x.\]</span> But does it
factor? Not obviously.</p>
<p>Let’s now form <span class="math display">\[\theta(h, g) =
\sum_{\alpha \in M_n(k)} \phi(h^{-1} \alpha g)\]</span> and consider
<span class="math display">\[\int_{[\mathrm{GL}_n]} \varphi(g) \lvert
\det g \rvert^s \theta(h, g) \, d g.\]</span> This is now automorphic as
a function of <span class="math inline">\(h\)</span>, so we can
decompose it with respect to the automorphic spectrum. To compute the
coefficients in that decomposition, we consider, for <span
class="math inline">\(\tilde{\varphi}\)</span> in the contragredient (or
dual) <span class="math inline">\(\tilde{\pi}\)</span> of <span
class="math inline">\(\pi\)</span>, the iterated integral <span
class="math display">\[\int_{[\mathrm{GL}_n^1]}
  \left(  \int_{[\mathrm{GL}_n]} \varphi(g) \lvert \det g \rvert^s
\theta(h, g) \, d g \right)
  \tilde{\varphi}(h) \, d h,\]</span> where <span
class="math inline">\(\mathrm{GL}_n^1\)</span> means either that we mod
out by the center or that we restrict to <span
class="math inline">\(\lvert \det \rvert = 1\)</span>. Then, reordering
terms and unfolding, we obtain <span
class="math display">\[\int_{\mathrm{GL}_n(\mathbb{A})} \phi(g) \lvert
\det g \rvert^s
  \left( \int_{[\mathrm{GL}_n^1]} \tilde{\varphi}(h)
    \varphi(h g) \,d h
  \right) \, d g.\]</span> We can understand the parenthetical inner
integral as <span class="math display">\[\langle \tilde{\varphi}, \pi(g)
\varphi \rangle,\]</span> where <span class="math display">\[\langle
\varphi_1, \varphi_2 \rangle = \int_{[\mathrm{GL}_n^1]} \varphi_1(h)
\varphi_2(h) \, d h.\]</span> This pairing defines a <span
class="math inline">\(G\)</span>-invariant functional <span
class="math inline">\(\langle , \rangle :  \tilde{\pi} \times \pi
\rightarrow \mathbb{C}\)</span>, which is locally unique, hence factors
as a product of local invariant functionals <span
class="math inline">\(\langle , \rangle_v : \tilde{\pi}_v \times \pi_v
\rightarrow \mathbb{C}\)</span>, thus <span
class="math display">\[\langle , \rangle =(\ast) \prod_v \langle ,
\rangle_v.\]</span> The leading constant <span
class="math inline">\((\ast)\)</span> will depend upon our
normalizations of the local and global integrals, and our normalization
of the comparison between <span class="math inline">\(\pi\)</span> and
<span class="math inline">\(\otimes \pi_v\)</span>.</p>
<p>This is the first example where multiplicity one shows up in what
we’ve discussed. In the afternoon talk, we’ll very quickly describe a
few other automorphic <span class="math inline">\(L\)</span>-function
settings where we see multiplicity one, and then start to move to the
Euler system side of things.</p>
<p><strong>Afternoon talk</strong>.</p>
<p>Factoring the integral is only one step towards understanding the
<span class="math inline">\(L\)</span>-functions. The next thing one
needs to do is to compute these local integrals. This of course seems
more tractable than working globally, which is the point. For instance,
in the Iwasawa–Tate setting, when all of the data is unramified (meaning
<span class="math inline">\(\chi_v\)</span> is an unramified character
and <span class="math inline">\(\phi_v\)</span> is the characteristic
function of the ring of integers), then the local factor in <a
href="#eq:cq6r32qpe5" data-reference-type="eqref"
data-reference="eq:cq6r32qpe5">\((2.3)\)</a> is easy to compute,
and gives a local zeta function. This is more complicated in the
Godement–Jacquet setting, but still doable. Then in the ramified
situations, there is the question of how to choose good vectors so that
one gets the <span class="math inline">\(L\)</span>-function on the
nose. This is useful for many of the applications that the speaker makes
of these kinds of functions. In some settings it’s still much of an art
and there are lots of interesting questions.</p>
<p>Let’s turn to Rankin–Selberg convolutions. We’ll begin classically,
say with holomorphic modular eigenforms <span
class="math inline">\(f\)</span> and <span
class="math inline">\(g\)</span> of weights <span
class="math inline">\(k_f \geq k_g\)</span>, say of level <span
class="math inline">\(1\)</span>, i.e., on <span
class="math inline">\(\mathrm{SL}_2(\mathbb{Z})\)</span>. Write <span
class="math display">\[f = \sum a_n q^n, \qquad g = \sum b_n
q^n.\]</span> We’ll consider the Dirichlet series <span id="eq:cq6r32z05j" class="math display">\[\label{eq:cq6r32z05j}\tag{2.4}
  \sum_n \overline{a_n} b_n n^{- s}.\]</span> The integral
representation is <span id="eq:cq6r32zyac" class="math display">\[\label{eq:cq6r32zyac}\tag{2.5}
  \int_{\mathrm{SL}_2(\mathbb{Z}) \backslash \mathbb{H}}
\overline{f(\tau)} g(\tau)
  E_k(\tau, s)
  y^{k_f}
  \, d \mathop{\mathrm{vol}}(\tau),\]</span> where <span
class="math inline">\(k := k_f - k_g\)</span> and <span id="eq:cq6r320zyb" class="math display">\[\label{eq:cq6r320zyb}\tag{2.6}
  E_k(\tau, s)
  := \sum_{\gamma \in
    \begin{pmatrix}
      \ast      &amp; \ast \\
      0             &amp; \ast \\
    \end{pmatrix} \backslash \mathrm{SL}_2(\mathbb{Z})}
  j(\gamma, \tau)^{- k} \lvert y(\gamma(\tau)) \rvert^k.\]</span> The
way you get from <a href="#eq:cq6r32zyac" data-reference-type="eqref"
data-reference="eq:cq6r32zyac">\((2.5)\)</a> to <a
href="#eq:cq6r32z05j" data-reference-type="eqref"
data-reference="eq:cq6r32z05j">\((2.4)\)</a> is to unfold the sum
in <a href="#eq:cq6r320zyb" data-reference-type="eqref"
data-reference="eq:cq6r320zyb">\((2.6)\)</a> with the integral in
<a href="#eq:cq6r32zyac" data-reference-type="eqref"
data-reference="eq:cq6r32zyac">\((2.5)\)</a>, which yields an
integral over <span class="math inline">\(\begin{pmatrix}
  \ast  &amp; \ast \\
  0     &amp; \ast \\
\end{pmatrix} \backslash \mathbb{H}\)</span>. This is a nice exercise if
you haven’t done it.</p>
<p>What does this have to do with multiplicity one? Maybe we try to set
this up a bit more automorphically. Let <span
class="math inline">\(\pi_1\)</span> and <span
class="math inline">\(\pi_2\)</span> be cuspidal automorphic
representations of <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A}_k)\)</span>. Let <span
class="math inline">\(\chi_1, \chi_2\)</span> be Hecke characters <span
class="math inline">\(\chi_i : k^\times \backslash \mathbb{A}_k^\times
\rightarrow \mathbb{C}\)</span> such that <span
class="math inline">\(\chi_1 \chi_2 =(\chi_{\pi_1}
\chi_{\pi_2})^{-1}\)</span>. Let <span class="math inline">\(I_s(\chi_1,
\chi_2)\)</span> denote the space of functions <span
class="math inline">\(f : \mathrm{GL}_2(\mathbb{A}) \rightarrow
\mathbb{C}\)</span> that are smooth (meaning the usual thing at
archimedean places and “fixed by an open subgroup” at finite places) and
“<span class="math inline">\(K\)</span>-finite” and satisfying <span
class="math display">\[f_s \left(
    \begin{pmatrix}
      a &amp; b \\
      0 &amp; d \\
    \end{pmatrix} g \right) =
  \chi_1(a) \chi_2(d)
  \left\lvert \frac{a}{d} \right\rvert^{s + \frac{1}{2}}
  f_s(g).\]</span> We then define an Eisenstein series by averaging:
<span class="math display">\[E(f_s, g) := \sum_{\gamma \in B(\mathbb{Q})
\backslash \mathrm{GL}_2(\mathbb{Q})} f_s(\gamma g).\]</span> The
Rankin–Selberg integral is now just the integral <span
class="math display">\[\int_{[\mathrm{GL}_2]} \varphi_1(g) \varphi_2(g)
E(f_s, g) \, d g.\]</span> We can unfold this to obtain <span
class="math display">\[\int_{Z(\mathbb{A})B(\mathbb{Q}) \backslash
\mathrm{GL}_2(\mathbb{A})} \varphi_1(g) \varphi_2(g) f_s(g) \, d
g.\]</span> Let’s replace <span class="math inline">\(\varphi_i\)</span>
by its Whittaker expansion <span class="math display">\[\varphi_1(g) =
\sum_{a \in k^\times} W_{\psi} \left(
    \begin{pmatrix}
      a      &amp;  \\
             &amp; 1 \\
    \end{pmatrix} g \right).\]</span> Then, unfolding a bit further, we
arrive at <span class="math display">\[\int_{Z(\mathbb{A}) N(\mathbb{A})
\backslash \mathrm{GL}_2(\mathbb{A})} W_{\psi}(g) \varphi_2(g) f_s(g) \,
d g
  =
  \int_{Z(\mathbb{A}) N(\mathbb{A}) \backslash
\mathrm{GL}_2(\mathbb{A})}
  W_\psi(g) W_{\bar{\psi}} &#39;(g) f_s(g) \, d g,\]</span> where <span
class="math inline">\(W_{\psi}&#39;\)</span> is the Whittaker function
for <span class="math inline">\(\varphi_2\)</span> with respect to the
conjugate character. This last integrand is a product of local
functions, so the integral factors, assuming that all vectors in our
representations are pure tensors.</p>
<p>Where’s the multiplicity one? It’s hidden, because, just like in the
case of <span class="math inline">\(\mathrm{GL}_1\)</span> characters,
we have taken for one of our automorphic forms something particularly
special, namely an Eisenstein series. The picture that might be better
is, to give something slightly more complicated, there’s something
called the <strong>triple product integral</strong>. Now we’ll take
<span class="math inline">\(\varphi_i \in \pi_i\)</span> for <span
class="math inline">\(i = 1, 2, 3\)</span>, where it’ll be slightly
simpler to assume that at least one is cuspidal. Look at the function
<span class="math display">\[\int_{[Z \backslash \mathrm{GL}_2]}
  \varphi_1(g) \varphi_2(g) \varphi_3(g) \, d g.\]</span> This integral
defines a trilinear form on the product of the three representations
that is invariant by the diagonal action of <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A})\)</span>, or
equivalently, a <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A})\)</span>-invariant
functional <span class="math inline">\(\Lambda\)</span> on the tensor
product <span class="math inline">\(\pi_1 \otimes \pi_2 \otimes
\pi_3\)</span>, i.e, an element <span class="math display">\[\Lambda \in
{\mathop{\mathrm{Hom}}}_{\mathrm{GL}_2(\mathbb{A})}(\pi_1 \otimes \pi_2
\otimes \pi_3, \mathbb{C}).\]</span> This space is one-dimensional, as
are its local avatars: <span class="math display">\[\dim
{\mathop{\mathrm{Hom}}}_{\mathrm{GL}_2(k_v)}(\pi_{1, v} \otimes \pi_{2, v}
\otimes \pi_{3, v}) \leq 1.\]</span> We can thus factor <span
class="math inline">\(\Lambda = \prod \Lambda_v\)</span>, where each
<span class="math inline">\(\Lambda_v \in
{\mathop{\mathrm{Hom}}}_{\mathrm{GL}_2(k_v)}(\pi_{1, v} \otimes \pi_{2, v}
\otimes \pi_{3, v})\)</span>. Suppose <span
class="math inline">\(v\)</span> is a place for which <span
class="math inline">\(\pi_{i, v}\)</span> is unramified for each <span
class="math inline">\(i\)</span>. Then we can take <span
class="math display">\[\Lambda_v =
  \int_{Z N(k_v) \backslash \mathrm{GL}_2(k_v)}
  W_{\psi_v} W_{\overline{\psi_v}}(g) f_v(g) \, d g.\]</span> Here,
locally, we’re realizing the unramified representation <span
class="math inline">\(\pi_{3, v}\)</span> as an induced representation
<span class="math inline">\(\pi_{3, v} = \pi_v(\chi_{1, v}, \chi_{2,
v})\)</span>. We didn’t unfold to this computation; this was all
local.</p>
<p>There’s one more example we’d like to emphasize: <em>toric
integrals</em>. Let <span class="math inline">\(K /k\)</span> be a
quadratic extension. We can then think of <span
class="math inline">\(K\)</span> as a two-dimensional <span
class="math inline">\(k\)</span>-space, which gives a way to identify
<span class="math display">\[{\mathrm{GL}_2}{/ k} \cong
{\mathop{\mathrm{Aut}}}_k(K) \hookleftarrow K^\times.\]</span> We might
for simplicity that <span class="math inline">\(\pi\)</span> is a
cuspidal automorphic representation of <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A}_k)\)</span>, and let
<span class="math inline">\(\varphi \in \pi\)</span> be a cusp form. Let
<span class="math inline">\(\chi : K^\times \backslash
\mathbb{A}_{K}^\times \rightarrow \mathbb{C}^\times\)</span> be a Hecke
character for our extension. Let’s assume that <span
class="math inline">\(\chi \mid_{\mathbb{A}_k^\times} =
\chi_\pi^{-1}\)</span>, i.e., the restriction is the inverse of the
central character. We are then going to think of the integral <span
class="math display">\[\int_{\mathbb{A}_k^\times K^\times \backslash
\mathbb{A}_K^\times} \varphi(t) \chi(t) \,d^\times t\]</span> as
defining an element of the space <span
class="math inline">\({\mathop{\mathrm{Hom}}}_{\mathbb{A}_k^\times}(\pi,
\mathbb{C}(\chi^{-1}))\)</span>, which has dimensional <span
class="math inline">\(\leq 1\)</span>. Such integrals will thus factor
as prodcuts of local linear functionals.</p>
<p>Some of these can be computed quickly in terms of integrals we
already know. Suppose <span class="math inline">\(\pi_v\)</span> is
unramified and <span class="math inline">\(v\)</span> splits in <span
class="math inline">\(K /k\)</span>. Then <span
class="math display">\[K_v^\times = k_v^\times \times k_v^\times \cong
\left\{
    \begin{pmatrix}
      a      &amp;  \\
                                                                              &amp;
b \\
    \end{pmatrix} \right\} \subseteq \mathrm{GL}_2(k).\]</span> We may
thus identify <span class="math inline">\(\chi_v\)</span> with a pair of
characters <span class="math inline">\((\chi_{1, v}, \chi_{2,
v})\)</span>. We can define the local functional <span
class="math display">\[\int_{k_v^\times} W_\psi
  \begin{pmatrix}
    t    &amp;  \\
                                                                      &amp;
1 \\
  \end{pmatrix} \chi_{1, v}(t) \,d^\times t,\]</span> which defines an
element of <span
class="math inline">\({\mathop{\mathrm{Hom}}}_{K_v^\times}(\pi_v,
\mathbb{C}(\chi_v^{-1}))\)</span>. For unramified data, this evaluates
to <span class="math inline">\(L(\pi_v, \chi_{1, v})\)</span>. It turns
out that (Waldspurger’s formula) <span
class="math display">\[\left\lvert \int \varphi(t) \chi(t) \,d^\times y
\right\rvert^2 \sim L(\mathrm{B C}_{K/k}(\pi) \otimes \chi,
\tfrac{1}{2}).\]</span> There’s a similar relation in the triple product
case, which we can guess using the Rankin–Selberg unfolding that we saw
earlier.</p>
<div id="remark:cq6thpb6e1" class="remark">
<p><strong>Remark 39</strong>. This doesn’t make sense for general
arguments other than <span class="math inline">\(s =
\tfrac{1}{2}\)</span>, except in some form when <span
class="math inline">\(\varphi\)</span> is an Eisenstein series (“formula
of Damerell”). One needs to be able to vary <span
class="math inline">\(\varphi\)</span> (or <span
class="math inline">\(\chi\)</span>) in a family, preserving the central
character compatibility condition.</p>
</div>
<p>All of these examples are special cases of the Gan–Gross–Prasad
conjectures, which we’ll hear more about later in the week.</p>
<p>We’ll now begin by giving one example of an Euler system. Tomorrow,
we’ll explore this in greater generality and more detail. The simplest
case is that of cyclotomic units. Let <span
class="math inline">\(F\)</span> be a number field or a local field.
Kummer theory gives an isomorphism <span class="math display">\[F^\times
/ F^{\times N} \rightarrow H^1(F, \mu_N),\]</span> as follows. Let <span
class="math inline">\(\alpha \in F^\times\)</span>. Choose an <span
class="math inline">\(n\)</span>th root <span
class="math inline">\(\alpha^{1/N}\)</span>. The ambiguity in this
choice is an element of <span class="math inline">\(\mu_N\)</span>,
i.e., an <span class="math inline">\(n\)</span>th root of unity. For any
<span class="math inline">\(\sigma \in G_F\)</span>, we can look at
<span class="math inline">\(\sigma(\alpha^{1/N}) /
\alpha^{1/N}\)</span>. Since the numerator and denominator are both
<span class="math inline">\(N\)</span>th roots of <span
class="math inline">\(1\)</span>, the ratio must lie in <span
class="math inline">\(\mu_N\)</span>. This gives us a way of
constructing elements of <span class="math inline">\(H^1\)</span> very
concretely. The classes we obtain are unramified away from <span
class="math inline">\(N \alpha\)</span>.</p>
<p>Let’s now restrict ourselves to the field <span
class="math inline">\(\mathbb{Q}[\mu_N]\)</span>. Restrict the above map
to the unit group of that field: <span
class="math display">\[\mathcal{O}_{\mathbb{Q}[\mu_N]}^\times
\rightarrow H^1(\mathbb{Q}(\mu_N), \mu_{p^n}).\]</span> Taking inverse
limits, we obtain, with <span class="math inline">\(\mathbb{Z}_p(1) =
\varprojlim\mu_{p^n}\)</span> (where the Galois group acts via the
cyclotomic character), a map <span
class="math display">\[\mathcal{O}_{\mathbb{Q}[\mu_N]}^\times \otimes
\mathbb{Z}_p \rightarrow H^1(\mathbb{Q}(\mu_N),
\mathbb{Z}_p(1)).\]</span> Thus, for any <span class="math inline">\((a,
N) = 1\)</span>, we get , say with <span class="math inline">\(\zeta_N =
e^{2 \pi i / N}\)</span>, <span class="math display">\[\frac{\zeta_N^a -
1}{\zeta_N - 1} \mapsto z_N,\]</span> say. If we look at the
corestriction <span
class="math display">\[\operatorname{cores}_{\mathbb{Q}[\mu_{N \ell}] /
\mathbb{Q}[\mu_N]}(z_{N \ell}) =
  \begin{cases}
    z_N    
    &amp; \text{ if } \ell \mid N \\
    (1 - \mathrm{Fr}_{\ell}^{-1}) z_N
                                                                                     &amp;
\text{ if } \ell \nmid N.
  \end{cases}\]</span> We look at <span class="math display">\[\det
\left( 1 - \mathrm{Fr}_{\ell}^{-1} X \mid \mathbb{Z}_p(1)^\ast \right)
\mid X = \mathrm{Fr}_{\ell}^{-1}.\]</span></p>
<p>Some idea for checking this: <span class="math inline">\((\mathbb{Z}
/ \ell \mathbb{Z})^\times \subset(\mathbb{Z} / \ell N \mathbb{Z})^\times
\cong \mathop{\mathrm{Gal}}(\mathbb{Q}(\mu_{N \ell}) / \mathbb{Q}
)\)</span>, where the last map sends <span class="math inline">\(a
\mapsto \sigma_\alpha(\zeta_{N \ell}) = \zeta_{N \ell}^a\)</span>.</p>
<div id="remark:cq6thpb27e" class="remark">
<p><strong>Remark 40</strong>. Given <span
class="math inline">\(f\)</span> a holomorphic modular form, say of
weight <span class="math inline">\(2\)</span>, we have <span
class="math inline">\(\omega_f = f(\tau) \, d \tau \in H^0(X,
\Omega_X^1) \subseteq H^1(X, \mathbb{C})\)</span>. Then <span
class="math inline">\(\lVert f \rVert^2 = \int_X\omega_f \wedge
\overline{\omega_f}\)</span>.</p>
<p>Similarly, for <span class="math inline">\(X \hookrightarrow X \times
X \times X\)</span>, we get some particular values of the Rankin–Selberg
convolution by looking at <span class="math inline">\(\int_X
\overline{\omega_f} \wedge \omega_g \wedge \omega_{E_k}\)</span>. Then
from the rational structure on cohomology, one can get something like
rational structure on the <span
class="math inline">\(L\)</span>-values.</p>
</div>
<div id="remark:cq6thpb14c" class="remark">
<p><strong>Remark 41</strong>. Let’s talk about the corestriction map in
this setting. Abstractly, it’s a map <span
class="math display">\[H^1(\mathbb{Q}[\mu_{N \ell}], \mathbb{Z}_p(1))
\rightarrow H^1(\mathbb{Q}[\mu_N], \mathbb{Z}_p(1)).\]</span> How are we
going to understand this? We could of course write it down at the level
of cocycles, or something. But what’s it’s really doing is that if we
restrict back, i.e., compose with the restriction map <span id="eq:cq6r4knx6r" class="math display">\[\label{eq:cq6r4knx6r}\tag{2.7}
    H^1(\mathbb{Q}[\mu_N], \mathbb{Z}_p(1)) \rightarrow
H^1(\mathbb{Q}[\mu_{N \ell}], \mathbb{Z}_p(1)),\]</span> then the
composition is just the trace map, given by <span
class="math display">\[\sum_{\sigma \in
\mathop{\mathrm{Gal}}(\mathbb{Q}[\mu_{N \ell}] / \mathbb{Q}[\mu_N])}
\sigma.\]</span> The restriction map <a href="#eq:cq6r4knx6r"
data-reference-type="eqref"
data-reference="eq:cq6r4knx6r">\((2.7)\)</a> is actually an
injection because there are no Galois invariants of <span
class="math inline">\(\mathbb{Z}_p(1)\)</span>.</p>
<p>Also, we have the Kummer map <span
class="math display">\[\mathbb{Q}[\mu_{N \ell}]^\times
\xrightarrow{\mathrm{Kummer}} H^1(\mathbb{Q}[\mu_{N \ell}],
\mathbb{Z}_p(1)).\]</span> And this construction is Galois-invariant. We
have the trace map <span class="math inline">\(\alpha \mapsto
\prod_\sigma \sigma(\alpha)\)</span> from <span
class="math inline">\(\mathbb{Q}[\mu_{N \ell}]^\times \rightarrow
\mathbb{Q}[\mu_N]^\times\)</span>. We claim that this induces the
corestriction map via the Kummer map. This remains the case when we
tensor with <span class="math inline">\(\mathbb{Z}_p\)</span>.</p>
<p>So when we’re dealing with corestriction, what we really want to
understand is what is the norm of the particular <span
class="math inline">\(\alpha\)</span> that we’re working with.</p>
<p>All of this is fairly formal applied to a specific setting. The
Kummer map is also a connecting map in a long exact sequence of Galois
cohomology, associated to <span class="math display">\[0 \rightarrow
\mu_{p^n} \rightarrow \bar{F}^\times \xrightarrow{\alpha \mapsto
\alpha^{p^n}} \bar{F}^\times \rightarrow 0.\]</span> From the formal
stuff, we have an arithmetic question. We take <span
class="math display">\[\alpha = \frac{\zeta_{N \ell}^a - 1}{\zeta_{N
\ell} - 1},\]</span> and we want to know, what is the norm of this
element? Look at <span
class="math display">\[\operatorname{norm}_{\mathbb{Q}(\mu_{N \ell}) /
\mathbb{Q}(\mu_N)}(\alpha).\]</span> We have <span
class="math display">\[\mathop{\mathrm{Gal}}(\mathbb{Q}(\mu_{N \ell}) /
\mathbb{Q}(\mu_N))
    \subseteq \mathop{\mathrm{Gal}}(\mathbb{Q}(\mu_{N \ell}) /
\mathbb{Q})
    \cong(\mathbb{Z} / N \ell)^\times,\]</span> The subgroup here will
be identified with congruence classes <span
class="math inline">\(b\)</span> satisfying <span
class="math inline">\(b \equiv 1 \pmod{N}\)</span>. The last isomorphism
is given by <span class="math inline">\(\sigma_c \mapsto c\)</span>,
where <span class="math inline">\(\sigma_c(\zeta_{N \ell}) = \zeta_{N
\ell}^c\)</span>. Now, suppose for instance that <span
class="math inline">\(\ell \nmid N\)</span>. Then <span
class="math inline">\(\zeta_{N \ell}^{b \ell} = \zeta_N^b =
\zeta_N\)</span>. As <span class="math inline">\(b \in(\mathbb{Z} / N
\ell )^\times\)</span> runs over <span class="math inline">\(\ell -
1\)</span> residue classes modulo <span class="math inline">\(\equiv 1
\pmod{N}\)</span>, then <span class="math inline">\(\zeta_{N
\ell}^b\)</span> runs over <span class="math inline">\(\ell\)</span>th
roots of <span class="math inline">\(\zeta_N\)</span>, but excluding
<span class="math inline">\(\zeta_N^{\ell^{-1}}\)</span>. A short
calculation then gives the claim corestriction formula. In the other
case where <span class="math inline">\(\ell \mid N\)</span>, <span
class="math inline">\(b\)</span> runs over <span
class="math inline">\(\ell\)</span> classes, and we get the other
answer.</p>
</div>
<p>We’re going to continue our discussion of Euler systems. We turn to
the example given by Heegner points. Let <span class="math inline">\(K /
\mathbb{Q}\)</span> be an imaginary quadratic field, with ring of
integers <span class="math inline">\(\mathcal{O}_K\)</span>. Let <span
class="math inline">\(N\)</span> be a positive integer such that all
primes <span class="math inline">\(\ell \mid N\)</span> split in <span
class="math inline">\(K /\mathbb{Q}\)</span>. We take <span
class="math display">\[X_0(N) = \Gamma_0(N) \backslash[\mathfrak{h}
\sqcup \mathbb{P}^1(\mathbb{Q})],\]</span> and write <span
class="math inline">\(\tau \in \mathfrak{h}\)</span>. This classifies
elliptic curves together with an isogeny of order <span
class="math inline">\(N\)</span>, e.g., <span class="math display">\[E
:= \mathbb{C} / \mathbb{Z} \oplus \mathbb{Z} \tau \rightarrow E&#39;
:=  \mathbb{C} / \tfrac{1}{N}(\mathbb{Z} + N \tau \mathbb{Z}) \cong
\mathbb{C} / \mathbb{Z} + N \tau \mathbb{Z},\]</span> whose kernel is
<span class="math inline">\(\tfrac{1}{N} \mathbb{Z} /
\mathbb{Z}\)</span>.</p>
<p>We’re going to produce some points on <span
class="math inline">\(X_0(N)\)</span>. Let <span
class="math inline">\(c\)</span> be positive integer. We can have an
order <span class="math display">\[\mathcal{O}_c := \mathbb{Z} + c
\mathcal{O}_K \subseteq \mathcal{O}_K.\]</span> This gives us a lattice
inside the complex numbers (having chosen a complex embedding of <span
class="math inline">\(K\)</span>). We can then form the quotient <span
class="math inline">\(\mathbb{C} / \mathcal{O}_c\)</span>. To produce a
lattice that is slightly larger, we will use that each <span
class="math inline">\(\ell \mid N\)</span> splits to <em>choose</em> an
ideal <span class="math inline">\(\mathfrak{n} \subseteq
\mathcal{O}_K\)</span> such that <span
class="math inline">\(\mathcal{O}_K / \mathfrak{n} \cong \mathbb{Z} / N
\mathbb{Z}\)</span>. We then obtain an isogeny of elliptic curves <span
class="math display">\[\left[ \mathbb{C} / \mathcal{O}_c \rightarrow
\mathbb{C} / \mathfrak{n}^{-1} \mathcal{O}_c \right] \in
X_0(N)(K[c]),\]</span> where <span class="math inline">\(K[c]\)</span>
denotes the <em>ring class field</em> of <span
class="math inline">\(K\)</span> of conductor <span
class="math inline">\(c\)</span>. To explain what this means, we
introduce some notation. For a module <span
class="math inline">\(M\)</span>, write <span
class="math inline">\(\hat{M} := M \otimes \hat{\mathbb{Z}}\)</span>,
where <span class="math inline">\(\hat{\mathbb{Z}} = \prod_{\ell}
\mathbb{Z}_{\ell}\)</span>. (For instance, if <span
class="math inline">\(M\)</span> is a <span
class="math inline">\(\mathbb{Q}\)</span>-module, then we may also write
<span class="math inline">\(\hat{M}\)</span> as <span
class="math inline">\(M \otimes_{\mathbb{Q}} \mathbb{A}_f\)</span>.)
Class field theory tells us that <span
class="math display">\[\mathop{\mathrm{Pic}}(\mathcal{O}_c) = K^\times
\backslash \hat{K}^\times / \hat{\mathcal{O}}_c^\times
\xrightarrow{\mathrm{rec}} \mathop{\mathrm{Gal}}(K[c] / K),\]</span>
<span class="math display">\[\mapsto \sigma_{\mathfrak{b}}.\]</span>
More generally, for any fractional ideal <span
class="math inline">\(\mathfrak{a}\)</span> of <span
class="math inline">\(\mathcal{O}_c\)</span>, we get a point <span
class="math display">\[x_{c}(\mathfrak{a}) := \left[ \mathbb{C} /
\mathfrak{a} \rightarrow \mathbb{C} / \mathfrak{n}^{-1} \mathfrak{a}
\right] \in X_0(N)(K[c]).\]</span> The action of <span
class="math inline">\(\mathop{\mathrm{Gal}}(K[c] / K)\)</span> on <span
class="math inline">\(X_0(N)(K[c])\)</span> on these points is described
by the relation <span id="eq:cq6sjz7g2n" class="math display">\[\label{eq:cq6sjz7g2n}\tag{2.8}
  \sigma_{\mathfrak{b}} x_c(\mathfrak{a}) = x_c(\mathfrak{b}^{-1}
\mathfrak{a}).\]</span> This is the content of CM theory.</p>
<p>Now we’re going to look at the divisors <span
class="math display">\[y_c(\mathfrak{a}) := x_c(\mathfrak{a}) -
\infty\]</span> obtained by subtracting off the cusp at infinity, which
is defined over <span class="math inline">\(\mathbb{Q}\)</span>. This
difference defines an element of the Jacobian <span
class="math inline">\(J_0(N) := \mathop{\mathrm{Jac}}(X_0(N))\)</span>,
defined over <span class="math inline">\(K[c]\)</span>. The Jacobian is
an abelian variety. For abelian varieties, there is a construction very
similar to Kummer theory that gives us an analogue of the Kummer map
defined yesterday, <span class="math display">\[J_0(N)(K[c]) \rightarrow
H^1(K[c], J_0(N)[p^m]),\]</span> where <span
class="math inline">\(J_0(N)[p^m]\)</span> is the <span
class="math inline">\(p^m\)</span>-torsion subgroup of the Jacobian. The
map is defined as follows. Given <span class="math inline">\(y \in
J_0(N)(K[c])\)</span>, let us choose <span class="math inline">\(y
&#39;\)</span> so that <span class="math inline">\(p^m y&#39; =
y\)</span>. We send this to the class of the cocycle <span
class="math inline">\(\sigma \mapsto \sigma(y&#39;) - y&#39;\)</span>.
Applying this map to <span
class="math inline">\(y_c(\mathfrak{a})\)</span> gives us a cohomology
class <span class="math display">\[z_c(\mathfrak{a}) \in H^1(K[c],
J_0(N)[p^m]).\]</span> In the special case where <span
class="math inline">\(\mathfrak{a} = \mathcal{O}_c\)</span>, we drop it
from the notation and write simply <span
class="math inline">\(z_c\)</span>.</p>
<p>Suppose now that <span class="math inline">\(\ell \nmid c D_K
N\)</span>. Then we’re going to look at what happens when we take the
point <span class="math inline">\(z_{c \ell}\)</span> (attached as above
to the order <span class="math inline">\(\mathcal{O}_{c \ell}\)</span>)
and form the norm <span class="math display">\[\sum_{\sigma \in
\mathop{\mathrm{Gal}}(K[c \ell] / K[c])} \sigma z_{c \ell}.\]</span> We
can write this as the sum <span
class="math display">\[\sum_{\mathfrak{b} \in
\ker(\mathop{\mathrm{Pic}}\mathcal{O}_{c \ell} \rightarrow
\mathop{\mathrm{Pic}}\mathcal{O}_c)} \sigma_{\mathfrak{b}} z_{c
\ell}.\]</span> We can in turn rewrite <span
class="math inline">\(\sigma_{\mathfrak{b}} z_{c \ell}\)</span> as <span
class="math inline">\(\sum_{\mathfrak{b}} y_{c \ell}(\mathfrak{b}^{-1})
- \infty\)</span>, summing over the same <span
class="math inline">\(\mathfrak{b}\)</span> as before. Now, how many
<span class="math inline">\(\mathfrak{b}\)</span>’s are there, and what
is this sum?</p>
<p>Suppose that <span class="math inline">\(\ell\)</span> is inert in
<span class="math inline">\(K\)</span>. Comparing what happens with
<span class="math inline">\(c\)</span> and <span class="math inline">\(c
\ell\)</span>, we get <span class="math display">\[\frac{(\mathcal{O}_K
\otimes \mathbb{Z}_{\ell})^\times}{((\mathbb{Z} + \ell \mathcal{O}_K)
\otimes \mathbb{Z}_{\ell})^\times},\]</span> which is cyclic of order
<span class="math inline">\(\ell + 1\)</span>. Now, <span
class="math inline">\(\mathfrak{b}\)</span> lying in the kernel of the
above map means that <span class="math inline">\(\mathfrak{b}
\mathcal{O}_c\)</span> is a principal ideal, say <span
class="math inline">\(\beta \mathcal{O}_c\)</span> with <span
class="math inline">\(\beta \in K^\times\)</span>. If we look at <span
class="math inline">\(\beta \mathfrak{b}^{-1} \mathcal{O}_c\)</span>,
then we see that inside <span
class="math inline">\(\mathcal{O}_c\)</span>, it has index <span
class="math inline">\(\ell\)</span>. As <span
class="math inline">\(\mathfrak{b}\)</span> varies, this exhausts all
lattices of index <span class="math inline">\(\ell\)</span>. By
definition of the Hecke operator <span
class="math inline">\(T_{\ell}\)</span>, we see that <span
class="math display">\[\sum_{\mathfrak{b}} \left( y_{c
\ell}(\mathfrak{b}^{-1}) - \infty \right) = T_{\ell}(y_c -
\infty).\]</span> Under the Kummer map, this tells us that <span
class="math display">\[\operatorname{cor}_{K[c \ell] / K[c]} z_{c \ell}
  = T_{\ell} z_c.\]</span></p>
<p>Kolyvagin used these relations as follows. <span
class="math display">\[y_K = {\mathop{\mathrm{trace}}}_{K[1] / K} y_1 \in
J_0(N)(K) \xrightarrow{\phi_E} E(K),\]</span> where <span
class="math inline">\(E\)</span> is an elliptic curve of conductor <span
class="math inline">\(N\)</span> with a modular parametrization <span
class="math inline">\(\phi_N : X_0(N) \rightarrow E\)</span> sending
<span class="math inline">\(\infty\)</span> to <span
class="math inline">\(0\)</span>. Using relations, Kolyvagin could show
that if the point is not torsion, then the rank of the elliptic curve is
<span class="math inline">\(1\)</span>. Around the same time,
Gross–Zagier showed that the Néron–Tate height of this point is nonzero
if and only if <span class="math inline">\(L\)</span>-function for <span
class="math inline">\(E/K\)</span> vanishes exactly to order one. This
gave some of the first theoretical evidence for the Birch and
Swinnerton-Dyer conjecture. This was a spectacular application by
Kolyvagin that got people interested in Euler systems.</p>
<p>You can also run Kolyvagin’s argument in another way. You can look at
the primes <span class="math inline">\(\ell\)</span> that are
<em>split</em> in <span class="math inline">\(K\)</span>, say <span
class="math inline">\(\ell = \lambda \bar{\lambda}\)</span>. Then <span
class="math display">\[\frac{(\mathcal{O}_K \otimes
\mathbb{Z}_{\ell})^\times}{((\mathbb{Z} + \ell \mathcal{O}_K) \otimes
\mathbb{Z}_{\ell})^\times}
  =
  \frac{\mathcal{O}_\lambda^\times \times
\mathcal{O}_{\bar{\lambda}}^\times}{\{(a, b) : a \equiv
b(\ell)\}},\]</span> where the numerator is really <span
class="math inline">\(\mathbb{Z}_{\ell}^\times \times
\mathbb{Z}_{\ell}^\times\)</span>. Arguing as above, we’re no longer
summing over all the lattices, but instead we miss two of them: <span
class="math inline">\(\lambda \mathcal{O}_c\)</span> and <span
class="math inline">\(\bar{\lambda} \mathcal{O}_c\)</span>. One obtains
<span class="math display">\[\sum_{\mathfrak{b}} (y_{c
\ell}(\mathfrak{b}^{-1}) - \infty )
  =
  T_{\ell}(y_c - \infty)
  - (\mathrm{Fr}_\lambda^{-1} + \mathrm{Fr}_{\bar{\lambda}}^{-1})(y_c -
\infty).\]</span> (The inverses come from <a href="#eq:cq6sjz7g2n"
data-reference-type="eqref"
data-reference="eq:cq6sjz7g2n">\((2.8)\)</a>.)</p>
<p>Work of the speaker and Jetchev and Wan used the split primes to do
something like what Kolyvagin did.</p>
<p>Let <span class="math inline">\(\mathfrak{c} = \lambda_1 \dotsb
\lambda_r\)</span> be a squarefree product of ideals <span
class="math inline">\(\lambda_i \nmid N D_K\)</span> of degree <span
class="math inline">\(1\)</span> in <span
class="math inline">\(K\)</span>, with <span
class="math inline">\(\lambda_i =\overline{\lambda_i}\)</span>. Let
<span class="math inline">\(c\)</span> be the integer such that <span
class="math inline">\((c) = \mathfrak{c} \cap \mathbb{Z}\)</span>. Let
<span class="math inline">\(z(\mathfrak{c})\)</span> be basically the
class that we were just analyzing, but let’s modify it slightly: <span id="eq:cq6sj3hg5b" class="math display">\[\label{eq:cq6sj3hg5b}\tag{2.9}
  z(\mathfrak{c}) := \prod_{i = 1}^r \left( - \mathrm{Fr}_{\lambda_i}
\right) z_c \in H^1(K[c], T_p J_0(N)),\]</span> where <span
class="math inline">\(T_p J_0(N) = \varprojlim J_0(N)[p^m]\)</span>. We
obtain now, for <span class="math inline">\(\lambda \mid
\ell\)</span>,</p>
<p><span id="eq:cq6sj0iiz3" class="math display">\[\label{eq:cq6sj0iiz3}\tag{2.10}
  \operatorname{cores}_{K[c \ell] / K[c]} z(\mathfrak{c} \lambda) =
\left( \mathrm{Fr}_\lambda^{- 2} - T_{\ell} \mathrm{Fr}_\lambda^{-1} + 1
\right) z(\mathfrak{c}).\]</span> Let’s think about this last expression
in terms of the Hecke polynomial <span class="math inline">\(X^2 -
T_{\ell} X + \ell\)</span>. You can see that if we evaluate this at
<span class="math inline">\(\lambda^{-1}\)</span>, we almost get the
quantity appearing on the right hand side of <a href="#eq:cq6sj0iiz3"
data-reference-type="eqref"
data-reference="eq:cq6sj0iiz3">\((2.10)\)</a>: <span
class="math display">\[(X^2 - T_{\ell} X + \ell) \mid_{X =
\mathrm{Fr}_\lambda^{-1}}.\]</span> They are congruent modulo <span
class="math inline">\(\ell - 1\)</span>, which is <span
class="math inline">\(N(\lambda) - 1\)</span>. When working with Euler
systems, it’s acceptable to work with congruences modulo <span
class="math inline">\(\ell - 1\)</span>. There’s a general way to
massage those classes so that they give the relations on the nose, but
there’s no need to do so. Later, we’ll pose a question that will suggest
that this comparison is a feature of some integral representation
theory, once we see where these norm relations come from in those terms.
In any event, once you have these relations, you can take these objects
and run Kolyvagin’s argument and reprove Kolyvagin’s theorem.</p>
<p>We next want to explain how to set up the construction of the
Kolyvagin system in such a way that some representation theory naturally
shows up, with this Galois relation <a href="#eq:cq6sj0iiz3"
data-reference-type="eqref"
data-reference="eq:cq6sj0iiz3">\((2.10)\)</a> showing up as
something like a Hecke module, which in turn is closely related to
representation theory. The argument we’re going to give generalizes
quite significantly, for instance, it produces an Euler system in the
sense of these split primes for the diagonal cycles coming from the
arithmetic Gan–Gross–Prasad settings, and one can generalize Kolyvagin’s
statement to a rank one statement about Selmer groups for certain
Rankin–Selberg convolutions of <span class="math inline">\(\mathrm{GL}_n
\times\mathrm{GL}_{n + 1}\)</span>. With Euler systems, we’re trying to
bound the orders of Selmer groups of elliptic curves, something like
<span class="math inline">\(H^1_f(\mathbb{Q}, E[p^N])\)</span>, where
the subscript <span class="math inline">\(f\)</span> denotes some sort
of Block–Kato condition coming from the geometry of the elliptic curve.
One way to bound a Selmer group like this is to use global duality to
give classes in the arithmetic dual, i.e., <span
class="math inline">\(H_f^1(\mathbb{Q}, E[p^N]^\ast )\)</span>, where
<span id="eq:cq6sj3fh1h" class="math display">\[\label{eq:cq6sj3fh1h}\tag{2.11}
  E[p^N]^\ast = \mathop{\mathrm{Hom}}(E[p^N], \mathbb{Q}_p /
\mathbb{Z}_p(1)).\]</span> Here one wants to allow ramification at good
primes <span class="math inline">\(\ell\)</span>, chosen to capture the
orders of classes that we want to control. One can then reduce to
looking at <span id="eq:cq6sj3eqsx" class="math display">\[\label{eq:cq6sj3eqsx}\tag{2.12}
  H^1_{\mathrm{ur}}(\mathbb{Q}_{\ell}, E[p^N]).\]</span> The local
duality relates this to <span class="math inline">\(H^1(I_{\ell},
E[p^N]^\ast)^{G_{\mathbb{Q}_{\ell}}}\)</span>. So if we can produce a
class in the latter that is highly ramified (of large order), then we
can force the class in <a href="#eq:cq6sj3eqsx"
data-reference-type="eqref"
data-reference="eq:cq6sj3eqsx">\((2.12)\)</a> to have small order.
That, in a nutshell, is how Selmer groups are bounded. The whole trick
is to produce ramified classes in <a href="#eq:cq6sj3fh1h"
data-reference-type="eqref"
data-reference="eq:cq6sj3fh1h">\((2.11)\)</a> that you can measure
the size of in some way. Now, producing things that are provably
ramified is a hard problem. There are few cases where we can do this.
It’s much easier to check that something is unramified (think of the
criterion of Néron–Ogg–Shafarevich or something like that). What
Kolyvagin’s argument does is, he says well, let’s start off with classes
<a href="#eq:cq6sj3hg5b" data-reference-type="eqref"
data-reference="eq:cq6sj3hg5b">\((2.9)\)</a> that are over
ramified extensions. If they are truly over that ramified extension and
not, say, defined over some extension with less ramification, then
Kolyvagin can use that to produce ramified classes, and it is exactly
these relations <a href="#eq:cq6sj0iiz3" data-reference-type="eqref"
data-reference="eq:cq6sj0iiz3">\((2.10)\)</a> that allow him to
understand how ramified these classes actually are. These norm relations
are thus crucial for producing ramified classes with controlled or
measurable ramification. That’s sort of the algebra background for why
one is interested in Euler systems.</p>
<p>We’ll now describe a more representation-theoretic picture that
produces these Kolyvagin classes. Recall the situation. We have the
modular curve <span class="math inline">\(X_0(N)\)</span> and the
Heegner point <span class="math inline">\(x_c \in X_0(N)(K[c])\)</span>,
corresponding to an isogeny <span class="math inline">\([\mathbb{C} /
\mathcal{O}_c \rightarrow \mathbb{C} / \mathfrak{n}
\mathcal{O}_c]\)</span>. The modular curve is a curve defined over <span
class="math inline">\(\mathbb{Q}\)</span>, so we can think of this point
as defining a map <span
class="math display">\[\mathop{\mathrm{Spec}}K[c] \rightarrow
X_0(N).\]</span> We can base our curve to a curve over <span
class="math inline">\(K[c]\)</span>, yielding the following map of
varieties over <span class="math inline">\(K [c]\)</span>: <span
class="math display">\[\mathop{\mathrm{Spec}}K[c] \xrightarrow{x_c}
X_0(N) \times \mathop{\mathrm{Spec}}K[c].\]</span> The left hand side
has dimension <span class="math inline">\(0\)</span>, while the right
hand side has dimension <span class="math inline">\(1\)</span>. There is
thus a cycle class map <span
class="math display">\[H^0(\mathop{\mathrm{Spec}}K[c])
  \xrightarrow{\mathrm{cyc}}
  H^{2}(X_0(N) / \mathop{\mathrm{Spec}}K[c], \mathbb{Z}_p(1)).\]</span>
(In general, the exponent is <span class="math inline">\(2 d\)</span>,
where <span class="math inline">\(d\)</span> is the codimension.)</p>
<p>This is a single point. What we did before was to take the difference
between two points, <span id="eq:cq6s0hup34" class="math display">\[\label{eq:cq6s0hup34}\tag{2.13}
  \operatorname{cyc}(x_c) - \operatorname{cyc}(\infty) \in
  H^2(X_0(N) \times \mathop{\mathrm{Spec}}K[c],
\mathbb{Z}_p(1))_0,\]</span> but it’s now homologically trivial in the
sense that if we pass to the algebraic closure, i.e., we consider the
degree map <span class="math display">\[H^2(X_0(N) \times
\mathop{\mathrm{Spec}}K[c], \mathbb{Z}_p(1))_0
  \xrightarrow{\deg}
  H^2(X_0(N) \times \mathop{\mathrm{Spec}}\bar{K}[c], \mathbb{Z}_p(1))_0
  \cong \mathbb{Z}_p\]</span> which the difference <a
href="#eq:cq6s0hup34" data-reference-type="eqref"
data-reference="eq:cq6s0hup34">\((2.13)\)</a> lies in the kernel
of, then we obtain the element <span class="math display">\[z_c \in
  H^1(K[c], H^1(X_0(N) / \bar{K}, \mathbb{Z}_p(1)))
  =H^1(K[c], T_p J_0(N)).\]</span></p>
<p>Now, we don’t want to keep tracking the field of definition, so let’s
think of <span class="math inline">\(x_c\)</span> as a map over <span
class="math inline">\(K\)</span>. Starting with <span
class="math display">\[\mathop{\mathrm{Spec}}K[c](\bar{K})
  = \left\{ \sigma : K[c] \hookrightarrow \bar{K} \right\} \simeq
\mathop{\mathrm{Gal}}(K[c] / K)
  = K^\times \backslash \hat{K}^\times /
\hat{\mathcal{O}}_c^\times,\]</span> we can think of <span
class="math display">\[H^0(K^\times \backslash \hat{K}^\times /
\hat{\mathcal{O}}_c^\times)
  \xrightarrow{\mathrm{cyc}}
  H^2(X_0(N) \times K^\times \backslash \hat{K}^\times /
\hat{\mathcal{O}}_c^\times,
  \mathbb{Z}_p(1)).\]</span> There is an action of <span
class="math inline">\(\mathop{\mathrm{Gal}}(K[c] / K)\)</span> on <span
class="math inline">\(X_0(N) \times K^\times \backslash \hat{K}^\times /
\hat{\mathcal{O}}_c^\times\)</span> that we may reinterpret as
multiplication by <span
class="math inline">\(\hat{K}^\times\)</span>.</p>
<p>Now, let’s take an embedding <span class="math inline">\(K
\hookrightarrow M_2(\mathbb{Q})\)</span> such that <span
class="math inline">\(\mathcal{O}_K = K \cap M_2(\mathbb{Z})\)</span>.
This induces <span class="math inline">\(K^\times \hookrightarrow
\mathrm{GL}_2(\mathbb{Q})\)</span>. We fix <span
class="math inline">\(\tau_0 \in \mathfrak{h}\)</span> such that <span
class="math inline">\({\mathop{\mathrm{Stab}}}_{\mathrm{GL}_2^+(\mathbb{Q})}(\tau)
= K^\times\)</span>. For a compact open subgroup <span
class="math inline">\(U\)</span> of <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A}_f)\)</span>, we set <span
class="math display">\[X_U := \mathrm{GL}_2(\mathbb{Q})
\backslash[\mathfrak{h}^{\pm, \ast} \times \mathrm{GL}_2(\mathbb{A}_f) /
U],\]</span> where <span class="math inline">\(\ast\)</span> means “add
the cusps” so as to obtain a compactification. The above contains the
set of “CM points” <span class="math display">\[\left\{[\tau_0, g] : g
\in \mathrm{GL}_2(\mathbb{A}_f) \right\},\]</span> which comes with with
an action of <span class="math inline">\(\hat{K}^\times\)</span> via the
reciprocity map <span class="math inline">\(\hat{K}^\times
\xrightarrow{\mathrm{rec}} G_K^{\mathrm{ab}}\)</span> defined by <span
class="math display">\[\operatorname{rec}(\alpha)[\tau_0, g]
  =[\tau_0, \alpha g].\]</span> We might as well take <span
class="math display">\[U = U_0(N) = \mathrm{GL}_2(\hat{\mathbb{Z}}) \cap
  \begin{pmatrix}
    \ast    &amp; \ast \\
    N \ast            &amp;  \ast \\
  \end{pmatrix}.\]</span></p>
<p>In that case, <span class="math inline">\(x_c =[\tau_0, g_c]\)</span>
for a particular choice of <span class="math inline">\(g_c\)</span>.</p>
<p>This is the classical picture of Heegner points. We’re going to
change the picture just a little bit. Think <span id="eq:cq6s0mlq0m" class="math display">\[\label{eq:cq6s0mlq0m}\tag{2.14}
  H := \mathbb{Q}^\times \backslash K^\times \rightarrow G :=
\frac{\mathrm{GL}_2 \times K^\times}{\mathbb{Q}^\times}.\]</span> (The
right hand side may be thought of as <span
class="math inline">\(\mathrm{GU}(1, 1)\)</span>, if you’d like.) We get
<span class="math display">\[X_{U_0(N)} \rightarrow
  \mathrm{S h}_G(U) := G(\mathbb{Q}) \backslash G(\mathbb{A}) / K_\infty
U, \quad U := U_0(N) \times V.\]</span> We also get <span
class="math display">\[\mathrm{S h}_H(V) := \hat{\mathbb{Q}}^\times
K^\times \backslash \hat{K}^\times / V.\]</span>&lt;++&gt; There is a
map <span class="math display">\[\mathrm{S h}_G(U) \rightarrow
\mathrm{Sh}_H(V).\]</span> In the interest of time, we’re going to cut
to the chase here. Look at compactly supported functions on <span
class="math inline">\(H(\mathbb{A}_f) \backslash
G(\mathbb{A}_f)\)</span>, valued in <span
class="math inline">\(\mathbb{Z}_p\)</span>. We’ll produce elements in
the Shimura variety of <span class="math inline">\(G\)</span> (over
<span class="math inline">\(K\)</span>) valued in <span
class="math inline">\(\mathbb{Z}_p(1)\)</span>: <span id="eq:cq6s0i3k4v" class="math display">\[\label{eq:cq6s0i3k4v}\tag{2.15}
  C_c(H(\mathbb{A}_f) \backslash G(\mathbb{A}_f), \mathbb{Z}_p)
  \rightarrow H^2_{\mathrm{ct}}(\mathrm{S h}_{G /K},
\mathbb{Z}_p(1))\]</span> <span class="math display">\[\mathbf{1}(g U)
\mapsto U_H = \hat{H}^\times g U g^{-1}.\]</span> Now we have <span
class="math display">\[\mathrm{Sh}_H(U_H) \xrightarrow{\mathrm{cyc}}
  H^2(\mathrm{Sh}_G(g U g^{-1}), \mathbb{Z}_p(1)) \xrightarrow{g}
  H^2(\mathrm{Sh}_G(U), \mathbb{Z}_p(1)).\]</span> These maps are <span
class="math inline">\(G(\mathbb{A}_f)\)</span>-equivariant, or “Hecke
equivariant”.</p>
<div id="exercise:cq6tho7823" class="exercise">
<p><strong>Exercise 7</strong>. Recover the Heegner point Euler system
that we wrote down before by taking the right open compact and the right
elements <span class="math inline">\(g_c\)</span>, with <span
class="math inline">\(V\)</span> coming from <span
class="math inline">\(\mathcal{O}_c\)</span>.</p>
</div>
<p>The point is that through this process, the Galois action has been
subsumed into some kind of group action. What’s really going on in some
ways is that the Shimura varieties for these unitary groups are just
some copies of modular curves, where the number of copies is just the
class group of some ring class extension. Once you have this picture,
the Euler system should just be the image of a bunch of elements on the
left hand side of <a href="#eq:cq6s0i3k4v" data-reference-type="eqref"
data-reference="eq:cq6s0i3k4v">\((2.15)\)</a>, and you just have to
choose the elements: <span class="math display">\[\text{Euler system} =
\text{ image of elements in } C_c((H \backslash G)(\mathbb{A}_f) /
\mathbb{Z}_p).\]</span> This can factor. Suppose <span
class="math inline">\(c = \ell_1 \dotsb \ell_r\)</span> is ap roduct of
primes. We might then take <span class="math display">\[\varphi_c =
\varphi_S \otimes \bigotimes_{\ell_i} \varphi_{\ell_i} \otimes
\bigotimes_{
    \substack{
      \ell \neq \ell_i  \\
      \ell \notin S      
    }
  }
  \varphi_{\ell}^0 \in \Bigl(C_c(X(\mathbb{Z}_S), \mathbb{Z}_p) \otimes
C_c(X(\mathbb{A}_f^S), \mathbb{Z}_p)\Bigr)^{U_c},\]</span> where <span
class="math inline">\(U_c := U_0(N) \times
\hat{\mathcal{O}}_c^\times\)</span>, the <span
class="math inline">\(\varphi_{\ell_i}\)</span> are chosen well and
<span class="math inline">\(\varphi_{\ell}^0 :=
\mathbf{1}(G(\mathbb{Z}_{\ell}))\)</span> is the unramified choice. By
choosing <span class="math inline">\(\varphi_S\)</span> appropriately,
we can even arrange that we’re in the homologically trivial classes,
hence giving rise to <span class="math display">\[z_c =
\mathrm{cyc}(\varphi_c)\]</span> in Galois cohomology; this is easy to
arrange by just choosing the right section for <span
class="math inline">\(\varphi_S\)</span>, which amounts to acting by a
Hecke operator of degree zero or something like that. The norm relations
are all about the <span class="math inline">\(\varphi_{\ell_i}\)</span>.
We have <span class="math display">\[\mathrm{cor}_{K[c \ell] / K[c]}
z_{c \ell} =
  \operatorname{cyc}
  \left(
    \sum_{
      t \in (\mathcal{O}_c \otimes \mathbb{Z}_{\ell} )^\times
/(\hat{\mathcal{O}}_{c \ell} \otimes \mathbb{Z}_{\ell})^\times
    }
    (1, t) \varphi_{c \ell}
  \right)
  \in C_c(X(\mathbb{A}_f), \mathbb{Z}_p)^{U_c}.\]</span> Suppose <span
class="math inline">\(\ell \nmid c\)</span>. Then we have <span
class="math display">\[\varphi_{\ell}^0 =
\mathbf{1}(X(\mathbb{Z}_{\ell}))\]</span> and <span
class="math display">\[\varphi_{\ell} &#39; :=
\mathop{\mathrm{trace}}\varphi_{\ell} = \sum_t \varphi_{\ell}(x(1,
t)).\]</span> What we’re interested in is, how to compare these two?
Both of the above define elements of <span class="math display">\[C_c(H
\backslash G(\mathbb{Q}_{\ell}), \mathbb{Z}_p)^{G(\mathbb{Z}_\ell)}
  =
  C_c(H \backslash G(\mathbb{Q}_{\ell}) / G(\mathbb{Z}_\ell),
\mathbb{Z}_p).\]</span> This space is cyclic for the action of the Hecke
algebra (at least after tensoring by <span
class="math inline">\(\mathbb{Q}_p\)</span>) <span
class="math display">\[\mathcal{H}(G /\!\!/G(\mathbb{Z}_{\ell}),
\mathbb{Q}_p)\]</span> generated with respect to that action by the
<span class="math inline">\(\varphi_{\ell}^0\)</span>. So we can write
<span class="math display">\[\varphi_{\ell} &#39; = P_{\ell} \ast
\varphi_{\ell}^0.\]</span> In the remaining minutes, let’s say something
about how that calculation might go.</p>
<p>Let <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\chi\)</span> be unramified representations of
<span class="math inline">\(\mathrm{GL}_2(\mathbb{Q}_{\ell})\)</span>
and <span class="math inline">\(K_{\ell}^\times\)</span>, respectively,
with <span class="math inline">\(\chi_\pi \chi
\mid_{\mathbb{Q}_{\ell}^\times} = 1\)</span>. This pair defines a
representation of the group <span class="math inline">\(G\)</span> as in
<a href="#eq:cq6s0mlq0m" data-reference-type="eqref"
data-reference="eq:cq6s0mlq0m">\((2.14)\)</a>. Take a spherical
vector <span class="math inline">\(\theta \in \pi\)</span>. Maybe we
realize <span class="math inline">\(\pi\)</span> in the Whittaker model.
Let’s also assume that <span class="math inline">\(\ell\)</span> splits.
The sort of functional we’re looking at is <span
class="math display">\[\int_{(g, t_0) \in H \backslash
G(\mathbb{Q}_{\ell})}
  \int_{t \in \mathbb{Q}_{\ell}^\times \backslash K_{\ell}^\times}
  \theta(t g)
  \chi(t t_0)
  \varphi(g, t_0)
  \,d^\times t
  = \Lambda(\varphi).\]</span> Taking <span
class="math display">\[\varphi = \varphi_{\ell} &#39; = P_{\ell} \ast
\varphi_{\ell}^0,\]</span> we obtain <span
class="math display">\[\Lambda(\varphi_{\ell} &#39;) = \xi_{(\pi,
\chi)}(P_{\ell}) \cdot \Lambda(\varphi_{\ell}^0),\]</span> where <span
class="math display">\[\Lambda(\varphi_{\ell}^0) =
\int_{\mathbb{Q}_{\ell}^\times \backslash K_{\ell}^\times} \theta(t)
\chi(t) \,d^\times t.\]</span> We might want to arrange that <span
class="math inline">\(1 = \Lambda(\varphi_{\ell} &#39;)\)</span>. Since
<span class="math inline">\(\Lambda(\varphi_{\ell}^0)\)</span> is the
<span class="math inline">\(L\)</span>-factor, this motivates taking
<span class="math inline">\(\xi(P_{\ell})\)</span> to be the Hecke
polynomial of which the <span class="math inline">\(L\)</span>-factor is
the inverse. Here we’re assuming that <span
class="math inline">\(\ell\)</span> splits in <span
class="math inline">\(K / \mathbb{Q}\)</span>.</p>
<p>Locally, we can think <span class="math display">\[K_{\ell}^\times =
\mathcal{O}_{\ell}^\times \times \mathcal{O}_{\ell}^\times
\hookrightarrow \mathrm{GL}_2(\mathbb{Q}_{\ell}),\]</span> where the
inclusion is the diagonal embedding. We can take <span
class="math display">\[g_{\ell} =
  \begin{pmatrix}
    1 &amp; \frac{1}{\ell} \\
    0 &amp; 1 \\
  \end{pmatrix}.\]</span> Then <span
class="math display">\[\varphi_{\ell} &#39;
  = \sum
  _{a \in(\mathbb{Z} / \ell)^\times}
  \varphi_{\ell}^0 \left(
    \begin{pmatrix}
    1      &amp; \frac{a}{\ell} \\
    0             &amp; 1 \\
    \end{pmatrix} \right).\]</span> You end up with something that’s not
quite what you want, but is <em>congruent</em> to what you want modulo
<span class="math inline">\(\ell - 1\)</span>. Anyway, the norm relation
from before falls out.</p>
<p>You can do this more generally for <span class="math inline">\(H
\subset G\)</span> defining Shimura varieties. One can is to take <span
class="math display">\[G = G\bigl(\mathop{\mathrm{U}}(n, 1) \times
\mathop{\mathrm{U}}(n - 1, 1) \times
\mathop{\mathrm{U}}(1)\bigr),\]</span> which contains <span
class="math display">\[H = G \bigl( \mathop{\mathrm{U}}(n - 1, 1) \times
\mathop{\mathrm{U}}(1) \bigr).\]</span> (This belongs to the “GGP”
setting.) We have a corresponding map of Shimura varieties <span
class="math display">\[\mathrm{Sh}_H \rightarrow \mathrm{Sh}_G\]</span>
of dimensions <span class="math inline">\(n - 1\)</span> and <span
class="math inline">\(n + n - 1 = 2 n - 1\)</span>, so the codimension
is <span class="math inline">\(n\)</span>, and we get a cycle class map
<span class="math display">\[H^0(\mathrm{Sh}_H)
\xrightarrow{\mathrm{cyc}} H^{2 n}(\mathrm{Sh}_G, n).\]</span> This
leads to <span class="math display">\[H^1(\text{ring class fields}, H^{2
n - 1}(\mathrm{Sh}_{\mathop{\mathrm{U}}(n - 1, 1) \times
\mathop{\mathrm{U}}(n, 1)})).\]</span> See the work of the speaker and
Xinwen Wan.</p>
<div id="remark:cq6tho73c6" class="remark">
<p><strong>Remark 42</strong>. We consider <span
class="math display">\[C_c(X(\mathbb{Q}_{\ell}),
\mathbb{Z}_p)^{G(\mathbb{Z}_{\ell})}
    \supseteq \mathop{\mathrm{trace}}C_c(X(\mathbb{Q}_{\ell}),
\mathbb{Z}_p)^{G_{\ell}(\mathbb{Z}_{\ell})},\]</span> for some subgroup
<span class="math inline">\(G_{\ell}(\mathbb{Z}_{\ell}) \subseteq
G(\mathbb{Z}_{\ell})\)</span>. What is the right hand side? Contains
<span class="math display">\[\left( P_{\ell} ,(\ell - 1)
C_c(\dotsb)^{G(\mathbb{Z}_{\ell})} \right).\]</span></p>
</div>
<div id="remark:cq6tho71jb" class="remark">
<p><strong>Remark 43</strong>. See paper of David Loeffler regarding the
ramified primes</p>
</div>
<h1 id="sec:cq6tho1wyu">§3. Jayce Getz’s lectures</h1>
<h2 id="sec:cq6tho1xqr">§3.1. Langlands <span
class="math inline">\(L\)</span>-functions and converse theorem</h2>
<p>Let <span class="math inline">\(F\)</span> be a number field, <span
class="math inline">\(\mathbb{A}_F\)</span> the ring of adeles, and
<span class="math inline">\(G\)</span> a split reductive group over
<span class="math inline">\(F\)</span>. Let <span
class="math inline">\(A_G\)</span> denote the neutral component in the
real topology of the greatest <span
class="math inline">\(\mathbb{Q}\)</span>-split torus in <span
class="math inline">\({\mathop{\mathrm{Res}}}_{F / \mathbb{Q}}
Z_G\)</span>. (For example, <span
class="math inline">\(A_{{\mathop{\mathrm{GL}}}_r} = \mathbb{R}_{&gt; 0}
I_r\)</span>.)</p>
<p><strong>Goal</strong>: given an <span
class="math inline">\(L\)</span>-map <span class="math inline">\(\rho :
{}^L G \rightarrow \mathrm{GL}_n(\mathbb{C})\)</span>, construct a
transfer of automorphic representations of <span
class="math inline">\(G(\mathbb{A}_F)\)</span> to <span
class="math inline">\(\mathrm{GL}_n(\mathbb{A}_F)\)</span>.</p>
<p>Given an automorphic representationd <span
class="math inline">\(\pi\)</span> of <span
class="math inline">\(G(\mathbb{A}_F)\)</span>, we can form the
Langlands <span class="math inline">\(L\)</span>-function <span
class="math display">\[L(s, \pi, \rho) := \prod_v L(s, \pi_v,
\rho).\]</span> If <span class="math inline">\(\pi\)</span> is
unramified at <span class="math inline">\(v\)</span>, then <span
class="math display">\[L(s, \pi_v, \rho) = \frac{1}{\det(1 -
\rho(c(\pi_v)) q_v^{- s})},\]</span> where <span
class="math inline">\(c(\pi_v) \in{}^L G\)</span> is the Langlands class
of <span class="math inline">\(\pi_v\)</span>.</p>
<p>Let <span class="math inline">\(\psi : F \backslash \mathbb{A}_F
\rightarrow \mathbb{C}^\times\)</span> be a nontrivial character. Then
we obtain <span class="math inline">\(\varepsilon\)</span>-factors <span
class="math inline">\(\varepsilon(s, \pi_v, \rho, \psi_v)\)</span>,
defined via local Langlands and the known definition in the case of
<span class="math inline">\(\mathrm{GL}_n\)</span>. There is also the
<span class="math inline">\(\gamma\)</span>-factor <span
class="math display">\[\gamma(s, \pi_v, \rho, \psi_v) :=
  \frac{
    \varepsilon(s, \pi_v, \rho, \psi_v)
    L(1 - s, \pi_v^\vee, \rho)
  }{
    L(s, \pi_v, \rho)
  }.\]</span></p>
<div id="conjecture:cq6tho7y7k" class="conjecture">
<p><strong>Conjecture 44</strong> (Langlands). <em><span
class="math inline">\(L(s, \pi, \rho)\)</span> admits a meromorphic
continuation to <span class="math inline">\(\mathbb{C}\)</span>, is
bounded in vertical strips, and satisfies a functional equation <span
class="math display">\[L(s, \pi, \rho) = \varepsilon(s, \pi, \rho, \psi)
L(1 - s, \pi^\vee, \rho).\]</span></em></p>
</div>
<p>If <span class="math inline">\(L(s, \pi, \rho)\)</span> satisfies the
conjecture, then we say that it is <em>nice</em>.</p>
<p>One case where we know this in complete generality is the case of the
standard representation <span class="math display">\[\rho :=
\rho_{\mathrm{st}} = \mathrm{triv} \times \mathrm{Id} :{}^L
\mathrm{GL}_n = {\mathop{\mathrm{Gal}}}_F \times \mathrm{GL}_n(\mathbb{C})
\rightarrow \mathrm{GL}_n(\mathbb{C}),\]</span> in which case we write
simply <span class="math display">\[L(s, \pi) := L(s, \pi,
\rho_{\mathrm{st}}).\]</span> Then the conjecture is known, and you can
prove it in three different ways that are largely distinct:</p>
<ul>
<li><p>Godement–Jacquet (which preceded the general formulation of this
conjecture).</p></li>
<li><p>The Rankin–Selberg method.</p></li>
<li><p>The Langlands–Shahidi method.</p></li>
</ul>
<p>At first glance, none of these methods will work to address the
general conjecture, but we’ll see that there is a sort of modification
of the first two that might be applicable.</p>
<p>Now, what’s the converse theorem?</p>
<div id="theorem:cq6tho7vvs" class="theorem">
<p><strong>Theorem 45</strong> (Cogdell–Piatetski-Shapiro; Hecke, Weil).
<em>Let <span class="math inline">\(\sigma\)</span> be an admissible
irreducible representation of <span
class="math inline">\(\mathrm{GL}_n(\mathbb{A}_F)\)</span>. (In order to
get this sort of thing, you have to choose a bunch of local data and
outside finitely many places you declare that it is unramified.) Assume
that</em></p>
<ul>
<li><p><em>the central character <span
class="math inline">\(\omega_\sigma\)</span> is <span
class="math inline">\(Z_{\mathrm{GL}_n(F)}\)</span>-invariant,</em></p></li>
<li><p><em><span class="math inline">\(\sigma_v\)</span> is generic for
all <span class="math inline">\(v\)</span>, and</em></p></li>
<li><p><em><span class="math inline">\(L(s, \sigma)\)</span> converges
for <span class="math inline">\(\Re s\)</span> sufficiently
large.</em></p></li>
</ul>
<p><em>Let <span class="math inline">\(S\)</span> be a finite set of
finite primes. Assume that <span class="math inline">\(L(s, \sigma
\times \sigma &#39;)\)</span> is nice and holomorphic for all cuspidal
automorphic representations <span class="math inline">\(\sigma
&#39;\)</span> of <span
class="math inline">\(\mathrm{GL}_m(\mathbb{A}_F)\)</span> unramified at
<span class="math inline">\(S\)</span>, with <span
class="math inline">\(1 \leq m \leq n - 2\)</span> (for <span
class="math inline">\(n \geq 2\)</span>; for <span
class="math inline">\(n = 2\)</span>, just take <span
class="math inline">\(m = 1\)</span>). Then there exists an automorphic
representation <span class="math inline">\(\pi &#39;\)</span> of <span
class="math inline">\(\mathrm{GL}_n(\mathbb{A}_F)\)</span> that is
nearly equivalent to <span class="math inline">\(\sigma\)</span> in the
sense that <span class="math inline">\(\sigma_v \cong \pi_v
&#39;\)</span> for all <span class="math inline">\(s \notin
S\)</span>.</em></p>
</div>
<p>To see the relevance of this, take <span
class="math inline">\(\pi\)</span> on <span
class="math inline">\(G(\mathbb{A}_F)\)</span>, and take <span
class="math inline">\(\sigma = \rho(\pi)\)</span>, giving an admissible
representation for almost all places (assuming the local Langlands
correspondence).</p>
<p>This gives some overplay of the interplay between <span
class="math inline">\(L\)</span>-functions and automorphic
representations and exactly how the two are interrlated via
functoriality. This sort of thing is in the background when you read
things on the Braverman–Kazhdan program, Beyond Endoscopy, etc.</p>
<p>Now let’s talk about a particular case.</p>
<h2 id="sec:cq6tho1yti">§3.2. Rankin–Selberg products and triple products</h2>
<p>Let <span class="math inline">\(\underline{r} =(r_1, r_2,
r_3)\)</span>. Set <span
class="math inline">\(\mathrm{GL}_{\underline{r}} :=\mathrm{GL}_{r_1}
\times\mathrm{GL}_{r_2} \times\mathrm{GL}_{r_3}\)</span>. We have an
<span class="math inline">\(L\)</span>-map that we call the
Rankin–Selberg product (taking complex points, say) <span id="eq:cq6tg2afra" class="math display">\[\label{eq:cq6tg2afra}\tag{3.1}
  \otimes^2 : {}^L(\mathrm{GL}_{r_1} \times\mathrm{GL}_{r_2})
\rightarrow\mathrm{GL}_{r_1 r_2},\]</span> <span id="eq:cq6tg2hl5x" class="math display">\[\label{eq:cq6tg2hl5x}\tag{3.2}
  \otimes^3 : {}^L\mathrm{GL}_{\underline{r}}
\rightarrow\mathrm{GL}_{r_1 r_2 r_3}.\]</span> We’ll think of these as
hypothetical Langlands transfers.</p>
<div id="theorem:cq6tho7t2z" class="theorem">
<p><strong>Theorem 46</strong> (Chevalley). <em>Given any faithful
representation <span class="math inline">\(\rho : H \rightarrow
\mathrm{GL}_n\)</span> (say with <span class="math inline">\(H\)</span>
reductive), any other representation is a subrepresentation of <span
class="math inline">\(\rho^{\otimes m} \otimes \rho^{\vee \otimes
n}\)</span> for some <span class="math inline">\(m\)</span> and <span
class="math inline">\(n\)</span>.</em></p>
</div>
<p>Now, <span class="math inline">\({}^L G\)</span> is not a reductive
group, but ignore that fact for a moment. Say we’re given an <span
class="math inline">\(L\)</span>-map <span id="eq:cq6tg2amid" class="math display">\[\label{eq:cq6tg2amid}\tag{3.3}
  \rho :{}^L G \rightarrow \mathrm{GL}_n.\]</span> Suppose we know the
Rankin–Selberg transfer <a href="#eq:cq6tg2afra"
data-reference-type="eqref"
data-reference="eq:cq6tg2afra">\((3.1)\)</a> as well as transfer
for <a href="#eq:cq6tg2amid" data-reference-type="eqref"
data-reference="eq:cq6tg2amid">\((3.3)\)</a>. Then, <em>any</em>
transfer from <span class="math inline">\(G\)</span> to <span
class="math inline">\(\mathop{\mathrm{GL}}(V)\)</span> is a
“subtransfer” of some <span class="math inline">\(\rho^{\otimes m}
\otimes \rho^{\vee \otimes n}\)</span>.</p>
<div id="question:cq6tho7sd5" class="question">
<p><strong>Question 47</strong> (Not an exercise). Given functorial
transfers <span class="math inline">\(\rho^{\otimes m} \otimes
\rho^{\vee \otimes n}\)</span>, how to pick out the transfers associated
to subrepresentations?</p>
</div>
<p>By analogy to representation theory, some of the basic ways to
construct new representations from old ones is to take direct sums,
induced representations and tensor products. In the automorphic world,
we know how to do the first two (isobaric sum and Eisenstein series),
but not the third.</p>
<p>The importance of triple product <span
class="math inline">\(L\)</span>-functions (attached to <a
href="#eq:cq6tg2hl5x" data-reference-type="eqref"
data-reference="eq:cq6tg2hl5x">\((3.2)\)</a>) is that if they are
nice, then, using the converse theorem, we get that Rankin–Selberg
transfers exist. This is the motivation for what we’re about to do.</p>
<h2 id="sec:cq6tho1zlh">§3.3. Poisson summation conjecture</h2>
<p>In the exercises, we’ll see the Godement–Jacquet Poisson summation
formula for <span class="math inline">\(M_{n \times n}\)</span>, which
leads to the functional equation and analytic continuation of the
standard <span class="math inline">\(L\)</span>-functions <span
class="math inline">\(L(s, \pi)\)</span>. Bravmern–Kazhdan suggest
replacing <span class="math inline">\(M_{n \times n}\)</span> by a
certain <span class="math inline">\(M_{\rho}\)</span>, and try to run
the argument to study <span class="math inline">\(L(s, \pi,
\rho)\)</span>. This proposal was refined by Ngô. Sakellaridis suggested
working with some spherical varieties. Need a little more
flexibility.</p>
<p>We’ll start with the geometric setup.</p>
<h3 id="sec:cq6tho17py">§3.3.1. Global setting</h3>
<p>Let <span class="math inline">\(F\)</span> be a number field, let
<span class="math inline">\(R\)</span> be an <span
class="math inline">\(F\)</span>-algebra, and let <span
class="math inline">\(G_{/F}\)</span> be a reductive group. Assume given
an action <span class="math display">\[\mathcal{R} : X \times G
\rightarrow X\]</span> on an affine <span
class="math inline">\(G\)</span>-scheme <span
class="math inline">\(X\)</span>. Assume that there is a unique open
orbit <span class="math inline">\(X^{\circ} \subseteq X\)</span>. Let
<span class="math inline">\(Z_G^+\)</span> denote the greatest split
torus in <span class="math inline">\(Z_G\)</span> (e.g., for <span
class="math inline">\(G = \mathrm{GL}_n\)</span>, <span
class="math inline">\(Z_G^+ = \mathbb{G}_m\)</span>). Fix an isomorphism
<span class="math inline">\(\mathbb{G}_m^n \xrightarrow{\cong}
Z_G^+\)</span>. Assume that the pullback <span
class="math inline">\(\mathcal{R} : X \times \mathbb{G}_m^n \rightarrow
X\)</span> extends to <span class="math inline">\(\mathcal{R} : X \times
\mathbb{G}_a^n \rightarrow X\)</span>.</p>
<div id="example:cq6tho7qex" class="example">
<p><strong>Example 48</strong>. <span class="math inline">\(X =
\mathbb{G}_a\)</span> (which we don’t write as <span
class="math inline">\(\mathbb{A}^1\)</span>, because that denotes the
adeles). Then the map <span class="math inline">\(X \times \mathbb{G}_m
\rightarrow X\)</span> given by <span class="math inline">\((t, a)
\mapsto t a\)</span> extends to <span class="math inline">\(\mathbb{G}_a
\supset \mathbb{G}_m\)</span> (at <span
class="math inline">\(0\)</span>, but not at <span
class="math inline">\(\infty\)</span>).</p>
</div>
<p>Assume that there exists an automorphic <span
class="math inline">\(\iota : G \rightarrow G\)</span> such that <span
class="math inline">\(\iota(z) = z^{-1}\)</span> for <span
class="math inline">\(z \in Z_G^+(\mathbb{R})\)</span>.</p>
<div id="example:cq6tho7ox2" class="example">
<p><strong>Example 49</strong>. Take <span
class="math inline">\(X\)</span> to be a vector space, <span
class="math inline">\(G =\mathrm{GL}_{X}\)</span>, <span
class="math inline">\(\iota(g) = g^{- \intercal}\)</span>, and <span
class="math inline">\(X(R) := \{x \in R^n \mid Q(x) = 0\}\)</span>,
where <span class="math inline">\(Q\)</span> is an anisotropic quadratic
form. Or take <span class="math inline">\(G =
{\mathop{\mathrm{GO}}}_Q\)</span>, and <span
class="math inline">\(\iota(g) = \operatorname{simil}(g^{-1})
g\)</span>.</p>
</div>
<p>We need a generalization. In integral representations, you often need
some sort of Whittaker or Fourier coefficients to integrate against. The
reason is that if you don’t have it, then when you integrate against
cusp forms, you get zero. If we don’t have this in the cases of
interest, then we end up getting zero. There’s a geometric way of
phrasing this:</p>
<div id="definition:cq6tho7nvw" class="definition">
<p><strong>Definition 50</strong>. Suppose given a <span
class="math inline">\(\mathbb{G}_a^n\)</span>-torsor <span
class="math inline">\(p : V^{\circ} \rightarrow X^{\circ}\)</span>
equipped with a <span class="math inline">\(\mathbb{G}_a^n \rtimes
G\)</span>-action. Assume that <span class="math inline">\(p\)</span> is
<span class="math inline">\(\mathbb{G}_a^n \rtimes
G\)</span>-equivariant. Consider the map <span
class="math display">\[V^{\circ}(R) \times R^n \times G(R) \rightarrow
V^{\circ}(R) \times R^n,\]</span> <span class="math display">\[(v, z, g)
\mapsto(v g,(0 \times g)^{-1} z(0 \times g)).\]</span> Assume given
<span class="math inline">\(\Psi : V^{\circ} \times \mathbb{G}_a^n
\rightarrow \mathbb{G}_a\)</span> such that</p>
<ol>
<li><p><span class="math inline">\(\Psi\)</span> factors through <span
class="math inline">\(p \times \mathrm{id} : V^{\circ} \times
\mathbb{G}_a^n \rightarrow X^{\circ} \times
\mathbb{G}_a^n\)</span>.</p></li>
<li><p><span class="math inline">\(\Psi\)</span> is <span
class="math inline">\(G\)</span>-invariant.</p></li>
<li><p>For each <span class="math inline">\(w \in V^{\circ}(R)\)</span>,
the map <span class="math inline">\(\Psi(w, \bullet) : \mathbb{G}_{a,
R}^n \rightarrow \mathbb{G}_{a, R}\)</span> is a group
homomorphism.</p></li>
</ol>
<p>An <em>affine</em> <span
class="math inline">\(\Psi\)</span><em>-bundle</em> is a pair <span
class="math inline">\((p : V^{\circ} \rightarrow X^{\circ},
\Psi)\)</span> as above.</p>
</div>
<p>Given <span class="math inline">\(w \in V^{\circ}(R)\)</span>, set
<span class="math inline">\(x := p(w)\)</span>. We obtain <span
class="math inline">\(R^n \xrightarrow{\cong} V_x^0(R)\)</span>, <span
class="math inline">\(z \mapsto w z\)</span>. For <span
class="math inline">\(g \in G_\lambda(R)\)</span>, there is a unique
<span class="math inline">\(z_w(g) \in R^n\)</span> such that <span
class="math inline">\(w z_w(g) = w g\)</span>. Then <span
class="math inline">\(\Psi_w(g) = \Psi(w, z_w(g))\)</span>.</p>
<div id="lemma:cq6tho7lzu" class="lemma">
<p><strong>Lemma 51</strong>. <span class="math inline">\(\Psi_w : G_x
\rightarrow \mathbb{G}_a\)</span> is a character, depending only upon
<span class="math inline">\(x\)</span>.</p>
</div>
<p>This is the geometry that underlies the Poisson summation conjecture.
In the remaining time today, we’ll start doing some of the harmonic
analysis. We’ll enrich the geometry by introducing some function spaces
on the <span class="math inline">\(F\)</span>-points of everything.
We’ll start that process now and continue it in the next lecture.</p>
<h3 id="sec:cq6tho3bu5">§3.3.2. Local harmonic analysis</h3>
<p>Start with some global character <span class="math inline">\(\psi : F
\backslash \mathbb{A}_F \rightarrow \mathbb{C}^\times\)</span>. Let
<span class="math inline">\(v\)</span> be a place of <span
class="math inline">\(F\)</span>. Define <span class="math inline">\(F =
F_v\)</span>, <span class="math inline">\(\psi = \psi_v\)</span>. Thus,
we’ll work locally and omit <span class="math inline">\(v\)</span> from
notation. We ask for a Schwartz space sitting as follows: <span
class="math display">\[C_c^\infty(X^{\circ}(F)) \subseteq
\mathcal{S}(X(F)) \subseteq C^\infty(X^{\circ}(F)) \cap
L^2(X^{\circ}(F)).\]</span> (This assumes that we have an invariant
measure to define <span class="math inline">\(L^2\)</span>. It’s better
in some sense to work instead with half-densities.) We want the Schwartz
space to be stable under <span class="math inline">\(G(F)\)</span>. One
can do a bit more: one can form an <span
class="math inline">\(\varepsilon_\psi\)</span>-hermitian bundle over
<span class="math inline">\(X^{\circ}(F)\)</span>, using the affine
<span class="math inline">\(\Psi\)</span>-bundle just mentioned. The
sections are <span class="math display">\[\left\{ f \in
C^\infty(V^{\circ}(F)) \mid \mathcal{R}(a \times I) f(w) = \psi(\Psi(w,
a) f(w)) \right\}.\]</span> The motivation is that if you don’t
incorporate such sections rather than just functions, then you’ll get
zero when you try to integrate against cusp forms. Consider for instance
a cusp form <span class="math inline">\(\varphi\)</span> on <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A}_F)\)</span>. Then <span
class="math display">\[\int_{[\mathbb{G}_a]} \varphi
  \begin{pmatrix}
    1 &amp; x \\
    0 &amp; 1 \\
  \end{pmatrix} \, d x= 0,\]</span> while <span
class="math display">\[\int_{[\mathbb{G}_a]} \varphi
  \begin{pmatrix}
    1 &amp; x \\
    0 &amp; 1 \\
  \end{pmatrix}
  \psi(x) \, d x
  \, d x
  =
  W_\psi^\varphi(1).\]</span> Actually, it’s better, and we do it in the
paper (see the course references (TODO: add link here)), and you need
it. We twist by half-densities: <span
class="math inline">\(\varepsilon_\psi \otimes \lvert \Lambda
\rvert^{1/2} = \mathcal{L}_\psi\)</span>. These are canonical – no
choice of measure. They are helpful for normalization. On the other
hand, you can’t evaluate at points. But you can work around this. Using
these makes the formulation of the theory much simpler. Another benefit
is that with half-densities, Schwartz spaces behave well under
restriction. Maybe the reason behind this might be an exercise:</p>
<div id="exercise:cq6tho3tag" class="exercise">
<p><strong>Exercise 8</strong>. <span
class="math inline">\(L^2(X^{\circ}(F), \lvert \Lambda
\rvert^{1/2})\)</span> is a unitary <span
class="math inline">\(G(F)\)</span>-representation.</p>
</div>
<p>We continue now with harmonic analysis over a local field <span
class="math inline">\(F\)</span>. Let <span class="math inline">\(X
\times G \rightarrow X\)</span> be a <span
class="math inline">\(G\)</span>-variety, with open <span
class="math inline">\(G\)</span>-orbit <span
class="math inline">\(X^{\circ} \subset X\)</span>. We’ll ignore the
half-densities “<span class="math inline">\(\mathcal{L}_\psi\)</span>”
discussed earlier.</p>
<p>Recall that we are looking for a Schwartz space <span
class="math inline">\(\mathcal{S}(X(F))\)</span> sitting as follows:
<span class="math display">\[C_c^\infty(X^{\circ}(F)) \subset S(X(F))
\subset C^\infty \cap L^2(X^{\circ}(F)).\]</span> We moreover have the
following desiderata for the Schwartz space:</p>
<ul>
<li><p>It should be stable under <span
class="math inline">\(G(F)\)</span>.</p></li>
<li><p>There should be a unitary “Fourier transform” <span
class="math inline">\(\mathcal{F}_X \circlearrowright
\mathcal{S}(X(F))\)</span>.</p></li>
<li><p>We should have the compatibility <span
class="math inline">\(\mathcal{F}_X \circ \mathcal{R}(g) =
\mathcal{R}(\iota(g)) \mathcal{F}_x\)</span></p></li>
</ul>
<p>We caution that elements of <span
class="math inline">\(\mathcal{S}(X(F))\)</span> need not be defined on
all of <span class="math inline">\(X(F)\)</span>. We want the
following:</p>
<ol>
<li><p>In the archimedean case, we want <span
class="math inline">\(S(X(F))\)</span> to be a Frechét space, with the
action continuous.</p></li>
<li><p>We want elements of <span class="math inline">\(S(X(F))\)</span>
to enjoy “rapid decay at <span class="math inline">\(\infty\)</span>”.
In the archimedean case, this means dominated by a Schwartz function
after an affine embedding. In the non-archimedean case, it means
supported on a compact subset of <span
class="math inline">\(X(F)\)</span> (not <span
class="math inline">\(X^{\circ}(F)\)</span>).</p></li>
<li><p>We want the space to be local: given a <span
class="math inline">\(G\)</span>-equivariant embedding <span
class="math inline">\(X \hookrightarrow \mathbb{G}_a^n\)</span>, we want
the space to be preserved under multiplication by restrictions of
functions in <span
class="math inline">\(\mathcal{S}(F^n)\)</span>.</p></li>
</ol>
<p>In the unramified case, we ask that for a <em>basic function</em>
<span class="math inline">\(b_X \in S(X(F))\)</span> such that <span
class="math inline">\(X^{\circ}(\mathcal{O}_F) \subsetneq
\mathop{\mathrm{supp}}b_X \subseteq X(\mathcal{O}_F)\)</span>, with
<span class="math inline">\(\mathcal{F}_X(b_X) = b_X\)</span>.</p>
<p>In many cases, one can construct this. For instance, the case of
<span class="math inline">\(\overline{P^{\mathop{\mathrm{der}}}
\backslash G}^{\mathrm{aff}}\)</span> was studied by Braverman–Kazhdan,
refined by Getz–Liu, and further by Getz–Hsu–Leslie.</p>
<h3 id="sec:cq6txpqnif">§3.3.3. Poisson summation formula</h3>
<p>Let <span class="math inline">\(F\)</span> again be a number field.
Assume that <span class="math inline">\(\mathcal{S}(X(F_v))\)</span> has
been constructed for all places <span class="math inline">\(v\)</span>.
We then take <span class="math display">\[\mathcal{S}(X(\mathbb{A}_F)) =
\bigotimes_{v \mid \infty} \mathcal{S}(X(F_v))  \otimes \bigotimes_{v
\nmid \infty} {}^{&#39;} \mathcal{S}(X(F_v)),\]</span> where the
restricted tensor product is with respect to the <span
class="math inline">\(b_{X_{F_v}}\)</span>.</p>
<p>We set <span class="math inline">\(\mathcal{F}_X := \otimes_v
\mathcal{F}_{X_{F_v}}\)</span>, which acts on <span
class="math inline">\(\mathcal{S}(X(\mathbb{A}_F))\)</span>. If <span id="eq:cq6txloduw" class="math display">\[\label{eq:cq6txloduw}\tag{3.4}
  f = f_{v_1} f_{v_2} f^{v_1 v_2}
  \quad \text{ with }
  \mathop{\mathrm{supp}}f_{v_1}  \subset X^{\circ}(F_{v_1})
  \text{ and }
  \mathop{\mathrm{supp}}\mathcal{F}_X(f_{v_2}) \subset
X^{\circ}(F_{v_2}),\]</span> then the Poisson summation conjecture is
that is the statement that <span class="math display">\[\sum_{x \in
X^{\circ}(F)} f(x) = \sum_{x \in X^{\circ}(F)}
\mathcal{F}(f)(x).\]</span> We remark that this may not be true in
general. We expect it to be true for reductive monoids and more
generally in multiplicity one situations. One thing we’ll talk about in
later lectures is how one can prove new types of formulas of this type
from old ones. We’ll see examples where even if you’re ultimately
interested in situations with multiplicity one (spherical varieties), it
may be useful to pass outside that setting.</p>
<p>Now, Poisson summation is a very useful formula in analysis, but why
would someone outside representation theory care about this? The reason
is the connection to zeta integrals. Suppose <span
class="math inline">\(\pi\)</span> is cuspidal in <span
class="math inline">\(A_G \backslash G(\mathbb{A}_F)\)</span>, and let
<span class="math inline">\(\varphi \in \pi\)</span>. Write <span
class="math inline">\(Z_G^+ = \mathbb{G}_m^n\)</span>. We assume given
characters <span class="math display">\[\eta_s : G(\mathbb{A}_F)
\rightarrow(\mathbb{A}_F^\times)^n \xrightarrow{x \mapsto \prod \lvert
x_i \rvert^{s_i}} \mathbb{C}^\times.\]</span> Given <span
class="math inline">\(f \in \mathcal{S}(X(\mathbb{A}_F))\)</span>, we
form the zeta integral <span class="math display">\[Z(f, \varphi, s) =
\int_{[G]}
  \sum_{x \in X^{\circ}(F)} f(x g)
  \varphi(g)
  \eta_s(g) \, d g.\]</span> Morally, the Poisson summation conjecture
implies that <span class="math display">\[Z(f, \varphi, s) =
Z(\mathcal{F}_X(f), \varphi^\vee, 1 - s),\]</span> where <span
class="math inline">\(\varphi^\vee(g) = \varphi(\iota(g))\)</span> is
just defined using this automorphism that we mentioned earlier. These
sort of period integrals have appeared in almost every talk that we’ve
seen this week.</p>
<p>We’re primarily interested in the Eulerian case, i.e., when <span
class="math display">\[Z(f, \varphi, s) = \prod_v Z(f_v, \varphi_v,
s)\]</span></p>
<p>for pure tensors <span class="math inline">\(f = \otimes_v
f_v\)</span> and <span class="math inline">\(\varphi = \otimes_v
\varphi_v\)</span>.</p>
<h2 id="sec:cq6txpqmpx">§3.4. The spectral argument</h2>
<p>Known properties of <span class="math inline">\(L\)</span>-functions
imply cases of the Poisson summation conjecture. (This is analogous to
the fact that the functional equation of the Riemann zeta function is
<em>equivalent</em> to Poisson summation for <span
class="math inline">\(\mathbb{Z}\)</span>.) Why would you do this, given
that it seems circular?</p>
<ol>
<li><p>It puts the local theory on firmer footing.</p></li>
<li><p>It’s a check on the Poisson summation conjecture.</p></li>
<li><p>We can produce new Poisson summation formulae from old ones. (If
you place it in the right context, the Rankin–Selberg method is a
consequence of this. It starts by taking known properties of Eisenstein
series, which can always be understood as a case of the Poisson
summation conjecture, and then applies it to new <span
class="math inline">\(L\)</span>-functions.)</p></li>
<li><p>“Boundary terms lead to residue kernels.” We won’t have much time
to talk about this point in these lectures, but the idea is that if you
want to remove the condition <a href="#eq:cq6txloduw"
data-reference-type="eqref"
data-reference="eq:cq6txloduw">\((3.4)\)</a>, you’ll get new
boundary terms, which can in turn be related to residues of <span
class="math inline">\(L\)</span>-functions.</p></li>
</ol>
<h3 id="sec:cq6txpqlp7">§3.4.1. Plancherel decomposition</h3>
<p>Let’s talk about this spectral argument, starting locally. A nice
reference is <a href="#ref-MR1075727" class="citation" data-cites="MR1075727">(Bernstein
1988)</a>. Recall that we expect <span
class="math display">\[C_c^\infty(X^{\circ}(F)) \subsetneq
\mathcal{S}(X(F)) \subsetneq \mathcal{C}(X(F)) \subsetneq
L^2(X(F)),\]</span> where <span
class="math inline">\(\mathcal{C}\)</span> denotes the Harish–Chandra
Schwartz space. We may write <span
class="math display">\[L^2(X^{\circ}(F)) = \int_{\widehat{G(F)}} V_\pi
\, d \mu_X(\pi)\]</span> for some Borel measure <span
class="math inline">\(d \mu_X(\pi)\)</span>. (If you’re not familiar
with these, they’re analogous to writing <span
class="math inline">\(L^2(\mathbb{R}) = \int \mathbb{C} e^{i t} \, d
t\)</span>.) We assume that the support of <span class="math inline">\(d
\mu_X\)</span> is contained in the tempered spectrum <span
class="math inline">\(T_p(G(F))\)</span>. For each <span
class="math inline">\(\pi\)</span>, we have a projection map <span
class="math display">\[\alpha_\pi : C_c^\infty(X^{\circ}(F)) \rightarrow
V_\pi,\]</span> with adjoint <span class="math display">\[\beta_\pi :
V_\pi^\infty \rightarrow C^\infty(X^{\circ}(F)).\]</span> For <span
class="math inline">\(f \in C_c^\infty(X^{\circ}(F))\)</span>, we have
<span class="math display">\[f(x) = \int_{T_p(G(F))}
  f_\pi(x)
  \, d \mu_X(\pi)
  \quad
  \text{ when }
  f_\pi = \beta_\pi \circ \alpha_\pi(f).\]</span></p>
<h3 id="sec:cq6txpqktt">§3.4.2. <span
class="math inline">\(L\)</span>-functions</h3>
<p>Recall that we have our torus <span
class="math display">\[\begin{CD}         
    Z_G^+    @&gt;&gt;&gt; \mathbb{G}_m^n\\
    @VVV  @VVV \\
    \overline{Z_G^+}    @&gt;&gt;&gt; \mathbb{G}_a^n. \\
  \end{CD}\]</span> Recall that we asked that the action map <span
class="math inline">\(X^{\circ} \times Z^+_G \rightarrow
X^{\circ}\)</span> extends to a map (no longer an action) <span
class="math inline">\(X \times \overline{Z_G^+} \rightarrow X\)</span>.
We can choose <span class="math inline">\(d_i : G \rightarrow
\mathbb{G}_m\)</span> such that <span class="math display">\[Z_G^+
\rightarrow G \xrightarrow{\prod  d_i} \mathbb{G}_m^n\]</span> is an
isogeny. For <span class="math inline">\(s \in \mathbb{C}^n\)</span>,
set <span class="math display">\[\eta_s(g) := \prod \lvert d_i(g)
\rvert^{s_i}.\]</span> We record <strong>Hypothesis L</strong>: there
exists <span class="math inline">\(r_i :{}^L G \rightarrow
{\mathop{\mathrm{GL}}}_{v_i}(\mathbb{C})\)</span>, for <span
class="math inline">\(1 \leq i \leq n\)</span>, such that when <span
class="math inline">\(F\)</span> is non-archimedean, for all <span
class="math inline">\(f \in C_c^\infty(X(F))\)</span> and <span
class="math inline">\(\phi \in C_c^\infty(X^{\circ}(F))\)</span>e, we
have <span class="math display">\[\frac{\left\langle f, \phi_\pi \otimes
\eta_s \right\rangle}{\prod L(\tfrac{1}{2} + s_i, \pi, r_i)} \in
\mathbb{C}[q^{\pm s_1}, \dotsc, q^{\pm s_n}].\]</span> See the work of
Sakellaridis–Venkatesh, Ichino–Ikeda, and our paper in the list of
references. The idea is that some “almost <span
class="math inline">\(L\)</span>-functions” (they would be actual <span
class="math inline">\(L\)</span>-functions if the ratio were <span
class="math inline">\(1\)</span> rather than some polynomial) control
the boundary asymptotics.</p>
<p>A basic example is when <span class="math inline">\(X^{\circ} =
\mathbb{G}_m\)</span> and <span class="math inline">\(X =
\mathbb{G}_a\)</span>, where the asymptotics near zero are controlled by
the local zeta factor <span class="math inline">\(\zeta(s)\)</span>.</p>
<p>There’s another hypothesis that’s useful: <strong>Multiplicity
one</strong>. This says that for tempered <span
class="math inline">\(\pi\)</span> and generic <span
class="math inline">\(s \in \mathbb{C}^n\)</span>, we have <span
class="math display">\[\dim \mathop{\mathrm{Hom}}(V_\pi \otimes \eta_s
\otimes C^\infty(X^{\circ}(F)), \mathbb{C}) = 1.\]</span> (This was one
of the motivations for Sakellaridis to focus on spherical varieties in
his early papers.)</p>
<h3 id="sec:cq6txpqjrw">§3.4.3. Construction of a Schwartz space</h3>
<p>Given the above, we can give our first pass at the definition of the
Schwartz space. Assume that <span class="math display">\[f(x) =
\int_{T_p(G(F))}
  f_\pi(x)
  \, d \mu_X(\pi).\]</span> Assume Hypothesis <span
class="math inline">\(L\)</span> and Multiplicity One. If <span
class="math inline">\(F\)</span> is non-archimedean, then our first
approximation at a definition is that <span
class="math display">\[\mathcal{S}^{\text{naive}}(X(F))
  =
  \left\{ f \in \mathcal{C}(X^{\circ}(F)) \mid \pi \mapsto
\frac{f_\pi}{\prod_i L(\frac{1}{2}, \pi, r_i)} \text{ is polynomial}
\right\}.\]</span> (Our treatment is inspired by <a href="#ref-2015arXiv150601452B" class="citation"
data-cites="2015arXiv150601452B">(R. Beuzart-Plessis 2015, sec.
2.6)</a>.) A polynomial function on <span
class="math inline">\((\mathbb{R} / 2 \pi i \log q)^n\)</span> is a
function of the form <span class="math inline">\(s \mapsto p(q^{- s},
q^{s})\)</span> for some <span class="math inline">\(p \in \mathbb{C}[x,
y] /(x y - 1)\)</span>. Locally, <span
class="math inline">\(T_p(G(F))\)</span> is a quotient of <span
class="math inline">\((\mathbb{R} / 2 \pi i \log q)^n\)</span> by a
finite group. A polynomial function on <span
class="math inline">\(T_p(G(F))\)</span> is a function that pulls back
to a polynomial function on <span class="math inline">\((\mathbb{R} / 2
\pi i \log q)^n\)</span>. (You can ask me later to give an example.)
Define the basic function to be <span class="math display">\[b_X =
\int_{T_p(G(F))}
  \prod_i L(\tfrac{1}{2}, \pi, r_i)
  \cdot
  \mathbf{1}_{X^{\circ}(\mathcal{O}_F)_\pi}
  \, d \mu_X(\pi)\]</span> and <span
class="math display">\[\mathcal{F}_X(f) := \int_{T_p(G(F))} \prod_i
\gamma(\tfrac{1}{2}, \pi, r_i) \cdot f_{\pi^\vee}
  \, d \mu_X(\pi).\]</span> Then <span
class="math inline">\(\mathcal{F}_X\)</span> acts on <span
class="math inline">\(\mathcal{S}^{\text{naive}}(X(F))\)</span>. (This
should be an approximation to the Schwartz space, but too big.)</p>
<h3 id="sec:cq6txpqe90">§3.4.4. The spectral argument</h3>
<p>We define <span
class="math inline">\(\mathcal{S}(X(\mathbb{A}_F))\)</span> to be a
restricted tensor product, as before.</p>
<div id="exercise:cq6txpqdmd" class="exercise">
<p><strong>Exercise 9</strong>. Derive the Poisson summation formula for
<span class="math inline">\(\mathbb{Z} \subset \mathbb{R}\)</span> from
the functional equation of the Riemann zeta function <span
class="math inline">\(\zeta(s)\)</span>.</p>
</div>
<p>Generalizing this, you can show that if <span
class="math inline">\(L(s, \pi, r_i)\)</span> is nice for all <span
class="math inline">\(i\)</span>, then the Poisson summation conjecture
holds for <span class="math inline">\(X\)</span>. We’re not going to go
through this, and in any given case there might be some difficulties to
make this precise.</p>
<div id="example:cq6ud4pnkj" class="example">
<p><strong>Example 52</strong>. Take <span
class="math inline">\(F\)</span> to be a local non-archimedean field. We
may write <span class="math display">\[L^2(F^\times) = \int_{\mathbb{R}
/ (2 \pi i \log q) \mathbb{Z}} \bigoplus_\chi \chi \lvert . \rvert^{i t}
\, d t,\]</span> where <span class="math inline">\(\chi\)</span> runs
over a set of characters of <span
class="math inline">\(F^\times\)</span> modulo twisting by <span
class="math inline">\(\lvert . \rvert^{i t}\)</span>. Take <span
class="math inline">\(X^{\circ} \subset X\)</span> to be <span
class="math inline">\(\mathbb{G}_m \subset \mathbb{G}_a\)</span>. Set
<span class="math inline">\(f := \mathbf{1}_{X(\mathcal{O}_F)}\)</span>.
Let <span class="math inline">\(\phi \in C_c^\infty(F^\times)\)</span>,
such as <span class="math inline">\(\phi =
\mathbf{1}_{\mathcal{O}_F^\times}\)</span>. Then <span
class="math display">\[\phi_{\chi_s} = \int_{\mathcal{O}_F^\times}
\chi_s(t) \, d t \, \chi_s(x).\]</span> We have <span
class="math display">\[\langle f, \phi_{\chi_s} \rangle = L(s,
\chi).\]</span></p>
</div>
<h2 id="sec:cq6ud4pku1">§3.5. Producing new Poisson summation formulae from
old</h2>
<p>We will discuss two techniques, one of which has been exploited more
than the other.</p>
<h3 id="sec:cq6ud4pjsa">§3.5.1. Restriction</h3>
<p>Suppose given <span class="math inline">\(X \times G \rightarrow
X\)</span> together with a Poisson summation formula. If we restrict to
a subgroup <span class="math inline">\(H \subset G\)</span> that still
has open orbit, then we get a Poisson summation formula still for <span
class="math inline">\(X\)</span>, but with respect to the action of
<span class="math inline">\(H\)</span>.</p>
<div id="example:cq6ud4qj65" class="example">
<p><strong>Example 53</strong>. Take a parabolic subgroup <span
class="math inline">\(P = M N \leq G\)</span>. We can look at <span
class="math display">\[X := \overline{P^{\mathrm{der} \backslash
G}}^{\mathrm{aff}},\]</span> with an action by <span
class="math inline">\(M^{\mathrm{a b}} \times G\)</span>. The Poisson
summation conjecture for <span class="math inline">\(X\)</span> is
known, and is essentially the theory of Eisenstein series plus the
spectral argument. (Some of these ideas go back to Gelfand–Graev.) Here
<span class="math inline">\(M^{\mathrm{ab}}\)</span> is an abelian
group, so you can do a Mellin transform. By summing, one then gets an
Eisenstein series. The thing to note is that if we look at the integrals
defined the other day <span class="math inline">\(Z(f, \varphi, s) =
0\)</span> for <span class="math inline">\(\varphi\)</span> a cusp form
on <span class="math inline">\(G(\mathbb{A}_F)\)</span>, because if we
try to integrate it against this space, then every stabilizer will
continue the unipotent radical of a parabolic subgroup, hence will die.
But <span class="math inline">\(Z(f, \varphi, s)\)</span> may be nonzero
if <span class="math inline">\(\varphi\)</span> is a cusp form on <span
class="math inline">\(H(\mathbb{A}_F)\)</span>. This will still have a
functional equation because it inherits it from the case of <span
class="math inline">\(G\)</span>.</p>
</div>
<p>The above is just another way of talking about the Rankin–Selberg
method. Here’s a concrete example:</p>
<div id="example:cq6ud4qlts" class="example">
<p><strong>Example 54</strong>. Let <span
class="math inline">\(P\)</span> denote the Siegel parabolic subgroup of
<span class="math inline">\(\mathrm{GSp}_6\)</span>, i.e., <span
class="math display">\[P = \left\{
      \begin{pmatrix}
        z g        &amp; \ast \\
                   &amp; g^{- \intercal} \\
      \end{pmatrix}
      : g \in \mathrm{GL}_3\right\}.\]</span> Take <span
class="math inline">\(H = G(\mathrm{SL}_2 \times \mathrm{SL}_2 \times
\mathrm{SL}_2)\)</span>. Poisson conjeture for <span
class="math inline">\(\overline{P^{\mathop{\mathrm{der}}} \backslash
\mathrm{GSp}_6}\)</span> is known. This gives rise to the triple product
<span class="math inline">\(L\)</span>-function <span
class="math inline">\(L(s, \pi, \otimes^3)\)</span> for <span
class="math inline">\(\pi = \pi_1 \otimes \pi_2 \otimes \pi_3\)</span>,
with <span class="math inline">\(\pi_i\)</span> on <span
class="math inline">\(\mathrm{GL}_2(\mathbb{A}_F)\)</span>, introduced
by Garrett <a href="#ref-MR881269" class="citation" data-cites="MR881269">(Garrett
1987)</a> and developed further by Piatetski-Shapiro–Rallis <a href="#ref-MR911357"
class="citation" data-cites="MR911357">(Piatetski-Shapiro and Rallis
1987)</a>.</p>
</div>
<h3 id="sec:cq6ud4ph5c">§3.5.2. Coinvariant</h3>
<p>Take <span class="math inline">\(X \times G \rightarrow X\)</span>
and <span class="math inline">\(\iota \circlearrowright G\)</span>, as
before. Assume that <span class="math inline">\(G = G &#39; \ltimes
H\)</span> and that <span class="math inline">\(\iota |_{H} =
\mathop{\mathrm{id}}\)</span>. Suppose given a <span
class="math inline">\(G&#39;\)</span>-equivariant map <span
class="math display">\[I : \mathcal{S}(X(F))_{H(F_v)} \rightarrow
C^\infty(Y^{\circ}(F_v))\]</span> for some quasi-affine space <span
class="math inline">\(Y^{\circ}\)</span>, with <span
class="math inline">\(Y^{\circ} \times G&#39; \rightarrow
Y^{\circ}\)</span> some other action. We assume the Poisson summation
conjecture for <span class="math inline">\(X\)</span>. Often, one can
prove <span class="math display">\[\sum_{y \in Y^{\circ}(F)}
  I(f)(y)
  = \sum_{y \in Y^{\circ}(F)}
  I(\mathcal{F}_X(f))(y).\]</span> This gives the Poisson summation
formula for <span class="math inline">\(Y \times G&#39; \rightarrow
Y\)</span>.</p>
<p>It is often reasonable to define <span
class="math display">\[\mathcal{S}(Y(\mathbb{A}_F)) :=
\mathcal{S}(X(\mathbb{A}_F))_{H(\mathbb{A}_F)}.\]</span> You have to be
a bit careful at the infinite places (you want to take some closure, but
let’s not worry about that). You can think of <span
class="math inline">\(\mathcal{S}(X(\mathbb{A}_F)) \rightarrow
\mathcal{S}(Y(\mathbb{A}_F))\)</span> as a harmonic analytic analogue of
the map <span class="math inline">\(X \rightarrow[X / H]\)</span>, where
<span class="math inline">\([X / H]\)</span> is the stack that appeared
in yesterday’s exercise session.</p>
<p>Two examples:</p>
<div class="example">
<p><strong>Example 55</strong>. (Suggested to me by Aaron Slipper.) Take
<span class="math inline">\(V = \mathbb{G}_a^n\)</span> to be a vector
space, and <span class="math inline">\(V \times G \times H \rightarrow
V\)</span> any action. Then we get a Schwartz space for <span
class="math inline">\(V / H\)</span>. This seems a bit stupid, but you
can create some fairly complicated vector spaces <span
class="math inline">\(V\)</span> and get some interesting examples out
of this.</p>
</div>
<div id="example:cq6ud5xqwu" class="example">
<p><strong>Example 56</strong>. <span class="math inline">\(V =
\mathbb{G}_a^n \times \mathbb{G}_a^n\)</span> and <span
class="math inline">\(Q_n(x, y) := x y^{\intercal}\)</span>, and <span
class="math inline">\(Y_n(R) := \left\{ v \in V_n(R) : Q_n(v) = 0
\right\}\)</span> to be the zero locus. We have a Weil representation
<span class="math display">\[\rho : \mathrm{SL}_2(\mathbb{A}_F) \times
\operatorname{O}_{V_n}(\mathbb{A}_F) \times
\mathcal{S}(V_n(\mathbb{A}_F)) \rightarrow
\mathcal{S}(V_n(\mathbb{A}_F)).\]</span> Let <span
class="math inline">\(R := (\rho \otimes\mathrm{std}^\vee) \boxtimes
\mathrm{trivial} : \mathrm{SL}_2(\mathbb{A}_F) \otimes
\operatorname{O}_{V_n}(\mathbb{A}_F) \times \mathcal{S}(V_{n +
1}(\mathbb{A}_F)) \rightarrow \mathcal{S}(V_{n +
1}(\mathbb{A}_F))\)</span>, where the action is extended from the
subspace <span class="math display">\[\mathcal{S}(V_{n +
1}(\mathbb{A}_F)) \supseteq \mathcal{S}(V_n(\mathbb{A}_F)) \otimes
\mathcal{S}(\mathbb{A}_F^2)\]</span> Then you get a map (see <a href="#ref-MR4887846"
class="citation" data-cites="MR4887846">(Getz 2025)</a>) <span
class="math display">\[I : \mathcal{S}(V_{n +
1}(\mathbb{A}_F))_{r(\mathrm{SL}_2(\mathbb{A}_F))} \rightarrow
C^\infty(Y_n^{\circ}(\mathbb{A}_F)).\]</span> Note that <span
class="math inline">\(V_{n + 1}\)</span> is <em>not</em> spherical for
<span class="math inline">\(\operatorname{O}_n\)</span>. It is not even
homogeneous - the orthogonal group does not act transitively on <span
class="math inline">\(V_n\)</span>. Nevertheless, after we take these
coinvariants, we obtain a summation formula for the <span
class="math inline">\({\mathop{\mathrm{GO}}}_n\)</span>-spherical variety
<span class="math inline">\(Y_n\)</span>. The Fourier transform in this
case just comes a Fourier transform on a big vector space.</p>
<p>There’s a more complicated example, sort of combining this example
with that of the Siegel parabolic, due to Getz–Liu <a href="#ref-MR3916514"
class="citation" data-cites="MR3916514">(Getz and Liu 2019)</a>.</p>
</div>
<h3 id="fiber-bundle-method">Fiber bundle method</h3>
<p>Assume given affine <span class="math inline">\(G\)</span>-schemes
<span class="math inline">\(B_i\)</span> and equivariant maps <span
class="math inline">\(p_i : X \rightarrow B_i\)</span>, fitting into a
diagram <span class="math display">\[\begin{tikzcd}
    &amp; X \arrow[dl, &quot;p_1&quot;&#39;] \arrow[dr, &quot;p_2&quot;]
&amp; \\
    B_1 &amp; &amp; B_2
  \end{tikzcd}\]</span> Assume given compatible Poisson summation
formulae for the fibers of <span class="math inline">\(p_1\)</span> and
<span class="math inline">\(p_2\)</span>. Then we get the Poisson
summation formulae for <span class="math inline">\(X\)</span>.</p>
<p>Say this is a vector bundle, for example. Then you can just do
Poisson summation on all the vector spaces, and as long as the group
action preserves everything, you get a Poisson summation for the whole
thing. (That’s kind of interesting – maybe you don’t think about Poisson
summation formulas in families.) But it’s more interesting when you have
two of these and can combine them. Let’s give a simple example saying
what you can get out of this, which is very rich.</p>
<div class="example">
<p><strong>Example 57</strong>. Take <span class="math display">\[X =
\overline{(N \backslash \mathrm{SL}_3)}^{\mathrm{aff}}.\]</span> Let
<span class="math inline">\(V = \mathbb{G}_a^3\)</span> and let <span
class="math inline">\(V^\vee := \mathop{\mathrm{Hom}}(V,
\mathbb{G}_a)\)</span>. It’s not hard to verify that we can identify
<span class="math display">\[X(R) = \left\{(v, v^\vee) \in V(R) \times
V^\vee(R) : v^\vee(v) = 0 \right\}.\]</span> So it’s another one of
these cones. In this picture, we have our little diagram again: <span
class="math display">\[\begin{tikzcd}
      &amp; X \arrow[dl, &quot;p_1&quot;&#39;] \arrow[dr,
&quot;p_2&quot;] &amp; \\
      V &amp; &amp; V^\vee
    \end{tikzcd}\]</span> One Fourier transform is given by <span
class="math display">\[\mathcal{F}_1(f)(v, v^\vee) =
\int_{(V^\vee)^{\perp}(F)} f(v &#39;, v^\vee)
    \psi \left( \frac{v \wedge v &#39;}{v^\vee} \right)
    \, \frac{d v&#39;}{d v^\vee},\]</span> being a bit liberal here with
notation in order to make the equivariance properties more transparent,
e.g., in the argument of <span class="math inline">\(\psi\)</span>, we
think of <span class="math inline">\(v \wedge v &#39;\)</span> as
defining the linear map <span class="math display">\[x \mapsto \frac{v
\wedge v &#39; \wedge x}{e_1 \wedge e_2 \wedge e_3},\]</span> which is
then a functional that we can then divide by <span
class="math inline">\(v^\vee\)</span>. For <span
class="math inline">\(\mathcal{F}_2\)</span>, you exchange the roles of
<span class="math inline">\(v\)</span> and <span
class="math inline">\(v^\vee\)</span> in the above expression. The
operators <span class="math inline">\(\mathcal{F}_1\)</span> and <span
class="math inline">\(\mathcal{F}_2\)</span> extend to <span
class="math inline">\(L^2(X^\circ(F))\)</span> (there is an <span
class="math inline">\(\mathrm{SL}_3\)</span>-invariant measure on this),
and generate a subgroup of <span
class="math inline">\(\mathop{\mathrm{Aut}}(L^2(X^{\circ}(F)))\)</span>
isomorphic to <span class="math inline">\(S_3\)</span>. The latter is
really the Weyl group <span class="math inline">\(W\)</span> of a
maximal torus in <span class="math inline">\(\mathrm{SL}_3\)</span> –
the two Fourier transforms correspond to simple reflections. This tells
us that we can define <span class="math inline">\(\mathcal{F}_w\)</span>
for <span class="math inline">\(w \in W\)</span>. Let <span
class="math display">\[\mathcal{S}_{\mathrm{B K}}(X(F_v)) = \bigoplus_{w
\in W}
    \mathcal{F}_w(\mathcal{S}(X^{\circ}(F_v))).\]</span> This is a bit
of a cheat, but it’s obviously invariant under all the Fourier
transforms now. We can think of this as living inside <span
class="math inline">\(L^2(X^{\circ}(F))\)</span>.</p>
<p>We can adelize. We get Poisson summation formulae for <span
class="math inline">\(X\)</span>, with a whole non-abelian group of
Fourier transforms.</p>
<p>This example gives you <em>hidden equivariance</em>. You’ll notice
that this space is an example of the space from Example <a
href="#example:cq6ud5xqwu" data-reference-type="ref"
data-reference="example:cq6ud5xqwu">3.13</a>, just realized differently.
You can ask, what is the relationship between the two? Let <span
class="math inline">\(P \subset {\mathop{\mathrm{SO}}}_6\)</span> be the
stabilizer of an isotropic vector. Then <span
class="math display">\[\overline{P^{\mathrm{der}} \backslash
{\mathop{\mathrm{SO}}}_6}^{\mathrm{aff}} = \overline{(N \backslash
{\mathop{\mathrm{SL}}}_3)}^{\mathrm{aff}}.\]</span> The Schwartz spaces
are the same. But the actions are different - on the left, there is an
action of <span class="math inline">\(\mathbb{G}_m \times
{\mathop{\mathrm{SO}}}_6\)</span> (here <span
class="math inline">\(\mathbb{G}_m = P / P^{\mathrm{der}}\)</span>),
while on the right, we have an action of <span
class="math inline">\(\mathbb{G}_m^2 \times \mathrm{SL}_3\)</span> (here
<span class="math inline">\(\mathbb{G}_m^2 = T \leq
\mathrm{SL}_3\)</span> is the diagonal torus). Now, <span
class="math inline">\(\mathcal{F}_1\)</span> and <span
class="math inline">\(\mathcal{F}_2\)</span> do <em>not</em> commute
with the action of <span
class="math inline">\({\mathop{\mathrm{SO}}}_6\)</span>, but the long Weyl
element for <span class="math inline">\(\mathrm{SL}_3\)</span> defines
the operator <span class="math inline">\(\mathcal{F}_1 \mathcal{F}_2
\mathcal{F}_1\)</span>, which <em>does</em> commute with that action and
defines the Fourier transform arising naturally on the left.</p>
<p>The moral is that sometimes one can build equivariant Fourier
transforms by composing non-equivariant Fourier transforms.</p>
</div>
<h2 id="integral-representations-of-triple-product-l-functions">Integral
representations of triple product <span
class="math inline">\(L\)</span>-functions</h2>
<p>Maybe in the last five minutes, we’ll try to say something about what
we do in the preprint <a href="#ref-2025arXiv2503.21648" class="citation"
data-cites="2025arXiv2503.21648">(Getz et al. 2025)</a>. Let <span
class="math inline">\(\underline{r} =(r_1, r_2, r_3)\)</span> be as
before, and <span class="math inline">\(\mathrm{GL}_{\underline{r}} =
\prod_{i = 1}^3\mathrm{GL}_{r_i}\)</span>. Let <span
class="math display">\[H(R) := \{(h_1, h_2, h_3) \in
\mathrm{GL}_{\underline{r}}(R) \mid \det h_1 = \det h_2 = \det
h_3\}.\]</span> We construct an affine <span
class="math inline">\(\Psi\)</span>-bundle <span
class="math display">\[\mathcal{V}^{\circ} \rightarrow X \times
Y\]</span> equipped with an action of <span
class="math inline">\(\mathrm{GL}_{\underline{r}}
\times\mathrm{GL}_{\underline{r - 2}} \times H\)</span>. We assume that
<span class="math inline">\(f \in C^\infty(X^{\circ}(\mathbb{A}_F)
\times Y^{\circ}(\mathbb{A}_F), \mathcal{L}_\psi)\)</span>. We can then
form the theta function <span class="math display">\[\theta_f(g, g&#39;,
h) := \sum_{
    (x, y) \in
    X^{\circ}(F) \times Y^{\circ}(F)
  }
  \mathcal{R}(g, g&#39;, h) f(x, y).\]</span> For <span
class="math inline">\(\varphi \in \pi\)</span> on <span
class="math inline">\(\mathrm{GL}_{\underline{r}}(\mathbb{A}_F)\)</span>,
<span class="math inline">\(\varphi &#39; \in \pi &#39;\)</span> on
<span class="math inline">\(\mathrm{GL}_{\underline{r -
2}}(\mathbb{A}_F)\)</span> and <span class="math inline">\(s \in
\mathbb{C}\)</span> and <span class="math inline">\(\underline{s} \in
\mathbb{C}^3\)</span>, we define a zeta integral <span
class="math display">\[Z(f, \varphi, \varphi &#39;, s, \underline{s})
  := \int_{[\mathrm{GL}_{\underline{r}} \times\mathrm{GL}_{\underline{r
- 2}}] \times[H^{\circ}]}
  \theta_f(g, g&#39;, h)
  \varphi(g) \varphi &#39;(g&#39;)
  \eta_{s, \underline{s}}(g&#39;, h)
  \, d g \, d g&#39; \, d h,\]</span> with <span
class="math inline">\(\eta_{s, \underline{s}}\)</span> a suitable
quasi-character.</p>
<div class="theorem">
<p><strong>Theorem 58</strong> (Getz–Gu–Hsu–Leslie). </p>
<ol>
<li><p><em>This zeta integral is a holomorphic multiple of <span
class="math display">\[L(s + \tfrac{1}{2}, \pi^\vee, \otimes^3)
      \prod_{i = 1}^3 L(\tfrac{1}{2} + s + \frac{s_i - s_{i + 1} - s_{i
+ 2}}{r_i - 2}, \pi_i \times \pi_i &#39;)
      L(\tfrac{1}{2} + s_i, \pi_i).\]</span></em></p></li>
<li><p><em>The Poisson summation conjecture for <span
class="math inline">\(X \times Y\)</span> implies the meromorphic
continuation of the above.</em></p></li>
</ol>
</div>
<p>If you were looking at this with a critical eye and knew something
about the subject, you could just say, well, use the reductive monoid
attached to the triple product, for which the Poisson summation
conjecture implies the meromorphic continuation. So what have you really
done? What we argue is that the space <span class="math inline">\(X
\times Y\)</span> is designed so that one can apply the techniques
discussed earlier in this lecture, e.g., the fiber bundle method, to get
going. On the other hand, at least far as the speaker can see, there is
no known way of attacking the Poisson summation conjecture directly on
reductive monoids. The only real idea we have is to push it to the trace
formula and try to work there.</p>
<h1 id="sec:cq6tho3cpy">§4. Chen Wan’s lectures</h1>
<p>We’ll focus on the <em>period</em> aspect of the relative Langlands
duality of Ben-Zvi–Sakellaridis–Venkatesh. Recall from Chris’s talk that
we saw something about integral representations of <span
class="math inline">\(L\)</span>-functions, which involves integrating
automorphic forms <span class="math inline">\(\phi\)</span> on some
larger space <span class="math inline">\(Y\)</span> over some smaller
space <span class="math inline">\(X\)</span>. In nice cases, such
integrals represent <span class="math inline">\(L\)</span>-functions:
<span id="eq:cq6tg8d3hf" class="math display">\[\label{eq:cq6tg8d3hf}\tag{4.1}
  \int_X (\phi, \text{ automorphic form on $Y \supseteq X$}) =
\text{$L$-function}.\]</span> We’ve seen in previous lectures that if
you have this sort of integral representation of <span
class="math inline">\(L\)</span>-functions, then you can use it to study
the meromorphic continuation of <span
class="math inline">\(L\)</span>-functions, or their special values.
Such identities are thus very useful.</p>
<p>The examples might seem a bit <em>ad hoc</em>. Why should we
integrate automorphic forms on <span class="math inline">\(Y\)</span>
over <span class="math inline">\(X\)</span>, for certain pairs <span
class="math inline">\((X, Y)\)</span>? Is there some way to
systematically find, for a given <span
class="math inline">\(L\)</span>-function, which integrals represent
them? Can we determine systematically which <span
class="math inline">\(L\)</span>-functions are represented by some
integral? The theory of relative Langlands duality at least gives some
explanation of this in some cases. This is what we’ll talk about in our
lectures.</p>
<p>Let’s first say the rough idea. If you look at this kind of integral
<a href="#eq:cq6tg8d3hf" data-reference-type="eqref"
data-reference="eq:cq6tg8d3hf">\((4.1)\)</a>, it’s kind of an
automorphic integral involving the quotient variety <span
class="math inline">\(\mathcal{M} = Y / X\)</span> (whatever this
means). Relative Langlands duality generalizes the classical Langlands
correspondence to varieties: one passes from <span
class="math inline">\(\mathcal{M}\)</span> to some dual variety <span
class="math inline">\(\hat{\mathcal{M}}\)</span>, and the proposal in
relative Langlands duality is that <span
class="math display">\[(\text{automorphic integral on } \mathcal{M})
  =
  (\text{$L$-function associated to } \hat{\mathcal{M}}).\]</span>
Moreover, it’s a duality, which means that the same holds with the roles
of <span class="math inline">\(\mathcal{M}\)</span> and <span
class="math inline">\(\hat{\mathcal{M}}\)</span> reversed: <span
class="math display">\[(\text{automorphic integral on }
\hat{\mathcal{M}})
  =
  (\text{$L$-function associated to } \mathcal{M}).\]</span> Everything
is general at this point – later, we’ll say precisely what it means. But
the idea is that at least in terms of periods integrals of automorphic
forms, you have certain nice Hamiltonian spaces and dualities between
them so that the integrals attached to one space are given by the <span
class="math inline">\(L\)</span>-functions attached to the other.</p>
<p>Let’s now set up some notation. We’ll first define the automorphic
integrals associated to this data, and if there’s time, the <span
class="math inline">\(L\)</span>-functions and the duality. Let <span
class="math inline">\(K\)</span> be a global field, and <span
class="math inline">\(\mathbb{A} = \mathbb{A}_K\)</span> the ring of
adeles. Sometimes we’ll also work over a local field <span
class="math inline">\(F\)</span>, (e.g., <span
class="math inline">\(\mathbb{R}, \mathbb{C}, \mathbb{Q}_p,
\dotsc\)</span>). Let <span class="math inline">\(G\)</span> be a
connected reductive group defined over <span
class="math inline">\(K\)</span>. (If you’re not familiar with this
language, you can just think of the matrix groups that you’re familiar
with, such as <span class="math inline">\(\mathrm{GL}_n\)</span>, <span
class="math inline">\(\mathrm{SL}_n\)</span>, <span
class="math inline">\(\mathrm{PGL}_n\)</span>, <span
class="math inline">\({\mathop{\mathrm{SO}}}_n\)</span>, <span
class="math inline">\({\mathop{\mathrm{Sp}}}_{2 n}\)</span>.) Throughout
these lectures, we’ll mostly focus on the groups that are
<em>split</em>, i.e., that have a maximal split torus.</p>
<p>The foundation of the Langlands program is based on the duality
between these reductive groups. For each such group <span
class="math inline">\(G\)</span>, we can write down its dual group <span
class="math inline">\(\hat{G}\)</span>. Reductive groups are
parametrized by root data. For each root data, you can take its dual
root data, which then defines the dual group:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><span
class="math inline">\(G\)</span></th>
<th style="text-align: center;"><span
class="math inline">\(\hat{G}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span
class="math inline">\(\mathrm{GL}_n\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\mathrm{GL}_n\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span
class="math inline">\(\mathrm{SL}_n\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\mathrm{PGL}_n\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span
class="math inline">\(\mathrm{SO}_{2n+1}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\mathrm{Sp}_{2n}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span
class="math inline">\(\mathrm{SO}_{2n}\)</span></td>
<td style="text-align: center;"><span
class="math inline">\(\mathrm{SO}_{2n}\)</span></td>
</tr>
</tbody>
</table>
<p>The <em>Langlands conjecture</em> says roughly that automorphic
representations of <span class="math inline">\(G(\mathbb{A})\)</span>
should correspond to Langlands parameters <span
class="math inline">\(\phi : L_K \rightarrow
\hat{G}(\mathbb{C})\)</span> valued in the dual group, and similalry
with <span class="math inline">\(G\)</span> and <span
class="math inline">\(\hat{G}\)</span> swapped.</p>
<div id="definition:cq6tho3qgh" class="definition">
<p><strong>Definition 59</strong>. A <em>BZSV quadruple</em> for <span
class="math inline">\(G\)</span> is <span class="math inline">\(\Delta
=(G, H, \iota, \rho_H)\)</span>, where</p>
<ol>
<li><p><span id="enumerate:cq6tg8um5h"
label="enumerate:cq6tg8um5h"></span> <span class="math inline">\(H
\subset G\)</span> is a split connected reductive subgroup,</p></li>
<li><p><span id="enumerate:cq6tg8uyi6"
label="enumerate:cq6tg8uyi6"></span> <span class="math inline">\(\iota :
\mathrm{SL}_2 \rightarrow G\)</span> is a homomorphism (possibly
trivial) such that <span class="math inline">\(H\)</span> commutes with
<span class="math inline">\(\operatorname{image}(\iota)\)</span>, so
that we may extend to <span class="math inline">\(\iota : H \times
\mathrm{SL}_2 \rightarrow G\)</span>.</p></li>
<li><p><span id="enumerate:cq6tg8wpyk"
label="enumerate:cq6tg8wpyk"></span> <span
class="math inline">\(\rho_H\)</span> is a symplectic representation of
<span class="math inline">\(H\)</span>, i.e., a homomorphism <span
class="math inline">\(H \rightarrow \mathrm{Sp}(V)\)</span>.</p></li>
</ol>
</div>
<p>Define the automorphic quotient <span class="math inline">\([G] :=
G(K) \backslash G(\mathbb{A})\)</span>, and let <span
class="math inline">\(\phi :[G] \rightarrow \mathbb{C}\)</span> be an
automorphic form. The goal today is to define the period integral <span
class="math inline">\(\mathcal{P}_\Delta(\phi)\)</span> associated to a
quadruple <span class="math inline">\(\Delta\)</span> as above.</p>
<p>Let’s start with some easy special cases, before moving to the
general case.</p>
<ol>
<li><p><span id="enumerate:cq6tg85st6"
label="enumerate:cq6tg85st6"></span> Suppose <span
class="math inline">\(\iota = 1\)</span> (the trivial representation,
<span class="math inline">\(\mathbb{C}\)</span>) and <span
class="math inline">\(\rho_H = 0\)</span> (the <em>zero-dimensional</em>
symplectic representation <span class="math inline">\(\{0\}\)</span>),
thus <span class="math inline">\(\Delta =(G, H, 1, 0)\)</span>. Then
<span class="math display">\[\mathcal{P}_\Delta(\phi) := \int_{[H]}
\phi(h) \, d h.\]</span> (In general, this does not converge and must be
understood via truncation, etc.)</p></li>
<li><p><span id="enumerate:cq6tg85t0e"
label="enumerate:cq6tg85t0e"></span> Suppose still that <span
class="math inline">\(\iota = 1\)</span> is trivial, but allow <span
class="math inline">\(\rho_H\)</span> to be general. Then <span
class="math display">\[\mathcal{P}_\Delta(\phi) := \int_{[H]} \phi(h)
\cdot \Theta_{\rho_H}(h) \, d h,\]</span> where <span
class="math inline">\(\Theta_{\rho_H}\)</span> is a suitable theta
function, whose definition depends also upon the choice of a Schwartz
function:</p>
<ol type="a">
<li><p><span id="enumerate:cq6thb0l6i"
label="enumerate:cq6thb0l6i"></span> It’s easiest to define in the
special <em>polarized</em> case that <span class="math inline">\(\rho_H
= \tau \oplus \tau^\vee\)</span> for some <span
class="math inline">\(\tau : H \rightarrow\mathrm{GL}(W)\)</span>. In
that case, after choosing <span class="math inline">\(\varphi \in
\mathcal{S}(W(\mathbb{A}))\)</span>, we define <span
class="math display">\[\Theta_{\rho_H}(h) := \sum_{x \in W(F)}
\varphi(\tau(h) x).\]</span> To illustrate that case, we consider a
couple examples:</p>
<ol type="i">
<li><p><span id="enumerate:cq6thb0n66"
label="enumerate:cq6thb0n66"></span> Suppose <span
class="math display">\[\Delta =(\mathrm{GL}_n \times \mathrm{GL}_n,
\mathrm{GL}_n \times \mathrm{GL}_n, 1, \mathrm{std} \otimes \mathrm{std
\oplus(\mathrm{std} \otimes \mathrm{std})^\vee})\]</span> Then, writing
<span class="math inline">\(\phi = \phi_1 \otimes \phi_2\)</span> with
each <span class="math inline">\(\phi_i :[\mathrm{GL}_n] \rightarrow
\mathbb{C}\)</span>, we may take <span class="math inline">\(W =
{\mathop{\mathrm{Mat}}}_{n \times n}\)</span> above (the space of <span
class="math inline">\(n \times n\)</span> matrices), and we obtain <span
class="math display">\[\mathcal{P}_\Delta(\phi) := \int_{[\mathrm{GL}_n]
\times[\mathrm{GL}_n]} \phi_1(h_1) \phi_2(h_2) \sum_{x \in
{\mathop{\mathrm{Mat}}}_{n \times n}(F)}
        \varphi(h_1^{-1} x h_2) \, d h_1 \, d h_2.\]</span></p></li>
<li><p><span id="enumerate:cq6thb0ptu"
label="enumerate:cq6thb0ptu"></span> Take <span
class="math inline">\(\Delta =(\mathrm{GL}_n \times \mathrm{GL}_n,
\mathrm{GL}_n^{\mathrm{diag}}, 1, \mathrm{std} \oplus
\mathrm{std}^\vee)\)</span>. Then, taking <span
class="math inline">\(W\)</span> to be the <span
class="math inline">\(n\)</span>-dimensional vector space on which <span
class="math inline">\(\mathrm{GL}_n\)</span> acts by right
multiplication, we obtain <span
class="math display">\[\mathcal{P}_\Delta(\phi) :=
\int_{[\mathrm{GL}_n]} \phi_1(h) \phi_2(h) \sum_{x \in W(K)}
        \varphi(x h) \, d h,\]</span> which is the Rankin–Selberg
integral for <span class="math inline">\(\mathrm{GL}_n \times
\mathrm{GL}_n\)</span>.</p></li>
</ol></li>
<li><p><span id="enumerate:cq6thb0m6q"
label="enumerate:cq6thb0m6q"></span> In general, <span
class="math inline">\(\rho_H : H \rightarrow
\mathop{\mathrm{Sp}}(V)\)</span> induces the so-called Weil
representation, which may be realized on <span
class="math inline">\(\mathcal{S}(Y(\mathbb{A}))\)</span> for a maximal
isotropic subspace <span class="math inline">\(Y\)</span> of <span
class="math inline">\(V\)</span>. As you may know, the Weil
representation is not on <span
class="math inline">\(\mathop{\mathrm{Sp}}(V)\)</span>, but on its
double cover. So you can’t do it for an arbitrary symplectic
representation – need a condition called “anomaly-free” that allows you
to resolve the ambiguity, but let’s not go into the details there. There
is anyway some condition under which we can split the Weil
representation over <span class="math inline">\(H\)</span>, giving a
well-defined representation. The splitting is not necessarily unique,
and perhaps BZSV do not currently choose a canonical splitting, but it’s
expected that there is some natural splitting. Of course there is such a
natural splitting in the polarized case. In any event, one then sets,
for <span class="math inline">\(h \in H(\mathbb{A})\)</span> and <span
class="math inline">\(\varphi \in \mathcal{S}(Y(\mathbb{A}))\)</span>,
<span class="math display">\[\Theta_{\rho_H}(h) := \sum_{x \in Y(K)}
\Omega_{\rho_H}(h) \varphi(x).\]</span></p></li>
</ol></li>
<li><p><span id="enumerate:cq6thb84py"
label="enumerate:cq6thb84py"></span> In the fully general case, we
define <span id="eq:cq6thc4107" class="math display">\[\label{eq:cq6thc4107}\tag{4.2}
    \mathcal{P}_\Delta(\phi) := \int_{[H]} \mathcal{P}_\iota(\phi)(h)
\Theta_{\rho_H}(h) \, d h.\]</span> Here <span
class="math inline">\(\mathcal{P}_\iota\)</span> is the Fourier
coefficient of <span class="math inline">\(\phi\)</span> associated to
<span class="math inline">\(\iota\)</span>, defined as follows. We first
recall that <span class="math inline">\(\iota : \mathrm{SL}_2
\rightarrow G\)</span>. In particular, we can let <span
class="math inline">\(L :=
\mathrm{Cent}_G(\operatorname{image}(\iota(T_{\mathrm{SL}_2})))\)</span>,
with <span class="math inline">\(T_{\mathrm{SL}_2} \leq
\mathrm{SL}_2\)</span> the diagonal maximal torus consisting of elements
of the form <span class="math inline">\(\mathop{\mathrm{diag}}(t,
t^{-1})\)</span>. Then <span class="math inline">\(L\)</span> is a Levi
subgroup of <span class="math inline">\(G\)</span>. We also know, since
<span class="math inline">\(H\)</span> commutes with the image of <span
class="math inline">\(\iota\)</span>, that <span
class="math inline">\(H\)</span> is a subgroup of <span
class="math inline">\(L\)</span>. Now let <span class="math inline">\(U
:= \exp(\mathfrak{u})\)</span>, where <span
class="math inline">\(\mathfrak{u}\)</span> is the positive weight space
for <span
class="math inline">\(\mathop{\mathrm{Ad}}(\iota(\mathop{\mathrm{diag}}(t,
t^{-1})))\)</span>. We also define <span class="math inline">\(\bar{U}
:= \exp(\bar{\mathfrak{u}})\)</span>, with <span
class="math inline">\(\mathfrak{u}\)</span> the negative weight
space.</p>
<div id="example:cq6ueb2rz1" class="example">
<p><strong>Example 60</strong>. Take <span class="math inline">\(G =
\mathrm{GL}_{2 n}\)</span> and <span class="math inline">\(\iota :
\mathrm{SL}_2 \rightarrow \mathrm{GL}_{2 n}\)</span> given by <span
class="math display">\[\begin{pmatrix}
        t      &amp;  \\
               &amp; t^{-1} \\
      \end{pmatrix}
      \mapsto
      \begin{pmatrix}
        t I_n      &amp;  \\
                   &amp; t^{-1} I_n \\
      \end{pmatrix},\]</span> <span
class="math display">\[\begin{pmatrix}
        1 &amp; 1 \\
          &amp; 1 \\
      \end{pmatrix}
      \mapsto
      \begin{pmatrix}
        I_n      &amp;  I_n \\
                 &amp; I_n \\
      \end{pmatrix},\]</span> <span
class="math display">\[\begin{pmatrix}
        1      &amp;  \\
        1 &amp; 1 \\
      \end{pmatrix}
      \mapsto
      \begin{pmatrix}
        I_n      &amp;  \\
        I_n &amp;  I_n \\
      \end{pmatrix}.\]</span> Then <span class="math display">\[L =
\left\{
        \begin{pmatrix}
          a          &amp;  \\
                     &amp; b \\
        \end{pmatrix} : a, b \in \mathrm{GL}_n \right\},
      \quad
      U = \left\{
        \begin{pmatrix}
          I_n          &amp; \ast \\
                       &amp; I_n \\
        \end{pmatrix} \right\},
      \quad
      \bar{U} = \left\{
        \begin{pmatrix}
          I_n          &amp;  \\
          \ast          &amp; I_n \\
        \end{pmatrix} \right\}.\]</span></p>
</div>
<p>If <span class="math inline">\(\iota\)</span> is even (i.e., all the
weights of <span
class="math inline">\(\mathop{\mathrm{Ad}}(\iota(\mathop{\mathrm{diag}}(t,
t^{-1})))\)</span> are even), then the Fourier coefficient is given by a
very easy formula: <span id="eq:cq6thc26pn" class="math display">\[\label{eq:cq6thc26pn}\tag{4.3}
    \mathcal{P}_\iota(\phi)(h) := \int_{[U]} \phi(u h) \xi(u)^{-1} \, d
u,\]</span> where <span class="math inline">\(\xi :[U] \rightarrow
\mathbb{C}^\times\)</span> is a character defined, for <span
class="math inline">\(x \in \mathfrak{u}(\mathbb{A})\)</span>, by <span
class="math display">\[\xi(\exp(x)) := \psi \bigl( \langle x, \iota
\left(
      \begin{smallmatrix}
        0&amp;0\\
        1&amp;0 \\
      \end{smallmatrix}
    \right) \rangle \bigr),\]</span> where <span
class="math inline">\(\psi : K \backslash \mathbb{A} \rightarrow
\mathbb{C}^\times\)</span> is some fixed character.</p>
<div id="example:cq6ueb2vh0" class="example">
<p><strong>Example 61</strong>. In the above example, <span
class="math display">\[\xi
      \begin{pmatrix}
        I_n    &amp; x \\
                                                                                        &amp;
I_n \\
      \end{pmatrix}
      = \psi \left( \left\langle
          \begin{pmatrix}
            0        &amp; x \\
            0 &amp; 0 \\
          \end{pmatrix},
          \begin{pmatrix}
            0        &amp; 0 \\
            1 &amp; 0 \\
          \end{pmatrix} \right\rangle \right)
      = \psi(\mathop{\mathrm{trace}}(x)).\]</span></p>
</div>
<div id="exercise:cq6ueb2mev" class="exercise">
<p><strong>Exercise 10</strong>. Let <span class="math inline">\(G :=
\mathrm{GL}_n\)</span> and <span class="math inline">\(\iota :
\mathrm{SL}_2 \rightarrow \mathrm{GL}_n\)</span> be <span
class="math inline">\(\rho_{\mathop{\mathrm{sym}}}^{n - 1}\)</span>.
Then write down the Fourier coefficient <span
class="math inline">\(\mathcal{P}_\iota(\phi)\)</span>.</p>
</div>
<p>If <span class="math inline">\(\iota\)</span> is <em>not</em> even,
then we have a Weil representation <span
class="math inline">\(\Omega_\iota\)</span> of <span
class="math inline">\(U(\mathbb{A})\)</span> on <span
class="math inline">\(\mathcal{S}(Z(\mathbb{A}))\)</span>, where <span
class="math inline">\(Z\)</span> is a maximal isotropic subspace of the
weight <span class="math inline">\(1\)</span> space of <span
class="math inline">\(\mathop{\mathrm{Ad}}(\iota(\mathop{\mathrm{diag}}(t,
t^{-1})))\)</span>. Then we build another theta kernal <span
class="math inline">\(\Theta_\iota(u) := \sum_{x \in Z(K)}
\Omega_\iota(u) \varphi(x)\)</span>, where <span
class="math inline">\(\varphi \in \mathcal{S}(Z(\mathbb{A}))\)</span>.
The period integral (depending upon <span
class="math inline">\(\varphi\)</span>) is then given by integrating not
just against a character as in <a href="#eq:cq6thc26pn"
data-reference-type="eqref"
data-reference="eq:cq6thc26pn">\((4.3)\)</a>, but against the
theta function: <span id="eq:cq6thc48wh" class="math display">\[\label{eq:cq6thc48wh}\tag{4.4}
    \mathcal{P}_\iota(\phi) := \int_{[U]} \phi(u) \Theta_{\iota}(u) \, d
u.\]</span></p>
<p>So, in the integral <span
class="math inline">\(\mathcal{P}_\Delta(\phi)\)</span>, there are
possibly two different choices of Schwartz functions: one in the theta
kernel in <a href="#eq:cq6thc4107" data-reference-type="eqref"
data-reference="eq:cq6thc4107">\((4.2)\)</a>, and another in the
theta kernel in <a href="#eq:cq6thc48wh" data-reference-type="eqref"
data-reference="eq:cq6thc48wh">\((4.4)\)</a>. But in some special
cases (<span class="math inline">\(\iota\)</span> trivial or even), we
don’t need these.</p></li>
</ol>
<div id="example:cq6tho3o9b" class="example">
<p><strong>Example 62</strong>. Take <span class="math inline">\(\Delta
=(G, H, \iota, \rho_H)\)</span>, where <span class="math display">\[G
=\mathrm{GL}_{2 n},\]</span> <span class="math display">\[H =
\mathrm{GL}_n = \left\{
      \begin{pmatrix}
        h        &amp;  \\
                 &amp; h \\
      \end{pmatrix} \mid h \in \mathrm{GL}_n \right\},\]</span> <span
class="math inline">\(\rho_H = 0\)</span> and <span
class="math display">\[\iota :
    \begin{pmatrix}
      t      &amp;  \\
             &amp; t^{-1} \\
    \end{pmatrix}
    \mapsto
    \begin{pmatrix}
      t I_n &amp;  \\
            &amp; t^{-1} I_n \\
    \end{pmatrix},
    \quad
    \begin{pmatrix}
      1 &amp; 1 \\
        &amp; 1 \\
    \end{pmatrix}
    \mapsto
    \begin{pmatrix}
      I_n      &amp; I_n \\
               &amp; I_n \\
    \end{pmatrix}.\]</span> Then <span
class="math display">\[\mathcal{P}_\Delta(\phi) =
    \int_{[\mathrm{GL}_n] / \mathrm{GL}_1(\mathbb{A})}
    \int_{[{\mathop{\mathrm{Mat}}}_{n \times n}]} \phi \left(
      \begin{pmatrix}
        I_n      &amp; x \\
                 &amp; I_n \\
      \end{pmatrix}
      \begin{pmatrix}
        h &amp;  \\
          &amp; h \\
      \end{pmatrix}      
    \right)
    \psi(\mathop{\mathrm{trace}}(x))^{-1} \, d x
    \, d h,\]</span> which is relevant for the <em>Shalika
model</em>.</p>
</div>
<div id="exercise:cq6tho3oca" class="exercise">
<p><strong>Exercise 11</strong>. For <span class="math inline">\(G =
\mathrm{GL}_6\)</span>, find <span class="math inline">\(\Delta\)</span>
for which <span class="math inline">\(\mathcal{P}_\Delta(\phi)\)</span>
is given by <span class="math display">\[\int_{[\mathrm{GL}_2]}
\int_{[{\mathop{\mathrm{Mat}}}_{2 \times 2}^3]} \phi
    \left(
      \begin{pmatrix}
        I_2      &amp; X &amp; Z \\
                 &amp; I_2 &amp; Y \\
                 &amp;  &amp; I_2 \\
      \end{pmatrix}
      \begin{pmatrix}
        h      &amp;  &amp;  \\
               &amp; h &amp;  \\
               &amp;  &amp; h \\
      \end{pmatrix}\right)
    \psi(\mathop{\mathrm{trace}}(X + Y))^{-1}
    \, d X \, d Y \, d Z \, d h.\]</span></p>
</div>
<div id="example:cq6tho3m7k" class="example">
<p><strong>Example 63</strong>. <span class="math inline">\(\iota :
\mathrm{SL}_2 \rightarrow \mathrm{GL}_3\)</span> given by <span
class="math inline">\(h \mapsto \mathop{\mathrm{diag}}(h, 1)\)</span> is
<em>not</em> even, because we get odd weight spaces for <span
class="math inline">\(\mathop{\mathrm{diag}}(t, t^{-1}, 1)\)</span>
acting via the adjoint representation for <span
class="math inline">\(\mathrm{GL}_3\)</span>.</p>
</div>
<p>Continuing, let <span class="math inline">\(G\)</span> be be a split
connected reductive group over <span class="math inline">\(K\)</span>.
Recall that a BZSV quadruple is <span class="math inline">\(\Delta =(G,
H, \iota, \rho_H)\)</span>, where <span class="math inline">\(H \subset
G\)</span> is a split connected reductive group, <span
class="math inline">\(\iota : \mathrm{SL}_2 \rightarrow G\)</span> has
image commuting with <span class="math inline">\(H\)</span>, and <span
class="math inline">\(\rho_H : H \rightarrow
\mathop{\mathrm{Sp}}(V)\)</span> is a symplectic representation. Then,
given <span class="math inline">\(\phi :[G] \rightarrow
\mathbb{C}\)</span>, we defined <span
class="math display">\[\mathcal{P}_\Delta(\phi) := \int_{[H]}
\mathcal{P}_\iota(\phi)(h) \Theta_{\rho_H}(h) \, d h.\]</span> We recall
also that there were Schwartz functions entering into this definition,
but we omit this from our notation for simplicity.</p>
<p>There will be some conditions that one can impose on these
quadruples, called <em>hyperspherical</em> and <em>anomaly-free</em>.
Under these conditions, <em>relative Langlands duality</em> is a
conjecture saying that there should be a duality between such quadruples
<span id="eq:cq6txrs6zo" class="math display">\[\label{eq:cq6txrs6zo}\tag{4.5}
  \Delta =(G, H, \iota, \rho_H) \leftrightarrow
  \hat{\Delta} =
  (\hat{G}, \hat{H}&#39;, \hat{\iota}&#39;,
\rho_{\hat{H}&#39;}).\]</span></p>
<div id="remark:cq6txru6kw" class="remark">
<p><strong>Remark 64</strong>. In general, for the duality, with <span
class="math inline">\(\Delta\)</span> dual to <span
class="math inline">\(\hat{\Delta}\)</span>, one is a quadruple for
<span class="math inline">\(G\)</span>, while the other is a quadruple
for <span class="math inline">\(\hat{G}\)</span>. But the other three
data should be viewed as a whole, i.e., <span class="math inline">\((H,
\iota, \rho_H)\)</span> is dual to <span
class="math inline">\((\hat{H}&#39;, \hat{\iota}&#39;,
\rho_{\hat{H}&#39;})\)</span>, but the duality is not defined at the
level of individual entries in these tuples.</p>
</div>
<p>There are then several conjectures that one can associate to this
duality. In my talk, we will focus on the <em>period integral
conjecture</em> of BZSV. If you want to summarize it in one line, it
says that if you have one quadruple that is dual to another one, then
the period for <span class="math inline">\(\Delta\)</span> should be
roughly equal to the <span class="math inline">\(L\)</span>-function for
<span class="math inline">\(\hat{\Delta}\)</span>, and vice-versa: <span
class="math display">\[P_{\Delta} = L_{\hat{\Delta}}, \qquad
  P_{\hat{\Delta}} = L_{\Delta}.\]</span> So far for this whole picture,
we only did one thing, which is we defined the period. We next need to
define the <span class="math inline">\(L\)</span>-functions, and then
explain which quadruples should admit such a duality. (One should not
expect a duality for arbitrary quadruples.)</p>
<p>We’ll next define define the <span
class="math inline">\(L\)</span>-functions. We recall that, because the
image of <span class="math inline">\(\iota\)</span> commutes with <span
class="math inline">\(H\)</span>, the map <span
class="math inline">\(\iota\)</span> extends to <span
class="math inline">\(\iota : H \times \mathrm{SL}_2 \rightarrow
G\)</span>. Using this homomorphism and the adjoint action, we get an
action of <span class="math inline">\(H \times \mathrm{SL}_2\)</span> on
<span class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>. We may
thus decompose <span class="math display">\[\mathfrak{g} = \bigoplus_{k
\geq 0} \rho_k \otimes {\mathop{\mathrm{Sym}}}^k,\]</span> where the <span
class="math inline">\(\rho_k\)</span> are representations of <span
class="math inline">\(H\)</span>. Now the adjoint representation of
<span class="math inline">\(G\)</span> on its whole Lie algebra is an
orthogonal representation (because it fixes the Killing form), but if
you look at the symmetric powers <span
class="math inline">\({\mathop{\mathrm{Sym}}}^k\)</span> of <span
class="math inline">\(\mathrm{SL}_2\)</span>, when <span
class="math inline">\(k\)</span> is even, it is an orthogonal
representation, while when <span class="math inline">\(k\)</span> is
odd, is a symplectic representation. Since the tensor should be of
orthogonal type, we also know that <span
class="math inline">\(\rho_k\)</span> is orthogonal (resp. symplectic)
when <span class="math inline">\(k\)</span> is even (resp. odd).</p>
<p>We can do the same thing for the dual side of <a
href="#eq:cq6txrs6zo" data-reference-type="eqref"
data-reference="eq:cq6txrs6zo">\((4.5)\)</a>, i.e., using <span
class="math inline">\(\hat{\iota} &#39; : \hat{H} &#39; \times
\mathrm{SL}_2 \rightarrow G\)</span>, we get <span
class="math display">\[\hat{\mathfrak{g}} = \bigoplus_{k \geq 0}
  \hat{\rho}_K \otimes {\mathop{\mathrm{Sym}}}^k,\]</span> with <span
class="math inline">\(\hat{\rho}_K\)</span> a representation of <span
class="math inline">\(\hat{H}&#39;\)</span>.</p>
<p>We can now state the <em>period integral conjecture of BZSV</em>.</p>
<ol>
<li><p>Let <span class="math inline">\(\pi\)</span> be a discrete
automorphic representation of <span
class="math inline">\(G(\mathbb{A})\)</span>. Let <span
class="math inline">\(\nu : \pi \rightarrow L^2([G])\)</span>. Then
<span class="math inline">\(\mathcal{P}_\Delta(\phi) \neq 0\)</span> for
some <span class="math inline">\(\phi \in
\mathop{\mathrm{image}}(\nu)\)</span> only if the Arthur parameter of
<span class="math inline">\(\pi\)</span> factors through <span
class="math display">\[\hat{\iota}&#39; : \hat{H}&#39;(\mathbb{C})
\times \mathrm{SL}_2(\mathbb{C}) \rightarrow
\hat{G}(\mathbb{C}).\]</span> To be a bit more precise, recall that the
Arthur parameter for <span class="math inline">\(\pi\)</span> is
(conjecturally) a map <span class="math inline">\(\omega_\pi : L_K
\times \mathrm{SL}_2(\mathbb{C}) \rightarrow
\hat{G}(\mathbb{C})\)</span>, where <span
class="math inline">\(L_K\)</span> is the conjectural Langlands group.
The meaning of “factors through” is then that there exists an Arthur
parameter <span class="math inline">\(\omega_\sigma : L_K \times
\mathrm{SL}_2(\mathbb{C}) \rightarrow \hat{H}&#39;(\mathbb{C})\)</span>
(of an automorphic representation <span
class="math inline">\(\sigma\)</span> of <span class="math inline">\(H
&#39;(\mathbb{A})\)</span>) such that <span
class="math display">\[\omega_\pi = \hat{\iota} &#39; \circ
(\omega_\sigma \times
{\mathop{\mathrm{id}}}_{{\mathop{\mathrm{SL}}}_2}),\]</span> fitting into a
commutative diagram <span class="math display">\[\begin{tikzcd}
      L_K \times \mathrm{SL}_2(\mathbb{C}) \arrow[r,
&quot;\omega_\pi&quot;] \arrow[d, &quot;\omega_\sigma&quot;&#39;,
dashed] &amp; \hat{G}(\mathbb{C}) \\
      \hat{H}&#39;(\mathbb{C}) \times \mathrm{SL}_2(\mathbb{C})
\arrow[ur, &quot;\hat{\iota}&#39;&quot;&#39;] &amp;
    \end{tikzcd}\]</span> The content of “factors through” is thus that
<span class="math inline">\(\pi\)</span> is the Langlands functorial
transfer of an automorphic representation <span
class="math inline">\(\sigma\)</span> of <span class="math inline">\(H
&#39;(\mathbb{A})\)</span>. Assume that this is the case, and assume
that <span class="math inline">\(\sigma\)</span> is tempered (i.e., that
<span class="math inline">\(\omega_\sigma |_{\mathrm{SL}_2(\mathbb{C})}
\equiv 1\)</span>). Then we can choose <span
class="math inline">\(\nu\)</span> such that <span
class="math display">\[\left\lvert \mathcal{P}_\Delta(\phi)
\right\rvert^2
    \doteq
    \frac{
      L(\tfrac{1}{2}, \sigma, \rho_{\hat{H}&#39;})
      \prod_{k \geq 0} L(\frac{k}{2} + 1, \sigma, \hat{\rho}_K)}{L(1,
\sigma, \mathop{\mathrm{Ad}})^2}.\]</span> In other words, on the dual
side, we get two things from <span
class="math inline">\(\hat{H}&#39;\)</span> and <span
class="math inline">\(\hat{\iota}&#39;\)</span>. It first gives you
functoriality, i.e., the period is nonzero only if it factors through
<span class="math inline">\(\hat{\iota}&#39;\)</span>. It also gives you
the grading into <span class="math inline">\(k\)</span>’s and the second
factor in the numerator. Finally, the symplectic representation gives
you <span class="math inline">\(L\)</span>-values at <span
class="math inline">\(1/2\)</span>.</p>
<p>The equal sign is dotted because there are several other factors,
e.g. volume terms, quantities depending upon the sizes of Arthur
packets, etc.</p></li>
<li><p>Conversely, <span
class="math inline">\(\mathcal{P}_{\hat{\Delta}}\)</span> is “equal” to
<span class="math inline">\(L_\Delta\)</span>.</p></li>
</ol>
<p>Two special cases:</p>
<ol>
<li><p><span id="enumerate:cq6txwuycw"
label="enumerate:cq6txwuycw"></span> <span
class="math inline">\(\hat{\Delta} =(\hat{G}, \hat{H}&#39;, 1,
0)\)</span>. Then the conjecture says that <span
class="math inline">\(\mathcal{P}_\Delta(\phi)\)</span> detects the
functoriality from <span
class="math inline">\(H&#39;(\mathbb{A})\)</span> to <span
class="math inline">\(G(\mathbb{A})\)</span>. For instance, suppose (as
discussed earlier) <span class="math inline">\(\Delta =(\mathrm{GL}_{2
n}, \mathrm{GL}_n,(2^n), 0)\)</span>, where <span
class="math inline">\(\mathrm{GL}_n\)</span> is embedded like <span
class="math inline">\(\mathop{\mathrm{diag}}(h, h)\)</span>, and <span
class="math inline">\((2^n)\)</span> means we take <span
class="math inline">\(\iota : \mathop{\mathrm{diag}}(t, t^{-1}) \mapsto
\mathop{\mathrm{diag}}(t I_n, t^{-1} I_n)\)</span>. Then <span
class="math inline">\(\hat{\Delta} =(\mathrm{GL}_{2 n},
{\mathop{\mathrm{Sp}}}_{2 n}, 1, 0)\)</span>. Thus <span
class="math inline">\(\mathcal{P}_\Delta \neq 0\)</span> only if <span
class="math inline">\(\phi\)</span> comes from the functorial lifting
from <span class="math inline">\({\mathop{\mathrm{SO}}}_{2 n +
1}(\mathbb{A})\)</span> to <span class="math inline">\(\mathrm{GL}_{2
n}(\mathbb{A})\)</span>.</p></li>
<li><p><span id="enumerate:cq6txwu9pz"
label="enumerate:cq6txwu9pz"></span> Let’s consider next the case where
<span class="math inline">\(\hat{\Delta} =(\hat{G}, \hat{G}, 1,
\hat{\rho}_{\hat{G}})\)</span>, i.e., we only have a symplectic
representation (but no <span
class="math inline">\(\mathrm{SL}_2\)</span> representation). Then the
conditions simplify and what we get is that <span
class="math display">\[\left\lvert \mathcal{P}_\Delta(\phi)
\right\rvert^2 \doteq \frac{L(\tfrac{1}{2}, \pi,
\hat{\rho}_{\hat{G}})}{L(1, \pi, \mathop{\mathrm{Ad}})}.\]</span> In
other words, in this case, the period corresponds to a special value of
<span class="math inline">\(L\)</span>-functions.</p></li>
</ol>
<p>The general case will be some combination of these two cases: some
detection of functoriality, and some special values.</p>
<div id="exercise:cq6txvu33z" class="exercise">
<p><strong>Exercise 12</strong>. Check this for <span
class="math inline">\(\Delta =(\mathrm{GL}_n \times \mathrm{GL}_n,
\mathrm{GL}_n \times \mathrm{GL}_n, 1,(\mathop{\mathrm{std}}\otimes
\mathop{\mathrm{std}})^\vee \oplus(\mathop{\mathrm{std}}\otimes
\mathop{\mathrm{std}}))\)</span> and <span
class="math inline">\(\hat{\Delta} =(\mathrm{GL}_n \times \mathrm{GL}_n,
\mathrm{GL}_n, 1, \mathop{\mathrm{std}}\oplus
{\mathop{\mathrm{std}}}^\vee)\)</span>, where it corresponds to the
results of Godement–Jacquet and Rankin–Selberg.</p>
</div>
<p>This is now the rough statement of the period conjecture, but we
still haven’t said exactly what things are dual to each other, and which
categories we’re working with (i.e., which quadruples). Let’s now
discuss that point. We continue to fix our <span
class="math inline">\(G\)</span> and <span
class="math inline">\(\hat{G}\)</span>. The relative Langlands duality
goes between <em>smooth, anomaly-free, hyperspherical Hamiltonian
spaces</em> <span class="math inline">\(\mathcal{M} \leftrightarrow
\hat{\mathcal{M}}\)</span> for <span class="math inline">\(G\)</span>
and <span class="math inline">\(\hat{G}\)</span>, respectively. Let’s
explain how to attach, to a quadruple <span class="math inline">\(\Delta
=(G, H, \iota, \rho_H)\)</span>, a <span
class="math inline">\(G\)</span>-Hamiltonian space <span
class="math inline">\(\mathcal{M}_\Delta\)</span>. The association is
easy to understand in special cases:</p>
<ol>
<li><p><span class="math inline">\(\Delta =(G, H, 1, 0)\)</span>. Then
<span class="math inline">\(\mathcal{M}_\Delta = T^\ast(G / H)\)</span>
is just the cotangent bundle.</p></li>
<li><p><span class="math inline">\(\Delta =(G, G, 1, \rho_G)\)</span>,
where <span class="math inline">\(\rho_G : G \rightarrow
\mathop{\mathrm{Sp}}(V)\)</span>. Then <span
class="math inline">\(\mathcal{M}_\Delta = V\)</span>.</p></li>
<li><p>Combining these two cases together, take <span
class="math inline">\(\Delta =(G, H, 1, \rho_H)\)</span>, where <span
class="math inline">\(\rho_H : H \rightarrow
\mathop{\mathrm{Sp}}(V)\)</span>. Then <span
class="math inline">\(\mathcal{M}_\Delta =(V \times_{\mathfrak{h}^\ast}
\mathfrak{g}^\ast) \times^H G\)</span>. Here <span
class="math inline">\(V \times_{\mathfrak{h}^\ast}
\mathfrak{g}^\ast\)</span> is the fiber product, where <span
class="math inline">\(V \rightarrow \mathfrak{h}^\ast\)</span> is the
moment map (coming from the symplectic action of <span
class="math inline">\(H\)</span>). (This is sometimes called “symplectic
induction”.)</p></li>
</ol>
<p>In general, recall that <span class="math inline">\(\iota\)</span>
gives <span class="math inline">\(L =
{\mathop{\mathrm{Cent}}}_G(\iota(\mathop{\mathrm{diag}}(t,
t^{-1})))\)</span> and <span class="math inline">\(U =
\exp(\mathfrak{u})\)</span>, where <span
class="math inline">\(\mathfrak{u}\)</span> is the positive weight space
for <span
class="math inline">\(\mathop{\mathrm{Ad}}(\iota(\mathop{\mathrm{diag}}(t,
t^{-1})))\)</span>. Let <span class="math inline">\(\mathfrak{u}_+
\subseteq \mathfrak{u}\)</span> denote the weight <span
class="math inline">\(\geq 2\)</span> space. Then <span
class="math inline">\(\mathfrak{u} / \mathfrak{u}_+\)</span> is the
weight one space. (We remark that <span
class="math inline">\(\mathfrak{u} / \mathfrak{u}_+ = \{0\}\)</span> if
and only if <span class="math inline">\(\iota\)</span> is even in the
terminology introduced earlier.) The quotient <span
class="math inline">\(\mathfrak{u} / \mathfrak{u}_+\)</span> is a
symplectic vector space. <span class="math display">\[\mathcal{M}_\Delta
= \left(
    (V \times \mathfrak{u} / \mathfrak{u}_+)
    \times_{(\mathfrak{h} + \mathfrak{u})^\ast}
    \mathfrak{g}^\ast\right)
  \times^{H U}
  G.\]</span></p>
<p>We have <span class="math inline">\(\mathfrak{u} / \mathfrak{u}_+
\rightarrow \mathfrak{u}^\ast\)</span> via <span class="math inline">\(x
\mapsto \kappa(x) + \kappa_f\)</span>, where <span
class="math inline">\(\kappa : \mathfrak{u} / \mathfrak{u}_+
\rightarrow(\mathfrak{u} / \mathfrak{u}_+)^\ast\)</span> comes from the
symplectic pairing and the shift <span class="math inline">\(\kappa_f
\in \mathfrak{u}^\ast\)</span> is given by <span class="math inline">\(Y
\mapsto \left\langle \iota \left(
    \begin{smallmatrix}
      0&amp;0\\
      1&amp;0 \\
    \end{smallmatrix}
  \right), Y \right\rangle\)</span>. The <em>hyperspherical</em>
condition involves several requirements. Many concern avoiding the cases
of covering groups, where stabilizers need not be connected. The main
requirement is <em>coisotropy</em>, which says that the space <span
class="math inline">\(K(\mathcal{M})^G\)</span> of <span
class="math inline">\(G\)</span>-invariant rational functions on <span
class="math inline">\(\mathcal{M}\)</span> is commutative with respect
to the Poisson bracket.</p>
<p>There is a structure theorem of BZSV that says that every smooth
hyperspherical Hamiltonian <span class="math inline">\(G\)</span>-space
<span class="math inline">\(\mathcal{M}\)</span> arises as <span
class="math inline">\(\mathcal{M}_\Delta\)</span> for some unique BZSV
quadruple <span class="math inline">\(\Delta\)</span>. Tomorrow, we’ll
explain how in terms of the quadruples to see the coisotropy conditions;
we will also explain the “anomaly-free” condition. (Note that so far we
could take any subgroup <span class="math inline">\(H\)</span> in such a
quadruple, which would be too powerful; the hyperspherical condition
says roughly that <span class="math inline">\(H\)</span> is a spherical
subgroup in the special case <a href="#enumerate:cq6txwuycw"
data-reference-type="eqref"
data-reference="enumerate:cq6txwuycw">\((1)\)</a>, while
in the special case <a href="#enumerate:cq6txwu9pz"
data-reference-type="eqref"
data-reference="enumerate:cq6txwu9pz">\((2)\)</a>, it
says that the symplectic representation should be multiplicity-free in a
certain sense to be discussed tomorrow.)</p>
<div id="remark:cq6ueb2get" class="remark">
<p><strong>Remark 65</strong>. For a reductive group over a local field,
local Langlands classifies isomorphism classes of irreducible
representations in terms of conjugacy classes of maps from <span
class="math inline">\(W_F &#39;\)</span> to <span
class="math inline">\(\hat{G}\)</span>. (For a compact connected Lie
group, there is a simpler bijection involving <span
class="math inline">\(S^1\)</span> in place of <span
class="math inline">\(W_F&#39;\)</span>.) In this setting, there is a
Hamiltonian <span class="math inline">\(G\)</span>-space <span
class="math inline">\(\mathcal{M}\)</span> and a Hamiltonian <span
class="math inline">\(\hat{G}\)</span>-space <span
class="math inline">\(\hat{\mathcal{M}}\)</span>. There is something
like quantization. Formally, <span class="math inline">\(\mathcal{M}
=T^\ast X\)</span> and <span class="math inline">\(\hat{\mathcal{M}} =
T^\ast \hat{X}\)</span>. There are actions <span class="math inline">\(G
\circlearrowright L^2(X)\)</span> and <span
class="math inline">\(\hat{G} \circlearrowright L^2(\hat{X})\)</span>.
For instance, if <span class="math inline">\(\mathcal{M} = T^\ast(G /
H)\)</span>, then <span class="math inline">\(X= G / H\)</span>. It
makes sense to consider the subset <span
class="math display">\[{\mathop{\mathrm{Irr}}}_X(G(F)) = \left\{ \pi \in
\mathop{\mathrm{Irr}}(G(F)) \text{ appearing in } L^2(X)
\right\}.\]</span> This should correspond to <span
class="math display">\[\left\{ \phi : W_F &#39; \rightarrow
\hat{G}(\mathbb{C}) : \hat{\mathcal{M}}^{\mathop{\mathrm{image}}(\phi)}
\neq \emptyset \right\}.\]</span></p>
</div>
<p>Continuing, let’s first recall what we’ve been doing in the past few
days, in the reverse order. We start with a split reductive group <span
class="math inline">\(G\)</span>, with dual group <span
class="math inline">\(\hat{G}\)</span>. We said at the end of yesterday
that the relative Langlands duality is a duality, conjectured by BZSV,
between certain Hamiltonian spaces <span
class="math inline">\(\mathcal{M}\)</span> and <span
class="math inline">\(\hat{\mathcal{M}}\)</span> for <span
class="math inline">\(G\)</span> and <span
class="math inline">\(\hat{G}\)</span> satisfying certain conditions:
anomaly-free and hyperspherical. The structure theorem of BZSV states
that any hyperspherical <span class="math inline">\(\mathcal{M}\)</span>
is of the course <span class="math inline">\(\mathcal{M} =
\mathcal{M}_\Delta\)</span> for some unique BZSV quadruple <span
class="math inline">\(\Delta =(G, H, \iota, \rho_H)\)</span>, where we
recall that <span class="math inline">\(H \subset G\)</span> is a
reductive subgroup, <span class="math inline">\(\iota : \mathrm{SL}_2
\rightarrow G\)</span> commutes with <span
class="math inline">\(H\)</span>, and <span class="math inline">\(\rho_H
: H \rightarrow\mathrm{Sp}(V)\)</span>.</p>
<div id="definition:cq6ueb08jo" class="definition">
<p><strong>Definition 66</strong>. We say that a quadruple <span
class="math inline">\(\Delta\)</span> is <em>anomaly-free
hyperspherical</em> if the associated Hamiltonian space <span
class="math inline">\(\mathcal{M}_\Delta\)</span> is.</p>
</div>
<p>How does one see these conditions in terms of the quadruples? Recall
that, given <span class="math inline">\(\Delta =(G, H, \iota,
\rho_H)\)</span>, from <span class="math inline">\(\iota\)</span>, we
get <span class="math inline">\(L :=
\operatorname{Cent}_G(\operatorname{image}(\iota(\mathop{\mathrm{diag}}(t,
t^{-1}))))\)</span> and <span class="math inline">\(U =
\exp(\mathfrak{u})\)</span>, with <span
class="math inline">\(\mathfrak{u}\)</span> the positive weight space.
We also let <span class="math inline">\(\mathfrak{u}_+\)</span> denote
the weight <span class="math inline">\(\geq 2\)</span> space, so that
<span class="math inline">\(\mathfrak{u} / \mathfrak{u}_+\)</span> is
actually the weight <span class="math inline">\(1\)</span> space; it is
also a symplectic representation of <span
class="math inline">\(H\)</span>. We denote this representation by <span
class="math inline">\(\rho_\iota\)</span>. From this quadruple, we
define another quadruple, but with trivial <span
class="math inline">\(\iota\)</span>, by <span id="eq:cq6uefar6y" class="math display">\[\label{eq:cq6uefar6y}\tag{4.6}
  \Delta_{\mathrm{red}} :=(L, H, 1, \rho_{H, \iota}),\]</span> where
<span class="math inline">\(\rho_{H, \iota} = \rho_H \oplus
\rho_\iota\)</span>. The reason we write “<span
class="math inline">\(\mathrm{red}\)</span>” for “reductive” is that the
<span class="math inline">\(\iota\)</span> part in the period integral
gives some unipotent period, so if you want a period integral over a
reductive subgroup, that’s equivalent to saying that <span
class="math inline">\(\iota\)</span> is trivial. We say that <span
class="math inline">\(\Delta\)</span> is <em>reductive</em> if <span
class="math inline">\(\iota = 1\)</span>, or equivalently, if <span
class="math inline">\(\Delta =
\Delta_{\mathop{\mathrm{red}}}\)</span>.</p>
<div id="definition:cq6ueb2cbs" class="definition">
<p><strong>Definition 67</strong>. We say that <span
class="math inline">\(\Delta\)</span> is <em>anomaly-free</em> if this
symplectic representation <span class="math inline">\(\rho_{H,
\iota}\)</span> is an anomaly-free symplectic representation of <span
class="math inline">\(H\)</span>, in the sense defined below.</p>
</div>
<div id="definition:cq6ueb0lsb" class="definition">
<p><strong>Definition 68</strong>. Let <span class="math inline">\(\pi :
H \rightarrow\mathrm{Sp}(V)\)</span> be a symplectic representation.
Recall that <span class="math inline">\(H\)</span> is split. Let <span
class="math inline">\(T \subset H\)</span> denote the maximal split
torus. We may then restrict our representation to <span
class="math inline">\(T\)</span>. Since the representation is
symplectic, its restriction to <span class="math inline">\(T\)</span>
will be self-dual and even-dimensional, so we can decompose <span
class="math inline">\(\pi |_T = \tau \oplus \tau^\vee\)</span>
(non-uniquely, although the definition to follow does not depend upon
this choice). We say that <span class="math inline">\(\pi\)</span> is
<em>anomaly-free</em> if there exists <span class="math inline">\(\chi :
T \rightarrow \mathrm{GL}_1\)</span> and <span
class="math inline">\(\eta : H \rightarrow \mathrm{GL}_1\)</span> such
that <span class="math inline">\(\det(\tau) = \chi^2 \cdot \eta
|_T\)</span>.</p>
</div>
<p>This means roughly that if you take half the weights of the <span
class="math inline">\(\pi\)</span>, you get a square in the weight
lattice. From the point of view of period integrals, recall that we
really needed a Weil representation, but this is usually not defined on
<span class="math inline">\(\mathrm{Sp}(V)\)</span>, but rather on its
metaplectic cover <span
class="math inline">\(\tilde{\mathop{\mathrm{Sp}}}(V)
\rightarrow\mathrm{Sp}(V)\)</span>; this anomaly-free condition ensures
that the image of the representation has a splitting inside this cover.
There are several places where this condition becomes natural.</p>
<div id="exercise:cq6ueb0ys0" class="exercise">
<p><strong>Exercise 13</strong>. Check that Definition <a
href="#definition:cq6ueb0lsb" data-reference-type="ref"
data-reference="definition:cq6ueb0lsb">4.10</a> is independent of the
choice of the decomposition of <span class="math inline">\(\pi
|_T\)</span>.</p>
</div>
<div class="remark">
<p><strong>Remark 69</strong>. From the above definition, one can easily
see that <span class="math inline">\(\Delta\)</span> is anomaly-free if
and only if <span
class="math inline">\(\Delta_{\mathop{\mathrm{red}}}\)</span> is.
Indeed, what really matters is the symplectic representation.</p>
</div>
<p>Now let’s discuss how to see the coisotropy condition. Recall that
<span class="math inline">\(\mathcal{M}\)</span> is coisotropic if the
ring <span class="math inline">\(K(\mathcal{M})^G\)</span> of <span
class="math inline">\(G\)</span>-invariant rational functions is
commutative with respect to the Poisson bracket. What condition does
this place on the quadruples? To see this, we may reduce to the case
that <span class="math inline">\(\Delta\)</span> is reductive.</p>
<div class="proposition">
<p><strong>Proposition 70</strong>. <em>(See <a href="#ref-2024arXiv2409.04677" class="citation"
data-cites="2024arXiv2409.04677">(Ben-Zvi, Sakellaridis, and Venkatesh
2024, sec. 3)</a>.) For <span class="math inline">\(\Delta =
\Delta_{\mathop{\mathrm{red}}}\)</span>, we have that <span
class="math inline">\(\mathcal{M}_\Delta\)</span> is coisotropic if and
only if the following conditions hold:</em></p>
<ol>
<li><p><em><span id="enumerate:cq6ueeom44"
label="enumerate:cq6ueeom44"></span> <span class="math inline">\(H
\subset L\)</span> is a spherical subgroup.</em></p></li>
<li><p><em><span id="enumerate:cq6ueeon2w"
label="enumerate:cq6ueeon2w"></span> The restricted symplectic
representation <span class="math inline">\(\rho_{H, \iota}
|_{H_0}\)</span> is a multiplicity-free symplectic representation, where
<span class="math inline">\(H_0\)</span> is the stabilizer of a generic
orbit for <span class="math inline">\(H \circlearrowright
\mathfrak{h}^\perp\)</span>, with <span
class="math inline">\(\mathfrak{h}^\perp\)</span> the orthogonal
complement of <span class="math inline">\(\mathfrak{h}\)</span> inside
<span class="math inline">\(\mathfrak{l} =
\mathop{\mathrm{Lie}}(L)\)</span>. Here “multiplicity-free” is similar
to this coisotropy condition; it means basically that <span
class="math inline">\(K(V)^{H}\)</span> is commutative with respect to
the Poisson bracket. Such representations were completely classified by
Knop and Losev.</em></p></li>
</ol>
</div>
<p>We can now describe the duality <span class="math inline">\(\Delta
=(G, H, \iota, \rho_H) \longleftrightarrow \hat{\Delta} =(\hat{G},
\hat{H}&#39;, \hat{\iota}&#39;, \rho_{\hat{H}&#39;})\)</span>. We have
focused here on the period conjectures, but there are also geometric and
<span class="math inline">\(L^2\)</span>-conjectures, and it is expected
that those finer conjectures (especially the geometric ones) should
classify this duality. What is not available at the moment is, if we’re
given a <span class="math inline">\(\Delta\)</span>, can you write down
<span class="math inline">\(\hat{\Delta}\)</span>? This is apparently
missing at the moment; there’s no clear algorithm in general. (By
contrast, it’s clear and algorithmic how to pass from a group <span
class="math inline">\(G\)</span> to its dual group <span
class="math inline">\(\hat{G}\)</span> in terms of root data.) But there
are algorithms for computing the duality in some special cases.</p>
<p>First, BZSV explain how we can reduce the computation of the duality
to the reductive case. We want to go from <span
class="math inline">\(\Delta\)</span> to <span
class="math inline">\(\hat{\Delta}\)</span>, and we know how to go from
<span class="math inline">\(\Delta\)</span> to <span
class="math inline">\(\Delta_{\mathop{\mathrm{red}}}\)</span>, as in <a
href="#eq:cq6uefar6y" data-reference-type="eqref"
data-reference="eq:cq6uefar6y">\((4.6)\)</a>. What BZSV propose is
to use <span
class="math display">\[\widehat{\Delta_{\mathop{\mathrm{red}}}}
=(\hat{L}, \hat{H}_{L}&#39;, \hat{\iota}_L &#39;,
\rho_{\hat{H}_{L}&#39;})\]</span> (this is the dual of <span
class="math inline">\(\Delta_{\mathop{\mathrm{red}}}\)</span>, typically
not the same as the reductive version <span
class="math inline">\(\hat{\Delta}_{\mathop{\mathrm{red}}}\)</span> of
the dual <span class="math inline">\(\hat{\Delta}\)</span>) to compute
<span class="math inline">\(\hat{\Delta}\)</span>, as follows:</p>
<ol type="i">
<li><p><span class="math inline">\(\hat{\iota}&#39; =
\hat{\iota}&#39;_L\)</span>.</p></li>
<li><p><span class="math inline">\(\hat{H}&#39;\)</span> is generated by
<span class="math inline">\(\hat{H}&#39;_L\)</span> and <span
class="math display">\[\left\{ \mathop{\mathrm{image}}(\iota_\alpha)
\mid \alpha \in \Delta_{\hat{G}} = \Delta_{\hat{L}} \right\},\]</span>
where <span class="math inline">\(\Delta_{\dotsb}\)</span> denotes
simple roots.</p></li>
<li><p>Write <span class="math inline">\(\rho_{\hat{H}_L &#39;} =
\bigoplus_i \tau_{i, L}\)</span>, where the <span
class="math inline">\(\tau_{i, L}\)</span> are irreducible
representations of highest weight <span
class="math inline">\(\omega_{i,L}\)</span>. Then take <span
class="math inline">\(\rho_{\hat{H}&#39;} = \bigoplus_i \tau_i\)</span>,
where the <span class="math inline">\(\tau_i\)</span> are irreducible
representations of highest weight <span
class="math inline">\(\omega_i\)</span> such that <span
class="math inline">\(\omega_i\)</span> and <span
class="math inline">\(\omega_{i, L}\)</span> belongs to the same orbit
of the Weyl group.</p></li>
</ol>
<div class="example">
<p><strong>Example 71</strong> (Shalika model). (Recall Example <a
href="#example:cq6tho3o9b" data-reference-type="ref"
data-reference="example:cq6tho3o9b">4.4</a>.) <span
class="math inline">\(\Delta =(\mathrm{GL}_{2 n},\mathrm{GL}_{n},(2^n),
0)\)</span>. Then <span
class="math display">\[\Delta_{\mathop{\mathrm{red}}} =(\mathrm{GL}_n
\times \mathrm{GL}_n, \mathrm{GL}_n, 1, 0)
    \rightarrow
    \widehat{\Delta_{\mathop{\mathrm{red}}}}
    =(\mathrm{GL}_n \times \mathrm{GL}_n, \underline{\mathrm{GL}_n}, 1,
0),\]</span> where <span
class="math inline">\(\underline{\mathrm{GL}_n}\)</span> is a sort of
diagonal <span class="math inline">\(\mathrm{GL}_n\)</span>. Pass from
this to <span class="math inline">\(\hat{\Delta}\)</span>, we get <span
class="math display">\[\hat{\Delta} =(\mathrm{GL}_{2 n},\mathrm{Sp}_{2
n}, 1, 0).\]</span></p>
</div>
<div class="example">
<p><strong>Example 72</strong>. (Recall Exercise <a
href="#exercise:cq6tho3oca" data-reference-type="ref"
data-reference="exercise:cq6tho3oca">4.2</a>.) <span
class="math inline">\(\Delta =(\mathrm{GL}_6, \mathrm{GL}_2,(3^2),
0)\)</span>. Then <span
class="math display">\[\Delta_{\mathop{\mathrm{red}}} =(\mathrm{GL}_2^3,
\mathrm{GL}_2, 1, 0)
    \rightarrow \widehat{\Delta_{\mathop{\mathrm{red}}}} =
(\mathrm{GL}_2^3, S(\mathrm{GL}_2^3), 1, \mathrm{std}^{\otimes
3}).\]</span> We obtain <span class="math display">\[\hat{\Delta}
=(\mathrm{GL}_6, \mathrm{SL}_6, 1, \wedge^3).\]</span> In deriving this,
we look at <span class="math display">\[\begin{pmatrix}
      \mathop{\mathrm{diag}}(t_1, t_2)      &amp;  \mathrm{GL}_2
&amp;  \\
                           &amp; \mathop{\mathrm{diag}}(t_3, t_4)
&amp;  \\
                           &amp;  &amp;  \mathrm{GL}_2 \\
    \end{pmatrix}
    \subset \mathrm{GL}_6,\]</span> and <span
class="math inline">\(\omega_{L} = t_1 t_3 t_5 \implies \omega = t_1 t_2
t_3\)</span>.</p>
</div>
<p>This is the first algorithm we have – you can reduce to the reductive
case. It remains to consider the reductive case, where <span
class="math inline">\(\Delta =(G, H, 1, \rho_H)\)</span>. In this case,
there are two known algorithms.</p>
<p>First, the <em>polarized case</em> <span class="math inline">\(\rho_H
= \tau \oplus \tau^\vee\)</span>. This includes, for instance, the case
of spherical varieties, where <span class="math inline">\(\Delta =(G, H,
1, 0)\)</span>. It’s not too far away from that case – one can often
just replace <span class="math inline">\(H\)</span> by a generic
stabilizer for the action of <span class="math inline">\(\tau\)</span>.
BZSV give a generic formula for computing the dual.</p>
<ul>
<li><p><span class="math inline">\(\hat{H}&#39;, \iota\)</span> are
given by the dual group of spherical varieties (Gaitsgory–Nadler,
Sakellaridis–Venkatesh, Knop–Schalke).</p></li>
<li><p><span class="math inline">\(\rho_{\hat{H}}\)</span> was
constructed (via unramified calculation) by Sakellaridis <a href="#ref-MR3117308"
class="citation" data-cites="MR3117308">(Sakellaridis
2013)</a>.</p></li>
</ul>
<p>Another known case is the <em>vector space case</em>, where <span
class="math inline">\(H = G\)</span> but <span
class="math inline">\(\rho_H\)</span> can be anything. We then give a
construction based on Knop’s construction. We give a way to describe
<span class="math inline">\(\hat{H}&#39;\)</span> and <span
class="math inline">\(\hat{\iota}&#39;\)</span>, but for <span
class="math inline">\(\rho_{\hat{H}&#39;}\)</span>, we use an <em>ad
hoc</em> method based on looking at the finite tables of examples. See
<a href="#ref-2023arXiv2310.17837" class="citation" data-cites="2023arXiv2310.17837">(Mao, Wan, and
Zhang 2023)</a>.</p>
<h1 id="sec:cq6tho1cgx">§5. Raphael Beuzart-Plessis’s lectures</h1>
<p><strong>Introduction to Relative Trace Formulas (RTF)</strong></p>
<h2 id="sec:cq6tho1blx">§5.1. RTF in general</h2>
<p>Let <span class="math inline">\(K\)</span> be a global field. Let
<span class="math inline">\(G\)</span> be a connected reductive group
over <span class="math inline">\(K\)</span>. Let <span
class="math inline">\(A(G)\)</span> denote the space of automorphic
forms on the automorphic quotient <span class="math inline">\([G] :=
G(K) \backslash G(\mathbb{A}_K)\)</span>.</p>
<h3 id="sec:cq6tho1auw">§5.1.1. Periods</h3>
<p>Let <span class="math inline">\(H \subset G\)</span> be an algebraic
group. Let <span class="math inline">\(\chi :[H] \rightarrow
\mathbb{C}^\times\)</span> be a character. By the <span
class="math inline">\((H, \chi)\)</span>-period, we mean the functional
<span class="math display">\[\mathcal{P}_{H, \chi} : A(G) \rightarrow
\mathbb{C}\]</span> <span class="math display">\[\varphi \mapsto
\int_{[H]} \varphi(h) \chi(h) \, d h.\]</span></p>
<div id="remark:cq6tho091q" class="remark">
<p><strong>Remark 73</strong>. The integral often diverges. We’ll
explain in some examples how one might regularize them. It’s usually
convergent if the automorphic form <span
class="math inline">\(\varphi\)</span> is cuspidal. (Usually, but not
always – there might be issues with the center, or if one takes <span
class="math inline">\(H\)</span> to be the Borel subgroup of <span
class="math inline">\(G = \mathrm{GL}_2\)</span>, then it never
converges.)</p>
</div>
<div id="remark:cq6tho3lbh" class="remark">
<p><strong>Remark 74</strong>. We can replace <span
class="math inline">\(\chi\)</span> by some “small” automorphic
representation of <span class="math inline">\(H\)</span> (e.g.,
“degenerate” Eisenstein series).</p>
</div>
<p><strong>Emprical fact</strong>: <span
class="math inline">\(\mathcal{P}_{H, \chi}\)</span> is often related to
<span class="math inline">\(L\)</span>-functions and functoriality.</p>
<div id="example:cq6tho6g4r" class="example">
<p><strong>Example 75</strong>. </p>
<ol type="a">
<li><p>(Hecke) <span class="math inline">\(G = \mathrm{GL}_2 \supset
\left(
      \begin{smallmatrix}
        \ast&amp;\\
                               &amp;1 \\
      \end{smallmatrix}
    \right) := \mathbb{G}_m\)</span>. For <span
class="math inline">\(\varphi \in \pi \subset
\mathcal{A}_{\mathrm{cusp}}(G)\)</span>, <span
class="math display">\[\mathcal{P}_{H, \lvert . \rvert^s}(\varphi) \sim
L(\tfrac{1}{2} + s, \pi).\]</span></p></li>
<li><p>(Rankin–Selberg) <span class="math inline">\(G = \mathrm{GL}_2
\times \mathrm{GL}_2 \supset H = \mathrm{GL}_2^{\mathrm{diag}}\)</span>,
<span class="math inline">\(\int_{[H/Z]} \varphi_1(h) \varphi_2(h) E(h,
f, s) \, d h \sim L(s, \pi_1 \times \pi_2)\)</span>, where <span
class="math inline">\(\varphi_i \in \pi_i \subset
A_{\mathrm{cusp}}(\mathrm{GL}_2)\)</span> and <span
class="math inline">\(E\)</span> is a suitable Eisenstein
series.</p></li>
<li><p>(Harder–Langlands–Rapoport) Let <span
class="math inline">\(L/K\)</span> be a quadratic extension, <span
class="math inline">\(G =\mathrm{GL}_{2, L}\)</span>, <span
class="math inline">\(H =\mathrm{GL}_{2, K}\)</span>. Take <span
class="math inline">\(\pi \subset A_{\mathrm{cusp}}(\mathrm{GL}_{2,
K})\)</span> and <span class="math inline">\(\chi : \mathbb{A}_K^\times
/ K^\times \rightarrow \mathbb{C}^\times\)</span> such that <span
class="math inline">\(\omega_\pi = \chi^{-1} \circ N_{L/K}\)</span>.
Then the following are equivalent:</p>
<ul>
<li><p>There exists <span class="math inline">\(\varphi \in \pi\)</span>
with <span class="math inline">\(\mathcal{P}_{H, \chi}(\varphi) \neq
0\)</span>.</p></li>
<li><p>There exists <span class="math inline">\(\sigma \subset
A_{\mathrm{cusp}}(\mathrm{GL}_{2, K})\)</span> such that <span
class="math inline">\(\pi\)</span> is the base change <span
class="math inline">\(\sigma_L\)</span> and <span
class="math inline">\(\omega_\sigma = \chi^{-1}\)</span>.</p></li>
</ul></li>
<li><p>(Jacquet–Shalika) Take <span class="math display">\[G
:=\mathrm{GL}_{2 n} \supseteq H = \left\{
        \begin{pmatrix}
          g &amp;  \\
                                                                                             &amp;
g \\
        \end{pmatrix}
        \begin{pmatrix}
          1          &amp; X \\
                                                                                             &amp;
1 \\
        \end{pmatrix} \mid g \in \mathrm{GL}_n, \, X \in
{\mathop{\mathrm{Mat}}}_n \right\}.\]</span> Let <span
class="math display">\[\chi :[H] \rightarrow \mathbb{C}^\times,\]</span>
<span class="math display">\[\begin{pmatrix}
        g        &amp;  \\
                                                                          &amp;
g \\
      \end{pmatrix}
      \begin{pmatrix}
        1        &amp; X \\
                                                                          &amp;
1 \\
      \end{pmatrix}
      \mapsto \psi(\mathop{\mathrm{trace}}(X)).\]</span> For <span
class="math inline">\(\pi \subset A_{\mathrm{cusp}}(\mathrm{GL}_{2 n} /
Z)\)</span>, the following are equivalent:</p>
<ul>
<li><p><span class="math inline">\(\mathcal{P}_{H, \chi}
\mid_\pi\)</span> is not identically zero.</p></li>
<li><p><span class="math inline">\(\pi\)</span> is a functorial lift
from <span class="math inline">\({\mathop{\mathrm{SO}}}_{2 n +
1}\)</span>.</p></li>
</ul></li>
</ol>
</div>
<h3 id="sec:cq6thpxagu">§5.1.2. Theta series</h3>
<p>Take <span class="math inline">\(X := H \backslash G\)</span>. Define
<span class="math inline">\(\Theta^X : C_c^\infty(X(\mathbb{A}))
\rightarrow C^\infty([G])\)</span> by <span class="math display">\[f
\mapsto \Theta_f^X(g) := \sum_{x \in X(K)} f(x g).\]</span> For <span
class="math inline">\(\varphi \in A(G)\)</span>, define <span
class="math display">\[\mathcal{P}_X(\varphi, f) := \int_{[G]}
  \varphi(g) \Theta_f^X(g) \, d g.\]</span> Provided that <span
class="math inline">\(f\)</span> is supported inside <span
class="math inline">\(H(\mathbb{A}) \backslash G(\mathbb{A})\)</span>
(in general, a proper subset of <span
class="math inline">\(X(\mathbb{A})\)</span>, with the obstruction
measured by Galois cohomology), we have <span
class="math display">\[\mathcal{P}_X(\varphi, f) = \int_{H(\mathbb{A})
\backslash G(\mathbb{A})}
  \mathcal{P}_H(R(x) \varphi) f(x) \, d x.\]</span> In particular,
writing <span class="math inline">\(\Theta_{f,\pi}^X\)</span> for the
orthogonal projection of <span
class="math inline">\(\Theta_{f}^X\)</span> to <span
class="math inline">\(\pi\)</span>, we see that <span
class="math display">\[\mathcal{P}_H |_\pi \not \equiv 0
  \quad \iff \quad
  \Theta_{f,\pi}^X  \not \equiv 0.\]</span> This makes sense for any
(smooth) <span class="math inline">\(G\)</span>-variety <span
class="math inline">\(X\)</span>, not necessarily homogeneous. Put this
way, it contains many basic examples.</p>
<div id="example:cq6thpw9ml" class="example">
<p><strong>Example 76</strong>. </p>
<ol type="a">
<li><p><span id="enumerate:cq6thpxd02"
label="enumerate:cq6thpxd02"></span> Take <span class="math inline">\(X
= \mathbb{G}_a \circlearrowleft \mathbb{G}_m\)</span>. Then an
automorphic form is just a Hecke character <span
class="math inline">\(\chi\)</span>, and by Tate, <span
class="math display">\[\int_{[\mathrm{GL}_1]}^{\mathop{\mathrm{reg}}}
\chi(t) \Theta_f^X(t) \, d t \sim L(\tfrac{1}{2}, \chi).\]</span> (We’ll
talk about the regularization later.)</p></li>
<li><p><span id="enumerate:cq6thpxe24"
label="enumerate:cq6thpxe24"></span> Take <span class="math inline">\(X
= {\mathop{\mathrm{Mat}}}_n \circlearrowleft G = \mathrm{GL}_n \times
\mathrm{GL}_n\)</span>. Take two cusps forms in the <em>same</em>
cuspidal automorphic representation, say <span
class="math inline">\(\varphi_1, \varphi_2 \in \pi \subset
A_{\mathrm{cusp}}(\mathrm{GL}_n)\)</span>. Then <span
class="math display">\[\int_{[G]}^{\mathop{\mathrm{reg}}} \varphi_1(g)
\varphi_2(g) \Theta_f^X(g) \, d g \sim L \left( \tfrac{1 - n}{2}, \pi
\right).\]</span></p></li>
</ol>
</div>
<h3 id="sec:cq6thp1yjb">§5.1.3. RTF formally</h3>
<p>Before defining an RTF, we need to talk about an <em>automorphic
kernel</em>. Take <span class="math inline">\(f \in
C_c^\infty(G(\mathbb{A}))\)</span>. It acts on the space of automorphic
forms by the right convolution <span
class="math inline">\(R(f)\)</span>. This action is given by a kernel,
which is like a continuous matrix, given by <span
class="math display">\[\left( R(f) \varphi \right)(x) := \int_{[G]}
  K_f(x, y) \varphi(y) \, d y.\]</span> The kernel has <span
class="math inline">\(K_f(x, y)\)</span> two different expansions. One,
which we call the <em>geometric</em> expansion, is as a sum over
rational points over the group: <span
class="math display">\[\sum_{\gamma \in G(K)}
  f(x^{-1} \gamma y).\]</span> The other, which is a kind of
<em>spectral</em> expansion, is given by <span
class="math display">\[\sum_{
    \substack{
      \varphi \in A_{\mathrm{cusp}}(G)  \\
      \text{O.N.B.}      
    }
  }
  \bigl( R(f) \varphi \bigr)(x) \overline{\varphi(y)}
  + \dotsb\]</span> where <span class="math inline">\(\dotsb\)</span>
denotes the Eisenstein contribution.</p>
<p>We now consider the following setting. Let <span
class="math inline">\(H_1 \subset G \supset H_2\)</span> be two
subgroups. Let <span class="math inline">\(\chi_i :[H_i] \rightarrow
\mathbb{C}^\times\)</span>. Define <span
class="math inline">\(\mathfrak{X}\)</span> to be, informally, the
quotient <span class="math display">\[\text{``}H_1, \chi_1 \backslash G
/ H_2, \chi_2\text{&#39;&#39;}.\]</span> More precisely:</p>
<div id="definition:cq6thqam4a" class="definition">
<p><strong>Definition 77</strong>. For <span class="math inline">\(f \in
C_c^\infty(G(\mathbb{A}))\)</span>, <span
class="math display">\[\operatorname{RTF}_{\mathfrak{X}}(f) :=
\int_{[H_1] \times[H_2]} K_f(h_1, h_2) \chi_1(h_1) \chi_2(h_2)
    \, d h_1 \, d h_2.\]</span></p>
</div>
<p>Why is this related to period integrals? Well, one way to compute the
RTF is via the <em>spectral expansion</em> <span
class="math display">\[\mathrm{RTF}_{\mathfrak{X}}(f) := \sum_{\varphi
\in A_{\mathrm{cusp}}(G)}
  \mathcal{P}_{H_1, \chi_1}(R(f) \varphi)
  \mathcal{P}_{H_2, \chi_2}(\overline{\varphi})
  + \dotsb.\]</span> Another is the <em>geometric expansion</em> <span
class="math display">\[\mathrm{RTF}_{\mathfrak{X}}(f) = \sum_{\gamma \in
H_1(K) \backslash G(K) / H_2(K)}
  \mathop{\mathrm{vol}}\left([(H_1 \times H_2)_\gamma] \right)
\mathrm{Orb}_\gamma(f),\]</span> where <span
class="math display">\[\mathrm{Orb}_\gamma(f) :=
  \int_{(H_1 \times H_2)_\gamma(\mathbb{A}) \backslash (H_1 \times
H_2)(\mathbb{A})}
  H(h_1^{-1} \gamma h_2)
  \chi_1(h_1) \chi_2(h_2)
  \, d h_1
  \, d h_2.\]</span> Here <span class="math inline">\((H_1 \times
H_2)_\gamma\)</span> is the stabilizer with respect to the action <span
class="math inline">\(\gamma \cdot(h_1, h_2) = h_1^{-1} \gamma
h_2\)</span>.</p>
<div id="remark:cq6thubzrk" class="remark">
<p><strong>Remark 78</strong>. Two sources of divergence on the
geometric side:</p>
<ul>
<li><p>the volumes can be infinite, and</p></li>
<li><p>the orbital integrals can diverge.</p></li>
</ul>
<p>However, one advantage of these distributions over the original ones
is that they are factorizable, being now taken over an adelic space. At
least formally, <span class="math display">\[\mathrm{Orb}_\gamma(f) =
\prod_v \mathrm{Orb}_\gamma(f_v) \quad \text{ for } f = \prod
f_v,\]</span> where <span
class="math inline">\(\mathrm{Orb}_\gamma(f_v)\)</span> is a local
orbital integral.</p>
</div>
<div id="remark:cq6th778hd" class="remark">
<p><strong>Remark 79</strong>. There are a few different RTF’s one can
see here:</p>
<ul>
<li><p><span class="math inline">\(G \circlearrowleft H_1 \times
H_2\)</span>,</p></li>
<li><p><span class="math inline">\(H_1 \backslash G \circlearrowleft
H_2\)</span>,</p></li>
<li><p><span class="math inline">\(H_1 \backslash G \times H_2
\backslash G \circlearrowleft G\)</span>.</p></li>
</ul>
</div>
<p>&lt;++&gt;</p>
<h3 id="sec:cq6thubysx">§5.1.4. RTF and theta series</h3>
<p>Assume for simplicity that <span class="math inline">\(\chi_1 =
\chi_2 = 1\)</span>.</p>
<p>There is one first obvious relation between RTF and theta series.
Note that <span class="math display">\[K_f = \Theta_f^G \qquad \text{
for } G \circlearrowleft G \times G.\]</span> Thus <span
class="math display">\[\mathrm{RTF}_{\mathfrak{X}}(f) = \int_{[H_1
\times H_2]} \Theta_f^G = \int_{[H_2]} \Theta_\varphi^{H_2 \backslash
G},\]</span> where <span class="math inline">\(\varphi(x) =
\int_{H_1(\mathbb{A})} f(h_1 x) \, d h_1\)</span>, which lies in <span
class="math inline">\(C_c^\infty(H_1(\mathbb{A}) \backslash
G(\mathbb{A}))\)</span>. We can also write the above as the Petersson
norm <span class="math display">\[\left\langle \Theta^{H_1 \backslash
G}_{\varphi_1}, \Theta_{\varphi_2}^{H_2 \backslash G}
\right\rangle_{\mathrm{Pet}},\]</span> where for <span
class="math inline">\(f = f_1 \ast f_2^\vee\)</span> with <span
class="math inline">\(f_1, f_2 \in C_c^\infty(G(\mathbb{A}))\)</span>,
we set <span class="math display">\[\varphi_i(x) :=
\int_{H_i(\mathbb{A})} f_i(h_i x) \, d h_i.\]</span></p>
<p>More generally, for <span class="math inline">\(X \circlearrowleft
G\)</span>, we can consider the distributions <span
class="math display">\[\mathrm{RTF}_{\mathfrak{X}/G}(f) := \int_{[G]}
\Theta^X_f \quad \text{ for } f \in C_c^\infty(X(\mathbb{A})).\]</span>
You can write, in a similar way, a geometric expansion of this in terms
of <span class="math inline">\(G(K)\)</span> on <span
class="math inline">\(X(K)\)</span>. Let’s try to make sense of the
convergence. These <span class="math inline">\(\Theta_f^X\)</span> are
not arbitrary functions – they have a very special behavior. Here’s a
fact that we’ll write in vague terms, and then give one example.</p>
<div id="fact:cq6thubvi6" class="fact">
<p><strong>Fact 80</strong>. <em><span
class="math inline">\(\Theta^X_f\)</span> is “asymptotically finite”,
i.e., is asymptotic to eigenfunctions with respect to the action of some
tori (where we pluralize “torus” because the precise one depends upon in
which direction you are tending to infinity). Informally, by declaring
the integrals of such asymptotics to be zero, you can define regularized
integrals. Provided that&lt;++&gt; the asymptotics are nontrivial, there
is a canonical way to regularize <span
class="math inline">\(\mathrm{RTF}_{X / G}\)</span>.</em></p>
</div>
<div id="example:cq6thubuij" class="example">
<p><strong>Example 81</strong>. Take <span class="math inline">\(G =
\mathbb{G}_m\)</span>. Let <span class="math inline">\(\chi_0,
\chi_\infty :[\mathbb{G}_m] \rightarrow \mathbb{C}^\times\)</span>.
Define <span class="math inline">\(\mathcal{F}_{\chi_0,
\chi_\infty}([\mathbb{G}_m])\)</span> to be the set of all <span
class="math inline">\(f \in C^\infty([\mathbb{G}_m])\)</span> such that
there are <span class="math inline">\(c_0 = c_0(f)\)</span> and <span
class="math inline">\(c_\infty = c_\infty(f) \in \mathbb{C}\)</span>
such that <span class="math display">\[\left\lvert f(t) - c_\infty
\chi_\infty(t) \right\rvert \ll_N \lvert t \rvert^{- N}
    \quad \text{ for } \lvert t \rvert \geq 1,\]</span> <span
class="math display">\[\left\lvert f(t) - c_\infty \chi_\infty(t)
\right\rvert \ll_N \lvert t \rvert^{N} \qquad \text{ for } \lvert t
\rvert \leq 1.\]</span> We have a short exact sequence of <span
class="math inline">\(\mathbb{A}^\times\)</span>-representations <span
class="math display">\[0 \rightarrow \mathcal{S}([\mathbb{G}_m])
\rightarrow \mathcal{F}_{\chi_0, \chi_\infty} \rightarrow
\mathbb{C}_{\chi_0} \oplus \mathbb{C}_{\chi_\infty} \rightarrow
0,\]</span> where <span
class="math inline">\(\mathcal{S}([\mathbb{G}_m])\)</span> consists in
particular of functions that are rapidly decaying. The map is given by
<span class="math inline">\(f \mapsto(c_0(f), c_\infty(f))\)</span>.</p>
<ol type="a">
<li><p><span id="enumerate:cq6tht3m44"
label="enumerate:cq6tht3m44"></span> If <span
class="math inline">\(\chi_0 \neq 1 \neq \chi_\infty\)</span>, then
there is a unique functional <span
class="math display">\[\int_{[\mathbb{G}_m]}^{\mathrm{reg}} :
\mathcal{F}_{\chi_0, \chi_\infty} \rightarrow \mathbb{C}\]</span> that
is <span class="math inline">\(\mathbb{A}^\times\)</span>-invariant and
such that <span
class="math display">\[\int_{[\mathbb{G}_m]}^{\mathrm{reg}} f =
\int_{[\mathbb{G}_m]} f(t) \, d t
      \quad \text{ for } f \in
\mathcal{S}([\mathbb{G}_m]).\]</span></p></li>
<li><p><span id="enumerate:cq6tht3n8y"
label="enumerate:cq6tht3n8y"></span> Take <span
class="math inline">\(X_1 = \mathbb{G}_a \circlearrowleft
\mathbb{G}_m\)</span>. Then, for all <span class="math inline">\(f \in
C_c^\infty(\mathbb{A})\)</span>, we have <span
class="math inline">\(\Theta_f^{X_1} \in \mathcal{F}_{\lvert .
\rvert^{-1}, 1}\)</span>.</p></li>
<li><p><span id="enumerate:cq6tht4jar"
label="enumerate:cq6tht4jar"></span> Define <span
class="math inline">\(X_2 = \mathbb{G}_a^2 \circlearrowleft
\mathbb{G}_m\)</span> by <span class="math inline">\(t \cdot(x, y) :=(t
x, t^{-1} y)\)</span>. Then, for all <span class="math inline">\(f \in
C_c^\infty(\mathbb{A}^2)\)</span>, we have <span
class="math inline">\(\Theta_f^{X_2} := \mathcal{F}_{\lvert .
\rvert^{-1}, \lvert . \rvert}\)</span>.</p></li>
<li><p><span id="enumerate:cq6tht7mp9"
label="enumerate:cq6tht7mp9"></span> Take <span
class="math inline">\(\mathbb{G}_m = A = \left(
      \begin{smallmatrix}
        \ast&amp;\\
                                &amp;1 \\
      \end{smallmatrix}
    \right) \subset \mathrm{PGL}_2\)</span>, then for all <span
class="math inline">\(f \in C_c^\infty(X_3(\mathbb{A}))\)</span>, we
have <span class="math inline">\(\Theta_f^{X_3} \in \mathcal{F}_{\lvert
. \rvert^{-1}, \lvert . \rvert}\)</span>.</p></li>
</ol>
</div>
<h2 id="sec:cq6tyal5g1">§5.2. Waldspurger theorem via Jacquet’s comparison of
RTF</h2>
<h3 id="sec:cq6tyal962">§5.2.1. Reminder on Hecke periods</h3>
<p>Set <span class="math display">\[G := \mathrm{PGL}_2 / K \supset A :=
  \begin{pmatrix}
    \ast    &amp;  \\
                                                                             &amp;
1 \\
  \end{pmatrix}
  = \mathbb{G}_m.\]</span> Let’s also fix an idele class character <span
class="math inline">\(\chi :[\mathbb{G}_m] \rightarrow
\mathbb{C}^\times\)</span>. Yesterday we formulated a relation between
the Hecke period and the Hecke <span
class="math inline">\(L\)</span>-function. Let’s recall that, being a
little more precise. Let <span class="math inline">\(\varphi \in \pi
\subset A_{\mathrm{cusp}}(G)\)</span> be a cusp form, living in some
cuspidal automorphic representation. Then if you take the automorphic
period over <span class="math inline">\(A\)</span> twisted by <span
class="math inline">\(\chi\)</span> of <span
class="math inline">\(\varphi\)</span>, you get the standard <span
class="math inline">\(L\)</span>-function of <span
class="math inline">\(\pi\)</span> twisted by <span
class="math inline">\(\chi\)</span>, although it’s only an
approximation: you need to add some local factors involving the local
points of your torus, the local components of your character, and the
local component of not exactly <span
class="math inline">\(\varphi\)</span>, but rather its Whittaker
function. This yields <span id="eq:cq6tx8qioa" class="math display">\[\label{eq:cq6tx8qioa}\tag{5.1}
  \mathcal{P}_{A, \chi \lvert . \rvert^s}(\varphi) = L(\tfrac{1}{2} + s,
\pi \times \chi) \prod_v \mathcal{P}_{A_v, \chi_v, \lvert .
\rvert_v^s}^{\flat}(W_v),\]</span> where the Whittaker function is
defined by <span class="math display">\[W_\varphi(g) = \int_{\mathbb{A}}
\varphi \left(
    \begin{pmatrix}
      1 &amp; x \\
      0 &amp; 1 \\
    \end{pmatrix} g \right)
  \psi(x) \, d x
  = \prod_v W_v,\]</span> with the factorization was explained in
Chris’s lectures, and where the local periods are defined in the obvious
way, by integrating the Whittaker function against the character: <span
class="math display">\[\mathcal{P}_{A_v, \chi_v, \lvert .
\rvert_v^s}(W_v) := \int_{F_v^\times} W_v
  \begin{pmatrix}
    a    &amp;  \\
                                                                                   &amp;
1 \\
  \end{pmatrix}
  \chi_v(a) \lvert a \rvert_v^s \, d a,\]</span> which we normalize
further by dividing by the local factor of the global <span
class="math inline">\(L\)</span>-function: <span
class="math display">\[\mathcal{P}_{A_v, \chi_v, \lvert .
\rvert_v^s}^\flat(W_v) :=
  \frac{\mathcal{P}_{A_v, \chi_v, \lvert .
\rvert_v^s}(W_v)}{L(\tfrac{1}{2} + s, \pi_v \times \chi_v)}.\]</span>
Specialize to <span class="math inline">\(s = 0\)</span>. It turns out
that all local periods are nonzero, so we obtain <span
class="math display">\[L(\tfrac{1}{2}, \pi \times \chi) \neq 0
  \quad \iff \quad
  \text{there exists } \varphi \in \pi, \, \, \mathcal{P}_{A,
\chi}(\varphi) \neq 0.\]</span></p>
<h3 id="sec:cq6tyama80">§5.2.2. Waldspurger’s formula</h3>
<p>Let <span class="math inline">\(L /K\)</span> be a separable
quadratic extension of <span class="math inline">\(K\)</span>. We can
then define a torus <span class="math inline">\(T := L^\times / K^\times
\subset G := {\mathop{\mathrm{Aut}}}_K(L) / K^\times\)</span>. We can
define an automorphic character <span class="math inline">\(\chi :[T]
\rightarrow \mathbb{C}^\times\)</span>. Let us remark that <span
class="math inline">\([T]\)</span> can also be written as <span
class="math inline">\(L^\times \backslash \mathbb{A}_L^\times /
\mathbb{A}_K^\times\)</span>; thus, <span
class="math inline">\(\chi\)</span> gives in particular an idele class
character for <span class="math inline">\(L\)</span>. We then have all
the ingredients needed to formulate a precise version of Waldspurger’s
formula. It’s essentially an analogue of the Hecke formula <a
href="#eq:cq6tx8qioa" data-reference-type="eqref"
data-reference="eq:cq6tx8qioa">\((5.1)\)</a>. Let <span
class="math inline">\(\varphi \in \pi \subset
A_{\mathrm{cusp}}(G)\)</span>. Then <span
class="math display">\[\left\lvert \mathcal{P}_{T, \chi}(\varphi)
\right\rvert^2
  =
  L(\tfrac{1}{2}, \pi_L \times \chi) \prod(\text{local
periods}),\]</span> where <span class="math inline">\(\pi_L \subset
A(G_L)\)</span> is the base change lift of <span
class="math inline">\(\pi\)</span> (a particular case of Langlands
functoriality, shown to exist by Langlands in this case). That’s the
shape of the Waldspurger formula.</p>
<p>Now you can ask the same question: can we deduce from this formula a
criterion for the nonvanishing of the central <span
class="math inline">\(L\)</span>-value? The problem here is that the
local periods can be identically zero! The way to work around this
problem is to work with a family of groups, called <em>pure inner
forms</em>. Let’s explain quickly what are these groups.</p>
<h3 id="sec:cq6tyamby0">§5.2.3. Quaternion algebras</h3>
<p>Let <span class="math inline">\(k\)</span> be an arbitrary field,
with <span class="math inline">\(\operatorname{char}(k) \neq 2\)</span>.
Let’s take as a definition that a <em>pure inner form</em> of <span
class="math inline">\(G := \mathrm{PGL}_2\)</span> is a group of the
form <span class="math inline">\(G^B := B^\times / k^\times\)</span>,
where <span class="math inline">\(B\)</span> is a quaternion algebra
over <span class="math inline">\(k\)</span>.</p>
<p>Recall that a <em>quaternion algebra</em> over <span
class="math inline">\(k\)</span> is an algebra <span
class="math inline">\(B_{/k}\)</span> whose base change to the algebraic
closure is the space of <span class="math inline">\(2 \times 2\)</span>
matrices, i.e., <span class="math inline">\(B \otimes_k k^{\mathrm{sep}}
\cong M_2(k^{\mathrm{sep}})\)</span>. If <span class="math inline">\(B
\cong M_2(k)\)</span> (already over <span
class="math inline">\(k\)</span>), then we say that <span
class="math inline">\(B\)</span> is <em>split</em>. There’s a very
simple classification of quaternion algebras, using the following
construction. Over the algebraic closure, there’s a particular quadratic
form on the <span class="math inline">\(2 \times 2\)</span> matrices,
given by the determinant: <span class="math inline">\(\det :
M_2(k^{\mathrm{sep}}) \rightarrow k^{\mathrm{sep}}\)</span>. Being
unique, it descends to <span class="math inline">\(N : B \rightarrow
k\)</span>, called the <em>reduced norm</em>. This is also a quadratic
form. In particular, you can consider the orthogonal of <span
class="math inline">\(k\)</span> with respect to the associated bilinear
form, say <span class="math inline">\(B_0 := k^\perp\)</span>. Then we
obtain <span class="math display">\[\begin{gathered}
  \left\{
    \begin{array}{c}
      \text{quaternion algebras over } k \\
      \text{up to isomorphism}
    \end{array}
  \right\}
  \quad \longleftrightarrow \quad
  \left\{
    \begin{array}{c}
      \text{rank } 3 \text{ quadratic forms} \\
      \text{of discriminant one,} \\
      \text{up to equivalence}
    \end{array}
  \right\} \\[1em]
  B \quad \longmapsto \quad N|_{B^0}
\end{gathered}\]</span> Moreover, <span class="math inline">\(G^B \cong
\mathop{\mathrm{SO}}(q)\)</span>.</p>
<p>The classification proceeds as follows.</p>
<ul>
<li><p>If <span class="math inline">\(k\)</span> is a local field other
than <span class="math inline">\(\mathbb{C}\)</span>, then there are two
isomorphism classes of quaternion algebras: <span
class="math inline">\(M_2(k) = B^+\)</span> (called <em>split</em>), and
some other quaternion algebra <span
class="math inline">\(B^-\)</span>.</p></li>
<li><p>Suppose <span class="math inline">\(k = K\)</span> is global.
Then:</p>
<ul>
<li><p>Two quaternion algebras <span class="math inline">\(B\)</span>
and <span class="math inline">\(B&#39;\)</span> over <span
class="math inline">\(K\)</span> are isomorphic if and only if their
completions <span class="math inline">\(B_v :=B \otimes_K k_v\)</span>
and <span class="math inline">\(B_v &#39;\)</span> are isomorphic for
all <span class="math inline">\(v\)</span>.</p></li>
<li><p>For a family <span
class="math inline">\((\mathbb{B}_v)_v\)</span> of local quaternion
algebras, there exists a quaternion algebra <span
class="math inline">\(B_{/ K}\)</span> with <span
class="math inline">\(B_v \cong \mathbb{B}_v\)</span> for all places
<span class="math inline">\(v\)</span> if and only if</p>
<ul>
<li><p><span class="math inline">\(\mathbb{B}_v\)</span> is split for
almost all <span class="math inline">\(v\)</span>, and</p></li>
<li><p><span class="math inline">\(\prod_v \varepsilon(\mathbb{B}_v) =
1\)</span>, where <span
class="math inline">\(\varepsilon(\mathbb{B}_v)\)</span> is defined to
be <span class="math inline">\(+1\)</span> if <span
class="math inline">\(\mathbb{B}_v\)</span> is split and <span
class="math inline">\(- 1\)</span> otherwise.</p></li>
</ul></li>
</ul></li>
</ul>
<p>We next recall the <em>Jacquet–Langlands</em> correspondence.</p>
<ul>
<li><p>For <span class="math inline">\(k = F\)</span> local, there
exists <span class="math display">\[\mathrm{JL} :
\mathop{\mathrm{Irr}}(G^B(F)) \hookrightarrow
\mathop{\mathrm{Irr}}(G(F))\]</span> that is injective and is
characterized by some character identities. Moreover, if <span
class="math inline">\(B\)</span> is split, then <span
class="math inline">\(\mathrm{JL}\)</span> is just the
identity.</p></li>
<li><p>For <span class="math inline">\(k \in K\)</span> global, there
exists <span class="math display">\[\mathrm{JL} :
    \left\{
      \begin{array}{c}
        \text{cuspidal automorphic } \\
        \text{representations } \pi_B \subset A_{\mathrm{cusp}}(G^B)
      \end{array}
    \right\}
    \hookrightarrow
    \left\{
      \begin{array}{c}
        \text{cuspidal automorphic } \\
        \text{representations } \pi \subset A_{\mathrm{cusp}}(G)
      \end{array}
    \right\}\]</span> such that <span
class="math inline">\(\mathrm{JL}(\pi_B)_v = \mathrm{JL}(\pi_{B,
v})\)</span> for all places <span class="math inline">\(v\)</span>. In
particular, <span class="math inline">\(\pi_{B, v} \cong \pi_v\)</span>
for all places <span class="math inline">\(v\)</span> such that <span
class="math inline">\(B_v\)</span> is split.</p></li>
</ul>
<p>That’s all we wanted to say about quaternion algebras and the
Jacquet–Langlands correspondence. Let’s now go back to finding a way to
go from the Waldspurger formula to a criterion for the nonvanishing of
the central <span class="math inline">\(L\)</span>-value.</p>
<h3 id="sec:cq6tyamcm6">§5.2.4. Non-vanishing</h3>
<p>Return to the previous setting. Let <span class="math inline">\(L /
K\)</span> be a quadratic extension of global fields, so that we have
<span class="math display">\[T = L^\times / K^\times \subset G :=
\mathrm{PGL}_2, \qquad \chi :[T] \rightarrow \mathbb{C}^\times\]</span>
as before. Let <span class="math inline">\(B\)</span> be a quaternion
algebra such that <span class="math inline">\(L \subset B\)</span>. Then
we obtain an embedding <span class="math display">\[T = L^\times /
K^\times \subset G^B \rightarrow B^\times / K^\times.\]</span> It turns
out that in this situation also, there is a Waldspurger formula for the
period of cusp forms on <span class="math inline">\(G^B\)</span> over
<span class="math inline">\(T\)</span>. When you combine all these
formulas, you can deduce the following nonvanishing result:</p>
<div id="theorem:cq6tyal0fv" class="theorem">
<p><strong>Theorem 82</strong> (Waldspurger). <em>Let <span
class="math inline">\(\pi \subset A_{\mathrm{cusp}}(G)\)</span>. Then
the following are equivalent:</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(L(\tfrac{1}{2}, \pi_L \times
\chi) \neq 0\)</span>.</em></p></li>
<li><p><em>There exists a quaternion algebra <span
class="math inline">\(B\)</span> over <span
class="math inline">\(K\)</span> with <span class="math inline">\(L
\subset B\)</span> and <span class="math inline">\(\pi_B \subset
A_{\mathrm{cusp}}(G^B)\)</span> with <span
class="math inline">\(\operatorname{JL}(\pi_B) = \pi\)</span> with <span
class="math inline">\(\mathcal{P}_{T, \chi} |_{\pi^B} \neq
0\)</span>.</em></p></li>
</ol>
</div>
<p>That’s the statement. We’ll now aim to explain how Jacquet was able
to reprove this using a comparison of RTF.</p>
<h3 id="sec:cq6tyamdej">§5.2.5. RTF approach</h3>
<p>For simplicity, we will only consider the case where <span
class="math inline">\(\chi = 1\)</span> is trivial. This simplifies in
particular the base change <span
class="math inline">\(L\)</span>-function, which is then just <span
class="math inline">\(L(s, \pi_L) = L(s, \pi) L(s, \pi \times
\eta)\)</span>, where <span class="math display">\[\eta : K^\times
\backslash \mathbb{A}_K^\times / N_{L / K}(\mathbb{A}_L^\times)
\xrightarrow{\simeq} \{\pm 1\}\]</span></p>
<p>is the quadratic character of the idele class group of <span
class="math inline">\(K\)</span> that is associated to the extension
<span class="math inline">\(L / K\)</span> by class field theory. In
particular, <span class="math display">\[L(\tfrac{1}{2}, \pi) \neq 0
  \quad \iff \quad
  \mathcal{P}_{A} |_\pi \not \equiv 0\]</span> and <span
class="math display">\[L(\tfrac{1}{2}, \pi \times \eta) \neq 0
  \quad \iff \quad
  \mathcal{P}_{A, \eta} |_\pi \not \equiv 0.\]</span> Jacquet’s idea:
prove Waldspurger’s theorem using a comparison of RTF. On the one side,
we’ll have the RTF associated to <span id="eq:cq6tx983u1" class="math display">\[\label{eq:cq6tx983u1}\tag{5.2}
  T \backslash G^B / T.\]</span> We’d like to compare it to the RTF that
sees these two Hecke periods, ie.. that which is associated, at least
formally, to the double quotient <span id="eq:cq6tx98942" class="math display">\[\label{eq:cq6tx98942}\tag{5.3}
  A \backslash G / A, \eta.\]</span></p>
<p>One remark before we proceed. We have already solved yesterday all
the convergence issues. In the two relative trace formulas that we want
to consider, there is a precise way to form the integral defining the
RTF. For the first case <a href="#eq:cq6tx983u1"
data-reference-type="eqref"
data-reference="eq:cq6tx983u1">\((5.2)\)</a>, we are taking
periods over <span class="math inline">\([T]\)</span>, which is compact,
so the RTF is already convergent. This is not the case for <a
href="#eq:cq6tx98942" data-reference-type="eqref"
data-reference="eq:cq6tx98942">\((5.3)\)</a>, but it can be
regularized as in yesterday’s talk. We are now starting from something
that is really defined. We want to compare these two relative trace
formulas. We do so by trying to match the geometric expansions. Let’s
describe those.</p>
<h3 id="sec:cq6tyamec3">§5.2.6. Geometric expansions</h3>
<ol type="a">
<li><p><span class="math display">\[\mathrm{RTF}_{T \backslash G^B /
T}(f) = \sum_{\delta \in T(K) \backslash G^B(K) / T(K)}
    \mathop{\mathrm{vol}}([(T \times T)_\delta])
\operatorname{Orb}_\gamma(f).\]</span></p>
<div id="exercise:cq6tyalwr3" class="exercise">
<p><strong>Exercise 14</strong>. We need to parametrize the orbits.
Define <span class="math display">\[L_B^- := L^\perp \subset B = L
\oplus L_B^-.\]</span> We can define a map <span
class="math display">\[\nu : G^B \rightarrow \mathbb{P}^1 -
\{1\}\]</span> <span class="math display">\[\delta = \delta^+ + \delta^-
\mapsto - \frac{N(\delta^-)}{N(\delta^+)}.\]</span> (Check why we miss
<span class="math inline">\(1\)</span>!) This induces an injection <span
class="math display">\[T(K) \backslash G^B(K) / T(K) \rightarrow
\mathbb{P}^1(K) \setminus \{1\}\]</span> with image <span
class="math inline">\((- N(L_B^-) \setminus \{1\}) \cup
\{\infty\}\)</span>.</p>
</div>
<div id="definition:cq6tyalx5j" class="definition">
<p><strong>Definition 83</strong>. We say that <span
class="math inline">\(\delta \in G^B\)</span> is <em>regular
semisimple</em> if <span class="math inline">\(\nu(\delta) \neq
0\)</span> or <span class="math inline">\(\infty\)</span>.</p>
</div>
<p>We denote by <span class="math display">\[G_{\mathrm{rs}}^B \subset
G^B\]</span> the subset consisting of regular semisimple elements.</p>
<div id="exercise:cq6tyaqy0z" class="exercise">
<p><strong>Exercise 15</strong>. <span class="math display">\[\sqcup_{
        \substack{
          B: \text{quat.\ alg }/ K  \\
          L \subset B          
        }
      }
      \nu(G_{\mathrm{rs}^B(K)})
      = \mathbb{P}^1(K).\]</span></p>
</div>
<div id="notation:1" class="notation">
<p><strong>Notation 84</strong>. For <span class="math inline">\(x \in
\nu(G^B(K))\)</span>, we set <span id="eq:cq6tyc779o" class="math display">\[\label{eq:cq6tyc779o}\tag{5.4}
      \operatorname{Orb}_{\delta_x}(f) =: \operatorname{O}_x(f)\]</span>
and <span class="math inline">\(\nu(\delta_x) = x\)</span>.</p>
</div>
<div id="exercise:cq6tydnqrq" class="exercise">
<p><strong>Exercise 16</strong>. Let <span class="math inline">\(x \in
K^\times \setminus \{1\}\)</span>. Then <span
class="math display">\[\mu_K^{-1}(x) = A(k)
      \underbrace
      {
        \begin{pmatrix}
          1      &amp; x \\
          1 &amp; 1 \\
        \end{pmatrix}
      }_{
        \gamma_x
      }
      \quad
      \gamma_x := .\]</span> For <span class="math inline">\(x =
0\)</span>, we have <span class="math display">\[\mu_K^{-1}(0) =
      A(K)
      \sqcup A(K)
      \underbrace
      {
        \begin{pmatrix}
          1        &amp; 1 \\
          0 &amp; 1 \\
        \end{pmatrix}
      }_{
        \gamma_0^+
      }
      A(K) \sqcup A(K)
      \underbrace
      {
        \begin{pmatrix}
          1        &amp; 0 \\
          1                 &amp; 1 \\
        \end{pmatrix}
      }_{
        \gamma_0^-
      }
      A(K).\]</span> For <span class="math inline">\(x =
\infty\)</span>, we have <span class="math display">\[\mu_K^{-1}(\infty)
= A(K) \omega \sqcup A(K) \underbrace
      {
        \omega \gamma_0^+
      }_{
        \gamma_\infty^+
      }
      A(K) \sqcup A(K) \underbrace
      {
        \omega \gamma_0^-
      }_{
        \gamma_\infty^-
      }
      A(K),
      \quad  \omega =
      \begin{pmatrix}
        &amp; 1 \\
        1 &amp;  \\
      \end{pmatrix}.\]</span></p>
</div></li>
<li><p><span id="enumerate:cq6tydex7z"
label="enumerate:cq6tydex7z"></span> Now we need to regularize and work
out the following: <span class="math display">\[\mathrm{RTF}_{A
\backslash G / A, \eta}(f) = \sum_{x \in \mathbb{P}^1(K) \setminus
\{1\}} \mathcal{O}_x^\eta(f),\]</span> where for <span
class="math inline">\(x \neq 0, \infty\)</span>, we set <span
class="math display">\[\mathcal{O}_x^\eta(f) :=
\operatorname{Orb}_{\gamma_x}(f),\]</span> while for <span
class="math inline">\(x = 0, \infty\)</span>, we have <span
class="math display">\[\mathcal{O}_x^\eta(f) :=
\operatorname{Orb}_{\gamma_x^+}^{\mathop{\mathrm{reg}}}(f) +
\operatorname{Orb}_{\gamma_x^-}^{\mathop{\mathrm{reg}}}(f).\]</span></p></li>
</ol>
<h3 id="sec:cq6uerkd57">§5.2.7. Local transfer</h3>
<p>We briefly survey local transfer. Let <span
class="math inline">\(v\)</span> be a place of <span
class="math inline">\(K\)</span>. Set <span class="math inline">\(E / F
:= L_v / K_v\)</span>. We have <span class="math inline">\(T = E^\times
/ F^\times \hookrightarrow G = \mathrm{PGL}_2(F)\)</span> and also <span
class="math inline">\(T \hookrightarrow G^B\)</span>.</p>
<div id="definition:cq6tydlv0l" class="definition">
<p><strong>Definition 85</strong>. We say that <span
class="math inline">\(f \in C_c^\infty(G)\)</span> and <span
class="math inline">\(f^B \in C_c^\infty(G^B)\)</span> <em>match</em> if
<span class="math inline">\(\mathcal{O}_x^\eta(f) =
\mathcal{O}_x(f^B)\)</span> for all <span class="math inline">\(x \in
\nu(G^B)\)</span>.</p>
</div>
<p>First, a notation. Other than writing that two functions match, you
can just use this symbol <span class="math inline">\(f \leftrightarrow
f^B\)</span>. Now, if <span class="math inline">\(v\)</span> is split in
<span class="math inline">\(L\)</span>, then <span
class="math inline">\(B\)</span> must split, and not only must <span
class="math inline">\(G^B\)</span> and <span
class="math inline">\(G\)</span> be isomorphic, but there must be an
isomorphism respecting <span class="math inline">\(T\)</span> and <span
class="math inline">\(A\)</span>, i.e., <span
class="math display">\[(G^B, T) \cong(G, A),\]</span> and the existence
of matchings turns out to be trivial. So let’s assume that <span
class="math inline">\(v\)</span> is non-split – this is the nontrivial
case. Then you can genuinely have two quaternion algebras.</p>
<div id="theorem:cq6tydtozy" class="theorem">
<p><strong>Theorem 86</strong>. <em>[Jacquet]</em></p>
<ol type="i">
<li><p><em>For all <span class="math inline">\(f \in
C_c^\infty(G)\)</span>, there exist <span class="math inline">\((f_+,
f_-) \in C_c^\infty(G^{B_+}) \bigoplus C_c^\infty(G^{B_-})\)</span> such
that <span class="math inline">\(f \leftrightarrow f_+\)</span> and
<span class="math inline">\(f \leftrightarrow
f_-\)</span>.</em></p></li>
<li><p><em>For all pairs <span class="math inline">\((f_+,
f_-)\)</span>, there exists <span class="math inline">\(f\)</span> such
that <span class="math inline">\(f \leftrightarrow
f_{\pm}\)</span>.</em></p></li>
</ol>
</div>
<p>We’ll also need the fundamental lemma. We’ll explain that briefly
next time, then say how to get the matching.</p>
<div id="remark:cq6uewza4m" class="remark">
<p><strong>Remark 87</strong>. Given an algebraic subgroup <span
class="math inline">\(H\)</span> of an algebraic group <span
class="math inline">\(G\)</span>, there is a way to make the quotient
<span class="math inline">\(H \leq G\)</span> a variety. Even over a
field, it is not necessarily the case that <span
class="math inline">\(H(k) \backslash G(k)\)</span> coincides with <span
class="math inline">\((H \backslash G)(k)\)</span>, but the former is
always contained in the latter: <span id="eq:cq6tyq0ey8" class="math display">\[\label{eq:cq6tyq0ey8}\tag{5.5}
    H(k) \backslash G(k) \subseteq (H \backslash G)(k).\]</span> We have
<span class="math display">\[(H \backslash G)(k) = \bigsqcup_{\alpha \in
\ker(H^1(k, H) \rightarrow H^1(k, G))}
    H_\alpha(k) \backslash G(k),\]</span> thus <span
class="math display">\[C_c^\infty((H \backslash G)(k)) =
\bigoplus_{\alpha} C_c^\infty \left( H_\alpha(k) \backslash G(k)
\right).\]</span> If <span class="math inline">\(k\)</span> is local,
then <a href="#eq:cq6tyq0ey8" data-reference-type="eqref"
data-reference="eq:cq6tyq0ey8">\((5.5)\)</a> is closed and
open.</p>
<p>Here we need <span class="math inline">\(H\)</span> to be smooth.
Otherwise, consider <span class="math inline">\(\mu_2 \backslash
\mathbb{G}_m\)</span> with <span
class="math inline">\(\operatorname{char}(k) = 2\)</span>; theo rbits in
this case are not open.</p>
<p>If <span class="math inline">\(X \circlearrowright G\)</span>, we can
form the stack <span class="math inline">\([X / G]]\)</span>, and we
have (groupoids) <span class="math display">\[\subset [X/G](k) =
\bigsqcup_{\alpha \in H^1(k, G)} X_\alpha(k) / G_\alpha(k).\]</span>
Here <span class="math inline">\(\alpha\)</span> corresponds to pure
inner forms <span class="math inline">\(G_\alpha\)</span></p>
<p>For example, if <span class="math inline">\(X = T \backslash G
\circlearrowleft T\)</span> (same notation as today), then we end up
looking at <span class="math display">\[(k)
    = \bigsqcup_{B \text{:quat}}
    T(k) \backslash G^B(k) / T(k).\]</span></p>
</div>
<p>Continuing (day 3), recall that <span class="math inline">\(L
/K\)</span> is a quadratic extension of global fields, and <span
class="math inline">\(T = L^\times / K^\times \subset G =
\mathrm{PGL}_2\)</span>. We take <span class="math display">\[B \in
\operatorname{Quat}_L(K) := \left\{ \text{quaternion algebras } B _{/K}
\text{ with } L \subset K \right\},\]</span> which gives rise to <span
class="math inline">\(G^B \supset T\)</span>.</p>
<div id="theorem:cq6uewzdca" class="theorem">
<p><strong>Theorem 88</strong> (Waldspurger). <em>Let <span
class="math inline">\(\pi \subset A_{\mathrm{cusp}}(G)\)</span>. Then
<span class="math inline">\(L(\tfrac{1}{2}, \pi) L(\tfrac{1}{2}, \pi
\times \eta) \neq 0\)</span> if and only if there exists <span
class="math inline">\(B \in \operatorname{Quat}_L(K)\)</span> and <span
class="math inline">\(\pi^B  \in A_{\mathrm{cusp}}(G)\)</span> such that
<span class="math inline">\(\pi = \operatorname{JL}(\pi^B)\)</span> and
<span class="math inline">\(\mathcal{P}_T |_{\pi^B} \neq
0\)</span>.</em></p>
</div>
<p>We explained this last time via an RTF comparison. To simplify, let
us introduce the notation <span class="math display">\[C(B) := -
N(L_B^-).\]</span> Then we saw that <span
class="math display">\[\mathrm{RTF}_{T \backslash G^B / T}(f^B) =
\sum_{x \in C(B)} O_x(f^B) +
  \mathop{\mathrm{vol}}([T]) O_0(f^B)
  + \mathop{\mathrm{vol}}([T]) O_\infty(f^B)\]</span> and <span
class="math display">\[\operatorname{RTF}_{A \backslash G / A, \eta}(f)
  = \sum_{x \in K^\times - \{1\}} O^{\eta}_x(f) + O^{\eta}_{0, +}(f)  +
O^{\eta}_{0, -}(f)
  + O^{\eta}_{\infty, +}(f) + O^{\eta}_{\infty, -}(f).\]</span>
Moreover, <span class="math display">\[\bigsqcup_{B \in
\operatorname{Quat}_L(K)} C(B) = K^\times - \{1\}.\]</span> We have seen
that there is a notion of <em>local transfer.</em> Let <span
class="math inline">\(v\)</span> be a place of <span
class="math inline">\(K\)</span>. Take <span
class="math display">\[C_c^\infty(G_v) \ni f_v
\longleftrightarrow(f^{B_v})_{B_v}, \quad B_v \in
\operatorname{Quat}_{L_v}(K_v).\]</span> We say that we have such a
matching if for each <span class="math inline">\(x \in C(B_v)\)</span>,
we have <span class="math inline">\(O_x^\eta(f_v) =
O_x(f^{B_v})\)</span>. We saw yesterday the first part of the
following:</p>
<div id="theorem:cq6uewzgjl" class="theorem">
<p><strong>Theorem 89</strong> (Jacquet). <em>Every <span
class="math inline">\(f_v\)</span> admits a transfer <span
class="math inline">\((f^{B_v})_{B_v}\)</span>, and conversely.
Moreover, if you have such matching functions, then for all <span
class="math inline">\(x \in \{0, \infty\}\)</span>, we have <span
class="math display">\[O_{x, +}^\eta(f_v) = \sum_{B_v \in
\operatorname{Quat}_{L_v}(K_v)} O_x(f^{B_v}),\]</span> <span
class="math display">\[O_{x, -}^\eta(f_v) = \sum_{B_v \in
\operatorname{Quat}_{L_v}(K_v)} \varepsilon(B_v) O_x(f^{B_v}),\]</span>
where <span class="math inline">\(\varepsilon(B_v)\)</span> is <span
class="math inline">\(\pm 1\)</span> according to whether <span
class="math inline">\(B_v\)</span> is split or not.</em></p>
</div>
<p>Finally, we need the <em>fundamentally lemma</em>:</p>
<div id="theorem:cq6uewzh6d" class="theorem">
<p><strong>Theorem 90</strong> (Jacquet). <em>If <span
class="math inline">\(v\)</span> is nonarchimedean and unramified in
<span class="math inline">\(L\)</span>, then for all <span
class="math inline">\(f_v \in C_c(G(\mathcal{O}_v) \backslash G(K_v) /
G(\mathcal{O}_v))\)</span>, there is an explicit transfer <span
class="math inline">\(f_v \longleftrightarrow(f^{B_v})_{B_v}\)</span>,
where <span class="math display">\[f^{B_v} =
    \begin{cases}
      f_v      
      &amp; \text{ if $B_v$ is split}, \\
      0 \text{ otherwise.}
    \end{cases}\]</span></em></p>
</div>
<p>We’ll now explain how to use this ingredient to prove an identity
relating relative trace formulas.</p>
<h3 id="sec:cq6uewy7rr">§5.2.8. Global comparison</h3>
<p>For each place <span class="math inline">\(v\)</span> of <span
class="math inline">\(K\)</span>, we are going to pick matching test
functions <span class="math inline">\(f_v
\longleftrightarrow(f^{B_v})_{B_v}\)</span>, as before, with the
requirement that for almost all <span class="math inline">\(v\)</span>,
we have that <span class="math inline">\(f_v =
\mathbf{1}_{G(\mathcal{O}_v)}\)</span> is the unit in the spherical
Hecke algebra (i.e., the characteristic function of the integral points)
and <span class="math display">\[f^{B_v} =
  \begin{cases}
    \mathbf{1}_{G(\mathcal{O}_v)}      
    &amp; \text{ if $B_v$ is split}, \\
    0
                                                                         &amp;
\text{ otherwise}.
  \end{cases}\]</span> We then set <span class="math display">\[f =
\prod_v f_v \in C_c^\infty(G(\mathbb{A})),
  \quad
  f^B = \prod_v f^{B_v} \in C_c^\infty(G^B(\mathbb{A})),\]</span> for
<span class="math inline">\(B \in \operatorname{Quat}_L(K)\)</span>.
Then for <span class="math inline">\(x \in C(B)\)</span>, <span
class="math display">\[O_x^\eta(f) = \prod_v O_x^\eta(f_v) = \prod_v
O_x(f^{B_v})
  = O_x(f^B).\]</span> You can do the same for <span
class="math inline">\(x \in \{0, \infty\}\)</span>, but you have to be a
bit more careful: <span class="math display">\[O_{x, +}^\eta(f) + O_{x,
-}^\eta(f) =
  \prod_v
  \underbrace
  {
    O_{x, +}^\eta(f_v)
  }_{
    \sum_{B_v} O_x(f^{B_v})
  }
  +
  \prod_v
  \underbrace
  {
    O_{x, -}^\eta(f_v)
  }_{
    \sum_{B_v} \varepsilon(B_v) O_x(f^{B_v})
  }.\]</span> Now you expand. Using what we said yesterday about when
collections of local quaternion algebras come from a global quaternion
algebra, we see that the above is <span class="math display">\[2
\mathop{\mathrm{vol}}([T]) \sum_{B} O_x(f^B).\]</span> As a consequence,
we obtain <span class="math display">\[\sum_B \operatorname{RTF}_{T
\backslash G^B / T}(f^B) = \operatorname{RTF}_{A \backslash G / A,
\eta}(f).\]</span> We now do the spectral expansions. The right hand
side expands to <span id="eq:cq6ueti8gi" class="math display">\[\label{eq:cq6ueti8gi}\tag{5.6}
  \sum_{\pi \subset A_{\mathrm{cusp}}(G)}
  \underbrace
  {
    \sum_{
      \substack{
        \varphi \in \mathcal{B}  \\
        \text{O.N.B.}      
      }
    }
    \mathcal{P}_A(R(f) \varphi)
    \mathcal{P}_{A, \eta}(\overline{\varphi})
  }_{
    I_\pi(f)
  } + \dotsb,\]</span> where <span class="math inline">\(\dotsb\)</span>
comes from the Eisenstein part of the spectrum. Similarly, the left hand
side expands to <span id="eq:cq6uetkg8x" class="math display">\[\label{eq:cq6uetkg8x}\tag{5.7}
  \sum_B
  \sum_{\pi^B \subset A_{\mathrm{cusp}}(G^B)}
  \underbrace
  {
    \sum_{\varphi \in \pi^B}
    \mathcal{P}_T(R(f^B) \varphi)
    \mathcal{P}_T(\overline{\varphi})
  }_{
    J_{\pi^B}(f^B)
  }
  + \dotsb.\]</span></p>
<p>Today we will mostly ignore the dots – you either have to rid of them
or to compute them explicitly, and we don’t want to explain how to do
either. So let’s just pretend that <span class="math inline">\(\dotsb =
0\)</span>.</p>
<p>Note that <span class="math inline">\(I_\pi(f) \neq 0\)</span> only
if <span class="math inline">\(\pi\)</span> is unramified outside <span
class="math inline">\(S\)</span>, and similarly, <span
class="math inline">\(J_{\pi^B}(f^B) \neq 0\)</span> only if <span
class="math inline">\(\pi^B\)</span> is unramified outside <span
class="math inline">\(S\)</span>. You can classify unramified
representations very easily, using Satake parameters. Suppose given a
cuspidal representation <span class="math inline">\(\pi\)</span>
unramified outside <span class="math inline">\(S\)</span>. We attach to
this a Satake parameter <span
class="math display">\[\operatorname{Sat}(\pi^S)
  :=
  \left( \operatorname{Sat}(\pi_v) \right)_{v \notin S} \in
  \prod_{v \notin S}
  \frac{\mathbb{C}^\times}{z \sim z^{-1}} =: \mathfrak{X}^S\]</span> and
similarly <span class="math display">\[\operatorname{Sat}(\pi^{B, S})
\in \mathfrak{X}^S.\]</span> The Satake isomorphism says that if you
take the restricted tensor product of the Hecke algebras outside <span
class="math inline">\(S\)</span>, namely <span
class="math display">\[\mathcal{H}^S := \bigotimes_{v \notin
S}{}&#39;C_c \left( G(\mathcal{O}_v) \backslash G(K_v) /
G(\mathcal{O}_v) \right)
  \simeq \mathbb{C}[\mathfrak{X}^S].\]</span> We now take advantage of
the fact that the fundamental lemma is valid for all elements of the
Hecke algebra: for each element <span class="math inline">\(h \in
\mathcal{H}^S\)</span>, we have the matching <span
class="math display">\[h \ast f \longleftrightarrow h \ast f^B\]</span>
for all <span class="math inline">\(B\)</span>. You can now replace
<span class="math inline">\(f\)</span> with <span
class="math inline">\(h \ast f\)</span> and <span
class="math inline">\(f^B\)</span> with <span class="math inline">\(h
\ast f^B\)</span>, which multiplies the contribution of <span
class="math inline">\(\pi\)</span> to <a href="#eq:cq6ueti8gi"
data-reference-type="eqref"
data-reference="eq:cq6ueti8gi">\((5.6)\)</a> by <span
class="math inline">\(\hat{h}(\pi^S)\)</span> and that of <span
class="math inline">\(\pi^B\)</span> to <a href="#eq:cq6uetkg8x"
data-reference-type="eqref"
data-reference="eq:cq6uetkg8x">\((5.7)\)</a> by <span
class="math inline">\(\hat{h}(\pi^S)\)</span>. Given <span
class="math inline">\(\pi \subset A_{\mathrm{cusp}}(G)\)</span>, we can
isolate on both sides automorphic representations with the same Satake
parameters as <span class="math inline">\(\pi\)</span>. But now it’s
well known, for example on the <span
class="math inline">\(\mathrm{PGL}_2\)</span> side, that there’s only
one automorphic representation with the same Satake parameters as <span
class="math inline">\(\pi\)</span>, namely, <span
class="math inline">\(\pi\)</span> itself. This is <em>strong
multiplicity one</em>. If you combine this with the Jacquet–Langlands
correspondence, you will see that on the other side, all that remains
are those <span class="math inline">\(\pi^B\)</span> whose
Jacquet–Langlands lift is <span class="math inline">\(\pi\)</span>,
giving <span class="math display">\[\sum_B \sum_{
    \substack{
      \pi_B:  \\
      \operatorname{JL}(\pi^B) = \pi
    }
  }
  J_{\pi^B}(f^B)
  = I_\pi(f).\]</span> By linear independence of characters, we see that
<span class="math inline">\(I_\pi \neq 0\)</span> if and only if there
exists <span class="math inline">\(B\)</span> and <span
class="math inline">\(\pi_{B}\)</span> so that <span
class="math inline">\(\operatorname{JL}(\pi^B) = \pi\)</span> and <span
class="math inline">\(J_{\pi^B} \neq 0\)</span>. On sees further that
<span class="math inline">\(I_\pi \neq 0\)</span> if and only if both
<span class="math inline">\(\mathcal{P}_{A, \eta} |_{\pi} \neq
0\)</span> and <span class="math inline">\(\mathcal{P}_A |_{\pi} \neq
0\)</span>. On the other hand, <span class="math inline">\(J_{\pi^B}
\neq 0\)</span> if and only if <span class="math inline">\(\mathcal{P}_T
|_{\pi^B} \neq 0\)</span>.</p>
<h2 id="sec:cq6uewy6d8">§5.3. Gan–Gross–Prasad</h2>
<p>In the remaining minutes, we very quickly explain a generalization
proposed by Gross–Prasad and Gan–Gross–Prasad (GGP) <a href="#ref-GGP"
class="citation" data-cites="GGP">(Gan, Gross, and Prasad
2012)</a>.</p>
<p>Waldspurger’s formula concerns <span class="math inline">\(T
\hookrightarrow G^B\)</span>. We may think of this as <span
class="math inline">\(\mathop{\mathrm{SO}}(2) \subset
\mathop{\mathrm{SO}}(3)\)</span>, or as <span
class="math inline">\(\mathop{\mathrm{U}}(1) \subset \operatorname{P
U}(2)\)</span>.</p>
<p>GGP concerns the generalization to <span
class="math inline">\(\mathop{\mathrm{SO}}(n) \subset
\mathop{\mathrm{SO}}(n + 1)\)</span> and <span
class="math inline">\(\mathop{\mathrm{U}}(n) \subset
\mathop{\mathrm{U}}(n + 1)\)</span>.</p>
<p>Let’s focus on the unitary case.</p>
<p>Let <span class="math inline">\(L /K\)</span> be a quadratic
extension. To define unitary groups, we need hermitian spaces. Let <span
class="math inline">\((V&#39;, h)\)</span> be a hermitian space of
dimension <span class="math inline">\(n + 1\)</span> with respect to
<span class="math inline">\(L/K\)</span>. Fix <span
class="math inline">\(V \subset V&#39;\)</span> a non-degenerate
hyperplane, with <span class="math inline">\(\dim V = n\)</span> and
<span class="math inline">\(V&#39; = V \bigoplus L\)</span> (orthogonal
direct sum, with <span class="math inline">\(L\)</span> a line). It’s
more convenient to work with the product of the two unitary groups,
<span class="math inline">\(G^V := \mathop{\mathrm{U}}(V) \times
\mathop{\mathrm{U}}(V&#39;)\)</span>, which contains the diagonal
embedding of <span class="math inline">\(H^V :=
\mathop{\mathrm{U}}(V)\)</span>. We now have a group and a subgroup, so
we have a period, the <em>GGP period</em>, <span
class="math display">\[\mathcal{P}_{H^V} := A_{\mathrm{cusp}}(G^V)
  \rightarrow \mathbb{C}.\]</span> This is one of the two ingredients.
The other is an <span class="math inline">\(L\)</span>-function. It’s
essentially the direct generalization of the <span
class="math inline">\(L\)</span>-function appearing in the most general
version of Waldspurger’s theorem (the one involving <span
class="math inline">\(L(\tfrac{1}{2}, \pi_L \times \chi)\)</span>). We
can do the same here, except that it requires also using Langlands base
change, a case of Langlands functoriality. Start with a cuspidal
automorphic representation <span class="math inline">\(\pi = \pi_n
\boxtimes \pi_{n + 1} \subset A_{\mathrm{cusp}}(G)\)</span>. Take its
base change <span class="math inline">\(\pi_L = \pi_{n, L} \boxtimes
\pi_{n + 1, L} \subset A(G_L)\)</span> (which is now known to exist in
generality, see the work of Mok, Minguez, Shin and White). In fact,
<span class="math inline">\(G_L =\mathrm{GL}_{n, L} \times\mathrm{GL}_{n
+ 1, L}\)</span>. We may thus form the Rankin–Selberg <span
class="math inline">\(L\)</span>-function <span
class="math display">\[L(s, \pi_L) = L(s, \pi_{n, L} \times \pi_{n + 1,
L}).\]</span></p>
<p>There’s actually a third ingredient, because we need the analogue of
the family of quaternion algebras. These are called <em>pure inner
forms</em>. They are again parametrized by linear algebraic data. They
correspond to <span class="math inline">\(W\)</span>, another <span
class="math inline">\(n\)</span>-dimensional hermitian space, and
construct similar groups, but with <span
class="math inline">\(W\)</span> replacing <span
class="math inline">\(V\)</span>. One defines <span
class="math inline">\(W &#39; := W \bigoplus L\)</span> (orthogonal
direct sum) and <span class="math inline">\(G^W \supset H^W\)</span>.
There’s again a form of the Jacquet–Langlands correspondence, which
gives a relation between automorphic forms on such groups as <span
class="math inline">\(W\)</span> varies. One way to define it is to say
that a cuspidal automorphic representation <span
class="math inline">\(\pi \subset A_{\mathrm{cusp}}(G^V)\)</span> and
<span class="math inline">\(\pi &#39; \subset
A_{\mathrm{cusp}}(G^W)\)</span> are <em>nearly equivalent</em> if they
are the same locally at almost all places: <span
class="math inline">\(\pi_v \simeq \pi_v &#39;\)</span> for almost all
<span class="math inline">\(v\)</span>.</p>
<div id="theorem:cq6uewzmi6" class="theorem">
<p><strong>Theorem 91</strong> (GGP conjecture). <em>Let <span
class="math inline">\(\pi \subset A_{\mathrm{cusp}}(G^V)\)</span>.
Assume that <span class="math inline">\(\pi_L\)</span> is generic. Then
the following are equivalent:</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(L(\tfrac{1}{2}, \pi_L) \neq
0\)</span>.</em></p></li>
<li><p><em>There exists <span class="math inline">\(W\)</span>, as
before, and a cuspidal representation <span class="math inline">\(\pi
&#39;\)</span> of the corresponding pure inner form, such that <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\pi&#39;\)</span> are nearly equivalent and <span
class="math inline">\(\mathcal{P}_{H^W} |_{\pi
&#39;}\)</span>.</em></p></li>
</ol>
</div>
<div id="remark:cq6uew7e6j" class="remark">
<p><strong>Remark 92</strong>. </p>
<ul>
<li><p>This follows from the work of many people (and we’ll probably
forget some of them). What started it all was the work of Jacquet–Rallis
<a href="#ref-MR2767518" class="citation" data-cites="MR2767518">(Jacquet and Rallis
2011)</a>. What they did was they found a pair of RTF’s whose
comparison was expected to give the conjecture (the proof is similar to
what we have seen in the Waldspurger case). They also wrote down what
the matching should be, precisely. There was the work of Wei Zhang <a href="#ref-MR3245011"
class="citation" data-cites="MR3245011">(Zhang 2014)</a>, Zhiwei Yun,
Beuzart-Plessis–Liu–Zhang–Zhu <a href="#ref-MR4298750" class="citation"
data-cites="MR4298750">(Raphaël Beuzart-Plessis et al. 2021)</a>, and
<a href="#ref-MR4426741" class="citation" data-cites="MR4426741">(Raphaël Beuzart-Plessis,
Chaudouard, and Zydor 2022)</a>.</p></li>
<li><p>The analogous conjecture for <span
class="math inline">\((\mathop{\mathrm{SO}}(n), \mathop{\mathrm{SO}}(n +
1))\)</span> is still open except for small values of <span
class="math inline">\(n\)</span>. The case <span class="math inline">\(n
= 2\)</span> is essentially Waldspurger; <span class="math inline">\(n =
3\)</span> is the formula for trilinear period that appeared in Chen’s
talk and follows from work of Garrett, Kudla–Harris and Ichino. Already
for <span class="math inline">\(n = 4\)</span>, it’s not known in
generality.</p></li>
<li><p>There are similar conjectures for <span
class="math inline">\((\mathop{\mathrm{U}}(m),
\mathop{\mathrm{U}}(n))\)</span>. These are known for any <span
class="math inline">\(m\)</span> and <span
class="math inline">\(n\)</span>. There’s first the case where <span
class="math inline">\(n \not \equiv m(2)\)</span>. This involves, as
we’ve seen in Chen’s lectures, a degenerate Fourier coefficient (but no
theta series). The proof of the <span
class="math inline">\((\mathop{\mathrm{U}}(n),
\mathop{\mathrm{U}}(n+1))\)</span> case was extended to this more
general case in work of Beuzart-Plessis–Chaudouard. The case where <span
class="math inline">\(n \equiv m (2)\)</span> is a new setting, where
you have to compare two different RTF’s involving Fourier–Jacobi
periods. This case involved theta series. It was very recently
established by Boisseau–Lu–Xue, again using a comparison of
RTF.</p></li>
<li><p>The proof uses RTF comparison (Jacquet–Rallis). The two RTF to be
compared are <span class="math display">\[\mathrm{RTF}_{H^\vee
\backslash G^\vee / H^\vee}, \qquad
      \mathrm{RTF}_{H_1 \backslash G&#39; / H_2, \eta}\]</span> where
<span class="math display">\[H_2 :=\mathrm{GL}_{n, K}
\times\mathrm{GL}_{n + 1, K}
      \subset
      G&#39; :=\mathrm{GL}_{n, L} \times\mathrm{GL}_{n + 1, L}
      \supset H_1 :=\mathrm{GL}_{n, L}.\]</span></p></li>
</ul>
</div>
<div id="refs" class="references csl-bib-body hanging-indent"
data-entry-spacing="0" role="list">
<div id="ref-2024arXiv2409.04677" class="csl-entry" role="listitem">
Ben-Zvi, David, Yiannis Sakellaridis, and Akshay Venkatesh. 2024.
<span>“Relative Langlands Duality,”</span> September. <a
href="http://arxiv.org/abs/2409.04677v1">http://arxiv.org/abs/2409.04677v1</a>.
</div>
<div id="ref-MR1075727" class="csl-entry" role="listitem">
Bernstein, Joseph N. 1988. <span>“On the Support of
<span>P</span>lancherel Measure.”</span> <em>J. Geom. Phys.</em> 5 (4):
663–710. <a
href="https://doi.org/10.1016/0393-0440(88)90024-1">https://doi.org/10.1016/0393-0440(88)90024-1</a>.
</div>
<div id="ref-2015arXiv150601452B" class="csl-entry" role="listitem">
Beuzart-Plessis, R. 2015. <span>“<span class="nocase">A local trace
formula for the Gan-Gross-Prasad conjecture for unitary groups: the
archimedean case</span>.”</span> <em>ArXiv e-Prints</em>, June. <a
href="https://arxiv.org/abs/1506.01452">https://arxiv.org/abs/1506.01452</a>.
</div>
<div id="ref-MR4426741" class="csl-entry" role="listitem">
Beuzart-Plessis, Raphaël, Pierre-Henri Chaudouard, and Michał Zydor.
2022. <span>“The Global
<span>G</span>an-<span>G</span>ross-<span>P</span>rasad Conjecture for
Unitary Groups: The Endoscopic Case.”</span> <em>Publ. Math. Inst.
Hautes Études Sci.</em> 135: 183–336. <a
href="https://doi.org/10.1007/s10240-021-00129-1">https://doi.org/10.1007/s10240-021-00129-1</a>.
</div>
<div id="ref-MR4298750" class="csl-entry" role="listitem">
Beuzart-Plessis, Raphaël, Yifeng Liu, Wei Zhang, and Xinwen Zhu. 2021.
<span>“Isolation of Cuspidal Spectrum, with Application to the
<span>G</span>an-<span>G</span>ross-<span>P</span>rasad
Conjecture.”</span> <em>Ann. Of Math. (2)</em> 194 (2): 519–84. <a
href="https://doi.org/10.4007/annals.2021.194.2.5">https://doi.org/10.4007/annals.2021.194.2.5</a>.
</div>
<div id="ref-GGP" class="csl-entry" role="listitem">
Gan, Wee Teck, Benedict H. Gross, and Dipendra Prasad. 2012.
<span>“Symplectic Local Root Numbers, Central Critical <span><span
class="math inline">\(L\)</span></span> Values, and Restriction Problems
in the Representation Theory of Classical Groups.”</span>
<em>Astérisque</em>, no. 346: 1–109.
</div>
<div id="ref-MR881269" class="csl-entry" role="listitem">
Garrett, Paul B. 1987. <span>“Decomposition of <span>E</span>isenstein
Series: <span>R</span>ankin Triple Products.”</span> <em>Ann. Of Math.
(2)</em> 125 (2): 209–35. <a
href="https://doi.org/10.2307/1971310">https://doi.org/10.2307/1971310</a>.
</div>
<div id="ref-MR4887846" class="csl-entry" role="listitem">
Getz, Jayce R. 2025. <span>“Summation Formulae for Quadrics.”</span>
<em>Selecta Math. (N.S.)</em> 31 (2): Paper No. 41, 42. <a
href="https://doi.org/10.1007/s00029-025-01036-7">https://doi.org/10.1007/s00029-025-01036-7</a>.
</div>
<div id="ref-2025arXiv2503.21648" class="csl-entry" role="listitem">
Getz, Jayce R., Miao Pam Gu, Chun-Hsien Hsu, and Spencer Leslie. 2025.
<span>“On Triple Product <span
class="math inline">\(L\)</span>-Functions and the Fiber Bundle
Method,”</span> March. <a
href="http://arxiv.org/abs/2503.21648v2">http://arxiv.org/abs/2503.21648v2</a>.
</div>
<div id="ref-MR3916514" class="csl-entry" role="listitem">
Getz, Jayce R., and Baiying Liu. 2019. <span>“A Summation Formula for
Triples of Quadratic Spaces.”</span> <em>Adv. Math.</em> 347: 150–91. <a
href="https://doi.org/10.1016/j.aim.2019.02.023">https://doi.org/10.1016/j.aim.2019.02.023</a>.
</div>
<div id="ref-MR2767518" class="csl-entry" role="listitem">
Jacquet, Hervé, and Stephen Rallis. 2011. <span>“On the
<span>G</span>ross-<span>P</span>rasad Conjecture for Unitary
Groups.”</span> In <em>On Certain <span><span
class="math inline">\(L\)</span></span>-Functions</em>, 13:205–64. Clay
Math. Proc. Amer. Math. Soc., Providence, RI.
</div>
<div id="ref-2023arXiv2310.17837" class="csl-entry" role="listitem">
Mao, Zhengyu, Chen Wan, and Lei Zhang. 2023. <span>“BZSV Duality for
Some Strongly Tempered Spherical Varieties,”</span> October. <a
href="http://arxiv.org/abs/2310.17837v3">http://arxiv.org/abs/2310.17837v3</a>.
</div>
<div id="ref-MR911357" class="csl-entry" role="listitem">
Piatetski-Shapiro, I., and Stephen Rallis. 1987. <span>“Rankin Triple
<span><span class="math inline">\(L\)</span></span> Functions.”</span>
<em>Compositio Math.</em> 64 (1): 31–115. <a
href="http://www.numdam.org/item?id=CM_1987__64_1_31_0">http://www.numdam.org/item?id=CM_1987__64_1_31_0</a>.
</div>
<div id="ref-MR3117308" class="csl-entry" role="listitem">
Sakellaridis, Yiannis. 2013. <span>“Spherical Functions on Spherical
Varieties.”</span> <em>Amer. J. Math.</em> 135 (5): 1291–381. <a
href="https://doi.org/10.1353/ajm.2013.0046">https://doi.org/10.1353/ajm.2013.0046</a>.
</div>
<div id="ref-MR3245011" class="csl-entry" role="listitem">
Zhang, Wei. 2014. <span>“Fourier Transform and the Global
<span>G</span>an-<span>G</span>ross-<span>P</span>rasad Conjecture for
Unitary Groups.”</span> <em>Ann. Of Math. (2)</em> 180 (3): 971–1049. <a
href="https://doi.org/10.4007/annals.2014.180.3.4">https://doi.org/10.4007/annals.2014.180.3.4</a>.
</div>
</div>
<script>
document.querySelectorAll(".toggle-proof").forEach(function(toggle) {
  toggle.addEventListener("click", function(e) {
    e.preventDefault();
    const content = this.nextElementSibling;
    const em = this.querySelector('em');
    if (window.getComputedStyle(content).display === "none") {
      content.style.display = "inline";
      em.textContent = em.dataset.defaultText;
    } else {
      content.style.display = "none";
      em.textContent = em.dataset.foldedText;
    }
  });
});
</script>
<script>
document.querySelector("#toggle-all-proofs").addEventListener("click", function(e) {
  e.preventDefault();
  const proofs = document.querySelectorAll(".proof-content");
  proofs.forEach(function(proof) {
    const proofToggle = proof.previousElementSibling;
    if (window.getComputedStyle(proof).display === "none") {
      proof.style.display = "inline";
      proofToggle.innerHTML = `<em>${proofToggle.dataset.defaultText}</em>`;
    } else {
      proof.style.display = "none";
      proofToggle.innerHTML = `<em>${proofToggle.dataset.foldedText}</em>`;
    }
  });
});
</script>

<script src="https://giscus.app/client.js"
        data-repo="Ultronozm/math"
        data-repo-id="R_kgDOJlhjqQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOJlhjqc4CWo21"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</body>
</html>

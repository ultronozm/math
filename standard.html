<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Paul D. Nelson" />
  <title>Bounds for standard L-functions</title>
  <style>
      .my-links-container {
        position: absolute;
        top: 0;
        right: 0;
        padding-right: 20px;
        padding-top: 10px;
      }
      .my-link {
        margin-left: 10px;
      }
    html {
line-height: 1.5;
font-family: Georgia, serif;
font-size: 20px;
color: #1a1a1a;
background-color: #fdfdfd;
}
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    div.abstract {
      margin: 2em 2em 2em 2em;
      text-align: left;
      font-size: 85%;
    }
    div.abstract-title {
      font-weight: bold;
      text-align: center;
      padding: 0;
      margin-bottom: 0.5em;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
    <div class="my-links-container">
      <a href="standard.tex" class="my-link">tex</a>
      <a href="standard.pdf" class="my-link">pdf</a>
    </div>
<header id="title-block-header">
<h1 class="title">Bounds for standard <span
class="math inline">\(L\)</span>-functions</h1>
<p class="author">Paul D. Nelson</p>
<div class="abstract">
<div class="abstract-title">Abstract</div>
<p>Let <span class="math inline">\(\pi\)</span> be a cuspidal
automorphic representation of a general linear group over the rational
numbers. We establish a subconvex bound for the standard <span
class="math inline">\(L\)</span>-function of <span
class="math inline">\(\pi\)</span> in the <span
class="math inline">\(t\)</span>-aspect. More generally, we address the
spectral aspect in the case of uniform parameter growth.</p>
</div>
</header>
<h3 id="sec:introduction">§1. Introduction</h3>
<p>Let <span class="math inline">\(\pi\)</span> be a unitary cuspidal
automorphic representation of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span>. The standard <span
class="math inline">\(L\)</span>-functions <span
class="math inline">\(L(\pi,s)\)</span> (<span class="math inline">\(s
\in \mathbb{C}\)</span>) were introduced by Godement–Jacquet <a href="#ref-MR0342495"
class="citation" data-cites="MR0342495">(Godement and Jacquet
1972)</a>, and later interpreted more broadly by
Jacquet–Piatetski-Shapiro–Shalika as the <span
class="math inline">\({\mathop{\mathrm{GL}}}_n \times
{\mathop{\mathrm{GL}}}_1\)</span> case of Rankin–Selberg convolutions for
<span class="math inline">\({\mathop{\mathrm{GL}}}_n \times
{\mathop{\mathrm{GL}}}_m\)</span>; we refer to §<a
href="#sec:standard-l-factors" data-reference-type="ref"
data-reference="sec:standard-l-factors">2.14.3</a>, §<a
href="#sec:standard-l-functions" data-reference-type="ref"
data-reference="sec:standard-l-functions">2.14.5</a> and references for
further details, and also the summaries of <a href="#ref-MR546609" class="citation"
data-cites="MR546609">(Hervé Jacquet 1979)</a>, <a href="#ref-MR1395406"
class="citation" data-cites="MR1395406">(Rudnick and Sarnak 1996, sec.
2)</a> and <a href="#ref-MR2508768" class="citation" data-cites="MR2508768">(Cogdell
2008)</a>. Conjectures of Langlands <a href="#ref-MR0302614" class="citation"
data-cites="MR0302614">(R. P. Langlands 1970)</a> predict that “all
<span class="math inline">\(L\)</span>-functions” arise as shifted
products of such standard <span
class="math inline">\(L\)</span>-functions.</p>
<p>As a matter of convention, we exclude archimedean factors from the
definition, so that <span class="math inline">\(L(\pi,s)\)</span> is
defined for <span class="math inline">\(s \in \mathbb{C}\)</span> with
<span class="math inline">\(\Re(s) &gt; 1\)</span> <a href="#ref-MR618323"
class="citation" data-cites="MR618323">(H. Jacquet and Shalika 1981, I,
Thm 5.3)</a> by an Euler product <span
class="math display">\[L(\pi,s) = \prod_p L(\pi_p,s),\]</span> and in
general by meromorphic continuation. In the case <span
class="math inline">\(n = 1\)</span>, these are the Dirichlet <span
class="math inline">\(L\)</span>-functions, which include the Riemann
zeta function as a special case. We focus here on the case <span
class="math inline">\(n \geqslant 2\)</span>, in which <span
class="math inline">\(L(\pi,s)\)</span> is known to be entire.</p>
<h4 id="sec:subc-probl-t">§1.1. The subconvexity problem in the <span
class="math inline">\(t\)</span>-aspect</h4>
<p>For each natural number <span class="math inline">\(n\)</span>, let
<span class="math inline">\(\delta_n\)</span> denote the supremum of all
real numbers <span class="math inline">\(\delta\)</span> with the
property that for each unitary cuspidal automorphic representation <span
class="math inline">\(\pi\)</span> of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span>, there exists <span
class="math inline">\(C_0 \geqslant 0\)</span> so that for all <span
class="math inline">\(t \in \mathbb{R}\)</span>, <span id="eq:lpi-tfrac12-+" class="math display">\[\label{eq:lpi-tfrac12-+}\tag{1.1}
  |L(\pi,\tfrac{1}{2} + i  t)| \leqslant C_0 (1 + |t|)^{(1 - \delta)
n/4}.\]</span> The convexity bound (see Lemma <a
href="#lem:convexity-bound" data-reference-type="ref"
data-reference="lem:convexity-bound">23</a>) implies that <span
class="math inline">\(\delta_n \geqslant 0\)</span>, while the
generalized Lindelöf hypothesis predicts that <span
class="math inline">\(\delta_n = 1\)</span>. The <span
class="math inline">\(t\)</span>-aspect subconvexity problem for <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> (over <span
class="math inline">\(\mathbb{Q}\)</span>) is to show that <span
class="math inline">\(\delta_n &gt; 0\)</span>. For an overview of the
history on this problem, we refer to <a href="#ref-MR1403937" class="citation"
data-cites="MR1403937">(Friedlander 1995)</a>, <a href="#ref-MR1826269" class="citation"
data-cites="MR1826269">(Iwaniec and Sarnak 2000, sec. 2)</a>, <a href="#ref-MichelVenkateshICM"
class="citation" data-cites="MichelVenkateshICM">(Philippe Michel and
Venkatesh 2006)</a>, <a href="#ref-MR2331346" class="citation"
data-cites="MR2331346">(Philippe Michel 2007, sec. 4, §5)</a> and
<a href="#ref-MR3966770" class="citation" data-cites="MR3966770">(Munshi 2018a)</a>. We
survey below some of the existing literature, which has primarily
addressed the case <span class="math inline">\(n \leqslant 3\)</span>.
Our motivating result is the following.</p>
<div id="thm:t-aspect" class="theorem">
<p><strong>Theorem 1</strong>. <em>For each natural number <span
class="math inline">\(n\)</span>, we have <span
class="math inline">\(\delta_n &gt; 0\)</span>. In fact, for <span
class="math inline">\(n \geqslant 2\)</span>, <span id="eq:delta_n-geq-frac1" class="math display">\[\label{eq:delta_n-geq-frac1}\tag{1.2}
    \delta_n \geqslant\delta_n ^\sharp := \frac{2}{ 3 n^5 - 2 n^4 - n^2
} &gt; \frac{2}{3 n^5}.\]</span> That is to say, for each unitary
cuspidal automorphic representation <span
class="math inline">\(\pi\)</span> of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span> and each <span
class="math inline">\(\delta &lt; \delta_n ^\sharp\)</span>, there
exists <span class="math inline">\(C_0 \geqslant 0\)</span> so that
<span class="math inline">\(|L(\pi,\tfrac{1}{2} + i t)| \leqslant C_0 (1
+ |t|)^{(1 - \delta) n/4}\)</span>.</em></p>
</div>
<p>We note that when <span class="math inline">\(n=2\)</span> or <span
class="math inline">\(3\)</span>, our estimate <a
href="#eq:delta_n-geq-frac1" data-reference-type="eqref"
data-reference="eq:delta_n-geq-frac1">\((1.2)\)</a> is not
competitive with the existing numerical records. On the other hand, we
have prioritized the clarity and uniformity of our arguments over their
numerical optimality.</p>
<h5 class="unnumbered" id="summary-of-existing-literature">Summary of
existing literature</h5>
<p>It will be useful to introduce the modified quantity <span
class="math inline">\(\delta_n^{(*)}\)</span> (resp. <span
class="math inline">\(\delta_{n}^{(**)}\)</span>) defined similarly, but
restricting the quantification to <span
class="math inline">\(\pi\)</span> that are unramified at every finite
place (resp. that correspond to Hecke–Maass cusp forms on <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{Z})\)</span>).
Clearly <span class="math inline">\(\delta_n^{(**)}
\geqslant\delta_n^{(*)} \geqslant\delta_n\)</span>. Many papers
establish lower bounds for <span
class="math inline">\(\delta_n^{(*)}\)</span> or <span
class="math inline">\(\delta_n^{(**)}\)</span> using methods that are
expected to extend to <span class="math inline">\(\delta_n\)</span>,
although such extensions have not consistently been carried out.</p>
<p>It has been known that <span class="math inline">\(\delta_1 &gt;
0\)</span> since the classical work of Weyl, Hardy–Littlewood and Landau
<a href="#ref-MR1511862 MR1544665" class="citation" data-cites="MR1511862 MR1544665">(Weyl 1916;
Landau 1924)</a>, who in fact established the stronger bound <span
class="math inline">\(\delta_1 \geqslant 1/3\)</span>. The current
numerical record, <span class="math inline">\(\delta_1^{(*)} \geqslant
65/171 = 0.380\dotsb\)</span>, follows from work of Bombieri–Iwaniec
<a href="#ref-MR881101" class="citation" data-cites="MR881101">(Bombieri and Iwaniec
1986)</a> and Bourgain <a href="#ref-MR3556291" class="citation"
data-cites="MR3556291">(Bourgain 2017)</a>.</p>
<p>It was shown first by Good <a href="#ref-MR696884" class="citation"
data-cites="MR696884">(Good 1982)</a> and Meurman <a href="#ref-MR1058223"
class="citation" data-cites="MR1058223">(Meurman 1990)</a> that <span
class="math inline">\(\delta_2^{(*)} &gt; 0\)</span>, and in fact that
<span class="math inline">\(\delta_2^{(*)} \geqslant 1/3\)</span>.
Recently Aggarwal <a href="#ref-MR4032289" class="citation"
data-cites="MR4032289">(Aggarwal 2020)</a> showed that <span
class="math inline">\(\delta_2 \geqslant 1/3\)</span> (see also
Booker–Milinovich–Ng <a href="#ref-MR3872849" class="citation"
data-cites="MR3872849">(Booker, Milinovich, and Ng 2019)</a>).</p>
<p>It was shown first by Munshi <a href="#ref-MR3369905" class="citation"
data-cites="MR3369905">(Munshi 2015)</a>, following earlier work of
X. Li <a href="#ref-MR2753605" class="citation" data-cites="MR2753605">(Xiaoqing Li
2011)</a>, that <span class="math inline">\(\delta_3^{(**)} &gt;
0\)</span>, and in fact that <span class="math inline">\(\delta_3^{(**)}
\geqslant 1/24\)</span>. This has been improved to <span
class="math inline">\(\delta_3^{(**)} \geqslant 1/10\)</span> by
Aggarwal <a href="#ref-MR4270876" class="citation" data-cites="MR4270876">(Aggarwal
2021)</a> and to <span class="math inline">\(\delta_3^{(**)}
\geqslant 1/6\)</span> by Aggarwal–Leung–Munshi <a href="#ref-2022arXiv220606517A" class="citation"
data-cites="2022arXiv220606517A">(Aggarwal, Leung, and Munshi
2022)</a>.</p>
<p>Sporadic cases of <span class="math inline">\(t\)</span>-aspect
subconvex bounds in higher rank have also been given, e.g., for
Rankin–Selberg convolutions on <span
class="math inline">\({\mathop{\mathrm{GL}}}_2 \times
{\mathop{\mathrm{GL}}}_2\)</span> <a href="#ref-MR2726097 2021arXiv210112106B" class="citation"
data-cites="MR2726097 2021arXiv210112106B">(J. Bernstein and Reznikov
2010; Blomer, Jana, and Nelson 2023)</a> or <span
class="math inline">\({\mathop{\mathrm{GL}}}_3 \times
{\mathop{\mathrm{GL}}}_2\)</span> <a href="#ref-2018arXiv181000539M" class="citation"
data-cites="2018arXiv181000539M">(Munshi 2018b)</a>.</p>
<p>Soundararajan <a href="#ref-MR2680497" class="citation"
data-cites="MR2680497">(Soundararajan 2010, Example 3)</a>
established the following nontrivial bound, weaker than the assertion
that <span class="math inline">\(\delta_n &gt; 0\)</span>: for each
<span class="math inline">\(n\)</span> and <span
class="math inline">\(\pi\)</span> as above, and each <span
class="math inline">\(\varepsilon&gt; 0\)</span>, there exists <span
class="math inline">\(C_0\)</span> so that <span id="eq:lpi-tfrac12-+-1" class="math display">\[\label{eq:lpi-tfrac12-+-1}\tag{1.3}
  |L(\pi, \tfrac{1}{2} + i t)| \leqslant C_0 \frac{(1 + |t|)^{n/4}
}{(\log (3 + |t|))^{1 - \varepsilon}}.\]</span></p>
<h4 id="sec:subc-bounds-assum">§1.2. Subconvex bounds assuming uniform
parameter growth</h4>
<p>We will establish Theorem <a href="#thm:t-aspect"
data-reference-type="ref" data-reference="thm:t-aspect">1</a> in a more
general form.</p>
<p>The archimedean factor attached to <span
class="math inline">\(L(\pi,s)\)</span> may be written <span id="eqn:L-infinity" class="math display">\[\label{eqn:L-infinity}\tag{1.4}
  L_\infty(\pi,s) =
  \prod_{j=1}^{n}
  \Gamma_\mathbb{R}(s + t_j),
  \quad
  \Gamma_{\mathbb{R}}(s) := \pi^{-s/2} \Gamma(s/2)\]</span> for some
complex numbers <span class="math inline">\(t_j\)</span>, which we call
the <em>archimedean <span class="math inline">\(L\)</span>-function
parameters</em> of <span class="math inline">\(\pi\)</span>. The
functional equation for <span class="math inline">\(L(\pi,s)\)</span>
involves a natural number, called the <em>finite conductor</em> of <span
class="math inline">\(\pi\)</span>, which we denote by <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}})\)</span>. The
<em>analytic conductor</em> of <span class="math inline">\(\pi\)</span>
<a href="#ref-MR1826269" class="citation" data-cites="MR1826269">(Iwaniec and Sarnak
2000)</a> is then defined to be the product <span
class="math inline">\(C(\pi) := C(\pi_{\mathop{\mathrm{fin}}})
C(\pi_\infty)\)</span>, where <span
class="math inline">\(C(\pi_\infty)\)</span>, the <em>archimedean
conductor</em>, is the product <span class="math inline">\(\prod_{j=1}^n
(3 + |t_j|)\)</span> or some mild variant thereof.</p>
<p>Write <span class="math inline">\(\mathcal{A}(n)\)</span> for the set
of unitary cuspidal automorphic representations of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span>. The convexity bound (Lemma <a
href="#lem:convexity-bound" data-reference-type="ref"
data-reference="lem:convexity-bound">23</a>) asserts that for each
natural number <span class="math inline">\(n\)</span> and <span
class="math inline">\(\varepsilon&gt; 0\)</span>, there exists <span
class="math inline">\(C_0 \geqslant 0\)</span> so that for each <span
class="math inline">\(\pi \in \mathcal{A}(n)\)</span>, <span
class="math display">\[|L(\pi,\tfrac{1}{2})| \leqslant C_0
C(\pi)^{1/4+\varepsilon}.\]</span></p>
<p>We say that a family <span class="math inline">\(\mathcal{F} \in
\mathcal{A}(n)\)</span> satisfies a <em>subconvex bound</em> if there
exists <span class="math inline">\(\delta &gt; 0\)</span> and <span
class="math inline">\(C_0 \geqslant 0\)</span> so that for all <span
class="math inline">\(\pi \in \mathcal{F}\)</span>, <span
class="math display">\[|L(\pi, \tfrac{1}{2} )| \leqslant C_0 C(\pi)^{(1
- \delta)/4}.\]</span> The generalized Lindelöf hypothesis predicts that
every family (or equivalently, the “universal family” <span
class="math inline">\(\mathcal{F} = \mathcal{A}(n)\)</span>) satisfies a
subconvex bound with <span class="math inline">\(\delta = 1\)</span>. It
is known by the classical work of Weyl <a href="#ref-MR1511862" class="citation"
data-cites="MR1511862">(Weyl 1916)</a>, Hardy–Littlewood, Landau
<a href="#ref-MR1544665" class="citation" data-cites="MR1544665">(Landau 1924)</a>,
Burgess <a href="#ref-Bur57" class="citation" data-cites="Bur57">(Burgess 1957)</a>
and Heath-Brown <a href="#ref-MR485727" class="citation"
data-cites="MR485727">(Heath-Brown 1978)</a> that for <span
class="math inline">\(n = 1\)</span>, every family satisfies a subconvex
bound. The more recent work of Michel–Venkatesh <a href="#ref-michel-2009" class="citation"
data-cites="michel-2009">(Philippe Michel and Venkatesh 2010)</a>
established the same conclusion when <span
class="math inline">\(n=2\)</span> (indeed, for the analogous problem
over any fixed number field).</p>
<p>Soundararajan–Thorner <a href="#ref-MR3953433" class="citation"
data-cites="MR3953433">(Soundararajan and Thorner 2019)</a> recently
established the general logarithmic improvement <span id="eq:lpi-tfrac12-leq-2" class="math display">\[\label{eq:lpi-tfrac12-leq-2}\tag{1.5}
  |L(\pi,\tfrac{1}{2})| \leqslant C_0 \frac{C(\pi)^{1/4}}{(\log
C(\pi))^{1/10^7 n^3}}.\]</span> Their work made unconditional an earlier
result of Soundararajan <a href="#ref-MR2680497" class="citation"
data-cites="MR2680497">(Soundararajan 2010, Thm 1)</a>, which
featured the stronger logarithmic improvement <span
class="math inline">\((\log C(\pi))^{1-\varepsilon}\)</span>, as in <a
href="#eq:lpi-tfrac12-+-1" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-+-1">\((1.3)\)</a>, but under
the assumption of (a weakened form of) the generalized Ramanujan
conjecture.</p>
<p>We focus in this paper on the <em>spectral aspect</em>, in which one
regards the archimedean conductor <span
class="math inline">\(C(\pi_\infty)\)</span> as varying substantially
and the finite conductor <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}})\)</span> as either
fixed or varying mildly. We say that <span
class="math inline">\(\mathcal{F} \subseteq  \mathcal{A}(n)\)</span>
satisfies a <em>spectral aspect subconvex bound, with polynomial
dependence upon the level</em>, if there exists <span
class="math inline">\(\delta &gt; 0\)</span>, <span
class="math inline">\(C_0 \geqslant 0\)</span> and <span
class="math inline">\(A \geqslant 0\)</span> so that for all <span
class="math inline">\(\pi \in \mathcal{F}\)</span>, <span id="eq:lpi-tfrac12-leq-1" class="math display">\[\label{eq:lpi-tfrac12-leq-1}\tag{1.6}
  |L(\pi,\tfrac{1}{2})| \leqslant C_0 C(\pi_\infty)^{(1-\delta)/4}
C(\pi_{\mathop{\mathrm{fin}}})^{A}.\]</span></p>
<p>The following definition has played an important (although often
implicit) role in the literature on the subject, and also in this paper.
We say that <span class="math inline">\(\mathcal{F} \subseteq
\mathcal{A}(n)\)</span> has <em>uniform parameter growth</em> if there
exists <span class="math inline">\(c &gt; 0\)</span> so that for each
<span class="math inline">\(\pi \in \mathcal{F}\)</span>, the
archimedean <span class="math inline">\(L\)</span>-function parameters
<span class="math inline">\(t_1,\dotsc,t_n\)</span> of <span
class="math inline">\(\pi\)</span> satisfy <span id="eq:c-leq-fract_j1" class="math display">\[\label{eq:c-leq-fract_j1}\tag{1.7}
  \frac{\min \{|t_1|, \dotsc, |t_n|\} }{1 + \max \{|t_1|,\dotsc,|t_n|\}}
\geqslant c.\]</span> Note that the LHS of <a href="#eq:c-leq-fract_j1"
data-reference-type="eqref"
data-reference="eq:c-leq-fract_j1">\((1.7)\)</a> is obviously
bounded by <span class="math inline">\(1\)</span>, so this condition
forces all of the <span class="math inline">\(t_j\)</span> to be of
roughly the same size. For instance, a result of Jutila–Motohashi <a href="#ref-MR2233686"
class="citation" data-cites="MR2233686">(Jutila and Motohashi
2005)</a> may be formulated as follows: for each <span
class="math inline">\(\delta &lt; 1/3\)</span>, there exists <span
class="math inline">\(C_0 \geqslant 0\)</span> so that for each <span
class="math inline">\(\pi \in \mathcal{A}(2)\)</span> of “full level”
(i.e., <span class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}}) =
1\)</span>), we have <span class="math display">\[|L(\pi,\tfrac{1}{2})|
\leqslant C_0 (1 + \max \{|t_1|, |t_2|\})^{(1 - \delta)/2},\]</span>
where <span class="math inline">\(\{t_1, t_2\}\)</span> denote the
archimedean <span class="math inline">\(L\)</span>-function parameters
of <span class="math inline">\(\pi\)</span>. This result implies that a
family <span class="math inline">\(\mathcal{F} \subseteq
\mathcal{A}(2)\)</span> with uniform parameter growth and full level
satisfies a spectral aspect subconvex bound (with polynomial dependence
upon the level, tautologically). However, specialized to the “conductor
dropping” case in which one of the two parameters <span
class="math inline">\(t_1\)</span> or <span
class="math inline">\(t_2\)</span> is much smaller than the other (e.g.,
<span class="math inline">\(t_2 = \operatorname{O}(1)\)</span> while
<span class="math inline">\(t_1 \rightarrow \infty\)</span>), this
estimate does not improve upon the convexity bound. That case was not
addressed until the work of Michel–Venkatesh noted above, following an
important breakthrough of Duke–Friedlander–Iwaniec <a href="#ref-MR1923476"
class="citation" data-cites="MR1923476">(Duke, Friedlander, and Iwaniec
2002)</a> (see also <a href="#ref-MR2382859 Mi04 MR3912807" class="citation"
data-cites="MR2382859 Mi04 MR3912807">(Blomer, Harcos, and Michel 2007;
P. Michel 2004; Blomer and Khan 2019)</a>).</p>
<p>For <span class="math inline">\(n \geqslant 3\)</span>, the first
general examples of families <span class="math inline">\(\mathcal{F}
\subseteq \mathcal{A}(n)\)</span> proven to satisfy subconvex bounds,
beyond the “<span class="math inline">\(t\)</span>-aspect” setting
discussed in §<a href="#sec:subc-probl-t" data-reference-type="ref"
data-reference="sec:subc-probl-t">1.1</a> or special families arising
from functorial lifts, were given by Blomer–Buttcane <a href="#ref-MR4203038 MR4039487"
class="citation" data-cites="MR4203038 MR4039487">(Blomer and Buttcane
2020a, 2020b)</a>. To describe their result, let us say that <span
class="math inline">\(\mathcal{F} \subseteq \mathcal{A}(n)\)</span>
<em>avoids the walls</em> if there exists <span class="math inline">\(c
&gt; 0\)</span> so that for each <span class="math inline">\(\pi \in
\mathcal{F}\)</span>, <span class="math display">\[\frac{  \max_{j \neq
k}|t_j - t_k|}{1 + \max \{|t_1|,\dotsc,|t_n|\}} \geqslant c.\]</span>
Blomer–Buttcane’s results may be formulated as follows: if <span
class="math inline">\(\mathcal{F} \subseteq \mathcal{A}(3)\)</span> has
uniform parameter growth, avoids the walls, and each <span
class="math inline">\(\pi \in \mathcal{F}\)</span> has trivial central
character, then <span class="math inline">\(\mathcal{F}\)</span>
satisfies a spectral aspect subconvex bound, with polynomial dependence
upon the level. A preprint of Kumar–Mallesham–Singh <a href="#ref-2020arXiv200607819K"
class="citation" data-cites="2020arXiv200607819K">(Kumar, Mallesham, and
Singh 2020)</a> establishes a similar conclusion, but with a modified
form of the wall-avoidance condition.</p>
<p>We will show the following:</p>
<div id="itm:standard:main-b" class="theorem">
<p><strong>Theorem 2</strong>. <em><span id="thm:main-result"
label="thm:main-result"></span> Let <span
class="math inline">\(n\)</span> be a natural number.</em></p>
<ol type="a">
<li><p><em><span id="itm:standard:main-a"
label="itm:standard:main-a"></span> Every family <span
class="math inline">\(\mathcal{F} \subseteq \mathcal{A}(n)\)</span> with
uniform parameter growth satisfies a spectral aspect subconvex bound,
with polynomial dependence upon the level.</em></p></li>
<li><p><em>More quantitatively, suppose that <span
class="math inline">\(n \geqslant 2\)</span>. Let <span
class="math inline">\(\delta &lt; \delta_n ^\sharp\)</span>, with <span
class="math inline">\(\delta_n^\sharp\)</span> as in <a
href="#eq:delta_n-geq-frac1" data-reference-type="eqref"
data-reference="eq:delta_n-geq-frac1">\((1.2)\)</a>. Let
<span class="math inline">\(C_0 &gt; c_0 &gt; 0\)</span>. There exists
<span class="math inline">\(C_1 \geqslant 0\)</span> with the following
property. Let <span class="math inline">\(T \geqslant 1\)</span>. Let
<span class="math inline">\(\pi\)</span> be a unitary cuspidal
automorphic representation of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span> whose archimedean <span
class="math inline">\(L\)</span>-function parameters <span
class="math inline">\(t_1,\dotsc,t_n \in \mathbb{C}\)</span> satisfy
<span id="eq:c_1-t-leq" class="math display">\[\label{eq:c_1-t-leq}\tag{1.8}
    c_0 T \leqslant|t_j| \leqslant C_0 T \quad \text{ for each }  j \in
\{1,\dotsc,n\}.\]</span> Then <span id="eq:lpi-tfrac12-leq" class="math display">\[\label{eq:lpi-tfrac12-leq}\tag{1.9}
    |L(\pi, \tfrac{1}{2})| \leqslant C_1
C(\pi_{\mathop{\mathrm{fin}}})^{1/2}
T^{(1-\delta)n/4}.\]</span></em></p></li>
</ol>
</div>
<p>For the sake of illustration, we record the straightforward deduction
from the latter result to the former:</p>
<div class="proof">
<p><em>Proof of Theorem <a href="#thm:main-result"
data-reference-type="ref"
data-reference="thm:main-result">1.2</a>, part <a
href="#itm:standard:main-a" data-reference-type="eqref"
data-reference="itm:standard:main-a">\((a)\)</a>, assuming
Theorem <a href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a>, part <a
href="#itm:standard:main-b" data-reference-type="eqref"
data-reference="itm:standard:main-b">\((b)\)</a>.</em> By
the classical results mentioned above, we may assume that <span
class="math inline">\(n \geqslant 2\)</span>. Let <span
class="math inline">\(\mathcal{F} \subseteq \mathcal{A}(n)\)</span> be a
family with uniform parameter growth. We may then find <span
class="math inline">\(C_0 &gt; c_0 &gt; 0\)</span> so that for each
<span class="math inline">\(\pi \in \mathcal{F}\)</span>, there exists
<span class="math inline">\(T \geqslant 1\)</span> (e.g., <span
class="math inline">\(T = 1 + \max \{|t_1|, \dotsc, |t_n|\}\)</span>) so
that the parameters <span
class="math inline">\(\{t_1,\dotsc,t_n\}\)</span> of <span
class="math inline">\(\pi\)</span> satisfy <a href="#eq:c_1-t-leq"
data-reference-type="eqref"
data-reference="eq:c_1-t-leq">\((1.8)\)</a>. The ratio <span
class="math inline">\(C(\pi_\infty) / T^n\)</span> is then bounded, from
above and below, by positive quantities depending only upon <span
class="math inline">\(\mathcal{F}\)</span>, so the conclusion of part <a
href="#itm:standard:main-b" data-reference-type="eqref"
data-reference="itm:standard:main-b">\((b)\)</a> implies
that for each <span class="math inline">\(\delta &lt;  \delta_n
^\sharp\)</span>, there exists <span class="math inline">\(C_1 \geqslant
0\)</span> so that for all <span class="math inline">\(\pi \in
\mathcal{F}\)</span>, the bound <a href="#eq:lpi-tfrac12-leq-1"
data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-leq-1">\((1.6)\)</a> holds
with the given value of <span class="math inline">\(\delta\)</span> and
with <span class="math inline">\(A := 1/2\)</span>. ◻</p>
</div>
<p>It is similarly straightforward to see that Theorem <a
href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> generalizes
Theorem <a href="#thm:t-aspect" data-reference-type="ref"
data-reference="thm:t-aspect">1</a>:</p>
<div class="proof">
<p><em>Proof of Theorem <a href="#thm:t-aspect"
data-reference-type="ref" data-reference="thm:t-aspect">1</a>, assuming
Theorem <a href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a>.</em> Let <span
class="math inline">\(\pi \in \mathcal{A}(n)\)</span>. Let <span
class="math inline">\(t_1, \dotsc, t_n \in \mathbb{C}\)</span> denote
its parameters. We may find <span class="math inline">\(T_0 \geqslant
1\)</span> so that whenever <span class="math inline">\(|T| &gt;
T_0\)</span>, we have <span class="math display">\[\tfrac{1}{2} T
\leqslant|t_j + T | \leqslant 2 T,\]</span> say. Then the unitary twist
<span class="math inline">\(\pi \otimes |\det|^{i T}\)</span> satisfies
the hypotheses of Theorem <a href="#thm:main-result"
data-reference-type="ref"
data-reference="thm:main-result">1.2</a> with <span
class="math inline">\(c_0 = \tfrac{1}{2}\)</span> and <span
class="math inline">\(C_0 = 2\)</span>. Since <span
class="math inline">\(L(\pi \otimes |\det|^{iT}, \tfrac{1}{2}) = L(\pi,
\tfrac{1}{2} + i T)\)</span>, the conclusion of Theorem <a
href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> implies that we
may find <span class="math inline">\(C_1 \geqslant 0\)</span> so that
whenever <span class="math inline">\(|T| &gt; T_0\)</span>, we have
<span class="math display">\[|L(\pi, \tfrac{1}{2} + i T)| \leqslant C_1
( 1 + |T|)^{(1 - \delta) n/4}.\]</span> The bound <a
href="#eq:lpi-tfrac12-+" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-+">\((1.1)\)</a> then holds with
the leading scalar <span class="math display">\[C_2 := \max
\left(\{C_1\} \cup \left\{ \frac{|L(\pi,\tfrac{1}{2} + i T)|}{(1 +
|t|)^{(1 - \delta) n/4}} : |T| \leqslant T_0
\right\}\right).\]</span> ◻</p>
</div>
<div class="remark">
<p><strong>Remark 3</strong>. While the primary novelty of these last
results is in addressing the case <span class="math inline">\(n
\geqslant 4\)</span>, the conclusion appears to be new even when <span
class="math inline">\(n=3\)</span>. For instance, the spectral aspect
subconvexity problem for <span
class="math inline">\({\mathop{\mathrm{GL}}}_3\)</span> in the degenerate
case where <span class="math inline">\((t_1,t_2,t_3) = (T, T, - 2
T)\)</span> is addressed by Theorem <a href="#thm:main-result"
data-reference-type="ref"
data-reference="thm:main-result">1.2</a>, but not by the
earlier works <a href="#ref-MR4203038 MR4039487 2020arXiv200607819K" class="citation"
data-cites="MR4203038 MR4039487 2020arXiv200607819K">(Blomer and
Buttcane 2020a, 2020b; Kumar, Mallesham, and Singh 2020)</a>. We note
also that the proof of Theorem <a href="#thm:main-result"
data-reference-type="ref"
data-reference="thm:main-result">1.2</a> treats the
“spectral aspect” and “<span class="math inline">\(t\)</span>-aspect”
uniformly, whereas earlier papers covering those cases <a href="#ref-MR3369905 MR4270876 MR4203038 MR4039487 2020arXiv200607819K"
class="citation"
data-cites="MR3369905 MR4270876 MR4203038 MR4039487 2020arXiv200607819K">(Munshi
2015; Aggarwal 2021; Blomer and Buttcane 2020a, 2020b; Kumar, Mallesham,
and Singh 2020)</a> employ fundamentally different methodology.</p>
</div>
<div class="remark">
<p><strong>Remark 4</strong>. Since our focus in this paper is on the
spectral aspect, we have made no effort to optimize the exponent of
<span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}})^{1/2}\)</span>.
Indeed, we would have been satisfied with any estimate involving <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}})^A\)</span> for some
explicit <span class="math inline">\(A \geqslant 0\)</span>. The
exponent <span class="math inline">\(A = 1/2\)</span> turns out to be
achievable with essentially no effort beyond what would be required in a
treatment of the full level case, where <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}}) = 1\)</span>. It
would be interesting and natural to strengthen this exponent to
arbitrary <span class="math inline">\(A &gt; 1/4\)</span>, as in the
convexity bound.</p>
</div>
<div class="remark">
<p><strong>Remark 5</strong>. We suspect that the proof of Theorem <a
href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> can be made
polynomially effective with respect to the parameter <span
class="math inline">\(c_0\)</span>. That is to say, we expect that one
could provably take <span class="math inline">\(C_1 = C_2
(1/c_0)^{C_3}\)</span>, where <span class="math inline">\(C_2,
C_3\)</span> depend upon <span class="math inline">\(C_0\)</span> but
not upon <span class="math inline">\(c_0\)</span>. To achieve this, it
should suffice to give a strengthening of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Theorem
15.2)</a> that “depends polynomially” upon the quantity “<span
class="math inline">\(\mathfrak{S}\)</span>” in its statement. We expect
that an ineffective strengthening of the required form follows formally
from the Nullstellensatz, an effective strengthening by quantifying each
step of the proof. Since the estimate <a href="#eq:lpi-tfrac12-leq"
data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-leq">\((1.9)\)</a> is weaker
than the convexity bound unless <span class="math inline">\(c_0\)</span>
can be taken quite close to <span class="math inline">\(1\)</span>, we
expect that such a strengthening would yield the following slightly more
natural statement, which would in turn represent the limit of the
technique developed in this paper (as far as the spectral aspect is
concerned, and ignoring the problem of optimizing <span
class="math inline">\(\delta\)</span>):</p>
<p><em>For each natural number <span class="math inline">\(n\)</span>,
there exists <span class="math inline">\(C_0 &gt; 0\)</span> and <span
class="math inline">\(\delta &gt; 0\)</span> such that for each unitary
cuspidal automorphic representation <span
class="math inline">\(\pi\)</span> of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span> whose archimedean <span
class="math inline">\(L\)</span>-function parameters <span
class="math inline">\(t_1,\dotsc,t_n \in \mathbb{C}\)</span> satisfy
<span class="math inline">\(|t_j| \leqslant T\)</span> for all <span
class="math inline">\(j\)</span>, we have</em> <span
class="math display">\[|L(\pi, \tfrac{1}{2})| \leqslant C_0
C(\pi_{\mathop{\mathrm{fin}}})^{1/2} T^{(1-\delta)n/4}.\]</span></p>
</div>
<h4 id="sec:high-level-overview">§1.3. Discussion of the proof</h4>
<h5 id="overview">Overview</h5>
<p>The closest result in the literature to Theorem <a
href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> is the main
result of <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D.
Nelson 2023)</a>. We summarize that result informally:</p>
<div id="thm:unitary-review" class="theorem">
<p><strong>Theorem 6</strong>. <em>Let <span class="math inline">\(G =
{\mathop{\mathrm{U}}}_{n+1} \geqslant H = {\mathop{\mathrm{U}}}_n\)</span>
be unitary groups over a number field <span
class="math inline">\(F\)</span>, with <span
class="math inline">\(H\)</span> anisotropic. Let <span
class="math inline">\(S\)</span> be a large enough finite set of places.
Let <span class="math inline">\(\mathfrak{q} \in S\)</span> be an
archimedean place. Let <span class="math inline">\(\mathcal{F}\)</span>
be a family of pairs <span class="math inline">\((\pi,\sigma)\)</span>
of cuspidal automorphic representations of <span
class="math inline">\(G\)</span> and <span
class="math inline">\(H\)</span>, respectively, with the following
properties.</em></p>
<ul>
<li><p><em>The local components of <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> are tempered at all places inside
<span class="math inline">\(S\)</span>, unramified outside <span
class="math inline">\(S\)</span>, and have bounded ramification at all
places other than <span
class="math inline">\(\mathfrak{q}\)</span>.</em></p></li>
<li><p><em>The archimedean parameters at <span
class="math inline">\(\mathfrak{q}\)</span> of the base change
Rankin–Selberg <span class="math inline">\(L\)</span>-function <span
class="math inline">\(L(\pi \times \sigma, \tfrac{1}{2})\)</span>
satisfy the analogue of the “uniform parameter growth” condition <a
href="#eq:c-leq-fract_j1" data-reference-type="eqref"
data-reference="eq:c-leq-fract_j1">\((1.7)\)</a>.</em></p></li>
</ul>
<p><em>Then there is an explicit <span class="math inline">\(\delta &gt;
0\)</span> so that, for some <span class="math inline">\(C_0 \geqslant
0\)</span>, we have <span class="math display">\[|L(\pi \times \sigma,
\tfrac{1}{2})| \leqslant C_0 C(\pi \times \sigma)^{1/4-\delta}\]</span>
for all <span class="math inline">\((\pi,\sigma) \in
\mathcal{F}\)</span>.</em></p>
</div>
<p>Theorem <a href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> may be understood
as a specialization of a hypothetical generalization of Theorem <a
href="#thm:unitary-review" data-reference-type="ref"
data-reference="thm:unitary-review">6</a>: if we</p>
<ul>
<li><p>generalize Theorem <a href="#thm:unitary-review"
data-reference-type="ref" data-reference="thm:unitary-review">6</a> by
dropping</p>
<ul>
<li><p>the anisotropy condition on <span
class="math inline">\(H\)</span>,</p></li>
<li><p>the cuspidality condition on the automorphic representations,
and</p></li>
<li><p>the temperedness condition on their local components,</p></li>
</ul></li>
<li><p>specialize that generalization to the “least anisotropic” example
<span class="math inline">\((G,H) = ({\mathop{\mathrm{GL}}}_{n+1},
{\mathop{\mathrm{GL}}}_n)\)</span> and <span class="math inline">\(F =
\mathbb{Q}\)</span>, and then</p></li>
<li><p>specialize further by taking for <span
class="math inline">\(\sigma\)</span> the “least cuspidal” automorphic
representation, consisting of Eisenstein series with trivial parameters,
so that the Rankin–Selberg convolution is given by <span
class="math display">\[L(\pi \times \sigma, \tfrac{1}{2}) = L(\pi,
\tfrac{1}{2})^n,\]</span></p></li>
</ul>
<p>then we arrive at something like Theorem <a href="#thm:main-result"
data-reference-type="ref"
data-reference="thm:main-result">1.2</a>. In this paper,
we address that specialization by combining the strategy and results of
<a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson
2023)</a> with some new ideas that overcome the failure of
temperedness, cuspidality and (most seriously) anisotropy.</p>
<p>We recall that the anisotropy of <span
class="math inline">\(H\)</span> corresponds to the compactness of the
quotients <span class="math inline">\(H(\mathbb{Q}) \backslash
H(\mathbb{A})\)</span>, <span class="math inline">\(H(\mathbb{Z})
\backslash H(\mathbb{R})\)</span>. There has been little work concerning
the problem of bounding automorphic forms on higher-rank non-compact
quotients, uniformly with respect to both</p>
<ul>
<li><p>the argument of the automorphic form as it tends into the cusp,
and</p></li>
<li><p>the underlying parameters of the automorphic form.</p></li>
</ul>
<p>Some exceptions include the recent work of Brumley–Templier <a href="#ref-MR4150475"
class="citation" data-cites="MR4150475">(Brumley and Templier
2020)</a> and Blomer–Harcos–Maga <a href="#ref-MR3905609 MR4093914" class="citation"
data-cites="MR3905609 MR4093914">(Blomer, Harcos, and Maga 2019,
2020)</a>.</p>
<p>We note that the present paper does not “replace” the work <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson
2023)</a> treating the compact case. Indeed, the main technical
results of that work (concerning the volume estimates and refined
microlocal calculus) are applied here as a “black box” and combined with
some new ingredients. On the other hand, the relative character
asymptotics of <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
19)</a>, which served as a crucial input to <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023)</a>, do not
enter here; the analogous role in the present treatment is played by
direct analysis of local zeta integrals.</p>
<p>We survey the local issues addressed by this paper in §<a
href="#sec:intertw-oper-distr" data-reference-type="ref"
data-reference="sec:intertw-oper-distr">1.3.9</a>, §<a
href="#sec:asympt-local-zeta" data-reference-type="ref"
data-reference="sec:asympt-local-zeta">1.3.10</a> and §<a
href="#sec:asympt-kirill-model" data-reference-type="ref"
data-reference="sec:asympt-kirill-model">1.3.11</a>. The main global
problem that we face and overcome is to give nontrivial bounds for the
“local <span class="math inline">\(L^2\)</span>-norms” of certain
Eisenstein series, uniformly as we move away from the bulk of the
fundamental domain. This is needed to compensate for the growth of the
geometric side of a pretrace formula for <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span>, coming from a
long sum over unipotent elements of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Z})\)</span>. It is
a familiar feature that trace-like formulas on non-compact quotients are
complicated by the contributions of unipotent elements. The
Arthur–Selberg trace formula gives a well-known example where the taming
of the unipotent contribution requires an inclusion-exclusion scheme
involving Eisenstein spectra coming from Levi subgroups. The present
situation more closely resembles the Jacquet–Rallis relative trace
formula for <span class="math inline">\((G, H \times H)\)</span> (see
<a href="#ref-MR2767518 MR4195660 MR3947975" class="citation" data-cites="MR2767518 MR4195660 MR3947975">(Hervé
Jacquet and Rallis 2011; Zydor 2020; Chaudouard 2019)</a>, <a href="#ref-2020arXiv200705601B"
class="citation" data-cites="2020arXiv200705601B">(Raphaël
Beuzart-Plessis, Chaudouard, and Zydor 2020, sec. 3)</a>), but
differs in that, by taking for <span class="math inline">\(\Psi\)</span>
a wave packet, our integrals converge absolutely. We are thus faced not
with the qualitative-analytic problem of making sense of divergent
integrals, but rather the quantitative-analytic problem of obtaining
satisfactory estimates for convergent ones. It was nevertheless unclear
to us whether an inclusion-exclusion scheme would be necessary, or
whether direct estimation would be possible. We eventually succeeded via
the latter route, in the manner indicated below in §<a
href="#sec:theta-funct-posit" data-reference-type="ref"
data-reference="sec:theta-funct-posit">1.3.7</a>–§<a
href="#sec:duality-1" data-reference-type="ref"
data-reference="sec:duality-1">1.3.8</a>.</p>
<p>In the remainder of this introductory section, we give a high-level
overview, intended for experts, of the new features of this paper
relative to the compact quotient case treated in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023)</a>. In
particular, we assume some familiarity with the notion of “coadjoint
microlocalization” described in <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
1)</a> and applied in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023)</a>. Some
readers may wish to first study <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 2)</a> for
an informal overview of the compact case, and <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
1)</a> for an overview of how microlocal analysis and the orbit
method may be applied to the analysis of automorphic forms. On the other
hand, we have attempted to keep the body of this paper self-contained
and to give complete details. We emphasize that the following discussion
is informal. In particular, notation such as <span
class="math inline">\(\approx\)</span> or <span
class="math inline">\(\lessapprox\)</span> is not defined precisely.</p>
<h5 id="setup">Setup</h5>
<p>The main ideas may be explained in the full level case (i.e., <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}}) = 1\)</span>),
where all the action takes place on the quotients <span
class="math display">\[:= \Gamma \backslash G :=
{\mathop{\mathrm{GL}}}_{n+1}(\mathbb{Z}) \backslash
{\mathop{\mathrm{GL}}}_{n+1}(\mathbb{R}),
  \quad
  [H] := \Gamma_H \backslash H := {\mathop{\mathrm{GL}}}_{n}(\mathbb{Z})
\backslash {\mathop{\mathrm{GL}}}_{n}(\mathbb{R}).\]</span> We denote by
<span class="math inline">\(\mathfrak{g}, \mathfrak{h}\)</span> the Lie
algebras and <span class="math inline">\(\mathfrak{g}^\wedge,
\mathfrak{h}^\wedge\)</span> their imaginary duals. We write <span
class="math inline">\(Z \leqslant G\)</span> and <span
class="math inline">\(Z_H \leqslant H\)</span> for the centers.</p>
<p>We regard <span class="math inline">\(\pi\)</span> as a space of cusp
forms on <span class="math inline">\([G]\)</span>, transforming under
<span class="math inline">\(Z\)</span> via some unitary character.
Similarly, <span class="math inline">\(\sigma\)</span> is a space of
Eisenstein series on <span class="math inline">\([H]\)</span>. The
method of Jacquet–Piatetski-Shapiro–Shalika leads to an integral
representation <span id="eq:int-_h-varphi" class="math display">\[\label{eq:int-_h-varphi}\tag{1.10}
  \int _{[H]} \varphi \Psi \approx L(\pi,\tfrac{1}{2})^{n}
Z(\varphi,\Psi),\]</span> where <span
class="math inline">\(Z(\varphi,\Psi)\)</span> denotes the local
integral obtained by integrating the archimedean Whittaker functions of
<span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\Psi\)</span>. To bound <span
class="math inline">\(L(\pi,\tfrac{1}{2})\)</span> using <a
href="#eq:int-_h-varphi" data-reference-type="eqref"
data-reference="eq:int-_h-varphi">\((1.10)\)</a> (following
<a href="#ref-MR2726097 venkatesh-2005 michel-2009" class="citation"
data-cites="MR2726097 venkatesh-2005 michel-2009">(J. Bernstein and
Reznikov 2010; Venkatesh 2010; Philippe Michel and Venkatesh
2010)</a>), we must choose vectors <span
class="math inline">\(\varphi\)</span> and <span
class="math inline">\(\Psi\)</span> for which we may prove that the
local integral <span class="math inline">\(Z(\varphi, \Psi)\)</span> is
not too small, while the global integral <span
class="math inline">\(\int_{[H]} \varphi \Psi\)</span> is not too large.
Strictly speaking, we replace <span class="math inline">\(\Psi\)</span>
with a “wave packet” or “pseudo Eisenstein series” that decays rapidly
on <span class="math inline">\([H]\)</span>, which has the effect of
replacing <span class="math inline">\(L(\pi,\tfrac{1}{2})^n\)</span> by
an average of <span class="math inline">\(\prod_{j=1}^n
L(\pi,\tfrac{1}{2} + s_j)\)</span> over small <span
class="math inline">\(s = (s_1,\dotsc,s_n) \in \mathbb{C}^n\)</span>,
but we will often ignore this point in this overview and write simply
<span class="math inline">\(L(\pi,\tfrac{1}{2})^n\)</span> in place of
the more complicated expression that actually arises.</p>
<p>We note the recent work of Tsuzuki <a href="#ref-2021arXiv210307835T" class="citation"
data-cites="2021arXiv210307835T">(Tsuzuki 2021)</a>, which applies an
integral representation similar to <a href="#eq:int-_h-varphi"
data-reference-type="eqref"
data-reference="eq:int-_h-varphi">\((1.10)\)</a> to the
nonvanishing problem.</p>
<h5 id="sec:analyt-test-vect">§1.3.3. Analytic test vectors</h5>
<p>We choose vectors following <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021)</a>
(although with completely different implementation details, for reasons
discussed below):</p>
<p>Let <span class="math inline">\(\mathcal{O}_\pi \subseteq
\mathfrak{g}^\wedge\)</span> and <span
class="math inline">\(\mathcal{O}_\sigma \subseteq
\mathfrak{h}^\wedge\)</span> denote the coadjoint orbits. (In the
absence of any temperedness assumption on <span
class="math inline">\(\pi\)</span>, take these to be the loci of the
infinitesimal characters – see §<a href="#sec:infin-char"
data-reference-type="ref" data-reference="sec:infin-char">2.1.4</a>.) We
may choose <span class="math inline">\(\tau \in
\mathfrak{g}^\wedge\)</span> and <span class="math inline">\(\theta \in
\mathfrak{h}^\wedge\)</span> so that <span class="math display">\[T \tau
\in \mathcal{O}_\pi, \quad
  T \theta \in \mathcal{O}_{\sigma},
  \quad
  \tau|_{\mathfrak{h}} = \theta.\]</span> Indeed, we may be quite
explicit: since <span class="math inline">\(\sigma\)</span> consists of
Eisenstein series with trivial parameters, <span
class="math inline">\(\mathcal{O}_\sigma\)</span> is the nilcone, so we
may take for <span class="math inline">\(\theta\)</span> any nilpotent
Jordan block. We then solve for <span
class="math inline">\(\tau\)</span> by an exercise in rational canonical
form (§<a href="#sec:parameter-tau" data-reference-type="ref"
data-reference="sec:parameter-tau">2.3.3</a>). For example, when <span
class="math inline">\(n = 3\)</span>, we might take <span
class="math display">\[\theta = \begin{pmatrix}
    0 &amp; 0 &amp; 0 \\
    1 &amp; 0 &amp; 0 \\
    0 &amp; 1 &amp; 0
  \end{pmatrix},
  \quad
  \tau = \begin{pmatrix}
    0 &amp; 0 &amp; 0 &amp; \ast \\
    1 &amp; 0 &amp; 0 &amp; \ast \\
    0 &amp; 1 &amp; 0 &amp; \ast \\
    0 &amp; 0 &amp; 1 &amp; \ast
  \end{pmatrix}.\]</span> The normalization is such that <span
class="math inline">\(\tau\)</span> remains bounded as <span
class="math inline">\(T \rightarrow \infty\)</span>.</p>
<p>We take for the cusp form <span
class="math inline">\(\varphi\)</span> a unit vector microlocalized at
<span class="math inline">\(T \tau\)</span>.</p>
<p>We take for the pseudo Eisenstein series <span
class="math inline">\(\Psi\)</span> a unit vector microlocalized at
<span class="math inline">\(T \theta\)</span>. More precisely, <span
class="math inline">\(\Psi\)</span> is described by a function <span
class="math display">\[f : U_H \backslash H \rightarrow
\mathbb{C},\]</span> where <span class="math inline">\(U_H\)</span>
denotes a maximal unipotent subgroup. For example, if we pretend that
<span class="math inline">\(\Gamma_H \backslash H =
{\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>, then we may identify <span
class="math inline">\(U_H \backslash H\)</span> with the punctured plane
<span class="math inline">\(\mathbb{R}^2 - \{0\}\)</span> and take <span
class="math inline">\(\Psi(g) = \sum _{v \in \mathbb{Z}^2 - \{0\}} f(v
g)\)</span>. The space <span class="math inline">\(U_H \backslash
H\)</span> admits a right action by <span
class="math inline">\(H\)</span> and a left action by the toral part
<span class="math inline">\(A_H\)</span> of the normalizer of <span
class="math inline">\(U_H\)</span>. In practice, we take <span
class="math inline">\(U_H\)</span> lower-triangular and identify <span
class="math inline">\(A_H\)</span> with the diagonal subgroup, thus,
e.g., for <span class="math inline">\(n=3\)</span>, <span
class="math display">\[U_H = \begin{pmatrix}
    1 &amp; 0 &amp; 0 \\
    \ast &amp; 1 &amp; 0 \\
    \ast &amp; \ast &amp; 1
  \end{pmatrix},
  \quad
  A_H = \begin{pmatrix}
    \ast&amp; 0 &amp; 0 \\
    0 &amp; \ast &amp; 0 \\
    0 &amp; 0 &amp; \ast
  \end{pmatrix}.\]</span> We take <span class="math inline">\(f\)</span>
to be:</p>
<ul>
<li><p><span class="math inline">\(L^2\)</span>-normalized,</p></li>
<li><p>microlocalized under <span class="math inline">\(H\)</span> at
<span class="math inline">\(T \theta\)</span>,</p></li>
<li><p>uniformly smooth under <span class="math inline">\(A_H\)</span>,
and</p></li>
<li><p>concentrated near <span
class="math inline">\(T^{-\rho^\vee}\)</span>, where <span
class="math inline">\(\rho^\vee\)</span> denotes the half-sum of
positive coroots for <span class="math inline">\(U_H\)</span>.</p></li>
</ul>
<p>In the <span class="math inline">\({\mathop{\mathrm{SL}}}_2\)</span>
example, the resulting function on <span
class="math inline">\(\mathbb{R}^2 - \{0\}\)</span> has the rough shape
<span class="math display">\[f(x,y) \approx
  \begin{cases}
    T^{-1/2}
      e^{i T y/x}
      &amp; \text{ if }
      x \asymp T^{1/2}, \, y \ll 1, \\
      0 &amp; \text{ otherwise,}
  \end{cases}\]</span> or equivalently, <span class="math display">\[f(r
\cos \alpha, r \sin \alpha) \approx
  \begin{cases}
  T^{-1/2}  e^{i T \alpha}
     &amp; \text{ if } r \asymp T^{1/2}, \,  \alpha \ll T^{-1/2}, \\
     0 &amp; \text{ otherwise.}
  \end{cases}\]</span> We assume moreover that <span
class="math inline">\(f\)</span> is chosen so that <span
class="math inline">\(\Psi\)</span> is “nondegenerate” in certain senses
(e.g., orthogonal to the residual spectrum); in the <span
class="math inline">\({\mathop{\mathrm{SL}}}_2\)</span> example, this
amounts to requiring that the radial Mellin transform of <span
class="math inline">\(f\)</span> vanish at certain arguments.</p>
<p>Ignoring wave packet issues, we obtain with this choice <span id="eq:zvarphi-psi-approx" class="math display">\[\label{eq:zvarphi-psi-approx}\tag{1.11}
Z(\varphi, \Psi) \approx T^{-n^2/4},\]</span> leading to an integral
representation roughly of the shape <span
class="math display">\[L(\pi,\tfrac{1}{2})^{n}  \approx T^{n^2/4} \int
_{[H]} \varphi \cdot \Psi.\]</span></p>
<div class="remark">
<p><strong>Remark 7</strong>. Strictly speaking, since we are working
with a wave packet, what we really consider is a family of zeta
integrals <span class="math inline">\(Z(\varphi, \Psi, s)\)</span>
indexed by small elements <span class="math inline">\(s \in
\mathbb{C}^n\)</span>. The concentration condition for <span
class="math inline">\(f\)</span> may be understood as ensuring that the
variation of this family with respect to the real part of <span
class="math inline">\(s\)</span> matches up with the convexity bound for
the <span class="math inline">\(L\)</span>-functions (see §<a
href="#sec:reduct-peri-bounds" data-reference-type="ref"
data-reference="sec:reduct-peri-bounds">3.3</a> for details). This
matching may be understood as the analogue in our setup of working with
a “balanced” approximate functional equation.</p>
</div>
<h5 id="sec:relat-trace-form">§1.3.4. Relative trace formula</h5>
<p>We construct, as in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 1.5.2)</a>,
a “convolution kernel” <span class="math inline">\(\omega \in
C_c^\infty(G)\)</span> with the following properties.</p>
<ol type="i">
<li><p>The associated integral operator <span
class="math inline">\(\pi(\omega)\)</span> satisfies <span id="eq:piom-varphi-appr" class="math display">\[\label{eq:piom-varphi-appr}\tag{1.12}
    \pi(\omega) \varphi \approx \varphi.\]</span></p></li>
<li><p><span class="math inline">\(\omega\)</span> concentrates on <span
class="math display">\[\left\{ g \in G : g = 1 + O(T^{-\varepsilon}),
\quad {\mathop{\mathrm{Ad}}}^*(g) \tau = \tau + O(T^{-1/2-\varepsilon})
\right\}.\]</span></p></li>
<li><p><span class="math inline">\(\omega\)</span> has <span
class="math inline">\(L^\infty\)</span>-norm <span
class="math inline">\(\lessapprox T^{n(n+1)/2}\)</span>.</p></li>
</ol>
<p>Informally, the spectral support of <span
class="math inline">\(\omega\)</span> is “<span
class="math inline">\(\pi + \operatorname{O}(1)\)</span>,” and <span
class="math inline">\(\pi(\omega)\)</span> is essentially the orthogonal
projection onto <span class="math inline">\(\varphi\)</span>. The
function <span class="math inline">\(\omega\)</span> has the same shape
as its adjoint <span class="math inline">\(\omega^*\)</span> and
self-convolution <span class="math inline">\(\omega \ast
\omega^{\ast}\)</span>, so we denote these simply by <span
class="math inline">\(\omega\)</span> in this informal overview.</p>
<p>As in <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D.
Nelson 2023, sec. 1.5.3)</a>, the main point is to show that <span id="eq:t-n2-int" class="math display">\[\label{eq:t-n2-int}\tag{1.13}
  T^{-n/2} \int _{h_1, h_2 \in [H]} \sum _{\gamma \in \Gamma }
\bar{\Psi}(h_1) \Psi(h_2) \omega(h_1^{-1} \gamma h_2) \, d h_1 \, d h_2
  = (\text{main term}) + \operatorname{O}(T^{-\delta}).\]</span> Indeed,
the pretrace formula for <span class="math inline">\([G]\)</span> (or
Cauchy–Schwarz) applied to <span class="math inline">\(\omega\)</span>
shows that the LHS of <a href="#eq:t-n2-int" data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a> majorizes an average of
<span class="math inline">\(|L(\pi,\tfrac{1}{2})|^{2 n}\)</span> over a
family of size <span class="math inline">\(T^{n(n+1)/2}\)</span>. In
view of our uniform parameter growth assumption, the family size is
roughly the fourth root of the conductor, so the amplification method
will deliver a subconvex bound if we can give a sufficiently robust
proof of <a href="#eq:t-n2-int" data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a>. The sum over <span
class="math inline">\(\gamma \in H Z\)</span> contributes an apparent
main term, so we reduce to showing that the <span
class="math inline">\(\gamma \notin H Z\)</span> contribute <span
class="math inline">\(\operatorname{O}(T^{-\delta})\)</span>. (There
would be additional contributions to the main term had we not passed to
wave packets, cf. <a href="#ref-MR2200997" class="citation"
data-cites="MR2200997">(Ramakrishnan and Rogawski 2005)</a>.)</p>
<h5 id="bilinear-forms-estimates">Bilinear forms estimates</h5>
<p>We record an informal statement of the “bilinear forms” estimate
given by <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D.
Nelson 2023, Thm 15.1)</a>, the proof of which relies ultimately upon
the volume estimates <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, secs. 16–17)</a>
whose relevance was first observed by S. Marshall. Fix a compact
neighborhood <span class="math inline">\(\mathcal{H}\)</span> of the
identity element in <span class="math inline">\(H\)</span>. Let <span
class="math inline">\(\Psi_1\)</span> and <span
class="math inline">\(\Psi_2\)</span> be measurable functions, supported
on <span class="math inline">\(\mathcal{H}\)</span>, with <span
class="math inline">\(\Psi_2\)</span> satisfying the approximate
equivariance condition <span class="math display">\[|\Psi_2(h z)|
\approx |\Psi_2(h)| \text{ for } (h,z) \in \mathcal{H} \times
Z_H  \text{ with } z = \operatorname{O}(1).\]</span> Let <span
class="math inline">\(g \in G\)</span> be “not too close to <span
class="math inline">\(H Z\)</span>.” Then <span id="eq:t-n2-int-1" class="math display">\[\label{eq:t-n2-int-1}\tag{1.14}
  T^{-n/2} \int _{h_1, h_2 \in \mathcal{H} }
  \left\lvert
    \Psi_1(h_1) \Psi_2(h_2)
    \omega(h_1^{-1} g h_2) \right\rvert \, d h_1 \, d h_2
  \lessapprox
  T^{-1/2 + \varepsilon}
  \|\Psi_1\|_{L^2(\mathcal{H})}
  \|\Psi_2\|_{L^2(\mathcal{H})}.\]</span> The factor <span
class="math inline">\(T^{-1/2}\)</span> improves upon what one might
regard as the “trivial estimate” obtained by omitting that factor. We
refer to <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D.
Nelson 2023, secs. 1.5.3–1.5.7, §2.9–2.11)</a> for an extended
discussion of such estimates.</p>
<p>In the compact quotient case, the estimate <a href="#eq:t-n2-int-1"
data-reference-type="eqref"
data-reference="eq:t-n2-int-1">\((1.14)\)</a> readily yields <a
href="#eq:t-n2-int" data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a>: take <span
class="math inline">\(\mathcal{H}\)</span> large enough to contain a
fundamental domain for <span class="math inline">\([H]\)</span> and
observe that</p>
<ul>
<li><p>the number of <span class="math inline">\(\gamma\)</span>
contributing to <a href="#eq:t-n2-int" data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a> is essentially <span
class="math inline">\(\operatorname{O}(1)\)</span>, and</p></li>
<li><p>by the discreteness of <span
class="math inline">\(\Gamma\)</span>, any element of <span
class="math inline">\(\Gamma - H Z\)</span> is “not too close to <span
class="math inline">\(H Z\)</span>” in the required sense.</p></li>
</ul>
<p>In the non-compact case, the same argument gives an adequate estimate
for the contribution from <span class="math inline">\(x, y\)</span>
lying in any fixed compact subset of <span
class="math inline">\([H]\)</span>. (Recall that <span
class="math inline">\(\Psi\)</span> is a wave packet, so we have good
control over its <span class="math inline">\(L^2\)</span>-norm.)
Unfortunately, as <span class="math inline">\(x\)</span> and/or <span
class="math inline">\(y\)</span> “escape to <span
class="math inline">\(\infty\)</span>,” the sum over <span
class="math inline">\(\gamma\)</span> in <a href="#eq:t-n2-int"
data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a> features a large number
of unipotent elements, so unlike in the compact case, we cannot conclude
immediately.</p>
<h5 id="siegel-domains">Siegel domains</h5>
<p>Every element of <span class="math inline">\([H]\)</span> may be
represented in the form <span class="math inline">\(h = t x\)</span>
with <span class="math inline">\((t,x) \in \mathcal{T} \times
\mathcal{H}\)</span>, where <span
class="math inline">\(\mathcal{T}\)</span> denotes the set of diagonal
matrices <span class="math inline">\(t\)</span> with entries <span
class="math inline">\(t_1 \geqslant\dotsb \geqslant t_n &gt; 0\)</span>
and, as above, <span class="math inline">\(\mathcal{H}\)</span> is a
large enough fixed compact set. The Haar measure <span
class="math inline">\(d h\)</span> on <span
class="math inline">\([H]\)</span> is comparable to <span
class="math display">\[\frac{d t}{\delta_H(t)} \, d x,
  \quad \delta_H(t) = t_1^{n-1} t_2^{n-3} \dotsb t_n^{1-n},
  \quad
  d t = \frac{d t_1}{t_1} \dotsb \frac{d t_n}{t_n}.\]</span> We majorize
the sum over <span class="math inline">\(\gamma \notin H Z\)</span> in
<a href="#eq:t-n2-int" data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a> by <span
class="math display">\[T^{-n/2}   \int _{t, u \in \mathcal{T}  }
  \sum _{\gamma \in \Gamma  - H Z}
  \int _{x,y \in \mathcal{H} }
  \left\lvert
    \Psi(t x)
    \Psi(u y)
    \omega(x^{-1} t^{-1}  \gamma u y)
  \right\rvert
  \, d x \, d y \, \frac{d t \, d u}{\delta_H(t) \delta_H(u)}.\]</span>
We can apply the bilinear forms estimate <a href="#eq:t-n2-int-1"
data-reference-type="eqref"
data-reference="eq:t-n2-int-1">\((1.14)\)</a> with <span
class="math inline">\(g = t^{-1} \gamma u\)</span>. (Many of these
elements will be closer to <span class="math inline">\(H Z\)</span> than
in the compact case, where discreteness forces them all to be far away,
but the dominant contribution still comes from those that are not too
close.) Our task then reduces to showing that <span
class="math display">\[T^{-1/2}
  \int _{t, u \in \mathcal{T} }
  \nu(t,u)
  \|\Psi \|_{L^2(t \mathcal{H})}
  \|\Psi \|_{L^2(u \mathcal{H})}
  \frac{d t \, d u}{\delta_H(t) \delta_H(u)} \ll T^{-\delta},\]</span>
where <span class="math inline">\(\nu(t,u)\)</span> denotes the number
of <span class="math inline">\(\gamma \in \Gamma - H Z\)</span> for
which <span class="math inline">\(t^{-1} \gamma u =
\operatorname{O}(1)\)</span>. By elementary counting arguments, we see
that <span class="math inline">\(\nu(t,u)\)</span> vanishes unless <span
class="math inline">\(t \approx u\)</span>, in which case <span
class="math inline">\(\nu(t,u) \approx \delta_H(t) t ^\dagger\)</span>,
where <span id="eq:t-dagger-:=" class="math display">\[\label{eq:t-dagger-:=}\tag{1.15}
  t ^\dagger := \prod_{j=1}^n \max(t_j, t_j^{-1}).\]</span> After
Cauchy–Schwarz, the main problem is then to show that <span id="eq:t-14-int" class="math display">\[\label{eq:t-14-int}\tag{1.16}
  T^{-1/2}
  \int _{t  \in \mathcal{T} }
  \|\Psi \|_{L^2(t \mathcal{H})}^2
  t ^\dagger
  \frac{d t}{\delta_H(t)} \ll T^{-\delta}.\]</span> By comparison, the
<span class="math inline">\(L^2\)</span>-normalization of <span
class="math inline">\(\Psi\)</span> gives <span
class="math display">\[\int _{t  \in \mathcal{T} }
  \|\Psi \|_{L^2(t \mathcal{H})}^2
  \frac{d t}{\delta_H(t)} \ll 1,\]</span> so the “enemy” is the
additional factor <span class="math inline">\(t ^\dagger\)</span>.</p>
<p>The wave packet <span class="math inline">\(\Psi\)</span>
concentrates near <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> (since
<span class="math inline">\(\det(T^{-\rho^\vee}) = 1\)</span>), so one
can focus on the contribution to <a href="#eq:t-14-int"
data-reference-type="eqref"
data-reference="eq:t-14-int">\((1.16)\)</a> from when <span
class="math inline">\(\det(t) \approx 1\)</span>. Since <span
class="math inline">\(\Psi\)</span> is of rapid decay, the integrals <a
href="#eq:t-14-int" data-reference-type="eqref"
data-reference="eq:t-14-int">\((1.16)\)</a> decay rapidly in a
qualitative sense, so “very large” values of <span
class="math inline">\(t\)</span> are no problem; the “intermediate”
values of size larger than <span class="math inline">\(1\)</span> must
be addressed. We refer to <a href="#ref-MR4093914" class="citation"
data-cites="MR4093914">(Blomer, Harcos, and Maga 2020, sec. 1.2)</a>
for some hint as to the precise meaning of “intermediate.” In any event,
the total volume of the set of <span class="math inline">\(t\)</span>
that we must consider is logarithmic in <span
class="math inline">\(T\)</span>, so the basic problem is to show that
<span id="eq:t-in-mathcalt" class="math display">\[\label{eq:t-in-mathcalt}\tag{1.17}
  t \in \mathcal{T},
  \det(t) = 1
  \implies
  T^{-1/2}
  \|\Psi \|_{L^2(t \mathcal{H})}^2
  t ^\dagger  \ll
  \delta_H(t)
  T^{-\delta}.\]</span></p>
<div class="remark">
<p><strong>Remark 8</strong>. We caution that <span
class="math inline">\(\Psi\)</span> is not, e.g., bounded by <span
class="math inline">\(T^{o(1)}\)</span> – one can show that the
Whittaker function of <span class="math inline">\(\Psi\)</span> contains
large “spikes,” which, for the same reasons as in the work of
Brumley–Templier <a href="#ref-MR4150475" class="citation" data-cites="MR4150475">(Brumley
and Templier 2020)</a>, implies that it assumes large values near the
cusp. While this feature suggests that we should be careful, it does not
directly contradict the required estimates, which concern only the local
average behavior.</p>
</div>
<h5 id="sec:theta-funct-posit">§1.3.7. Theta functions and positivity</h5>
<p>The estimate <a href="#eq:t-in-mathcalt" data-reference-type="eqref"
data-reference="eq:t-in-mathcalt">\((1.17)\)</a> is
straightforward when <span class="math inline">\(H =
{\mathop{\mathrm{GL}}}_2(\mathbb{R})\)</span>, which is the case relevant
for the subconvexity problem on <span
class="math inline">\({\mathop{\mathrm{GL}}}_3\)</span>: every approach
that we have tried works without difficulty. Already when <span
class="math inline">\(H = {\mathop{\mathrm{GL}}}_3(\mathbb{R})\)</span>
(relevant for the subconvexity problem on <span
class="math inline">\({\mathop{\mathrm{GL}}}_4\)</span>, hitherto
unaddressed), an approach based on direct estimation of the Fourier
expansion (e.g., as in <a href="#ref-MR3905609" class="citation"
data-cites="MR3905609">(Blomer, Harcos, and Maga 2019)</a>) seems
hopeless: optimal bounds for all terms in that expansion add up to a
worse than required bound. Several other natural avenues of attack
(e.g., using the Rankin–Selberg integrals that represent <span
class="math inline">\(L(\sigma \times \tilde{\sigma}, 1+
\varepsilon)\)</span>) also seem inadequate. We will establish <a
href="#eq:t-in-mathcalt" data-reference-type="eqref"
data-reference="eq:t-in-mathcalt">\((1.17)\)</a> instead using
“pseudo mirabolic Eisenstein series” or “Siegel theta functions,” which
provide a more flexible source of nonnegative functions, taking large
values in the cusp, than do their “spectral” counterparts relevant for
the integral representation of <span class="math inline">\(L(\sigma
\times \tilde{\sigma}, 1 + \varepsilon)\)</span>.</p>
<p>Let <span class="math inline">\(\phi \in
C_c^\infty(\mathbb{R}^n)\)</span> be a nonnegative function supported on
a dyadic annulus of radii <span class="math inline">\(\approx
t_n\)</span>. Form the series <span class="math display">\[E(g) :=
\sideset{}{^*}\sum _{v \in \mathbb{Z}^n} \phi(v g),\]</span> where <span
class="math inline">\(\sum^*\)</span> denotes a sum over primitive
vectors. By considering the contribution to that series from the <span
class="math inline">\(n\)</span>th standard basis vector, we see that
<span class="math inline">\(E(g) \gg 1\)</span> for <span
class="math inline">\(g \in t \mathcal{H}\)</span>. It follows that
<span class="math display">\[\|\Psi \|^2_{L^2(t \mathcal{H})} \ll
\delta_H(t) \int _{[H]} |\Psi|^2 E\]</span> The integral <span
class="math inline">\(\int _{[H]} |\Psi|^2 E\)</span> is a “pseudo
Rankin–Selberg integral” (i.e., a spectral expansion of <span
class="math inline">\(\Psi\)</span> and <span
class="math inline">\(E\)</span> yields <span
class="math inline">\({\mathop{\mathrm{GL}}}_n \times
{\mathop{\mathrm{GL}}}_n\)</span> Rankin–Selberg integrals with Eisenstein
factors). It unfolds nicely enough. With some work, we can estimate the
associated “pseudo local Rankin–Selberg integrals.” We arrive in this
way at the estimate <span id="eq:psi-_l2t-mathcalh2" class="math display">\[\label{eq:psi-_l2t-mathcalh2}\tag{1.18}
\|\Psi \|_{L^2(t \mathcal{H})}^2 \ll \delta_H(t) t_n^n
T^{\varepsilon}.\]</span> We could have chosen <span
class="math inline">\(\phi\)</span> differently, i.e., concentrated on a
different dyadic annulus, but the estimate <a
href="#eq:psi-_l2t-mathcalh2" data-reference-type="eqref"
data-reference="eq:psi-_l2t-mathcalh2">\((1.18)\)</a> turns
out to be optimal among such choices.</p>
<p>The estimate <a href="#eq:psi-_l2t-mathcalh2"
data-reference-type="eqref"
data-reference="eq:psi-_l2t-mathcalh2">\((1.18)\)</a> does
not imply <a href="#eq:t-in-mathcalt" data-reference-type="eqref"
data-reference="eq:t-in-mathcalt">\((1.17)\)</a>. A typical
“problem case” is when <span id="eq:t-=-diagt_1" class="math display">\[\label{eq:t-=-diagt_1}\tag{1.19}
  t = \mathop{\mathrm{diag}}(t_1,\dotsc,t_n),
  \quad
  t_1 = r^{n-1}, \quad
  t_2 = \dotsb = t_n = r^{-1}\]</span> where <span
class="math inline">\(r\)</span> is a small positive power of <span
class="math inline">\(T\)</span>. In that case, <span
class="math inline">\(t_n^n = r^{-n}\)</span> and <span
class="math inline">\(t ^\dagger \approx r^{2 (n-1)}\)</span>, so to
achieve <a href="#eq:t-in-mathcalt" data-reference-type="eqref"
data-reference="eq:t-in-mathcalt">\((1.17)\)</a>, we would need
<span class="math inline">\(T^{-1/2} r^{-n + 2 (n - 1)} \ll
T^{-\delta}\)</span>, or equivalently, <span class="math inline">\(r^{n
- 2} \ll T^{1/2 - \delta}\)</span>. The proof of <a href="#ref-MR4093914" class="citation"
data-cites="MR4093914">(Blomer, Harcos, and Maga 2020, Thm 3)</a>
suggests that the rapid decay of <span
class="math inline">\(\Psi\)</span> kicks in only when <span
class="math inline">\(r\)</span> is a bit larger than <span
class="math inline">\(T^{1/n}\)</span>. Consider then, for instance, the
contribution from when <span class="math inline">\(r = T^{1/n}\)</span>.
The desired estimate is that <span class="math inline">\(T^{1 - 2/n} \ll
T^{1/2 - \delta}\)</span>, which holds only for <span
class="math inline">\(n \leqslant 3\)</span>.</p>
<h5 id="sec:duality-1">§1.3.8. Duality</h5>
<p>We can do better by exploiting an important symmetry of the problem,
coming from the outer automorphism of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> defined by the
inverse transpose map <span class="math inline">\(g \mapsto g^{-%
  {\mathpalette\@transpose{}}%
}\)</span>. (We came to appreciate the power of this symmetry while
perusing <a href="#ref-MR4093914" class="citation" data-cites="MR4093914">(Blomer, Harcos,
and Maga 2020, sec. 3.3)</a>.) We can argue either in terms of a dual
mirabolic Eisenstein series <span class="math display">\[\tilde{E}(g) =
\sideset{}{^*}\sum _{v \in \mathbb{Z}^n} \phi(v g^{-%
  {\mathpalette\@transpose{}}%
}),\]</span> or a dual Eisenstein series <span
class="math display">\[\tilde{\Psi}(g) := \Psi(g^{-%
  {\mathpalette\@transpose{}}%
}).\]</span> Either way, we obtain the following bound, complementary to
<a href="#eq:psi-_l2t-mathcalh2" data-reference-type="eqref"
data-reference="eq:psi-_l2t-mathcalh2">\((1.18)\)</a>:
<span id="eq:psi-_l2t-mathcalh2-2" class="math display">\[\label{eq:psi-_l2t-mathcalh2-2}\tag{1.20}
\|\Psi \|_{L^2(t \mathcal{H})}^2 \ll \delta_H(t) t_1^{-n}
T^{\varepsilon}.\]</span> It is easy to see that this estimate is highly
effective in “problem cases” such as <a href="#eq:t-=-diagt_1"
data-reference-type="eqref"
data-reference="eq:t-=-diagt_1">\((1.19)\)</a>. In fact, the two
estimates <a href="#eq:psi-_l2t-mathcalh2" data-reference-type="eqref"
data-reference="eq:psi-_l2t-mathcalh2">\((1.18)\)</a> and
<a href="#eq:psi-_l2t-mathcalh2-2" data-reference-type="eqref"
data-reference="eq:psi-_l2t-mathcalh2-2">\((1.20)\)</a>
combine to cover all cases, due to elementary inequalities such as the
following (see Lemma <a href="#lem:standard:any-dominant-element"
data-reference-type="ref"
data-reference="lem:standard:any-dominant-element">76</a>): <span
class="math display">\[\det(1) = 1 \implies t ^\dagger
\leqslant\max(t_1^n, t_n^{-n}).\]</span> We thus obtain <span id="eq:int-_t-in-Psi-t-dagger" class="math display">\[\label{eq:int-_t-in-Psi-t-dagger}\tag{1.21}
  \int _{t  \in \mathcal{T} }
  \|\Psi \|_{L^2(t \mathcal{H})}^2
  t ^\dagger
  \frac{d t}{\delta_H(t)} \ll T^{\varepsilon},\]</span> and the proof
is, to first approximation, complete.</p>
<div class="remark">
<p><strong>Remark 9</strong>. While the argument outlined above seems
natural in retrospect, it was unclear to us for some time whether the
estimates <a href="#eq:t-14-int" data-reference-type="eqref"
data-reference="eq:t-14-int">\((1.16)\)</a> and <a
href="#eq:t-in-mathcalt" data-reference-type="eqref"
data-reference="eq:t-in-mathcalt">\((1.17)\)</a> were even true,
or whether more careful arguments following <a href="#eq:t-n2-int"
data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a> (e.g., Poisson summation
applied to the unipotent contributions, exploiting cancellation coming
from the sum over <span class="math inline">\(\gamma\)</span>, or
inclusion-exclusion involving the non-cuspidal spectrum of <span
class="math inline">\(G\)</span>) would be needed to achieve a
satisfactory estimate. We elaborate briefly on one source of our
concern. We have referred to the geometric expansion <a
href="#eq:t-n2-int" data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a> as describing a spectral
average of <span class="math inline">\(\left\lvert L(\pi,\tfrac{1}{2})
\right\rvert^{2 n}\)</span> over <span
class="math inline">\(\pi\)</span> in some family. Let us pause to
consider in more detail what that spectral average actually looks like.
(It does not arise explicitly in this work – we argue via
Cauchy–Schwarz, in the guise of the pretrace inequality stated in <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
Lemma 5.5)</a>, rather than an actual pretrace formula.) The
contribution from cuspidal <span class="math inline">\(\pi\)</span> is
as we have described, modulo the wave packet issues noted previously
which have the effect of replacing the <span
class="math inline">\(2n\)</span>th moment with an average of shifts.
One could likely show that the contribution of the residual spectrum is
negligible, thanks to the specific shape of either <span
class="math inline">\(\omega\)</span> or <span
class="math inline">\(\Psi\)</span>. It remains to understand the
contribution of the Eisenstein spectrum, which involves non-cuspidal
generic automorphic representations <span
class="math inline">\(\pi\)</span>. Let <span
class="math inline">\(\varphi \in \pi\)</span> be a unit vector in the
essential image of <span class="math inline">\(\pi(\omega)\)</span>
(heuristically, <span class="math inline">\(\varphi\)</span> is
essentially unique, since <span
class="math inline">\(\pi(\omega)\)</span> is essentially of rank one).
Then the contribution of <span class="math inline">\(\pi\)</span> to the
spectral average is essentially the squared magnitude <span
class="math inline">\(\left\lvert \int_{[H]} \varphi \Psi
\right\rvert^2\)</span> of the integral analogous to that in <a
href="#eq:int-_h-varphi" data-reference-type="eqref"
data-reference="eq:int-_h-varphi">\((1.10)\)</a>. There are no
convergence issues here, since <span class="math inline">\(\Psi\)</span>
is a wave packet. However, since <span
class="math inline">\(\pi\)</span> is non-cuspidal, unfolding as in <a
href="#eq:int-_h-varphi" data-reference-type="eqref"
data-reference="eq:int-_h-varphi">\((1.10)\)</a> produces
additional “degenerate” terms, coming from the non-generic parts of the
Fourier expansion of <span class="math inline">\(\varphi\)</span>. These
would be “subtracted off” in a proper discussion of regularized <span
class="math inline">\({\mathop{\mathrm{GL}}}_{n+1} \times
{\mathop{\mathrm{GL}}}_{n}\)</span> zeta integrals <a href="#ref-MR3334892" class="citation"
data-cites="MR3334892">(Ichino and Yamana 2015)</a>, and it was not
clear to us whether they might be large enough to spoil the estimate <a
href="#eq:t-n2-int" data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a>, thereby precluding the
possibility of <a href="#eq:t-14-int" data-reference-type="eqref"
data-reference="eq:t-14-int">\((1.16)\)</a>. (There is precedent for
the spoiling role of contributions from the Eisenstein spectrum in the
subconvexity literature for <span
class="math inline">\({\mathop{\mathrm{GL}}}_2\)</span> and <span
class="math inline">\({\mathop{\mathrm{GL}}}_3\)</span>, see for instance
<a href="#ref-MR1923476 MR3694659" class="citation" data-cites="MR1923476 MR3694659">(Duke,
Friedlander, and Iwaniec 2002; Blomer, Buttcane, and Maga 2017)</a>.)
It would be possible to excise such terms from the spectral average
(essentially via the Kuznetsov formula, roughly as in the work of
Blomer–Buttcane <a href="#ref-MR4203038 MR4039487" class="citation"
data-cites="MR4203038 MR4039487">(Blomer and Buttcane 2020a,
2020b)</a>), but at the cost of producing a more complicated
geometric expansion <a href="#eq:t-n2-int" data-reference-type="eqref"
data-reference="eq:t-n2-int">\((1.13)\)</a>.</p>
</div>
<h5 id="sec:intertw-oper-distr">§1.3.9. Intertwining operators and distributions
related to Jacquet integrals</h5>
<p>For the cuspidal variant of the problem considered here, the proof of
<a href="#eq:int-_t-in-Psi-t-dagger" data-reference-type="eqref"
data-reference="eq:int-_t-in-Psi-t-dagger">\((1.21)\)</a>
is quite simple: see §<a href="#sec:simpler-variants"
data-reference-type="ref" data-reference="sec:simpler-variants">1</a>.
For the Eisenstein case of primary interest, there are some further
difficulties, discussed at length in Part <a
href="#part:local-l2-growth" data-reference-type="ref"
data-reference="part:local-l2-growth"></a>. One of these difficulties is
to understand the asymptotics of the various “partial Whittaker
transforms” of <span class="math inline">\(\Psi\)</span>, including the
constant term. Recalling that <span class="math inline">\(\Psi\)</span>
is attached to a function <span class="math inline">\(f \in C^\infty(U_H
\backslash H)\)</span>, an important intermediate step is to understand
the behavior of <span class="math inline">\(f\)</span> under the Fourier
transforms, or normalized intertwining operators, attached to all
elements of the Weyl group of <span class="math inline">\(H\)</span>. We
manage to avoid this step altogether by carefully constructing <span
class="math inline">\(f\)</span> so as to be exactly invariant under all
normalized intertwining operators. To do this, we take for <span
class="math inline">\(f\)</span> the image, under a
carefully-constructed convolution operator on <span
class="math inline">\(A_H \times H\)</span>, of a distribution on <span
class="math inline">\(U_H \backslash H\)</span> closely related to the
theory of Jacquet integrals. Since (by definition) normalized
intertwining operators preserve Jacquet integrals, they likewise
preserve <span class="math inline">\(f\)</span> provided that we take
our convolution operator on <span class="math inline">\(A_H \times
H\)</span> to be invariant under the action of the Weyl group on the
first factor.</p>
<h5 id="sec:asympt-local-zeta">§1.3.10. Asymptotics of local zeta integrals</h5>
<p>We have not yet commented on the key local estimates <a
href="#eq:piom-varphi-appr" data-reference-type="eqref"
data-reference="eq:piom-varphi-appr">\((1.12)\)</a> and <a
href="#eq:zvarphi-psi-approx" data-reference-type="eqref"
data-reference="eq:zvarphi-psi-approx">\((1.11)\)</a>. The
analogues of these already appeared in the compact case <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson
2023)</a>. In that case, we argued as follows. We started with the
test function <span class="math inline">\(\omega\)</span>. We showed
that <span class="math inline">\(\pi(\omega)\)</span> behaves like a
self-adjoint rank one idempotent, and so approximately corresponds to a
scaling class of vectors <span class="math inline">\(\varphi\)</span>.
The vectors <span class="math inline">\(\varphi\)</span> themselves did
not appear explicitly. In the setting of unitary groups, the local zeta
integrals <span class="math inline">\(Z(\varphi, \Psi)\)</span> are not
necessarily defined. In their place, we have certain matrix coefficients
integrals <span
class="math inline">\(\mathcal{Q}(\varphi,\Psi)\)</span>, defined at
least in the tempered case, which may be understood as avatars of <span
class="math inline">\(|Z(\varphi,\Psi)|^2\)</span>. We estimated the
matrix coefficient integrals using the “reduction to small elements”
technique of <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P.
D. Nelson and Venkatesh 2021, sec. 19)</a> and then ultimately via
appeal to the Kirillov character formula for <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span>. More specifially, we proved such
estimates on average for <span class="math inline">\(\varphi\)</span> in
an implicit family defined by <span
class="math inline">\(\omega\)</span>.</p>
<p>The approach of the present paper is completely different. The
primary motivation for the difference is that, since we are working with
wave packets, we require not just estimates for individual zeta
integrals, but rather a family of integrals <span
class="math inline">\(Z(\varphi, \Psi, s)\)</span> indexed by small
elements <span class="math inline">\(s \in \mathbb{C}^n\)</span>. Off
the “unitary axis” <span class="math inline">\((i
\mathbb{R})^n\)</span>, the connection between such zeta integrals and
matrix coefficient integrals is more tenuous, and does not seem to us to
lend readily to the problem of estimation. A secondary motivation for
the departure from <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023)</a> is that we
do not wish to impose temperedness assumptions on <span
class="math inline">\(\pi\)</span>. The Kirillov character formulas for
non-tempered representations (see, e.g., <a href="#ref-MR4131117" class="citation"
data-cites="MR4131117">(Harris and Oshima 2020)</a>) are more
unwieldly than in the tempered case, and in any event, the estimates of
<a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P. D. Nelson and
Venkatesh 2021, sec. 19)</a> are available only in the tempered
case.</p>
<p>We will instead study the zeta integrals <span
class="math inline">\(Z(\varphi,\Psi,s)\)</span> directly. In doing so,
it is very convenient to assume that the Whittaker function of <span
class="math inline">\(\varphi\)</span> has compactly-supported image in
the Kirillov model. This assumption trivializes the problem of analytic
continuation of such integrals, and also reduces the range of arguments
for which we need to estimate the Whittaker functions associated to
<span class="math inline">\(\Psi\)</span>. For this reason, we will view
the vector <span class="math inline">\(\varphi \in \pi\)</span> as the
primary object, rather than the test function <span
class="math inline">\(\omega\)</span>.</p>
<h5 id="sec:asympt-kirill-model">§1.3.11. Asymptotics of the Kirillov model</h5>
<p>While the adjustment of perspective noted in §<a
href="#sec:asympt-local-zeta" data-reference-type="ref"
data-reference="sec:asympt-local-zeta">1.3.10</a> reduces the complexity
of analyzing the zeta integrals, it introduces a new difficulty: proving
that <span class="math inline">\(\omega\)</span> has the required
approximation property <a href="#eq:piom-varphi-appr"
data-reference-type="eqref"
data-reference="eq:piom-varphi-appr">\((1.12)\)</a>. (Recall
that this property was essentially automatic in the approach pursued in
the compact case, by virtue of the implicit definition of <span
class="math inline">\(\varphi\)</span> in terms of <span
class="math inline">\(\omega\)</span>.) The mirabolic subgroup <span
class="math inline">\(P\)</span> of <span
class="math inline">\(G\)</span> acts in a very simple way on the
Kirillov model. We construct <span
class="math inline">\(\varphi\)</span> so that it is microlocalized with
respect to <span class="math inline">\(P\)</span> at the restriction of
<span class="math inline">\(T \tau\)</span> to <span
class="math inline">\(\mathop{\mathrm{Lie}}(P)\)</span>. We need to know
that <span class="math inline">\(\varphi\)</span> is actually
microlocalized with respect to <span class="math inline">\(G\)</span> at
<span class="math inline">\(T \tau\)</span>. At a heuristic level, this
is clear, since <span class="math inline">\(T \tau\)</span> is the only
element of the coadjoint orbit <span
class="math inline">\(\mathcal{O}_\pi\)</span> lying above its
restriction to <span
class="math inline">\(\mathop{\mathrm{Lie}}(P)\)</span>. It is a bit
subtle to implement this heuristic rigorously. The scenario that we need
to rule out is that the “frequency” of <span
class="math inline">\(\varphi\)</span> with respect to the <span
class="math inline">\(G\)</span>-action is significantly larger than
<span class="math inline">\(T\)</span>. To do this, we first apply a
quantitative form of Jacquet’s arguments <a href="#ref-MR2733072" class="citation"
data-cites="MR2733072">(Hervé Jacquet 2010, sec. 3)</a> concerning
the archimedean Kirillov model, which allows us to show that <span
class="math inline">\(\varphi\)</span> has “frequency <span
class="math inline">\(T^{\operatorname{O}(1)}\)</span>.” This serves as
the first step in a bootstrapping argument, involving the microlocal
calculi of <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P. D.
Nelson and Venkatesh 2021)</a> and <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023)</a>, by which we
eventually conclude that <span class="math inline">\(\varphi\)</span>
has frequency <span class="math inline">\(\operatorname{O}(T)\)</span>
and is microlocalized at <span class="math inline">\(T \tau\)</span>, as
required. We record a more detailed overview of this part of the paper
in §<a href="#sec:overview-asymp-kirillov" data-reference-type="ref"
data-reference="sec:overview-asymp-kirillov">1</a>. We note in
particular that the Kirillov character formula makes no appearance in
this paper, in contrast to its repeated usage in the previous works
<a href="#ref-nelson-venkatesh-1 2020arXiv201202187N" class="citation"
data-cites="nelson-venkatesh-1 2020arXiv201202187N">(P. D. Nelson and
Venkatesh 2021; P. D. Nelson 2023)</a>.</p>
<h4 id="outlook">Outlook</h4>
<p>We briefly comment on the scope of the method.</p>
<p>It would be natural to give a common generalization of Theorems <a
href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> and <a
href="#thm:unitary-review" data-reference-type="ref"
data-reference="thm:unitary-review">6</a>, valid for all unitary (or
orthogonal) GGP pairs and all families of pairs of automorphic
representations <span class="math inline">\((\pi,\sigma)\)</span> with
uniform parameter growth. As an imperfect analogy, one might think of
such a generalization as the “convex hull” of those theorems. For
example, the case of Rankin–Selberg <span
class="math inline">\(L\)</span>-functions attached to cusp forms on
<span class="math inline">\({\mathop{\mathrm{GL}}}_{n+1} \times
{\mathop{\mathrm{GL}}}_n\)</span> can be approached either by dropping the
anisotropy and temperedness assumptions from Theorem <a
href="#thm:unitary-review" data-reference-type="ref"
data-reference="thm:unitary-review">6</a>, or by adapting Theorem <a
href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> to the case that
<span class="math inline">\(\sigma\)</span> is cuspidal, which should in
most respects be simpler than the Eisenstein case treated here. However,
such a generalization would not be altogether formal, as the local
estimates developed here for the Eisenstein case use that they are
tempered and belong locally to the principal series. We hope that our
work might nevertheless serve as a useful template for such a
generalization.</p>
<p>Over number fields with complex places, there are a couple lemmas in
the literature concerning <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span> that
would need to be generalized to <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{C})\)</span> (e.g.,
<a href="#ref-MR2733072" class="citation" data-cites="MR2733072">(Hervé Jacquet 2010, Lemma
3)</a> and <a href="#ref-JN19a" class="citation" data-cites="JN19a">(Jana and Nelson
2019, Lemma 5.2)</a>) but we do not foresee significant difficulties
there. The depth aspect is often similar to the archimedean aspect, but
with less technical compilation due to the availability of the exact
projectors in the Hecke algebra; one might hope that it could be treated
similarly.</p>
<p>The “horizontal” level aspect (e.g., taking <span
class="math inline">\(\pi\)</span> of prime level), the quadratic twist
case of which may have applications to quadratic forms in view of the
appearance of self-dual standard <span
class="math inline">\(L\)</span>-functions in formulas for Whittaker
coefficients on higher rank metaplectic groups <a href="#ref-MR3267120 MR3619910 MR3649366" class="citation"
data-cites="MR3267120 MR3619910 MR3649366">(E. Lapid and Mao 2015,
2017b, 2017a)</a>, would require new ideas concerning the
construction of analytic test vectors, and, we imagine, new estimates
for exponential sums over finite fields, substituting for the role
played by Proposition <a href="#prop:standard2:let-tau-belong"
data-reference-type="ref"
data-reference="prop:standard2:let-tau-belong">201</a>, <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
Thm 4.2 (iii) and Thm 15.1)</a> and <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, secs. 16–17)</a>
for the “vertical” (archimedean or depth) aspects. The works of
Bykovskii <a href="#ref-MR1433344" class="citation" data-cites="MR1433344">(Bykovskiı̆
1996)</a>, Blomer–Harcos <a href="#ref-MR2431250 MR3259045" class="citation"
data-cites="MR2431250 MR3259045">(Blomer and Harcos 2008, 2014)</a>
and Fouvry–Kowalski–Michel <a href="#ref-MR3334236" class="citation"
data-cites="MR3334236">(Fouvry, Kowalski, and Michel 2015)</a> (resp.
Sharma <a href="#ref-2019arXiv190609493S" class="citation" data-cites="2019arXiv190609493S">(Sharma
2019)</a> and Lin–Michel–Sawin <a href="#ref-2019arXiv191209473L" class="citation"
data-cites="2019arXiv191209473L">(Lin, Michel, and Sawin 2019)</a>)
concerning the case of <span
class="math inline">\({\mathop{\mathrm{GL}}}_2 \times
{\mathop{\mathrm{GL}}}_1\)</span> (resp. <span
class="math inline">\({\mathop{\mathrm{GL}}}_3 \times
{\mathop{\mathrm{GL}}}_2\)</span>) give some hint as to what might be
required. As a first step towards generalizing the results of those
works to higher rank, it might be interesting to revisit them from the
perspective of integral representations (cf. <a href="#ref-2020arXiv200201993N MR4206609 2020arXiv200406791S" class="citation"
data-cites="2020arXiv200201993N MR4206609 2020arXiv200406791S">(Nunes
2020; Zacharias 2021; Schumacher 2020)</a>).</p>
<p>The outstanding open problem is to address the case in which <span
class="math inline">\(\pi\)</span> is not of uniform parameter growth,
often known as the conductor dropping case. We have already noted the
works <a href="#ref-MR1923476 MR2382859 Mi04 michel-2009 MR3912807" class="citation"
data-cites="MR1923476 MR2382859 Mi04 michel-2009 MR3912807">(Duke,
Friedlander, and Iwaniec 2002; Blomer, Harcos, and Michel 2007; P.
Michel 2004; Philippe Michel and Venkatesh 2010; Blomer and Khan
2019)</a> addressing that case (or its related level aspect analogue)
when <span class="math inline">\(n=2\)</span>. An extension of Theorem
<a href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> for <span
class="math inline">\(n=3\)</span> or <span
class="math inline">\(n=6\)</span> to the conductor dropping case in
which one or two of the archimedean <span
class="math inline">\(L\)</span>-function parameters remains bounded
would have well-known applications to quantum chaos, as described, for
instance, in <a href="#ref-MR1826269 watson-2008 MR2680499 PDN-AP-AS-que sarnak-progress-que 2020arXiv200108704N" class="citation"
data-cites="MR1826269 watson-2008 MR2680499 PDN-AP-AS-que sarnak-progress-que 2020arXiv200108704N">(Iwaniec
and Sarnak 2000; Watson 2002; Holowinsky and Soundararajan 2010; P. D.
Nelson, Pitale, and Saha 2014; Sarnak 2011; P. D. Nelson 2022)</a>.
Such an extension should not be expected to follow via analysis of the
specific moments considered in this paper. Indeed, to obtain such an
extension, we would need to further shrink the archimedean families that
we consider. Doing so is not analytically feasible, even when <span
class="math inline">\(n=2\)</span>: the families are already of “size
<span class="math inline">\(\operatorname{O}(1)\)</span>” with respect
to the parameters.</p>
<h4 id="organization">Organization</h4>
<p>The paper is intended to be read linearly, but other approaches may
be preferred. For this reason, we briefly indicate the organization. In
Part <a href="#part:reduction-proof" data-reference-type="ref"
data-reference="part:reduction-proof"></a>, we begin by formulating two
auxiliary results:</p>
<ul>
<li><p>a local result, Theorem <a href="#thm:main-local-results"
data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>,
asserting the existence of elements <span
class="math inline">\(\varphi\)</span>, <span
class="math inline">\(f\)</span> and <span
class="math inline">\(\omega\)</span> satisfying the desiderata
indicated in the sketch of §<a href="#sec:high-level-overview"
data-reference-type="ref"
data-reference="sec:high-level-overview">1.3</a>, with <span
class="math inline">\(\varphi\)</span> constructed in terms of its
archimedean Whittaker function <span class="math inline">\(W\)</span>,
and</p></li>
<li><p>a global result, Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>, asserting the
required <span class="math inline">\(L^2\)</span>-local growth bounds <a
href="#eq:int-_t-in-Psi-t-dagger" data-reference-type="eqref"
data-reference="eq:int-_t-in-Psi-t-dagger">\((1.21)\)</a>
for Eisenstein series.</p></li>
</ul>
<p>The proof of the former is given in Part <a
href="#part:constr-test-vect" data-reference-type="ref"
data-reference="part:constr-test-vect"></a>, the latter in Part <a
href="#part:asympt-analys-kirill" data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>. In the remainder of
Part <a href="#part:reduction-proof" data-reference-type="ref"
data-reference="part:reduction-proof"></a>, we deduce our main result,
Theorem <a href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a>, from these
auxiliary results, via the expected global ingredients (amplification
method, counting arguments, <span
class="math inline">\(\dotsc\)</span>). Part <a
href="#part:asympt-analys-kirill" data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a> supplies an independent
ingredient (discussed in §<a href="#sec:asympt-kirill-model"
data-reference-type="ref"
data-reference="sec:asympt-kirill-model">1.3.11</a>) required in the
construction of test vectors. The dependency graph of the parts of the
paper is thus as follows:</p>
<ul>
<li><p>Part <a href="#part:reduction-proof" data-reference-type="ref"
data-reference="part:reduction-proof"></a>: Division of the argument</p>
<ul>
<li><p>Part <a href="#part:constr-test-vect" data-reference-type="ref"
data-reference="part:constr-test-vect"></a>: Construction of test
vectors</p>
<ul>
<li><p>Part <a href="#part:asympt-analys-kirill"
data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>: Asymptotics of the
Kirillov model</p></li>
</ul></li>
<li><p>Part <a href="#part:local-l2-growth" data-reference-type="ref"
data-reference="part:local-l2-growth"></a>: Growth bounds for Eisenstein
series</p></li>
</ul></li>
</ul>
<h4 class="unnumbered" id="acknowledgments">Acknowledgments</h4>
<p>We would like to thank V. Blomer, R. Beuzart-Plessis, P. Garrett, G.
Harcos, P. Sarnak, E. Lapid, Ph. Michel, Y. Sakellaridis, A. Venkatesh
and Liyang Yang for helpful discussions and feedback. Much of this paper
was written while the author was an Assistant Professor at ETH Zurich,
during the Hausdorff Trimester Program <em>Harmonic Analysis and
Analytic Number Theory</em> hosted by the Hausdorf Research Institute
for Mathematics. This paper was completed at the Institute for Advanced
Study, where the author was supported by the National Science Foundation
under Grant No. DMS-1926686. We are grateful to each of these
institutions for their excellent working conditions.</p>
<h3 id="sec:preliminaries">§2. Preliminaries</h3>
<h4 id="sec:asympt-notat-term">§2.1. Asymptotic notation and terminology</h4>
<h5 id="sec:asymptotic-notation-overview">§2.1.1. Overview</h5>
<p>This paper, like its predecessor <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023)</a>, involves
the iterated application of estimates involving functions whose support,
size and oscillation depend upon many parameters. To manage this
iteration sensibly, we again adopt the formalism of nonstandard
analysis. Specifically, we adopt the axiomatization due to E. Nelson
<a href="#ref-MR469763" class="citation" data-cites="MR469763">(E. Nelson 1977)</a>
(“internal set theory”, or IST for short), but with the terminological
substitution of “fixed” for “standard.” This substitution has the
primary effect of making this paper read (we hope) like a typical
analytic number theory paper, so as to require little adjustment of
habit for the reader who is familiar with such papers. A secondary
effect is to have a convenient verb form: we write “fix <span
class="math inline">\(x\)</span>” synonymously with “let <span
class="math inline">\(x\)</span> be fixed.” A tertiary effect is to
avoid conflict with “standard <span
class="math inline">\(L\)</span>-functions.” We briefly recall that
axiomatization, referring to <em>loc. cit.</em> for details and superior
exposition.</p>
<p>In ZFC, everything is a set. ZFC consists of the binary predicate
“<span class="math inline">\(\in\)</span>” (interpreted: “is an element
of”) and some axioms for working with it. IST adjoins to ZFC an
additional unary predicate, which we label “fixed,” and three axioms,
recalled below, for working with that. A statement of IST is
<em>internal</em> if it is really a statement of ZFC, i.e., if it does
not use the predicate “fixed,” even implicitly; otherwise, it is
<em>external</em>. The appendix of <a href="#ref-MR469763" class="citation"
data-cites="MR469763">(E. Nelson 1977)</a> establishes the
<em>conservation theorem</em>: any internal statement provable in IST is
also provable in ZFC. More precisely, any proof in IST may be
mechanically converted to one in ZFC. In some applications of
nonstandard analysis, such conversion is not practical, but in this
paper, it is: the proof of our main results could be rewritten in ZFC in
a reasonable amount of time by a human.</p>
<p>We define customary asymptotic notation in terms of “fixed,” as in
<a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson
2023, sec. 3.1)</a>. If <span class="math inline">\(|A| \leqslant C
|B|\)</span> for some fixed <span class="math inline">\(C \geqslant
0\)</span>, then we write <span class="math inline">\(A \ll B\)</span>
or <span class="math inline">\(B \gg A\)</span> or <span
class="math inline">\(A = \operatorname{O}(B)\)</span>; otherwise, we
write <span class="math inline">\(B \lll A\)</span> or <span
class="math inline">\(A \ggg B\)</span> or <span class="math inline">\(B
= o(A)\)</span>. We write <span class="math inline">\(A \asymp
B\)</span> as shorthand for <span class="math inline">\(A \ll B \ll
A\)</span>. We introduce some further notation below, and will introduce
other definitions involving “fixed” throughout the paper. The reader who
is familiar with the customary use of such notation can likely skip or
skim the remainder of §<a href="#sec:asympt-notat-term"
data-reference-type="ref" data-reference="sec:asympt-notat-term">2.1</a>
on a first reading, referring back in case anything seems unclear or
imprecise.</p>
<p>Informally, “fixed” quantities behave like “absolute constants.” In
particular, ordinary mathematical objects (<span
class="math inline">\(\mathbb{Z}\)</span>, <span
class="math inline">\(\mathbb{R}\)</span>, <span
class="math inline">\(\sqrt{2}\)</span>, the set of cuspidal automorphic
representations of <span
class="math inline">\({\mathop{\mathrm{GL}}}_{100}(\mathbb{Q})\)</span>,
<span class="math inline">\(\dotsc\)</span>) are fixed. On the other
hand, any infinite set (and any non-fixed finite set) contains non-fixed
elements. To make this heuristic more precise, one could introduce an
asymptotic parameter <span class="math inline">\(T\)</span> (tending off
to <span class="math inline">\(\infty\)</span> in some directed set),
take every object in one’s mathematical universe to depend upon <span
class="math inline">\(T\)</span> by default, and think of “fixed” as
meaning “independent of <span class="math inline">\(T\)</span>.” This is
essentially what happens in the ultrafilter approach to nonstandard
analysis, which in turn forms the basis for the proof of the
conservation theorem of IST. The definitions and results of this paper
could be reformulated in such “parameter-dependent” language, much like
in <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P. D. Nelson
and Venkatesh 2021)</a>, but doing so seemed to us to ultimately
reduce the clarity and precision.</p>
<p>As detailed in <a href="#ref-MR469763" class="citation" data-cites="MR469763">(E.
Nelson 1977, sec. 2)</a>, any external statement may be mechanically
converted to an equivalent internal statement (subject to a minor
technical caveat that applies in ordinary mathematics, and in
particular, this paper). We illustrate this algorithm below in the
discussion of §<a href="#sec:main-result:-reform"
data-reference-type="ref"
data-reference="sec:main-result:-reform">2.1.3</a> and in the proof of
Lemma <a href="#lem:four-transf-begin" data-reference-type="ref"
data-reference="lem:four-transf-begin">12</a>.</p>
<p>The principal results upon which we base the proof of Theorem <a
href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a> are formulated in
the language of IST. We record their equivalent internal formulations in
Appendix <a href="#sec:elem-form" data-reference-type="ref"
data-reference="sec:elem-form">6</a>. Those reformulations are clunkier,
and we do not work with them in the body of the text; they are provided
only for the sake of illustration.</p>
<h5 id="sec:axioms-ist">§2.1.2. Axioms of IST</h5>
<p>We now recall the axioms, referring again to <a href="#ref-MR469763" class="citation"
data-cites="MR469763">(E. Nelson 1977)</a> for details. In what
follows, take “quantity” to be a synonym for “set,” given that we are
working in ZFC.</p>
<ul>
<li><p><em>Transfer</em>. Let <span class="math inline">\(A(x)\)</span>
be an internal statement involving a quantity <span
class="math inline">\(x\)</span> and possibly other fixed quantities,
but no non-fixed quantities. Then <span
class="math inline">\(A(x)\)</span> is true for all <span
class="math inline">\(x\)</span> if and only if it is true for all fixed
<span class="math inline">\(x\)</span>.</p></li>
<li><p><em>Idealization</em>. Let <span
class="math inline">\(A(x,y)\)</span> be an internal statement involving
quantities <span class="math inline">\(x\)</span>, <span
class="math inline">\(y\)</span> and possibly other quantities. Then the
following statements are equivalent.</p>
<ul>
<li><p>For each fixed finite set <span
class="math inline">\(x&#39;\)</span>, there exists <span
class="math inline">\(y\)</span> so that, for each <span
class="math inline">\(x \in x&#39;\)</span>, the statement <span
class="math inline">\(A(x,y)\)</span> is true.</p></li>
<li><p>There exists <span class="math inline">\(y\)</span> so that for
each fixed <span class="math inline">\(x\)</span>, the statement <span
class="math inline">\(A(x,y)\)</span> is true.</p></li>
</ul></li>
<li><p><em>Standardization</em>. Let <span
class="math inline">\(A(z)\)</span> be a statement involving the
quantity <span class="math inline">\(z\)</span>. Let <span
class="math inline">\(x\)</span> be a fixed set. Then there is a fixed
subset <span class="math inline">\(y \subseteq x\)</span> so that for
each fixed <span class="math inline">\(z \in x\)</span>, we have <span
class="math inline">\(z \in y\)</span> if and only if <span
class="math inline">\(A(z)\)</span> holds.</p></li>
</ul>
<p>The idealization axiom simplifies when</p>
<ul>
<li><p>the variable <span class="math inline">\(x\)</span> of the
statement <span class="math inline">\(A(x,y)\)</span> is restricted to
some directed set <span class="math inline">\((X, \geqslant)\)</span>,
and</p></li>
<li><p>the statement <span class="math inline">\(A(x,y)\)</span> is
<em>filtered</em> in <span class="math inline">\(x\)</span>: if <span
class="math inline">\(x_1 \geqslant x_2\)</span>, then <span
class="math inline">\(A(x_1,y) \implies A(x_2,y)\)</span>.</p></li>
</ul>
<p>In that case, it says that one can commute quantifiers: “for each
fixed <span class="math inline">\(x\)</span>, there exists <span
class="math inline">\(y\)</span> so that <span
class="math inline">\(A(x,y)\)</span>” is equivalent to “there exists
<span class="math inline">\(y\)</span> so that for each fixed <span
class="math inline">\(x\)</span>, we have <span
class="math inline">\(A(x,y)\)</span>.”</p>
<p>A primary consequence of the standardization axiom is the following
(see <a href="#ref-MR469763" class="citation" data-cites="MR469763">(E. Nelson 1977, Thm
1.3)</a>). Suppose given fixed sets <span
class="math inline">\(X\)</span> and <span
class="math inline">\(Y\)</span> and a statement <span
class="math inline">\(A(x,y)\)</span>, concerning elements <span
class="math inline">\(x \in X\)</span> and <span class="math inline">\(y
\in Y\)</span>, such that for each fixed <span class="math inline">\(x
\in X\)</span>, there is a fixed <span class="math inline">\(y \in
Y\)</span> for which <span class="math inline">\(A(x,y)\)</span> holds.
Then there is a fixed function <span class="math inline">\(\tilde{y} : X
\rightarrow Y\)</span> such that for all fixed <span
class="math inline">\(x \in X\)</span>, we have <span
class="math inline">\(A(x, \tilde{y}(x))\)</span></p>
<p>Each of the above axioms has a dual form obtained by swapping “for
all” with “there exists.”</p>
<h5 id="sec:main-result:-reform">§2.1.3. Main result: reformulation</h5>
<p>Recall that the main result to be proved is part <a
href="#itm:standard:main-b" data-reference-type="eqref"
data-reference="itm:standard:main-b">\((b)\)</a> of
Theorem <a href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a>. We explain here
the equivalence of that statement with the following one.</p>
<div id="thm:main-result-reformulated" class="theorem">
<p><strong>Theorem 10</strong> (Theorem <a href="#thm:main-result"
data-reference-type="ref"
data-reference="thm:main-result">1.2</a>, reformulated).
<em>Let <span class="math inline">\(T \geqslant 1\)</span>. Let <span
class="math inline">\(n \geqslant 2\)</span> be fixed. Let <span
class="math inline">\(\pi\)</span> be a unitary cuspidal automorphic
representation of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span> whose archimedean <span
class="math inline">\(L\)</span>-function parameters satisfy <span
class="math inline">\(t_j \asymp T\)</span>. Then for each fixed <span
class="math inline">\(\delta &lt; \delta_n ^\sharp\)</span>, we have
<span class="math display">\[L(\pi, \tfrac{1}{2}) \ll
C(\pi_{\mathop{\mathrm{fin}}})^{1/2}
T^{(1-\delta)n/4}.\]</span></em></p>
</div>
<p>Recall the universal quantifier <span
class="math inline">\(\forall\)</span> (“for all”) and the existential
quantifier <span class="math inline">\(\exists\)</span> (“there
exists”). Let us write <span class="math inline">\(\forall^*\)</span>
and <span class="math inline">\(\exists^*\)</span> for the modified
quantifiers obtained by restricting quantification to fixed elements
(thus, e.g., <span class="math inline">\(\forall^* x\)</span> means “for
all <span class="math inline">\(x\)</span>, if <span
class="math inline">\(x\)</span> is fixed, then <span
class="math inline">\(\dotsb\)</span>.”) The condition “<span
class="math inline">\(t_j \asymp T\)</span> for all <span
class="math inline">\(j\)</span>” expands to <span
class="math display">\[\forall j \, \exists^* C_0, c_0 \, : j \in \{1,
\dotsc, n\} \implies C_0 &gt; c_0 &gt; 0 \text{ and }  c_0 T
\leqslant|t_j| \leqslant C_0 T.\]</span> The conclusion is filtered with
respect to <span class="math inline">\((C_0,c_0)\)</span>, so by
idealization, the above is equivalent to <span
class="math display">\[\exists^* C_0, c_0 \,   \forall j \, : j \in \{1,
\dotsc, n\} \implies C_0 &gt; c_0 &gt; 0 \text{ and }  c_0 T
\leqslant|t_j| \leqslant C_0 T.\]</span> Theorem <a
href="#thm:main-result-reformulated" data-reference-type="ref"
data-reference="thm:main-result-reformulated">10</a> is thus equivalent
to <span id="eq:forall-t-reducing-nonstandard-reformulation" class="math display">\[\label{eq:forall-t-reducing-nonstandard-reformulation}\tag{2.1}
  \forall T \,
  \forall^* n \,
  \forall \pi \,
  \forall^* \delta , C_0, c_0 \,
  \exists^* C_1 : A,\]</span> where <span
class="math inline">\(A\)</span> denotes the internal statement “if
<span class="math inline">\(T \geqslant 1\)</span>, <span
class="math inline">\(n\)</span> is a natural number, <span
class="math inline">\(\pi\)</span> is a unitary cuspidal automorphic
representation of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span>, <span
class="math inline">\(\delta &lt; \delta_n ^\sharp\)</span>, <span
class="math inline">\(C_0 &gt; c_0 &gt; 0\)</span>, <span
class="math inline">\(c_0 T \leqslant|t_j|  \leqslant C_0 T\)</span> for
all <span class="math inline">\(j\)</span>, and <span
class="math inline">\(\delta &lt; \delta_n^\sharp\)</span>, then <span
class="math inline">\(|L(\pi,\tfrac{1}{2})| \leqslant C_1
C(\pi_{\mathop{\mathrm{fin}}})^{1/2} T^{(1-\delta) n/4}\)</span>.” By
Boolean logic, <a href="#eq:forall-t-reducing-nonstandard-reformulation"
data-reference-type="eqref"
data-reference="eq:forall-t-reducing-nonstandard-reformulation">\((2.1)\)</a>
is equivalent to <span class="math display">\[\forall^* n, \delta , C_0,
c_0  \,
  \forall T , \pi  \,
  \exists^* C_1 \, : A.\]</span> The internal statement <span
class="math inline">\(A\)</span> is filtered with respect to <span
class="math inline">\(C_1\)</span>, so by idealization, we can commute
its quantification with that for <span
class="math inline">\((T,\pi)\)</span>. This yields the equivalent
statement <span id="eq:forall-n-delta" class="math display">\[\label{eq:forall-n-delta}\tag{2.2}
  \forall^* n, \delta , C_0, c_0  \,
  \exists^* C_1 \,
  \forall T , \pi  \,
  : A.\]</span> By repeated application of transfer to the internal
statement “<span class="math inline">\(\forall T, \pi \, : A\)</span>,”
we obtain the further reformulation <span class="math display">\[\forall
n, \delta , C_0, c_0  \,
  \exists C_1 \,
  \forall T , \pi  \,
  : A.\]</span> The latter unwinds to the statement of part <a
href="#itm:standard:main-b" data-reference-type="eqref"
data-reference="itm:standard:main-b">\((b)\)</a> of
Theorem <a href="#thm:main-result" data-reference-type="ref"
data-reference="thm:main-result">1.2</a>.</p>
<p>In this way, we obtain the required equivalence with Theorem <a
href="#thm:main-result-reformulated" data-reference-type="ref"
data-reference="thm:main-result-reformulated">10</a>. By the
conservation theorem, our task reduces to verifying the latter.</p>
<h5 id="sec:classes">§2.1.4. Classes</h5>
<p>As in <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D.
Nelson 2023, sec. 3.1.4)</a>, by a <em>class</em>, we mean a pair
<span class="math inline">\((X,P)\)</span>, where <span
class="math inline">\(X\)</span> is a set and <span
class="math inline">\(P\)</span> is a boolean formula of IST that
accepts an element <span class="math inline">\(x \in X\)</span> as its
argument. We note that if <span class="math inline">\(P\)</span> is
internal, then an axiom of ZFC tells us that there exists a subset of
<span class="math inline">\(X\)</span>, denoted <span
class="math inline">\(\{x \in X : P(x)\}\)</span>, that consists of
precisely those elements for which <span
class="math inline">\(P\)</span> is true. On the other hand, ZFC says
nothing about external formulas. For example, there is no subset of
<span class="math inline">\(\mathbb{R}\)</span> consisting of precisely
those elements <span class="math inline">\(x\)</span> for which <span
class="math inline">\(x = \operatorname{O}(1)\)</span>. On the other
hand, it makes perfect sense to form the pair <span
class="math inline">\((\mathbb{R},P)\)</span>, where <span
class="math inline">\(P(x)\)</span> denotes the predicate “<span
class="math inline">\(x = \operatorname{O}(1)\)</span>.” We refer to
such a pair <span class="math inline">\((X,P)\)</span> as “the class of
all <span class="math inline">\(x \in X\)</span> satisfying <span
class="math inline">\(P(x)\)</span>.” For instance, we may speak of the
class of all real numbers of the form <span
class="math inline">\(\operatorname{O}(1)\)</span>. In the language of
some axiomatizations (see, e.g., <a href="#ref-MR469763" class="citation"
data-cites="MR469763">(E. Nelson 1977, sec. 3)</a>, <a href="#ref-MR723332"
class="citation" data-cites="MR723332">(Kawai 1983)</a> or <a href="#ref-MR546178"
class="citation" data-cites="MR546178">(Hrbacek 1979, sec. 3)</a>),
“classes” correspond to “external subsets of interal sets,” but since we
will be working with classes in a purely syntactic way, it is not
necessary to adopt such additional formalism.</p>
<p>Classes do not appear explicitly in Part <a
href="#part:reduction-proof" data-reference-type="ref"
data-reference="part:reduction-proof"></a>. They play a significant
organizing role in Parts <a href="#part:constr-test-vect"
data-reference-type="ref" data-reference="part:constr-test-vect"></a>
and <a href="#part:asympt-analys-kirill" data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>, and a minor one in Part
<a href="#part:local-l2-growth" data-reference-type="ref"
data-reference="part:local-l2-growth"></a>.</p>
<p>We may regard sets as classes (take for <span
class="math inline">\(P\)</span> the predicate “true”) and work with
classes in much the same way we work with sets, except that we will
never apply anything like the “power set” axiom to classes, e.g., by
speaking of “the class of all subclasses of <span
class="math inline">\((\dotsb)\)</span>.” An element <span
class="math inline">\(x\)</span> belongs to the class <span
class="math inline">\((X,P)\)</span> if <span class="math inline">\(x
\in X\)</span> and if <span class="math inline">\(P(x)\)</span> is true.
One class <span class="math inline">\((X,P)\)</span> is contained in
another class <span class="math inline">\((Y,Q)\)</span> (and called,
then, a “subclass”) if for every <span class="math inline">\(x \in
X\)</span> satisfying <span class="math inline">\(P(x)\)</span>, we have
<span class="math inline">\(x \in Y\)</span> and <span
class="math inline">\(Q(x)\)</span>. For example, for <span
class="math inline">\(T \geqslant 1\)</span>, the class of all real
numbers of the form <span
class="math inline">\(\operatorname{O}(T)\)</span> is contained in the
class of all real numbers of the form <span
class="math inline">\(\operatorname{O}(T^2)\)</span>, say. This basic
idea is routinely applied in analytic number theory papers, but since we
will eventually be applying it in somewhat complicated ways, we have
attempted to be precise.</p>
<p>Two classes are equal if they contain the same elements, or
equivalently, if each is contained in the other. We may define
intersections or unions of classes, class maps <span
class="math inline">\(f : (X,P) \rightarrow (Y,Q)\)</span> between
classes (i.e., subclasses of the product class satisfying the map
axioms), and so on.</p>
<p>We record a simple example of the sorts of classes we will work with.
This example will not play a direct role in the paper, and is perhaps
better treated without such formalism, but illustrates the basic
idea.</p>
<div id="exa:positive-parameter-t-scaling" class="example">
<p><strong>Example 11</strong>. For a positive parameter <span
class="math inline">\(T\)</span>, let <span
class="math inline">\(\mathcal{A}_T\)</span> denote the subclass of the
Schwartz space <span
class="math inline">\(\mathcal{S}(\mathbb{R})\)</span> consisting of
<span class="math inline">\(f\)</span> that satisfy, for all fixed <span
class="math inline">\(m,n \in \mathbb{Z}_{\geqslant 0}\)</span>, the
<span class="math inline">\(n\)</span>th derivative estimate <span
class="math display">\[f^{(n)}(x) \ll \frac{1}{T^{1+n}} \left(1 +
\frac{|x|}{T}\right)^{-m}\]</span> for all <span class="math inline">\(x
\in \mathbb{R}\)</span>.</p>
<p>Let <span class="math inline">\(\mathcal{A}_T^\wedge\)</span> denote
the subclass of <span
class="math inline">\(\mathcal{S}(\mathbb{R})\)</span> consisting of
<span class="math inline">\(f\)</span> satisfying, for all fixed <span
class="math inline">\(m,n \in \mathbb{Z}_{\geqslant 0}\)</span>, <span
class="math display">\[f^{(n)}(x) \ll T^{n} \left( 1 + T |x|
\right)^{-m}.\]</span> Informally, <span
class="math inline">\(\mathcal{A}_T\)</span> consists of bump functions
of mean <span class="math inline">\(\ll 1\)</span> that concentrate on
<span class="math inline">\(\operatorname{O}(T)\)</span>, while <span
class="math inline">\(\mathcal{A}_T^\wedge\)</span> consists of bump
functions of magnitude <span class="math inline">\(\ll 1\)</span> that
concentrate on <span
class="math inline">\(\operatorname{O}(1/T)\)</span>.</p>
</div>
<div id="lem:four-transf-begin" class="lemma">
<p><strong>Lemma 12</strong>. The Fourier transform <span
class="math display">\[f \mapsto f^\wedge := [\xi \mapsto \int _{x \in
\mathbb{R} } f(x) e^{i \xi x} \, d x]\]</span> induces a bijective class
map <span class="math inline">\(\mathcal{A}_T \rightarrow
\mathcal{A}_T^\wedge\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This follows by repeated partial integration applied
to the definition of the Fourier integral. Alternatively, we may reduce
to the case <span class="math inline">\(T = 1\)</span> by rescaling, and
then apply transfer to relate the conclusion to the well-known fact that
the Fourier transform defines a topological automorphism of the Schwartz
space. The “two proofs” are ultimately equivalent. We indicate in more
detail the latter argument, primarily as an excuse to illustrate further
the algorithm for translating external statements into internal ones.
(We emphasize that this is a toy example. The nonstandard language
become more useful than in this example when the definitions of the
classes involve, e.g., support conditions depending upon
parameters.)</p>
<p>In the case <span class="math inline">\(T = 1\)</span>, we need to
verify the implication <span class="math display">\[\begin{align}
    &amp;\forall f \in \mathcal{S}(\mathbb{R}) :
    (  \forall^* k,  \ell \,
    \exists^* C_0 \,
    \forall x :
    (1 + |x|)^\ell |f^{(k)}(x)| \leqslant C_0
      )
      \\
    &amp;\implies
    (  \forall^* m,  n \,
    \exists^* C_1 \,
    \forall y :
    (1 + |y|)^m |(f^\wedge)^{(n)}(y)| \leqslant C_1
    )
  
\end{align}\]</span> as well as its converse. By Fourier inversion and
the symmetry of the problem, we can just focus on the forward
implication.</p>
<p>We may rewrite the implication to be proved more succinctly as <span
class="math display">\[\forall f \,
  :  (
  \forall^* \kappa \, \exists^* C_0 \, :  \kappa(f) \leqslant C_0
  ) \implies
  (
  \forall^* \mu \, \exists^* C_1 \,  : \mu(f^\wedge) \leqslant C_1
  ),\]</span> where <span class="math inline">\(f \in
\mathcal{S}(\mathbb{R})\)</span>, <span
class="math inline">\(\kappa\)</span> and <span
class="math inline">\(\mu\)</span> are (continuous) seminorms on <span
class="math inline">\(\mathcal{S}(\mathbb{R})\)</span>, and <span
class="math inline">\(C_0, C_1\)</span> are nonnegative reals. (Indeed,
<span class="math inline">\(f \mapsto \max_{k \leqslant k&#39;} \sup_{x
\in \mathbb{R}} (1 + |x|)^{\ell}) |f^{(k)}(x)|\)</span> defines a
seminorm for each <span class="math inline">\((k,\ell) \in
\mathbb{Z}_{\geqslant 0}^2\)</span>, and every seminorm is bounded by a
constant multiple of such a seminorm.) By standardization, we can
permute quantification over <span class="math inline">\(\kappa\)</span>
and <span class="math inline">\(C_0\)</span> at the cost of replacing
<span class="math inline">\(C_0\)</span> by a fixed function that
depends upon <span class="math inline">\(\kappa\)</span>: <span
class="math display">\[\forall f \,
  :  (
  \exists^* \tilde{C}_0 \, \forall^* \kappa \, : \kappa(f)
\leqslant\tilde{C}_0(\kappa)
  ) \implies
  (
  \forall^* \mu \, \exists^* C_1 \, :  \mu(f^\wedge) \leqslant C_1
  ).\]</span> By Boolean logic, the above is equivalent to <span
class="math display">\[\forall f \, \forall^* \tilde{C}_0, \mu \,
\exists^* \kappa, C_1 \,
  : \kappa(f) \leqslant\tilde{C}_0(\kappa)
  \implies \mu(f^\wedge) \leqslant C_1.\]</span> The universal
quantification over <span class="math inline">\(f\)</span> and <span
class="math inline">\((\tilde{C}_0, \mu)\)</span> may be commuted. The
innermost statement is then of the form <span
class="math inline">\(\forall f \exists^* \kappa, C_1 :
(\dotsb)\)</span>, where <span class="math inline">\((\dotsb)\)</span>
is an internal statement that filters with respect to <span
class="math inline">\((\kappa,C_1)\)</span>. By idealization, we may
commute quantification over <span class="math inline">\(f\)</span> and
<span class="math inline">\((\kappa,C_1)\)</span>. We arrive at the
equivalent statement <span class="math display">\[\forall^* \tilde{C}_0,
\mu \, \exists^* \kappa, C_1 \,
  \forall f \,
  : \kappa(f) \leqslant\tilde{C}_0(\kappa)
  \implies \mu(f^\wedge) \leqslant C_1.\]</span> By transfer, this is
equivalent to the internal statement obtained by replaced <span
class="math inline">\(\forall^*\)</span> with <span
class="math inline">\(\forall\)</span> and <span
class="math inline">\(\exists^*\)</span> with <span
class="math inline">\(\exists\)</span>: <span
class="math display">\[\forall^* \tilde{C}_0, \mu \, \exists^* \kappa,
C_1 \,
  \forall f \,
  : \kappa(f) \leqslant\tilde{C}_0(\kappa)
  \implies \mu(f^\wedge) \leqslant C_1.\]</span> The function <span
class="math inline">\(\tilde{C}_0\)</span> describes a general bounded
subset <span class="math inline">\(\Omega\)</span> of <span
class="math inline">\(\mathcal{S}(\mathbb{R})\)</span>, so we are left
with the assertion that, for each bounded subset <span
class="math inline">\(\Omega\)</span> of <span
class="math inline">\(\mathcal{S}(\mathbb{R})\)</span> and seminorm
<span class="math inline">\(\mu\)</span> on <span
class="math inline">\(\mathcal{S}(\mathbb{R})\)</span>, there exists
<span class="math inline">\(C_1 \geqslant 0\)</span> so that <span
class="math inline">\(\mu(f^\wedge) \leqslant C_1\)</span> for all <span
class="math inline">\(f \in \Omega\)</span>, which is the content of the
continuity of <span class="math inline">\(f \mapsto
f^\wedge\)</span>. ◻</p>
</div>
<h5 id="overspill">Overspill</h5>
<p>For our purposes, the overspill principle is a theorem of IST <a href="#ref-MR469763"
class="citation" data-cites="MR469763">(E. Nelson 1977, Thm 1.1)</a>
which asserts that any subset of the natural numbers that contains every
fixed natural number must contain some natural number <span
class="math inline">\(n\)</span> that is not fixed, hence for which
<span class="math inline">\(n \ggg 1\)</span>. One verifies in the same
way that any subset of the positive reals that contains every fixed
positive real must contain some positive real of the form <span
class="math inline">\(o(1)\)</span>. These conclusions would fail if we
relaxed “subset” to “subclass” in the sense described above (consider,
e.g., the class of natural numbers of the form <span
class="math inline">\(\operatorname{O}(1)\)</span>), so it is important
to pay attention to what is actually a set rather than merely a class.
We will use this principle primarily for “<span
class="math inline">\(\varepsilon\)</span> clean-up.” A sample
application is given by the lemma below.</p>
<p>The notation <span class="math inline">\(A \ll T^{o(1)}\)</span>
(together with variants, such as <span class="math inline">\(A \ll B
T^{o(1)}\)</span>) will occur frequently. The direct meaning is that
there is a fixed <span class="math inline">\(C \geqslant 0\)</span> and
an <span class="math inline">\(\varepsilon\lll 1\)</span> such that
<span class="math inline">\(|A| \leqslant C T^{\varepsilon}\)</span>. We
will often make use of the following equivalent characterizations:</p>
<div id="lem:overspill-A-vs-T-eps" class="lemma">
<p><strong>Lemma 13</strong>. Let <span class="math inline">\(T\)</span>
be a positive quantity with <span class="math inline">\(T \ggg
1\)</span>. Let <span class="math inline">\(A\)</span> be a scalar. The
following conditions are equivalent.</p>
<ol type="i">
<li><p><span class="math inline">\(|A| \leqslant
T^{o(1)}\)</span>.</p></li>
<li><p><span class="math inline">\(A \ll T^{o(1)}\)</span>.</p></li>
<li><p>For each fixed <span class="math inline">\(\varepsilon&gt;
0\)</span>, we have <span class="math inline">\(A \ll
T^{\varepsilon}\)</span>.</p></li>
</ol>
<p>Under the weaker assumption that <span class="math inline">\(T
\geqslant 1\)</span>, conditions (ii) and (iii) are equivalent.</p>
</div>
<div class="proof">
<p><em>Proof.</em> It is clear that (i) implies (ii) implies (iii).</p>
<p>Assume (iii). We claim first that <span class="math inline">\(|A|
\leqslant T^\varepsilon\)</span> for each fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>. Indeed, our hypothesis
(applied to <span class="math inline">\(\varepsilon/2\)</span>) gives
<span class="math inline">\(A \ll T^{\varepsilon/2}\)</span>; since
<span class="math inline">\(T \ggg 1\)</span>, we have <span
class="math inline">\(T^{\varepsilon/2} \ggg 1\)</span>, and so <span
class="math inline">\(|A| \leqslant T^{\varepsilon}\)</span>, as
required. The claim implies that the set <span
class="math inline">\(\{\varepsilon&gt; 0 : |A| \leqslant
T^{\varepsilon}\}\)</span> contains every fixed <span
class="math inline">\(\varepsilon\)</span>. By overspill, it must
contain some <span class="math inline">\(\varepsilon= o(1)\)</span>.
Thus (i) holds.</p>
<p>Assume now only that <span class="math inline">\(T \geqslant
1\)</span>. If <span class="math inline">\(T \ggg 1\)</span>, then we
see from the above that (ii) and (iii) are equivalent. Otherwise <span
class="math inline">\(T \ll 1\)</span>, and it is easy to see that both
(ii) and (iii) are equivalent to “<span class="math inline">\(A \ll
1\)</span>.” ◻</p>
</div>
<h5 id="sec:furth-notat-conv">§2.1.6. Further notation and conventions</h5>
<p>We conclude with some miscellaneity.</p>
<p>Let <span class="math inline">\(F\)</span> be a fixed local field,
with normalized absolute value <span class="math inline">\(|.| : F
\rightarrow \mathbb{R}_{\geqslant 0}\)</span>. Let <span
class="math inline">\(V\)</span> be a fixed vector space
(finite-dimensional) over <span class="math inline">\(F\)</span>. By a
<em>norm</em> on <span class="math inline">\(V\)</span>, we mean a
continuous function <span class="math inline">\(|.| : V \rightarrow
\mathbb{R}_{&gt;0}\)</span> such that <span class="math inline">\(|v| =
0\)</span> only if <span class="math inline">\(v = 0\)</span>, and <span
class="math inline">\(|t v| = |t|\, |v|\)</span> for all <span
class="math inline">\((t,v) \in F \times  V\)</span>. It is well-known
that for any two fixed norms <span class="math inline">\(|.|_1\)</span>
and <span class="math inline">\(|.|_2\)</span> on <span
class="math inline">\(V\)</span>, we have <span
class="math inline">\(|x|_1 \asymp |x|_2\)</span> for all <span
class="math inline">\(x \in V\)</span>. Given <span
class="math inline">\(x,y \in F\)</span> and a scalar <span
class="math inline">\(t\)</span> (either in <span
class="math inline">\(F\)</span> or complex), we write <span
class="math inline">\(x = y + \operatorname{O}(t)\)</span> to denote
that <span class="math inline">\(|x-y| \ll |t|\)</span> for some
(equivalently, any) fixed norm <span class="math inline">\(|.|\)</span>
on <span class="math inline">\(V\)</span>. We analogously define the
notations <span class="math inline">\(x = y + o(t)\)</span>, <span
class="math inline">\(x \asymp y\)</span>, <span class="math inline">\(x
\ll t\)</span> and <span class="math inline">\(x \lll t\)</span>.</p>
<p>We often write <span class="math inline">\(T\)</span> and <span
class="math inline">\(\mathop{\mathrm{h}}\)</span> for positive
parameters with <span class="math inline">\(T \geqslant 1\)</span> and
<span class="math inline">\(\mathop{\mathrm{h}}\leqslant 1\)</span>;
typically, <span class="math inline">\(T =
1/\mathop{\mathrm{h}}\)</span> and <span class="math inline">\(T \ggg
1\)</span>, or equivalently, <span
class="math inline">\(\mathop{\mathrm{h}}\lll 1\)</span>. We use
notation such as <span class="math inline">\(A \ll B
T^{-\infty}\)</span> or <span class="math inline">\(A =
\operatorname{O}(B T^{-\infty})\)</span> as shorthand for the assertion
that for each fixed <span class="math inline">\(m \geqslant 0\)</span>,
we have <span class="math inline">\(A \ll B T^{-m}\)</span>; more
explicitly, for each fixed <span class="math inline">\(m \geqslant
0\)</span> there is a fixed <span class="math inline">\(C \geqslant
0\)</span> so that <span class="math inline">\(|A| \leqslant C |B|
T^{-m}\)</span>. We analogously define the notation <span
class="math inline">\(A \ll B {\mathop{\mathrm{h}}}^\infty\)</span>.
Similarly, given a subclass <span
class="math inline">\(\mathcal{C}\)</span> of a vector space, we write
<span class="math inline">\(T^{-\infty} \mathcal{C}\)</span> for the
intersection over all fixed <span class="math inline">\(m \geqslant
0\)</span> of the classes <span class="math inline">\(T^{-m}
\mathcal{C}\)</span>. This notation will be used only in situations
where that intersection is descending.</p>
<h4 id="general-notation">General notation</h4>
<p>For a statement <span class="math inline">\(S\)</span>, we define
<span class="math inline">\(1_S\)</span> to be <span
class="math inline">\(1\)</span> if <span
class="math inline">\(S\)</span> is true and <span
class="math inline">\(0\)</span> otherwise. For a set <span
class="math inline">\(X\)</span>, we write <span
class="math inline">\(1_X\)</span> for its characteristic function, thus
<span class="math inline">\(1_X(x)\)</span> is <span
class="math inline">\(1\)</span> or <span
class="math inline">\(0\)</span> according as <span
class="math inline">\(x \in X\)</span> or <span class="math inline">\(x
\notin X\)</span>; equivalently, <span class="math inline">\(1_X(x) :=
1_{x \in X}\)</span>.</p>
<p>We interchangeably write <span class="math inline">\(\# X\)</span>
and <span class="math inline">\(|X|\)</span> for the cardinality of a
set <span class="math inline">\(X\)</span>.</p>
<h4 id="sec:gener-prel">§2.3. General preliminaries</h4>
<h5 id="fields">Fields</h5>
<p>Let <span class="math inline">\(F\)</span> be a local or global
number field (i.e., a local or global field of characteristic zero, the
only case considered here).</p>
<p>In the global case, we write <span
class="math inline">\(\mathbb{A}\)</span> for the adele ring of <span
class="math inline">\(F\)</span> and <span
class="math inline">\(\mathbb{A}_f\)</span> for the subring of finite
adeles. We use the letter <span
class="math inline">\(\mathfrak{p}\)</span> to denote places of <span
class="math inline">\(F\)</span>, possibly archimedean, and denote by
<span class="math inline">\(F_\mathfrak{p}\)</span> the associated
completion. We set <span class="math inline">\(F_\infty := F
\otimes_{\mathbb{Q}} \mathbb{R} = \prod_{\mathfrak{p} | \infty}
F_\mathfrak{p}\)</span>, so <span class="math inline">\(\mathbb{A} =
F_\infty \times \mathbb{A}_f\)</span>. When working over <span
class="math inline">\(F = \mathbb{Q}\)</span>, we write <span
class="math inline">\(p\)</span> for a finite prime.</p>
<p>In the local case, we write <span class="math inline">\(|.| : F
\rightarrow \mathbb{R}_{\geqslant 0}\)</span> for the normalized
absolute value; in the global case, <span class="math inline">\(|.| :
\mathbb{A}^\times / F^\times \rightarrow \mathbb{R}^\times_+\)</span>
denotes the idelic absolute value.</p>
<p>In the local non-archimedean case, we denote by <span
class="math inline">\(\mathfrak{o}\)</span> the ring of integers, by
<span class="math inline">\(\mathfrak{p}\)</span> the maximal ideal, by
<span class="math inline">\(\varpi \in \mathfrak{p}\)</span> a
generator, and <span class="math inline">\(q := \#
\mathfrak{o}/\mathfrak{p}\)</span>.</p>
<h5 id="reductive-groups">Reductive groups</h5>
<p>Let <span class="math inline">\(G\)</span> be a split connected
reductive group over <span class="math inline">\(F\)</span>. The
examples relevant for this paper are when <span
class="math inline">\(G\)</span> is a finite product of general linear
groups (e.g., arising as Levi factors of a given general linear group),
but it will be convenient at times to work more generally – for
instance, some points can be explained most clearly by passing
temporarily to the simpler group <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_2\)</span>.</p>
<p>In the local case, we identify <span class="math inline">\(G\)</span>
with its set of <span class="math inline">\(F\)</span>-points, and
abbreviate <span class="math inline">\(G := G(F)\)</span>. In the global
case, we denote by <span class="math inline">\([G] := G(F) \backslash
G(\mathbb{A})\)</span> the associated adelic quotient.</p>
<p>In the local case, we write <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span> for the Lie
algebra. In the local archimedean case, we write <span
class="math inline">\(\mathfrak{U}(G)\)</span> for the universal
enveloping algebra of the complexification of <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>, and <span
class="math inline">\(\mathfrak{Z}(G)\)</span> for the center of <span
class="math inline">\(\mathfrak{U}(G)\)</span>.</p>
<p>We occasionally take for <span class="math inline">\(G\)</span> a
split connected reductive group over <span
class="math inline">\(\mathbb{Z}\)</span> or over the ring of integers
<span class="math inline">\(\mathfrak{o}\)</span> in a non-archimedean
local field <span class="math inline">\(F\)</span>; in such cases, by
base restriction, we may understand <span
class="math inline">\(G\)</span> as being defined also over <span
class="math inline">\(\mathbb{Q}\)</span> or <span
class="math inline">\(F\)</span>, respectively.</p>
<p>We always assume that <span class="math inline">\(G\)</span> comes
equipped with the following additional data:</p>
<ul>
<li><p>A closed linear embedding <span class="math inline">\(G
\hookrightarrow {\mathop{\mathrm{SL}}}_r\)</span> for some <span
class="math inline">\(r\)</span>.</p></li>
<li><p>A split maximal torus <span class="math inline">\(A\)</span>. We
assume given a basis for its group of rational characters, hence an
identification of <span class="math inline">\(A\)</span> with a product
of copies of <span
class="math inline">\({\mathop{\mathrm{GL}}}_1(F)\)</span>.</p></li>
<li><p>A Borel subgroup <span class="math inline">\(B\)</span> of <span
class="math inline">\(G\)</span>, containing <span
class="math inline">\(A\)</span>, with unipotent radical denoted <span
class="math inline">\(N\)</span>, so that <span class="math inline">\(B
= A N\)</span>.</p></li>
<li><p>Another Borel subgroup <span class="math inline">\(Q = A
U\)</span> containing <span class="math inline">\(A\)</span>, which may
or may not coincide with <span class="math inline">\(B\)</span>. (We
will use <span class="math inline">\(Q\)</span> to define induced
representations, and <span class="math inline">\(N\)</span> to define
Whittaker functions – it will be computationally convenient to keep the
choices of <span class="math inline">\(Q\)</span> and <span
class="math inline">\(B\)</span> decoupled.)</p></li>
<li><p>In the local (resp. global) case, a maximal compact subgroup
<span class="math inline">\(K\)</span> of <span
class="math inline">\(G\)</span> (resp. <span class="math inline">\(K =
\prod_\mathfrak{p} K_\mathfrak{p}\)</span> of <span
class="math inline">\(G(\mathbb{A})\)</span>) in good position relative
to <span class="math inline">\(B\)</span> (resp. <span
class="math inline">\(B(\mathbb{A})\)</span>), so that <span
class="math inline">\(A \cap K\)</span> (resp. <span
class="math inline">\(A(\mathbb{A}) \cap K\)</span>) is a maximal
compact subgroup of <span class="math inline">\(A\)</span> (resp. <span
class="math inline">\(A(\mathbb{A})\)</span>) and the Iwasawa
decomposition <span class="math inline">\(G = B K\)</span> (resp. <span
class="math inline">\(G(\mathbb{A}) = B(\mathbb{A}) K\)</span>) holds
(see <a href="#ref-MR1361168" class="citation" data-cites="MR1361168">(Mœglin and
Waldspurger 1995, 113:I.1.4)</a>, <a href="#ref-GetzHahn" class="citation"
data-cites="GetzHahn">(Getz and Hahn 2021, Thm A.1.1)</a>).</p></li>
<li><p>In the local archimedean case, bases <span
class="math inline">\(\mathcal{B}(A)\)</span> and <span
class="math inline">\(\mathcal{B}(G)\)</span> for <span
class="math inline">\(\mathop{\mathrm{Lie}}(A)\)</span> and <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>,
respectively.</p></li>
</ul>
<p>When <span class="math inline">\(G\)</span> is fixed, we may and
shall assume that all of the above data is fixed, too. We denote by
<span class="math inline">\(Z_G\)</span> the center of <span
class="math inline">\(G\)</span> and by <span
class="math inline">\(W_G\)</span> the Weyl group for <span
class="math inline">\((G,A)\)</span>. When <span
class="math inline">\(G\)</span> is clear from context, we abbreviate
<span class="math inline">\(Z := Z_G\)</span> and <span
class="math inline">\(W := W_G\)</span>.</p>
<p>When working over <span class="math inline">\(\mathbb{R}\)</span>,
<span class="math inline">\(\mathbb{Q}\)</span> or <span
class="math inline">\(\mathbb{Z}\)</span>, we write <span
class="math inline">\(A(\mathbb{R})^0\)</span> for the topologically
connected component of the identity element of <span
class="math inline">\(A(\mathbb{R})\)</span>.</p>
<h5 id="sec:gener-line-groups-1">§2.3.3. General linear groups</h5>
<p>By a <em>general linear group</em> <span
class="math inline">\(G\)</span>, we mean <span class="math inline">\(G
= {\mathop{\mathrm{GL}}}_n\)</span> for some <span class="math inline">\(n
\in \mathbb{Z}_{\geqslant 0}\)</span>. We take the closed embedding
<span class="math inline">\(G \hookrightarrow {\mathop{\mathrm{SL}}}_{2
n}\)</span> given by <span class="math inline">\(g \mapsto
\mathop{\mathrm{diag}}(g, g^{-%
  {\mathpalette\@transpose{}}%
})\)</span>. We assume that <span class="math inline">\(A\)</span> is
the diagonal subgroup and <span class="math inline">\(B\)</span> is the
upper-triangular Borel subgroup. We will take <span
class="math inline">\(U\)</span> to be either <span
class="math inline">\(N\)</span> or its opposite, according to
convenience. It will often be convenient to use the letter “<span
class="math inline">\(n\)</span>” for other purposes (e.g., to denote
elements of the group <span class="math inline">\(N\)</span>) or to be
flexible in the indexing of our general linear groups (e.g., writing
<span class="math inline">\(G = {\mathop{\mathrm{GL}}}_{n+1}\)</span> or
<span class="math inline">\(G = {\mathop{\mathrm{GL}}}_{n-1}\)</span>,
according to convenience). To that end, we will make use of the formulas
<span class="math display">\[\mathop{\mathrm{rank}}(G) = n, \quad
\dim(G) = n^2, \quad
  \dim(N) = n(n+1)/2,\]</span> and so on (with ranks and dimensions
computed over <span class="math inline">\(F\)</span>, unless otherwise
indicated).</p>
<p>By a <em>general linear pair</em> <span
class="math inline">\((G,H)\)</span> over <span
class="math inline">\(F\)</span>, we mean a pair of <span
class="math inline">\(F\)</span>-groups of the form <span
class="math inline">\(({\mathop{\mathrm{GL}}}_{n+1},{\mathop{\mathrm{GL}}}_n)\)</span>
for some natural number <span class="math inline">\(n \in
\mathbb{Z}_{\geqslant 0}\)</span>. We regard <span
class="math inline">\(H\)</span> as being included in <span
class="math inline">\(G\)</span> as the upper left <span
class="math inline">\(n \times n\)</span> block. We denote by <span
class="math inline">\(A_H, B_H, N_H\)</span> the subgroups of <span
class="math inline">\(H\)</span> defined by intersecting the
corresponding subgroups of <span class="math inline">\(G\)</span> with
<span class="math inline">\(H\)</span>. We denote by <span
class="math inline">\(Z_H\)</span> the center of <span
class="math inline">\(H\)</span>. We will take for <span
class="math inline">\(Q_H\)</span> a Borel subgroup of <span
class="math inline">\(H\)</span> containing <span
class="math inline">\(A_H\)</span>, chosen according to convenience, and
denote by <span class="math inline">\(U_H\)</span> its unipotent
radical. We define <span class="math inline">\(\mathfrak{a}_H^*\)</span>
and <span class="math inline">\(\mathfrak{a}_{H,\mathbb{C}}^*\)</span>
in terms of <span class="math inline">\(A_H\)</span> as in <a
href="#eq:frak-a-star-X-A" data-reference-type="eqref"
data-reference="eq:frak-a-star-X-A">\((2.5)\)</a>.</p>
<h5 id="norms">Norms</h5>
<p>In the local case, we define a norm <span
class="math inline">\(\|.\|_G\)</span> on <span
class="math inline">\(G\)</span>, denoted simply <span
class="math inline">\(\|.\|\)</span> when <span
class="math inline">\(G\)</span> is clear from context, by pulling back
the operator norm on the special linear group under the given embedding
<span class="math inline">\(G \hookrightarrow
{\mathop{\mathrm{SL}}}_r\)</span>. In the global case, we define the norm
<span class="math inline">\(\|.\|_{G(\mathbb{A})}\)</span> on <span
class="math inline">\(G(\mathbb{A})\)</span> to be the product <span
class="math inline">\(\|g\|_{G(\mathbb{A})} := \prod_{\mathfrak{p}}
\|g_\mathfrak{p} \|_{G(F_\mathfrak{p})}\)</span> of the corresponding
local norms defined using the induced embeddings <span
class="math inline">\(G(F_\mathfrak{p}) \hookrightarrow
{\mathop{\mathrm{SL}}}_r(F_\mathfrak{p})\)</span>.</p>
<h5 id="sec:haar-measures">§2.3.5. Haar measures</h5>
<p>Since this paper is ultimately concerned with estimates, the choice
of Haar measure is unimportant, provided that we are consistent. We
record a standard choice sufficient for our purposes.</p>
<p>In local and global cases, we equip <span
class="math inline">\(K\)</span> with the Haar probability measure.</p>
<p>In the local case, we assume given Haar measures on <span
class="math inline">\(U\)</span>, <span
class="math inline">\(N\)</span>, <span
class="math inline">\(A\)</span>, <span
class="math inline">\(Z\)</span>. In the non-archimedean case, we assume
that maximal compact subgroups of each of these groups have volume one.
In the archimedean case, we assume only that the given Haar measures are
fixed when <span class="math inline">\(G\)</span> is fixed. We then
equip <span class="math inline">\(G\)</span> with the Haar measure
defined using the Iwasawa decomposition: <span id="eq:int-_g-in-3" class="math display">\[\label{eq:int-_g-in-3}\tag{2.3}
  \int _{g \in G} f(g) \, d g
  = \int _{u \in U}
  \int _{a \in A}
  \int _{k \in K}
  f(u a k)
  \, d k
  \, \frac{d a}{\delta_U(a)}
  \, d u.\]</span> Equivalently, the multiplication map <span
class="math inline">\(A \times U \times K \rightarrow G\)</span> is
measure-preserving. We obtain a quotient measure on <span
class="math inline">\(U \backslash G\)</span>, given by <span id="eq:int-_g-in-U-bakslash-G" class="math display">\[\label{eq:int-_g-in-U-bakslash-G}\tag{2.4}
  \int _{g \in U \backslash G} f(g) \, d g
  =
  \int _{a \in A}
  \int _{k \in K}
  f(a k)
  \, d k
  \, \frac{d a}{\delta_U(a)}.\]</span> These last identities remain
valid with <span class="math inline">\(U\)</span> replaced by <span
class="math inline">\(N\)</span>.</p>
<p>Sometimes, it will be convenient instead to suppose that the
multiplication map <span class="math inline">\(A \times U \times N
\rightarrow G\)</span> is measure-preserving. We will indicate when this
is the case.</p>
<p>In the global case, we choose factorizable Haar measures on <span
class="math inline">\(U(\mathbb{A})\)</span>, <span
class="math inline">\(N(\mathbb{A})\)</span>, <span
class="math inline">\(A(\mathbb{A})\)</span>, <span
class="math inline">\(Z(\mathbb{A})\)</span> and <span
class="math inline">\(K\)</span> so that <span
class="math inline">\([U]\)</span> and <span
class="math inline">\(K\)</span> have volume one. We equip <span
class="math inline">\(G(\mathbb{A})\)</span> with the Haar measure
defined by analogy to <a href="#eq:int-_g-in-3"
data-reference-type="eqref"
data-reference="eq:int-_g-in-3">\((2.3)\)</a>. We fix compatible
factorizations of the Haar measures on each of these groups, so that for
each <span class="math inline">\(\mathfrak{p}\)</span>, the analogue of
<a href="#eq:int-_g-in-3" data-reference-type="eqref"
data-reference="eq:int-_g-in-3">\((2.3)\)</a> for <span
class="math inline">\(G(F_\mathfrak{p})\)</span> is valid and the Haar
measures on the groups <span
class="math inline">\(U(F_\mathfrak{p})\)</span>, <span
class="math inline">\(N(F_\mathfrak{p})\)</span>, <span
class="math inline">\(A(F_\mathfrak{p})\)</span>, <span
class="math inline">\(Z(F_\mathfrak{p})\)</span> and <span
class="math inline">\(K_\mathfrak{p}\)</span> satisfy the desiderata of
the previous paragraph. We equip the discrete groups consisting of
rational points with the counting measure, adelic quotients <span
class="math inline">\([G]\)</span>, <span
class="math inline">\([A]\)</span>, <span
class="math inline">\([Z]\)</span>, etc., with the quotient measure.</p>
<h4 id="characters">Characters</h4>
<p>Given a locally compact abelian group <span
class="math inline">\(V\)</span>, we write <span
class="math inline">\(V^\wedge\)</span> for its Pontryagin dual. This
notation applies in particular when <span
class="math inline">\(F\)</span> is local and <span
class="math inline">\(V\)</span> is a finite-dimensional vector space
over <span class="math inline">\(F\)</span>, in which case <span
class="math inline">\(V^\wedge\)</span> may be regarded as a vector
space over <span class="math inline">\(F\)</span> of the same dimension.
It applies also in the local (resp. global) case to <span
class="math inline">\(A\)</span> (resp. <span
class="math inline">\([A]\)</span>).</p>
<p>We denote <span class="math inline">\(X(A)\)</span> the group of
rational characters <span class="math inline">\(\chi : A \rightarrow
{\mathop{\mathrm{GL}}}_1\)</span>. We set <span id="eq:frak-a-star-X-A" class="math display">\[\label{eq:frak-a-star-X-A}\tag{2.5}
\mathfrak{a}^* := X(A) \otimes_{\mathbb{Z}} \mathbb{R} \hookrightarrow
\mathfrak{a}_{\mathbb{C}}^* := X(A) \otimes_{\mathbb{Z}}
\mathbb{C}.\]</span> We denote by <span
class="math inline">\(\mathfrak{a} \hookrightarrow
\mathfrak{a}_{\mathbb{C}}\)</span> the corresponding dual spaces. For
<span class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span>
and <span class="math inline">\(t \in
\mathfrak{a}_{\mathbb{C}}\)</span>, we denote by <span
class="math inline">\(t(s) = \langle s, t \rangle = \langle t,s  \rangle
\in \mathbb{C}\)</span> the natural pairing.</p>
<p>In the local (resp. global) case, we denote by <span
class="math inline">\(\mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>) the group of
continuous complex-valued characters <span
class="math inline">\(\chi\)</span> of <span
class="math inline">\(A\)</span> (resp. <span
class="math inline">\([A]\)</span>). It is naturally a complex manifold,
locally isomorphic to <span
class="math inline">\(\mathfrak{a}^*_{\mathbb{C}}\)</span>. The subgroup
of unitary characters is <span class="math inline">\(A^\wedge
\leqslant\mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\([A]^\wedge
\leqslant\mathfrak{X}([A])\)</span>).</p>
<p>Each <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span> naturally defines an element <span
class="math inline">\(|.|^s : a \mapsto |a|^s\)</span> of <span
class="math inline">\(\mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>). When <span
class="math inline">\(F = \mathbb{R}\)</span> and <span
class="math inline">\(a \in A(\mathbb{R})^0\)</span>, we abbreviate
<span class="math inline">\(a^s := |a|^s\)</span>. We recall that <span
class="math inline">\(\chi \in \mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>) is <em>unramified</em>
if it is invariant under the maximal compact subgroup of <span
class="math inline">\(A\)</span> (resp. <span
class="math inline">\([A]\)</span>); in that case, <span
class="math inline">\(\chi\)</span> is of the form <span
class="math inline">\(|.|^{s}\)</span> for some <span
class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span> (in the
local non-archimedean case, non-uniquely). We denote by <span
class="math inline">\(\mathfrak{X}^e(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}^e([A])\)</span>) the subgroup
consisting of unramified characters. (The superscript “<span
class="math inline">\(e\)</span>” is motivated by the archimedean case,
where it signifies an “evenness” condition.)</p>
<p>For each element <span class="math inline">\(\chi\)</span> of <span
class="math inline">\(\mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>), there is a unique
element <span class="math inline">\(\Re(\chi) \in
\mathfrak{a}^*\)</span>, called the <em>real part</em> of <span
class="math inline">\(\chi\)</span>, for which <span
class="math inline">\(|\chi| = |.|^{\sigma}\)</span>. Thus <span
class="math inline">\(A^\wedge\)</span> (resp. <span
class="math inline">\([A]^\wedge\)</span>) consists of all <span
class="math inline">\(\chi\)</span> with <span
class="math inline">\(\Re(\chi) = 0\)</span>.</p>
<p>We equip <span class="math inline">\(A^\wedge\)</span> (resp. <span
class="math inline">\([A]^\wedge\)</span>) with the Haar measure <span
class="math inline">\(d \chi\)</span> dual to the Haar measure <span
class="math inline">\(d a\)</span> on <span
class="math inline">\(A\)</span> (resp. <span
class="math inline">\([A]\)</span>). For each <span
class="math inline">\(\sigma \in \mathfrak{a}^*\)</span>, the “vertical”
subset consisting of <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>) with <span
class="math inline">\(\Re(\chi) = \sigma\)</span> is a coset of <span
class="math inline">\(A^\wedge\)</span> (resp. <span
class="math inline">\([A]^\wedge\)</span>); we equip it with the Haar
measure <span class="math inline">\(d \chi\)</span> obtained by
transporting that on the latter group. For a function <span
class="math inline">\(f\)</span> on <span
class="math inline">\(\mathfrak{X}^e(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}^e([A])\)</span>), we denote by <span id="eq:int-_sigma-fs" class="math display">\[\label{eq:int-_sigma-fs}\tag{2.6}
  \int _{(\sigma)} f(s) \, d \mu_A(s)\]</span> the integral of <span
class="math inline">\(f(\chi) \, d \chi\)</span> over <span
class="math inline">\(\chi\)</span> in <span
class="math inline">\(\mathfrak{X}^e(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}^e([A])\)</span>) of real part <span
class="math inline">\(\sigma\)</span>.</p>
<p>We denote by <span class="math inline">\(R\)</span> the set of roots
for <span class="math inline">\((G,A)\)</span>, by <span
class="math inline">\(R_U^+\)</span> (resp. <span
class="math inline">\(R_N^+\)</span>) the subset of positive roots
relative to <span class="math inline">\(U\)</span> (resp. <span
class="math inline">\(N\)</span>), and <span
class="math inline">\(\Delta_U\)</span> (resp. <span
class="math inline">\(\Delta_N\)</span>) the associated set of simple
roots. For <span class="math inline">\(\alpha \in R\)</span>, we denote
by <span class="math inline">\(\alpha^\vee \in \mathfrak{a}^*\)</span>
the corresponding coroot.</p>
<p>We say that <span class="math inline">\(\sigma \in
\mathfrak{a}^*\)</span> is <em>dominant</em> if it is dominant in the
sense defined by <span class="math inline">\(U\)</span>, i.e., if for
each <span class="math inline">\(\alpha \in R_U^+\)</span>, we have
<span class="math inline">\(\alpha^\vee(s) \geqslant 0\)</span>. We say
that <span class="math inline">\(\sigma\)</span> is <em>strictly
dominant</em> if the stronger condition <span
class="math inline">\(\alpha^\vee(s) &gt; 0\)</span> holds for all such
<span class="math inline">\(\alpha\)</span>. Given <span
class="math inline">\(\sigma_1, \sigma_2 \in \mathfrak{a}^*\)</span>, we
write <span class="math display">\[\sigma_1 \prec \sigma_2 \quad \text{
or } \quad \sigma_2 \succ \sigma_1\]</span> to denote that the
difference <span class="math inline">\(\sigma_2 - \sigma_1\)</span> is
strictly dominant.</p>
<p>(When we wish to speak of dominance relative to <span
class="math inline">\(N\)</span>, we write more verbosely “<span
class="math inline">\(N\)</span>-dominant,” but this will rarely happen
except when <span class="math inline">\(N = U\)</span>.)</p>
<p>We denote by <span class="math inline">\(\delta_U, \delta_N \in
\mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>) the modulus characters
attached to <span class="math inline">\(Q = A U\)</span> and <span
class="math inline">\(B = A N\)</span>, respectively. We write <span
class="math inline">\(\rho_U, \rho_N \in \mathfrak{a}^*\)</span> for the
elements characterized by the identities <span
class="math inline">\(\delta_U = |.|^{2 \rho_U}\)</span>, <span
class="math inline">\(\delta_N = |.|^{2 \rho_N}\)</span>. Then <span
class="math inline">\(\rho_U = (1/2) \sum_{\alpha \in R_U^+}
\alpha\)</span>, and similarly for <span
class="math inline">\(\rho_N\)</span>. We set <span
class="math inline">\(\rho_U^\vee := (1/2) \sum_{\alpha \in R_U^+}
\alpha^\vee\)</span>, and define <span
class="math inline">\(\rho_N^\vee\)</span> analogously.</p>
<h4 id="quotients-and-actions">Quotients and actions</h4>
<p>Let <span class="math inline">\(P\)</span> be a parabolic subgroup of
<span class="math inline">\(G\)</span> that contains <span
class="math inline">\(A\)</span>. We may write <span
class="math inline">\(P = M_P U_P\)</span>, where <span
class="math inline">\(U_P\)</span> is the unipotent radical of <span
class="math inline">\(P\)</span> and <span
class="math inline">\(M_P\)</span> is the unique Levi factor that
contains <span class="math inline">\(A\)</span>. In the local case, we
may form the quotient <span class="math inline">\(U_P \backslash
G\)</span>. In the global case, we define <span
class="math display">\[_P := P(F) U_P(\mathbb{A}) \backslash
G(\mathbb{A}).\]</span> We will be almost exclusively concerned with the
special cases <span class="math inline">\(P = G\)</span> and <span
class="math inline">\(P = Q\)</span>. We note that, in the global case,
<span class="math inline">\([G]_G = [G]\)</span> and <span
class="math inline">\([G]_Q = Q(F) U(\mathbb{A}) \backslash
G(\mathbb{A}) = A(F) U(\mathbb{A}) \backslash
G(\mathbb{A})\)</span>.</p>
<p>In the local (resp. global) case, given a complex-valued function
<span class="math inline">\(f\)</span> on <span
class="math inline">\(U_P \backslash G\)</span> (resp. <span
class="math inline">\([G]_P\)</span>) and <span class="math inline">\(g
\in G\)</span>, we denote by <span class="math inline">\(R(g) f\)</span>
the function on the same space obtained via right translation: <span
class="math display">\[R(g) f(x) := f(x g).\]</span> The spaces <span
class="math inline">\(U \backslash G\)</span> (resp. <span
class="math inline">\([G]_Q\)</span>) admit natural left action by <span
class="math inline">\(A\)</span> (resp. <span
class="math inline">\([A]\)</span>), and we denote by <span
class="math inline">\(L\)</span> the associated normalized action on
function spaces, namely, for <span class="math inline">\(a \in
A\)</span> (resp. <span class="math inline">\([A]\)</span>), <span id="eq:normalized-left-translation" class="math display">\[\label{eq:normalized-left-translation}\tag{2.7}
  L(a) f(x) :=
  \delta_U^{-1/2}(a)
  f(a x).\]</span> In the local archimedean case, we denote also simply
by <span class="math inline">\(R\)</span> (resp. <span
class="math inline">\(L\)</span>) the induced actions of <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span> and <span
class="math inline">\(\mathfrak{U}(G)\)</span> (resp. <span
class="math inline">\(\mathop{\mathrm{Lie}}(A)\)</span> and <span
class="math inline">\(\mathfrak{U}(A)\)</span>) on the corresponding
space of smooth functions. In the global setting, we use similar
notation for the differential actions induced by <span
class="math inline">\(G(F_\infty)\)</span> and <span
class="math inline">\(A(F_\infty)\)</span>.</p>
<h4 id="sec:schwartz-spaces">§2.6. Schwartz spaces</h4>
<p>We refer to Casselman <a href="#ref-MR1001613" class="citation"
data-cites="MR1001613">(Casselman 1989)</a> and the thesis of Moore
<a href="#ref-MooreOSU2018" class="citation" data-cites="MooreOSU2018">(Moore 2018)</a> for
background, although we note that in non-archimedean aspects, we do not
adopt the same definitions as the latter reference.</p>
<p>Continue to let <span class="math inline">\(P = M_P U_P\)</span> be a
parabolic containing <span class="math inline">\(A\)</span>.</p>
<p>Recall that in the local (resp. global) case, we have defined a norm
<span class="math inline">\(\|.\|\)</span> on <span
class="math inline">\(G\)</span> (resp. <span
class="math inline">\(G(\mathbb{A})\)</span>). In the local case, we
define a norm on <span class="math inline">\(U_P \backslash G\)</span>
by <span class="math display">\[\|g\|_{U_P \backslash G} := \inf_{u \in
U_P} \|u g\|.\]</span> In the global case, we define a norm on <span
class="math inline">\([G]_P\)</span>, hence on <span
class="math inline">\([G]_Q\)</span> and <span
class="math inline">\([G]\)</span>, by <span id="eq:g_g-:=-inf_gamma" class="math display">\[\label{eq:g_g-:=-inf_gamma}\tag{2.8}
  \|g\|_{[G]_P} := \inf_{h \in P(F) U_P(\mathbb{A})} \|h
g\|,\]</span></p>
<p>Suppose for the moment that <span class="math inline">\(F\)</span> is
fixed (or that <span class="math inline">\(F\)</span> is non-archimedean
local and “everything is unramified”). In the local case, for <span
class="math inline">\(g = u a k\)</span> with <span
class="math inline">\((u,a,k) \in U \times A \times K\)</span>, we then
have <span class="math inline">\(\|g\|_{U \backslash G} \asymp
\|a\|\)</span>. In the global case, we have under analogous hypotheses
<span class="math display">\[\|g\| _{[G]_Q} \asymp \|a\|_{[A]} :=
\inf_{h \in A(F)} \|h a\|.\]</span> (The proofs of these estimates may
be reduced, via the given linear embedding of <span
class="math inline">\(G\)</span>, to the case <span
class="math inline">\(G = {\mathop{\mathrm{GL}}}_n\)</span>, where they
may be verified directly.)</p>
<p>Suppose for the moment that <span class="math inline">\(F\)</span> is
local. We define the Schwartz space <span
class="math inline">\(\mathcal{S}(U_P \backslash G)\)</span> as follows.
In the non-archimedean case, it consists of locally constant
compactly-supported functions <span class="math inline">\(f : U_P
\backslash G \rightarrow \mathbb{C}\)</span>. In the archimedean case,
it consists of smooth functions satisfying, for all <span
class="math inline">\(x \in \mathfrak{U}(G)\)</span> and <span
class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span>, <span
class="math display">\[\sup_{g \in U_P \backslash G} \|g\|_{U_P
\backslash G}^m | R(x) f(a) | &lt; \infty.\]</span> In particular, by
specializing to <span class="math inline">\(P = G\)</span> and <span
class="math inline">\(P = Q\)</span>, we obtain definitions of <span
class="math inline">\(\mathcal{S}(G)\)</span> and <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span>.</p>
<p>In the global case, we define the Schwartz space <span
class="math inline">\(\mathcal{S}([G]_P)\)</span> to be the union, over
all open subgroups <span class="math inline">\(J\)</span> of <span
class="math inline">\(G(\mathbb{A}_f)\)</span>, of the space of smooth
functions <span class="math inline">\(f : [G]_P \rightarrow
\mathbb{C}\)</span> that are right-invariant under <span
class="math inline">\(J\)</span> and satisfy, for each <span
class="math inline">\(m \geqslant 0\)</span> and <span
class="math inline">\(x \in \mathfrak{U}(G(F_\infty))\)</span>, <span
class="math display">\[\sup_{g \in [G]_P} \|g\|_{[G]_P}^m |R(x) f(g)|
&lt; \infty.\]</span> In particular, we obtain definitions of <span
class="math inline">\(\mathcal{S}([G])\)</span> and <span
class="math inline">\(\mathcal{S}([G]_Q)\)</span>.</p>
<p>In the local (resp. global) case, the space <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> (resp. <span
class="math inline">\(\mathcal{S}([G]_Q)\)</span>) admits a natural left
action by <span class="math inline">\(A\)</span> (resp. <span
class="math inline">\([A]\)</span>). We denote by <span
class="math inline">\(\mathcal{S}^e(U \backslash G)\)</span> (resp.
<span class="math inline">\(\mathcal{S}^e([G]_Q)\)</span>) the subspaces
consisting of elements that are <em>left-unramified</em>, i.e.,
left-invariant under the maximal compact subgroup of <span
class="math inline">\(A\)</span> (resp. <span
class="math inline">\([A]\)</span>).</p>
<p>All of the above definitions apply in particular to <span
class="math inline">\(G = A\)</span>. In particular, in the local case,
we may define the Schwartz space <span
class="math inline">\(\mathcal{S}(A)\)</span> and its subspace <span
class="math inline">\(\mathcal{S}^e(A)\)</span> consisting of elements
invariant under the maximal compact subgroup.</p>
<p>In the global case, we define the space <span
class="math inline">\(\mathcal{T}([G]_P)\)</span> of functions of
uniform moderate growth to be the union, over <span
class="math inline">\(d \in \mathbb{Z}_{\geqslant 0}\)</span> and open
subgroups <span class="math inline">\(J\)</span> of <span
class="math inline">\(G(\mathbb{A}_f)\)</span>, of the space of smooth
functions <span class="math inline">\(f : [G]_P \rightarrow
\mathbb{C}\)</span> that are right-invariant by <span
class="math inline">\(J\)</span> and satisfy, for each <span
class="math inline">\(x \in \mathfrak{U}(G(F_\infty))\)</span>, <span
class="math display">\[\sup_{g \in [G]_P} \|g\|^{-d}_{[G]_P} | R(x)
\varphi(g)| &lt; \infty.\]</span></p>
<p>Each of the function spaces just defined is naturally a
Fr<span>é</span>chet space in the local archimedean case and an
inductive limit of Fr<span>é</span>chet spaces otherwise.</p>
<h4 id="sec:induc-repr">§2.7. Principal series representations</h4>
<p>In the local (resp. global) case, for <span
class="math inline">\(\chi \in \mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>), we denote by <span
class="math display">\[\mathcal{I}(\chi) =
{\mathop{\mathrm{Ind}}}_Q^G(\chi) \subseteq C^\infty(U \backslash G)
  \quad
  \text{
    (resp. $\mathcal{I}(\chi) =
{\mathop{\mathrm{Ind}}}_{Q(\mathbb{A})}^{G(\mathbb{A})}(\chi) \subseteq
C^\infty([G]_Q)$)
  }\]</span> the corresponding normalized principal series
representation, consisting of smooth complex-valued functions <span
class="math inline">\(f\)</span> on <span
class="math inline">\(G\)</span> (resp. <span
class="math inline">\(G(\mathbb{A})\)</span>) satisfying <span
class="math inline">\(f(u a g) = \delta_U^{1/2}(a) \chi(a) f(g)\)</span>
for all <span class="math inline">\((u,a,g)\)</span> in <span
class="math inline">\(U \times A \times G\)</span> (resp. <span
class="math inline">\(U(\mathbb{A}) \times A(\mathbb{A}) \times
G(\mathbb{A})\)</span>). Here “smooth” carries the following
convention:</p>
<ul>
<li><p>In the archimedean case, it means that all derivatives
(left-invariant, say) exist.</p></li>
<li><p>In the non-archimedean (resp. global) case, it means that there
is an open subgroup <span class="math inline">\(J\)</span> of <span
class="math inline">\(G\)</span> (resp. of <span
class="math inline">\(G(\mathbb{A}_f)\)</span>) under which <span
class="math inline">\(f\)</span> is right-invariant.</p></li>
</ul>
<p>In the global case, for a prime <span
class="math inline">\(\mathfrak{p}\)</span> of <span
class="math inline">\(F\)</span>, we denote by <span
class="math inline">\(\chi_\mathfrak{p}\)</span> the local component of
<span class="math inline">\(\chi\)</span> at <span
class="math inline">\(\mathfrak{p}\)</span> and by <span
class="math inline">\(I_\mathfrak{p}(\chi_\mathfrak{p})\)</span> (or
simply <span
class="math inline">\(\mathcal{I}_\mathfrak{p}(\chi)\)</span>) the
corresponding principal series representation of <span
class="math inline">\(G(F_\mathfrak{p})\)</span>; then <span
class="math inline">\(\mathcal{I}(\chi)\)</span> identifies naturally
with the restricted tensor product of the <span
class="math inline">\(\mathcal{I}_\mathfrak{p}(\chi_\mathfrak{p})\)</span>,
restricted with respect to the spherical elements taking the value <span
class="math inline">\(1\)</span> at the identity.</p>
<p>An invariant pairing between <span
class="math inline">\(\mathcal{I}(\chi)\)</span> and <span
class="math inline">\(\mathcal{I}(\chi^{-1})\)</span> is given by <span
class="math inline">\((f_1,f_2) \mapsto \int_{K} f_1 f_2\)</span>. In
the local case, up to a constant factor depending upon measure
normalizations, this coincides with the pairing given by <span
class="math inline">\(\int_N f_1 f_2\)</span>.</p>
<p>We denote by <span class="math inline">\(\|.\|\)</span> the norm on
<span class="math inline">\(\mathcal{I}(\chi)\)</span> given by <span
class="math inline">\(\|f\|^2 := \int _{K} |f|^2\)</span>, which is
invariant when <span class="math inline">\(\Re(\chi) = 0\)</span>.</p>
<p>When <span class="math inline">\(\chi\)</span> is unramified, i.e.,
<span class="math inline">\(\chi = |.|^s\)</span> for some <span
class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span>, we
often write simply <span class="math display">\[\mathcal{I}(s) :=
\mathcal{I}(|.|^s)\]</span> in both local and global cases. (This
notational abbreviation has the potential to introduce confusion –
should <span class="math inline">\(\mathcal{I}(1)\)</span> denote the
induction of the trivial character <span class="math inline">\(1 =
|.|^0\)</span>, or that of <span class="math inline">\(|.|^1\)</span>? –
so we will be careful when using it.)</p>
<h4 id="sec:mell-analys-paley">§2.8. Mellin analysis and Paley–Wiener
theory</h4>
<h5 id="warm-up">Warm-up</h5>
<p>We briefly recall the case of the real line. We say that a
holomorphic function <span class="math inline">\(\tilde{f} : \mathbb{C}
\rightarrow \mathbb{C}\)</span> has <em>rapid vertical decay</em> if for
each finite interval <span class="math inline">\([a,b] \subset
\mathbb{R}\)</span> and <span class="math inline">\(m \geqslant
0\)</span>, the quantity <span id="eq:sup_s-in-mathbbc" class="math display">\[\label{eq:sup_s-in-mathbbc}\tag{2.9}
  \sup_{s \in \mathbb{C} : \Re(s) \in [a,b]}
  (1 + |s|)^m |\tilde{f}|(s)\]</span> is finite. The Schwartz space
<span class="math inline">\(\mathcal{S}(\mathbb{R}^\times_+)\)</span> is
defined to consist of all smooth <span class="math inline">\(f :
\mathbb{R}^\times_+ \rightarrow \mathbb{C}\)</span> with the property
that for each <span class="math inline">\(m, k \geqslant 0\)</span>, we
have <span id="eq:sup_y-in-mathbbrt" class="math display">\[\label{eq:sup_y-in-mathbbrt}\tag{2.10}
  \sup_{y \in \mathbb{R}^\times_+} (y + y^{-1})^m \left\lvert \left( y
\frac{d}{d y} \right)^k f(y) \right\rvert &lt; \infty.\]</span> For each
<span class="math inline">\(f \in
\mathcal{S}(\mathbb{R}^\times_+)\)</span>, the Mellin transform <span
class="math inline">\(\tilde{f}(s) := \int _{y \in \mathbb{R}^\times_+}
f(y) y^{-s} \, d^\times y\)</span>, where <span
class="math inline">\(d^\times y := \frac{d y}{y}\)</span>, converges
absolutely, and defines a holomorphic function <span
class="math inline">\(\tilde{f}\)</span> of rapid vertical decay;
conversely, every such function <span
class="math inline">\(\tilde{f}\)</span> arises in this way. Moreover,
the topology on <span
class="math inline">\(\mathcal{S}(\mathbb{R}^\times_+)\)</span>, as
described by the seminorms <a href="#eq:sup_y-in-mathbbrt"
data-reference-type="eqref"
data-reference="eq:sup_y-in-mathbbrt">\((2.10)\)</a>, is
equivalent to the topology described by the seminorms <a
href="#eq:sup_s-in-mathbbc" data-reference-type="eqref"
data-reference="eq:sup_s-in-mathbbc">\((2.9)\)</a>. Finally,
we have <span class="math display">\[\int  _{y \in \mathbb{R}^\times_+}
|f(y)|^2 \, d^\times y
  =
  \int _{\Re(s) = 0} \left\lvert \tilde{f}(s) \right\rvert^2 \, \frac{d
s}{2 \pi i }.\]</span></p>
<p>The above assertions summarize parts of classical Paley–Wiener
theory, expressed in terms of the Mellin transform. The proofs consist
of elementary complex analysis. A similar theory relates decay
properties of functions <span class="math inline">\(f : \mathbb{Z}
\rightarrow \mathbb{C}\)</span> to the regularity of the associated
Laurent series <span class="math inline">\(\tilde{f}(z) = \sum_{n \in
\mathbb{Z}} f(n) z^n\)</span>.</p>
<p>We temporarily drop the general notation of §<a
href="#sec:preliminaries" data-reference-type="ref"
data-reference="sec:preliminaries">2</a>. In §<a href="#sec:tori"
data-reference-type="ref" data-reference="sec:tori">2.8.2</a> and §<a
href="#sec:mellin-paley-affine-quotients" data-reference-type="ref"
data-reference="sec:mellin-paley-affine-quotients">2.8.3</a>, we
consider groups <span class="math inline">\(A\)</span> acting on spaces
<span class="math inline">\(X\)</span> with the following
properties:</p>
<ul>
<li><p><span class="math inline">\(A\)</span> is isomorphic <span
class="math inline">\(\mathbb{R}^{n_1} \times \mathbb{Z}^{n_2} \times
\Gamma\)</span> for some <span class="math inline">\(n_1, n_2 \geqslant
0\)</span> and some profinite group <span
class="math inline">\(\Gamma\)</span>.</p></li>
<li><p>There is a compact group <span class="math inline">\(K\)</span>
and a surjective <span class="math inline">\(A\)</span>-equivariant
homomorphism <span class="math inline">\(A \times K \rightarrow
X\)</span> with compact kernel.</p></li>
</ul>
<p>In each case, we describe a form of Paley–Wiener theory for the
action of <span class="math inline">\(A\)</span> on certain function
spaces on <span class="math inline">\(X\)</span>. The proofs remain
elementary. Analogous results appear throughout <a href="#ref-MR1361168" class="citation"
data-cites="MR1361168">(Mœglin and Waldspurger 1995,
113:II.1)</a>.</p>
<h5 id="sec:tori">§2.8.2. Tori</h5>
<p>We now return to the general thread of §<a href="#sec:preliminaries"
data-reference-type="ref" data-reference="sec:preliminaries">2</a>. When
<span class="math inline">\(F\)</span> is archimedean, we use the given
linear embedding of <span class="math inline">\(G\)</span> to equip the
real Lie group <span
class="math inline">\(\mathop{\mathrm{Lie}}(A)\)</span>, hence its real
dual <span class="math inline">\(\mathop{\mathrm{Lie}}(A)^*\)</span>,
with a <span class="math inline">\(W\)</span>-invariant norm <span
class="math inline">\(\|.\|\)</span>. We denote by <span
class="math inline">\(d \chi \in \mathop{\mathrm{Lie}}(A)^*\)</span> the
differential at the identity of a character <span
class="math inline">\(\chi \in \mathfrak{X}(A)\)</span>, and define the
analytic conductor <span class="math inline">\(C(\chi) := 3 + \|d
\chi\|\)</span>. (It is easy to see that this definition is comparable
to the “standard” one, obtained by identifying <span
class="math inline">\(A\)</span> with a product of copies of <span
class="math inline">\({\mathop{\mathrm{GL}}}_1(F)\)</span>, hence <span
class="math inline">\(\chi\)</span> with a tuple of characters <span
class="math inline">\(\chi_j\)</span> of <span
class="math inline">\(F^\times\)</span>, and multiplying together the
analogous conductors of the <span class="math inline">\(\chi_j\)</span>
as defined in §<a href="#ref-michel-2009" class="citation" data-cites="michel-2009">(Philippe
Michel and Venkatesh 2010, sec. 3.1.8)</a>.)</p>
<p>We consider here the local case, which is all that we require. We say
that a complex-valued holomorphic function <span
class="math inline">\(\tilde{f}\)</span> on <span
class="math inline">\(\mathfrak{X}(A)\)</span> has <em>rapid vertical
decay</em> if</p>
<ol type="i">
<li><p>in the non-archimedean case, there is an open subgroup <span
class="math inline">\(J\)</span> of <span
class="math inline">\(A\)</span> so that <span
class="math inline">\(\tilde{f}(\chi) = 0\)</span> unless <span
class="math inline">\(\chi|_J\)</span> is trivial, and</p></li>
<li><p>in the archimedean case, for each compact subset <span
class="math inline">\(\mathcal{D} \subseteq \mathfrak{a}^*\)</span> and
<span class="math inline">\(m \geqslant 0\)</span>, the supremum <span id="eq:sup_chi-in-mathfr" class="math display">\[\label{eq:sup_chi-in-mathfr}\tag{2.11}
    \sup_{
      \substack{
        \chi \in \mathfrak{X}([A]) :
        \\
          \Re(\chi) \in \mathcal{D}
      }
    }
    C(\chi)^m
    |\tilde{f}(\chi)|\]</span> is finite.</p></li>
</ol>
<p>For <span class="math inline">\(f \in \mathcal{S}(A)\)</span>, the
Mellin transform <span class="math inline">\(\tilde{f}(\chi) := \int _{a
\in A} f(\chi) \chi^{-1}(a) \, d a\)</span> converges absolutely, and
defines a holomorphic function <span class="math inline">\(\tilde{f} :
\mathfrak{X}(A) \rightarrow \mathbb{C}\)</span> of rapid decay;
conversely, every such function <span
class="math inline">\(\tilde{f}\)</span> arises in this way. In the
archimedean case, the topology on <span
class="math inline">\(\mathcal{S}(A)\)</span> is the same as that
defined by the seminorms <a href="#eq:sup_chi-in-mathfr"
data-reference-type="eqref"
data-reference="eq:sup_chi-in-mathfr">\((2.11)\)</a>.</p>
<p>We have <span class="math inline">\(f \in \mathcal{S}^e(A)\)</span>
if and only if <span class="math inline">\(\tilde{f}\)</span> is
supported on <span class="math inline">\(\mathfrak{X}^e(A)\)</span>. In
that case, <span class="math inline">\(\tilde{f}\)</span> is described
entirely by the numbers <span class="math display">\[\tilde{f}(s) :=
\tilde{f}(|.|^s).\]</span> (We will be careful in using such notation
for the same reasons as indicated at the end of §<a
href="#sec:induc-repr" data-reference-type="ref"
data-reference="sec:induc-repr">2.7</a>.)</p>
<h5 id="sec:mellin-paley-affine-quotients">§2.8.3. Affine quotients</h5>
<p>In the local (resp. global) case, let <span
class="math inline">\(E\)</span> be an open subset of <span
class="math inline">\(\mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>). By a <em>holomorphic
family <span class="math inline">\(\{f[\chi]\}_{\chi \in E}\)</span> of
vectors <span class="math inline">\(f[\chi] \in
\mathcal{I}(\chi)\)</span></em>, we mean a family of such vectors that
arises as the pointwise specialization <span
class="math inline">\(f[\chi](g) := f(\chi,g)\)</span> of some
complex-valued function <span class="math inline">\(f\)</span> on <span
class="math inline">\(E \times U \backslash G\)</span> (resp. <span
class="math inline">\(E \times [G]_Q\)</span>) that is holomorphic in
the first variable and smooth in the second variable, where “smooth”
follows the same convention as in §<a href="#sec:induc-repr"
data-reference-type="ref" data-reference="sec:induc-repr">2.7</a>, with
the subgroup <span class="math inline">\(J\)</span> taken independent of
the first argument. This definition applies in particular when <span
class="math inline">\(E\)</span> is the full character group <span
class="math inline">\(\mathfrak{X}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{X}([A])\)</span>), in which case we
write simply “holomorphic family <span
class="math inline">\(\{f[\chi]\}\)</span>.”</p>
<p>We say that a holomorphic family <span
class="math inline">\(\{f[\chi]\}\)</span> has <em>rapid vertical
decay</em> if</p>
<ul>
<li><p>in the non-archimedean local case, there is an open subgroup
<span class="math inline">\(J\)</span> of <span
class="math inline">\(A\)</span> so that <span
class="math inline">\(f[\chi] = 0\)</span> unless <span
class="math inline">\(\chi|_J\)</span> is trivial,</p></li>
<li><p>in the archimedean local case, for each compact subset <span
class="math inline">\(\mathcal{D} \subseteq \mathfrak{a}^*\)</span>,
<span class="math inline">\(m \geqslant 0\)</span>, and <span
class="math inline">\(x \in \mathfrak{U}(G)\)</span>, the supremum <span id="eq:sup_chi-in-mathfr-1" class="math display">\[\label{eq:sup_chi-in-mathfr-1}\tag{2.12}
    \sup_{
      \substack{
        \chi \in \mathfrak{X}(A) :  \\
         \Re(\chi) \in \mathcal{D}
      }
    } C(\chi_\infty)^m \sup_{k \in K} |R(x) f[\chi](k)|\]</span> is
finite, and</p></li>
<li><p>in the global case, there is an open subgroup <span
class="math inline">\(J\)</span> of <span
class="math inline">\(A(\mathbb{A}_f)\)</span> so that <span
class="math inline">\(f[\chi] = 0\)</span> unless <span
class="math inline">\(\chi|_J\)</span> is trivial, and for each compact
subset <span class="math inline">\(\mathcal{D} \subseteq
\mathfrak{a}^*\)</span>, <span class="math inline">\(m \geqslant
0\)</span> and <span class="math inline">\(x \in
\mathfrak{U}(G(F_\infty))\)</span>, the supremum <span id="eq:sup_-substack-chi" class="math display">\[\label{eq:sup_-substack-chi}\tag{2.13}
    \sup_{
      \substack{
        \chi \in \mathfrak{X}([A]) :  \\
          \Re(\chi) \in \mathcal{D}
      }
    }  C(\chi)^m \sup_{k \in K} |R(x) f[\chi](k)|\]</span> is
finite.</p></li>
</ul>
<p>We note that in the archimedean local and global cases, replacing
<span class="math inline">\(\sup_{k \in K} |R(x) f[\chi](k)|\)</span>
with <span class="math inline">\(\|R(x) f[\chi] \|\)</span> yields the
same definition, thanks to the Sobolev lemma for <span
class="math inline">\(K\)</span>. We note also that the vanishing
conditions imposed on <span class="math inline">\(f[\chi]\)</span> in
the non-archimedean local and global cases can be seen to follow from
our definition of “holomorphic family”; we have stated it, redundantly,
for emphasis.</p>
<p>In the local (resp. global) case, given <span class="math inline">\(f
\in \mathcal{S}(U \backslash G)\)</span> (resp. <span
class="math inline">\(\mathcal{S}([G]_Q)\)</span>), we define the Mellin
components <span class="math inline">\(f[\chi] \in
\mathcal{I}(\chi)\)</span> by the absolutely convergent integrals <span
class="math display">\[f[\chi](g) := \int \delta_U^{1/2}(a)  \chi(a)
f(a^{-1} g) \, d a\]</span> taken over <span class="math inline">\(a \in
A\)</span> (resp. <span class="math inline">\([A]\)</span>). These
integrals define a holomorphic family of vectors, of rapid vertical
decay; conversely, every such family arises in this way. In the
archimedean local (resp. global) case, the topology on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> (resp. <span
class="math inline">\(\mathcal{S}([G]_Q)\)</span>) is described by the
family of seminorms <a href="#eq:sup_chi-in-mathfr-1"
data-reference-type="eqref"
data-reference="eq:sup_chi-in-mathfr-1">\((2.12)\)</a>
(resp. <a href="#eq:sup_-substack-chi" data-reference-type="eqref"
data-reference="eq:sup_-substack-chi">\((2.13)\)</a>).</p>
<p>We have for each <span class="math inline">\(\sigma \in
\mathfrak{a}^*\)</span> the Mellin decomposition <span id="eq:f-=-int" class="math display">\[\label{eq:f-=-int}\tag{2.14}
  f = \int _{(\sigma)} f[\chi] \, d \chi.\]</span> When <span
class="math inline">\(\sigma = 0\)</span>, this extends to a
decomposition of <span class="math inline">\(L^2(U \backslash
G)\)</span> (resp. <span class="math inline">\(L^2([G]_Q)\)</span>) as
the direct integral of the <span
class="math inline">\(\mathcal{I}(\chi)\)</span> with <span
class="math inline">\(\Re(\chi) = 0\)</span> (cf. <a href="#ref-MR3468638" class="citation"
data-cites="MR3468638">(Gelfand, Graev, and Pyatetskii-Shapiro 2016,
sec. 3.4.9, §3.5.2)</a>). In particular, for <span
class="math inline">\(f_1, f_2 \in \mathcal{S}(U \backslash G)\)</span>
(resp. <span class="math inline">\(\mathcal{S}([G]_Q)\)</span>), we have
the Parseval formula <span id="eq:leftlangle-f_1-f_2" class="math display">\[\label{eq:leftlangle-f_1-f_2}\tag{2.15}
  \left\langle f_1, f_2 \right\rangle
  =
  \int _{(0)}
  \left\langle f_1[\chi], f_2[\chi] \right\rangle \, d
\chi.\]</span></p>
<p>If <span class="math inline">\(f \in \mathcal{S}^e(U \backslash
G)\)</span> (resp. <span
class="math inline">\(\mathcal{S}^e([G]_Q)\)</span>), then <span
class="math inline">\(f[\chi] = 0\)</span> unless <span
class="math inline">\(\chi\)</span> is unramified, and so <span
class="math inline">\(f\)</span> is again described by the vectors <span
class="math display">\[f[s] := f[|.|^s] \in
  \mathcal{I}(s) := \mathcal{I} (|.|^s).\]</span></p>
<h4 id="sec:local-sobolev-norms-prelims">§2.9. Sobolev norms</h4>
<p>Here we restrict to the local archimedean case. The topology on <span
class="math inline">\(\mathcal{S}^e(U \backslash G)\)</span> is
described by the following family of seminorms, indexed by compact
subsets <span class="math inline">\(\mathcal{D} \subseteq
\mathfrak{a}^*\)</span> and <span class="math inline">\(\ell \in
\mathbb{Z}_{\geqslant 0}\)</span>: <span id="eq:nu_mathcald-ellf-:=" class="math display">\[\label{eq:nu_mathcald-ellf-:=}\tag{2.16}
  \nu_{\mathcal{D},\ell}(f) :=
  \sup _{
    \substack{
      s \in \mathfrak{a}_{\mathbb{C}}^* :  \\
       \Re(s) \in \mathcal{D}
    }
  }
  \sum_{m=0}^{\ell}
  \sum_{x_1,\dotsc,x_m \in \mathcal{B}(G)}
  (1 + |s|)^{\ell}
  \|R(x_1 \dotsb x_m) f[s] \|.\]</span> Here <span
class="math inline">\(\|.\|\)</span> denotes the norm on <span
class="math inline">\(\mathcal{I}(s)\)</span>, induced as in §<a
href="#sec:induc-repr" data-reference-type="ref"
data-reference="sec:induc-repr">2.7</a> from <span
class="math inline">\(L^2(K)\)</span>. For each <span
class="math inline">\(T \geqslant 1\)</span>, we defined a rescaled
variant of such seminorms: <span
class="math display">\[\nu_{\mathcal{D},\ell,T}(f) :=
  \sup _{
    \substack{
      s \in \mathfrak{a}_{\mathbb{C}}^* :  \\
       \Re(s) \in \mathcal{D}
    }
  }
  \sum_{m=0}^{\ell}
  \sum_{x_1,\dotsc,x_m \in \mathcal{B}(G)}
  (1 + |s|)^{\ell}
  \frac{\|R(x_1 \dotsb x_m) f[s] \|}{T ^{\left\langle \rho_U^\vee ,
\Re(s) \right\rangle + m}}.\]</span> The informal idea here is that
<span class="math inline">\(\nu_{\mathcal{D},\ell,T}(f) =
\operatorname{O}(1)\)</span> provided that <span
class="math inline">\(f\)</span> concentrates near <span
class="math inline">\(T^{-\rho_U^\vee}\)</span>, is uniformly smooth
under left translation by <span class="math inline">\(A\)</span>, has
<span class="math inline">\(L^2\)</span>-norm <span
class="math inline">\(\operatorname{O}(1)\)</span>, and has “frequency”
<span class="math inline">\(\operatorname{O}(T)\)</span> under right
translation by <span class="math inline">\(G\)</span> (see, e.g., Lemmas
<a href="#lem:standard:frakE-equivalences" data-reference-type="ref"
data-reference="lem:standard:frakE-equivalences">20.2</a>
and <a href="#lem:standard:let-f-in-2" data-reference-type="ref"
data-reference="lem:standard:let-f-in-2">21.26</a>
for details).</p>
<p>Let <span class="math inline">\(\pi\)</span> be a unitary
representation of <span class="math inline">\(G\)</span>. More
precisely, we write <span class="math inline">\(\pi\)</span> for the
space of smooth vectors in the underlying Hilbert space representation.
For each <span class="math inline">\(d \in \mathbb{Z}_{\geqslant
0}\)</span>, we define a Sobolev norm <span
class="math inline">\(\mathcal{S}_d\)</span> on <span
class="math inline">\(\pi\)</span> by the formula: for <span
class="math inline">\(v \in \pi\)</span>, <span id="eq:mathc-:=-sum_x_1" class="math display">\[\label{eq:mathc-:=-sum_x_1}\tag{2.17}
  \mathcal{S}_d(v)^2 := \sum_{x_1,\dotsb,x_d \in \mathcal{B}(G) \cup
\{1\}} \| \pi(x_1 \dotsb x_d) v\|^2,\]</span> where <span
class="math inline">\(\|.\|\)</span> denotes the given norm on <span
class="math inline">\(\pi\)</span>.</p>
<p>For each <span class="math inline">\((d_1,d_2) \in
\mathbb{Z}_{\geqslant 0} \times \mathbb{Z}_{\geqslant 0}\)</span>, we
define a Sobolev norm <span
class="math inline">\(\mathcal{S}_{d_1,d_2}\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> by the
formula: for <span class="math inline">\(f \in \mathcal{S}(U \backslash
G)\)</span>, <span class="math display">\[\mathcal{S}_{d_1,d_2}(f)^2 :=
  \sum _{
    \substack{
      x_1, \dotsb, x_{d_1} \in \mathcal{B}(A) \cup \{1\}  \\
       y_1, \dotsc, y _{d _2 } \in \mathcal{B}(G) \cup \{1\}
    }
  }
  \| L(x_1 \dotsb x_{d_1}) R(y_1 \dotsb y_{d_2}) f \|^2,\]</span> where
<span class="math inline">\(\|.\|\)</span> denotes the norm on <span
class="math inline">\(L^2(U \backslash G)\)</span>. For example, <span
class="math inline">\(\mathcal{S}_{d,0}(f) = \mathcal{S}_{d}(f)\)</span>
as defined via <a href="#eq:mathc-:=-sum_x_1"
data-reference-type="eqref"
data-reference="eq:mathc-:=-sum_x_1">\((2.17)\)</a>, taking
for <span class="math inline">\(\pi\)</span> the right regular
representation <span class="math inline">\(R\)</span> of <span
class="math inline">\(G\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span>. By the
Parseval relation on <span class="math inline">\(A\)</span>, we have for
<span class="math inline">\(f \in \mathcal{S}^e(U \backslash G)\)</span>
the relation <span id="eq:sobolev-parseval-A-U-G" class="math display">\[\label{eq:sobolev-parseval-A-U-G}\tag{2.18}
  \mathcal{S}_{d_1,d_2}(f)^2 =
  \sum _{
    y_1, \dotsc, y _{d _2 } \in \mathcal{B}(G) \cup \{1\}
  }
  \int _{
    \substack{
      s \in \mathfrak{a}_{\mathbb{C}}^* :  \\
       \Re(s) = 0
    }
  }
  E_{d_1}(s)
  \| R(y_1 \dotsb y_{d_2}) f[s] \|^2 \, d \mu_A(s),\]</span> where <span id="eq:e_ds-:=-sum" class="math display">\[\label{eq:e_ds-:=-sum}\tag{2.19}
  E_d(s) :=
  \sum _{
    x_1, \dotsc, x _{d } \in \mathcal{B}(A) \cup \{1\}
  }
  |\langle s, x_1 \dotsb x_{d}  \rangle|^2.\]</span></p>
<p>We note that for all <span class="math inline">\(a \in A\)</span> and
<span class="math inline">\((d_1,d_2,f)\)</span> as above, <span id="eq:mathcals_d_1-d_2la-f" class="math display">\[\label{eq:mathcals_d_1-d_2la-f}\tag{2.20}
  \mathcal{S}_{d_1,d_2}(L(a) f) = \mathcal{S}_{d_1,d_2}(f),\]</span> as
follows from the commutativity of <span class="math inline">\(A\)</span>
and the unitarity of the operator <span
class="math inline">\(L(a)\)</span> on <span class="math inline">\(L^2(U
\backslash G)\)</span>.</p>
<p>Given a parameter <span class="math inline">\(T \geqslant 1\)</span>,
we define the rescaled Sobolev norm <span
class="math inline">\(\mathcal{S}_{d_1,d_2,T}\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> by <span id="eq:mathcals_d_1-d_2-tf" class="math display">\[\label{eq:mathcals_d_1-d_2-tf}\tag{2.21}
  \mathcal{S}_{d_1,d_2,T}(f) :=
  \max_{0 \leqslant k \leqslant d_2}
  T^{-k}
  \mathcal{S}_{d_1,k}(f).\]</span></p>
<div id="lem:standard2:let-d_1-d_2" class="lemma">
<p><strong>Lemma 14</strong>. Let <span class="math inline">\(d_1, d_2
\in \mathbb{Z}_{\geqslant 0}\)</span>. There exists <span
class="math inline">\(C_0 \geqslant 0\)</span> and <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span> so that
for all compact <span class="math inline">\(\mathcal{D} \subseteq
\mathfrak{a}^*\)</span> containing the origin, and all <span
class="math inline">\(f \in \mathcal{S}^e(U \backslash G)\)</span>, we
have <span class="math display">\[\mathcal{S}_{d_1,d_2}(f) \leqslant C_0
\nu_{\mathcal{D},\ell}(f).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Immediate from <a href="#eq:nu_mathcald-ellf-:="
data-reference-type="eqref"
data-reference="eq:nu_mathcald-ellf-:=">\((2.16)\)</a> and
<a href="#eq:sobolev-parseval-A-U-G" data-reference-type="eqref"
data-reference="eq:sobolev-parseval-A-U-G">\((2.18)\)</a>;
we may take <span class="math inline">\(\ell = d_1 + b\)</span> for any
<span class="math inline">\(b \in \mathbb{Z}_{\geqslant 0}\)</span>
large enough that <span class="math inline">\(\int _{s \in
\mathfrak{a}_{\mathbb{C}}^* : \Re(s) = 0} (1 + |s|)^{-2 b} \, d \mu_A(s)
&lt; \infty\)</span>. ◻</p>
</div>
<h4 id="sec:local-zeta-functions">§2.10. Zeta functions</h4>
<p>In the local case, we denote by <span
class="math inline">\(\zeta_F\)</span> the meromorphic function on <span
class="math inline">\(\mathbb{C}\)</span> given by <span
class="math display">\[\zeta_F(s) :=
  \begin{cases}
    \pi^{-s/2} \Gamma(s/2) &amp; \text{ if } F = \mathbb{R}, \\
    2 (2 \pi ) ^{- s} \Gamma (s) &amp;  \text{ if } F = \mathbb{C}, \\
    (1 - q^{-s})^{-1} &amp; \text{ if } F: \text{non-archimedean}.
  \end{cases}\]</span> We write <span
class="math inline">\(\zeta_F(U,\cdot)\)</span> for the meromorphic
function on <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span> given by
<span class="math display">\[\zeta_F(U,s) := \prod_{\alpha \in R_U^+}
\zeta_F(1 + \alpha^\vee(s)).\]</span> We note that <span
class="math inline">\(\zeta_F(U,s)\)</span> depends only upon the
character <span class="math inline">\(\chi = |.|^s\)</span> of <span
class="math inline">\(A\)</span>. Thus the shorthand <span
class="math display">\[\zeta_F(U,\chi) := \zeta_F(U,s)\]</span> defines
a meromorphic function <span
class="math inline">\(\zeta_F(U,\cdot)\)</span> on <span
class="math inline">\(\mathfrak{X}^e(A)\)</span>.</p>
<p>In the global case, we abbreviate <span
class="math inline">\(\zeta_\mathfrak{p} :=
\zeta_{F_\mathfrak{p}}\)</span>. Given a finite set of places <span
class="math inline">\(S\)</span> containing the archimedean ones, we
write <span class="math inline">\(\zeta_F^{(S)}(U,s)\)</span> or <span
class="math inline">\(\zeta_F^{(S)}(U,\chi)\)</span> for the product
over <span class="math inline">\(\mathfrak{p} \notin S\)</span> of the
corresponding local factors, with the product defined either via
meromorphic continuation from the domain where <span
class="math inline">\(\Re(s)\)</span> is strictly dominant or by the
analogous product of partial Dedekind zeta functions. When <span
class="math inline">\(F = \mathbb{Q}\)</span> and <span
class="math inline">\(S = \{\infty\}\)</span>, we write simply <span
class="math inline">\(\zeta(U,s)\)</span> or <span
class="math inline">\(\zeta(U,\chi)\)</span>.</p>
<h4 id="sec:stand-nond-char">§2.11. Additive characters</h4>
<p>We denote by <span class="math inline">\(\psi_{\mathbb{Q}}\)</span>
the “standard” nontrivial unitary character of <span
class="math inline">\(\mathbb{A}/\mathbb{Q}\)</span>, characterized by
<span class="math inline">\(\psi_{\mathbb{Q}}|_{\mathbb{R}} = e^{2 \pi i
(\cdot)}\)</span>. For each completion <span
class="math inline">\(F\)</span> of <span
class="math inline">\(\mathbb{Q}\)</span>, we write <span
class="math inline">\(\psi_F\)</span> for the restriction of <span
class="math inline">\(\psi_{\mathbb{Q}}\)</span> to <span
class="math inline">\(F\)</span>. Each local field <span
class="math inline">\(F\)</span> of characteristic zero is a finite
extension of some completion <span class="math inline">\(F_0\)</span> of
<span class="math inline">\(\mathbb{Q}\)</span>; we define <span
class="math inline">\(\psi_F\)</span> to be the pullback of <span
class="math inline">\(\psi_{F_0}\)</span> via the trace map <span
class="math inline">\(F \rightarrow F_0\)</span>.</p>
<p>We denote by <span class="math inline">\(\mathop{\mathrm{U}}(1) :=
\{z \in \mathbb{C}^\times : |z| = 1\}\)</span> the unitary group in one
variable.</p>
<p>In the local (resp. global) case, let <span
class="math inline">\(\psi : N \rightarrow
\mathop{\mathrm{U}}(1)\)</span> (resp. <span class="math inline">\(\psi
: N(\mathbb{A}) \rightarrow \mathop{\mathrm{U}}(1)\)</span>) be a
nondegenerate unitary character, trivial on <span
class="math inline">\(N(F)\)</span> in the global case. For example, if
<span class="math inline">\(G = {\mathop{\mathrm{GL}}}_r\)</span>, then
<span id="eq:psi-n-vs-psi-F-whittaker" class="math display">\[\label{eq:psi-n-vs-psi-F-whittaker}\tag{2.22}
  \psi(n) = \psi_F\left(\sum_{i=1}^{r-1} c_i n_{i,i+1}\right)\]</span>
for some <span class="math inline">\(c_1,\dotsc,c_{r-1} \in
F^\times\)</span>.</p>
<p>Suppose <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_r\)</span>. In the local (resp. global) case, the
<em>standard</em> nondegenerate unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span> (resp. of <span
class="math inline">\(N(\mathbb{A})\)</span>, trivial on <span
class="math inline">\(N(F)\)</span>) is then defined to be <span id="eq:psin-=-psi_f" class="math display">\[\label{eq:psin-=-psi_f}\tag{2.23}
  \psi(n) = \psi_{F} \left( \sum_{i=1}^{r-1} n_{i,i+1}
\right).\]</span></p>
<p>Suppose now that <span class="math inline">\(F\)</span> is local and
that <span class="math inline">\(G\)</span> arises from some split
reductive group over <span class="math inline">\(\mathfrak{o}\)</span>,
which we continue to denote by <span class="math inline">\(G\)</span>.
We may speak then of <span class="math inline">\(\psi\)</span> being
<em>unramified</em>. For example, if <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_r\)</span> and <span
class="math inline">\(\psi_F\)</span> itself is unramified (i.e., <span
class="math inline">\(F = \mathbb{Q}_p\)</span> or an unramified
extension), then this says that each <span class="math inline">\(|c_i| =
1\)</span> in the expression <a href="#eq:psi-n-vs-psi-F-whittaker"
data-reference-type="eqref"
data-reference="eq:psi-n-vs-psi-F-whittaker">\((2.22)\)</a>.</p>
<p>For a reductive group <span class="math inline">\(G\)</span> over
<span class="math inline">\(\mathbb{Z}\)</span> and a nondegenerate
unitary character <span class="math inline">\(\psi\)</span> of <span
class="math inline">\(N(\mathbb{A})\)</span>, trivial on <span
class="math inline">\(N(\mathbb{Q})\)</span>, we say that <span
class="math inline">\(\psi\)</span> is <em>unramified</em> if its
restriction to each <span class="math inline">\(N(\mathbb{Q}_p)\)</span>
is unramified. For example, when <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n\)</span>, the standard character and its inverse
are unramified, as is any <span class="math inline">\(\psi\)</span> for
which each <span class="math inline">\(c_i = \pm 1\)</span> in <a
href="#eq:psi-n-vs-psi-F-whittaker" data-reference-type="eqref"
data-reference="eq:psi-n-vs-psi-F-whittaker">\((2.22)\)</a>.</p>
<h4 id="sec:whittaker-functions-1">§2.12. Whittaker functions</h4>
<p>Let <span class="math inline">\(\psi\)</span> be as in §<a
href="#sec:stand-nond-char" data-reference-type="ref"
data-reference="sec:stand-nond-char">2.11</a>.</p>
<p>In the local case, we denote by <span
class="math inline">\(C^\infty(N \backslash G, \psi)\)</span> the space
of smooth functions <span class="math inline">\(W : G \rightarrow
\mathbb{C}\)</span> satisfying <span class="math inline">\(W(u g) =
\psi(u) W(g)\)</span> for all <span class="math inline">\((u,g) \in N
\times G\)</span>. (We are using the letter <span
class="math inline">\(W\)</span> to denote both the Weyl group and
Whittaker functions, but it should always be clear by context what we
mean.) In the global case, we analogously define <span
class="math inline">\(C^\infty(N(\mathbb{A}) \backslash G(\mathbb{A}),
\psi)\)</span>.</p>
<p>We denote by <span class="math inline">\(w_{\bar{U},N} \in W\)</span>
the unique Weyl group element with <span
class="math inline">\(w_{\bar{U},N} N = \bar{U} w_{\bar{U},N}\)</span>,
where <span class="math inline">\(\bar{U}\)</span> denotes the maximal
unipotent subgroup opposite to <span class="math inline">\(U\)</span>.
We choose a representative for <span class="math inline">\(w
_{\overline{U}, N}\)</span> in <span
class="math inline">\(G(F)\)</span>. The definitions that follow depend
upon this choice. When <span class="math inline">\(G\)</span> is a
general linear group (the case ultimately relevant for this paper), we
always take the standard choice, given by a permutation matrix; more
generally, if <span class="math inline">\(U\)</span> is opposite to
<span class="math inline">\(N\)</span>, then we take for <span
class="math inline">\(w_{\overline{U}, N}\)</span> the identity element
of <span class="math inline">\(G(F)\)</span>. In the local case, <span
class="math inline">\(w _{\overline{U},N}\)</span> then lies in the
standard maximal compact subgroup.</p>
<p>In the local case, for <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span> and <span class="math inline">\(f \in
\mathcal{I}(\chi)\)</span>, we denote by <span
class="math display">\[W[f,\psi] \in C^\infty(N \backslash G,
\psi)\]</span> the corresponding Jacquet integral, defined for <span
class="math inline">\(\Re(\chi) \succ 0\)</span> by the absolutely
convergent integral <span class="math display">\[W[f, \psi](g) := \int
_{n \in N} \psi^{-1}(n)
  f(w_{\bar{U},N} n g) \, d n\]</span> and in general by analytic
continuation along a holomorphic family of vectors (see <a href="#ref-MR716292"
class="citation" data-cites="MR716292">(Hervé Jacquet and Shalika 1983,
sec. 3)</a>, <a href="#ref-MR2533003" class="citation" data-cites="MR2533003">(Hervé
Jacquet 2009, sec. 7.2)</a>, <a href="#ref-MR1170566" class="citation"
data-cites="MR1170566">(Wallach 1992, vol. 132, sec. 15)</a>, <a href="#ref-MR563369"
class="citation" data-cites="MR563369">(Shahidi 1980)</a>).</p>
<p>In the global case, for a continuous function <span
class="math inline">\(\varphi\)</span> on <span
class="math inline">\([G]\)</span>, we define <span
class="math display">\[W[\varphi,\psi] \in C^\infty(N(\mathbb{A})
\backslash G(\mathbb{A}), \psi)\]</span> by the analogous global
integral: <span class="math display">\[W[\varphi, \psi](g) := \int _{n
\in [N]} \psi^{-1}(n)
  \varphi(w_{\bar{U},N} n g) \, d n.\]</span></p>
<p>Assume now that <span class="math inline">\(F\)</span> is
non-archimedean local, that <span class="math inline">\(G\)</span>
arises from some split reductive group over <span
class="math inline">\(\mathfrak{o}\)</span>, which we continue to denote
by <span class="math inline">\(G\)</span>, that <span
class="math inline">\(K = G(\mathfrak{o})\)</span>, and that <span
class="math inline">\(w_{\bar{U},N} \in K\)</span>. Assume that <span
class="math inline">\(\psi\)</span> is unramified, <span
class="math inline">\(\chi\)</span> is unramified, and <span
class="math inline">\(f^0[\chi]\)</span> is the unramified vector with
<span class="math inline">\(f^0[\chi](1) = 1\)</span>. Recall our
convention that the Haar measure on <span
class="math inline">\(N\)</span> assigns volume one to a maximal compact
subgroup. The Casselman–Shalika formula <a href="#ref-MR581582" class="citation"
data-cites="MR581582">(Casselman and Shalika 1980, Thm 5.4)</a> then
reads <span id="eq:wf0chi-psi1-casselman-shalika" class="math display">\[\label{eq:wf0chi-psi1-casselman-shalika}\tag{2.24}
  W[f^0[\chi],\psi](1)
  =
  \frac{1}{\zeta_F(U,\chi)},\]</span> where the RHS is as defined in §<a
href="#sec:local-zeta-functions" data-reference-type="ref"
data-reference="sec:local-zeta-functions">2.10</a>.</p>
<h4 id="sec:local-intertw-oper-four">§2.13. Intertwining operators</h4>
<h5 id="sec:basic-definition-intertwining-ops">§2.13.1. Basic definition</h5>
<p>Let <span class="math inline">\(w \in W\)</span>.</p>
<p>In the local case, for <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span>, we denote by <span
class="math display">\[M_w[\chi] : \mathcal{I}(\chi) \rightarrow
\mathcal{I}(w \chi),\]</span> or simply <span
class="math inline">\(M_w\)</span> when <span
class="math inline">\(\chi\)</span> is clear from context, the standard
local intertwining operator, defined initially for <span
class="math inline">\(\Re(\chi) \succ 0\)</span> by <span
class="math display">\[M_w f[\chi](g) = \int _{u \in
    w U w^{-1} \cap U \backslash  U} f[\chi](w^{-1} u g) \, d u\]</span>
and in general via meromorphic continuation (see <a href="#ref-MR1170566" class="citation"
data-cites="MR1170566">(Wallach 1992, 132:10.1.14)</a>, <a href="#ref-MR610479"
class="citation" data-cites="MR610479">(Shahidi 1981, sec. 2.2)</a>).
We note that the definition depends upon a lift of <span
class="math inline">\(w\)</span> to <span
class="math inline">\(G\)</span>.</p>
<p>In the global case, for a function <span
class="math inline">\(f\)</span> on <span
class="math inline">\([G]_Q\)</span>, we denote by <span
class="math inline">\(M_w f : [G]_Q \rightarrow \mathbb{C}\)</span> the
image of <span class="math inline">\(f\)</span> under the standard
intertwining operator <span class="math inline">\(M_w\)</span>, defined
by the usual integral, if it converges absolutely: <span
class="math display">\[M_w f(g) = \int _{(w U w^{-1} \cap U \backslash
U)(\mathbb{A})}
  f(w^{-1} u g) \, d u.\]</span> Here we lift <span
class="math inline">\(w\)</span> to an element of <span
class="math inline">\(G(F)\)</span>. We recall the basic properties of
such integrals (see <a href="#ref-MR546601 2019arXiv191102342B MR2402686" class="citation"
data-cites="MR546601 2019arXiv191102342B MR2402686">(Arthur 1979; J.
Bernstein and Lapid 2019; E. M. Lapid 2008)</a>). They converge if
<span class="math inline">\(f \in \mathcal{S}([G]_Q)\)</span>, in which
case they induce continuous maps <span
class="math inline">\(\mathcal{S}([G]_Q) \rightarrow
\mathcal{T}([G]_Q)\)</span>. They also converge if <span
class="math inline">\(f \in \mathcal{I}(\chi)\)</span> for some <span
class="math inline">\(\chi\)</span> with <span
class="math inline">\(\Re(\chi) \succ \rho_U\)</span>. For a holomorphic
family <span class="math inline">\(\{f[\chi]\}_{\chi \in
\mathfrak{X}([A])}\)</span>, the assignment <span
class="math inline">\(\chi \mapsto M_w f[\chi]\)</span> admits a
meromorphic continuation to all <span
class="math inline">\(\chi\)</span>, inducing a meromorphic family of
maps <span class="math display">\[M_w := M_w[\chi] : \mathcal{I}(\chi)
\rightarrow \mathcal{I}(w \chi)\]</span> This family of operators is
holomorphic in a neighborhood of the subgroup <span
class="math inline">\([A]^\wedge\)</span> of unitary characters, and is
unitary on that axis: for <span class="math inline">\(\chi \in
[A]^\wedge\)</span> and <span class="math inline">\(f_1, f_2 \in
\mathcal{I}(\chi)\)</span>, we have <span id="eq:langle-f_1-f_2" class="math display">\[\label{eq:langle-f_1-f_2}\tag{2.25}
\langle f_1, f_2 \rangle = \langle M_w f_1, M_w f_2 \rangle.\]</span>
For <span class="math inline">\(w_1, w_2 \in W\)</span> and <span
class="math inline">\(\chi \in \mathfrak{X}(A)\)</span>, we have the
composition formula <span id="eq:m_w_1w_2-chi-circ" class="math display">\[\label{eq:m_w_1w_2-chi-circ}\tag{2.26}
  M_{w_1}[w_2 \chi] \circ M_{w_2}[\chi] = M_{w_1 w_2}[\chi] :
\mathcal{I}(\chi) \rightarrow \mathcal{I}(w_1 w_2 \chi).\]</span></p>
<h5 id="sec:fourier-transforms">§2.13.2. Fourier transforms</h5>
<p>In the local case, given a nondegenerate unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span>, we denote by <span
class="math display">\[\mathcal{F}_{w,\psi}[\chi] : \mathcal{I}(\chi)
\rightarrow \mathcal{I}(w \chi),\]</span> or simply <span
class="math inline">\(\mathcal{F}_{w}[\chi]\)</span>, <span
class="math inline">\(\mathcal{F}_{w,\psi}\)</span> or <span
class="math inline">\(\mathcal{F}_w\)</span> when <span
class="math inline">\(\psi\)</span> and/or <span
class="math inline">\(\chi\)</span> are understood by context, the
normalized intertwining operator as in <a href="#ref-MR610479" class="citation"
data-cites="MR610479">(Shahidi 1981, p336)</a>, i.e., the scalar
multiple of <span class="math inline">\(M_w[\chi]\)</span> for which
<span id="eq:wmathcalf_w-fchi-psi" class="math display">\[\label{eq:wmathcalf_w-fchi-psi}\tag{2.27}
  W[\mathcal{F}_w f, \psi] = W[f,\psi] \quad \text{ for all } f \in
\mathcal{I}(\chi).\]</span> We note that, while <span
class="math inline">\(M_w\)</span> depends upon a choice of
representative for <span class="math inline">\(w\)</span>, the
normalized operators <span
class="math inline">\(\mathcal{F}_{w}\)</span> are independent of that
choice, although they do depend upon the representatives <span
class="math inline">\(w_{\bar{U},N}\)</span> used to define our
Whittaker functionals.</p>
<p>By <a href="#ref-MR610479" class="citation" data-cites="MR610479">(Shahidi 1981, Prop
3.1.4)</a>, we have <span id="eq:mathc-1-mathc" class="math display">\[\label{eq:mathc-1-mathc}\tag{2.28}
  \mathcal{F}_{w^{-1}} \mathcal{F}_w  f = f
  \quad \text{ for all } f \in \mathcal{I}(\chi)\]</span> and <span id="eq:f_1chi-f_2chi-1" class="math display">\[\label{eq:f_1chi-f_2chi-1}\tag{2.29}
  (f_1, f_2) =
  (\mathcal{F}_w f_1, \mathcal{F}_w f_2)
  \quad
  \text{ for all } (f_1,f_2,w) \in \mathcal{I}(\chi) \times
\mathcal{I}(\chi^{-1}) \times W.\]</span> In particular, <span
class="math inline">\(\mathcal{F}_w[\chi]\)</span> is unitary when <span
class="math inline">\(\chi\)</span> is unitary, and so the family <span
class="math inline">\(\{\mathcal{F}_w[\chi] : \chi \in A^\wedge
\}\)</span> induces a unitary operator <span
class="math inline">\(\mathcal{F}_w\)</span> on <span
class="math inline">\(L^2(U \backslash G)\)</span> (cf. <a href="#ref-MR3468638"
class="citation" data-cites="MR3468638">(Gelfand, Graev, and
Pyatetskii-Shapiro 2016, sec. 3.5)</a>, <a href="#ref-MR1694894 MR1988971 MR3969881" class="citation"
data-cites="MR1694894 MR1988971 MR3969881">(Braverman and Kazhdan 1999,
2002; Shahidi 2018)</a>). It is also known that <span
class="math display">\[\mathcal{F}_{w_1} \circ \mathcal{F}_{w_2} =
\mathcal{F}_{w_1 w_2},\]</span> see, e.g., <span class="citation"
data-cites="MR999488">(Arthur 1989, Thm 2.1, <span
class="math inline">\((R_2)\)</span>)</span>.</p>
<div id="itm:standard2:F-w-mellin" class="lemma">
<p><strong>Lemma 15</strong>. <span id="lem:standard2:let-w-in"
label="lem:standard2:let-w-in"></span> Let <span class="math inline">\(w
\in W\)</span> and <span class="math inline">\(f \in \mathcal{S}(U
\backslash G)\)</span>. The following are equivalent:</p>
<ol type="i">
<li><p><span id="itm:standard2:F-w-unitary"
label="itm:standard2:F-w-unitary"></span> The unitary operator <span
class="math inline">\(\mathcal{F}_w\)</span> on <span
class="math inline">\(L^2(U \backslash G)\)</span> satisfies <span
class="math inline">\(\mathcal{F}_w f = f\)</span>.</p></li>
<li><p>For almost all <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span>, the operators <span
class="math inline">\(\mathcal{F}_w : \mathcal{I}(\chi) \rightarrow
\mathcal{I}(w \chi)\)</span> satisfy <span
class="math inline">\(\mathcal{F}_w f[\chi] = f [ w
\chi]\)</span>.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> By definition, <span
class="math inline">\(\mathcal{F}_w f\)</span> is the element of <span
class="math inline">\(L^2(U \backslash G)\)</span> that, with respect to
the direct integral decomposition noted in <a href="#eq:f-=-int"
data-reference-type="eqref"
data-reference="eq:f-=-int">\((2.14)\)</a>, has components <span
class="math inline">\((\mathcal{F}_w f)[w \chi]\)</span> given, for
almost all <span class="math inline">\(\chi\)</span> with <span
class="math inline">\(\Re(\chi) = 0\)</span>, by <span
class="math inline">\(\mathcal{F}_w f[\chi]\)</span>. The identity <span
class="math inline">\(\mathcal{F}_w f = f\)</span> is thus equivalent
to:</p>
<ul>
<li><p><span class="math inline">\(\mathcal{F}_w f[\chi] = f[w
\chi]\)</span> for almost all <span class="math inline">\(\chi\)</span>
with <span class="math inline">\(\Re(\chi) = 0\)</span>.</p></li>
</ul>
<p>This last identity should be understood initially as one of elements
of <span class="math inline">\(L^2(K)\)</span>, but both sides are
smooth under right translation by <span
class="math inline">\(G\)</span>, so we can interpret it pointwise. Both
sides of this last identity vary meromorphically with respect to <span
class="math inline">\(\chi\)</span>, so it is equivalent to ask that the
same identity hold for almost all <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span>. ◻</p>
</div>
<p>For <span class="math inline">\(w \in W\)</span>, we denote by <span id="eq:mathc-backsl-gw" class="math display">\[\label{eq:mathc-backsl-gw}\tag{2.30}
  \mathcal{S}(U \backslash G)^w\]</span> the space of all <span
class="math inline">\(f \in \mathcal{S}(U \backslash G)\)</span>
satisfying the equivalent conditions of Lemma <a
href="#lem:standard2:let-w-in" data-reference-type="ref"
data-reference="lem:standard2:let-w-in">2.6</a>. We
define <span class="math inline">\(\mathcal{S}^e(U \backslash
G)^w\)</span> analogously, and then define <span
class="math inline">\(\mathcal{S}(U \backslash G)^W\)</span> and <span
class="math inline">\(\mathcal{S}^e(U \backslash G)^W\)</span> by taking
the intersection over all <span class="math inline">\(w \in
W\)</span>.</p>
<div id="rmk:we-note-that-dependence-psi-w" class="remark">
<p><strong>Remark 16</strong>. We note that, despite what the notation
<span class="math inline">\(\mathcal{S}(U \backslash G)^w\)</span>
suggests, these spaces depend upon <span
class="math inline">\(\psi\)</span>, since <span
class="math inline">\(\mathcal{F}_{w,\psi}\)</span> does. We might write
more verbosely <span class="math inline">\(\mathcal{S}(U \backslash
G)^{w, \psi}\)</span>, etc., to reflect this dependence. In what
follows, the choice of <span class="math inline">\(\psi\)</span> will
always be specified or clear from context.</p>
<p>When <span class="math inline">\(G\)</span> is a general linear
group, we adopt the convention that <span class="math inline">\(S(U
\backslash G)^W := \mathcal{S}(U \backslash G)^{W,\psi}\)</span>, with
<span class="math inline">\(\psi\)</span> the standard character <span
class="math inline">\(\psi\)</span> as in <a href="#eq:psin-=-psi_f"
data-reference-type="eqref"
data-reference="eq:psin-=-psi_f">\((2.23)\)</a>. We adopt the
analogous convention concerning <span
class="math inline">\(\mathcal{S}^e(U \backslash G)^W\)</span>. Using
that the element <span class="math display">\[\eta =
\mathop{\mathrm{diag}}(1,-1,1,-1,\dotsc) \in A \cap K\]</span>
conjugates <span class="math inline">\(\psi\)</span> to <span
class="math inline">\(\psi^{-1}\)</span>, we may check that <span id="eq:mathc-backsl-gw-1" class="math display">\[\label{eq:mathc-backsl-gw-1}\tag{2.31}
    \mathcal{S}^e(U \backslash G)^W := \mathcal{S}^e(U \backslash
G)^{W,\psi} = \mathcal{S}^e(U \backslash G)^{W,\psi^{-1}}.\]</span></p>
</div>
<div class="remark">
<p><strong>Remark 17</strong>. The Mellin-theoretic condition <a
href="#itm:standard2:F-w-mellin" data-reference-type="eqref"
data-reference="itm:standard2:F-w-mellin">\((ii)\)</a>
is the relevant one for our purposes. We do not make direct use of the
<span class="math inline">\(L^2\)</span>-based condition <a
href="#itm:standard2:F-w-unitary" data-reference-type="eqref"
data-reference="itm:standard2:F-w-unitary">\((i)\)</a>.
We have included Lemma <a href="#lem:standard2:let-w-in"
data-reference-type="ref"
data-reference="lem:standard2:let-w-in">2.6</a>
primarily to simplify our notation: condition <a
href="#itm:standard2:F-w-unitary" data-reference-type="eqref"
data-reference="itm:standard2:F-w-unitary">\((i)\)</a>
is somewhat more concise than <a href="#itm:standard2:F-w-mellin"
data-reference-type="eqref"
data-reference="itm:standard2:F-w-mellin">\((ii)\)</a>
and better justifies the use of the notation <a
href="#eq:mathc-backsl-gw" data-reference-type="eqref"
data-reference="eq:mathc-backsl-gw">\((2.30)\)</a>. The above
discussion could likely be formulated more naturally in terms of
extended Schwartz spaces (see Remark <a href="#rmk:one-could-likely"
data-reference-type="ref"
data-reference="rmk:one-could-likely">30</a>).</p>
</div>
<div class="example">
<p><strong>Example 18</strong>. Suppose <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_2\)</span>, <span class="math inline">\(U\)</span>
is lower-triangular, <span class="math inline">\(N\)</span> is
upper-triangular, and <span class="math inline">\(\psi : N \rightarrow
\mathop{\mathrm{U}}(1)\)</span> is given by <span
class="math inline">\(\begin{pmatrix}
    1 &amp; x \\
    0  &amp; 1
  \end{pmatrix} \mapsto \psi_F(x)\)</span>. Then <span
class="math inline">\(U \backslash G\)</span> identifies, via the “top
row” map, with the punctured plane <span class="math inline">\(F^2 -
\{0\}\)</span>. The Haar measure on <span class="math inline">\(U
\backslash G\)</span> identifies with the restriction of the Haar
measure on the plane <span class="math inline">\(F^2\)</span>. For the
nontrivial element <span class="math inline">\(w \in W\)</span>, one can
check that the unitary operator <span
class="math inline">\(\mathcal{F}_{\psi} :=
\mathcal{F}_{w,\psi}\)</span> identifies with the symplectic Fourier
transform on <span class="math inline">\(L^2(F^2)\)</span>, given by
<span class="math display">\[\mathcal{F}_{\psi} f(x,y) =
    \int _{u, v \in F}
    f(u, v) \psi_F(u y - x v)
    \, d u \, d v\]</span> with <span class="math inline">\(d u\)</span>
and <span class="math inline">\(d v\)</span> the <span
class="math inline">\(\psi_F\)</span>-self-dual Haar measures. Related
calculations appear in <a href="#ref-MR3468638" class="citation"
data-cites="MR3468638">(Gelfand, Graev, and Pyatetskii-Shapiro 2016,
secs. 3.4–§3.6)</a>.</p>
</div>
<h5 id="sec:fact-intertw-oper">§2.13.3. Euler factorization</h5>
<p>Suppose for the moment that <span class="math inline">\(F\)</span> is
global. Intertwining operators may be factored, in a certain sense, over
the places of <span class="math inline">\(F\)</span>. Recall that <span
class="math inline">\(\mathcal{I}(\chi)\)</span> identifies with the
restricted tensor product of the local principal series representations
<span
class="math inline">\(\mathcal{I}_\mathfrak{p}(\chi_\mathfrak{p})\)</span>.
The restriction is with respect to the normalized spherical elements
<span class="math inline">\(f_\mathfrak{p}^0[\chi_\mathfrak{p}]\)</span>
defined for almost all <span
class="math inline">\(\mathfrak{p}\)</span>, with the normalization
being <span class="math inline">\(f_\mathfrak{p}^0[\chi_\mathfrak{p}](1)
= 1\)</span>. For a pure tensor <span class="math inline">\(f =
\otimes_\mathfrak{p} f_\mathfrak{p}\)</span> in this restricted tensor
product, we have <span class="math display">\[M_w f =
\otimes_\mathfrak{p} ^* M_w f_\mathfrak{p},\]</span> where <span
class="math inline">\(M_w\)</span> is the local intertwining operator,
defined for <span class="math inline">\(\Re(\chi_\mathfrak{p}) \succ
0\)</span> by integrating over <span
class="math inline">\(U(F_\mathfrak{p})\)</span>, and the meaning of
<span class="math inline">\(\otimes_\mathfrak{p}^*\)</span> is that we
regularize the tensor product using the ratio of <span
class="math inline">\(L\)</span>-functions describing the images <span
class="math inline">\(M_w f_\mathfrak{p}^0\)</span> of the unramified
vectors, as given in <a href="#ref-MR0419366" class="citation"
data-cites="MR0419366">(Robert P. Langlands 1971, 1:(4))</a>.</p>
<p>Let <span class="math inline">\(\psi\)</span> be a nondegenerate
unitary character of <span class="math inline">\(N(\mathbb{A})\)</span>,
trivial on <span class="math inline">\(N(F)\)</span>. Write <span
class="math inline">\(\psi_\mathfrak{p} : N(F_\mathfrak{p}) \rightarrow
\mathop{\mathrm{U}}(1)\)</span> for its local component at a place <span
class="math inline">\(\mathfrak{p}\)</span>. As explained in <a href="#ref-MR610479"
class="citation" data-cites="MR610479">(Shahidi 1981, sec. 4)</a>,
the functional equation for Eisenstein series (see, e.g., <a
href="#eq:eisenstein-series-functional-equation"
data-reference-type="eqref"
data-reference="eq:eisenstein-series-functional-equation">\((2.43)\)</a>
below) implies that <span id="eq:m_w-f-=" class="math display">\[\label{eq:m_w-f-=}\tag{2.32}
  M_w f = \otimes_{\mathfrak{p}}^* \mathcal{F}_{w}
f_\mathfrak{p},\]</span> where <span
class="math display">\[\mathcal{F}_{w} f_\mathfrak{p} :=
\mathcal{F}_{w,\psi_\mathfrak{p}} f_\mathfrak{p}\]</span> and <span
class="math inline">\(\otimes^*_{\mathfrak{p}}\)</span> is defined as
above, but using a different ratio of <span
class="math inline">\(L\)</span>-values. More precisely, suppose that
<span class="math inline">\(S\)</span> is a finite set of places taken
large enough that <span class="math inline">\(f_\mathfrak{p} =
f_\mathfrak{p}^0[\chi_\mathfrak{p}]\)</span> and <span
class="math inline">\(\psi_\mathfrak{p}\)</span> is unramified for all
<span class="math inline">\(\mathfrak{p} \notin S\)</span>. Then <span
class="math display">\[\begin{align}
  \mathcal{F}_{w} \zeta_{F_\mathfrak{p}}(U, \chi_\mathfrak{p})
f_\mathfrak{p}^0[\chi_\mathfrak{p}] =
  \zeta_{F_\mathfrak{p}}(U,w \chi_\mathfrak{p})f_\mathfrak{p}^0[w
\chi_\mathfrak{p}],
\end{align}\]</span> for <span class="math inline">\(\mathfrak{p}
\notin S\)</span>. The precise meaning of <a href="#eq:m_w-f-="
data-reference-type="eqref" data-reference="eq:m_w-f-=">\((2.32)\)</a>
is then that <span id="eq:m_w-f-=-1" class="math display">\[\label{eq:m_w-f-=-1}\tag{2.33}
  M_w f
  =
  \frac{
    \zeta_F^{(S)}(U,w \chi)
  }{
    \zeta_F^{(S)}(U,\chi)
  }
  (\otimes_{\mathfrak{p} \in S}
  \mathcal{F}_w f_\mathfrak{p} ) \otimes (
  \otimes_{\mathfrak{p} \notin S} f_\mathfrak{p}^0).\]</span></p>
<p>A more convenient formulation of <a href="#eq:m_w-f-=-1"
data-reference-type="eqref"
data-reference="eq:m_w-f-=-1">\((2.33)\)</a> may be given as
follows. Introduce the modified spherical elements <span
class="math display">\[f_\mathfrak{p}^\sharp[\chi_\mathfrak{p}] :=
\zeta_{F_\mathfrak{p}}(U,\chi_\mathfrak{p})
f_\mathfrak{p}^0[\chi_\mathfrak{p}].\]</span> For <span
class="math inline">\(f \in \mathcal{I}(\chi)\)</span>, write <span
class="math display">\[f = \otimes^\sharp f_\mathfrak{p}\]</span> to
signify that for some large enough finite set of places <span
class="math inline">\(S\)</span>, we have <span
class="math inline">\(f_\mathfrak{p} = f_\mathfrak{p} ^\sharp
[\chi_\mathfrak{p}]\)</span> for all <span
class="math inline">\(\mathfrak{p} \notin S\)</span>, and <span
class="math display">\[f = \zeta_F^{(S)}(U,\chi)
  (\otimes_{\mathfrak{p} \in S} f_\mathfrak{p} )
  \otimes
  (\otimes_{\mathfrak{p} \notin S} f_\mathfrak{p}^0 ).\]</span> Then for
<span class="math inline">\(\mathfrak{p} \notin S\)</span>, we have
<span id="eq:normalized-F-w-preserves-basic-vector" class="math display">\[\label{eq:normalized-F-w-preserves-basic-vector}\tag{2.34}
\mathcal{F}_w f_\mathfrak{p}^\sharp[\chi_\mathfrak{p}] = f_\mathfrak{p}
^\sharp [w \chi_\mathfrak{p}],\]</span> and so we may rewrite <a
href="#eq:m_w-f-=-1" data-reference-type="eqref"
data-reference="eq:m_w-f-=-1">\((2.33)\)</a> as follows: <span id="eq:m_w-f-=-2" class="math display">\[\label{eq:m_w-f-=-2}\tag{2.35}
  M_w f = \otimes ^\sharp \mathcal{F}_w f_\mathfrak{p}.\]</span></p>
<div class="remark">
<p><strong>Remark 19</strong>. Such relations may be derived also from
<a href="#ref-MR3468638" class="citation" data-cites="MR3468638">(Gelfand, Graev, and
Pyatetskii-Shapiro 2016, p373)</a>.</p>
</div>
<h4 id="representation-theory-of-general-linear-groups">Representation
theory of general linear groups</h4>
<h5 id="sec:local-prelim-kirillov-model">§2.14.1. Kirillov model</h5>
<p>Suppose now that <span class="math inline">\(F\)</span> is local and
that <span class="math inline">\(G\)</span> is a nontrivial general
linear group.</p>
<p>We recall that an irreducible (smooth admissible) representation
<span class="math inline">\(\pi\)</span> of <span
class="math inline">\(G\)</span> is <em>generic</em> if it admits an
equivariant embedding into the space <span
class="math inline">\(C^\infty(N \backslash G, \psi)\)</span> for some
(equivalently, any) nondegenerate unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span>; such an embedding is then uniquely
determined up to a scalar (see <a href="#ref-MR348047" class="citation"
data-cites="MR348047">(Shalika 1974)</a>, <a href="#ref-MR546599" class="citation"
data-cites="MR546599">(Piatetski-Shapiro 1979, sec. 1)</a>), so its
image, denoted <span
class="math inline">\(\mathcal{W}(\pi,\psi)\)</span>, is
well-defined.</p>
<p>We extend <span class="math inline">\(G\)</span> to a general linear
pair <span class="math inline">\((G,H)\)</span>, with <span
class="math inline">\(H\)</span> possibly trivial. The restriction <span
class="math inline">\(\psi|_{N_H}\)</span> is a nondegenerate unitary
character of <span class="math inline">\(N_H\)</span>; for notational
simplicity, we denote that restriction simply by <span
class="math inline">\(\psi\)</span>. The restriction map from <span
class="math inline">\(\mathcal{W}(\pi,\psi)\)</span> to the space <span
class="math inline">\(C^\infty(N \backslash H, \psi)\)</span> is
injective (see <a href="#ref-MR748505" class="citation" data-cites="MR748505">(J. N.
Bernstein 1984, sec. 6.5)</a>, <a href="#ref-MR1999922" class="citation"
data-cites="MR1999922">(Baruch 2003a, sec. 10.2)</a>), with image
called the <em>Kirillov model</em> of <span
class="math inline">\(\pi\)</span>. If <span
class="math inline">\(\pi\)</span> is unitarizable, then an invariant
norm on <span class="math inline">\(\mathcal{W}(\pi,\psi)\)</span> may
be given by (see <a href="#ref-MR748505" class="citation" data-cites="MR748505">(J. N.
Bernstein 1984, sec. 6.4)</a>, <a href="#ref-MR1999922" class="citation"
data-cites="MR1999922">(Baruch 2003a, sec. 10.2)</a>) <span
class="math display">\[\|W\|^2 := \int _{N_H \backslash H}
|W|^2.\]</span> We discuss the finer details of the archimedean Kirillov
model in §<a href="#sec:kirillov-model" data-reference-type="ref"
data-reference="sec:kirillov-model">3.1</a>.</p>
<h5 id="sec:essential-vector">§2.14.2. Essential vector</h5>
<p>We retain the setting of §<a href="#sec:local-prelim-kirillov-model"
data-reference-type="ref"
data-reference="sec:local-prelim-kirillov-model">2.14.1</a>, but assume
that <span class="math inline">\(F\)</span> is non-archimedean and <span
class="math inline">\(\psi\)</span> is unramified. Let <span
class="math inline">\(\pi\)</span> be a generic irreducible
representation of <span class="math inline">\(G\)</span>, with Whittaker
model <span class="math inline">\(\mathcal{W}(\pi,\psi)\)</span>.</p>
<p>For a nonzero integral <span
class="math inline">\(\mathfrak{o}\)</span>-ideal <span
class="math inline">\(\mathfrak{q}\)</span>, we write <span
class="math inline">\(K_1(\mathfrak{q}) \leqslant K_0(\mathfrak{q})
\leqslant K\)</span> for the standard congruence subgroups, consisting
of those elements with bottom row lying in <span
class="math inline">\((\mathfrak{q},\dotsc,\mathfrak{q},1 +
\mathfrak{q})\)</span> and <span
class="math inline">\((\mathfrak{q},\dotsc,\mathfrak{q},\mathfrak{o})\)</span>,
respectively. Then <span
class="math inline">\(K_1(\mathfrak{q})\)</span> is a normal subgroup of
<span class="math inline">\(K_0(\mathfrak{q})\)</span>, with quotient
isomorphic to <span class="math inline">\(\mathfrak{o}^\times /
(\mathfrak{o}^\times \cap (1 + \mathfrak{q}))\)</span>.</p>
<p>For a subgroup <span class="math inline">\(J\)</span> of <span
class="math inline">\(G\)</span>, we denote by <span
class="math inline">\(\pi^J\)</span> the subspace of <span
class="math inline">\(\pi\)</span> consisting of vectors invariant by
<span class="math inline">\(J\)</span>.</p>
<p>We recall some results of <a href="#ref-MR620708 MR3138844 MR3001803" class="citation"
data-cites="MR620708 MR3138844 MR3001803">(H. Jacquet,
Piatetski-Shapiro, and Shalika 1981; Matringe 2013; Hervé Jacquet
2012)</a>.</p>
<div class="theorem">
<p><strong>Theorem 20</strong>. <em>Let <span
class="math inline">\(\pi\)</span> be a generic irreducible
representation of <span class="math inline">\(G\)</span>. There is a
unique nonzero integral <span
class="math inline">\(\mathfrak{o}\)</span>-ideal <span
class="math inline">\(\mathfrak{c} = \mathfrak{c}(\pi)\)</span> so that
<span class="math inline">\(\pi^{K_1(\mathfrak{q})}\)</span> is
nontrivial precisely when <span class="math inline">\(\mathfrak{q}
\subseteq \mathfrak{c}\)</span>. The space <span
class="math inline">\(\pi^{K_1(\mathfrak{c})}\)</span> is
one-dimensional. Let <span class="math inline">\(W \in
\mathcal{W}(\pi,\psi)^{K_1(\mathfrak{c})}\)</span> be any basis element.
Then <span class="math inline">\(W(1) \neq 0\)</span>.</em></p>
</div>
<p>We refer to <span class="math inline">\(\mathfrak{c}\)</span> as the
<em>conductor ideal</em> of <span class="math inline">\(\pi\)</span> and
to its absolute norm <span class="math inline">\(C(\pi) := \#
\mathfrak{o} / \mathfrak{c}\)</span> as the <em>conductor</em> of <span
class="math inline">\(\pi\)</span>. We refer to any nonzero element of
that space as an <em>essential vector</em>. We will often impose the
normalization <span class="math inline">\(W(1) = 1\)</span>.</p>
<p>If <span class="math inline">\(\mathfrak{c} = \mathfrak{o}\)</span>,
then <span class="math inline">\(K_1(\mathfrak{c}) = K_0(\mathfrak{c}) =
K\)</span>. Otherwise, writing <span class="math inline">\(\pi|_Z :
F^\times \rightarrow \mathbb{C}^\times\)</span> for the central
character of <span class="math inline">\(\pi\)</span>, the group <span
class="math inline">\(K_0(\mathfrak{c})\)</span> acts on <span
class="math inline">\(\pi^{K_1(\mathfrak{c})}\)</span> via the character
<span class="math inline">\(g \mapsto \pi|_Z(d_g)\)</span> of <span
class="math inline">\(K_1(\mathfrak{c})\)</span>, where <span
class="math inline">\(d_g\)</span> denotes the lower-right entry of
<span class="math inline">\(g\)</span>. In particular, the conductor
ideal of the central character <span
class="math inline">\(\pi|_Z\)</span> divides that of the representation
<span class="math inline">\(\pi\)</span>.</p>
<h5 id="sec:standard-l-factors">§2.14.3. Standard <span
class="math inline">\(L\)</span>-factors</h5>
<p>Let <span class="math inline">\(F\)</span> be local, and let <span
class="math inline">\(G\)</span> be a general linear group. Let <span
class="math inline">\(\pi\)</span> be a generic irreducible admissible
representation of <span class="math inline">\(G\)</span>. The standard
<span class="math inline">\(L\)</span>-factor <span
class="math inline">\(L(\pi,s)\)</span> was defined first by
Godement–Jacquet <a href="#ref-MR0342495" class="citation" data-cites="MR0342495">(Godement
and Jacquet 1972)</a> as the greatest common divisor of a family of
zeta integrals attached to the matrix coefficients of <span
class="math inline">\(\pi\)</span>. It was later interpreted more
broadly, by Jacquet–Piatetski-Shapiro–Shalika (see <a href="#ref-MR701565"
class="citation" data-cites="MR701565">(H. Jacquet, Piatetskii-Shapiro,
and Shalika 1983, sec. 5.1)</a>, <a href="#ref-MR519356" class="citation"
data-cites="MR519356">(Hervé Jacquet, Piatetski-Shapiro, and Shalika
1979a, Thm 4.3)</a>) as the <span
class="math inline">\({\mathop{\mathrm{GL}}}_n \times
{\mathop{\mathrm{GL}}}_1\)</span> case of Rankin–Selberg convolutions for
<span class="math inline">\({\mathop{\mathrm{GL}}}_n \times
{\mathop{\mathrm{GL}}}_m\)</span>. We refer to the summaries <a href="#ref-MR546609"
class="citation" data-cites="MR546609">(Hervé Jacquet 1979)</a> and
<a href="#ref-MR1395406" class="citation" data-cites="MR1395406">(Rudnick and Sarnak 1996,
sec. 2 and Appendix)</a> for further discussion.</p>
<p>Such <span class="math inline">\(L\)</span>-factors may be expressed
as finite products <span class="math inline">\(L(\pi,s) = \prod_{j=1}^m
\zeta_F(s + \mu_{j})\)</span>, where <span class="math inline">\(0
\leqslant m \leqslant n\)</span> and <span class="math inline">\(\mu_j
\in \mathbb{C}\)</span>. If <span class="math inline">\(F\)</span> is
archimedean, or if <span class="math inline">\(F\)</span> is
non-archimedean and <span class="math inline">\(\pi\)</span> is
unramified, then <span class="math inline">\(m = n\)</span>. We remark
that if <span class="math inline">\(\pi\)</span> is unitary, then each
<span class="math inline">\(\Re(\mu_j) &gt; -1/2\)</span> <a href="#ref-MR618323"
class="citation" data-cites="MR618323">(H. Jacquet and Shalika 1981,
sec. 2.5)</a>, <a href="#ref-MR1277950" class="citation" data-cites="MR1277950">(Barthel
and Ramakrishnan 1994, Prop 2.1)</a>, so <span
class="math inline">\(L(\pi,s)\)</span> is holomorphic in the region
<span class="math inline">\(\Re(s) \geqslant 1/2-\varepsilon\)</span>
for some <span class="math inline">\(\varepsilon&gt; 0\)</span>.</p>
<h5 id="sec:zeta-integrals">§2.14.4. Zeta integrals</h5>
<p>Let <span class="math inline">\(F\)</span> be local and let <span
class="math inline">\((G,H)\)</span> be a general linear pair. We
summarize here some basic facts concerning local Rankin–Selberg
integrals for <span class="math inline">\(G \times H\)</span>.</p>
<p>As above, we choose a nondegenerate unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span>, and denote also by <span
class="math inline">\(\psi\)</span> its restriction to <span
class="math inline">\(N_H\)</span>.</p>
<p>Let <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> be generic irreducible
representations of <span class="math inline">\(G\)</span> and <span
class="math inline">\(H\)</span>, respectively. The following discussion
applies also to Whittaker-type representations in the sense of <a href="#ref-MR3753910"
class="citation" data-cites="MR3753910">(Cogdell and Piatetski-Shapiro
2017, sec. 1.5)</a>, i.e., inductions of essentially
square-integrable representations. In particular, it applies to
principal series representations in the sense of §<a
href="#sec:induc-repr" data-reference-type="ref"
data-reference="sec:induc-repr">2.7</a>.</p>
<p>Recall (§<a href="#sec:haar-measures" data-reference-type="ref"
data-reference="sec:haar-measures">2.3.5</a>) that we have chosen Haar
measures on <span class="math inline">\(H\)</span> and <span
class="math inline">\(N_H\)</span> that, in the non-archimedean case,
assign volume one to maximal compact subgroups.</p>
<p>For <span class="math inline">\((W,V,u) \in \mathcal{W}(\pi,\psi)
\times \mathcal{W}(\sigma,\psi^{-1}) \times \mathbb{C}\)</span>, we
define the zeta integral <span class="math display">\[Z(W, V, u) := \int
_{h \in N_H \backslash H} W
  \begin{pmatrix}
    h &amp;  \\
    &amp; 1
  \end{pmatrix}
  V(h) |\det h|^{u-1/2} \, d h,\]</span> provided that it converges.</p>
<p>We recall some results of Jacquet, Piatetski-Shapiro and Shalika.</p>
<div id="thm:local-zeta-rankin-selberg-meromorphic-continuation"
class="theorem">
<p><strong>Theorem 21</strong>. <em>The integral <span
class="math inline">\(Z(W,V,u)\)</span> converges absolutely for <span
class="math inline">\(\Re(u)\)</span> sufficiently large in terms of
<span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span>. It extends meromorphically to the
complex plane. The normalized zeta integral <span
class="math display">\[\frac{Z(W,V,u)}{L(\pi \times \sigma, u)}\]</span>
extends to an entire function of <span
class="math inline">\(u\)</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> See Jacquet–Piatetski-Shapiro–Shalika <a href="#ref-MR701565"
class="citation" data-cites="MR701565">(H. Jacquet, Piatetskii-Shapiro,
and Shalika 1983, sec. 2.7)</a> and Jacquet <a href="#ref-MR2533003" class="citation"
data-cites="MR2533003">(Hervé Jacquet 2009, sec. 5, §8.1)</a>. ◻</p>
</div>
<p>The definition of <span class="math inline">\(Z(W,V,u)\)</span> is
particularly simple in the special case that the restriction of the
Whittaker function <span class="math inline">\(W\)</span> to the
subgroup <span class="math inline">\(H\)</span> has compact support
modulo <span class="math inline">\(N_H\)</span>. In that case, no
meromorphic continuation is necessary - the zeta integral is entire in
<span class="math inline">\(u\)</span>. This trivial case of Theorem <a
href="#thm:local-zeta-rankin-selberg-meromorphic-continuation"
data-reference-type="ref"
data-reference="thm:local-zeta-rankin-selberg-meromorphic-continuation">21</a>
is in fact the only case required for the purposes of this paper.</p>
<p>We now specialize to the case that <span
class="math inline">\(\sigma\)</span> is a principal series
representation <span class="math inline">\(\mathcal{I}(s)\)</span> of
<span class="math inline">\(H\)</span>, as defined in §<a
href="#sec:induc-repr" data-reference-type="ref"
data-reference="sec:induc-repr">2.7</a> for <span
class="math inline">\(s \in \mathfrak{a}_{H,\mathbb{C}}^*\)</span>.
Write <span class="math inline">\((G,H) =
({\mathop{\mathrm{GL}}}_{n+1}(F), {\mathop{\mathrm{GL}}}_n(F))\)</span>.
Using standard diagonal coordinates, we may identify <span
class="math inline">\(\mathfrak{a}_{H,\mathbb{C}}^*\)</span> with <span
class="math inline">\(\mathbb{C}^n\)</span>, hence <span
class="math inline">\(s\)</span> with an <span
class="math inline">\(n\)</span>-tuple <span
class="math inline">\((s_1,\dotsc,s_n)\)</span> of complex numbers <span
class="math inline">\(s_j\)</span>.</p>
<div id="thm:jpss-essential-vector-factorized" class="theorem">
<p><strong>Theorem 22</strong>. <em>Assume that <span
class="math inline">\(F\)</span> is non-archimedean, that <span
class="math inline">\(\psi\)</span> is unramified, and that <span
class="math inline">\(W \in \mathcal{W}(\pi,\psi)\)</span> is the
essential vector (§<a href="#sec:essential-vector"
data-reference-type="ref"
data-reference="sec:essential-vector">2.14.2</a>) with <span
class="math inline">\(W(1) = 1\)</span>. Let <span
class="math inline">\(V \in \mathcal{W}(\mathcal{I}(s),
\psi^{-1})\)</span> be the spherical vector with <span
class="math inline">\(V(1) = 1\)</span>. Then <span
class="math display">\[Z(W,V, u) = L(\pi \times \mathcal{I}(s), u) =
\prod_{j=1}^{n} L(\pi, s_j + u),\]</span> where the RHS denotes a
product of standard <span class="math inline">\(L\)</span>-factors as in
§<a href="#sec:standard-l-factors" data-reference-type="ref"
data-reference="sec:standard-l-factors">2.14.3</a>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> For the first identity, see
Jacquet–Piatetski-Shapiro–Shalika <a href="#ref-MR620708" class="citation"
data-cites="MR620708">(H. Jacquet, Piatetski-Shapiro, and Shalika 1981,
p208)</a>, Matringe <a href="#ref-MR3138844" class="citation"
data-cites="MR3138844">(Matringe 2013, Cor 3.3)</a> or the notes of
Cogdell <a href="#ref-MR2508768" class="citation" data-cites="MR2508768">(Cogdell 2008, Thm
3.3)</a>. For the second identity, see
Jacquet–Piatetski-Shapiro–Shalika <a href="#ref-MR701565" class="citation"
data-cites="MR701565">(H. Jacquet, Piatetskii-Shapiro, and Shalika 1983,
sec. 9.4, §8.4, §5.1)</a>, <a href="#ref-MR519356" class="citation"
data-cites="MR519356">(Hervé Jacquet, Piatetski-Shapiro, and Shalika
1979a, Thm 4.3)</a>. ◻</p>
</div>
<p>We abbreviate <span class="math display">\[Z(W,V) :=
Z(W,V,u)|_{u=1/2},\]</span> where the RHS is interpreted as the value
(possibly infinite) of the meromorphic function <span
class="math inline">\(u \mapsto Z(W,V,u)\)</span>.</p>
<p>Given <span class="math inline">\(f \in \mathcal{I}(s)\)</span>, we
set <span class="math display">\[Z(W,f) := Z(W,
W[f,\psi^{-1}]),\]</span> where <span
class="math inline">\(W[f,\psi^{-1}] \in \mathcal{W}(\mathcal{I}(s),
\psi^{-1})\)</span> denotes the image of <span
class="math inline">\(f\)</span> under the Jacquet integral, as defined
in §<a href="#sec:whittaker-functions-1" data-reference-type="ref"
data-reference="sec:whittaker-functions-1">2.12</a>.</p>
<h5 id="sec:standard-l-functions">§2.14.5. Standard <span
class="math inline">\(L\)</span>-functions</h5>
<p>For simplicity, we assume here that <span class="math inline">\(F =
\mathbb{Q}\)</span>.</p>
<p>Let <span class="math inline">\(G = {\mathop{\mathrm{GL}}}_n\)</span>
be a general linear group, <span class="math inline">\(\pi\)</span> a
cuspidal automorphic representation of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{A})\)</span>. We
recall some properties of the standard <span
class="math inline">\(L\)</span>-function <span
class="math inline">\(L(\pi,s)\)</span> introduced by Godement–Jacquet
<a href="#ref-MR0342495" class="citation" data-cites="MR0342495">(Godement and Jacquet
1972, Lemma 10.20)</a>. We refer to Jacquet <a href="#ref-MR546609" class="citation"
data-cites="MR546609">(Hervé Jacquet 1979)</a>, Rudnick–Sarnak <a href="#ref-MR1395406"
class="citation" data-cites="MR1395406">(Rudnick and Sarnak 1996, sec.
2)</a>, and Iwaniec–Kowalski <a href="#ref-MR2061214" class="citation"
data-cites="MR2061214">(Iwaniec and Kowalski 2004, vol. 53, sec.
5)</a> for further background and details.</p>
<p>For <span class="math inline">\(s \in \mathbb{C}\)</span>, we may
form the twisted representation <span class="math inline">\(\pi \otimes
|.|^s\)</span>, consisting of all functions <span
class="math inline">\(g \mapsto \varphi(g) |\det g|^s\)</span> with
<span class="math inline">\(\varphi \in \pi\)</span>. There is a unique
<span class="math inline">\(\sigma \in \mathbb{R}\)</span> for which the
twist <span class="math inline">\(\pi \otimes |.|^\sigma\)</span> has
unitary central character, and in that case, the Petersson inner product
equips <span class="math inline">\(\pi\)</span> with the structure of a
unitary representation. There is thus little loss of generality in
supposing <span class="math inline">\(\pi\)</span> to be unitary.</p>
<p>For each place <span class="math inline">\(\mathfrak{p}\)</span>, the
local component <span class="math inline">\(\pi_\mathfrak{p}\)</span> is
a generic irreducible representation of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{Q}_\mathfrak{p})\)</span>,
unitary if <span class="math inline">\(\pi\)</span> is. By the
discussion of §<a href="#sec:standard-l-factors"
data-reference-type="ref"
data-reference="sec:standard-l-factors">2.14.3</a>, we obtain standard
local <span class="math inline">\(L\)</span>-factors <span
class="math inline">\(L(\pi_\mathfrak{p},s)\)</span>. As shown by
Godement–Jacquet <a href="#ref-MR0342495" class="citation" data-cites="MR0342495">(Godement
and Jacquet 1972, Lemma 10.20)</a>, the Euler product <span
class="math display">\[L(\pi,s) := \prod_p L(\pi_p,s)\]</span> converges
for <span class="math inline">\(\Re(s)\)</span> sufficiently large
(indeed, for <span class="math inline">\(\Re(s) &gt; 1\)</span> if <span
class="math inline">\(\pi\)</span> is unitary, as shown by
Jacquet–Shalika <a href="#ref-MR618323" class="citation" data-cites="MR618323">(H. Jacquet
and Shalika 1981, I, Thm 5.3)</a>). The completed <span
class="math inline">\(L\)</span>-function <span
class="math inline">\(\Lambda(\pi,s) := L(\pi_\infty,s)
L(\pi,s)\)</span> satisfies a functional equation <span
class="math inline">\(\Lambda(\pi,s) = \varepsilon(\pi,s)
\Lambda(\tilde{\pi},1-s)\)</span>, where <span
class="math inline">\(\tilde{\pi}\)</span> denotes the contragredient
representation (for unitary <span class="math inline">\(\pi\)</span>,
the complex conjugate representation) and <span
class="math inline">\(\varepsilon(\pi,s)\)</span> has the form <span
class="math inline">\(\varepsilon(\pi,s) = \varepsilon(\pi)
C(\pi_{\mathop{\mathrm{fin}}})^{1/2-s}\)</span>, with <span
class="math inline">\(|\varepsilon(\pi)| = 1\)</span> for unitary <span
class="math inline">\(\pi\)</span>.</p>
<p>The finite conductor <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}}) \in
\mathbb{Z}_{\geqslant 1}\)</span> of <span
class="math inline">\(\pi\)</span> is defined to be the product <span
class="math inline">\(\prod_p C(\pi_p)\)</span> of the local conductors,
as defined in §<a href="#sec:essential-vector" data-reference-type="ref"
data-reference="sec:essential-vector">2.14.2</a>; only finitely many of
these local conductors are not equal to one, so the product is really a
finite product. Recall from §<a href="#sec:subc-bounds-assum"
data-reference-type="ref" data-reference="sec:subc-bounds-assum">1.2</a>
that if <span class="math inline">\(\pi\)</span> has archimedean <span
class="math inline">\(L\)</span>-function parameters <span
class="math inline">\(t_1,\dotsc,t_n\)</span>, i.e., if <span
class="math inline">\(L(\pi_\infty, s) = \prod_{j=1}^n
\Gamma_{\mathbb{R}}(s + t_j)\)</span>, then its archimedean conductor is
defined by <span class="math inline">\(C(\pi_\infty) = \prod_{j=1}^n (3
+ |t_j|)\)</span>, and its global analytic conductor by <span
class="math inline">\(C(\pi) = C(\pi_\infty)
C(\pi_{\mathop{\mathrm{fin}}})\)</span>.</p>
<p>The completed <span class="math inline">\(L\)</span>-function <span
class="math inline">\(\Lambda(\pi,s)\)</span> is bounded in vertical
strips, so <span class="math inline">\(L(\pi,s)\)</span> is of order
one. The absolute convergence of the Euler product, the functional
equation, and the Phragmen–Lindelöf convexity principle then imply that
<span class="math inline">\(L(\pi,s)\)</span> is polynomially bounded in
vertical strips (see <a href="#ref-MR2061214" class="citation"
data-cites="MR2061214">(Iwaniec and Kowalski 2004, Lemma 5.2)</a>):
for <span class="math inline">\(\Re(s) \ll 1\)</span>, <span id="eq:lpi-tfrac12-+-2" class="math display">\[\label{eq:lpi-tfrac12-+-2}\tag{2.36}
  L(\pi, \tfrac{1}{2} + s) \ll C(\pi)^{\operatorname{O}(1)} (1 +
|s|)^{\operatorname{O}(1)},\]</span> provided that <span
class="math inline">\(n \geqslant 2\)</span>; when <span
class="math inline">\(n = 1\)</span> and <span
class="math inline">\(L(\pi,s) = \zeta(s)\)</span>, this estimate must
be modified to take into account the pole at <span
class="math inline">\(s=1\)</span>.</p>
<p>We recall the convexity bound:</p>
<div id="lem:convexity-bound" class="lemma">
<p><strong>Lemma 23</strong>. Let <span
class="math inline">\(\pi\)</span> be a unitary cuspidal automorphic
representation of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span>, as above, with <span
class="math inline">\(n \geqslant 1\)</span> fixed. Then for <span
class="math inline">\(\sigma \in \mathbb{R}\)</span> with <span
class="math inline">\(\sigma \geqslant-1/2\)</span>, <span id="eq:lpi-tfrac12-+sigma" class="math display">\[\label{eq:lpi-tfrac12-+sigma}\tag{2.37}
    L(\pi, \tfrac{1}{2} +\sigma)
    \ll
    C(\pi)^{\max(0,(1 - 2 \sigma)/4) + o(1)},\]</span> except when <span
class="math inline">\(n=1\)</span> and the LHS is of the form <span
class="math inline">\(\zeta(s)\)</span> with <span
class="math inline">\(s\)</span> in some fixed neighborhood of <span
class="math inline">\(1\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> The case <span class="math inline">\(\sigma \geqslant
0\)</span> is recorded by Iwaniec–Kowalski <a href="#ref-MR2061214" class="citation"
data-cites="MR2061214">(Iwaniec and Kowalski 2004, Thm 5.41)</a>. The
general case follows from the functional equation and Phragmen–Lindelöf,
as in <a href="#ref-MR2061214" class="citation" data-cites="MR2061214">(Iwaniec and
Kowalski 2004, vol. 53, sec. 5, Exercise 3)</a>. ◻</p>
</div>
<div class="remark">
<p><strong>Remark 24</strong>. We note that <a
href="#eq:lpi-tfrac12-+sigma" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-+sigma">\((2.37)\)</a>,
unlike <a href="#eq:lpi-tfrac12-+-2" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-+-2">\((2.36)\)</a>, is uniform
in <span class="math inline">\(\pi\)</span>, and does not follow
formally from the functional equation (without assuming strong
hypotheses on <span class="math inline">\(\pi\)</span>, such as the
Ramanujan conjecture). The key estimates underlying the proof of <a
href="#eq:lpi-tfrac12-+sigma" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-+sigma">\((2.37)\)</a> are
due to Iwaniec <a href="#ref-MR1067982" class="citation" data-cites="MR1067982">(Iwaniec
1990)</a> when <span class="math inline">\(n=2\)</span> and to
Molteni <a href="#ref-MR1876443" class="citation" data-cites="MR1876443">(Molteni
2002)</a> for general <span class="math inline">\(n\)</span>. Despite
the fact that the main results of this paper improve upon the estimate
<a href="#eq:lpi-tfrac12-+sigma" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-+sigma">\((2.37)\)</a> in
many cases, we do not in any sense “reprove” that estimate: it provides
an important input to our arguments.</p>
</div>
<p>The twisted representation <span class="math inline">\(\pi \otimes
|.|^s\)</span> has archimedean <span
class="math inline">\(L\)</span>-function parameters <span
class="math display">\[t_1+s,\dotsc,t_n+s\]</span> and the same finite
conductor as <span class="math inline">\(\pi\)</span>, hence <span
class="math display">\[C(\pi \otimes |.|^s) =
C(\pi_{\mathop{\mathrm{fin}}}) \prod_{j=1}^n (3 + |t_j + s|).\]</span>
Since <span class="math inline">\(C(\pi \otimes |.|^s) \ll (1 + |s|)^{n}
C(\pi)\)</span>, the convexity bound <a href="#eq:lpi-tfrac12-+sigma"
data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-+sigma">\((2.37)\)</a>
contains the estimate: for <span class="math inline">\(s \in
\mathbb{C}\)</span> with <span class="math inline">\(|\Re(s)| \leqslant
1/2\)</span>, <span id="eqn:convexity-polynomially-in-s" class="math display">\[\label{eqn:convexity-polynomially-in-s}\tag{2.38}
  L(\pi, \tfrac{1}{2} +s)
  \ll
  C(\pi)^{(1 - 2 s_j)/4 + o(1)}
  (1 + |s|)^{\operatorname{O}(1)}.\]</span></p>
<h4 id="sec:eisenstein-series">§2.15. Eisenstein series</h4>
<p>Let <span class="math inline">\(F\)</span> be a number field.</p>
<h5 id="definition-and-convergence">Definition and convergence</h5>
<p>We will be concerned primarily with “minimal” Eisenstein series
coming from the Borel subgroup <span class="math inline">\(Q\)</span>.
(We will eventually need to consider “mirabolic” or “Siegel-type”
Eisenstein series, as well, but we treat those separately as they
arise.)</p>
<p>For a function <span class="math inline">\(f\)</span> on <span
class="math inline">\([G]_Q\)</span>, we denote by <span
class="math inline">\(\mathop{\mathrm{Eis}}(f) : [G] \rightarrow
\mathbb{C}\)</span> the usual series, provided that it converges
absolutely: <span class="math display">\[\mathop{\mathrm{Eis}}(f)(g) :=
\sum _{\gamma \in Q(F) \backslash G(F)} f(\gamma g).\]</span> When we
wish to explicate which groups are being considered, we write more
verbosely <span
class="math inline">\({\mathop{\mathrm{Eis}}}_Q^G\)</span>.</p>
<p>Standard convergence arguments as in <a href="#ref-MR2331343" class="citation"
data-cites="MR2331343">(Borel 2007, sec. 12)</a> give that for each
<span class="math inline">\(\varepsilon&gt; 0\)</span>, there exists
<span class="math inline">\(m \geqslant 0\)</span> so that <span id="eq:sup_g-in-gmathbba" class="math display">\[\label{eq:sup_g-in-gmathbba}\tag{2.39}
  \sup_{g \in G(\mathbb{A})} \|g\|^{-m}
  \int_{ (\sigma)
  }
  \sum_{\gamma \in Q(F) \backslash G(F)} |\mathfrak{a}(\gamma
g)|^{(1+\varepsilon) \rho_U} \, d \chi &lt; \infty,\]</span> where the
integral is taken over <span class="math inline">\(\chi \in
\mathfrak{X}([A])\)</span> with <span class="math inline">\(\Re(\chi) =
\sigma\)</span>, following the notation <a href="#eq:int-_sigma-fs"
data-reference-type="eqref"
data-reference="eq:int-_sigma-fs">\((2.6)\)</a>. It follows
that <span class="math inline">\(\mathop{\mathrm{Eis}}(f)\)</span>
converges absolutely if <span class="math inline">\(f \in
\mathcal{I}(\chi)\)</span> for some <span class="math inline">\(\chi \in
\mathfrak{X}([A])\)</span> with <span class="math inline">\(\Re(\chi)
\succ \rho_U\)</span>, in which case <span
class="math inline">\(\mathop{\mathrm{Eis}}(f) \in
\mathcal{T}([G])\)</span>. The arguments of <a href="#ref-MR1361168" class="citation"
data-cites="MR1361168">(Mœglin and Waldspurger 1995, vol. 113, secs.
II.1.7, II.1.10)</a> show that <span
class="math inline">\(\mathop{\mathrm{Eis}}(f)\)</span> converges for
<span class="math inline">\(f \in \mathcal{S}([G]_Q)\)</span>, in which
case <span class="math inline">\(\mathop{\mathrm{Eis}}(f) \in
\mathcal{S}([G])\)</span>, and the induced map <span
class="math display">\[\mathop{\mathrm{Eis}}: \mathcal{S}([G]_Q)
\rightarrow \mathcal{S}([G])\]</span> is continuous. (By the definition
of the topologies, we can check the continuity after passing to
invariants for some compact open subgroup <span
class="math inline">\(J\)</span> of <span
class="math inline">\(G(\mathbb{A}_f)\)</span>. We then appeal to <a href="#ref-MR1001613"
class="citation" data-cites="MR1001613">(Casselman 1989, Prop
1.13)</a>.)</p>
<h5 id="meromorphic-continuation-and-mellin-expansion">Meromorphic
continuation and Mellin expansion</h5>
<p>For any holomorphic family <span
class="math inline">\(\{f[\chi]\}_{\chi \in \mathfrak{X}([A])}\)</span>,
the assignment <span class="math inline">\(\chi \mapsto
\mathop{\mathrm{Eis}}(f[\chi])\)</span>, defined for <span
class="math inline">\(\Re(\chi) \succ \rho_U\)</span> by the series,
extends to a meromorphic vector-valued map <span
class="math inline">\(\mathfrak{X}([A]) \rightarrow
\mathcal{T}([G])\)</span>. We refer to <a href="#ref-MR2402686" class="citation"
data-cites="MR2402686">(E. M. Lapid 2008)</a> for precise statements
and proofs, and also to <a href="#ref-MR3219530" class="citation"
data-cites="MR3219530">(J. Bernstein and Krötz 2014, Thm
11.7)</a>.</p>
<p>Let <span class="math inline">\(f \in \mathcal{S}([G]_Q)\)</span>,
with corresponding holomorphic family of Mellin components <span
class="math inline">\(\{f[\chi]\}_{\chi \in \mathfrak{X}([A])}\)</span>
(necessarily of rapid vertical decay). Let <span
class="math inline">\(\sigma \in \mathfrak{a}^*\)</span> with <span
class="math inline">\(\sigma \succ \rho_U\)</span>. By <a
href="#eq:sup_g-in-gmathbba" data-reference-type="eqref"
data-reference="eq:sup_g-in-gmathbba">\((2.39)\)</a>, there
exists <span class="math inline">\(m \geqslant 0\)</span> so that <span
class="math display">\[\sup_{g \in G(\mathbb{A})} \|g\|^{-m}
    \int_{ (\sigma)  }
\sum_{\gamma \in Q(F) \backslash G(F)} |f[\chi](\gamma g)| \, d
\chi  &lt; \infty,\]</span> and similarly for archimedean derivatives.
By interchanging integration with summation, it follows that <span id="eq:eisf-=-int" class="math display">\[\label{eq:eisf-=-int}\tag{2.40}
  \mathop{\mathrm{Eis}}(f) = \int _{(\sigma) }
\mathop{\mathrm{Eis}}(f[\chi]) \, d \chi,\]</span> where the integral
converges in <span class="math inline">\(\mathcal{T}([G])\)</span>. In
particular, for any <span class="math inline">\(\varphi \in
\mathcal{S}([G])\)</span>, we have <span id="eq:int-_g-eisf" class="math display">\[\label{eq:int-_g-eisf}\tag{2.41}
  \int _{[G]} \mathop{\mathrm{Eis}}(f) \varphi
  = \int _{(\sigma)}
  \left( \int _{[G]} \mathop{\mathrm{Eis}}(f[\chi]) \varphi  \right) \,
d \chi.\]</span></p>
<h5 id="sec:whittaker-functions">§2.15.3. Whittaker functions</h5>
<p>Let <span class="math inline">\(\psi : N(\mathbb{A}) \rightarrow
\mathop{\mathrm{U}}(1)\)</span> be a nondegenerate character, trivial on
<span class="math inline">\(N(F)\)</span>. Provided that <span
class="math inline">\(\mathop{\mathrm{Eis}}(f)\)</span> converges
absolutely and locally uniformly, we have the standard unfolding
calculation (see, e.g., <a href="#ref-MR2683009" class="citation"
data-cites="MR2683009">(Shahidi 2010, Prop 7.1.3)</a>) <span id="eq:weisf-psig-=" class="math display">\[\label{eq:weisf-psig-=}\tag{2.42}
  W[\mathop{\mathrm{Eis}}(f),\psi](g) = W[f,\psi](g) := \int _{u
\in  N(\mathbb{A})} f(w_G^{-1} u g) \psi^{-1}(u) \, d u.\]</span></p>
<h5 id="functional-equation">Functional equation</h5>
<p>For <span class="math inline">\(f \in \mathcal{I}(\chi)\)</span>, we
have the functional equation <span id="eq:eisenstein-series-functional-equation" class="math display">\[\label{eq:eisenstein-series-functional-equation}\tag{2.43}
  \mathop{\mathrm{Eis}}(M_w f[\chi]) =
\mathop{\mathrm{Eis}}(f[\chi])\]</span> whenever both sides are
defined.</p>
<h5 id="sec:constant-terms">§2.15.5. Constant terms</h5>
<p>Let <span class="math inline">\(P\)</span> be a parabolic subgroup of
<span class="math inline">\(G\)</span> that contains <span
class="math inline">\(A\)</span>. We factor <span
class="math inline">\(P = M U_P\)</span>, with <span
class="math inline">\(M\)</span> the unique Levi factor containing <span
class="math inline">\(A\)</span>.</p>
<p>The constant term with respect to <span
class="math inline">\(P\)</span> of a continuous function <span
class="math inline">\(\varphi\)</span> on <span
class="math inline">\([G]\)</span> is the function <span
class="math inline">\(\varphi_P : [G]_P \rightarrow \mathbb{C}\)</span>
defined by <span class="math inline">\(\varphi_P(g) := \int _{[U_P]}
\varphi(u g) \, d u\)</span>.</p>
<p>For <span class="math inline">\(f \in \mathcal{S}([G]_Q)\)</span>, or
for <span class="math inline">\(f \in \mathcal{I}(\chi)\)</span> with
<span class="math inline">\(\Re(\chi) \succ \rho_U\)</span>, we have by
standard unfolding calculations <a href="#ref-MR1361168" class="citation"
data-cites="MR1361168">(Mœglin and Waldspurger 1995, 113:p101 and
§II.1.7)</a> that <span id="eq:int_g-eisf-varphi" class="math display">\[\label{eq:int_g-eisf-varphi}\tag{2.44}
  \int_{[G]} \mathop{\mathrm{Eis}}(f) \varphi = \int_{[G]_Q} f \varphi_Q
\quad \text{ for } \varphi \in \mathcal{S}([G])\]</span> and <span id="eq:eisf_b-=-sum" class="math display">\[\label{eq:eisf_b-=-sum}\tag{2.45}
  \mathop{\mathrm{Eis}}(f)_Q = \sum _{w \in W} M_w f.\]</span> Such
identities extend meromorphically to <span class="math inline">\(f \in
\mathcal{I}(\chi)\)</span> for almost all <span
class="math inline">\(\chi\)</span>.</p>
<p>For general <span class="math inline">\(P\)</span> as above, the
intersection <span class="math inline">\(Q_{M} := Q \cap M\)</span> is a
Borel subgroup of <span class="math inline">\(M\)</span>, and for <span
class="math inline">\(f \in \mathcal{S}([G]_Q)\)</span>, we have <span id="eq:eis_bgf_p-=-sum" class="math display">\[\label{eq:eis_bgf_p-=-sum}\tag{2.46}
  {\mathop{\mathrm{Eis}}}_Q^G(f)_P = \sum _{w \in W(A,M)}
{\mathop{\mathrm{Eis}}}_{Q_{M}}^{M} (M_w f),\]</span> where <span
class="math inline">\(W(A,M)\)</span> denotes the set of all <span
class="math inline">\(w \in W\)</span> such that <span
class="math inline">\(w^{-1}(\alpha) &gt; 0\)</span> for all positive
roots <span class="math inline">\(\alpha\)</span> for <span
class="math inline">\((M,A)\)</span>, and where each Eisenstein series
appearing on the RHS of <a href="#eq:eis_bgf_p-=-sum"
data-reference-type="eqref"
data-reference="eq:eis_bgf_p-=-sum">\((2.46)\)</a> converges
absolutely. This again follows from an unfolding calculation as in
<em>loc. cit</em>, the main point being, as noted in <em>loc cit.</em>,
that the set <span class="math inline">\(W(A,M)\)</span> defines a
system of representatives for <span class="math inline">\(Q(F)
\backslash G(F) / P(F)\)</span>.</p>
<p>For a holomorphic family <span
class="math inline">\(\{f[\chi]\}_{\chi \in \mathfrak{X}([A])}\)</span>,
the Eisenstein series <span
class="math inline">\(\mathop{\mathrm{Eis}}(f[\chi])\)</span> is
holomorphic in <span class="math inline">\(\chi\)</span> if and only its
constant term <span
class="math inline">\(\mathop{\mathrm{Eis}}(f[\chi])_Q\)</span> with
respect to the Borel <span class="math inline">\(Q\)</span> has the same
property (see <a href="#ref-MR1361168" class="citation" data-cites="MR1361168">(Mœglin and
Waldspurger 1995, vol. 113, sec. I.4.10 and Remark p167)</a>). By <a
href="#eq:eisf_b-=-sum" data-reference-type="eqref"
data-reference="eq:eisf_b-=-sum">\((2.45)\)</a>, the latter
condition holds provided that <span class="math inline">\(M_w
f[\chi]\)</span> is holomorphic in <span
class="math inline">\(\chi\)</span> for each <span
class="math inline">\(w \in W\)</span>.</p>
<h5 id="inner-product-formulas">Inner product formulas</h5>
<p>We require the following consequence of the spectral theory of
Eisenstein series.</p>
<div id="lem:let-f_1-f_2" class="proposition">
<p><strong>Proposition 25</strong>. <em>Let <span
class="math inline">\(f_1, f_2 \in \mathcal{S}([G]_Q)\)</span>. Assume
that for each <span class="math inline">\(j=1,2\)</span> and <span
class="math inline">\(w \in W\)</span>, we have <span
class="math inline">\(M_w f_j \in \mathcal{S}([G]_Q)\)</span>. Then
<span class="math display">\[\begin{align}
  \left\langle \mathop{\mathrm{Eis}}(f_1), \mathop{\mathrm{Eis}}(f_2)
\right\rangle
    &amp;= \sum_{w \in W}
  \left\langle f_1, M_w f_2 \right\rangle \\
    &amp;=
      \frac{1}{|W|}
  \left\langle \sum _{w \in W} M_w f_1, \sum _{w \in W } M_w f_2
\right\rangle.
  
\end{align}\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> By <a href="#eq:int_g-eisf-varphi"
data-reference-type="eqref"
data-reference="eq:int_g-eisf-varphi">\((2.44)\)</a> and <a
href="#eq:eis_bgf_p-=-sum" data-reference-type="eqref"
data-reference="eq:eis_bgf_p-=-sum">\((2.46)\)</a>, we have
<span class="math display">\[\int _{[G]} \mathop{\mathrm{Eis}}(f_1)
\mathop{\mathrm{Eis}}(f_2)
    =
    \int _{[G]_Q} f_1 \mathop{\mathrm{Eis}}(f_2)_Q
    = \sum _{w \in W}
    \int _{[G]_Q} f_1 \cdot  M_w f_2.\]</span> By applying complex
conjugation to <span class="math inline">\(f_2\)</span>, we obtain the
first identity.</p>
<p>We now study, for <span class="math inline">\(w_1, w_2 \in
W\)</span>, the integrals <span class="math display">\[\int _{[G]_Q}
M_{w_1} f_1 \cdot M_{w_2} f_2,\]</span> which converge in view of our
assumption that each <span class="math inline">\(M_w f_j\)</span> lies
in <span class="math inline">\(\mathcal{S}([G]_Q)\)</span>. We evaluate
<span class="math inline">\(M_{w_2} f_2\)</span> by considering the
Mellin expansion <span class="math inline">\(f_2 = \int _{(\sigma)}
f_2[\chi] \, d \chi\)</span> (§<a
href="#sec:mellin-paley-affine-quotients" data-reference-type="ref"
data-reference="sec:mellin-paley-affine-quotients">2.8.3</a>), initially
for sufficiently dominant <span class="math inline">\(\sigma \in
\mathfrak{a}^*\)</span>. Since <span
class="math inline">\(f_2[\chi]\)</span> has rapid vertical decay, the
double integral defining <span class="math inline">\(M_{w_2}
f_2\)</span> then converges absolutely, so the order of integration may
be swapped, giving <span class="math inline">\(M_{w_2} f_2 = \int
_{(\sigma)} M_{w_2} f_2[\chi] \, d \chi\)</span>. Our assumption that
<span class="math inline">\(M_{w_2} f_2\)</span> lies in <span
class="math inline">\(\mathcal{S}([G]_Q)\)</span> now implies that the
family <span class="math inline">\(M_{w_2} f_2[\chi]\)</span> is
holomorphic and has rapid vertical decay, so we may shift the contour to
<span class="math inline">\(\sigma = 0\)</span>. Since also <span
class="math inline">\(M_{w_1} f_1 \in \mathcal{S}([G]_Q)\)</span>, it
follows that <span class="math display">\[\int _{g \in [G]_Q} |M_{w_1}
f_1(g)| \int _{(0)} \left\lvert M_{w_2} f_2[\chi](g)  \right\rvert \, d
\chi \, d g &lt; \infty.\]</span> We may thus exchange integrals once
more to arrive at <span class="math display">\[\int _{[G]_Q} M_{w_1} f_1
\cdot M_{w_2} f_2
    = \int _{(0)} \left( \int _{[G]_Q} M_{w_1} f_1(g) \cdot M_{w_2}
f_2[\chi](g) \, d g \right) \, d \chi.\]</span> The same identity holds
with <span class="math inline">\(f_2\)</span> replaced by its complex
conjugate. Evaluating the resulting integral over <span
class="math inline">\([G]_Q\)</span> using the Iwasawa decomposition, we
obtain <span class="math display">\[\left\langle M_{w_1} f_1, M_{w_2}
f_2 \right\rangle
    =
    \int _{(0)}
    \left\langle M_{w_1} f_1[\chi], M_{w_2} f_2[\chi] \right\rangle \, d
\chi.\]</span> The unitarity of the intertwining operators <span
class="math inline">\(M_w\)</span> on the unitary axis <span
class="math inline">\(\Re(\chi) = 0\)</span> (see <a
href="#eq:langle-f_1-f_2" data-reference-type="eqref"
data-reference="eq:langle-f_1-f_2">\((2.25)\)</a>) and their
composition formula (see <a href="#eq:m_w_1w_2-chi-circ"
data-reference-type="eqref"
data-reference="eq:m_w_1w_2-chi-circ">\((2.26)\)</a>) now
give <span class="math display">\[\begin{align}
    \left\langle M_{w_1} f_1, M_{w_2} f_2 \right\rangle
    &amp;=
    \left\langle f_1, M_{w_1}^{-1} M_{w_2} f_2 \right\rangle \\
    &amp;=
    \left\langle f_1, M_{w_1^{-1} w_2} f_2 \right\rangle.
  
\end{align}\]</span> Summing this relation over all <span
class="math inline">\(w_1\)</span> and <span
class="math inline">\(w_2\)</span> yields the second required identity
in the statement of Proposition <a href="#lem:let-f_1-f_2"
data-reference-type="ref" data-reference="lem:let-f_1-f_2">25</a>. ◻</p>
</div>
<div class="remark">
<p><strong>Remark 26</strong>. Proposition <a href="#lem:let-f_1-f_2"
data-reference-type="ref" data-reference="lem:let-f_1-f_2">25</a> is
essentially contained in <a href="#ref-MR3468638" class="citation"
data-cites="MR3468638">(Gelfand, Graev, and Pyatetskii-Shapiro 2016,
secs. 3.6.6, p384)</a>, although not quite in the stated form.</p>
</div>
<h4 id="sec:compl-eisenst-seri">§2.16. Completed Eisenstein series</h4>
<p>For simplicity, we now take <span class="math inline">\(F =
\mathbb{Q}\)</span> and assume that <span
class="math inline">\(G\)</span> arises from a split reductive group
over <span class="math inline">\(\mathbb{Z}\)</span>, which we continue
to denote by <span class="math inline">\(G\)</span>. (The results of
this section represent the special case <span class="math inline">\(F =
\mathbb{Q}\)</span> and <span class="math inline">\(S =
\{\infty\}\)</span>, adequate for our immediate applications, of more
general results concerning any number field <span
class="math inline">\(F\)</span> and large enough finite set of places
<span class="math inline">\(S\)</span>.) We assume that <span
class="math inline">\(K_p = G(\mathbb{Z}_p)\)</span> for each finite
prime <span class="math inline">\(p\)</span>.</p>
<h5 id="sec:notat-basic-defin">§2.16.1. Notation and basic definition</h5>
<p>Recall from §<a href="#sec:induc-repr" data-reference-type="ref"
data-reference="sec:induc-repr">2.7</a> that, for <span
class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span>, we
denote by <span class="math inline">\(\mathcal{I}(s) =
{\mathop{\mathrm{Ind}}}_{Q(\mathbb{A})}^{G(\mathbb{A})} (|.|^s)\)</span>
the corresponding principal series representation of <span
class="math inline">\(G(\mathbb{A})\)</span>, which is the restricted
tensor product, over places <span
class="math inline">\(\mathfrak{p}\)</span> of <span
class="math inline">\(\mathbb{Q}\)</span>, of the local principal series
representations <span class="math inline">\(\mathcal{I}_\mathfrak{p}(s)
=
{\mathop{\mathrm{Ind}}}_{Q(\mathbb{Q}_\mathfrak{p})}^{G(\mathbb{Q}_\mathfrak{p})}(|.|_{\mathfrak{p}}^s)\)</span>.
For each finite prime <span class="math inline">\(p\)</span> and all
<span class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span>,
we temporarily write <span id="eq:holomorphic-families-f-p-of-s" class="math display">\[\label{eq:holomorphic-families-f-p-of-s}\tag{2.47}
  f_p[s] \in \mathcal{I}_p(s) \subseteq C^\infty(U(\mathbb{Q}_p)
\backslash G(\mathbb{Q}_p))\]</span> for the spherical vector normalized
by requiring that <span class="math inline">\(f_p[s](1) =
1\)</span>.</p>
<p>As in §<a href="#sec:local-zeta-functions" data-reference-type="ref"
data-reference="sec:local-zeta-functions">2.10</a>, for <span
class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span>, we
define <span class="math inline">\(\zeta(U,s)\)</span>, initially for
<span class="math inline">\(\Re(s) \succ 0\)</span> by the convergent
Euler product <span id="eq:zeta-U-s-global-over-Z" class="math display">\[\label{eq:zeta-U-s-global-over-Z}\tag{2.48}
  \zeta(U,s) :=
  \prod_p
  \zeta_p(U,s)
  =
  \prod_{\alpha \in R_U^+}
  \zeta(1 + \alpha^\vee(s)),\]</span> then in general via meromorphic
continuation. We also define the <span
class="math inline">\(W\)</span>-invariant polynomial <span
class="math display">\[\mathcal{P}_G(s)
  :=
  \prod_{\alpha \in R}
  \alpha^\vee(s)
  (1 - \alpha^\vee(s))
  =
  \prod_{\alpha \in R_U^+}
  \alpha^\vee(s)^2
  (\alpha^\vee(s)^2 - 1).\]</span> The product <span
class="math inline">\(\mathcal{P}_G(s) \zeta(U,s)\)</span> is then
entire and of polynomial growth in vertical strips, hence acts as a
multiplier on, e.g., <span
class="math inline">\(\mathcal{S}^e(U(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span>.</p>
<p>Let <span class="math inline">\(f_\infty \in
\mathcal{S}^e(U(\mathbb{R}) \backslash G(\mathbb{R}))\)</span>, with
associated Mellin components <span class="math inline">\(f_\infty[s] \in
\mathcal{I}_\infty(s)\)</span>.</p>
<p>For <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span>, define <span
class="math inline">\(\Phi[f_\infty][s] \in \mathcal{I}(s)\)</span> by
the formula <span id="eq:phis-:=-qn" class="math display">\[\label{eq:phis-:=-qn}\tag{2.49}
  \Phi[f_\infty][s] = \mathcal{P}_G(s) \zeta(U,s) \otimes_{\mathfrak{p}}
f_\mathfrak{p}[s].\]</span> This defines a holomorphic family of vectors
of rapid vertical decay. Per the discussion of §<a
href="#sec:mellin-paley-affine-quotients" data-reference-type="ref"
data-reference="sec:mellin-paley-affine-quotients">2.8.3</a>, this
family arises by taking the Mellin components of some element <span
class="math inline">\(\Phi[f_\infty]\)</span> of the Schwartz space
<span class="math inline">\(\mathcal{S}^e([G]_Q)\)</span>. We obtain a
<span class="math inline">\(G(\mathbb{R})\)</span>-equivariant linear
map <span class="math display">\[\Phi : \mathcal{S}^e(U(\mathbb{R})
\backslash G(\mathbb{R})) \rightarrow \mathcal{S}^e([G]_Q)\]</span>
<span class="math display">\[f_\infty \mapsto \Phi[f_\infty].\]</span>
This map may be used to define the “completed” pseudo Eisenstein series
<span class="math display">\[\begin{align}
  \mathop{\mathrm{Eis}}[\Phi[f_\infty]]
  &amp;= \int _{(\sigma)} \mathop{\mathrm{Eis}}[\Phi[f_\infty][s]] \, d
\mu_{[A]}(s)
    \quad \quad (\sigma \succ \rho_U) \\
  &amp;= \int _{(\sigma)} \mathcal{P}_G(s) \zeta(U,s)
    \mathop{\mathrm{Eis}}[\otimes_{\mathfrak{p}} f_\mathfrak{p}[s]] \, d
\mu_{[A]}(s).
\end{align}\]</span> In what follows, we drop the subscript <span
class="math inline">\(\infty\)</span>, writing simply <span
class="math inline">\(f\)</span> for an element of <span
class="math inline">\(\mathcal{S}^e(U(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span> and <span class="math inline">\(\Phi[f]\)</span>
for the associated element of <span
class="math inline">\(\mathcal{S}^e([G]_Q)\)</span>.</p>
<p>We note that for <span class="math inline">\(a \in A(\mathbb{R})
\hookrightarrow A(\mathbb{A})\)</span>, we have <span
class="math display">\[\Phi[L(a) f] = L(a) \Phi[f].\]</span> Indeed,
both sides have Mellin components <span class="math display">\[|a|^s
\mathcal{P}_G(s) \zeta(U,s) f[s] \otimes (\otimes_p
f_p[s]).\]</span></p>
<div id="rmk:one-could-altern" class="remark">
<p><strong>Remark 27</strong>. Given <span class="math inline">\(f \in
\mathcal{S}^e(U(\mathbb{R}) \backslash G(\mathbb{R}))\)</span>, one
could alternatively define <span class="math inline">\(\Phi[f]\)</span>
as follows. Set <span class="math display">\[f ^\sharp [s] :=
\mathcal{P}_G(s) \zeta(U,s) f[s].\]</span> This defines a holomorphic
family of rapid vertical decay, corresponding to some element <span
class="math inline">\(f ^\sharp \in \mathcal{S}^e(U(\mathbb{R})
\backslash G(\mathbb{R}))\)</span>. Note that here that <span
class="math inline">\(\zeta(U,s)\)</span>, defined initially by an Euler
product over the primes, is being employed as a Mellin multiplier at the
archimedean place. At a finite place <span
class="math inline">\(p\)</span>, the holomorphic family <a
href="#eq:holomorphic-families-f-p-of-s" data-reference-type="eqref"
data-reference="eq:holomorphic-families-f-p-of-s">\((2.47)\)</a>
corresponds to the element <span class="math inline">\(f_p \in
\mathcal{S}(U(\mathbb{Q}_p) \backslash G(\mathbb{Q}_p))\)</span> given
by the characteristic function of <span
class="math inline">\(U(\mathbb{Q}_p) K_p\)</span>. A simple application
of Mellin inversion gives <span class="math display">\[\Phi[f](g) = \sum
_{c \in A(\mathbb{Q})} f ^\sharp (c g) \prod_p f_p(c g).\]</span>
Indeed, the convergent integrals <span class="math display">\[\int
_{[A]} |a|^{-\rho_U - s}\Phi[f](a g)  \, d a\]</span> and <span
class="math display">\[\begin{align}
    &amp;\int _{[A]} |a|^{-\rho_U - s}\sum _{c \in A(\mathbb{Q})} f
^\sharp (c a_\infty  g_\infty ) \prod_p f _p (c a_p g_p) \, d a \\
    &amp;\quad =
    \int _{A(\mathbb{A}) } |a|^{-\rho_U - s} f ^\sharp
(a_\infty  g_\infty ) \prod _p f _p (a_p g_p) \, d a
  
\end{align}\]</span> both evaluate to <span class="math display">\[f
^\sharp [s] (g _\infty ) \prod _p f _p [s] (g _p).\]</span> Here we note
that the sum over <span class="math inline">\(c\)</span> is in fact a
finite sum; for example, if <span class="math inline">\(g \in
G(\mathbb{R})\)</span>, then <span class="math inline">\(\Phi[f](g) =
\sum _{c \in A(\mathbb{Z})} f ^\sharp (c g)\)</span>. One derives
different series representations, analogous to <a href="#eq:eg-=-sum"
data-reference-type="eqref"
data-reference="eq:eg-=-sum">\((2.51)\)</a>, by “diverting” the
Mellin multiplier <span class="math inline">\(\zeta(U,s)\)</span> from
the archimedean place to the finite place. We explain this passage in
greater detail, together with some variants, starting in §<a
href="#sec:interl-basic-vect" data-reference-type="ref"
data-reference="sec:interl-basic-vect">3.7</a>.</p>
<p>In the above optic, the associated Eisenstein series is given by
<span id="eq:eisphif=-sum-_gamma" class="math display">\[\label{eq:eisphif=-sum-_gamma}\tag{2.50}
    \mathop{\mathrm{Eis}}[\Phi[f]](g) = \sum _{\gamma \in Q(\mathbb{Q})
\backslash G(\mathbb{Q}) } \Phi[f](\gamma g)
    = \sum _{\gamma \in U(\mathbb{Q}) \backslash G(\mathbb{Q})} f
^\sharp (\gamma g_\infty ) \prod _p f _p (\gamma g_p).\]</span></p>
</div>
<div id="exa:example-sl2-completed-eisenstein-series" class="example">
<p><strong>Example 28</strong>. Take <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_2\)</span>, and assume that <span
class="math inline">\(U\)</span> is lower-triangular. Then</p>
<ul>
<li><p><span class="math inline">\(U(\mathbb{R}) \backslash
G(\mathbb{R})\)</span> identifies with the punctured plane <span
class="math inline">\(\mathbb{R}^2 - \{0\}\)</span> via the map
associating to a matrix its top row,</p></li>
<li><p>elements <span class="math inline">\(f \in
\mathcal{S}^e(U(\mathbb{R}) \backslash G(\mathbb{R}))\)</span> identify
with smooth even Schwartz functions <span class="math inline">\(f :
\mathbb{R}^2 \rightarrow \mathbb{C}\)</span> that, together with all
derivatives, decay rapidly near the origin, and</p></li>
<li><p>the Eisenstein series <span
class="math inline">\(\mathop{\mathrm{Eis}}[\Phi[f]]\)</span>, defined
above, identifies with the function <span class="math inline">\(E :
{\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_2(\mathbb{R}) \rightarrow \mathbb{C}\)</span> given
by <span id="eq:eg-=-sum" class="math display">\[\label{eq:eg-=-sum}\tag{2.51}
      E(g) = \sideset{}{^*}\sum _{v \in \mathbb{Z}^2} f ^\sharp( v
g),\]</span> where <span class="math inline">\(f ^\sharp\)</span> is as
in Remark <a href="#rmk:one-could-altern" data-reference-type="ref"
data-reference="rmk:one-could-altern">27</a> and <span
class="math inline">\(\sum^*\)</span> denotes a sum over primitive
vectors.</p></li>
</ul>
<p>Indeed, consider the evaluation of <a href="#eq:eisphif=-sum-_gamma"
data-reference-type="eqref"
data-reference="eq:eisphif=-sum-_gamma">\((2.50)\)</a> at
<span class="math inline">\(g \in G(\mathbb{R})\)</span>: <span
class="math display">\[E(g) = \mathop{\mathrm{Eis}}[\Phi[f]](g) = \sum
_{\gamma \in U(\mathbb{Q}) \backslash G(\mathbb{Q})} f ^\sharp (\gamma
g) \prod_p f_p(\gamma).\]</span> Identifying <span
class="math inline">\(U(\mathbb{Q}) \backslash G(\mathbb{Q})\)</span>
with <span class="math inline">\(\mathbb{Q}^2 - \{0\}\)</span> as above,
the product <span class="math inline">\(\prod_p f_p(\gamma)\)</span>
detects when, for each prime <span class="math inline">\(p\)</span>, the
image of <span class="math inline">\(\gamma\)</span> in <span
class="math inline">\(\mathbb{Q}_p^2 - \{0\}\)</span> defines a
primitive element of <span class="math inline">\(\mathbb{Z}_p^2 -
\{0\}\)</span>. It is equivalent to ask that <span
class="math inline">\(\gamma\)</span> itself defines a primitive element
of <span class="math inline">\(\mathbb{Z}^2\)</span>, whence <a
href="#eq:eg-=-sum" data-reference-type="eqref"
data-reference="eq:eg-=-sum">\((2.51)\)</a>.</p>
<p>Alternatively, defining <span class="math inline">\(f^{\flat} \in
\mathcal{S}^e(U(\mathbb{R}) \backslash G(\mathbb{R}))\)</span> by
requiring that <span class="math display">\[f^{\flat}[s] =
\mathcal{P}_G(s) f[s],
    \quad
    f ^\sharp [s] = \zeta(U,s) f^{\flat}[s],\]</span> we have <span id="eq:eg-=-sum-1" class="math display">\[\label{eq:eg-=-sum-1}\tag{2.52}
    E(g) = \sum _{v \in \mathbb{Z}^2 - \{0\}} f^{\flat}(v g).\]</span>
Indeed, let <span class="math inline">\(\alpha \in \Delta_U\)</span>
denote the unique simple root, and <span
class="math inline">\(\alpha^\vee\)</span> the corresponding coroot. The
latter induces an identification of <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span> with <span
class="math inline">\(\mathbb{C}\)</span>. For <span
class="math inline">\(s \in \mathbb{C} \cong
\mathfrak{a}_{\mathbb{C}}^*\)</span>, we have <span
class="math inline">\(\zeta(U,s) = \zeta(1 + s)\)</span>, while the
character <span class="math inline">\(|.|^s\)</span> of <span
class="math inline">\(A(\mathbb{R})\)</span> is given by <span id="eq:diagt-1ts-=" class="math display">\[\label{eq:diagt-1ts-=}\tag{2.53}
    |\mathop{\mathrm{diag}}(t, 1/t)|^s = |t|^{-s}.\]</span> By
definition, <span class="math inline">\(f[s](g) = \int _{a \in
A(\mathbb{R})} |a|^{-\rho_U - s} f(a g) \, d a\)</span> for <span
class="math inline">\(a \in \mathfrak{a}_{\mathbb{C}}^*\)</span>.
Identifying both <span class="math inline">\(f[s]\)</span> and <span
class="math inline">\(f\)</span> with functions on <span
class="math inline">\(\mathbb{R}^2 - \{0\}\)</span> as above and
invoking <a href="#eq:diagt-1ts-=" data-reference-type="eqref"
data-reference="eq:diagt-1ts-=">\((2.53)\)</a>, we see that this
definition may be rewritten, for <span class="math inline">\(s \in
\mathbb{C} \cong \mathfrak{a}_{\mathbb{C}}^*\)</span>, <span
class="math display">\[f[s](v) = \int _{t \in \mathbb{R}^\times }
|t|^{1+s} f(t v) \, \frac{d t}{|t|}\]</span> (for suitable normalization
of Haar measure). The same relation holds for <span
class="math inline">\(f ^\sharp\)</span> and <span
class="math inline">\(f^{\flat}\)</span>. It follows readily that <span
class="math display">\[f ^\sharp (v) = \sum _{c \in
\mathbb{Z}_{\geqslant 1} } f^{\flat} (c v).\]</span> The claim <a
href="#eq:eg-=-sum-1" data-reference-type="eqref"
data-reference="eq:eg-=-sum-1">\((2.52)\)</a> then follows from the
fact that every element of <span class="math inline">\(\mathbb{Z} ^2 -
\{0\}\)</span> may be written uniquely as <span class="math inline">\(c
v\)</span>, where <span class="math inline">\(c \in
\mathbb{Z}_{\geqslant 1}\)</span> and <span
class="math inline">\(v\)</span> is primitive.</p>
<p>One can check that <span class="math inline">\(f ^\flat\)</span> is
the image of <span class="math inline">\(f\)</span> under an explicit
finite-order differential operator, coming from the scaling action of
<span class="math inline">\(\mathbb{R}^\times\)</span> on <span
class="math inline">\(\mathbb{R}^2\)</span>.</p>
<p>We note that the proofs of the basic properties of the associations
<span class="math inline">\(f \mapsto \Phi[f]\)</span> and <span
class="math inline">\(f \mapsto \mathop{\mathrm{Eis}}[\Phi[f]]\)</span>
relevant for this paper can ultimately be reduced to analysis of this
example (see <a href="#ref-MR3468638" class="citation" data-cites="MR3468638">(Gelfand,
Graev, and Pyatetskii-Shapiro 2016, sec. 3.5)</a>).</p>
</div>
<h5 id="equivariance-under-fourier-transforms">Equivariance under
Fourier transforms</h5>
<p>In what follows, we let <span class="math inline">\(\psi\)</span> be
a nondegenerate unitary character of <span
class="math inline">\(N(\mathbb{A})\)</span>, trivial on <span
class="math inline">\(N(\mathbb{Q})\)</span>, that is unramified in the
sense of §<a href="#sec:stand-nond-char" data-reference-type="ref"
data-reference="sec:stand-nond-char">2.11</a>. This condition determines
<span class="math inline">\(\psi\)</span> “up to signs.” Recall the
notation <span class="math inline">\(\mathcal{S}^e(U(\mathbb{R})
\backslash G(\mathbb{R}))^w\)</span> from §<a
href="#sec:fourier-transforms" data-reference-type="ref"
data-reference="sec:fourier-transforms">2.13.2</a>. We define this
notation with respect to the restriction <span
class="math inline">\(\psi_{\infty}\)</span> of <span
class="math inline">\(\psi\)</span> to <span
class="math inline">\(N(\mathbb{R})\)</span>, thus <span
class="math inline">\(\mathcal{S}^e(U(\mathbb{R}) \backslash
G(\mathbb{R}))^w\)</span> is the subspace of <span
class="math inline">\(\mathcal{S}^e(U(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span> consisting of <span
class="math inline">\(\mathcal{F}_{w,\psi_\infty}\)</span>-invariant
elements.</p>
<div id="lem:standard2:let-f_infty-in" class="lemma">
<p><strong>Lemma 29</strong>. Let <span class="math inline">\(w \in
W\)</span> and <span class="math inline">\(f \in
\mathcal{S}^e(U(\mathbb{R}) \backslash G(\mathbb{R}))^w\)</span>. Then
<span class="math display">\[M_w \Phi[f] =
    \Phi[f].\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Abbreviate <span class="math inline">\(\Phi :=
\Phi[f]\)</span>. It admits the rapidly-convergent Mellin expansion
<span id="eq:phi-=-int_sigma" class="math display">\[\label{eq:phi-=-int_sigma}\tag{2.54}
    \Phi = \int_{(\sigma)} \Phi[s] \, d s\]</span> for each <span
class="math inline">\(\sigma \in \mathfrak{a}^*\)</span>. Choose <span
class="math inline">\(\sigma\)</span> such that <span
class="math inline">\(\sigma \succ \rho_{U}\)</span>. Then for each
<span class="math inline">\(g \in G(\mathbb{A})\)</span>, the double
integral <span class="math display">\[M_w \Phi(g) = \int _{u \in
      (w U w^{-1} \cap U \backslash  U)(\mathbb{A})} \int
_{(\sigma)}  \Phi[s](w^{-1} u g) \, d s \, d u\]</span> converges
absolutely. We may thus swap the integrals, giving <span
class="math display">\[M_w \Phi(g) = \int _{(\sigma) } M_w \Phi[s](g) \,
d s.\]</span> If we can show that <span class="math inline">\(M_w
\Phi[s] = \Phi[w s]\)</span> then it will follow from <a
href="#eq:phi-=-int_sigma" data-reference-type="eqref"
data-reference="eq:phi-=-int_sigma">\((2.54)\)</a> that <span
class="math inline">\(M_w \Phi = \Phi\)</span>. (Note that we have used
crucially here that <span class="math inline">\(\Phi \in
\mathcal{S}([G]_{Q})\)</span>.)</p>
<p>It remains to verify that <span class="math inline">\(M_w \Phi[s] =
\Phi[w s]\)</span>. Recall the definition <a href="#eq:phis-:=-qn"
data-reference-type="eqref"
data-reference="eq:phis-:=-qn">\((2.49)\)</a> of <span
class="math inline">\(\Phi[s]\)</span>. Using the notation <span
class="math inline">\(\otimes ^\sharp\)</span> as in §<a
href="#sec:fact-intertw-oper" data-reference-type="ref"
data-reference="sec:fact-intertw-oper">2.13.3</a> to denote a tensor
product regularized by <span class="math inline">\(\zeta(U,s)\)</span>
and its local factors, we may rewrite that definition as <span
class="math display">\[\Phi[s] = \mathcal{P}_G(s) f[s] \otimes
(\otimes_{p} ^\sharp f_p ^\sharp [s]),\]</span> where <span
class="math inline">\(f_\mathfrak{p} ^\sharp [s]\)</span> denotes the
spherical element taking the value <span
class="math inline">\(\zeta_\mathfrak{p}(U,s)\)</span> at the identity.
We have noted in <a href="#eq:normalized-F-w-preserves-basic-vector"
data-reference-type="eqref"
data-reference="eq:normalized-F-w-preserves-basic-vector">\((2.34)\)</a>
that <span class="math inline">\(\mathcal{F}_{w,\psi_p} f_p ^\sharp[s] =
f_p ^\sharp [w s]\)</span> (using here that <span
class="math inline">\(\psi_p\)</span> is unramified). The identity <a
href="#eq:m_w-f-=-2" data-reference-type="eqref"
data-reference="eq:m_w-f-=-2">\((2.35)\)</a> thus gives <span
class="math display">\[M_w \Phi[s] = \mathcal{P}_G(s)
\mathcal{F}_{w,\psi_\infty} f[s] \otimes (\otimes_p ^\sharp f_p ^\sharp
[w s]).\]</span> We have noted that the polynomial <span
class="math inline">\(\mathcal{P}_G(s)\)</span> is <span
class="math inline">\(W\)</span>-invariant. Our hypothesis is that <span
class="math inline">\(\mathcal{F}_{w,\psi_\infty} f[s] = f[ w
s]\)</span> for all <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span> (see Lemma <a
href="#lem:standard2:let-w-in" data-reference-type="ref"
data-reference="lem:standard2:let-w-in">2.6</a>).
Therefore <span class="math inline">\(M_w \Phi[s] = \Phi[w s]\)</span>,
as required. ◻</p>
</div>
<div id="rmk:one-could-likely" class="remark">
<p><strong>Remark 30</strong>. One could likely formulate and establish
a more natural version of Lemma <a href="#lem:standard2:let-f_infty-in"
data-reference-type="ref"
data-reference="lem:standard2:let-f_infty-in">29</a>, as follows. Let
<span class="math inline">\(X\)</span> denote the affine closure of the
quasi-affine variety <span class="math inline">\(U \backslash
G\)</span>. Define the extended Schwartz space <span
class="math inline">\(\mathcal{S}(X(\mathbb{R}))\)</span> as in <a href="#ref-2021arXiv210310261G"
class="citation" data-cites="2021arXiv210310261G">(Getz, Hsu, and Leslie
2021, Definition 5.5)</a> or <a href="#ref-MR1694894" class="citation"
data-cites="MR1694894">(Braverman and Kazhdan 1999, sec. 7.1)</a>; it
should be a space intermediate between <span
class="math inline">\(\mathcal{S}(U(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span> and <span
class="math inline">\(C^\infty(U(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span>. The assignment <span
class="math inline">\(\Phi\)</span> should extend to <span
class="math inline">\(\mathcal{S}(X(\mathbb{R}))\)</span>, hence in
particular to its subspace <span
class="math inline">\(\mathcal{S}^e(X(\mathbb{R}))\)</span>. The group
<span class="math inline">\(W\)</span> should act on <span
class="math inline">\(\mathcal{S}^e(X(\mathbb{R}))\)</span> (and <span
class="math inline">\(\mathcal{S}(X(\mathbb{R}))\)</span>) via the
Fourier transforms <span
class="math inline">\(\mathcal{F}_{w,\psi_\infty}\)</span>, and we
should have <span id="eq:Phi-intertwines-M-w-F-w" class="math display">\[\label{eq:Phi-intertwines-M-w-F-w}\tag{2.55}
    M_w \Phi[f] = \Phi[\mathcal{F}_{w,\psi_\infty} f].\]</span> We were
unable to extract such expectations from the literature on such extended
Schwartz spaces, although the technique needed to formulate and
establish identities such as <a href="#eq:Phi-intertwines-M-w-F-w"
data-reference-type="eqref"
data-reference="eq:Phi-intertwines-M-w-F-w">\((2.55)\)</a>
is certainly available (essentially already in <a href="#ref-MR3468638" class="citation"
data-cites="MR3468638">(Gelfand, Graev, and Pyatetskii-Shapiro 2016,
sec. 3.5)</a>), and we suspect that such identities are well known to
experts. In any event, the simpler but less natural implication given by
Lemma <a href="#lem:standard2:let-f_infty-in" data-reference-type="ref"
data-reference="lem:standard2:let-f_infty-in">29</a> suffices for our
applications.</p>
</div>
<h5 id="sec:matr-coeff-bounds">§2.16.3. Matrix coefficient bounds</h5>
<p>Let <span class="math inline">\(\mathcal{H} := \mathcal{H}_G\)</span>
denote the spherical Hecke algebra for <span
class="math inline">\(G(\mathbb{Z})\)</span>, i.e., the restricted
product over all primes <span class="math inline">\(p\)</span> of the
spherical Hecke algebras for <span
class="math inline">\((G(\mathbb{Q}_p), G(\mathbb{Z}_p))\)</span>.</p>
<p>By definition, <span class="math inline">\(\mathcal{H}\)</span>
consists of the smooth compactly-supported complex measures on <span
class="math inline">\(G(\mathbb{A}_f) = \prod &#39;
G(\mathbb{Q}_p)\)</span> that are bi-invariant under <span
class="math inline">\(\prod_p G(\mathbb{Z}_p)\)</span>. Using the Haar
measure on <span class="math inline">\(G(\mathbb{A}_f)\)</span> that
assigns volume one to <span
class="math inline">\(G(\mathbb{Z}_p)\)</span>, we may identify elements
of <span class="math inline">\(\mathcal{H}\)</span> with functions on
<span class="math inline">\(G(\mathbb{A}_f)\)</span>.</p>
<p>We may speak of an element <span class="math inline">\(t \in
\mathcal{H}\)</span> being nonnegative; this says that it defines a
positive measure, or equivalently, that the corresponding function is
nonnegative.</p>
<p>By the Satake isomorphism, characters (i.e., algebra homomorphisms)
<span class="math inline">\(\lambda : \mathcal{H} \rightarrow
\mathbb{C}\)</span> are in bijection with collections <span
class="math inline">\(A = (A_p)_p\)</span>, indexed by the primes <span
class="math inline">\(p\)</span>, of semisimple conjugacy classes <span
class="math inline">\(A_p\)</span> in the dual group <span
class="math inline">\({}^L G(\mathbb{C})\)</span>. (In the case <span
class="math inline">\(G = {\mathop{\mathrm{GL}}}_n\)</span> ultimately of
interest to us, we have <span class="math inline">\({}^L G =
{\mathop{\mathrm{GL}}}_n\)</span>, so such classes may be identified
further with <span class="math inline">\(n\)</span>-tuples of nonzero
complex numbers.)</p>
<p>For <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span>, let <span
class="math inline">\(\lambda_s\)</span> denote the character of <span
class="math inline">\(\mathcal{H}\)</span> attached to the principal
series representation <span
class="math inline">\(\mathcal{I}(s)\)</span>.</p>
<p>The representation <span
class="math inline">\(\mathcal{I}(s)\)</span> is tempered when <span
class="math inline">\(\Re(s) = 0\)</span>. It follows from the results
of <a href="#ref-MR946351" class="citation" data-cites="MR946351">(Cowling, Haagerup, and
Howe 1988)</a> (or more elementarily) that if <span
class="math inline">\(t \in \mathcal{H}\)</span> is nonnegative and
<span class="math inline">\(\Re(s) = 0\)</span>, then <span id="eq:lambd-leq-lambd" class="math display">\[\label{eq:lambd-leq-lambd}\tag{2.56}
|\lambda_s(t)| \leqslant\lambda_0(t).\]</span></p>
<div id="lem:standard2:matrix-coeff-bounds" class="lemma">
<p><strong>Lemma 31</strong>. Let <span class="math inline">\(G\)</span>
be as above. There exists <span class="math inline">\(C_0 \geqslant
0\)</span> and <span class="math inline">\(d \in \mathbb{Z}_{\geqslant
0}\)</span> with the following property. Let <span
class="math inline">\(f \in \mathcal{S}^e(U(\mathbb{R}) \backslash
G(\mathbb{R}))^W\)</span>. For <span class="math inline">\(Y \in
A(\mathbb{R})^0\)</span>, set <span class="math display">\[\Psi[Y] :=
\mathop{\mathrm{Eis}}[L(Y) \Phi[f]]  = \mathop{\mathrm{Eis}}[\Phi[L(Y)
f]] \in \mathcal{S}([G]).\]</span> Let <span class="math inline">\(t \in
\mathcal{H}_G\)</span> be nonnegative. Let <span class="math inline">\(g
\in G(\mathbb{R})\)</span> be arbitrary. Write <span
class="math inline">\(\left\langle , \right\rangle\)</span> for the
Petersson inner product on <span class="math inline">\([G]\)</span>.
Then <span id="eq:leftlangle-g-t" class="math display">\[\label{eq:leftlangle-g-t}\tag{2.57}
    |\left\langle g t \Psi[Y], \Psi[Y]  \right\rangle| \leqslant C_0
\lambda_0(t) \mathcal{S}_{d,0}(f)^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We treat first the case <span
class="math inline">\((Y,t,g) = (1,1,1)\)</span>.</p>
<p>By Lemma <a href="#lem:standard2:let-f_infty-in"
data-reference-type="ref"
data-reference="lem:standard2:let-f_infty-in">29</a>, we have <span
class="math inline">\(M_w \Phi[f] = \Phi[f]\)</span> for each <span
class="math inline">\(w \in W\)</span>. In particular, <span
class="math inline">\(M_w \Phi[f] \in \mathcal{S}([G]_Q)\)</span>, so by
Proposition <a href="#lem:let-f_1-f_2" data-reference-type="ref"
data-reference="lem:let-f_1-f_2">25</a>, we have <span
class="math display">\[\left\langle \Psi[1], \Psi[1]  \right\rangle
    = |W| \left\langle \Phi[f], \Phi[f] \right\rangle.\]</span> (The
inner product on the LHS is in <span
class="math inline">\(L^2([G])\)</span>, that on the RHS in <span
class="math inline">\(L^2([G]_Q)\)</span>.)</p>
<p>We may expand <span class="math display">\[\begin{align}
    \left\langle \Phi[f], \Phi[f] \right\rangle
    &amp;=
    \int _{
      \substack{
        s \in \mathfrak{a}_{\mathbb{C}}^* :  \\
         \Re(s) = 0
      }
    }
    \left\langle \Phi[f][s], \Phi[f][s] \right\rangle \, d \mu_{[A]}(s)
\\
    &amp;=
    \int _{
      \substack{
        s \in \mathfrak{a}_{\mathbb{C}}^* :  \\
         \Re(s) = 0
      }
    }
    |\mathcal{P}_G(s) \zeta(U,s)|^2
    \left\langle f[s], f[s] \right\rangle \, d \mu_{[A]}(s).
  
\end{align}\]</span> We choose <span class="math inline">\(d \in
\mathbb{Z}_{\geqslant 0}\)</span> and <span class="math inline">\(C_1
\geqslant 0\)</span> so that the function <span
class="math inline">\(E_d\)</span> on <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span>, as given by
<a href="#eq:e_ds-:=-sum" data-reference-type="eqref"
data-reference="eq:e_ds-:=-sum">\((2.19)\)</a>, satisfies <span
class="math display">\[|\mathcal{P}_G(s) \zeta(U,s)|^2 \leqslant C_1
E_d(s)\]</span> whenever <span class="math inline">\(\Re(s) =
0\)</span>. This is possible in view of the convexity bound for the
Riemann zeta function (or the well-known inequality <span
class="math inline">\(|t \zeta(1+it)| \leqslant C_2 \log(2 +
|t|)\)</span>). Using the strong approximation isomorphism <span
class="math inline">\(A(\mathbb{Q}) \backslash A(\mathbb{A}) / \prod_p
A(\mathbb{Z}_p) \cong  A(\mathbb{Z})  \backslash A(\mathbb{R})\)</span>
for the split torus <span class="math inline">\(A\)</span> and our
normalization of Haar measures, we verify that <span
class="math display">\[d \mu_{[A]}(s) = |A(\mathbb{Z})|\,  d
\mu_{A(\mathbb{R})}(s).\]</span> Thus <span
class="math display">\[\left\langle \Phi[f], \Phi[f] \right\rangle
\leqslant|A(\mathbb{Z})| C_1 J,\]</span> where <span
class="math display">\[J := \int _{
      \substack{
        s \in \mathfrak{a}_\mathbb{C}^* :  \\
         \Re(s)  = 0
      }
    }
    E_d(s) \left\langle f[s], f[s] \right\rangle d
\mu_{A(\mathbb{R})}(s).\]</span> By <a href="#eq:sobolev-parseval-A-U-G"
data-reference-type="eqref"
data-reference="eq:sobolev-parseval-A-U-G">\((2.18)\)</a>,
we have <span class="math inline">\(J = \mathcal{S}_{d,0}(f)^2\)</span>.
Thus the required bound <a href="#eq:leftlangle-g-t"
data-reference-type="eqref"
data-reference="eq:leftlangle-g-t">\((2.57)\)</a> holds in this
case with <span class="math inline">\(C_0 := |W| \cdot |A(\mathbb{Z})|
\cdot  C_1\)</span>.</p>
<p>In the general case, analogous arguments give the decomposition <span
class="math display">\[\begin{align}
    &amp;\left\langle g t \Psi[Y], \Psi[Y] \right\rangle \\
    &amp;=
    |A(\mathbb{Z})|
    \sum_{w \in W}
    \int _{
      \substack{
        s \in \mathfrak{a}_{\mathbb{C}}^* :  \\
         \Re(s) = 0
      }
    }
    |\mathcal{P}_G(s) \zeta(U,s)|^2
    \lambda_s(t)
    Y^{s + \overline{w s}}
    \left\langle R(g) f[s], f[s] \right\rangle
    \, d \mu_{A(\mathbb{R})}(s).
  
\end{align}\]</span> Using the inequality <a
href="#eq:lambd-leq-lambd" data-reference-type="eqref"
data-reference="eq:lambd-leq-lambd">\((2.56)\)</a>, the
identity <span class="math inline">\(\left\lvert Y^{s+ \overline{w s}}
\right\rvert = 1\)</span> and Cauchy–Schwarz, we obtain now <span
class="math display">\[\left\lvert \langle g t \Psi[Y], \Psi[Y] \rangle
\right\rvert \leqslant C_0 \lambda_0(t) \mathcal{S}_{d,0}(f)
\mathcal{S}_{d,0}(R(g) f),\]</span> with the same <span
class="math inline">\(C_0\)</span> as before. We conclude by noting that
<span class="math inline">\(\mathcal{S}_{d,0}(R(g) f) =
\mathcal{S}_{d,0}(f)\)</span>. ◻</p>
</div>
<h5 id="crude-growth-bounds">Crude growth bounds</h5>
<div id="lem:standard2:crude-growth-bounds-completed-eisenstein-series"
class="lemma">
<p><strong>Lemma 32</strong>. For each <span class="math inline">\(C_0
\geqslant 0\)</span> and <span class="math inline">\(x \in
\mathfrak{U}(G(\mathbb{R}))\)</span>, there exists <span
class="math inline">\(C_1 \geqslant 0\)</span> so that for each <span
class="math inline">\(C_2 \in \mathbb{R}\)</span>, there is a compact
<span class="math inline">\(\mathcal{D} \subseteq
\mathfrak{a}^*\)</span> and <span class="math inline">\(\ell \in
\mathbb{Z}_{\geqslant 0}\)</span> with the following property. For all
<span class="math inline">\(T \geqslant 1\)</span>, <span
class="math inline">\(f \in \mathcal{S}^e(U(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span>, <span class="math inline">\(Y \in
A(\mathbb{R})^0\)</span> with each component <span
class="math inline">\(Y_j\)</span> lying in <span
class="math inline">\([T^{-1/2}, T^{1/2}]\)</span>, and <span
class="math inline">\(g \in [G]\)</span>, we have <span
class="math display">\[\|g\|_{[G]}^{C_0}
  \left\lvert     \det(g Y) \right\rvert^{C_2}
  \left\lvert \mathop{\mathrm{Eis}}[\Phi[ R(x) L(Y) f]](g) \right\rvert
  \leqslant C_1 T^{C_1} \nu_{\mathcal{D},\ell,T}(f).\]</span></p>
</div>
<div class="remark">
<p><strong>Remark 33</strong>. The exponent <span
class="math inline">\(1/2\)</span> in <span
class="math inline">\([T^{-1/2}, T^{1/2}]\)</span> is not important –
the same conclusion holds for any exponent. The key feature here is that
<span class="math inline">\(C_2\)</span> may be taken arbitrarily large,
and either positive or negative, without increasing <span
class="math inline">\(C_1\)</span>. The practical consequence is that,
e.g., <span class="math inline">\(\mathop{\mathrm{Eis}}[\Phi[L(Y)
f]](g)\)</span> is concentrated on <span class="math inline">\(\det(g Y)
\approx 1\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By linearity, we my assume that <span
class="math inline">\(x = x_1 \dotsb x_k\)</span> with each <span
class="math inline">\(x_j \in \mathcal{B}(G)\)</span>. Then, using the
inequality <span class="math display">\[\nu_{\mathcal{D},\ell,T}(R(x) f)
\leqslant
  T^k
  \nu_{\mathcal{D},\ell + k, T}(f),\]</span> we may and shall reduce to
the case <span class="math inline">\(x = 1\)</span>.</p>
<p>The proof provides a convenient opportunity to illustrate the use of
asymptotic notation, following the conventions of §<a
href="#sec:asympt-notat-term" data-reference-type="ref"
data-reference="sec:asympt-notat-term">2.1</a>.</p>
<p>By transfer, it is equivalent to prove the same statement, but with
the quantification over the group <span class="math inline">\(G\)</span>
and the scalars <span class="math inline">\(C_0\)</span>, <span
class="math inline">\(C_1\)</span> and <span
class="math inline">\(\ell\)</span> restricted to fixed quantities. The
conclusion is filtered with respect to <span
class="math inline">\(C_1\)</span> and <span
class="math inline">\(\ell\)</span>, so by idealization, we may commute
them with the remaining quantifiers. Our task is then to show the
following:</p>
<ul>
<li><p><em>Let <span class="math inline">\(G\)</span> and <span
class="math inline">\(C_0 \geqslant 0\)</span> be fixed. Let <span
class="math inline">\(C_2 \in \mathbb{R}\)</span>, <span
class="math inline">\(T \geqslant 1\)</span>, <span
class="math inline">\(Y \in A(\mathbb{R})^0\)</span> with each component
<span class="math inline">\(Y_j\)</span> lying in <span
class="math inline">\([T^{-1/2}, T^{1/2}]\)</span>, and <span
class="math inline">\(g \in [G]\)</span>. Let <span
class="math inline">\(f \in \mathcal{S}^e(U(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span>. There is a compact <span
class="math inline">\(\mathcal{D} \subseteq \mathfrak{a}^*\)</span> and
a fixed <span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant
0}\)</span> so that</em> <span id="eq:g_gc_0-leftlv-detg" class="math display">\[\label{eq:g_gc_0-leftlv-detg}\tag{2.58}
    \|g\|_{[G]}^{C_0}
    \left\lvert     \det(g Y) \right\rvert^{C_2}
    \left\lvert \mathop{\mathrm{Eis}}[\Phi[ L(Y) f]](g) \right\rvert
    \ll T^{\operatorname{O}(1)}
\nu_{\mathcal{D},\ell,T}(f).\]</span></p></li>
</ul>
<p>The practical consequence of this formalism is that “fixed” means
“depending only upon <span class="math inline">\(C_0\)</span>, and not
upon <span class="math inline">\(C_2\)</span>, <span
class="math inline">\(T\)</span>, etc.”</p>
<p>Set <span class="math inline">\(J := \prod_p
G(\mathbb{Z}_p)\)</span>; it is an open subgroup of <span
class="math inline">\(G(\mathbb{A}_f)\)</span> under which <span
class="math inline">\(\Phi[f][s]\)</span> is invariant. The continuity
of <span class="math inline">\(\mathop{\mathrm{Eis}}: \mathcal{S}([G]_Q)
\rightarrow \mathcal{S}([G])\)</span> implies that there is a fixed
continuous seminorm <span class="math inline">\(\nu\)</span> on <span
class="math inline">\(\mathcal{S}([G]_Q)^J\)</span> so that for all
<span class="math inline">\(\phi \in \mathcal{S}([G]_Q)^J\)</span>, we
have <span id="eq:sup-_g-in" class="math display">\[\label{eq:sup-_g-in}\tag{2.59}
  \sup _{g \in [G]} \|g\| ^{C_0} _{[G]} | \mathop{\mathrm{Eis}}(\phi)
(g)| \leqslant\nu(\phi).\]</span> Assume now that <span
class="math inline">\(\phi \in \mathcal{S}^e([G]_Q)^J\)</span>. As
usual, write <span class="math inline">\(\phi[s] \in
\mathcal{I}(s)\)</span> for its Mellin components. By the definition of
the topology on <span
class="math inline">\(\mathcal{S}([G]_Q)^J\)</span>, we may find a fixed
compact set <span class="math inline">\(\mathcal{D}_0  \subseteq
\mathfrak{a}^*\)</span>, fixed <span class="math inline">\(y \in
\mathfrak{U}(G(\mathbb{R}))\)</span> and fixed <span
class="math inline">\(\ell_1 \geqslant 0\)</span> so that <span id="eq:nuphi-ll-sup" class="math display">\[\label{eq:nuphi-ll-sup}\tag{2.60}
  \nu(\phi) \ll \sup_{
    \substack{
      s \in \mathfrak{a}_{\mathbb{C}}^* :
      \\
      \Re(s) \in \mathcal{D}_0
    }
  }
  \langle s \rangle^{\ell_1} \|R(y) \phi[s]\|,\]</span> where we
abbreviate <span class="math inline">\(\langle s \rangle := 1 +
|s|\)</span>.</p>
<p>We will apply the estimate <a href="#eq:sup-_g-in"
data-reference-type="ref"
data-reference="eq:sup-_g-in">2.59</a> to the following
“twist” <span class="math inline">\(\phi\)</span> of <span
class="math inline">\(\Phi[L(Y) f]\)</span>: <span
class="math display">\[\phi(g) :=
  |\det(g Y)|^{C_2} \Phi[L(Y)f](g),\]</span> for which <span
class="math display">\[|\mathop{\mathrm{Eis}}(\phi)(g)| = |\det(g
Y)|^{C_2} |\mathop{\mathrm{Eis}}[\Phi[L(Y) f]](g)|.\]</span> In view of
<a href="#eq:sup-_g-in" data-reference-type="eqref"
data-reference="eq:sup-_g-in">\((2.59)\)</a> and <a
href="#eq:nuphi-ll-sup" data-reference-type="eqref"
data-reference="eq:nuphi-ll-sup">\((2.60)\)</a>, our task <a
href="#eq:g_gc_0-leftlv-detg" data-reference-type="eqref"
data-reference="eq:g_gc_0-leftlv-detg">\((2.58)\)</a>
reduces to verifying that for <span class="math inline">\(\Re(s) \in
\mathcal{D}_0\)</span>, we have <span id="eq:langle-s-rangleell_1" class="math display">\[\label{eq:langle-s-rangleell_1}\tag{2.61}
  \langle s \rangle^{\ell_1} \|R(y) \phi[s]\| \ll
T^{\operatorname{O}(1)} \nu_{\mathcal{D}, \ell, T}(f)\]</span> for some
compact <span class="math inline">\(\mathcal{D} \subseteq
\mathfrak{a}^*\)</span> and some fixed <span class="math inline">\(\ell
\in \mathbb{Z}_{\geqslant 0}\)</span>. The Mellin components of this
twist are given by shifts of the original Mellin components. Indeed,
write <span class="math inline">\(e \in \mathfrak{a}^*\)</span> for the
element corresponding to the diagonal matrix <span
class="math inline">\((1,\dotsc,1)\)</span>, so that <span
class="math inline">\(|a|^{C_2 e} = |\det a|^{C_2}\)</span>. Then <span
class="math display">\[\begin{align}
  \phi[s](g)
  &amp;=
    \int _{[A]} |a|^{-\rho_U - s} |\det(g Y)|^{C_2} \Phi[L(Y) f](a g) \,
d a \\
  &amp;=
     |\det(g)|^{C_2} \int _{[A]} |a|^{-\rho_U - s} Y^{C_2 e - \rho_U}
\Phi[f](Y a g) \, d a.
\end{align}\]</span> By the change of variables <span
class="math inline">\(a \mapsto Y^{-1} a\)</span>, it follows that <span id="eq:phis-=-left" class="math display">\[\label{eq:phis-=-left}\tag{2.62}
  \phi[s](g) = |\det(g)|^{C_2} Y^s \Phi[f][s - C_2 e].\]</span> We have
<span class="math inline">\(\mathcal{P}_G(s - C_2 e) =
\mathcal{P}_G(s)\)</span> and <span class="math inline">\(\zeta(U,s -
C_2 e) = \zeta(U,s)\)</span>, so <span class="math display">\[\Phi[f][s
- C_2 e]
  = \mathcal{P}_G(s) \zeta(U,s) f[s - C_2 e].\]</span> For <span
class="math inline">\(\Re(s) \in \mathcal{D}_0\)</span>, we have <span
class="math inline">\(\mathcal{P}_G(s) \zeta(U,s) \ll \langle s
\rangle^{\ell_2}\)</span> for some fixed <span
class="math inline">\(\ell_2 \in \mathbb{Z}_{\geqslant 0}\)</span>. We
note finally that the factor <span
class="math inline">\(|\det(g)|^{C_2}\)</span> has no effect on the
norms <span class="math inline">\(\|.\|\)</span> obtained from <span
class="math inline">\(L^2(K)\)</span>. Our task <a
href="#eq:langle-s-rangleell_1" data-reference-type="eqref"
data-reference="eq:langle-s-rangleell_1">\((2.61)\)</a>
thereby reduces to verifying that for <span class="math inline">\(\Re(s)
\in \mathcal{D}_0\)</span>, we have <span id="eq:langle-s-rangleell_1-1" class="math display">\[\label{eq:langle-s-rangleell_1-1}\tag{2.63}
  \langle s \rangle^{\ell_1 + \ell_2} Y^s \|R(y) f[s-C_2 e]\| \ll
T^{\operatorname{O}(1)} \nu_{\mathcal{D},\ell,T}(f)\]</span> for some
compact <span class="math inline">\(\mathcal{D} \subseteq
\mathfrak{a}^*\)</span> and some fixed <span class="math inline">\(\ell
\in \mathbb{Z}_{\geqslant 0}\)</span>.</p>
<p>Let <span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant
0}\)</span> be a fixed quantity larger than the maximum of <span
class="math inline">\(\ell_1 + \ell_2\)</span> and the degree of <span
class="math inline">\(y\)</span>. Define <span
class="math inline">\(\mathcal{D}\)</span> to be the translated compact
set <span class="math inline">\(\mathcal{D}_0 - C_2 e\)</span>. Then for
<span class="math inline">\(\Re(s) \in \mathcal{D}_0\)</span>, we have
<span class="math inline">\(\Re(s - C_2 e) \in \mathcal{D}\)</span>, and
so from the definition of <span
class="math inline">\(\nu_{\mathcal{D},\ell,T}\)</span>, <span id="eq:ry-fs-c_2" class="math display">\[\label{eq:ry-fs-c_2}\tag{2.64}
  \|R(y) f[s - C_2 e]\| \ll \langle s - C_2 e \rangle^{-\ell} T
^{\langle \rho, s - C_2 e \rangle + \ell}
\nu_{\mathcal{D},\ell,T}(f).\]</span> Since <span
class="math inline">\(\Re(s) \in \mathcal{D}_0\)</span>, we have <span
class="math inline">\(\langle s - C_2 e \rangle \gg \langle s
\rangle\)</span>. Since <span class="math inline">\(\langle \rho, s -
C_2 e \rangle = \langle \rho, s \rangle\)</span>, we have <span
class="math inline">\(T^{\langle \rho, s - C_2 e \rangle + \ell} =
T^{\operatorname{O}(1)}\)</span>. By our hypotheses on <span
class="math inline">\(Y\)</span>, we have <span
class="math inline">\(Y^s = T^{\operatorname{O}(1)}\)</span>. The
required estimate <a href="#eq:langle-s-rangleell_1-1"
data-reference-type="eqref"
data-reference="eq:langle-s-rangleell_1-1">\((2.63)\)</a>
follows. ◻</p>
</div>
<h4 id="sec:siegel-domains">§2.17. Siegel domains</h4>
<p>We take here for <span class="math inline">\(G\)</span> a general
linear group over <span class="math inline">\(\mathbb{Z}\)</span>, with
<span class="math inline">\(K_p = G(\mathbb{Z}_p)\)</span>.</p>
<p>For <span class="math inline">\(c &gt; 0\)</span>, we write <span
class="math inline">\(A(\mathbb{R})^0_{\geqslant c}\)</span> for the set
of all <span class="math inline">\(a \in A(\mathbb{R})\)</span>
satisfying <span class="math inline">\(|a|^{\alpha} \geqslant c\)</span>
for all <span class="math inline">\(\alpha \in \Delta_N\)</span>, i.e.,
<span class="math inline">\(a_i/a_{i+1} \geqslant c\)</span> for <span
class="math inline">\(1 \leqslant i &lt;
\mathop{\mathrm{rank}}(G)\)</span>.</p>
<div id="prop:siegel-upper" class="proposition">
<p><strong>Proposition 34</strong>. <em>There exists a compact subset
<span class="math inline">\(\Omega\)</span> of <span
class="math inline">\(G(\mathbb{R})\)</span> so that for each
nonnegative integrable function <span
class="math inline">\(\phi\)</span> on <span
class="math inline">\([G]\)</span>, <span class="math display">\[\int
_{[G]} \phi \leqslant\int _{t \in A(\mathbb{R})_{\geqslant 1}^0} \int
_{g \in \Omega \times \prod_p K_p} \phi(t g) \, d g \, \frac{d
t}{\delta_N(t)}.\]</span></em></p>
</div>
<div id="prop:siegel-lower" class="proposition">
<p><strong>Proposition 35</strong>. <em>For each compact subset <span
class="math inline">\(\Omega\)</span> of <span
class="math inline">\(G(\mathbb{R})\)</span>, there exists <span
class="math inline">\(C_0 \geqslant 0\)</span> so that for each <span
class="math inline">\(t \in A(\mathbb{R})^0_{\geqslant 1}\)</span> and
each nonnegative integrable function <span
class="math inline">\(\phi\)</span> on <span
class="math inline">\([G]\)</span>, <span class="math display">\[\int
_{\Omega \times \prod_p K_p} \phi(t g) \, d g
    \leqslant C_0 \delta_N(t) \int _{[G]} \phi.\]</span></em></p>
</div>
<div id="prop:siegel-lower-integrated" class="proposition">
<p><strong>Proposition 36</strong>. <em>For each compact subset <span
class="math inline">\(\Omega\)</span> of <span
class="math inline">\(G(\mathbb{R})\)</span>, there exists <span
class="math inline">\(C_1 \geqslant 0\)</span> so that for each
nonnegative integrable function <span
class="math inline">\(\phi\)</span> on <span
class="math inline">\([G]\)</span>, <span class="math display">\[\int
_{t \in A(\mathbb{R})_{\geqslant 1}^0} \int _{\Omega \times \prod_p K_p}
\phi(t g) \, d g
    \leqslant C_1 \int _{[G]} \phi.\]</span></em></p>
</div>
<p>Each proposition follows readily from standard results on Siegel
domains. We could not quickly locate a suitable reference, so we record
the short proofs. First of all, it is known that <span
class="math inline">\(G(\mathbb{Q}) G(\mathbb{R}) \prod_p K_p =
G(\mathbb{A})\)</span> <a href="#ref-MR202718" class="citation"
data-cites="MR202718">(Borel 1963, Prop 2.2)</a> and <span
class="math inline">\(G(\mathbb{Z}) = G(\mathbb{Q}) \cap \prod_p
K_p\)</span>, so we can reduce to verifying the corresponding assertions
concerning <span class="math inline">\(\phi\)</span> on <span
class="math inline">\(G(\mathbb{Z}) \backslash G(\mathbb{R})\)</span>,
where we integrate now over <span class="math inline">\(\Omega\)</span>
rather than <span class="math inline">\(\Omega \times \prod_p
K_p\)</span>. For <span class="math inline">\(b, c &gt; 0\)</span>, let
<span class="math inline">\(\Omega_N(b)\)</span> denote the set of all
<span class="math inline">\(n \in N(\mathbb{R})\)</span> satisfying
<span class="math inline">\(|n_{i j}| \leqslant b\)</span> for all <span
class="math inline">\(i &lt; j\)</span>, and denote by <span
class="math display">\[\mathfrak{S}(b,c) := \Omega_N(b)
A(\mathbb{R})^0_{\geqslant c} K_\infty  \subseteq G(\mathbb{R})\]</span>
the corresponding standard Siegel domain. A theorem of Siegel (see <a href="#ref-MR147566"
class="citation" data-cites="MR147566">(Borel and Harish-Chandra 1962,
Prop 4.5)</a>) implies that</p>
<ol type="i">
<li><p><span id="itm:standard2:b-c-large-enough"
label="itm:standard2:b-c-large-enough"></span> if <span
class="math inline">\(b\)</span> is large enough and <span
class="math inline">\(c\)</span> is small enough (e.g., <span
class="math inline">\(b \geqslant 1/2\)</span> and <span
class="math inline">\(c \leqslant\sqrt{3}/2\)</span>), then <span
class="math inline">\(G(\mathbb{Z}) \mathfrak{S}(b,c) =
G(\mathbb{R})\)</span>, and</p></li>
<li><p>for all <span class="math inline">\(b\)</span> and <span
class="math inline">\(c\)</span>, we have <span id="eq:nubc" class="math display">\[\label{eq:nubc}\tag{2.65}
    \nu(b,c) := \{\gamma \in G(\mathbb{Q}) : \gamma \mathfrak{S}(b,c)
\cap \mathfrak{S}(b,c) \neq \emptyset \} &lt; \infty.\]</span></p></li>
</ol>
<div class="proof">
<p><em>Proof of Proposition <a href="#prop:siegel-upper"
data-reference-type="ref"
data-reference="prop:siegel-upper">34</a>.</em> Choosing <span
class="math inline">\(b\)</span> and <span
class="math inline">\(c\)</span> as in <a
href="#itm:standard2:b-c-large-enough" data-reference-type="eqref"
data-reference="itm:standard2:b-c-large-enough">\((i)\)</a>,
we have <span class="math display">\[\int _{G(\mathbb{Z}) \backslash
G(\mathbb{R})} \phi \leqslant\int _{\mathfrak{S}(b,c)} \phi\]</span> for
all nonnegative <span class="math inline">\(\phi\)</span>. Let <span
class="math inline">\(f \in C_c^\infty(G(\mathbb{R}))\)</span> be
nonnegative and satisfy <span class="math inline">\(\int f = 1\)</span>.
Write <span class="math inline">\(R(f) \phi(x) := \int _{g \in
G(\mathbb{R})} \phi(x g) f(g) \, d g\)</span>. Applying the above
inequality to <span class="math inline">\(R(f) \phi\)</span> gives <span
class="math display">\[\begin{align}
  \int _{G(\mathbb{Z}) \backslash G(\mathbb{R})} \phi
  &amp;\leqslant
  \int_{\mathfrak{S}(b,c)} R(f) \phi \\
  &amp;=
  \int _{g \in G(\mathbb{R})} f(g)
  \int _{n \in \Omega_N(b)}
  \int _{t \in A(\mathbb{R})^0_{\geqslant c}}
  \int _{k \in K_\infty }
  \phi(n t k g)
  \, d k
    \, d n \, \frac{d t}{\delta_N(t)} \, d g.
\end{align}\]</span> Let <span class="math inline">\(a \in
A(\mathbb{R})^0\)</span> denote the element with <span
class="math inline">\(\det(a) = 1\)</span> and <span
class="math inline">\(a_i/a_{i+1} = c\)</span> for all <span
class="math inline">\(1 \leqslant i &lt;
\mathop{\mathrm{rank}}(G)\)</span>. Then this last integral may be
written <span class="math display">\[\int _{t \in
A(\mathbb{R})^0_{\geqslant 1}}
  \int _{g \in G(\mathbb{R})}
  \phi(t g)
  f_t(g) \, d g \, \frac{d t}{\delta_N(t)},\]</span> where <span
class="math display">\[f_t(g) :=
  \delta_N(a)^{-1}
  \int _{n \in \Omega_N(b)}
  \int _{k \in K_\infty }
  f((t^{-1} n t a k )^{-1} g)
  \, d k
  \, d n.\]</span> For each <span class="math inline">\(n \in
\Omega_N(b)\)</span> and <span class="math inline">\(t \in
A(\mathbb{R})^0_{\geqslant 1}\)</span>, we have <span
class="math inline">\(t^{-1} n t \in \Omega_N\)</span>, hence <span
class="math inline">\(t^{-1} n t a k\)</span> lies in the compact set
<span class="math inline">\(\Omega_N(b) a K_\infty\)</span>. Therefore
<span class="math inline">\(f_t\)</span> is supported on the compact set
<span class="math display">\[\Omega := (\Omega_N(b) a K_\infty)^{-1}
\cdot \mathop{\mathrm{supp}}(f)\]</span> and bounded by <span
class="math display">\[C_2 := \delta_N(a)^{-1}
\mathop{\mathrm{vol}}(\Omega_N(b), d n) \mathop{\mathrm{vol}}(K_\infty,
d k) \|f\|_{\infty},\]</span> so <span
class="math display">\[\int_{G(\mathbb{Z}) \backslash G(\mathbb{R})}
\phi \leqslant
  C_2 \int _{t \in A(\mathbb{R})^0_{\geqslant 1}}
  \int _{g \in \Omega } \phi(t g) \, d g \, \frac{d
t}{\delta_N(t)},\]</span> as required. ◻</p>
</div>
<p>The proof of Proposition <a href="#prop:siegel-lower"
data-reference-type="ref" data-reference="prop:siegel-lower">35</a>
requires some further preliminaries.</p>
<div id="lem:siegel-upper-basic" class="lemma">
<p><strong>Lemma 37</strong>. For each <span class="math inline">\(c
&gt; 0\)</span>, there exists <span class="math inline">\(C_0 \geqslant
0\)</span> so that for each nonnegative integrable function <span
class="math inline">\(\phi\)</span> on <span
class="math inline">\(G(\mathbb{Z}) \backslash G(\mathbb{R})\)</span>,
we have <span class="math display">\[\int _{N(\mathbb{Z}) \backslash
N(\mathbb{R})}
    \int _{A(\mathbb{R})^0_{\geqslant c}}
    \int _{K_\infty}
    \phi(n a k) \, d k \, \frac{d a}{\delta_N(a)} \, d n
    \leqslant C_0 \int _{G(\mathbb{Z}) \backslash G(\mathbb{R})}
\phi.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Choose <span class="math inline">\(b\)</span> large
enough that <span class="math inline">\(\Omega_N(b)\)</span> contains a
fundamental domain for the compact quotient <span
class="math inline">\(N(\mathbb{Z}) \backslash N(\mathbb{R})\)</span>.
Then the conclusion holds with <span class="math inline">\(C_0 :=
\nu(b,c)\)</span> as defined in <a href="#eq:nubc"
data-reference-type="eqref"
data-reference="eq:nubc">\((2.65)\)</a>. ◻</p>
</div>
<div id="lem:scratch-research:each-c-Omega-N" class="lemma">
<p><strong>Lemma 38</strong>. For each <span class="math inline">\(c
&gt; 0\)</span> and compact subset <span class="math inline">\(\Omega_N
\subseteq N(\mathbb{R})\)</span>, there exists <span
class="math inline">\(C_0 \geqslant 0\)</span> so that for each <span
class="math inline">\(t \in A(\mathbb{R})^0_{\geqslant c}\)</span> and
nonnegative integrable function <span
class="math inline">\(\phi\)</span> on <span
class="math inline">\(N(\mathbb{Z}) \backslash N(\mathbb{R})\)</span>,
we have <span class="math display">\[\int _{\Omega_N}
  \phi(t n t^{-1}) \, d n \leqslant C_0 \int _{N(\mathbb{Z}) \backslash
N(\mathbb{R})} \phi(n) \, d n.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> The change of variables <span class="math inline">\(n
\mapsto t^{-1} n t\)</span> gives <span class="math display">\[\int
_{\Omega_N}
  \phi(t n t^{-1}) \, d n
  =
  \frac{1}{\delta_N(t)}
  \int _{t \Omega_N t^{-1}}
  \phi(n) \, d n
  \leqslant
  \frac{C_1(t)}{\delta_N(t)} \int _{N(\mathbb{Z}) \backslash
N(\mathbb{R}) }\phi(n) \, d n,\]</span> where <span
class="math display">\[C_1(t) := \sup_{n \in t \Omega_N t^{-1}}
  \# \left\{ \gamma \in N(\mathbb{Z}) : \gamma n \in t \Omega_N t^{-1}
\right\}.\]</span> For <span class="math inline">\(t \geqslant
c\)</span>, we have <span class="math inline">\(t \Omega_N t^{-1}
\subseteq \Omega_N&#39;\)</span>, where <span
class="math inline">\(\Omega_N&#39;\)</span> depends only upon <span
class="math inline">\(\Omega_N\)</span> and <span
class="math inline">\(c\)</span>. For <span class="math inline">\(n \in
\Omega_N&#39;\)</span> and <span class="math inline">\(u \in t \Omega_N
t^{-1}\)</span>, we see by matrix multiplication that <span
class="math inline">\(u n^{-1}\)</span> is an upper-triangular unipotent
matrix with entries satisfying <span class="math inline">\(|(u
n^{-1})_{i j}| \leqslant C_2 t^{j-i}\)</span> for some <span
class="math inline">\(C_2 = C_2(\Omega_N,c) \geqslant 0\)</span> and all
<span class="math inline">\(i &lt; j\)</span>. It follows that <span
class="math display">\[C_1(t) \leqslant\prod_{1 \leqslant i &lt; j
\leqslant\mathop{\mathrm{rank}}(G)} (1 + 2 C_2 t^{j-i}) \leqslant C_0
\delta(t)\]</span> for some <span class="math inline">\(C_0 \geqslant
0\)</span>. The required estimate then holds with this value of <span
class="math inline">\(C_0\)</span>. ◻</p>
</div>
<div class="proof">
<p><em>Proof of Proposition <a href="#prop:siegel-lower"
data-reference-type="ref"
data-reference="prop:siegel-lower">35</a>.</em> By the Iwasawa
decomposition, we have <span class="math inline">\(\Omega \subseteq
\Omega_N \Omega_A K_\infty\)</span>, where <span
class="math inline">\(\Omega_N \subseteq N(\mathbb{R})\)</span> and
<span class="math inline">\(\Omega_A \subseteq A(\mathbb{R})^0\)</span>
are compact. Then <span class="math display">\[\int _{g \in \Omega }
\phi(t g) \, d g
    \leqslant
    \int _{n \in \Omega_N}
    \int _{a \in \Omega_A}
    \int _{k \in K_\infty }
    \phi(t n a k)
    \, d k \, \frac{d a}{\delta_N(a)}  \, d n.\]</span> We write <span
class="math inline">\(t n a k = (t n t^{-1}) t a k\)</span> and apply
Lemma <a href="#lem:scratch-research:each-c-Omega-N"
data-reference-type="ref"
data-reference="lem:scratch-research:each-c-Omega-N">38</a> to the <span
class="math inline">\(n\)</span>-integral, giving <span id="eq:int-_g-in-2" class="math display">\[\label{eq:int-_g-in-2}\tag{2.66}
    \int _{g \in \Omega } \phi(t g) \, d g \leqslant
    C_1 \int _{n \in N(\mathbb{Z}) \backslash N(\mathbb{R})}
    \int _{a \in \Omega_A } \int _{k \in K_\infty } \phi(n t a k)
    \, d k
    \, \frac{d a}{\delta_N(a)}
    \, d n,\]</span> where <span class="math inline">\(C_1\)</span>
depends only upon <span class="math inline">\(\Omega\)</span>. We
substitute <span class="math inline">\(a \mapsto t^{-1} a\)</span>,
giving <span class="math display">\[\int _{g \in \Omega } \phi(t g) \, d
g \leqslant
    C_1 \delta_N(t) \int _{n \in N(\mathbb{Z}) \backslash N(\mathbb{R})}
    \int _{a \in t \Omega_A } \int _{k \in K_\infty } \phi(n a k)
    \, d k
    \, \frac{d a}{\delta_N(a)}
    \, d n.\]</span> We may find <span class="math inline">\(c &gt;
0\)</span>, depending only upon <span
class="math inline">\(\Omega\)</span>, so that <span
class="math inline">\(t \Omega_A \subseteq A(\mathbb{R})_{\geqslant
c}^0\)</span>. The conclusion then follows from Lemma <a
href="#lem:siegel-upper-basic" data-reference-type="ref"
data-reference="lem:siegel-upper-basic">37</a>. ◻</p>
</div>
<div class="proof">
<p><em>Proof of Proposition <a href="#prop:siegel-lower"
data-reference-type="ref"
data-reference="prop:siegel-lower">35</a>.</em> We argue as in the proof
of Proposition <a href="#prop:siegel-lower" data-reference-type="ref"
data-reference="prop:siegel-lower">35</a>, and integrate <a
href="#eq:int-_g-in-2" data-reference-type="eqref"
data-reference="eq:int-_g-in-2">\((2.66)\)</a> over <span
class="math inline">\(t\)</span>: <span
class="math display">\[\begin{align}
    &amp;\int_{t \in A(\mathbb{R})^0_{\geqslant 1}} \int _{g \in \Omega
} \phi(t g) \, d g \, \frac{d t}{\delta_N(t)} \\
    &amp;\leqslant
    C_1 \int _{n \in N(\mathbb{Z}) \backslash N(\mathbb{R})}
    \int _{t \in A(\mathbb{R})^0_{\geqslant 1}}
      \int _{a \in \Omega_A } \int _{k \in K_\infty } \phi(n t a k)
      \, d k
      \, \frac{d a \, d t}{\delta_N(t a)}
      \, d n.
  
\end{align}\]</span> We bring the <span
class="math inline">\(a\)</span>-integral outside and substitute <span
class="math inline">\(t \mapsto a^{-1} t\)</span>, giving <span
class="math display">\[C_1
    \int _{a \in \Omega_A }
    \int _{n \in N(\mathbb{Z}) \backslash N(\mathbb{R})}
    \int _{t \in a A(\mathbb{R})^0_{\geqslant 1}}
    \int _{k \in K_\infty } \phi(n t k)
      \, d k
      \, \frac{d t}{\delta_N(t)}
      \, d n \, d a.\]</span> We may find <span class="math inline">\(c
&gt; 0\)</span>, depending only upon <span
class="math inline">\(\Omega_A\)</span>, so that that <span
class="math inline">\(a A(\mathbb{R})_{\geqslant 1}^0 \subseteq
A(\mathbb{R})_{\geqslant c}^0\)</span> for all <span
class="math inline">\(a \in \Omega_A\)</span>. The conclusion then
follows from Lemma <a href="#lem:siegel-upper-basic"
data-reference-type="ref" data-reference="lem:siegel-upper-basic">37</a>
and the finiteness of the volume of <span
class="math inline">\(\Omega_A\)</span>. ◻</p>
</div>
<h4 id="sec:norms-cusp-forms">§2.18. Petersson norms vs. Whittaker norms</h4>
<p>Let <span class="math inline">\(G\)</span> be a general linear group
over <span class="math inline">\(\mathbb{Z}\)</span>. Let <span
class="math inline">\(\psi\)</span> be an unramified (§<a
href="#sec:stand-nond-char" data-reference-type="ref"
data-reference="sec:stand-nond-char">2.11</a>) nondegenerate unitary
character of <span class="math inline">\(N(\mathbb{A})\)</span>, trivial
on <span class="math inline">\(N(\mathbb{Q})\)</span>. Let <span
class="math inline">\(\pi\)</span> be a unitary cuspidal automorphic
representation of <span class="math inline">\(G(\mathbb{A})\)</span>.
For each prime number <span class="math inline">\(p\)</span>, let <span
class="math inline">\(W_p \in \mathcal{W}(\pi_p, \psi_p)\)</span> denote
the essential vector (§<a href="#sec:essential-vector"
data-reference-type="ref"
data-reference="sec:essential-vector">2.14.2</a>), normalized by <span
class="math inline">\(W_p(1) = 1\)</span>. Denote as usual by <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}}) \in
\mathbb{Z}_{\geqslant 1}\)</span> the finite conductor of <span
class="math inline">\(\pi\)</span>, i.e., the product of the local
conductors <span class="math inline">\(C(\pi_p)\)</span> defined in §<a
href="#sec:essential-vector" data-reference-type="ref"
data-reference="sec:essential-vector">2.14.2</a>.</p>
<p>For each archimedean Whittaker function <span
class="math inline">\(W_\infty \in \mathcal{W}(\pi_\infty,
\psi_\infty)\)</span>, there is a unique automorphic form <span
class="math inline">\(\varphi \in \pi\)</span> whose Whittaker function
<span class="math inline">\(W_\varphi(g) = \int_{[N]} \varphi(u g)
\psi^{-1}(u) \, d u\)</span> is the product of the <span
class="math inline">\(W_\mathfrak{p}\)</span>: <span
class="math display">\[W_{\varphi}(g) = \prod_{\mathfrak{p}}
W_{\mathfrak{p}}(g_\mathfrak{p}).\]</span> With respect to our fixed
Haar measures, we define the Petersson norm <span
class="math inline">\(\|\varphi \|^2 := \int _{[G/Z]}
|\varphi|^2\)</span> and the Whittaker norm <span
class="math inline">\(\|W_\infty \|^2 := \int_{N_H(\mathbb{R})
\backslash H(\mathbb{R})} |W_\infty|^2\)</span>, as in §<a
href="#sec:local-prelim-kirillov-model" data-reference-type="ref"
data-reference="sec:local-prelim-kirillov-model">2.14.1</a>. They may be
compared via the following standard estimates, obtained by combining
<a href="#ref-MR2200849" class="citation" data-cites="MR2200849">(Venkatesh 2006, sec.
7)</a> and <a href="#ref-MR2595006" class="citation" data-cites="MR2595006">(Xiannan Li
2010, sec. 1.3)</a>.</p>
<div id="lem:nonstandard-norm-whittaker" class="lemma">
<p><strong>Lemma 39</strong>. Let <span class="math inline">\(G\)</span>
and <span class="math inline">\(\psi\)</span> be as above, with <span
class="math inline">\(G\)</span> fixed. Let <span
class="math inline">\(\pi\)</span> be a unitary cuspidal automorphic
representation of <span class="math inline">\(G\)</span>. Let <span
class="math inline">\(W_\infty \in \mathcal{W}(\pi_\infty,
\psi_\infty)\)</span>. Define <span class="math inline">\(\varphi \in
\pi\)</span> as in §<a href="#sec:norms-cusp-forms"
data-reference-type="ref"
data-reference="sec:norms-cusp-forms">2.18</a>. Then <span
class="math display">\[\|\varphi \|^2
    \asymp  C(\pi_{\mathop{\mathrm{fin}}})^{o(1)}
    {\mathop{\mathrm{res}}}_{s=1}L(\pi \times \tilde{\pi}, s)
    \int _{N_H \backslash H}
    |W_\infty|^2\]</span> and <span
class="math display">\[{\mathop{\mathrm{res}}}_{s=1}L(\pi \times
\tilde{\pi}, s) \ll C(\pi)^{o(1)},\]</span> hence <span
class="math display">\[\|\varphi \|^2
    \ll C(\pi) ^{o(1)}
    \int _{N_H \backslash H}
    |W_\infty|^2.\]</span></p>
</div>
<h4 id="sec:dist-funct-d_h">§2.19. The distance function <span
class="math inline">\(d_H\)</span></h4>
<p>We specialize the definition of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 4.2)</a> to
the case that <span class="math inline">\((G,H)\)</span> is a fixed
general linear pair over <span
class="math inline">\(\mathbb{R}\)</span>, say <span
class="math inline">\((G,H) = ({\mathop{\mathrm{GL}}}_{n+1}(\mathbb{R}),
{\mathop{\mathrm{GL}}}_n(\mathbb{R}))\)</span>. Set <span
class="math inline">\(\bar{G} := G/Z =
{\mathop{\mathrm{PGL}}}_{n+1}(\mathbb{R})\)</span>. We may regard <span
class="math inline">\(H\)</span> as a subgroup of <span
class="math inline">\(\bar{G}\)</span>. For a matrix <span
class="math inline">\(x\)</span>, we write <span
class="math inline">\(|x|\)</span> for the maximum of the absolute
values of its entries. In particular, for <span class="math inline">\(g
\in \bar{G}\)</span>, we may regard <span
class="math inline">\(\mathop{\mathrm{Ad}}(g)\)</span> as a matrix
(using the standard basis for <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>) and define
<span class="math inline">\(|\mathop{\mathrm{Ad}}(g) - 1|\)</span>,
which quantifies the distance from <span
class="math inline">\(g\)</span> to the identity element.</p>
<div class="definition">
<p><strong>Definition 40</strong>. Let <span class="math inline">\(g \in
\bar{G}\)</span>. We may write <span class="math display">\[g =
\begin{pmatrix}
    a &amp; b \\
    c &amp; d
  \end{pmatrix},
  \quad
  g^{-1} =
  \begin{pmatrix}
    a&#39; &amp; b&#39; \\
    c&#39; &amp; d&#39;
  \end{pmatrix},\]</span> where <span
class="math inline">\(a,b,c,d\)</span> and <span
class="math inline">\(a&#39;,b&#39;,c&#39;,d&#39;\)</span> are matrices
of respective dimensions <span class="math inline">\(n \times n, n
\times 1, 1 \times n, 1 \times 1\)</span>, well-defined up to
simultaneous scaling. We then define <span class="math display">\[d_H(g)
:= \min\left(1, |b/d| + |b&#39;/d&#39;| + |c/d| +
|c&#39;/d&#39;|\right),\]</span> with the convention that <span
class="math inline">\(d_H(g) := 1\)</span> if either <span
class="math inline">\(d\)</span> or <span
class="math inline">\(d&#39;\)</span> vanishes.</p>
</div>
<p>Observe that <span class="math inline">\(d_H(g) = 0\)</span> if and
only if <span class="math inline">\(g\)</span> lies in (the image of)
<span class="math inline">\(H\)</span>. We may thus regard <span
class="math inline">\(d_H(g)\)</span> as a quantification of the
distance from <span class="math inline">\(g\)</span> to <span
class="math inline">\(H\)</span>.</p>
<div class="remark">
<p><strong>Remark 41</strong>. The definition given here differs mildly
from that in <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P.
D. Nelson 2023, sec. 4.2)</a>. Call the latter <span
class="math inline">\(d_H^0(g)\)</span>. As explained in <em>loc.
cit.</em>, we have <span class="math inline">\(d_H(g) \asymp
d_H^0(g)\)</span> for all <span class="math inline">\(g \in
\bar{G}\)</span>. Since we will only use <span
class="math inline">\(d_H(g)\)</span> for the purpose of quantifying
estimates, the distinction between the two definitions is
irrelevant.</p>
</div>
<p>We recall <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P.
D. Nelson 2023, Lemma 4.1)</a>:</p>
<div class="lemma">
<p><strong>Lemma 42</strong>. Suppose that <span
class="math inline">\((G,H)\)</span> is fixed. Let <span
class="math inline">\(g \in \bar{G}\)</span>.</p>
<ol type="i">
<li><p>We have <span id="eqn:d-H-Z-vs-dist-G-mod-Z" class="math display">\[\label{eqn:d-H-Z-vs-dist-G-mod-Z}\tag{2.67}
      d_{H}(g) \ll |\mathop{\mathrm{Ad}}(g)-1|.\]</span></p></li>
<li><p>Let <span class="math inline">\(u_1, u_2 \in \bar{G}\)</span>.
Suppose that <span class="math inline">\(g\)</span> belongs to a fixed
compact subset of <span class="math inline">\(\bar{G}\)</span> and that
<span class="math display">\[|\mathop{\mathrm{Ad}}(u_j)-1| \lll
      d_{H}(g)
      \quad (j=1,2).\]</span> Then <span id="eqn:d-H-Z-compare-u-g-g" class="math display">\[\label{eqn:d-H-Z-compare-u-g-g}\tag{2.68}
      d_{H}(u_1 g u_2) \asymp d_{H}(g).\]</span></p></li>
<li><p>Let <span class="math inline">\(h_1, h_2 \in H\)</span>. Suppose
that <span class="math inline">\(g,h_1,h_2\)</span> each belong to some
fixed compact subset of <span
class="math inline">\(\bar{G},H,H\)</span>, respectively. Then <span id="eqn:d-H-h1gh2" class="math display">\[\label{eqn:d-H-h1gh2}\tag{2.69}
      d_{H}(h_1 g h_2)
      \asymp d_{H}(g).\]</span></p></li>
</ol>
</div>
<h1 id="part:reduction-proof">§1. Division of the argument</h1>
<h3 id="sec:20230516081722">§3. Construction of test vectors: statement</h3>
<p>The following is the main result of Part <a
href="#part:constr-test-vect" data-reference-type="ref"
data-reference="part:constr-test-vect"></a>, which relies in turn on
Part <a href="#part:asympt-analys-kirill" data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>. The statement is
regrettably complicated, but has the advantage of being a purely local
assertion concerning representations of real groups. The sketch of §<a
href="#sec:high-level-overview" data-reference-type="ref"
data-reference="sec:high-level-overview">1.3</a> may provide a useful
roadmap for the relevance of many assertions in the following result to
our global argument. We note that, in the language of that sketch, the
Whittaker function <span class="math inline">\(W\)</span> below
describes the global cusp form <span
class="math inline">\(\varphi\)</span>. The reader may also wish to
compare with <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P.
D. Nelson 2023, Thm 4.2)</a>, the analogous result in the compact
quotient case, which is simpler.</p>
<div id="itm:sub-gln:3" class="theorem">
<p><strong>Theorem 43</strong>. <em><span id="thm:main-local-results"
label="thm:main-local-results"></span> Suppose given a fixed general
linear pair <span class="math inline">\((G,H)\)</span> over <span
class="math inline">\(\mathbb{R}\)</span>, with accompanying notation
<span class="math inline">\(A\)</span>, <span
class="math inline">\(B\)</span>, <span
class="math inline">\(N\)</span>, <span
class="math inline">\(Q\)</span>, <span
class="math inline">\(U\)</span>, <span
class="math inline">\(Z\)</span>, <span
class="math inline">\(A_H\)</span>, <span
class="math inline">\(B_H\)</span>, <span
class="math inline">\(N_H\)</span>, <span
class="math inline">\(Q_H\)</span>, <span
class="math inline">\(U_H\)</span>, <span
class="math inline">\(Z_H\)</span>, as in §<a
href="#sec:gener-line-groups-1" data-reference-type="ref"
data-reference="sec:gener-line-groups-1">2.3.3</a>. Let <span
class="math inline">\(\psi\)</span> be a nondegenerate unitary character
of <span class="math inline">\(N\)</span> equal to either the standard
character or its inverse, as in §<a href="#sec:stand-nond-char"
data-reference-type="ref" data-reference="sec:stand-nond-char">2.11</a>.
Let <span class="math inline">\(T\)</span> be a nonnegative real with
<span class="math inline">\(T \ggg 1\)</span>. Let <span
class="math inline">\(\pi\)</span> be a generic irreducible unitary
representation of <span class="math inline">\(G\)</span>, each of whose
archimedean <span class="math inline">\(L\)</span>-function parameters
has magnitude <span class="math inline">\(\asymp T\)</span>. There
exists</em></p>
<ul>
<li><p><em><span class="math inline">\(f, f_{\ast} \in \mathcal{S}^e(U_H
\backslash H)^{W_H}\)</span> (cf. <a href="#eq:mathc-backsl-gw-1"
data-reference-type="eqref"
data-reference="eq:mathc-backsl-gw-1">\((2.31)\)</a>), a
fixed element <span class="math inline">\(\phi_{Z_H} \in
C_c^\infty(Z_H)\)</span>,</em></p></li>
<li><p><em>a smooth vector <span class="math inline">\(W \in
\mathcal{W}(\pi,\psi)\)</span> of norm <span
class="math inline">\(\leqslant 1\)</span> (with respect to the norm
defined in §<a href="#sec:local-prelim-kirillov-model"
data-reference-type="ref"
data-reference="sec:local-prelim-kirillov-model">2.14.1</a>),
and</em></p></li>
<li><p><em><span class="math inline">\(\omega_0 \in
C_c^\infty(G)\)</span>, supported in each fixed neighborhood of the
identity element,</em></p></li>
</ul>
<p><em>with the following further properties. Define <span
class="math display">\[\omega(g) := (\omega_0 \ast \omega_0^*)(g) :=
\int _{h \in G} \omega(g h^{-1}) \overline{\omega(h^{-1})} \, d
h,\]</span> <span class="math display">\[\omega^\sharp (g) := \int _{z
\in Z}
  \pi|_Z (z) \omega(z g) \, d z,\]</span> where <span
class="math inline">\(\pi|_Z\)</span> denotes the central character of
<span class="math inline">\(\pi\)</span>.</em></p>
<ol type="i">
<li><p><em><span id="itm:sub-gln:5" label="itm:sub-gln:5"></span> <span
class="math inline">\(f_{\ast}(g) = \int _{z \in Z_H} f(g z^{-1})
\phi_{Z_H}(z) \, d z\)</span>.</em></p></li>
<li><p><em><span id="itm:sub-gln:6" label="itm:sub-gln:6"></span> Each
of the following assertions remains valid upon replacing <span
class="math inline">\(f\)</span> with <span
class="math inline">\(f_{\ast}\)</span>.</em></p></li>
<li><p><em><span id="itm:sub-gln:7" label="itm:sub-gln:7"></span> For
each fixed compact subset <span
class="math inline">\(\mathcal{D}\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span> and fixed <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, we
have (see §<a href="#sec:local-sobolev-norms-prelims"
data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a> for notation)
<span class="math display">\[\nu_{\mathcal{D},\ell,T}(f) \ll
T^{o(1)}.\]</span></em></p></li>
<li><p><em><span id="itm:sub-gln:8" label="itm:sub-gln:8"></span> The
local zeta integral <span class="math inline">\(Z(W,f[s])\)</span>
(defined in §<a href="#sec:zeta-integrals" data-reference-type="ref"
data-reference="sec:zeta-integrals">2.14.4</a>, and evaluated at the
Mellin component <span class="math inline">\(f[s]\)</span> defined in
§<a href="#sec:mellin-paley-affine-quotients" data-reference-type="ref"
data-reference="sec:mellin-paley-affine-quotients">2.8.3</a>) is entire
in <span class="math inline">\(s\)</span>. We have the lower bound <span
class="math display">\[Z(W,f[0]) \gg T^{- \dim(H)/4}.\]</span> For each
<span class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span>
with <span class="math inline">\(\Re(s) \ll 1\)</span>, we have the
upper bound <span class="math display">\[Z(W,f[s]) \ll  T
^{\mathop{\mathrm{rank}}(G) \mathop{\mathrm{trace}}(s)/2 - \dim(H)/4 +
o(1) }
    (1 + |s|)^{-\infty }.\]</span></em></p></li>
<li><p><em><span id="itm:sub-gln:1" label="itm:sub-gln:1"></span> For
each fixed <span class="math inline">\(u \in \mathfrak{U}(G)\)</span>,
we have <span class="math display">\[\|\pi(u) ( \pi(\omega_0) W - W)\|
\ll T^{-\infty}.\]</span></em></p></li>
<li><p><em><span id="itm:sub-gln:f-L-one-H"
label="itm:sub-gln:f-L-one-H"></span> We have <span
class="math inline">\(\int_{H} |\omega^\sharp| \leqslant
T^{\mathop{\mathrm{rank}}(H)/2 + o(1)}\)</span>.</em></p></li>
<li><p><em>For each fixed compact subset <span
class="math inline">\(\Omega_H\)</span> of <span
class="math inline">\(H\)</span>, there is a fixed compact subset <span
class="math inline">\(\Omega_H&#39;\)</span> of <span
class="math inline">\(H\)</span> with the following property. Let <span
class="math inline">\(\Psi_1, \Psi_2 : H \rightarrow \mathbb{C}\)</span>
be continuous functions. For <span class="math inline">\(j=1,2\)</span>,
define the convolutions <span class="math display">\[(\Psi_j \ast
\phi_{Z_H})(x) := \int _{z \in Z_H} \Psi_j(x z^{-1}) \phi_{Z_H}(z) \, d
z.\]</span> Let <span class="math inline">\(\gamma \in \bar{G} -
H\)</span>. Then the integral <span id="eq:i-:=-int-1" class="math display">\[\label{eq:i-:=-int-1}\tag{3.1}
      I := \int _{x, y \in \Omega_H }
    \left\lvert
      (\Psi_1 \ast \phi_{Z_H})(x)
      (\Psi_2 \ast \phi_{Z_H})(y)
      \omega^\sharp(x^{-1} \gamma y)
    \right\rvert
    \, d x \, d y\]</span> satisfies the estimate <span
class="math display">\[I \ll
  T^{\mathop{\mathrm{rank}}(H)/2 + o(1)}
  \min\left( 1,
    \frac{T^{-1/2}}{ d_H(\gamma)}
  \right)
    \|\Psi_1\|_{L^2(\Omega_H&#39;)}
    \|\Psi_2\|_{L^2(\Omega_H&#39;)}.\]</span></em></p></li>
</ol>
</div>
<p>We refer to §<a href="#sec:elem-form" data-reference-type="ref"
data-reference="sec:elem-form">6</a> for an elementary reformulation of
this result, without the language of nonstandard analysis.</p>
<div id="rmk:we-briefly-comment" class="remark">
<p><strong>Remark 44</strong>. We briefly comment on the significance of
the numbered assertions, matching them with parts of the sketch given in
§<a href="#sec:high-level-overview" data-reference-type="ref"
data-reference="sec:high-level-overview">1.3</a>.</p>
<p>(i) and (ii) are purely technical. As promised in §<a
href="#sec:analyt-test-vect" data-reference-type="ref"
data-reference="sec:analyt-test-vect">1.3.3</a>, the functions on <span
class="math inline">\(U_{H} \backslash H\)</span> that we construct are
uniformly smooth under left translation by <span
class="math inline">\(A_H\)</span>, hence in particular approximately
invariant under <span class="math inline">\(Z_H\)</span>. For later
applications, the simplest way to “remember” this feature is to
represent such elements explicitly as convolutions <span
class="math inline">\(f_{\ast}\)</span> against some fixed function on
<span class="math inline">\(Z_H\)</span>.</p>
<p>(iii) says that <span class="math inline">\(f\)</span> has the shape
promised in §<a href="#sec:analyt-test-vect" data-reference-type="ref"
data-reference="sec:analyt-test-vect">1.3.3</a>. The relation between
bounds for <span
class="math inline">\(\nu_{\mathcal{D},\ell,T}(f)\)</span> and that
informal description will be made successively more explicit in Lemmas
<a href="#lem:standard:frakE-equivalences" data-reference-type="ref"
data-reference="lem:standard:frakE-equivalences">20.2</a>
and <a href="#lem:standard:let-f-in-2" data-reference-type="ref"
data-reference="lem:standard:let-f-in-2">21.26</a>.</p>
<p>(iv) gives the control over local zeta integrals promised around <a
href="#eq:zvarphi-psi-approx" data-reference-type="eqref"
data-reference="eq:zvarphi-psi-approx">\((1.11)\)</a>.</p>
<p>(v) says that, for all practical purposes, <span
class="math inline">\(\pi(\omega_0) W \approx W\)</span>, as promised in
§<a href="#sec:relat-trace-form" data-reference-type="ref"
data-reference="sec:relat-trace-form">1.3.4</a> (recall that <span
class="math inline">\(W\)</span> describes <span
class="math inline">\(\varphi\)</span>).</p>
<p>(vi) is consistent with the shape of <span
class="math inline">\(\omega\)</span> (or <span
class="math inline">\(\omega_0\)</span>) promised in §<a
href="#sec:relat-trace-form" data-reference-type="ref"
data-reference="sec:relat-trace-form">1.3.4</a>, in view of the
stability of <span class="math inline">\(\tau\)</span> (see §<a
href="#sec:stability" data-reference-type="ref"
data-reference="sec:stability">2.3.1</a>, Lemma <a
href="#lem:standard2:no-conductor-drop-vs-tau" data-reference-type="ref"
data-reference="lem:standard2:no-conductor-drop-vs-tau">7.9</a>,
<a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P. D. Nelson and
Venkatesh 2021, Thm 17.1)</a> and <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 14.9)</a>
for details).</p>
<p>(vii) asserts a precise form of the promised “bilinear forms”
estimate <a href="#eq:t-n2-int-1" data-reference-type="eqref"
data-reference="eq:t-n2-int-1">\((1.14)\)</a>.</p>
</div>
<h3 id="growth-bounds-for-eisenstein-series-statement">Growth bounds for
Eisenstein series: statement</h3>
<p>We retain the setting and notation of §<a href="#sec:siegel-domains"
data-reference-type="ref" data-reference="sec:siegel-domains">2.17</a>,
working with <span class="math inline">\(G :=
{\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Z}\)</span> for some natural number <span
class="math inline">\(n\)</span>.</p>
<p>Let <span class="math inline">\(\Omega\)</span> be a compact subset
of <span class="math inline">\(G(\mathbb{R})\)</span>. For each <span
class="math inline">\(t \in A(\mathbb{R})^0_{\geqslant 1}\)</span>, we
define a seminorm <span class="math inline">\(\|.\|_{t,\Omega}\)</span>
on <span class="math inline">\(L^2([G])\)</span> by <span id="eq:varphi-2_r-:=" class="math display">\[\label{eq:varphi-2_r-:=}\tag{4.1}
  \|\varphi \|^2_{t,\Omega} :=
  \int _{g \in \Omega \times \prod_p K_p }
  |\varphi(t g)|^2
  \, d g.\]</span> As <span class="math inline">\(t\)</span> varies with
<span class="math inline">\(\Omega\)</span> fixed, we may understand
these seminorms as describing the local <span
class="math inline">\(L^2\)</span>-norm of <span
class="math inline">\(\varphi\)</span> near a given point in <span
class="math inline">\([G]\)</span>.</p>
<p>The following is the main result of Part <a
href="#part:local-l2-growth" data-reference-type="ref"
data-reference="part:local-l2-growth"></a></p>
<div id="thm:growth-eisenstein-nonstandard" class="theorem">
<p><strong>Theorem 45</strong>. <em>Let <span
class="math inline">\(n\)</span> be a fixed natural number, <span
class="math inline">\(G := {\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Z}\)</span>. Let <span
class="math inline">\(\Omega \subseteq G(\mathbb{R})\)</span> be a fixed
compact. Let <span class="math inline">\(T \geqslant 1\)</span>. Let
<span class="math inline">\(Y \in A(\mathbb{R})^0\)</span>. Assume that
<span class="math inline">\(T^{-\kappa} \leqslant|Y_j| \leqslant
T^{\kappa}\)</span> for all <span class="math inline">\(j\)</span> and
some fixed <span class="math inline">\(\kappa \in (0,1/2)\)</span>. Let
<span class="math inline">\(t \in A(\mathbb{R})^0_{\geqslant
1}\)</span>. Let <span class="math inline">\(f \in
\mathcal{S}^e(U(\mathbb{R}) \backslash G(\mathbb{R}))^W\)</span> such
that for each fixed compact subset <span
class="math inline">\(\mathcal{D}\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span> and fixed <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, we
have <span id="eq:nu_mathcald-ell-tf" class="math display">\[\label{eq:nu_mathcald-ell-tf}\tag{4.2}
    \nu_{\mathcal{D},\ell,T}(f) \ll T^{o(1)},\]</span> with the Sobolev
norm <span class="math inline">\(\nu_{\mathcal{D},\ell,T}\)</span> as
defined in §<a href="#sec:local-sobolev-norms-prelims"
data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a>. Then we have
the following local <span class="math inline">\(L^2\)</span>-norm bound
for pseudo Eisenstein series, defined as in §<a
href="#sec:notat-basic-defin" data-reference-type="ref"
data-reference="sec:notat-basic-defin">2.16.1</a>: <span id="eq:fraceis--phily" class="math display">\[\label{eq:fraceis--phily}\tag{4.3}
    \frac{\|\mathop{\mathrm{Eis}}[ \Phi[L(Y) f] ]
\|_{t,\Omega}^2}{\delta_N(t)}
    \ll T^{o(1)} \min \left( \det(Y)^{-1} t_1^{-n}, \det(Y) t_n^n
\right).\]</span></em></p>
</div>
<p>We refer again to §<a href="#sec:elem-form" data-reference-type="ref"
data-reference="sec:elem-form">6</a> for an elementary reformulation of
this result, without the language of nonstandard analysis.</p>
<div class="remark">
<p><strong>Remark 46</strong>. For the sake of comparison with the
sketch of §<a href="#sec:high-level-overview" data-reference-type="ref"
data-reference="sec:high-level-overview">1.3</a>, we note that the
hypothesis <a href="#eq:nu_mathcald-ell-tf" data-reference-type="eqref"
data-reference="eq:nu_mathcald-ell-tf">\((4.2)\)</a> says
that <span class="math inline">\(f\)</span> has the shape promised in
§<a href="#sec:analyt-test-vect" data-reference-type="ref"
data-reference="sec:analyt-test-vect">1.3.3</a> (cf. Remark <a
href="#rmk:we-briefly-comment" data-reference-type="ref"
data-reference="rmk:we-briefly-comment">44</a>, Lemmas <a
href="#lem:standard:frakE-equivalences" data-reference-type="ref"
data-reference="lem:standard:frakE-equivalences">20.2</a>
and <a href="#lem:standard:let-f-in-2" data-reference-type="ref"
data-reference="lem:standard:let-f-in-2">21.26</a>),
while the conclusion <a href="#eq:fraceis--phily"
data-reference-type="eqref"
data-reference="eq:fraceis--phily">\((4.3)\)</a> is
essentially the promised pair of estimates <a
href="#eq:psi-_l2t-mathcalh2" data-reference-type="eqref"
data-reference="eq:psi-_l2t-mathcalh2">\((1.18)\)</a> and
<a href="#eq:psi-_l2t-mathcalh2-2" data-reference-type="eqref"
data-reference="eq:psi-_l2t-mathcalh2-2">\((1.20)\)</a>.
The reader might wish to pretend that <span class="math inline">\(Y =
1\)</span> on a first reading, since for the purpose of obtaining a
qualitative subconvex bound (without an effective exponent), one can
take <span class="math inline">\(\kappa\)</span> arbitrarily small.</p>
</div>
<h3 id="sec:reduction-proof-0">§5. Reduction of the proof</h3>
<p>We aim now to deduce Theorem <a href="#thm:main-result-reformulated"
data-reference-type="ref"
data-reference="thm:main-result-reformulated">10</a> from Theorems <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a> and
<a href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>.</p>
<h4 id="sec:setup-prel-reduct">§5.1. Setup and preliminary reductions</h4>
<p>Let <span class="math inline">\((G,H)\)</span> be a fixed general
linear pair over <span class="math inline">\(\mathbb{Z}\)</span>, with
<span class="math inline">\(H\)</span> nontrivial. In this section, we
label indices as follows: <span class="math display">\[(G,H) =
({\mathop{\mathrm{GL}}}_{n+1}, {\mathop{\mathrm{GL}}}_n).\]</span> Thus
<span class="math inline">\(n\)</span> is a fixed natural number <span
class="math inline">\(\geqslant 1\)</span>.</p>
<p>Let <span class="math inline">\(T \geqslant 1\)</span>. Let <span
class="math inline">\(\pi\)</span> be a unitary cuspidal automorphic
representation of <span class="math inline">\(G\)</span>, each of whose
archimedean <span class="math inline">\(L\)</span>-function parameters
are <span class="math inline">\(\asymp T\)</span>. We must show, for
suitable fixed <span class="math inline">\(\delta &gt; 0\)</span>, that
<span id="eq:lpi-tfrac12-ll" class="math display">\[\label{eq:lpi-tfrac12-ll}\tag{5.1}
  L(\pi,\tfrac{1}{2}) \ll C(\pi_{\mathop{\mathrm{fin}}})^{1/2} T^{(1 -
\delta) (n+1)/4}.\]</span></p>
<p>Consider first the case that <span class="math inline">\(T \ll
1\)</span>. Then <span class="math inline">\(C(\pi_\infty) \ll
1\)</span>, so <span class="math inline">\(C(\pi) \asymp
C(\pi_{\mathop{\mathrm{fin}}})\)</span>. In that case, the convexity
bound (Lemma <a href="#lem:convexity-bound" data-reference-type="ref"
data-reference="lem:convexity-bound">23</a>) implies that <span
class="math inline">\(L(\pi,\tfrac{1}{2}) \ll
C(\pi_{\mathop{\mathrm{fin}}})^{1/4 + o(1)}\)</span>, while the RHS of
<a href="#eq:lpi-tfrac12-ll" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-ll">\((5.1)\)</a> is <span
class="math inline">\(\asymp
C(\pi_{\mathop{\mathrm{fin}}})^{1/2}\)</span>. The required estimate <a
href="#eq:lpi-tfrac12-ll" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-ll">\((5.1)\)</a> thus holds in
that case. We thereby reduce to the case that <span id="eq:t-ggg-1" class="math display">\[\label{eq:t-ggg-1}\tag{5.2}
T \ggg 1.\]</span></p>
<p>We may similarly reduce to the case that <span id="eq:n_pi-=-to1" class="math display">\[\label{eq:n_pi-=-to1}\tag{5.3}
  C(\pi_{\mathop{\mathrm{fin}}}) \leqslant
T^{\operatorname{O}(1)}.\]</span> Otherwise, the RHS of <a
href="#eq:lpi-tfrac12-ll" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-ll">\((5.1)\)</a> is readily
seen to be <span class="math inline">\(\gg C(\pi)^{1/3}\)</span>, say,
and the required bound follows again from convexity.</p>
<p>We appeal throughout this section to Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>.</p>
<h4 id="sec:constr-autom-forms">§5.2. Construction of automorphic forms</h4>
<p>We let <span class="math inline">\(\psi\)</span> denote the standard
nondegenerate unitary character of <span
class="math inline">\(N(\mathbb{A})\)</span>, trivial on <span
class="math inline">\(N(\mathbb{Q})\)</span> (§<a
href="#sec:stand-nond-char" data-reference-type="ref"
data-reference="sec:stand-nond-char">2.11</a>). We denote also simply by
<span class="math inline">\(\psi\)</span> its restriction to <span
class="math inline">\(N(\mathbb{Q}_\mathfrak{p})\)</span> for each place
<span class="math inline">\(\mathfrak{p}\)</span> of <span
class="math inline">\(\mathbb{Q}\)</span>, and also to <span
class="math inline">\(N_H(\mathbb{A}),
N_H(\mathbb{Q}_\mathfrak{p})\)</span>.</p>
<p>Let <span class="math inline">\(W_{\infty} \in
\mathcal{W}(\pi_\infty, \psi)\)</span> denote the smooth vector
furnished by Theorem <a href="#thm:main-local-results"
data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>.
Let <span class="math inline">\(\varphi \in \pi\)</span> denote the
automorphic form attached to <span
class="math inline">\(W_{\infty}\)</span>, as in §<a
href="#sec:norms-cusp-forms" data-reference-type="ref"
data-reference="sec:norms-cusp-forms">2.18</a>, by requiring that its
local components at finite primes be normalized essential vectors <span
class="math inline">\(W_{\pi,p} \in \mathcal{W}(\pi_p, \psi)\)</span>.
By the estimates of that section (cf. Lemma <a
href="#lem:nonstandard-norm-whittaker" data-reference-type="ref"
data-reference="lem:nonstandard-norm-whittaker">39</a>) and our
assumption <a href="#eq:n_pi-=-to1" data-reference-type="eqref"
data-reference="eq:n_pi-=-to1">\((5.3)\)</a>, we then have the
Petersson norm estimate <span id="eq:varphi-2-asymp" class="math display">\[\label{eq:varphi-2-asymp}\tag{5.4}
  \|\varphi \|
  \leqslant T^{o(1)}.\]</span></p>
<p>Since <span class="math inline">\(\varphi\)</span> is cuspidal, its
restriction to <span class="math inline">\([H]\)</span> decays rapidly,
so the integral <span class="math inline">\(\int_{[H]} \varphi
\Psi\)</span> converges absolutely for any automorphic function <span
class="math inline">\(\Psi\)</span> on <span
class="math inline">\([H]\)</span> of moderate growth. We may unfold
that integral using the Whittaker expansion (cf. <a href="#ref-MR348047" class="citation"
data-cites="MR348047">(Shalika 1974, Thm 5.9)</a>) <span
class="math display">\[\varphi(g) = \sum _{\gamma \in N_H(\mathbb{Q})
\backslash H(\mathbb{Q})} W_\varphi(\gamma g).\]</span> Working formally
for the moment, we obtain <span id="eqn:unfolding-rs-1" class="math display">\[\label{eqn:unfolding-rs-1}\tag{5.5}
  \int_{[H]} \varphi \Psi
  =
  \int_{N_H(\mathbb{Q}) \backslash H(\mathbb{A})}
  W_\varphi \Psi
  =
  \int_{N_H(\mathbb{A}) \backslash H(\mathbb{A})}
  W_\varphi \tilde{W}_{\Psi},\]</span> where the dual Whittaker function
<span class="math inline">\(\tilde{W}_{\Psi}\)</span> is defined by
<span class="math display">\[\tilde{W}_{\Psi}(g)
  = \int_{[N_H]}
  \Psi(u g) \psi(u ) \, d u.\]</span> Such calculations <a
href="#eqn:unfolding-rs-1" data-reference-type="eqref"
data-reference="eqn:unfolding-rs-1">\((5.5)\)</a> are the
starting point for the study of <span
class="math inline">\({\mathop{\mathrm{GL}}}_{n+1} \times
{\mathop{\mathrm{GL}}}_n\)</span> zeta integrals due to Jacquet,
Piatetski-Shapiro and Shalika.</p>
<p>For each <span class="math inline">\(s \in
\mathfrak{a}_{H,\mathbb{C}}^*\)</span>, we denote by <span
class="math inline">\(\mathcal{I}(s) =
{\mathop{\mathrm{Ind}}}_{Q_H(\mathbb{A})}^{H(\mathbb{A})} (|.|^s)\)</span>
the corresponding principal series representation of <span
class="math inline">\(H(\mathbb{A})\)</span>, as defined in §<a
href="#sec:induc-repr" data-reference-type="ref"
data-reference="sec:induc-repr">2.7</a>; we recall that it is the
restricted tensor product of local principal series representations
<span class="math inline">\(\mathcal{I}_\mathfrak{p}(s) =
{\mathop{\mathrm{Ind}}}_{Q_H(\mathbb{Q}_\mathfrak{p})}^{H(\mathbb{Q}_\mathfrak{p})}(|.|_{\mathfrak{p}}^s)\)</span>.</p>
<p>Let <span class="math inline">\(f, f_{\ast} \in
\mathcal{S}^e(U_H(\mathbb{R}) \backslash H(\mathbb{R}))^{W_H}\)</span>
denote the vectors furnished by Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>,
with associated Mellin components <span class="math inline">\(f[s],
f_{\ast}[s] \in \mathcal{I}_\infty(s)\)</span>. Recall the elements
<span id="eq:phi-:=-phif" class="math display">\[\label{eq:phi-:=-phif}\tag{5.6}
  \Phi[f] \in \mathcal{S}^e([H]_{Q_H})\]</span> constructed in §<a
href="#sec:compl-eisenst-seri" data-reference-type="ref"
data-reference="sec:compl-eisenst-seri">2.16</a>, with Mellin components
<span class="math display">\[\Phi[f][s] \in \mathcal{I}(s).\]</span>
This notation and the following discussion applies also with <span
class="math inline">\(f\)</span> replaced by <span
class="math inline">\(f_{\ast}\)</span>.</p>
<p>Suppose for the moment that <span class="math inline">\(\Re(s) \succ
\rho_U\)</span>, so that the series definition of, e.g., <span
class="math inline">\(\mathop{\mathrm{Eis}}[\Phi[f][s]] \in
\mathcal{T}([H])\)</span> applies. By the unfolding identity <a
href="#eq:weisf-psig-=" data-reference-type="eqref"
data-reference="eq:weisf-psig-=">\((2.42)\)</a>, the definition
(§<a href="#sec:notat-basic-defin" data-reference-type="ref"
data-reference="sec:notat-basic-defin">2.16.1</a>) of <span
class="math inline">\(\Phi[f][s]\)</span> and the Casselman–Shalika
formula <a href="#eq:wf0chi-psi1-casselman-shalika"
data-reference-type="eqref"
data-reference="eq:wf0chi-psi1-casselman-shalika">\((2.24)\)</a>,
we see that the global Whittaker function of <span
class="math inline">\(\mathop{\mathrm{Eis}}(\Phi[f][s])\)</span> is
given by <span id="eq:weisphis-psi-1g" class="math display">\[\label{eq:weisphis-psi-1g}\tag{5.7}
  W[\mathop{\mathrm{Eis}}[\Phi[f][s]], \psi^{-1}](g)
  =
  \mathcal{P}_H(s)
  W[f[s], \psi^{-1}](g_\infty)
  \prod_p W_{s,p}(g_p)\]</span> where <span
class="math inline">\(W_{s,p} \in \mathcal{W}(\mathcal{I}_p(s),
\psi^{-1})\)</span> denotes the spherical element of the local Whittaker
model satisfying the normalization <span
class="math inline">\({W}_{s,p}(1) = 1\)</span>.</p>
<p>Let <span class="math inline">\(Y\)</span> be an element of the
identity component <span
class="math inline">\(A_H(\mathbb{R})^0\)</span> of <span
class="math inline">\(A_H(\mathbb{R})\)</span>. We identify <span
class="math inline">\(Y\)</span> with an element of <span
class="math inline">\(A_H(\mathbb{A})\)</span> via the standard
inclusion. We define the element <span class="math display">\[L(Y)
\Phi[f] \in \mathcal{S}([H]_{B_H}),\]</span> as in <a
href="#eq:normalized-left-translation" data-reference-type="eqref"
data-reference="eq:normalized-left-translation">\((2.7)\)</a>,
by normalized left translation: <span id="eq:ly-phig-=" class="math display">\[\label{eq:ly-phig-=}\tag{5.8}
  L(Y) \Phi[f](g) = \delta_{U_H}^{-1/2}(Y) \Phi[f](Y g),\]</span> or
equivalently, via the Mellin integral <span class="math display">\[L(Y)
\Phi[f] = \int _{(\sigma)} Y^{s} \Phi[f][s] \, d
\mu_{[A_H]}(s),\]</span> convergent for all <span
class="math inline">\(\sigma \in \mathfrak{a}_H^*\)</span>. (Here <span
class="math inline">\(Y^s\)</span> abbreviates <span
class="math inline">\(|Y|^s\)</span>, noting that the entries of <span
class="math inline">\(Y\)</span> are positive.) We define the associated
pseudo Eisenstein series <span class="math display">\[\Psi[Y] :=
\mathop{\mathrm{Eis}}[L(Y) \Phi[f]] \in \mathcal{S}([H]),\]</span> which
in turn admits the Mellin integral representation <span
class="math display">\[\begin{align}
  \Psi[Y] &amp;=
               \int _{(\sigma)} Y^{s}
               \mathop{\mathrm{Eis}}[\Phi[s]]
               \, d \mu_{[A_H]}(s) \\
  &amp;=
  \int _{(\sigma)}
  Y^{s} \mathcal{P}_H(s) \zeta(U_H,s)
  \mathop{\mathrm{Eis}}[f[s] \otimes (\otimes_{p} f_p[s])] \, d
\mu_{[A_H]}(s).
\end{align}\]</span> We analogously define <span
class="math display">\[\Psi_{\ast}[Y] := \mathop{\mathrm{Eis}}[L(Y)
\Phi[f_{\ast}]],\]</span> which admits an analogous integral
representation.</p>
<h4 id="sec:reduct-peri-bounds">§5.3. Reduction to period bounds</h4>
<p>Since <span class="math inline">\(\varphi|_{[H]}\)</span> and <span
class="math inline">\(\Psi[Y]\)</span> are (both) of rapid decay, the
integral of their product <span class="math display">\[I(Y) :=
\int_{[H]} \varphi \Psi_{\ast}[Y]\]</span> converges absolutely. The
following lemma reduces our task of bounding <span
class="math inline">\(L(\pi,\tfrac{1}{2})\)</span> to one of bounding
the periods <span class="math inline">\(I(Y)\)</span> for <span
class="math inline">\(Y\)</span> “fairly close” to the identity element
<span class="math inline">\(1\)</span>.</p>
<div id="lem:sub-gln:fix-kappa-in" class="lemma">
<p><strong>Lemma 47</strong>. Fix <span class="math inline">\(\kappa \in
(0,1/2)\)</span> and <span class="math inline">\(\delta &gt; 0\)</span>.
Assume that whenever each component <span
class="math inline">\(Y_j\)</span> of <span
class="math inline">\(Y\)</span> satisfies <span
class="math inline">\(T^{-\kappa} \leqslant|Y_j| \leqslant
T^{\kappa}\)</span>, we have <span id="eq:iy-ll-tn4" class="math display">\[\label{eq:iy-ll-tn4}\tag{5.9}
    I(Y) \ll C(\pi_{\mathop{\mathrm{fin}}})^{n/2} T^{n/4
-\delta}.\]</span> Then <span id="eq:lpi-tfrac12n-ll_eps" class="math display">\[\label{eq:lpi-tfrac12n-ll_eps}\tag{5.10}
    L(\pi,\tfrac{1}{2})^{n} \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
    T^{n(n+1)/4 - \min(\kappa/2,\delta) + o(1)}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We begin by expanding <span
class="math inline">\(I(Y)\)</span> as a contour integral. Since <span
class="math inline">\(\varphi\)</span> is cuspidal, we have <span
class="math inline">\(\varphi|_{[H]} \in \mathcal{S}([H])\)</span>. By
<a href="#eq:int-_g-eisf" data-reference-type="eqref"
data-reference="eq:int-_g-eisf">\((2.41)\)</a>, it follows that
for each <span class="math inline">\(\sigma \in
\mathfrak{a}_H^*\)</span> with <span class="math inline">\(\sigma \succ
\rho_{U_H}\)</span>, we have <span id="eq:iy-=-int_c" class="math display">\[\label{eq:iy-=-int_c}\tag{5.11}
    I(Y)
    =
    \int_{(\sigma)}
    Y^{s}
    \tilde{I}(s)
    \, d s,\]</span> where <span class="math display">\[\tilde{I}(s) :=
\int_{[H]} \varphi
\mathop{\mathrm{Eis}}[\Phi[f_{\ast}][s]].\]</span></p>
<p>We now apply the unfolding identity <a href="#eqn:unfolding-rs-1"
data-reference-type="eqref"
data-reference="eqn:unfolding-rs-1">\((5.5)\)</a>, the
Whittaker function evaluation <a href="#eq:weisphis-psi-1g"
data-reference-type="eqref"
data-reference="eq:weisphis-psi-1g">\((5.7)\)</a>, and the
local unramified evaluation given by Theorem <a
href="#thm:jpss-essential-vector-factorized" data-reference-type="ref"
data-reference="thm:jpss-essential-vector-factorized">22</a>. Arguing
formally for the moment, we obtain <span
class="math display">\[\begin{align}
    \nonumber
    \tilde{I}(s)
    &amp;= \int _{N_H(\mathbb{A}) \backslash H(\mathbb{A})} W_\varphi(g)
W[\mathop{\mathrm{Eis}}[\Phi[f_{\ast}][s]], \psi^{-1}](g) \, d g \\
    \nonumber
    &amp;=
      \mathcal{P}_H(s) Z_\infty(s)
      \prod_p
      \int _{N_H(\mathbb{Q}_p) \backslash H(\mathbb{Q}_p)} W_{\pi,p}(g)
W_{s,p}(g) \, d g \\
    &amp;=
      Z_\infty(s) \mathcal{L}(s),
  
\end{align}\]</span> where <span class="math display">\[Z_\infty(s)
    :=
    \int_{h \in N_H(\mathbb{R}) \backslash H(\mathbb{R})}
    W_{\infty}(h) W[f_{\ast}[s], \psi^{-1}](h) \, d h\]</span> and <span
class="math display">\[\mathcal{L}(s) :=
  \mathcal{P}_H(s)
  \prod_{j=1}^n L(\pi, \tfrac{1}{2} + s_j).\]</span> To make this
calculation rigorous, we first introduce a complex parameter <span
class="math inline">\(u \in \mathbb{C}\)</span> of sufficiently large
real part. Then, by the same proof as in the case of a cuspidal
Rankin–Selberg convolution (see <a href="#ref-MR2508768" class="citation"
data-cites="MR2508768">(Cogdell 2008, sec. 2.2.2)</a>, <a href="#ref-MR528964"
class="citation" data-cites="MR528964">(Hervé Jacquet,
Piatetski-Shapiro, and Shalika 1979b, sec. 13)</a>), the integral
<span class="math display">\[\int _{N_H(\mathbb{A}) \backslash
H(\mathbb{A})} W_\varphi(g) W[\mathop{\mathrm{Eis}}[\Phi[f_{\ast}][s]],
\psi^{-1}](g) |\det g|^u \, d g\]</span> converges absolutely. On the
one hand, it folds up to the (convergent) global integral <span
class="math display">\[\tilde{I}(s,u) := \int _{[H]} \varphi
\mathop{\mathrm{Eis}}[\Phi[f_{\ast}][s]] |\det|^u,\]</span> which is
analytic in <span class="math inline">\(u\)</span> and satisfies <span
class="math inline">\(\tilde{I}(s,0) = \tilde{I}(s)\)</span>. On the
other hand, it factors as a product of local integrals <span
class="math inline">\(Z_\infty(s,u) \mathcal{L}(s + u e)\)</span>, where
<span class="math inline">\(e = (1,\dotsc,1)\)</span> and <span
class="math inline">\(Z_\infty(s,u)\)</span> is defined like <span
class="math inline">\(Z_\infty(s)\)</span>, but with an additional
factor of <span class="math inline">\(|\det h|^u\)</span> in the
integrand. By specializing the resulting identity to <span
class="math inline">\(u=0\)</span>, we deduce the claimed factorization
of <span class="math inline">\(\tilde{I}(s)\)</span>.</p>
<p>We abbreviate <span class="math display">\[\langle s \rangle := 1 +
|s|.\]</span> Recall from Theorem <a href="#thm:main-local-results"
data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>,
part <a href="#itm:sub-gln:8" data-reference-type="eqref"
data-reference="itm:sub-gln:8">\((iv)\)</a> that <span
class="math inline">\(Z_\infty(s)\)</span> is entire and of rapid
vertical decay, i.e., <span class="math inline">\(Z_\infty(s) \ll
\left\langle s \right\rangle^{-\infty}\)</span> for <span
class="math inline">\(\Re(s) \ll 1\)</span>. On the other hand, <span
class="math inline">\(\mathcal{L}(s)\)</span> is entire and polynomially
bounded in vertical strips, i.e., <span
class="math inline">\(\mathcal{L}(s) \ll C(\pi)^{\operatorname{O}(1)}
\left\langle s \right\rangle^{\operatorname{O}(1)}\)</span> for <span
class="math inline">\(\Re(s) \ll 1\)</span> (see <a
href="#eq:lpi-tfrac12-+-2" data-reference-type="eqref"
data-reference="eq:lpi-tfrac12-+-2">\((2.36)\)</a>). The
product <span class="math inline">\(\tilde{I}(s)\)</span> is thus entire
and of rapid decay in vertical strips, and so we may shift the contour
integral in <a href="#eq:iy-=-int_c" data-reference-type="eqref"
data-reference="eq:iy-=-int_c">\((5.11)\)</a> to any <span
class="math inline">\(\sigma \in [-1/2, 1/2]^n\)</span>.</p>
<p>By Theorem <a href="#thm:main-local-results"
data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>, we
have <span class="math display">\[Z_\infty(s) \ll T^{\frac{n+1}{2} \sum
s_j - n^2/4 + o(1)} \langle s \rangle^{-\infty},
    \quad
    Z_\infty(0) \gg T^{-{n^2}/{4}}.\]</span> We appeal to the convexity
bound <a href="#eqn:convexity-polynomially-in-s"
data-reference-type="eqref"
data-reference="eqn:convexity-polynomially-in-s">\((2.38)\)</a>,
which gives for <span class="math inline">\(|\Re(s_j)| \leqslant
1/2\)</span> the estimate <span class="math display">\[L(\pi,
\tfrac{1}{2} +s_j)
    \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{(1 - 2 s_j)/4}
    T^{(n+1)(1 - 2 s_j)/4 + o(1)}
    \langle s_j \rangle^{\operatorname{O}(1)}.\]</span> Estimating quite
crudely with respect to the finite conductor <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}})\)</span>, we deduce
that for <span class="math inline">\(\max_j |\Re(s_j)| \leqslant
1/2\)</span>, <span class="math display">\[\tilde{I}(s)
    \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
    T^{n/4 + o(1) }
    \langle s \rangle^{-\infty}.\]</span> By shifting the Mellin
expansion <a href="#eq:iy-=-int_c" data-reference-type="eqref"
data-reference="eq:iy-=-int_c">\((5.11)\)</a> to the contour
defined by the conditions <span class="math inline">\(\Re(s_j) =
\sigma_j\)</span> with <span class="math inline">\(\sigma_j = \pm
1/2\)</span> (taking all possible signs), we deduce the following
“convexity” bound for the period <span
class="math inline">\(I(Y)\)</span>: <span id="eq:iy-ll-t" class="math display">\[\label{eq:iy-ll-t}\tag{5.12}
    I(Y) \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
    T^{n/4 + o(1) }
    (Y ^\dagger )^{-1/2},
    \quad
    Y ^\dagger :=
    \prod_{j=1}^n
    \max(Y_j, Y_j^{-1}).\]</span></p>
<p>Let <span class="math inline">\(\mathcal{Y}\)</span> denote the set
of all <span class="math inline">\(Y\)</span> for which <span
class="math inline">\(T^{-\kappa} \leqslant Y_j \leqslant
T^{\kappa}\)</span> for all <span class="math inline">\(j\)</span>. Fix
<span class="math inline">\(\varepsilon\in (0,1/2)\)</span>. For <span
class="math inline">\(Y \notin \mathcal{Y}\)</span>, we have <span
class="math inline">\(Y ^\dagger \geqslant T^{\kappa}\)</span>, and in
fact <span class="math display">\[\int _{Y \notin \mathcal{Y} } (Y
^\dagger)^{\varepsilon- 1/2} \, d Y \ll T^{(\varepsilon- 1/2) \kappa}
(\log T)^{n-1},\]</span> where <span class="math inline">\(d Y\)</span>
denotes the multiplicative Haar measure on <span
class="math inline">\(A_H(\mathbb{R})^0\)</span>. By <a
href="#eq:iy-ll-t" data-reference-type="eqref"
data-reference="eq:iy-ll-t">\((5.12)\)</a>, it follows that <span id="eq:int_y-notin-mathc" class="math display">\[\label{eq:int_y-notin-mathc}\tag{5.13}
    \int_{Y \notin \mathcal{Y} }
    |I(Y)| (Y ^\dagger )^{\varepsilon} \, d Y
    \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
    T^{n/4  + o(1) - (1/2-\varepsilon) \kappa}.\]</span> Recall from <a
href="#eq:iy-ll-tn4" data-reference-type="eqref"
data-reference="eq:iy-ll-tn4">\((5.9)\)</a> our assumption that
<span class="math inline">\(I(Y) \ll
C(\pi_{\mathop{\mathrm{fin}}})^{n/2} T^{n/4 - \delta}\)</span> for <span
class="math inline">\(Y \in \mathcal{Y}\)</span>. Integrating this
assumption over <span class="math inline">\(\mathcal{Y}\)</span> and
combining with <a href="#eq:int_y-notin-mathc"
data-reference-type="eqref"
data-reference="eq:int_y-notin-mathc">\((5.13)\)</a> gives
the overall bound <span class="math display">\[\int_{Y} |I(Y)| (Y
^\dagger )^\varepsilon\, d Y
    \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
    T^{n/4  - \min(\kappa/2,\delta)  + \varepsilon(1 + \kappa)
},\]</span> say. By Mellin inversion, we deduce that for <span
class="math inline">\(\max_j
   |\Re(s_j)| \leqslant\varepsilon\)</span>, <span
class="math display">\[\tilde{I}(s)
    \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
    T^{n/4  - \min(\kappa/2,\delta)  + \varepsilon(1 + \kappa)
}.\]</span> By an <span class="math inline">\(n\)</span>-fold
application of Cauchy’s residue theorem, we deduce the same bound for
each fixed Taylor coefficient of <span
class="math inline">\(\tilde{I}(s)\)</span> at <span
class="math inline">\(s=0\)</span>. In particular, <span
class="math display">\[Z_\infty(0)
    L(\pi,\tfrac{1}{2})^n \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
    T^{n/4  - \min(\kappa/2,\delta) + \varepsilon(1 + \kappa)
}.\]</span> Since this estimate holds for each fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>, it holds also with
<span class="math inline">\(\varepsilon(1 + \kappa)\)</span> replaced by
<span class="math inline">\(o(1)\)</span> (Lemma <a
href="#lem:overspill-A-vs-T-eps" data-reference-type="ref"
data-reference="lem:overspill-A-vs-T-eps">13</a>). By combining with the
lower bound for <span class="math inline">\(Z_\infty(0)\)</span> noted
previously, we deduce the claim <a href="#eq:lpi-tfrac12n-ll_eps"
data-reference-type="eqref"
data-reference="eq:lpi-tfrac12n-ll_eps">\((5.10)\)</a>. ◻</p>
</div>
<p>By Lemma <a href="#lem:sub-gln:fix-kappa-in"
data-reference-type="ref"
data-reference="lem:sub-gln:fix-kappa-in">47</a>, our task reduces to
estimating the period integrals <span class="math display">\[\int _{[H]}
\varphi \Psi_{\ast}[Y]\]</span> for <span class="math inline">\(Y \in
A_H(\mathbb{R})^0\)</span> with <span class="math inline">\(T^{-\kappa}
\leqslant Y_j \leqslant T^\kappa\)</span>, where <span
class="math inline">\(\kappa \in (0,1/2)\)</span> is a fixed parameter.
Since we focus in what follows on individual values of <span
class="math inline">\(Y\)</span>, we abbreviate <span
class="math display">\[\Psi_{\ast} := \Psi_{\ast}[Y],
  \quad
  \Psi := \Psi[Y].\]</span></p>
<h4 id="sec:matr-coeff-our">§5.4. Matrix coefficients of <span
class="math inline">\(\Psi\)</span></h4>
<p>Let <span class="math inline">\(\mathcal{H}_H\)</span> denote the
spherical Hecke algebra for <span
class="math inline">\(H(\mathbb{Z})\)</span>, as in §<a
href="#sec:matr-coeff-bounds" data-reference-type="ref"
data-reference="sec:matr-coeff-bounds">2.16.3</a>.</p>
<div id="lem:sub-gln:each-y-in" class="lemma">
<p><strong>Lemma 48</strong>. For each nonnegative <span
class="math inline">\(t \in \mathcal{H}_H\)</span> and <span
class="math inline">\(h \in H(\mathbb{R})\)</span>, we have <span
class="math display">\[\left\langle R(h) t \Psi, \Psi  \right\rangle \ll
\lambda_0(t) T^{o(1)},\]</span> and similarly for <span
class="math inline">\(\Psi_{\ast}\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Lemma <a href="#lem:standard2:let-d_1-d_2"
data-reference-type="ref"
data-reference="lem:standard2:let-d_1-d_2">14</a> and assertion <a
href="#itm:sub-gln:7" data-reference-type="eqref"
data-reference="itm:sub-gln:7">\((iii)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>
give, fixed <span class="math inline">\(d_1, d_2 \in
\mathbb{Z}_{\geqslant 0}\)</span>, <span
class="math display">\[\mathcal{S}_{d_1,d_2}(f) \ll T^{o(1)}.\]</span>
The conclusion then follows from Lemma <a
href="#lem:standard2:matrix-coeff-bounds" data-reference-type="ref"
data-reference="lem:standard2:matrix-coeff-bounds">31</a>; the latter is
applicable because, by construction, <span class="math inline">\(f \in
\mathcal{S}^e(U_H(\mathbb{R}) \backslash
H(\mathbb{R}))^{W_H}\)</span>. ◻</p>
</div>
<div id="cor:standard2:we-have-psi" class="corollary">
<p><strong>Corollary 49</strong>. <em>We have the <span
class="math inline">\(L^2([H])\)</span> estimate <span
class="math inline">\(\|\Psi \| \ll T^{o(1)}\)</span>, and similarly for
<span class="math inline">\(\Psi_{\ast}\)</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Take <span class="math inline">\((t,h) =
(1,1)\)</span>. ◻</p>
</div>
<h4 id="sec:intr-an-appr">§5.5. Introduction of an approximate idempotent</h4>
<p>Let <span class="math inline">\(\omega_{0,\infty} \in
C_c^\infty(G(\mathbb{R}))\)</span> be the element produced by Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>
(denoted there by “<span class="math inline">\(\omega_0\)</span>”).
Recall that it is supported in each fixed neighborhood of the identity
element. In particular, it is supported in <em>some</em> fixed compact
subset <span class="math inline">\(E_{G(\mathbb{R})} \subseteq
G(\mathbb{R})\)</span>.</p>
<p>Let <span class="math inline">\(p\)</span> be a prime number. For
each <span class="math inline">\(q \in \{1, p, p^2, \dotsc\}\)</span>,
we may define the congruence subgroup <span
class="math inline">\(K_0(q)_p \leqslant G(\mathbb{Z}_p)\)</span>
consisting of matrices with bottom row congruent to <span
class="math inline">\((0,\dotsc,0,\ast)\)</span> modulo <span
class="math inline">\(q\)</span>. Let <span class="math display">\[d :
K_0(q)_p \rightarrow \mathbb{Z}_p^\times / (\mathbb{Z}_p^\times \cap (1
+ q \mathbb{Z}_p))\]</span> denote the homomorphism assigning to a
matrix the class of its lower-right entry. Let <span
class="math inline">\(C(\pi_p) \in \{1, p, p^2, \dotsc \}\)</span>
denote the conductor of the component <span
class="math inline">\(\pi_p\)</span>. Let <span
class="math inline">\(\pi_p|_{Z} : \mathbb{Q}_p^\times \rightarrow
\mathop{\mathrm{U}}(1)\)</span> denote the central character of <span
class="math inline">\(\pi_p\)</span>. Let <span
class="math inline">\(\omega_{0,p} \in
C_c^\infty(G(\mathbb{Q}_p))\)</span> denote the function supported on
<span class="math inline">\(K_0(C(\pi_p))_p\)</span> and given there by
the following <span class="math inline">\(L^2\)</span>-normalized
character: <span class="math display">\[g \mapsto
\mathop{\mathrm{vol}}(K_0(C(\pi_p))_p)^{-1/2}
\pi_p|_{Z}(d(g))^{-1}.\]</span> Note that this character is well-defined
due to the fact the conductor of <span
class="math inline">\(\pi_p|_{Z}\)</span> divides that of <span
class="math inline">\(\pi_p\)</span> (§<a href="#sec:essential-vector"
data-reference-type="ref"
data-reference="sec:essential-vector">2.14.2</a>). The significance of
this normalization is that the self-convolution of <span
class="math inline">\(\omega_{0,p}\)</span> is bounded in magnitude by
one (see Lemma <a href="#lem:self-conv-omeg" data-reference-type="ref"
data-reference="lem:self-conv-omeg">5.10</a> below).</p>
<p>Let <span class="math inline">\(\omega_0 = \otimes_{\mathfrak{p}}
\omega_{0,\mathfrak{p}} \in C_c^\infty(G(\mathbb{A}))\)</span> denote
the tensor product of the functions defined above.</p>
<p>We have <span class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}}) =
\prod_p C(\pi_p)\)</span>. Set <span class="math inline">\(K_0(\pi) :=
\prod_p K_0(C(\pi_p))_p\)</span>. Then <span id="eq:volk_0pi-=-cpiinfty" class="math display">\[\label{eq:volk_0pi-=-cpiinfty}\tag{5.17}
  \mathop{\mathrm{vol}}(K_0(\pi)) =
C(\pi_{\mathop{\mathrm{fin}}})^{-n+o(1)}.\]</span></p>
<div id="lem:standard:we-have-begin" class="lemma">
<p><strong>Lemma 50</strong>. We have <span id="eq:volk_0pi-int_h-varph" class="math display">\[\label{eq:volk_0pi-int_h-varph}\tag{5.18}
    \mathop{\mathrm{vol}}(K_0(\pi))^{1/2}
    \int_{[H]} \varphi \cdot \Psi_{\ast}
    =
    \int _{[H]} \pi(\omega_0) \varphi \cdot \Psi_{\ast}
    + \operatorname{O}(T^{-\infty}).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Abbreviate <span class="math inline">\(c :=
\mathop{\mathrm{vol}}(K_0(\pi))^{1/2} = \prod_p c_p\)</span>, with <span
class="math inline">\(c_p :=
\mathop{\mathrm{vol}}(K_0(C(\pi_p))_p)^{1/2}\)</span>. By Corollary <a
href="#cor:standard2:we-have-psi" data-reference-type="ref"
data-reference="cor:standard2:we-have-psi">49</a>, we have <span
class="math inline">\(\|\Psi\| \ll 1\)</span>. By Cauchy–Schwarz, our
task reduces verifying that <span class="math display">\[\int _{[H]} | c
\varphi - \pi(\omega_0) \varphi |^2 \ll T^{-\infty}.\]</span></p>
<p>We define as in <a href="#ref-michel-2009" class="citation"
data-cites="michel-2009">(Philippe Michel and Venkatesh 2010, sec.
2.1.7)</a> a height function <span
class="math inline">\(\mathop{\mathrm{ht}}: [G] \rightarrow
\mathbb{R}_{\geqslant 1}\)</span>. It is essentially the norm <span
class="math inline">\(\|.\|_{[\bar{G}]}\)</span>, defined as in §<a
href="#sec:schwartz-spaces" data-reference-type="ref"
data-reference="sec:schwartz-spaces">2.6</a> using the adjoint
representation of <span class="math inline">\(\bar{G}\)</span>. We do
not require the details of that definition here; it suffices to note
that some negative power of <span
class="math inline">\(\mathop{\mathrm{ht}}\)</span> is integrable over
<span class="math inline">\([H]\)</span>, as follows readily from <a href="#ref-michel-2009"
class="citation" data-cites="michel-2009">(Philippe Michel and Venkatesh
2010, sec. 2.1.7)</a> and basic properties of Siegel domains
(Proposition <a href="#prop:siegel-upper" data-reference-type="ref"
data-reference="prop:siegel-upper">34</a>). Using <a href="#ref-michel-2009" class="citation"
data-cites="michel-2009">(Philippe Michel and Venkatesh 2010, secs. 2.4,
(S2a), (S3a))</a>, we see that for each fixed <span
class="math inline">\(d \geqslant 0\)</span>, there is a fixed <span
class="math inline">\(u \in \mathfrak{U}(G(\mathbb{R}))\)</span> and
<span class="math inline">\(d&#39; \geqslant 0\)</span> so that for each
<span class="math inline">\(x \in [G]\)</span> and <span
class="math inline">\(\varphi &#39; \in \pi\)</span>, we have <span
class="math display">\[\varphi &#39;(x) \ll \mathop{\mathrm{ht}}(x)^{-d}
C(\pi_{\mathop{\mathrm{fin}}})^{d&#39;} \|\pi(u) \varphi&#39;
\|\]</span> for all <span class="math inline">\(x \in [G]\)</span>,
where <span class="math inline">\(\|.\|\)</span> denotes the Petersson
norm. (This makes use of the cuspidality of <span
class="math inline">\(\pi\)</span>.) Applying this estimate to <span
class="math inline">\(\varphi &#39; := c \varphi - \pi(\omega_0)
\varphi\)</span> and recalling our assumption <a href="#eq:n_pi-=-to1"
data-reference-type="eqref"
data-reference="eq:n_pi-=-to1">\((5.3)\)</a> concerning <span
class="math inline">\(C(\pi_{\mathop{\mathrm{fin}}})\)</span>, we reduce
to verifying that for each fixed <span class="math inline">\(u \in
\mathfrak{U}(G(\mathbb{R}))\)</span>, we have <span id="eq:c-varphi-piomega_0" class="math display">\[\label{eq:c-varphi-piomega_0}\tag{5.19}
\|\pi(u) (c \varphi - \pi(\omega_0) \varphi) \| \ll
T^{-\infty}.\]</span></p>
<p>By construction, we have <span
class="math inline">\(\pi(\omega_{0,p}) W_p = c_p W_p\)</span> for each
finite prime <span class="math inline">\(p\)</span>. Thus <span
class="math inline">\(c \varphi - \pi(\omega_0) \varphi\)</span> is the
automorphic form attached, as in §<a href="#sec:norms-cusp-forms"
data-reference-type="ref"
data-reference="sec:norms-cusp-forms">2.18</a>, to the archimedean
Whittaker function <span class="math inline">\(W_\infty -
\pi(\omega_{0,\infty}) W_\infty\)</span>. By the results of §<a
href="#sec:norms-cusp-forms" data-reference-type="ref"
data-reference="sec:norms-cusp-forms">2.18</a> (applied as in §<a
href="#sec:constr-autom-forms" data-reference-type="ref"
data-reference="sec:constr-autom-forms">3.2</a>, using our assumption <a
href="#eq:n_pi-=-to1" data-reference-type="eqref"
data-reference="eq:n_pi-=-to1">\((5.3)\)</a>), we reduce further
to verifying that for each fixed <span class="math inline">\(u \in
\mathfrak{U}(G(\mathbb{R}))\)</span>, we have <span
class="math display">\[\|\pi(u) (W_\infty - \pi(\omega_{0,\infty})
W_\infty) \| \ll T^{-\infty},\]</span> where now <span
class="math inline">\(\|.\|\)</span> denotes the norm defined using the
Kirillov model. This last estimate is the content of part <a
href="#itm:sub-gln:1" data-reference-type="eqref"
data-reference="itm:sub-gln:1">\((v)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>. ◻</p>
</div>
<p>We thereby reduce to estimating the integrals <span
class="math display">\[\int_{[H]} \pi(\omega_0) \varphi \cdot
\Psi_{\ast}.\]</span></p>
<h4 id="sec:intr-an-ampl">§5.6. Introduction of an amplifier</h4>
<p>Let <span class="math inline">\(S\)</span> be the finite set of
places of <span class="math inline">\(\mathbb{Q}\)</span> consisting of
the infinite place <span class="math inline">\(\infty\)</span> together
with any finite primes at which <span class="math inline">\(\pi\)</span>
is ramified. Let <span class="math inline">\(\mathcal{H}_G^S\)</span>
denote the restricted product over <span class="math inline">\(p \notin
S\)</span> of the spherical Hecke algebras for <span
class="math inline">\((G(\mathbb{Q}_p), G(\mathbb{Z}_p))\)</span>.</p>
<p>The algebra <span class="math inline">\(\mathcal{H}_G^S\)</span> is
generated by the elements <span class="math inline">\(T_p(a)\)</span>,
defined for primes <span class="math inline">\(p \notin S\)</span> and
<span class="math inline">\((n+1)\)</span>-tuples of integers <span
class="math inline">\(a = (a_1,\dotsc,a_{n+1}) \in
\mathbb{Z}^{n+1}\)</span>, given by the characteristic functions of the
double cosets <span class="math display">\[G(\mathbb{Z}_p)
\mathop{\mathrm{diag}}(p^{a_1}, \dotsc, p^{a_{n+1}}) G(\mathbb{Z}_p)
\subseteq G(\mathbb{Q}_p)\]</span> (see for instance <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
sec. 5.2.1)</a>). For <span class="math inline">\(j \geqslant
0\)</span>, we introduce the shorthand <span
class="math inline">\(T_p[j] := T_p ((j,0,\dotsc,0))\)</span> as well as
its normalized variant <span class="math display">\[t_{p,j} := p^{
\frac{n j}{2} } T_p[j].\]</span></p>
<p>Let <span class="math inline">\(L &gt; 1\)</span> with <span
class="math inline">\(\log L / \log T\)</span> fixed and positive (to be
determined later, in §<a href="#sec:optimization"
data-reference-type="ref" data-reference="sec:optimization">3.11</a>).
Let <span class="math inline">\(\mathbb{P}\)</span> denote the set of
all primes <span class="math inline">\(p \notin S\)</span> that lie in
the interval <span class="math inline">\([L,2 L]\)</span>. By the
divisor bound and the prime number theorem, we then have <span
class="math display">\[T^{-o(1)} L \leqslant|\mathbb{P}| \leqslant
L.\]</span></p>
<p>Let <span class="math inline">\(\lambda_\pi : \mathcal{H}_G^S
\rightarrow \mathbb{C}\)</span> denote the algebra homomorphism
describing the eigenvalues for the action of <span
class="math inline">\(\mathcal{H}_G^S\)</span> on the <span
class="math inline">\(\prod_{p \notin S}
G(\mathbb{Z}_p)\)</span>-invariant subspace of <span
class="math inline">\(\pi\)</span>. By <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, (5.6))</a>
(which relies in turn on <a href="#ref-2014arXiv1405.6691B" class="citation"
data-cites="2014arXiv1405.6691B">(Blomer and Maga 2016, Cor
4.3)</a>), we have <span class="math inline">\(\sum_{j=1}^{n+1}
\lvert \lambda_{\pi}(t_{p,j}) \rvert \gg 1\)</span> for each <span
class="math inline">\(p \notin S\)</span>. By the pigeonhole principle,
we may thus find <span class="math inline">\(j_0 \in \{1, \dotsc,
n+1\}\)</span> so that <span class="math display">\[\sum_{p \in
\mathbb{P}} \lvert \lambda_{\pi}(t_{p,j_0}) \rvert \gg
|\mathbb{P}|.\]</span></p>
<p>Write <span class="math inline">\(\omega_{0,S} := \otimes_{p \in S}
\omega_{0,p}\)</span>. Then <span class="math inline">\(\omega_0 =
\omega_{0,S} \otimes (\otimes_{p \notin S} \omega_{0,p})\)</span>, with
<span class="math inline">\(\omega_{0,p}\)</span> unramified for each
<span class="math inline">\(p \notin S\)</span>. For <span
class="math inline">\(p \in \mathbb{P}\)</span>, set <span
class="math inline">\(x_p :=
\overline{\mathop{\mathrm{sgn}}(\lambda_\pi(t_{p,j_0}))}\)</span>, where
<span class="math inline">\(\mathop{\mathrm{sgn}}(0) := 0\)</span> and
<span class="math inline">\(\mathop{\mathrm{sgn}}(z) := z/|z|\)</span>
for <span class="math inline">\(z \neq 0\)</span>. Then <span
class="math inline">\(|x_p| \leqslant 1\)</span>, and <span
class="math display">\[\pi \left( \omega_{0,S} \otimes \sum _{p \in
\mathbb{P} } x_p t_{p,j_0} \right) \varphi
  =
  \left( \sum _{p \in \mathbb{P} } |\lambda_\pi(t_{p,j_0}) | \right)
\pi(\omega_0) \varphi.\]</span></p>
<p>By combining the above identities and estimates with <a
href="#eq:volk_0pi-=-cpiinfty" data-reference-type="eqref"
data-reference="eq:volk_0pi-=-cpiinfty">\((5.17)\)</a> and
<a href="#eq:volk_0pi-int_h-varph" data-reference-type="eqref"
data-reference="eq:volk_0pi-int_h-varph">\((5.18)\)</a>,
we deduce the following implication: <span id="eq:leftlvert-int-_h" class="math display">\[\begin{align}
  &amp;\mathcal{R} := \left\lvert
    \int _{[H]}
    \pi \left( \omega_{0,S} \otimes \sum _{p \in \mathbb{P} } x_p
t_{p,j_0} \right) \varphi
    \cdot \Psi_{\ast}
  \right\rvert^2
  \ll
  T^{n/2 - 2 \delta } L^2 \label{eq:leftlvert-int-_h}\tag{5.20}
  \\
  &amp;\quad \implies
    \int _{[H]} \varphi \Psi_{\ast} \ll
    C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
    T^{n/4 - \delta + o(1)}. \nonumber
\end{align}\]</span> Our task thereby reduces to suitably estimating
the quantity <span class="math inline">\(\mathcal{R}\)</span>.</p>
<h4 id="sec:pretr-ineq-mult-1">§5.7. Pretrace inequality and multiplication of
Hecke operators</h4>
<p>Following <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P.
D. Nelson 2023, sec. 6.3)</a> line-by-line, we apply the pretrace
inequality given in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Lemma 5.5)</a>
(which explicitly avoids requiring compactness for the quotients <span
class="math inline">\([G]\)</span> and <span
class="math inline">\([H]\)</span>) and multiply the Hecke operators
arising in the geometric expansion. We summarize the estimate obtained
in this way in the lemma stated below.</p>
<div class="notation">
<p><strong>Notation 51</strong>. Let <span
class="math inline">\(Z\)</span> denote the center of <span
class="math inline">\(G\)</span> and <span class="math inline">\(\bar{G}
= G/Z\)</span> the adjoint group. (We will consider <span
class="math inline">\(\bar{G}(R)\)</span> only when <span
class="math inline">\(R\)</span> is either <span
class="math inline">\(\mathbb{Q}\)</span>, <span
class="math inline">\(\mathbb{A}\)</span> or <span
class="math inline">\(\mathbb{Z}_p\)</span>; in each case, <span
class="math inline">\(\bar{G}(R) = G(R) / Z(R)\)</span>.) Let <span
class="math inline">\(\pi|_Z : Z(\mathbb{A}) \rightarrow
\mathop{\mathrm{U}}(1)\)</span> denote the central character of <span
class="math inline">\(\pi\)</span>. For <span
class="math inline">\(\omega \in C_c^\infty(G(\mathbb{A}))\)</span>,
define <span class="math display">\[\omega^\sharp(g) := \int _{z \in
Z(\mathbb{A})} \pi|_Z(z) \omega(z g) \, d z\]</span> and <span
class="math display">\[\mathcal{R}(\omega) := \int _{x, y \in [H]}
\overline{\Psi_{\ast}(x)} \Psi_{\ast}(y)
    \sum _{\gamma \in \bar{G}(\mathbb{Q})} \omega^\sharp(x^{-1} \gamma
y) \, d x \, d y.\]</span></p>
</div>
<div id="notation:convolve-adjoint-local-global-pretrace"
class="notation">
<p><strong>Notation 52</strong>. For elements <span
class="math inline">\(\omega, \omega_1, \omega_2\)</span> of <span
class="math inline">\(C_c^\infty(G(\mathbb{A}))\)</span> or of <span
class="math inline">\(C_c^\infty(G(\mathbb{Q}_\mathfrak{p}))\)</span>,
write <span class="math inline">\(\omega^*(g) :=
\overline{\omega(g^{-1})}\)</span> for the adjoint and <span
class="math inline">\(\omega_1 \ast \omega_2\)</span> for the
convolution.</p>
</div>
<div id="sec:notation-pretr-ineq-mult-3" class="notation">
<p><strong>Notation 53</strong>. For <span class="math inline">\(p_1,
p_2 \in \mathbb{P}\)</span> and <span class="math inline">\(\mathfrak{j}
\in \mathbb{Z}_{\geqslant 0}\)</span>, let <span
class="math inline">\(\omega[p_1, p_2, \mathfrak{j}]\)</span> denote the
factorizable test function <span class="math inline">\(\omega = \otimes
\omega_\mathfrak{p} \in C_c^\infty(G(\mathbb{A}))\)</span> with local
components described as follows.</p>
<ul>
<li><p>For <span class="math inline">\(p \in S\)</span>, take <span
class="math inline">\(\omega_p := \omega_{0,p} \ast
\omega_{0,p}^*\)</span>.</p></li>
<li><p>For <span class="math inline">\(p \notin S \cup  \{p_1,
p_2\}\)</span>, take for <span class="math inline">\(\omega_p\)</span>
the characteristic function of <span
class="math inline">\(G(\mathbb{Z}_p)\)</span>.</p></li>
<li><p>For <span class="math inline">\(p_1 \neq p_2\)</span>, take <span id="eq:omega_p_1-:=-t_p_1" class="math display">\[\label{eq:omega_p_1-:=-t_p_1}\tag{5.21}
    \omega_{p_1} :=  t_{p_1,\mathfrak{j}}
      =
      p_1 ^{- \frac{n \mathfrak{j}}{2}} T _{p _1}
(\mathfrak{j},0,\dotsc,0),\]</span> <span id="eq:omega_p_2-:=-t_p_2" class="math display">\[\label{eq:omega_p_2-:=-t_p_2}\tag{5.22}
      \omega_{p_2} :=  t_{p_2,\mathfrak{j}}^* = p_2 ^{- \frac{n
\mathfrak{j}}{2}} T _{p _2} (0, \dotsc, 0,
-\mathfrak{j}).\]</span></p></li>
<li><p>For <span class="math inline">\(p_1 = p_2\)</span>, take <span id="eq:omeg-=-omeg" class="math display">\[\label{eq:omeg-=-omeg}\tag{5.23}
      \omega_{p_1} = \omega_{p_2} := p_1^{- n \mathfrak{j}}
T_{p_1}(\mathfrak{j},0,\dotsc,0,-\mathfrak{j}).\]</span></p></li>
</ul>
<p>By analogy to the adelic case, we write <span
class="math inline">\(\pi|_{Z_\mathfrak{p}}\)</span> for the central
character of <span class="math inline">\(\pi_\mathfrak{p}\)</span> and
set <span id="eq:omeg-=-int" class="math display">\[\label{eq:omeg-=-int}\tag{5.24}
    \omega_\mathfrak{p}^\sharp(g) = \int _{z \in
Z(\mathbb{Q}_\mathfrak{p})} \pi|_{Z_\mathfrak{p}}(z)
\omega_\mathfrak{p}(z g) \, d z.\]</span></p>
</div>
<div class="lemma">
<p><strong>Lemma 54</strong>. The quantity <span
class="math inline">\(\mathcal{R}\)</span> defined in <a
href="#eq:leftlvert-int-_h" data-reference-type="eqref"
data-reference="eq:leftlvert-int-_h">\((5.20)\)</a> satisfies
the estimate <span id="eq:mathcalr-ll-sum" class="math display">\[\label{eq:mathcalr-ll-sum}\tag{5.25}
  \mathcal{R} \ll \sum _{p_1 \neq p_2 \in \mathbb{P} } \sum
_{\mathfrak{j}=1}^{n+1}
  \left\lvert \mathcal{R}(\omega[p_1, p_2, \mathfrak{j}]) \right\rvert
  + \sum _{p_1 = p_2 \in \mathbb{P} } \sum _{\mathfrak{j}=0}^{n+1}
  \left\lvert \mathcal{R} (\omega[p_1, p_2, \mathfrak{j}])
\right\rvert.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This follows from the arguments of <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
sec. 6.3)</a>, applied verbatim. ◻</p>
</div>
<p>We henceforth focus on individual values of <span
class="math inline">\(\mathfrak{j}, p_1, p_2\)</span> appearing on the
RHS of <a href="#eq:mathcalr-ll-sum" data-reference-type="eqref"
data-reference="eq:mathcalr-ll-sum">\((5.25)\)</a>, abbreviate
<span class="math display">\[\omega :=
\omega[p_1,p_2,\mathfrak{j}],\]</span> and aim to estimate <span
class="math inline">\(\mathcal{R}(\omega)\)</span>. As a first step, we
decompose <span id="eq:mathc-=-mathc" class="math display">\[\label{eq:mathc-=-mathc}\tag{5.26}
\mathcal{R}(\omega) = \mathcal{M} + \mathcal{E},\]</span> where <span
class="math inline">\(\mathcal{M}\)</span> denotes the contribution from
<span class="math inline">\(\gamma\)</span> lying in <span
class="math inline">\(H(\mathbb{Q}) \hookrightarrow
\bar{G}(\mathbb{Q})\)</span> and <span
class="math inline">\(\mathcal{E}\)</span> denotes the remaining
contribution.</p>
<p>We will estimate <span class="math inline">\(\mathcal{M}\)</span> in
§<a href="#sec:main-term-estimates" data-reference-type="ref"
data-reference="sec:main-term-estimates">3.8</a> and <span
class="math inline">\(\mathcal{E}\)</span> in §<a
href="#sec:error-term-estimates" data-reference-type="ref"
data-reference="sec:error-term-estimates">3.10</a>. We then combine the
estimates so obtained in §<a href="#sec:optimization"
data-reference-type="ref"
data-reference="sec:optimization">3.11</a>.</p>
<p>We conclude this subsection with some basic estimates for the factors
<span class="math inline">\(\omega_\mathfrak{p} ^\sharp\)</span>, to be
applied below.</p>
<div id="lem:let-p-notin" class="lemma">
<p><strong>Lemma 55</strong>. Let <span class="math inline">\(p \notin S
\cup \{p_1, p_2\}\)</span>. Then <span class="math inline">\(\omega_p
^\sharp\)</span> is the characteristic function of <span
class="math inline">\(\bar{G}(\mathbb{Z}_p)\)</span>; in particular,
<span id="eq:omega_p-sharp-_infty" class="math display">\[\label{eq:omega_p-sharp-_infty}\tag{5.27}
    \|\omega_p ^\sharp \|_{\infty} = 1, \quad \int _{H(\mathbb{Q}_p)}
|\omega_p ^\sharp| = 1.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Clear by construction. Indeed, <span
class="math inline">\(\bar{G}(\mathbb{Z}_p)\)</span> is the image of
<span class="math inline">\(G(\mathbb{Z}_p)\)</span>, and for each <span
class="math inline">\(g \in G(\mathbb{Q}_p)\)</span>, the set <span
class="math inline">\(\{z \in Z(\mathbb{Q}_p) : z g \in J\}\)</span> is
either empty or a coset of <span
class="math inline">\(Z(\mathbb{Z}_p)\)</span>. Each such coset has
volume one, and the set in question is nonempty precisely when <span
class="math inline">\(g \in \bar{G}(\mathbb{Z}_p)\)</span>. The first
identity in <a href="#eq:omega_p-sharp-_infty"
data-reference-type="eqref"
data-reference="eq:omega_p-sharp-_infty">\((5.27)\)</a>
is then clear. Since <span class="math inline">\(\bar{G}(\mathbb{Z}_p)
\cap H(\mathbb{Q}_p) = H(\mathbb{Z}_p)\)</span> and the Haar measure on
<span class="math inline">\(H(\mathbb{Q}_p)\)</span> assigns volume one
to <span class="math inline">\(H(\mathbb{Z}_p)\)</span>, the second
identity in <a href="#eq:omega_p-sharp-_infty"
data-reference-type="eqref"
data-reference="eq:omega_p-sharp-_infty">\((5.27)\)</a>
follows. ◻</p>
</div>
<div id="item:self-conv-omeg-3" class="lemma">
<p><strong>Lemma 56</strong>. <span id="lem:self-conv-omeg"
label="lem:self-conv-omeg"></span> Let <span class="math inline">\(p \in
S - \{\infty \}\)</span>.</p>
<ol type="i">
<li><p><span id="item:self-conv-omeg-2"
label="item:self-conv-omeg-2"></span> The support of <span
class="math inline">\(\omega_p ^\sharp\)</span> is contained in <span
class="math inline">\(\bar{G}(\mathbb{Z}_p)\)</span>.</p></li>
<li><p><span id="item:self-conv-omeg-1"
label="item:self-conv-omeg-1"></span> We have <span
class="math inline">\(\|\omega_{p} ^\sharp\|_{\infty} \leqslant
1\)</span>.</p></li>
<li><p>We have <span class="math inline">\(\int _{H(\mathbb{Q}_p)}
|\omega_p ^\sharp| \leqslant 1\)</span>.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> We recall from §<a href="#sec:intr-an-appr"
data-reference-type="ref" data-reference="sec:intr-an-appr">3.5</a> the
definition of <span class="math inline">\(\omega_{0,p}\)</span>. Set
<span class="math inline">\(J := K_0(C(\pi_p))_p \leqslant K_p \leqslant
G(\mathbb{Q}_p)\)</span>. Let <span class="math inline">\(\chi : J
\rightarrow \mathop{\mathrm{U}}(1)\)</span> denote the character of
<span class="math inline">\(J\)</span> given by <span
class="math inline">\(g \mapsto \pi_p|_{Z}(d(g))^{-1}\)</span>. Let
<span class="math inline">\(e \in C_c^\infty(G(\mathbb{Q}_p))\)</span>
denote the function supported on <span class="math inline">\(J\)</span>
and given there by <span
class="math inline">\(\mathop{\mathrm{vol}}(J)^{-1} \chi\)</span>. Then
<span class="math inline">\(e^* = e\)</span> and <span
class="math inline">\(e \ast e = e\)</span>. Since <span
class="math inline">\(\omega_{0,p} = \mathop{\mathrm{vol}}(J)^{1/2}
e\)</span>, it follows that <span class="math inline">\(\omega_{0,p}
\ast \omega_{0,p}^* = \mathop{\mathrm{vol}}(J) e\)</span> is the
function <span class="math inline">\(1_J \chi\)</span> supported on
<span class="math inline">\(J\)</span> and given there by <span
class="math inline">\(\chi\)</span>. Since <span class="math inline">\(J
\leqslant G(\mathbb{Z}_p)\)</span>, we deduce that <span
class="math inline">\(|\omega_{0,p} \ast \omega_{0,p}^*|\)</span> is
bounded by the characteristic function of <span
class="math inline">\(G(\mathbb{Z}_p)\)</span>. We may thus bound <span
class="math inline">\(|\omega_p ^\sharp|\)</span> exactly as in Lemma <a
href="#lem:let-p-notin" data-reference-type="ref"
data-reference="lem:let-p-notin">55</a>. ◻</p>
</div>
<div id="lem:we-have-begin" class="lemma">
<p><strong>Lemma 57</strong>. We have <span
class="math display">\[\prod_{p \in \{p_1, p_2\}}
    \|\omega_p ^\sharp \|_{\infty} \ll L^{-n \mathfrak{j}}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> The basis elements <span
class="math inline">\(T_p(a)\)</span> for the Hecke algebra have the
property that for each <span class="math inline">\(g \in
G(\mathbb{Q}_p)\)</span>, the set of all <span class="math inline">\(z
\in Z(\mathbb{Q}_p)\)</span> for which <span class="math inline">\(z
g\)</span> lies in the support of <span
class="math inline">\(T_p(a)\)</span> is either empty or a coset of
<span class="math inline">\(Z(\mathbb{Z}_\mathfrak{p})\)</span>. Thus
for <span class="math inline">\(p \in \{p_1, p_2\}\)</span>, we have
<span class="math inline">\(\|\omega_p ^\sharp \|_{\infty }
\leqslant\|\omega_p\|_{\infty}\)</span>. Since also <span
class="math inline">\(\|T_p(a)\|_{\infty} = 1\)</span>, we deduce from
the definitions <a href="#eq:omega_p_1-:=-t_p_1"
data-reference-type="eqref"
data-reference="eq:omega_p_1-:=-t_p_1">\((5.21)\)</a>, <a
href="#eq:omega_p_2-:=-t_p_2" data-reference-type="eqref"
data-reference="eq:omega_p_2-:=-t_p_2">\((5.22)\)</a> and
<a href="#eq:omeg-=-omeg" data-reference-type="eqref"
data-reference="eq:omeg-=-omeg">\((5.23)\)</a> that</p>
<ul>
<li><p>if <span class="math inline">\(p_1 \neq p_2\)</span>, then <span
class="math inline">\(\|\omega_{p_1} ^\sharp \|_{\infty} = p_1^{-
\frac{n \mathfrak{j}}{2}}\)</span> and <span
class="math inline">\(\|\omega_{p_2} ^\sharp \|_{\infty} = p_2^{-
\frac{n \mathfrak{j}}{2}}\)</span>, while</p></li>
<li><p>if <span class="math inline">\(p_1 = p_2 =: p\)</span>, then
<span class="math inline">\(\|\omega_{p} ^\sharp \|_{\infty} = p^{- n
\mathfrak{j}}\)</span>.</p></li>
</ul>
<p>In either case, the required bound follows from the fact that <span
class="math inline">\(p \asymp L\)</span>. ◻</p>
</div>
<h4 id="sec:main-term-estimates">§5.8. Main term estimates</h4>
<div id="lem:sub-gln:main-term-estimates" class="lemma">
<p><strong>Lemma 58</strong>. We have <span
class="math display">\[\mathcal{M} \ll T^{n/2 + o(1)}
L^{-\mathfrak{j}}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> The main term <span
class="math inline">\(\mathcal{M}\)</span> defined in the previous
section unfolds, as follows: <span
class="math display">\[\begin{align}
  \mathcal{M}
  &amp;:= \int _{x, y \in [H]} \overline{\Psi_{\ast}(x)} \Psi_{\ast}(y)
    \sum _{\gamma \in H(\mathbb{Q})} \omega^\sharp(x^{-1} \gamma y) \, d
x \, d y \\
  &amp;= \int _{x \in [H]} \int _{y \in
H(\mathbb{A})}\overline{\Psi_{\ast}(x)}
\Psi_{\ast}(y)  \omega^\sharp(x^{-1} y) \, d x \, d y \\
  &amp;= \int _{h \in H(\mathbb{A})}  \omega^\sharp(h) \langle R(h)
\Psi_{\ast}, \Psi_{\ast} \rangle \, d h.
\end{align}\]</span> Recall that <span class="math inline">\(\omega =
\otimes_{\mathfrak{p}} \omega_\mathfrak{p}\)</span>. Write <span
class="math inline">\(t_p\)</span> for the restriction of <span
class="math inline">\(\omega_p^\sharp\)</span> to <span
class="math inline">\(H(\mathbb{Q}_p)\)</span>, weighted by the Haar
measure on <span class="math inline">\(H(\mathbb{Q}_p)\)</span> (which,
by convention, assigns volume one to <span
class="math inline">\(H(\mathbb{Z}_p)\)</span>). Then <span
class="math inline">\(t := \otimes_p t_p\)</span> defines a nonnegative
element of the spherical Hecke, algebra <span
class="math inline">\(\mathcal{H}_H\)</span> (see §<a
href="#sec:matr-coeff-our" data-reference-type="ref"
data-reference="sec:matr-coeff-our">3.4</a>), and, writing <span
class="math inline">\(\mathbb{Q}_S := \prod_{\mathfrak{p} \in S}
\mathbb{Q}_\mathfrak{p}\)</span>, we have <span
class="math display">\[\mathcal{M} = \int _{h \in H(\mathbb{Q}_S) }
\omega_\infty^\sharp(h) \langle R(h) t \Psi_{\ast}, \Psi_{\ast} \rangle
\, d h.\]</span> We recall that, by construction, <span
class="math inline">\(\Psi_{\ast}\)</span> is invariant under <span
class="math inline">\(\prod_p H(\mathbb{Z}_p)\)</span>. By Lemmas <a
href="#lem:sub-gln:each-y-in" data-reference-type="ref"
data-reference="lem:sub-gln:each-y-in">48</a> and <a
href="#lem:let-p-notin" data-reference-type="ref"
data-reference="lem:let-p-notin">55</a>, it follows that <span
class="math display">\[\mathcal{M} \ll \lambda_0(t) T^{o(1)}
\int_{H(\mathbb{R})} |\omega_\infty^\sharp|
  \prod_{p \in S - \{\infty\}}
  \int _{H(\mathbb{Q}_p)} |\omega_p ^\sharp|.\]</span></p>
<p>By construction (i.e., Theorem <a href="#thm:main-local-results"
data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>),
we have <span class="math inline">\(\int_{H(\mathbb{R})}
|\omega_\infty^\sharp| \ll T^{n/2+o(1)}\)</span>.</p>
<p>By Lemma <a href="#lem:self-conv-omeg" data-reference-type="ref"
data-reference="lem:self-conv-omeg">5.10</a>, we have
<span class="math display">\[\prod_{p \in S} \int_{H(\mathbb{Q}_p)}
|\omega_p ^\sharp| \leqslant 1.\]</span></p>
<p>To bound <span class="math inline">\(\lambda_0(t)\)</span>, we factor
it as <span class="math inline">\(\prod_p \lambda_0(t_p)\)</span> and
bound each factor individually. Recall that <span
class="math inline">\(\omega_p = \omega_p[p_1, p_2,
\mathfrak{j}]\)</span> and that <span class="math inline">\(p_1, p_2 \in
[L,2 L]\)</span>. The discussion of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 6.4)</a>,
specialized to <span class="math inline">\(\vartheta = 0\)</span>,
applies verbatim, giving <span class="math display">\[\begin{align}
  p \notin \{p_1, p_2 \} &amp;\implies \lambda_0(t_p) = 1, \\
  p_1 \neq p_2 &amp;\implies \lambda_0(t_{p_1}), \lambda_0(t_{p_2}) \ll
L^{-\mathfrak{j}/2}, \\
  p_1 = p_2 &amp;\implies \lambda_0(t_{p_1}) \ll L^{-\mathfrak{j}}.
\end{align}\]</span> The claimed bound follows in either case. ◻</p>
</div>
<h4 id="sec:matrix-counting">§5.9. Matrix counting</h4>
<p>We pause to record some estimates to be applied in the following
subsection. We note that the quantitative details of this subsection are
relevant only for explicating the precise numerical savings <span
class="math inline">\(\delta_n^\sharp\)</span> obtained in our results.
The reader who is primarily interested in understanding the proof of a
qualitative subconvex bound is thus encouraged to skim this
subsection.</p>
<p>Recall that <span class="math inline">\((G,H) =
({\mathop{\mathrm{GL}}}_{n+1},{\mathop{\mathrm{GL}}}_n)\)</span> over <span
class="math inline">\(\mathbb{Z}\)</span>, with <span
class="math inline">\(n \geqslant 1\)</span> fixed. For <span
class="math inline">\(t \in A_H(\mathbb{R})^0\)</span>, we set <span
class="math display">\[t ^\dagger  := \prod_{i=1}^n \max(t_i,
t_i^{-1}).\]</span> Recall that <span class="math inline">\(T \ggg
1\)</span> and <span class="math inline">\(\bar{G} = G/Z\)</span>.</p>
<div id="itm:scratch-research:Sigma-count-5" class="definition">
<p><strong>Definition 59</strong>. <span id="defn:standard2:let-ell-ell"
label="defn:standard2:let-ell-ell"></span> Let <span
class="math inline">\(\ell\)</span> and <span class="math inline">\(\ell
&#39;\)</span> be natural numbers with <span class="math inline">\(\ell
\asymp \ell &#39;\)</span> and <span class="math inline">\(\log \ell /
\log T \asymp 1\)</span>. In particular, <span
class="math inline">\(\ell, \ell &#39; \ggg 1\)</span>. Let <span
class="math inline">\(t, u \in A_H(\mathbb{R})^0_{\geqslant 1}\)</span>.
We regard these as included in <span
class="math inline">\(G(\mathbb{R})\)</span>, with <span
class="math inline">\(t_{n+1}, u_{n+1} := 1\)</span>; we also write
simply <span class="math inline">\(t\)</span> and <span
class="math inline">\(u\)</span> for their images in <span
class="math inline">\(\bar{G}(\mathbb{R})\)</span> when doing so
introduces no confusion. Let <span class="math inline">\(0 &lt; X
\leqslant 1\)</span>. Let <span
class="math inline">\(\mathcal{D}\)</span> be a subset of <span
class="math inline">\(\bar{G}(\mathbb{R})\)</span>. Let <span
class="math display">\[\Sigma(t, u, \ell, \ell&#39;, X,
\mathcal{D})\]</span> denote the set of all <span
class="math inline">\(\gamma \in \bar{G}(\mathbb{Q})\)</span> with the
following properties:</p>
<ol type="i">
<li><p><span id="itm:scratch-research:Sigma-count-1"
label="itm:scratch-research:Sigma-count-1"></span> There is a lift <span
class="math inline">\(\tilde{\gamma} \in G(\mathbb{Q})\)</span> of <span
class="math inline">\(\gamma\)</span> with integral entries and
determinant <span class="math inline">\(\pm \ell\)</span>.</p></li>
<li><p><span id="itm:scratch-research:Sigma-count-2"
label="itm:scratch-research:Sigma-count-2"></span> There is a lift <span
class="math inline">\(\tilde{\gamma}^{-1} \in G(\mathbb{Q})\)</span> of
<span class="math inline">\(\gamma^{-1}\)</span> with integral entries
and determinant <span class="math inline">\(\pm \ell
&#39;\)</span>.</p></li>
<li><p><span id="itm:scratch-research:Sigma-count-3"
label="itm:scratch-research:Sigma-count-3"></span> We have <span
class="math inline">\(t^{-1} \gamma u \in \mathcal{D}\)</span>.</p></li>
<li><p><span id="itm:scratch-research:Sigma-count-4"
label="itm:scratch-research:Sigma-count-4"></span> We have <span
class="math inline">\(d_H(t^{-1} \gamma u) \leqslant
X\)</span>.</p></li>
<li><p>We have <span class="math inline">\(\gamma \notin
H(\mathbb{Q})\)</span>, regarding the latter as a subgroup of <span
class="math inline">\(\bar{G}(\mathbb{Q})\)</span>.</p></li>
</ol>
</div>
<p>For the following lemmas, we retain the setting of Definition <a
href="#defn:standard2:let-ell-ell" data-reference-type="ref"
data-reference="defn:standard2:let-ell-ell">5.13</a>,
we fix a compact symmetric (i.e., inversion-invariant) neighborhood
<span class="math inline">\(E \subseteq \bar{G}(\mathbb{R})\)</span> of
the identity element, we fix a compact symmetric subset <span
class="math inline">\(\Omega \subseteq H(\mathbb{R})\)</span>, and we
abbreviate <span class="math display">\[\Sigma := \Sigma(t,u,\ell,
\ell&#39;, X, \Omega E \Omega).\]</span></p>
<div id="lem:standard2:crude-a-priori-counting" class="lemma">
<p><strong>Lemma 60</strong> (Crude <em>a priori</em> bound). We have
<span class="math display">\[|\Sigma| \ll
    \left( \ell t ^\dagger u ^\dagger \max(|\det(t^{-1} u)|,
|\det(u^{-1} t)|) \right)^{n+1}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We consider the case <span
class="math inline">\(|\det(t^{-1} u)| \geqslant 1\)</span>; the other
case can be treated by applying the same argument to the inverses of all
involved matrices and recalling that <span class="math inline">\(\ell
&#39; \asymp \ell\)</span>.</p>
<p>Set <span class="math inline">\(D := |\det(t)^{-1} \ell
\det(u)|\)</span>. By hypothesis, <span id="eq:d-geq-ell" class="math display">\[\label{eq:d-geq-ell}\tag{5.28}
    D \geqslant\ell \geqslant 1.\]</span> Our task is to verify that
<span class="math display">\[|\Sigma| \ll (D t ^\dagger u
^\dagger)^{n+1}.\]</span></p>
<p>Let <span class="math inline">\(\gamma \in \Sigma\)</span>. Choose a
lift <span class="math inline">\(\tilde{\gamma}\)</span> as in condition
<a href="#itm:scratch-research:Sigma-count-1"
data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-1">\((i)\)</a>.
The rescaled matrix <span class="math display">\[\gamma^{(1)} := D ^{-
\frac{1}{n+1}} \tilde{\gamma }\]</span> then satisfies <span
class="math display">\[\det(t^{-1} \gamma^{(1)} u) = \pm 1.\]</span> The
image of <span class="math inline">\(t^{-1} \gamma^{(1)} u\)</span> in
<span class="math inline">\(\bar{G}(\mathbb{R})\)</span> is <span
class="math inline">\(t^{-1} \gamma u\)</span>, which, by condition <a
href="#itm:scratch-research:Sigma-count-3" data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-3">\((iii)\)</a>,
lies in a fixed compact subset of <span
class="math inline">\(\bar{G}(\mathbb{R})\)</span>. Thus <span
class="math inline">\(t^{-1} \gamma^{(1)} u\)</span> lies in a fixed
compact subset of <span class="math inline">\(G(\mathbb{R})\)</span>.
Let <span class="math inline">\(a_{i j}\)</span> (<span
class="math inline">\(1 \leqslant i, j \leqslant n+1\)</span>) denote
the matrix entries of <span class="math inline">\(\gamma^{(1)}\)</span>.
We have <span class="math inline">\(a_{i j} \in D^{- \frac{1}{n+1}}
\mathbb{Z}\)</span> and <span id="eq:r_i-1-s_j" class="math display">\[\label{eq:r_i-1-s_j}\tag{5.29}
    t_i^{-1} u_j a_{i j} \ll 1
    \quad
    (1 \leqslant i, j \leqslant n+1),\]</span> where, as noted above,
<span class="math inline">\(t_{n+1}, u_{n+1} := 1\)</span>.</p>
<p>For each <span class="math inline">\(\gamma\)</span>, there are
exactly two choices for <span
class="math inline">\(\tilde{\gamma}\)</span>, differing by <span
class="math inline">\(\pm 1\)</span>. For this reason, it suffices to
bound the number of possibilities for <span
class="math inline">\(\gamma^{(1)}\)</span>, or equivalently, for the
coefficients <span class="math inline">\(a_{i j}\)</span>. Thus <span id="eq:sigma-ll-prod_i" class="math display">\[\label{eq:sigma-ll-prod_i}\tag{5.30}
    |\Sigma| \ll
    \prod_{i,j= 1}^{n+1} \left( 1 + D ^{\frac{1}{ n + 1}} t_i u_j^{-1}
\right).\]</span> We conclude by estimating crudely via the inequality
<span class="math display">\[1 + D ^{\frac{1}{ n + 1}} t_i u_j^{-1}
    \leqslant
    D ^{\frac{1}{ n + 1}} ( 1 + t_i ) ( 1 + u_j^{-1} ),\]</span> which
follows from <a href="#eq:d-geq-ell" data-reference-type="eqref"
data-reference="eq:d-geq-ell">\((5.28)\)</a>, and the inequalities
<span class="math display">\[\prod_{i=1}^{n+1} (1 + t_i) \leqslant
2^{n+1} t ^\dagger ,
    \quad
    \prod_{j=1}^{n+1} (1 + u_j^{-1}) \leqslant 2^{n+1} u
^\dagger.\]</span> ◻</p>
</div>
<div id="lem:scratch-research:if-sigma-nonempty" class="lemma">
<p><strong>Lemma 61</strong>. Assume that <span id="eq:dett-1-u" class="math display">\[\label{eq:dett-1-u}\tag{5.31}
    \det(t^{-1} u) = T^{o(1)}.\]</span> If <span
class="math inline">\(\Sigma\)</span> is nonempty, then <span id="eq:d--frac2n+1-0" class="math display">\[\label{eq:d--frac2n+1-0}\tag{5.32}
    \ell^{-\frac{2}{n+1} - o(1)} \ll t_i / u_i \ll
\ell^{\frac{2}{n+1}+o(1)},\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> The proof will show more precisely that if there
exists <span class="math inline">\(\gamma \in
\bar{G}(\mathbb{Q})\)</span> satisfying conditions <a
href="#itm:scratch-research:Sigma-count-1" data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-1">\((i)\)</a>
and <a href="#itm:scratch-research:Sigma-count-2"
data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-2">\((ii)\)</a>,
then the indicated estimate holds.</p>
<p>We define <span class="math inline">\(D\)</span>, <span
class="math inline">\(\tilde{\gamma}\)</span>, <span
class="math inline">\(\gamma^{(1)}\)</span> and <span
class="math inline">\(a_{i j}\)</span> as in the proof of Lemma <a
href="#lem:standard2:crude-a-priori-counting" data-reference-type="ref"
data-reference="lem:standard2:crude-a-priori-counting">60</a>.</p>
<p>By <a href="#eq:dett-1-u" data-reference-type="eqref"
data-reference="eq:dett-1-u">\((5.31)\)</a>, we have <span id="eq:d-=-ell1" class="math display">\[\label{eq:d-=-ell1}\tag{5.33}
    D = \ell^{1 + o(1)}.\]</span> In particular, <span
class="math inline">\(D \geqslant 1\)</span>.</p>
<p>Write <span class="math inline">\(r_1 \geqslant\dotsb \geqslant
r_{n+1}\)</span> (resp. <span class="math inline">\(s_1 \geqslant\dotsb
\geqslant s_{n+1}\)</span>) for the numbers <span
class="math inline">\(t_1,\dotsc,t_n,1\)</span> (resp. <span
class="math inline">\(u_1,\dotsc,u_n,1\)</span>) arranged in
non-increasing order. Since <span
class="math inline">\(\gamma^{(1)}\)</span> has nonzero determinant, we
may find a permutation <span class="math inline">\(\sigma\)</span> of
<span class="math inline">\(\{1, \dotsc, n+1\}\)</span> so that <span
class="math inline">\(a_{i,\sigma(i)}\)</span> is nonzero for each <span
class="math inline">\(i \in \{1, \dotsc, n+1\}\)</span>. Since <span
class="math inline">\(a_{i j} \in D^{- \frac{1}{n+1}}
\mathbb{Z}\)</span>, it follows then from <a href="#eq:r_i-1-s_j"
data-reference-type="eqref"
data-reference="eq:r_i-1-s_j">\((5.29)\)</a> that <span id="eq:r_i-1-s_sigmai" class="math display">\[\label{eq:r_i-1-s_sigmai}\tag{5.34}
    r_i^{-1} s_{\sigma(i)} \ll D ^{\frac{1}{n+1}}.\]</span> Since <span
class="math inline">\(r\)</span> and <span
class="math inline">\(s\)</span> are non-increasing, the same estimate
holds with <span class="math inline">\(\sigma(i) = i\)</span>, i.e.,
<span id="eq:r_i-1-s_i" class="math display">\[\label{eq:r_i-1-s_i}\tag{5.35}
    r_i^{-1} s_i \ll D ^{\frac{1}{n+1}}.\]</span></p>
<p>Similarly, setting <span class="math inline">\(D&#39; :=
|\det(u)^{-1} \ell &#39; \det(t)| \asymp \ell^{1+o(1)}\)</span> and
arguing as above with a lift <span
class="math inline">\(\tilde{\gamma}^{-1}\)</span> of <span
class="math inline">\(\gamma^{-1}\)</span> as in condition <a
href="#itm:scratch-research:Sigma-count-2" data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-2">\((ii)\)</a>,
we obtain <span class="math inline">\(s_i^{-1} r_i \ll (D&#39;)
^{\frac{1}{n+1}}\)</span>. Combining the estimates derived thus far, we
deduce that <span id="eq:ell--frac1n+1" class="math display">\[\label{eq:ell--frac1n+1}\tag{5.36}
    \ell ^{- \frac{1}{n+1} + o(1)} \ll s_i^{-1} r_i \ll \ell
^{\frac{1}{n+1} + o(1)}.\]</span></p>
<p>We pass from <a href="#eq:ell--frac1n+1" data-reference-type="eqref"
data-reference="eq:ell--frac1n+1">\((5.36)\)</a> to <a
href="#eq:d--frac2n+1-0" data-reference-type="eqref"
data-reference="eq:d--frac2n+1-0">\((5.32)\)</a> by a simple
combinatorial argument, which we record for completeness. For <span
class="math inline">\(i \in \{1,\dotsc,n+1\}\)</span>, define <span
class="math inline">\(a_i,b_i \in \mathbb{R}\)</span> by writing <span
class="math display">\[t_i = \ell^{a_i}, \quad u_i =
\ell^{b_i}.\]</span> For example, <span class="math inline">\(a_{n+1} =
b_{n+1} = 0\)</span>. The desired conclusion <a href="#eq:d--frac2n+1-0"
data-reference-type="eqref"
data-reference="eq:d--frac2n+1-0">\((5.32)\)</a> is that for
each fixed <span class="math inline">\(c &gt; \frac{1}{n+1}\)</span> and
all <span class="math inline">\(i = \{1, \dotsc, n\}\)</span>, we have
<span class="math inline">\(|a_i - b_i| \leqslant 2 c\)</span>. On the
other hand, our hypothesis <a href="#eq:ell--frac1n+1"
data-reference-type="eqref"
data-reference="eq:ell--frac1n+1">\((5.36)\)</a> implies there
is a permutation <span class="math inline">\(\sigma\)</span> of <span
class="math inline">\(\{1,\dotsc,n+1\}\)</span> so that <span
class="math inline">\(|a_i - b_{\sigma(i)}| \leqslant c\)</span> for all
<span class="math inline">\(i \in \{1, \dotsc, n+1\}\)</span>. The
passage from our hypothesis to the desired conclusion is the content of
Lemma <a href="#lem:scratch-research:let-n-geq"
data-reference-type="ref"
data-reference="lem:scratch-research:let-n-geq">66</a>, stated at the
end of this subsection. ◻</p>
</div>
<div id="lem:standard2:we-have-begin" class="lemma">
<p><strong>Lemma 62</strong>. Assume that <a href="#eq:dett-1-u"
data-reference-type="eqref"
data-reference="eq:dett-1-u">\((5.31)\)</a> holds. Then <span id="eq:sigma_r-sx-ll-0" class="math display">\[\label{eq:sigma_r-sx-ll-0}\tag{5.37}
    |\Sigma| \ll X \ell^{3 (n+1) + o(1)}
    \min(\delta_H(t) t ^\dagger , \delta_H(u) u ^\dagger).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We may assume that <span
class="math inline">\(\Sigma\)</span> is nonempty, so that <a
href="#eq:d--frac2n+1-0" data-reference-type="eqref"
data-reference="eq:d--frac2n+1-0">\((5.32)\)</a> holds. By the
symmetry of the problem with respect to <span
class="math inline">\(t\)</span> and <span
class="math inline">\(u\)</span>, it will suffice to show that <span id="eq:sigma_r-sx-ll-0-b" class="math display">\[\label{eq:sigma_r-sx-ll-0-b}\tag{5.38}
    |\Sigma| \ll X \ell^{3 (n+1) + o(1)}
    \delta_H(t) t ^\dagger.\]</span></p>
<p>Let <span class="math inline">\(\gamma \in \Sigma\)</span>. We define
<span class="math inline">\(D\)</span>, <span
class="math inline">\(\tilde{\gamma}\)</span>, <span
class="math inline">\(\gamma^{(1)}\)</span> and <span
class="math inline">\(a_{i j}\)</span> as in the proof of Lemma <a
href="#lem:standard2:crude-a-priori-counting" data-reference-type="ref"
data-reference="lem:standard2:crude-a-priori-counting">60</a>, and
reduce again to counting the possibilities for the <span
class="math inline">\(a_{i j}\)</span>.</p>
<p>We consider first the case <span class="math inline">\(X =
1\)</span>, in which the condition <a
href="#itm:scratch-research:Sigma-count-4" data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-4">\((iv)\)</a>
on <span class="math inline">\(d_H\)</span> in the definition of <span
class="math inline">\(\Sigma\)</span> is tautological. We appeal in this
case to the estimate <a href="#eq:sigma-ll-prod_i"
data-reference-type="eqref"
data-reference="eq:sigma-ll-prod_i">\((5.30)\)</a> for <span
class="math inline">\(|\Sigma|\)</span>, established under weaker
hypotheses than the present ones. Recall from <a href="#eq:d-=-ell1"
data-reference-type="eqref"
data-reference="eq:d-=-ell1">\((5.33)\)</a> that <span
class="math inline">\(D = \ell^{1 + o(1)}\)</span>. By <a
href="#eq:d--frac2n+1-0" data-reference-type="eqref"
data-reference="eq:d--frac2n+1-0">\((5.32)\)</a>, we have <span
class="math inline">\(t_i u_j^{-1} \ll \ell ^{\frac{2}{n+1} + o(1)} t_i
t_j^{-1}\)</span>. Thus, estimating a bit crudely with respect to <span
class="math inline">\(\ell\)</span>, we obtain <span
class="math display">\[1 + D ^{\frac{1}{n + 1}} t_i u_j^{-1}
    \ll
    1 +
    \ell ^{\frac{3}{n+1} + o(1)} t_i t_j^{-1}
    \leqslant
    \ell ^{\frac{3}{n+1} + o(1)}(1 +
    t_i t_j^{-1}),\]</span> and so <span class="math display">\[|\Sigma|
\ll \ell ^{3 (n+1) + o(1)} \prod_{i,j=1}^{n+1} (1 + t_i
t_j^{-1}).\]</span> By estimating the contribution to this last product
from indices grouped according to whether they are equal to <span
class="math inline">\(n+1\)</span> or not, we see that it is <span
class="math inline">\(\ll \delta_H(t) t ^\dagger\)</span>. Indeed:</p>
<ul>
<li><p>Since <span class="math inline">\(t_{n+1} = 1\)</span>, the
contribution from when <span class="math inline">\(i=n+1\)</span> or
<span class="math inline">\(j=n+1\)</span> is <span
class="math inline">\(2 \prod_{j=1}^{n} (1 + t_j^{-1}) (1 + t_j) \asymp
t ^\dagger\)</span>.</p></li>
<li><p>For <span class="math inline">\(i,j \leqslant n\)</span> with
<span class="math inline">\(i \geqslant j\)</span>, we have <span
class="math inline">\(1 + t_i t_j^{-1} \leqslant 2\)</span> in view of
the <span class="math inline">\(N\)</span>-dominance of <span
class="math inline">\(t\)</span>.</p></li>
<li><p>For <span class="math inline">\(i,j \leqslant n\)</span> with
<span class="math inline">\(i &lt; j\)</span>, we have <span
class="math inline">\(t_i t_j^{-1} \geqslant 1\)</span>, hence <span
class="math inline">\(1 + t_i t_j^{-1} \asymp t_i t_j^{-1}\)</span>; we
conclude by noting that <span class="math inline">\(\prod_{i &lt; j
\leqslant n} t_i t_j^{-1} = \delta_H(t)\)</span>.</p></li>
</ul>
<p>Thus <span id="eq:sigma-ll-ell3" class="math display">\[\label{eq:sigma-ll-ell3}\tag{5.39}
    |\Sigma| \ll \ell^{3 (n+1) + o(1)}
    \delta_H(t) t ^\dagger,\]</span> giving the required estimate <a
href="#eq:sigma_r-sx-ll-0-b" data-reference-type="eqref"
data-reference="eq:sigma_r-sx-ll-0-b">\((5.38)\)</a>.</p>
<p>It remains to address the case <span class="math inline">\(X &lt;
1\)</span>. By the definition of <span class="math inline">\(d_H(t^{-1}
\gamma u)\)</span>, the lower-right entries of <span
class="math inline">\(t^{-1} \gamma u\)</span> and its inverse are
nonzero. In particular, <span class="math inline">\(a_{n+1,n+1} \neq
0\)</span>, and <span id="eq:d_hr-1-gamma" class="math display">\[\label{eq:d_hr-1-gamma}\tag{5.40}
      X \geqslant d_H(t^{-1} \gamma u) \asymp
      \max_{1 \leqslant i \leqslant n}
      t_i^{-1} \frac{|a_{i,n+1}|}{ | a_{n+1, n+1}|}
      +
      \max_{1 \leqslant j \leqslant n}
      u_j \frac{|a_{n+1, j}|}{ | a_{n+1, n+1}|}
      + \dotsb,\]</span> where <span
class="math inline">\(\dotsb\)</span> denotes the contribution of the
analogous quantities defined in terms of the inverse matrix <span
class="math inline">\(u^{-1} \gamma^{-1} t\)</span>. By <a
href="#eq:r_i-1-s_j" data-reference-type="eqref"
data-reference="eq:r_i-1-s_j">\((5.29)\)</a>, we have <span
class="math inline">\(a_{n+1,n+1} \ll 1\)</span>, and similarly for the
corresponding entry of the inverse. Condition <a
href="#itm:scratch-research:Sigma-count-4" data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-4">\((iv)\)</a>
thus gives <span id="eq:a_j-n+1-ll" class="math display">\[\label{eq:a_j-n+1-ll}\tag{5.41}
    a_{j,n+1} \ll X t_j, \quad
    a_{n+1,j} \ll X u_j^{-1}.\]</span> Since</p>
<ul>
<li><p>each of the entries <span
class="math inline">\(a_{j,n+1}\)</span> or <span
class="math inline">\(a_{n+1,j}\)</span> with <span
class="math inline">\(j \in \{1,\dotsc,n\}\)</span> lies in <span
class="math inline">\(D ^{\frac{-1}{n+1}} \mathbb{Z}\)</span>,
and</p></li>
<li><p>not all such entries vanish (thanks to condition <a
href="#itm:scratch-research:Sigma-count-5" data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-5">\((v)\)</a>),</p></li>
</ul>
<p>we deduce from <a href="#eq:a_j-n+1-ll" data-reference-type="eqref"
data-reference="eq:a_j-n+1-ll">\((5.41)\)</a> that <span id="eq:x-max_1-leq" class="math display">\[\label{eq:x-max_1-leq}\tag{5.42}
    X \ell^{\frac{1}{n+1}} \max_{1 \leqslant j \leqslant n} \max(t_j,
u_j^{-1}) \gg \ell ^{ - o(1)}.\]</span> We now count as in the case
<span class="math inline">\(X = 1\)</span>. In that case, the number of
possibilities for <span class="math inline">\(a_{j,n+1}\)</span> and
<span class="math inline">\(a_{n+1,j}\)</span> (<span
class="math inline">\(1 \leqslant j \leqslant n\)</span>) was majorized,
up to a factor of <span class="math inline">\(\ell^{o(1)}\)</span>, by
<span class="math display">\[C_1 := \prod_{1 \leqslant j \leqslant n }
(1 + \ell^{\frac{1}{n+1}} t_j)  (1 + \ell^{\frac{1}{n+1}}
u_j^{-1}).\]</span> In the present case <span class="math inline">\(X
&lt; 1\)</span>, we obtain instead the modified count <span id="eq:c_x-:=-prod_1" class="math display">\[\label{eq:c_x-:=-prod_1}\tag{5.43}
    C_X := \prod_{1 \leqslant j \leqslant n } (1 + X
\ell^{\frac{1}{n+1}} t_j)  (1 + X \ell^{\frac{1}{n+1}}
u_j^{-1}).\]</span></p>
<p>Using <a href="#eq:x-max_1-leq" data-reference-type="eqref"
data-reference="eq:x-max_1-leq">\((5.42)\)</a>, we see that <span id="eq:c_x-ll-x" class="math display">\[\label{eq:c_x-ll-x}\tag{5.44}
    C_X \ll X  C_1.\]</span> Indeed, let <span
class="math inline">\(j_0\)</span> be an index at which the maximum in
<a href="#eq:x-max_1-leq" data-reference-type="eqref"
data-reference="eq:x-max_1-leq">\((5.42)\)</a> is attained. For
the factor in <a href="#eq:c_x-:=-prod_1" data-reference-type="eqref"
data-reference="eq:c_x-:=-prod_1">\((5.43)\)</a> indexed by
<span class="math inline">\(j = j_0\)</span>, we have by <a
href="#eq:x-max_1-leq" data-reference-type="eqref"
data-reference="eq:x-max_1-leq">\((5.42)\)</a> that <span
class="math display">\[\frac{
      (1 + X \ell^{\frac{1}{n+1}} t_j)  (1 + X \ell^{\frac{1}{n+1}}
u_j^{-1})
    }{
      (1 + \ell^{\frac{1}{n+1}} t_j)  (1 + \ell^{\frac{1}{n+1}}
u_j^{-1})
    }
    \ll X,\]</span> while for the remaining indices <span
class="math inline">\(j \neq j_0\)</span>, we estimate the corresponding
factor in <a href="#eq:c_x-:=-prod_1" data-reference-type="eqref"
data-reference="eq:c_x-:=-prod_1">\((5.43)\)</a> trivially using
that <span class="math inline">\(X &lt; 1\)</span>.</p>
<p>Counting the remaining entries (<span class="math inline">\(a_{i
j}\)</span> with <span class="math inline">\(1 \leqslant i, j \leqslant
n\)</span> and <span class="math inline">\(a_{n+1,n+1}\)</span>) as in
the case <span class="math inline">\(X = 1\)</span> yields a bound for
<span class="math inline">\(|\Sigma|\)</span> that saves an additional
factor of <span class="math inline">\(X\)</span> over the bound <a
href="#eq:sigma-ll-ell3" data-reference-type="eqref"
data-reference="eq:sigma-ll-ell3">\((5.39)\)</a> obtained in the
case <span class="math inline">\(X = 1\)</span>. We thereby obtain the
required bound <a href="#eq:sigma_r-sx-ll-0-b"
data-reference-type="eqref"
data-reference="eq:sigma_r-sx-ll-0-b">\((5.38)\)</a>. ◻</p>
</div>
<p>We conclude §<a href="#sec:matrix-counting" data-reference-type="ref"
data-reference="sec:matrix-counting">3.9</a> by recording the
combinatorial argument required to complete the proof of Lemma <a
href="#lem:scratch-research:if-sigma-nonempty" data-reference-type="ref"
data-reference="lem:scratch-research:if-sigma-nonempty">61</a>. The
following discussion will not otherwise be applied in this paper.</p>
<div class="definition">
<p><strong>Definition 63</strong>. Given <span class="math inline">\(n
\in \mathbb{Z}_{\geqslant 0}\)</span> and <span
class="math inline">\(n\)</span>-tuples <span class="math inline">\(a =
(a_1,\dotsc,a_n) \in \mathbb{R}^n\)</span> and <span
class="math inline">\(b = (b_1,\dotsc,b_n)\in \mathbb{R}^n\)</span>, we
define <span class="math display">\[d(a,b) := \min_{\sigma \in S(n)}
  \max_{1 \leqslant i \leqslant n}
  |a_i - b_{\sigma(i)}|.\]</span></p>
</div>
<div id="lem:manhattan-greedy" class="lemma">
<p><strong>Lemma 64</strong>. If <span class="math inline">\(a,b \in
\mathbb{R}^n\)</span> are non-decreasing, then <span
class="math display">\[d(a,b) = \max_{1 \leqslant i \leqslant n} |a_i -
b_i|.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> By a simple greedy argument, reducing ultimately to
the case <span class="math inline">\(n = 2\)</span>. ◻</p>
</div>
<div class="definition">
<p><strong>Definition 65</strong>. For <span class="math inline">\(a \in
\mathbb{R}^{n+1}\)</span> with <span class="math inline">\(n \in
\mathbb{Z}_{\geqslant 0}\)</span>, and <span class="math inline">\(k \in
\{1,\dotsc, n+1\}\)</span>, define <span class="math display">\[a^{(k)}
:= (a_1,\dotsc,a_{k-1},a_{k+1},\dotsc,a_{n}) \in
\mathbb{R}^{n}.\]</span></p>
</div>
<div id="lem:scratch-research:let-n-geq" class="lemma">
<p><strong>Lemma 66</strong>. Let <span class="math inline">\(n \in
\mathbb{Z}_{\geqslant 0}\)</span>, <span class="math inline">\(a,b \in
\mathbb{R}^{n+1}\)</span>, <span class="math inline">\(k,\ell \in
\{1,\dotsc,n+1\}\)</span>, <span class="math inline">\(c \geqslant
0\)</span>. Suppose that <span class="math display">\[d (a,b) \leqslant
c, \quad
    a_k = b_{\ell}.\]</span> Then <span class="math display">\[d
(a^{(k)}, b^{(\ell)}) \leqslant 2 c.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We may assume that <span
class="math inline">\(a\)</span> and <span
class="math inline">\(b\)</span> are non-decreasing, so that by Lemma <a
href="#lem:manhattan-greedy" data-reference-type="ref"
data-reference="lem:manhattan-greedy">64</a>, we have <span id="eq:a_i-b_i-leq" class="math display">\[\label{eq:a_i-b_i-leq}\tag{5.45}
    |a_i - b_i| \leqslant c\]</span> for all <span
class="math inline">\(i \in \{1,\dotsc,n+1\}\)</span>. It is enough to
show then that <span id="eq:ak_i-aell_i-leq" class="math display">\[\label{eq:ak_i-aell_i-leq}\tag{5.46}
    |a^{(k)}_i - a^{(\ell)}_i| \leqslant 2 c\]</span> for all <span
class="math inline">\(i \in \{1,\dotsc,n\}\)</span>. Without loss of
generality, suppose <span class="math inline">\(k
\leqslant\ell\)</span>. For <span class="math inline">\(i &lt;
k\)</span> (resp. <span class="math inline">\(i \geqslant\ell\)</span>),
we have <span class="math inline">\(a^{(k)}_i = a_i\)</span> and <span
class="math inline">\(b^{(\ell)}_i = b_i\)</span> (resp. <span
class="math inline">\(a^{(k)}_i = a_{i+1}\)</span> and <span
class="math inline">\(b^{(\ell)}_i = b_{i+1}\)</span>), so <a
href="#eq:ak_i-aell_i-leq" data-reference-type="eqref"
data-reference="eq:ak_i-aell_i-leq">\((5.46)\)</a> follows
from <a href="#eq:a_i-b_i-leq" data-reference-type="eqref"
data-reference="eq:a_i-b_i-leq">\((5.45)\)</a>. It remains to
treat the range <span class="math inline">\(k \leqslant i &lt;
\ell\)</span>, in which <span class="math inline">\(a_i^{(k)} =
a_{i+1}\)</span> and <span class="math inline">\(b_i^{(\ell)} =
b_i\)</span>. By assumption, we have <span class="math display">\[a_k -
c \leqslant b_k \leqslant\dotsb \leqslant b_{\ell} = a_k \leqslant\dotsb
\leqslant a_{\ell} \leqslant b_{\ell} + c = a_k + c.\]</span> Therefore
all of the elements <span class="math inline">\(a_k,\dotsc,a_{\ell},
b_k,\dotsc,b_{\ell}\)</span> lie in the interval <span
class="math inline">\([a_k-c, a_k+c]\)</span> of length <span
class="math inline">\(2 c\)</span>, and so <span
class="math display">\[|a_i^{(k)} - b_i^{(\ell)}| = |a_{i+1} - b_i|
\leqslant 2 c,\]</span> as required. ◻</p>
</div>
<h4 id="sec:error-term-estimates">§5.10. Error term estimates</h4>
<p>By definition, <span id="eq:mathcale-:=E--int" class="math display">\[\label{eq:mathcale-:=E--int}\tag{5.47}
  \mathcal{E}
  := \int _{x, y \in [H]} \overline{\Psi_{\ast}(x)} \Psi_{\ast}(y)
  \sum _{\gamma \in \bar{G}(\mathbb{Q}) - H(\mathbb{Q})}
\omega^\sharp(x^{-1} \gamma y) \, d x \, d y.\]</span> We recall the
notation:</p>
<ul>
<li><p><span class="math inline">\(\Psi_{\ast}\)</span> is shorthand for
<span class="math inline">\(\Psi_{\ast}[Y]\)</span>, the pseudo
Eisenstein series attached in §<a href="#sec:constr-autom-forms"
data-reference-type="ref"
data-reference="sec:constr-autom-forms">3.2</a> to some <span
class="math inline">\(Y \in A_H(\mathbb{R})^0\)</span> satisfying <span
class="math inline">\(T^{-\kappa} \leqslant Y_j \leqslant
T^{\kappa}\)</span> for some fixed <span class="math inline">\(\kappa
\in (0,1/2)\)</span>.</p></li>
<li><p><span class="math inline">\(\omega^\sharp \in
C_c^\infty(\bar{G}(\mathbb{A}))\)</span>, <span
class="math inline">\(\bar{G} = G/Z\)</span>, is the integral over <span
class="math inline">\(Z(\mathbb{A})\)</span>, weighted by the central
character of <span class="math inline">\(\pi\)</span>, of the test
function <span class="math inline">\(\omega \in
C_c(G(\mathbb{A}))\)</span> attached to some triple <span
class="math inline">\((p_1,p_2,\mathfrak{j})\)</span> (see §<a
href="#sec:pretr-ineq-mult-1" data-reference-type="ref"
data-reference="sec:pretr-ineq-mult-1">3.7</a>), which is in turn an
“amplified” self-convolution of the test function <span
class="math inline">\(\omega_{0,\infty}\)</span> produced by Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>.</p></li>
</ul>
<p>The main result of §<a href="#sec:error-term-estimates"
data-reference-type="ref"
data-reference="sec:error-term-estimates">3.10</a> is as follows.</p>
<div id="prop:standard2:with-notat-assumpt" class="proposition">
<p><strong>Proposition 67</strong>. <em>With notation and assumptions as
above, <span class="math display">\[\mathcal{E} \ll
    T^{n/2 - 1/2 + n \kappa + o(1)}
    L^{(3 (n+1)^2 + 1 + n) \mathfrak{j}}.\]</span></em></p>
</div>
<p>The proof will be broken up into several steps, and occupies the
remainder of §<a href="#sec:error-term-estimates"
data-reference-type="ref"
data-reference="sec:error-term-estimates">3.10</a>. The crucial
ingredients are</p>
<ul>
<li><p>the “bilinear forms” or “transversality” estimate supplied by
part <a href="#itm:sub-gln:3" data-reference-type="eqref"
data-reference="itm:sub-gln:3">\((vii)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>,</p></li>
<li><p>the “growth bounds for Eisenstein series” estimate supplied by
Theorem <a href="#thm:growth-eisenstein-nonstandard"
data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>, and</p></li>
<li><p>the simple estimates for matrix counts given above.</p></li>
</ul>
<h5 id="siegel-domains-triangle-inequality">Siegel domains, triangle
inequality</h5>
<p>We begin by bounding the integrand in absolute value and applying the
Siegel domain majorization afforded by Proposition <a
href="#prop:siegel-upper" data-reference-type="ref"
data-reference="prop:siegel-upper">34</a> to both variables. Recall that
<span class="math inline">\(A_H(\mathbb{R})^0_{\geqslant 1}\)</span>
denotes the set of <span class="math inline">\(N\)</span>-dominant
elements of the connected component of the diagonal subgroup <span
class="math inline">\(A_H(\mathbb{R})\)</span>. Each factor in the
integrand of the integral <a href="#eq:mathcale-:=E--int"
data-reference-type="eqref"
data-reference="eq:mathcale-:=E--int">\((5.47)\)</a>
defining <span class="math inline">\(\mathcal{E}\)</span> is <span
class="math inline">\(\prod_{p} H(\mathbb{Z}_p)\)</span>-invariant in
both variables. We deduce that there is a fixed compact subset <span
class="math inline">\(\Omega\)</span> of <span
class="math inline">\(H(\mathbb{R})\)</span> so that <span id="eq:mathcale-ll-int" class="math display">\[\label{eq:mathcale-ll-int}\tag{5.48}
  \mathcal{E} \ll \int _{t, u \in A_H(\mathbb{R})^0_{\geqslant 1} }
\sum_{\gamma \in \bar{G}(\mathbb{Q}) - H(\mathbb{Q})} I_{t, u}(\gamma)  
  \, \frac{d t \, d u}{\delta_H(t) \delta_H(u)},\]</span> where <span
class="math display">\[I_{t,u}(\gamma) :=
  \int _{x \in t \Omega}
  \int _{y \in u \Omega}
  \left\lvert \Psi_{\ast}(x) \Psi_{\ast}(y)
    \omega^\sharp (x ^{-1} \gamma y)
  \right\rvert
  \,d x \,d y,\]</span> where <span class="math inline">\(d x\)</span>
and <span class="math inline">\(d y\)</span> denote our chosen Haar
measure on <span class="math inline">\(H(\mathbb{R})\)</span>.</p>
<p>In what follows, and unless otherwise stated, <span
class="math inline">\(t\)</span> and <span
class="math inline">\(u\)</span> denote elements of <span
class="math inline">\(A_H(\mathbb{R})^0_{\geqslant 1}\)</span>.</p>
<h5 id="factorization">Factorization</h5>
<p>By part <a href="#itm:sub-gln:5" data-reference-type="eqref"
data-reference="itm:sub-gln:5">\((i)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a> and
the <span class="math inline">\(H(\mathbb{R})\)</span>-equivariance of
the association <span class="math inline">\(f \mapsto \Psi\)</span>, we
may write <span id="eq:psiy-=-psi_0" class="math display">\[\label{eq:psiy-=-psi_0}\tag{5.49}
\Psi_{\ast}(y) = (\Psi \ast \phi_{Z_H})(y) := \int _{z \in
Z_H(\mathbb{R})} \Psi(y z ^{-1}) \phi_{Z_H}(z) \, d z,\]</span>
where</p>
<ul>
<li><p><span class="math inline">\(\phi_{Z_H} \in
C_c^\infty(Z_H(\mathbb{R}))\)</span> is fixed,</p></li>
<li><p><span class="math inline">\(\Psi : [H] \rightarrow
\mathbb{C}\)</span>, attached as in §<a href="#sec:compl-eisenst-seri"
data-reference-type="ref"
data-reference="sec:compl-eisenst-seri">2.16</a> to the element <span
class="math inline">\(f \in \mathcal{S}^e(U_H(\mathbb{R}) \backslash
H(\mathbb{R}))^{W_H}\)</span> furnished by Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a> via
the recipe <span class="math display">\[\Psi :=
\mathop{\mathrm{Eis}}[L(Y) \Phi[f]] = \mathop{\mathrm{Eis}}[\Phi[L(Y)
f]] \in \mathcal{S}([H]),\]</span> has the same essential properties as
<span class="math inline">\(\Psi_{\ast}\)</span> (indeed, all except the
explicit factorization property <a href="#eq:psiy-=-psi_0"
data-reference-type="eqref"
data-reference="eq:psiy-=-psi_0">\((5.49)\)</a>); in particular,
it is smooth and of rapid decay.</p></li>
</ul>
<h5 id="application-of-transversality">Application of
transversality</h5>
<p>Here we apply the “bilinear forms” estimate afforded by part <a
href="#itm:sub-gln:3" data-reference-type="eqref"
data-reference="itm:sub-gln:3">\((vii)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>,
whose proof relies in turn on the volume estimates established in <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
secs. 15–16)</a>.</p>
<p>Recall that part <a href="#itm:sub-gln:3" data-reference-type="eqref"
data-reference="itm:sub-gln:3">\((vii)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>
asserts “for each fixed compact <span class="math inline">\(\Omega_{H}
\subseteq H(\mathbb{R})\)</span>, there exists a compact <span
class="math inline">\(\Omega_{H}&#39; \subseteq H(\mathbb{R})\)</span>
so that <span class="math inline">\(\dotsb\)</span>.” Let <span
class="math inline">\(\Omega &#39; \subseteq H(\mathbb{R})\)</span>
denote the set obtained as “<span
class="math inline">\(\Omega_{H}&#39;\)</span>” by taking for “<span
class="math inline">\(\Omega_H\)</span>” our given set <span
class="math inline">\(\Omega\)</span>. By enlarging <span
class="math inline">\(\Omega &#39;\)</span> if needed, we may and shall
assume that <span class="math inline">\(\Omega &#39;\)</span> is
symmetric (i.e., invariant by inversion). For <span
class="math inline">\(t \in A_H(\mathbb{R})^0_{\geqslant 1}\)</span>, we
define the seminorms <span class="math inline">\(\|.\|_t\)</span> on
<span class="math inline">\(L^2(H(\mathbb{Z}) \backslash
H(\mathbb{R}))\)</span> as in <a href="#eq:varphi-2_r-:="
data-reference-type="eqref"
data-reference="eq:varphi-2_r-:=">\((4.1)\)</a>, but using
<span class="math inline">\(\Omega &#39;\)</span>, i.e., <span
class="math display">\[\|\phi\|^2_t := \int _{t \Omega&#39; } |\phi|^2
  =
  \int _{h \in \Omega&#39; \subseteq H(\mathbb{R})}
  |\phi(t h)|^2
  \, d h,\]</span> where the integral is taken with respect to the Haar
measure on <span class="math inline">\(H(\mathbb{R})\)</span>.</p>
<div id="lem:sub-gln:each-gamma-in" class="lemma">
<p><strong>Lemma 68</strong>. For each <span
class="math inline">\(\gamma \in \bar{G}(\mathbb{Q}) -
H(\mathbb{Q})\)</span>, we have <span class="math display">\[I_{t,
u}(\gamma) \ll T^{n/2 + o(1)} L^{-n \mathfrak{j}}
    \min \left( 1, \frac{T^{-1/2}}{d_H(t^{-1} \gamma u)} \right)
    \|\Psi \|_t \|\Psi \|_{u}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> For <span class="math inline">\(x \in t
\Omega\)</span> and <span class="math inline">\(y \in u \Omega\)</span>,
we have <span class="math display">\[\omega^\sharp (x ^{-1} \gamma y)
    =
    \omega_\infty^\sharp (x ^{-1} \gamma y)
    \prod_p \omega_p ^\sharp (\gamma).\]</span> By Lemmas <a
href="#lem:let-p-notin" data-reference-type="ref"
data-reference="lem:let-p-notin">55</a>, <a href="#lem:self-conv-omeg"
data-reference-type="ref"
data-reference="lem:self-conv-omeg">5.10</a> and <a
href="#lem:we-have-begin" data-reference-type="ref"
data-reference="lem:we-have-begin">57</a>, we have <span
class="math display">\[\prod_p \omega_p ^\sharp (\gamma) \ll L^{-n
\mathfrak{j}}.\]</span> Thus <span class="math display">\[I_{t,
u}(\gamma) \ll L^{-n \mathfrak{j}} \int _{x \in t \Omega } \int _{y \in
u \Omega } \left\lvert \Psi(x) \Psi(y)
      \omega_{\infty}^{\sharp}(x ^{-1} \gamma y) \right\rvert \,d x \,d
y.\]</span> Setting <span class="math inline">\(\Psi_1(x) := \Psi(t
x)\)</span> and <span class="math inline">\(\Psi_2(y) := \Psi(u
y)\)</span>, we may rewrite this last double integral as <span
class="math display">\[\int _{x ,y \in \Omega } \left\lvert (\Psi_1 \ast
\phi_{Z_H})(x) (\Psi_2 \ast \phi_{Z_H})(y) \omega_\infty^\sharp(x^{-1}
t^{-1} \gamma u y) \right\rvert \,d x \,d y\]</span> and then estimate
it, using part <a href="#itm:sub-gln:3" data-reference-type="eqref"
data-reference="itm:sub-gln:3">\((vii)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>, as
<span class="math display">\[\ll
    T^{n/2 + o(1)}
    \min \left( 1, \frac{T^{-1/2}}{d_H(t^{-1} \gamma u)} \right)
    \|\Psi_1\|_{L^2(\Omega&#39;)}
    \|\Psi_2\|_{L^2(\Omega&#39;)}.\]</span> By construction of the norms
<span class="math inline">\(\|.\|_t, \|.\|_{u}\)</span>, we have <span
class="math display">\[\|\Psi_1\|_{L^2(\Omega &#39;)} = \|\Psi\|_t,
\quad
    \|\Psi_2\|_{L^2(\Omega &#39;)} = \|\Psi\|_{u}.\]</span> The required
bound follows. ◻</p>
</div>
<p>For <span class="math inline">\(t, u \in A_H(\mathbb{R})^0_{\geqslant
1}\)</span>, set <span class="math display">\[\Sigma_{t,u} :=
  \left\{ \gamma \in \bar{G}(\mathbb{Q}) - H(\mathbb{Q}) :
\text{$\omega^\sharp(x^{-1} \gamma y) \neq 0$ for some $(x,y) \in t
\Omega \times u \Omega $} \right\}.\]</span> For <span
class="math inline">\(0 &lt; X \leqslant 1\)</span>, let <span
class="math inline">\(\Sigma_{t,u}^X \subseteq \Sigma_{t,u}\)</span>
denote the subset defined by the further condition <span
class="math inline">\(d_H(t^{-1} \gamma u) \leqslant X\)</span>. For
example, <span class="math inline">\(\Sigma_{t,u}^1 =
\Sigma_{t,u}\)</span>. Define <span id="eq:i-:=-int" class="math display">\[\label{eq:i-:=-int}\tag{5.50}
  I := \int _{t, u \in A_H(\mathbb{R})^0_{\geqslant 1}} \|\Psi\|_t
\|\Psi\|_u
  \sum _{\gamma \in \Sigma_{t,u}}
  \min \left( T^{1/2}, \frac{1}{d_H(t^{-1} \gamma u)} \right) \, \frac{d
t \, d u}{\delta_H(t) \delta_H(u)}.\]</span> From <a
href="#eq:mathcale-ll-int" data-reference-type="eqref"
data-reference="eq:mathcale-ll-int">\((5.48)\)</a> and Lemma
<a href="#lem:sub-gln:each-gamma-in" data-reference-type="ref"
data-reference="lem:sub-gln:each-gamma-in">68</a>, we see that <span
class="math display">\[\mathcal{E} \ll T ^{n/2 - 1/2 + o(1)} L^{- n
\mathfrak{j}} I.\]</span> The proof of Proposition <a
href="#prop:standard2:with-notat-assumpt" data-reference-type="ref"
data-reference="prop:standard2:with-notat-assumpt">67</a> thereby
reduces to that of the estimate <span id="eq:i-ll-tnkappa" class="math display">\[\label{eq:i-ll-tnkappa}\tag{5.51}
  I \ll
  T^{n \kappa + o(1)}
  L^{(3 (n+1)^2  + 2 n) \mathfrak{j}}.\]</span></p>
<h5 id="application-of-matrix-counting">Application of matrix
counting</h5>
<p>The sets <span class="math inline">\(\Sigma_{t,u}^X\)</span> are
contained in those considered in §<a href="#sec:matrix-counting"
data-reference-type="ref" data-reference="sec:matrix-counting">3.9</a>.
More precisely, let <span class="math inline">\(E \subseteq
\bar{G}(\mathbb{R})\)</span> denote the image of the set <span
class="math inline">\(\{x y^{-1} : x,y \in E_{G(\mathbb{R})}\}\)</span>,
where <span class="math inline">\(E_{G(\mathbb{R})} \subseteq
G(\mathbb{R})\)</span> is any fixed symmetric compact subset that
contains the support of <span
class="math inline">\(\omega_0\)</span>.</p>
<div class="lemma">
<p><strong>Lemma 69</strong>. There are natural numbers <span
class="math inline">\(\ell, \ell&#39; \in \mathbb{Z}_{\geqslant
1}\)</span> with <span id="eq:ell-asymp-ell" class="math display">\[\label{eq:ell-asymp-ell}\tag{5.52}
    \ell \asymp \ell &#39; \asymp L^{(n+1) \mathfrak{j}}\]</span> so
that <span id="eq:sigma_t-ux-subseteq" class="math display">\[\label{eq:sigma_t-ux-subseteq}\tag{5.53}
    \Sigma_{t,u}^X \subseteq \Sigma(t,u,\ell, \ell&#39;, X, \Omega E
\Omega).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We will see that the required conclusion holds with
<span class="math display">\[\ell := \prod_p \ell_p, \quad
    \ell_p := \begin{cases}
      1 &amp; \text{ if } p \notin \{p_1, p_2\}, \\
      p^{\mathfrak{j}} &amp; \text{ if } p = p_1 \neq p _2, \\
      p ^{n \mathfrak{j} } &amp;  \text{ if } p = p_2 \neq p_1, \\
      p ^{(n + 1) \mathfrak{j} } &amp;  \text{ if } p = p_1 = p_2,
    \end{cases}\]</span> <span class="math display">\[\ell &#39; :=
\prod_p \ell &#39;_p, \quad
    \ell&#39;_p := \begin{cases}
      1 &amp; \text{ if } p \notin \{p_1, p_2\}, \\
      p^{n\mathfrak{j}} &amp; \text{ if } p = p_1 \neq p _2, \\
      p ^{\mathfrak{j} } &amp;  \text{ if } p = p_2 \neq p_1, \\
      p ^{(n + 1) \mathfrak{j} } &amp;  \text{ if } p = p_1 = p_2.
    \end{cases}\]</span> Since <span class="math inline">\(p_1, p_2
\asymp L\)</span>, the estimate <a href="#eq:ell-asymp-ell"
data-reference-type="eqref"
data-reference="eq:ell-asymp-ell">\((5.52)\)</a> holds with this
choice. It remains to verify the containment <a
href="#eq:sigma_t-ux-subseteq" data-reference-type="eqref"
data-reference="eq:sigma_t-ux-subseteq">\((5.53)\)</a>.</p>
<p>Let <span class="math inline">\(\gamma \in \Sigma_{t,u}^X\)</span>.
The conditions <a href="#itm:scratch-research:Sigma-count-4"
data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-4">\((iv)\)</a>
and <a href="#itm:scratch-research:Sigma-count-5"
data-reference-type="eqref"
data-reference="itm:scratch-research:Sigma-count-5">\((v)\)</a>
in the definition of <span class="math inline">\(\Sigma(t,u,\ell,
\ell&#39;, X, \Omega E \Omega)\)</span> follow immediately from the
definition of <span class="math inline">\(\Sigma_{t,u}^X\)</span>, so
our task is to verify the remaining conditions, namely, that <span id="eq:t-1-gamma" class="math display">\[\label{eq:t-1-gamma}\tag{5.54}
    t^{-1} \gamma u \in \Omega  E \Omega\]</span> and that <span
class="math inline">\(\gamma\)</span> (resp. <span
class="math inline">\(\gamma^{-1}\)</span>) admits a lift to <span
class="math inline">\(G(\mathbb{Q})\)</span> with integral entries and
determinant <span class="math inline">\(\pm \ell\)</span> (resp. <span
class="math inline">\(\pm \ell &#39;\)</span>).</p>
<p>By the definition of <span
class="math inline">\(\Sigma_{t,u}^X\)</span>, we may find <span
class="math inline">\((x,y) \in t \Omega \times u \Omega\)</span> with
<span class="math inline">\(\omega^\sharp(x^{-1} \gamma y) \neq
0\)</span>, i.e., <span id="eq:omega_infty-sharp-x" class="math display">\[\label{eq:omega_infty-sharp-x}\tag{5.55}
    \omega_\infty ^\sharp (x^{-1} \gamma y) \neq 0\]</span> and <span id="eq:omega_p-sharp-gamma" class="math display">\[\label{eq:omega_p-sharp-gamma}\tag{5.56}
    \omega_p ^\sharp (\gamma ) \neq 0\]</span> for all primes <span
class="math inline">\(p\)</span>. The support of <span
class="math inline">\(\omega_\mathfrak{p} ^\sharp\)</span> is contained
in the image of the support of <span
class="math inline">\(\omega_\mathfrak{p}\)</span>, which we now discuss
case-by-case (recalling from §<a href="#sec:pretr-ineq-mult-1"
data-reference-type="ref" data-reference="sec:pretr-ineq-mult-1">3.7</a>
the construction of <span class="math inline">\(\omega\)</span>).</p>
<p>Since <span class="math inline">\(\omega_{0,\infty}\)</span> is
supported in <span class="math inline">\(E_{G(\mathbb{R})}\)</span> and
<span class="math inline">\(\omega_{\infty} = \omega_{0,\infty} \ast
\omega_{0,\infty}^*\)</span>, we deduce that <span
class="math inline">\(\omega _\infty ^\sharp\)</span> is supported in
the set <span class="math inline">\(E\)</span> defined above. From <a
href="#eq:omega_infty-sharp-x" data-reference-type="eqref"
data-reference="eq:omega_infty-sharp-x">\((5.55)\)</a> and
the symmetry of <span class="math inline">\(\Omega\)</span>, the
required membership <a href="#eq:t-1-gamma" data-reference-type="eqref"
data-reference="eq:t-1-gamma">\((5.54)\)</a> follows.</p>
<p>We observe that <span
class="math inline">\(\mathop{\mathrm{supp}}(\omega_{p}^\sharp)\)</span>
is contained in the image <span class="math inline">\(\Xi_p \subseteq
\bar{G}(\mathbb{Q}_p)\)</span> of the set <span
class="math display">\[\tilde{\Xi}_p := \left\{ g \in
M_{n+1}(\mathbb{Z}_p) : \det(g) \in \ell_p
\mathbb{Z}_p^\times  \right\}.\]</span> Indeed:</p>
<ul>
<li><p>If <span class="math inline">\(p \notin \{p_1, p_2\}\)</span>,
then <span
class="math inline">\(\mathop{\mathrm{supp}}(\omega_{\mathfrak{p}}) =
\bar{G}(\mathbb{Z}_p)\)</span>.</p></li>
<li><p>If <span class="math inline">\(p_1 \neq p_2\)</span> and <span
class="math inline">\(p = p_1\)</span>, then <span
class="math inline">\(\mathop{\mathrm{supp}}(\omega_{p_1}^\sharp)\)</span>
is the image of the support of <span class="math inline">\(\omega_{p_1}
= T_{p_1}(\mathfrak{j},0,\dotsc,0)\)</span>.</p></li>
<li><p>If <span class="math inline">\(p_1 \neq p_2\)</span> and <span
class="math inline">\(p = p_2\)</span>, then <span
class="math inline">\(\mathop{\mathrm{supp}}(\omega_{p_2}^\sharp)\)</span>
is the image of the support of <span class="math inline">\(\omega_{p_2}
= T_{p_2}(0,\dotsc,0,-\mathfrak{j})\)</span>, or equivalently, that of
the central shift <span
class="math inline">\(T_{p_2}(\mathfrak{j},\dotsc,\mathfrak{j},0)\)</span>.</p></li>
<li><p>If <span class="math inline">\(p_1 = p_2 = p\)</span>, then <span
class="math inline">\(\mathop{\mathrm{supp}}(\omega_p^\sharp)\)</span>
is the image of the support of <span class="math inline">\(\omega_p =
T_p(\mathfrak{j},0,\dotsc,0,-\mathfrak{j})\)</span>, or equivalently,
that of the central shift <span class="math inline">\(T_p(2
\mathfrak{j}, \mathfrak{j}, \dotsc, \mathfrak{j}, 0)\)</span>.</p></li>
</ul>
<p>To conclude, we need only note that for <span class="math inline">\(a
\in \mathbb{Z}_{\geqslant 0}^{n+1}\)</span>, the Hecke operator <span
class="math inline">\(T_p(a)\)</span> (see §<a href="#sec:intr-an-ampl"
data-reference-type="ref" data-reference="sec:intr-an-ampl">3.6</a>),
regarded as measure on <span class="math inline">\(G(\mathbb{Q}_p) =
{\mathop{\mathrm{GL}}}_{n+1}(\mathbb{Q}_p)\)</span>, is supported on <span
class="math display">\[\{g \in M_{n+1}(\mathbb{Z}_p) : \det(g) \in
\det(a) \mathbb{Z}_p^\times \}.\]</span></p>
<p>From <a href="#eq:omega_p-sharp-gamma" data-reference-type="eqref"
data-reference="eq:omega_p-sharp-gamma">\((5.56)\)</a>, we
deduce that <span class="math inline">\(\gamma \in \Xi_p\)</span> for
all <span class="math inline">\(p\)</span>. Since <span
class="math inline">\(\mathbb{Q}\)</span> has class number one, we may
find a lift <span class="math inline">\(\tilde{\gamma} \in
G(\mathbb{Q})\)</span> of <span class="math inline">\(\gamma\)</span>
that lies in <span class="math inline">\(\tilde{\Xi}_p\)</span> for all
<span class="math inline">\(p\)</span>. This lift has integral entries
and determinant <span class="math inline">\(\pm \ell\)</span>.</p>
<p>By applying the above argument to the inverses of all involved
matrices, we see that <span class="math inline">\(\gamma^{-1}\)</span>
admits a lift <span class="math inline">\(\tilde{\gamma}^{-1} \in
G(\mathbb{Q})\)</span> with integral entries and determinant <span
class="math inline">\(\pm \ell &#39;\)</span>.</p>
<p>The proof is now complete. ◻</p>
</div>
<p>By construction, the sets <span class="math inline">\(E\)</span> and
<span class="math inline">\(\Omega\)</span> satisfy the assumptions
required by §<a href="#sec:matrix-counting" data-reference-type="ref"
data-reference="sec:matrix-counting">3.9</a>. The results of that
section thus apply here, giving the following.</p>
<div id="lem:standard2:cool-counts-for-SIgma-t-u" class="lemma">
<p><strong>Lemma 70</strong>. Let <span class="math inline">\(t, u \in
A_H(\mathbb{R})^0_{\geqslant 1}\)</span> and <span
class="math inline">\(0 &lt; X \leqslant 1\)</span>. Define <span
class="math inline">\(t ^\dagger = \prod_{i=1}^n \max(t_i,
t_i^{-1})\)</span>, as in §<a href="#sec:matrix-counting"
data-reference-type="ref" data-reference="sec:matrix-counting">3.9</a>.
We have <span id="eq:sigma-ll-ln+12-a-priori" class="math display">\[\label{eq:sigma-ll-ln+12-a-priori}\tag{5.57}
    |\Sigma_{t,u}| \ll
    L^{(n+1)^2 \mathfrak{j}}
    \left( t ^\dagger u ^\dagger \max(|\det(t^{-1} u)|, |\det(u^{-1}
t)|) \right)^{n+1}.\]</span> Assume further that <span id="eq:dett-1-u-b" class="math display">\[\label{eq:dett-1-u-b}\tag{5.58}
    \det(t^{-1} u) = T^{o(1)}.\]</span> Then <span
class="math inline">\(\Sigma_{t,u}^X\)</span> is nonempty only if <span id="eq:d--frac2n+1" class="math display">\[\label{eq:d--frac2n+1}\tag{5.59}
    L^{-2 \mathfrak{j}  - o(1)} \ll t_i / u_i \ll L^{2 \mathfrak{j}
+o(1)},\]</span> in which case <span id="eq:sigma_r-sx-ll" class="math display">\[\label{eq:sigma_r-sx-ll}\tag{5.60}
    |\Sigma_{t,u}^X| \ll X L ^{(3(n+1)^2) \mathfrak{j} + o(1)}
\min(\delta_H(t) t^\dagger, \delta_H(u) u ^\dagger),\]</span></p>
</div>
<h5 id="sec:appl-crude-bounds">§5.10.5. Application of crude bounds for
Eisenstein series</h5>
<p>We now introduce some <em>a priori</em> bounds concerning <span
class="math inline">\(\|\Psi\|_t\)</span>. These will permit us to
reduce the range of pairs <span class="math inline">\((t,u)\)</span> to
consider.</p>
<div id="lem:each-fixed-c_0-Psi-crude" class="lemma">
<p><strong>Lemma 71</strong>. For each fixed <span
class="math inline">\(C_0 \geqslant 0\)</span>, there is a fixed <span
class="math inline">\(C_1 \geqslant 0\)</span> so that for each fixed
<span class="math inline">\(C_2 \in \mathbb{R}\)</span>, we have for all
<span class="math inline">\(g \in [H]\)</span> <span
class="math display">\[\Psi(g)
    \ll
    \|g\|_{[H]}^{-C_0}
    T^{C_1}
    \left\lvert \det(g Y) \right\rvert^{C_2}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We appeal to Lemma <a
href="#lem:standard2:crude-growth-bounds-completed-eisenstein-series"
data-reference-type="ref"
data-reference="lem:standard2:crude-growth-bounds-completed-eisenstein-series">32</a>
(using transfer to restrict quantification over <span
class="math inline">\(C_0\)</span> through <span
class="math inline">\(\mathcal{D}\)</span> to fixed quantities, and with
<span class="math inline">\(-C_2\)</span> playing the role of <span
class="math inline">\(C_2\)</span>). Since <span
class="math inline">\(\Psi = \mathop{\mathrm{Eis}}[\Phi[f]]\)</span>
with <span class="math inline">\(f \in \mathcal{S}^e(U(\mathbb{R})
\backslash G(\mathbb{R}))^W\)</span>, we obtain (with quantifiers as
indicated) <span class="math display">\[\|g\|_{[H]}^{C_0} \left\lvert
\det(g Y) \right\rvert^{-C_2} \left\lvert \Psi(g) \right\rvert \ll
T^{C_1} \nu_{\mathcal{D},\ell,T}(f).\]</span> By assertion <a
href="#itm:sub-gln:7" data-reference-type="eqref"
data-reference="itm:sub-gln:7">\((iii)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>, we
have <span class="math inline">\(\nu_{\mathcal{D},\ell,T}(f) \ll
T^{o(1)}\)</span>. We conclude by replacing <span
class="math inline">\(C_1\)</span> by <span class="math inline">\(C_1 +
1\)</span>, say, to absorb the factor <span
class="math inline">\(T^{o(1)}\)</span>. ◻</p>
</div>
<div id="lem:standard2:each-fixed-c_0" class="lemma">
<p><strong>Lemma 72</strong>. For each fixed <span
class="math inline">\(C_0 \geqslant 0\)</span>, there is a fixed <span
class="math inline">\(C_1 \geqslant 0\)</span> so that for each fixed
<span class="math inline">\(C_2 \in \mathbb{R}\)</span>, we have for all
<span class="math inline">\(t \in A_H(\mathbb{R})^0_{\geqslant
1}\)</span> <span id="eq:psi-_t-ll" class="math display">\[\label{eq:psi-_t-ll}\tag{5.61}
    \|\Psi \|_t \ll (t ^\dagger )^{-C_0} T^{C_1} |\det(t
Y)|^{C_2}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a consequence of Lemma <a
href="#lem:each-fixed-c_0-Psi-crude" data-reference-type="ref"
data-reference="lem:each-fixed-c_0-Psi-crude">71</a> and the estimate
<span class="math inline">\(\log(3 + \|t u\|_{[H]}) \asymp \log(3 + t
^\dagger)\)</span> for <span class="math inline">\(u \in
\Omega\)</span>, which follows (in sharper forms) from a well-known
theorem of Siegel; see for instance <a href="#ref-MR1001613" class="citation"
data-cites="MR1001613">(Casselman 1989, Lemma 2.1)</a> or <a href="#ref-2016arXiv160206538B"
class="citation" data-cites="2016arXiv160206538B">(R. Beuzart-Plessis
2016, A.1.1 (viii))</a>. ◻</p>
</div>
<div id="lem:standard2:each-fixed-c" class="lemma">
<p><strong>Lemma 73</strong>. For each fixed <span
class="math inline">\(C \geqslant 0\)</span>, there is a subset <span
class="math inline">\(\mathcal{C}\)</span> of <span
class="math inline">\(A_H(\mathbb{R})^0_{\geqslant 1}\)</span> with the
following properties.</p>
<ol type="i">
<li><p>For each <span class="math inline">\(t \in \mathcal{C}\)</span>,
we have <span id="eq:detr-=-dety" class="math display">\[\label{eq:detr-=-dety}\tag{5.62}
      \det(t Y)  = T^{o(1)}, \quad t ^\dagger \ll
T^{\operatorname{O}(1)}.\]</span></p></li>
<li><p>The integral <span class="math inline">\(I\)</span> defined in <a
href="#eq:i-:=-int" data-reference-type="eqref"
data-reference="eq:i-:=-int">\((5.50)\)</a> satisfies the estimate
<span id="eq:mathcale-ll-tn2-restricted-to-C" class="math display">\[\label{eq:mathcale-ll-tn2-restricted-to-C}\tag{5.63}
      I \ll
      \int _{t, u  \in \mathcal{C} }
      \|\Psi\|_{t}
      \|\Psi\|_{u}
      \sum _{\gamma \in \Sigma_{t,u}}
      \min \left( T^{1/2}, \frac{1}{d_H(t^{-1} \gamma u)} \right)
      \, \frac{d t \, d u}{\delta_H(t) \delta_H(u)}
      + T^{-C}.\]</span></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> By <a href="#eq:sigma-ll-ln+12-a-priori"
data-reference-type="eqref"
data-reference="eq:sigma-ll-ln+12-a-priori">\((5.57)\)</a>,
we have <span id="eq:sum-_gamma-in-2" class="math display">\[\label{eq:sum-_gamma-in-2}\tag{5.64}
    \sum _{\gamma \in \Sigma_{t,u}}
    \min \left( T^{1/2}, \frac{1}{d_H(t^{-1} \gamma u)} \right)
    \leqslant T^{1/2} |\Sigma_{t,u}| \ll
    T^{1/2}
    L^{(n+1)^2 \mathfrak{j}} \mathcal{G}(t,u),\]</span> where we
abbreviate <span class="math display">\[\mathcal{G}(t,u)  := \left( t
^\dagger u ^\dagger \max(|\det(t^{-1} u)|, |\det(u^{-1} t)|)
\right)^{n+1}.\]</span> We may fix <span class="math inline">\(C_0
\geqslant 0\)</span> (large enough in terms of <span
class="math inline">\(n\)</span>) for which <span id="eq:int-_t-u" class="math display">\[\label{eq:int-_t-u}\tag{5.65}
    \int _{t, u \in A_H(\mathbb{R})^0_{\geqslant 1}}
    \mathcal{G}(t,u) (t ^\dagger u ^\dagger )^{1- C_0} \, \frac{d t \, d
u}{\delta_H(t) \delta_H(u)} &lt; \infty.\]</span> We then fix <span
class="math inline">\(C_1\)</span> according to the conclusion of Lemma
<a href="#lem:standard2:each-fixed-c_0" data-reference-type="ref"
data-reference="lem:standard2:each-fixed-c_0">72</a>.</p>
<p>For <span class="math inline">\(\varepsilon\in (0,1)\)</span>, define
<span class="math display">\[\mathcal{C}(\varepsilon) := \left\{ t \in
A_H(\mathbb{R})^0_{\geqslant 1} : \left\lvert \det (t Y ) \right\rvert
\in [T ^{- \varepsilon}, T ^\varepsilon]\right\}.\]</span> When <span
class="math inline">\(\varepsilon\)</span> is fixed, the conclusion of
Lemma <a href="#lem:standard2:each-fixed-c_0" data-reference-type="ref"
data-reference="lem:standard2:each-fixed-c_0">72</a> implies that <span id="eq:t-notin-mathcalceps" class="math display">\[\label{eq:t-notin-mathcalceps}\tag{5.66}
    t \notin \mathcal{C}(\varepsilon)
    \implies
    \|\Psi\|_t
    \leqslant
    (t ^\dagger )^{-C_0} T^{-1/\varepsilon}.\]</span> To see this, we
apply <a href="#eq:psi-_t-ll" data-reference-type="eqref"
data-reference="eq:psi-_t-ll">\((5.61)\)</a> with <span
class="math inline">\(\pm C_2\)</span> fixed but sufficiently large in
terms of <span class="math inline">\(C_1\)</span> and <span
class="math inline">\(\varepsilon\)</span>, using that <span
class="math inline">\(T \ggg 1\)</span> to clean up the implied
constant. By overspill, we may find some <span
class="math inline">\(\varepsilon\lll 1\)</span> for which this
implication <a href="#eq:t-notin-mathcalceps"
data-reference-type="eqref"
data-reference="eq:t-notin-mathcalceps">\((5.66)\)</a>
remains valid. We work henceforth with such a value of <span
class="math inline">\(\varepsilon\)</span>. For all <span
class="math inline">\(u \in A_H(\mathbb{R})^0_{\geqslant 1}\)</span>, we
see by taking <span class="math inline">\(C_2 = 0\)</span> in <a
href="#eq:psi-_t-ll" data-reference-type="eqref"
data-reference="eq:psi-_t-ll">\((5.61)\)</a> that <span id="eq:psi_0-_u-ll" class="math display">\[\label{eq:psi_0-_u-ll}\tag{5.67}
    \|\Psi\|_u \ll (u ^\dagger )^{-C_0} T^{C_1}.\]</span> Combining <a
href="#eq:sum-_gamma-in-2" data-reference-type="eqref"
data-reference="eq:sum-_gamma-in-2">\((5.64)\)</a>, <a
href="#eq:int-_t-u" data-reference-type="eqref"
data-reference="eq:int-_t-u">\((5.65)\)</a>, <a
href="#eq:t-notin-mathcalceps" data-reference-type="eqref"
data-reference="eq:t-notin-mathcalceps">\((5.66)\)</a> and
<a href="#eq:psi_0-_u-ll" data-reference-type="eqref"
data-reference="eq:psi_0-_u-ll">\((5.67)\)</a>, we obtain <span
class="math display">\[\int _{
      \substack{
        t, u \in A_H(\mathbb{R})^0_{\geqslant 1} :  \\
        t \notin \mathcal{C}(\varepsilon)
      }
    }
    \|\Psi\|_t \|\Psi\|_u
    \sum _{\gamma \in \Sigma_{t,u}}
    \min \left( T^{1/2}, \frac{1}{d_H(t^{-1} \gamma u)} \right) \,
\frac{d t \, d u}{\delta_H(t) \delta_H(u)}
    \ll T^{-\infty}.\]</span> A similar estimate applies with the roles
of <span class="math inline">\(t\)</span> and <span
class="math inline">\(u\)</span> reversed. Thus by restricting the
integral in the definition <a href="#eq:i-:=-int"
data-reference-type="eqref"
data-reference="eq:i-:=-int">\((5.50)\)</a> to <span
class="math inline">\(t,u \in \mathcal{C}(\varepsilon)\)</span>, we
introduce an additive error of <span
class="math inline">\(\operatorname{O}(T^{-\infty})\)</span>.</p>
<p>Next, for each <span class="math inline">\(m \geqslant 0\)</span>,
set <span class="math inline">\(\mathcal{C}(\varepsilon,m) := \left\{ t
\in \mathcal{C}(\varepsilon) : t ^\dagger \leqslant T^m
\right\}\)</span>. If <span class="math inline">\(t \notin
\mathcal{C}(\varepsilon,m)\)</span>, then it follows again from Lemma <a
href="#lem:standard2:each-fixed-c_0" data-reference-type="ref"
data-reference="lem:standard2:each-fixed-c_0">72</a> that <span
class="math display">\[\|\Psi\|_t \ll (t ^\dagger )^{-C_0} T^{C_1}
\leqslant(t ^\dagger ) ^{1 - C_0} T^{C_1 - m}.\]</span> By fixing <span
class="math inline">\(m\)</span> large enough, we see as in the previous
paragraph that the contribution to <span
class="math inline">\(I\)</span> from <span class="math inline">\(t
\notin \mathcal{C}(\varepsilon,m)\)</span> or <span
class="math inline">\(u \notin \mathcal{C}(\varepsilon,m)\)</span> is
<span class="math inline">\(\operatorname{O}(T^{-C})\)</span>. The
conclusion of the lemma then holds with <span
class="math inline">\(\mathcal{C} :=
\mathcal{C}(\varepsilon,m)\)</span>. ◻</p>
</div>
<h5 id="clean-up">Clean-up</h5>
<p>Since an additive error <span class="math inline">\(T^{-C}\)</span>,
with <span class="math inline">\(C\)</span> large enough but fixed, is
acceptable for the purposes of proving <a href="#eq:i-ll-tnkappa"
data-reference-type="eqref"
data-reference="eq:i-ll-tnkappa">\((5.51)\)</a>, we reduce to
showing that the estimate <a href="#eq:i-ll-tnkappa"
data-reference-type="eqref"
data-reference="eq:i-ll-tnkappa">\((5.51)\)</a> holds for the
modification <span class="math inline">\(I_{\mathcal{C}}\)</span> of
<span class="math inline">\(I\)</span> obtained by restricting the
integral over <span class="math inline">\(t,u\)</span> to some set <span
class="math inline">\(\mathcal{C}\)</span> as in the conclusion of Lemma
<a href="#lem:standard2:each-fixed-c" data-reference-type="ref"
data-reference="lem:standard2:each-fixed-c">73</a>: <span
class="math display">\[I_{\mathcal{C}} :=
  \int _{
    t, u \in \mathcal{C}
  }
  \|\Psi\|_t \|\Psi\|_u
  \sum _{\gamma \in \Sigma_{t,u}}
  \min \left( T^{1/2}, \frac{1}{d_H(t^{-1} \gamma u)} \right) \, \frac{d
t \, d u}{\delta_H(t) \delta_H(u)}.\]</span> We henceforth focus on one
such set <span class="math inline">\(\mathcal{C}\)</span>. By
Cauchy–Schwarz, we have <span class="math inline">\(I \leqslant
I_0\)</span>, where <span class="math display">\[I_0
  := \int _{t, u \in \mathcal{C} } \|\Psi\|_u^2
  \sum _{\gamma \in \Sigma_{t,u}}
  \min \left( T^{1/2}, \frac{1}{d_H(t^{-1} \gamma u)} \right)
  \, \frac{d t \, d u}{\delta_H(t) \delta_H(u)}.\]</span></p>
<div class="lemma">
<p><strong>Lemma 74</strong>. We have <span id="eq:i_1-ll-l" class="math display">\[\label{eq:i_1-ll-l}\tag{5.68}
  I_0 \ll
L ^{(3(n+1)^2 + 2n) \mathfrak{j} + o(1)}
\int _{t \in \mathcal{C} } \|\Psi\|_t^2
t ^\dagger  \, \frac{d t}{\delta_H(t)}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> For <span class="math inline">\(t,u \in
\mathcal{C}\)</span>, the hypothesis <a href="#eq:dett-1-u-b"
data-reference-type="eqref"
data-reference="eq:dett-1-u-b">\((5.58)\)</a> is satisfied (indeed,
<span class="math inline">\(\det(t)\)</span> and <span
class="math inline">\(\det(u)\)</span> are both of the form <span
class="math inline">\(\det(Y)^{-1} T^{o(1)}\)</span>). We may thus
appeal to the refined conclusions of Lemma <a
href="#lem:standard2:cool-counts-for-SIgma-t-u"
data-reference-type="ref"
data-reference="lem:standard2:cool-counts-for-SIgma-t-u">70</a>. First
of all, set <span class="math display">\[\mathcal{C}_2 := \left\{ (t,u)
\in \mathcal{C} \times \mathcal{C} : \Sigma_{t,u} \neq \emptyset
  \right\}.\]</span> Then, by <a href="#eq:d--frac2n+1"
data-reference-type="eqref"
data-reference="eq:d--frac2n+1">\((5.59)\)</a>, we have <span
class="math display">\[(t,u) \in \mathcal{C}_2 \implies
  L^{-2 \mathfrak{j} - o(1)} \ll t_i / u_i \ll L^{2 \mathfrak{j} + o(1)}
\text{ for all } i \in \{1,\dotsc,n\}.\]</span> In particular,</p>
<ul>
<li><p>for each <span class="math inline">\(t \in \mathcal{C}\)</span>,
the set of all <span class="math inline">\(u \in \mathcal{C}\)</span>
with <span class="math inline">\((t,u) \in \mathcal{C}_2\)</span> has
volume <span class="math inline">\(\ll (\log L)^{\operatorname{O}(1)}
\ll L^{o(1)}\)</span>, and</p></li>
<li><p>we have <span class="math inline">\(u ^\dagger \leqslant L ^{2 n
\mathfrak{j} + o (1)} t ^\dagger\)</span>.</p></li>
</ul>
<p>It follows that <span id="eq:int-_u-in" class="math display">\[\label{eq:int-_u-in}\tag{5.69}
  \int _{u \in \mathcal{C} : (t,u) \in \mathcal{C}_2 }
  u ^\dagger
  \, d u
  \ll  L^{2 n \mathfrak{j}  + o(1)} t ^\dagger.\]</span></p>
<p>Recall that the subset <span class="math inline">\(\Sigma_{t,u}^X
\subseteq \Sigma_{t,u}\)</span> is cut out by the condition <span
class="math inline">\(d_H(t^{-1} \gamma u) \leqslant X\)</span>. By
dyadic decomposition, we have <span class="math display">\[\sum _{\gamma
\in \Sigma_{t,u}}
  \min \left( T^{1/2}, \frac{1}{d_H(t^{-1} \gamma u)} \right) \ll  \sum
_{
    \substack{
      X \in \exp(\mathbb{Z}) :  \\
      T^{-1/2} &lt; X \leqslant 1
    }
  }
  \frac{| \Sigma_{t,u}^X|}{X}
  +
  \frac{|\Sigma_{t,u}^{X_0}|}{X_0}\]</span> with <span
class="math inline">\(X_0 := 100 T^{-1/2}\)</span>, say. We estimate the
cardinalities <span class="math inline">\(|\Sigma_{t,u}^X|\)</span>
using <a href="#eq:sigma_r-sx-ll" data-reference-type="eqref"
data-reference="eq:sigma_r-sx-ll">\((5.60)\)</a>, giving <span
class="math display">\[\frac{|\Sigma_{t,u}^X|}{X} \ll L ^{3(n+1)^2
\mathfrak{j} + o(1)} \min(\delta_H(t) t^\dagger, \delta_H(u) u
^\dagger).\]</span> There are <span
class="math inline">\(\operatorname{O}(\log T)\)</span> summands, giving
an overall estimate <span class="math display">\[\sum _{\gamma \in
\Sigma_{t,u}}
  \min \left( T^{1/2}, \frac{1}{d_H(t^{-1} \gamma u)} \right)
  \ll L ^{3(n+1)^2\mathfrak{j} + o(1)} \min(\delta_H(t) t^\dagger,
\delta_H(u) u ^\dagger).\]</span> We take the second alternative in the
minimum and insert the resulting estimate into the definition of <span
class="math inline">\(I_0\)</span>, giving <span
class="math display">\[I_0
  \ll
  L ^{3(n+1)^2 \mathfrak{j} + o(1)}
  \int _{(t, u) \in \mathcal{C}_2 } \|\Psi\|_t^2
  \delta_H(u) u ^\dagger \, \frac{d t \, d u}{\delta_H(t) \,
\delta_H(u)}.\]</span> Estimating the <span
class="math inline">\(u\)</span>-integral using <a href="#eq:int-_u-in"
data-reference-type="eqref"
data-reference="eq:int-_u-in">\((5.69)\)</a>, we arrive at the
desired estimate <a href="#eq:i_1-ll-l" data-reference-type="eqref"
data-reference="eq:i_1-ll-l">\((5.68)\)</a>. ◻</p>
</div>
<p>The proof of our earlier reduction <a href="#eq:i-ll-tnkappa"
data-reference-type="eqref"
data-reference="eq:i-ll-tnkappa">\((5.51)\)</a> of Proposition <a
href="#prop:standard2:with-notat-assumpt" data-reference-type="ref"
data-reference="prop:standard2:with-notat-assumpt">67</a> thereby
reduces to that of the estimate <span id="eq:int-_t-in" class="math display">\[\label{eq:int-_t-in}\tag{5.70}
  \int _{t \in \mathcal{C} } \|\Psi\|_t^2
  t ^\dagger  \, \frac{d t}{\delta_H(t)}
  \ll
  T^{n \kappa + o(1)}.\]</span></p>
<h5 id="sec:appl-growth-bounds">§5.10.7. Application of growth bounds for
Eisenstein series</h5>
<p>We now apply Theorem <a href="#thm:growth-eisenstein-nonstandard"
data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a> to deduce the
key estimate <a href="#eq:int-_t-in" data-reference-type="eqref"
data-reference="eq:int-_t-in">\((5.70)\)</a>, following some
preliminary lemmas.</p>
<div id="lem:standard2:we-have-begin-1-growth" class="lemma">
<p><strong>Lemma 75</strong>. For each <span class="math inline">\(t \in
A_H(\mathbb{R})^0_{\geqslant 1}\)</span>, we have <span id="eq:fracpsi-_r2d-ll" class="math display">\[\label{eq:fracpsi-_r2d-ll}\tag{5.71}
    \frac{\|\Psi\|_t^2}{\delta_H(t)}  \ll T^{o(1)} \min \left(
\det(Y)^{-1} t_1^{-n}, \det(Y) t_n^n \right).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We appeal to Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>. Recall that
<span class="math inline">\(\Psi = \mathop{\mathrm{Eis}}[L(Y) \Phi[f]] =
\mathop{\mathrm{Eis}}[\Phi[L(Y) f]]\)</span>. The required hypotheses
concerning <span class="math inline">\(f\)</span> follow from assertion
<a href="#itm:sub-gln:7" data-reference-type="eqref"
data-reference="itm:sub-gln:7">\((iii)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>. ◻</p>
</div>
<div id="lem:standard:any-dominant-element" class="lemma">
<p><strong>Lemma 76</strong>. For each <span class="math inline">\(t \in
A_H(\mathbb{R})^0_{\geqslant 1}\)</span>, we have <span
class="math display">\[t ^\dagger \leqslant\max\left( \frac{1}{\det(t)},
\det(t), \frac{t_1^n}{\det(t)}, \frac{\det(t)}{ t_n^{n}}
\right).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Consider first the case that <span
class="math inline">\(t_1 \leqslant 1\)</span>. Then <span
class="math inline">\(t_j \leqslant 1\)</span> for all <span
class="math inline">\(j\)</span>, so <span class="math inline">\(t
^\dagger = \det(t)^{-1}\)</span>. Similarly, if <span
class="math inline">\(t_n \geqslant 1\)</span>, then <span
class="math inline">\(t ^\dagger = \det(t)\)</span>. In either case, the
required inequality holds. We may thus suppose that <span
class="math inline">\(t_1 \geqslant 1 \geqslant t_n\)</span>. We may
then choose <span class="math inline">\(m \in \{1, \dotsc,
n-1\}\)</span> so that <span class="math inline">\(t_1 \geqslant\dotsb
\geqslant t_m \geqslant 1 \gg t_{m+1} \geqslant\dotsb \geqslant
t_n\)</span>, in which case <span class="math display">\[t ^\dagger =
\frac{t_1 \dotsb t_m}{t_{m+1} \dotsb t_n}.\]</span> Since <span
class="math inline">\(t_1 \dotsb t_m \cdot t_{m+1} \dotsb t_n =
\det(t)\)</span>, it follows that <span class="math display">\[t
^\dagger = \det(t)^{-1} (t _1 \dotsb t _m ) ^2 = \det(t) (t _{m + 1 }
\dotsb t _n ) ^{- 2},\]</span> and so <span class="math display">\[t
^\dagger \leqslant\min(\det(t)^{-1} t_1^{2 m},  \det(t)
t_n^{-2(n-m)}).\]</span> If <span class="math inline">\(m \leqslant
n/2\)</span>, then we may conclude by taking the first alternative in
the minimum, recalling that <span class="math inline">\(t_1 \geqslant
1\)</span>. If <span class="math inline">\(m \geqslant n/2\)</span>, so
that <span class="math inline">\(n-m \leqslant n/2\)</span>, then we may
conclude by taking the second alternative, recalling that <span
class="math inline">\(t_n \leqslant 1\)</span>. ◻</p>
</div>
<p>In view of our assumption that <span class="math inline">\(Y_j \in
[T^{-\kappa}, T^{\kappa}]\)</span>, we have <span
class="math inline">\(\det(Y) \in [T^{- n \kappa}, T^{n
\kappa}]\)</span>. The desired estimate <a href="#eq:int-_t-in"
data-reference-type="eqref"
data-reference="eq:int-_t-in">\((5.70)\)</a> is thus an immediate
consequence of the following.</p>
<div class="proposition">
<p><strong>Proposition 77</strong>. <em>We have <span
class="math display">\[\int _{t \in \mathcal{C} } \|\Psi\|_t^2 t
^\dagger \, \frac{d t}{\delta_H(t)}
    \ll
    \max(\det(Y), \det(Y)^{-1}) T^{o(1)}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Lemma <a href="#lem:standard:any-dominant-element"
data-reference-type="ref"
data-reference="lem:standard:any-dominant-element">76</a> gives <span
class="math display">\[\int _{t \in \mathcal{C} } \|\Psi\|_t^2 t
^\dagger \, \frac{d t}{\delta_H(t)} \ll
    J_+ + J_- + J_0,\]</span> <span class="math display">\[J_{\pm} :=
\int _{t \in \mathcal{C} } \|\Psi\|_t^2 \det(t)^{\pm 1} \, \frac{d
t}{d_H(t)},\]</span> <span class="math display">\[J_0 := \int _{t \in
\mathcal{C} } \|\Psi\|_t^2 \max(\det(t)^{-1} t_1^n, \det(t) t_n^{-n}) \,
\frac{d t}{ \delta_H(t) }.\]</span></p>
<p>Recall from <a href="#eq:detr-=-dety" data-reference-type="eqref"
data-reference="eq:detr-=-dety">\((5.62)\)</a> that for <span
class="math inline">\(t \in \mathcal{C}\)</span>, we have <span id="eq:dett-=-dety" class="math display">\[\label{eq:dett-=-dety}\tag{5.72}
\det(t) = \det(Y)^{-1} T^{o(1)}\]</span> and <span id="eq:t-dagger-ll" class="math display">\[\label{eq:t-dagger-ll}\tag{5.73}
t ^\dagger \ll T^{\operatorname{O}(1)}.\]</span> Recall also from
Corollary <a href="#cor:standard2:we-have-psi" data-reference-type="ref"
data-reference="cor:standard2:we-have-psi">49</a> that <span
class="math inline">\(\|\Psi\| \ll T^{o(1)}\)</span>. By Proposition <a
href="#prop:siegel-lower-integrated" data-reference-type="ref"
data-reference="prop:siegel-lower-integrated">36</a>, it follows that
<span class="math display">\[\int _{t \in \mathcal{C} } \|\Psi\|_t^2 \,
\frac{d t}{ \delta_H(t) } \ll T^{o(1)}.\]</span> Thus <span
class="math display">\[J_+ + J _- \ll
  \max(\det(Y), \det(Y)^{-1}) T^{o(1)}.\]</span> It remains only to
estimate <span class="math inline">\(J_0\)</span>. By Lemma <a
href="#lem:standard2:we-have-begin-1-growth" data-reference-type="ref"
data-reference="lem:standard2:we-have-begin-1-growth">75</a> and the
estimate <a href="#eq:dett-=-dety" data-reference-type="eqref"
data-reference="eq:dett-=-dety">\((5.72)\)</a>, we have <span
class="math display">\[J_0 \ll T^{o(1)} \int_{t \in \mathcal{C}} \, d
t.\]</span> By <a href="#eq:t-dagger-ll" data-reference-type="eqref"
data-reference="eq:t-dagger-ll">\((5.73)\)</a>, we see that <span
class="math inline">\(\int_{t \in \mathcal{C}} \, d t \ll (\log
T)^{\operatorname{O}(1)} \ll T^{o(1)}\)</span>. The proof is now
complete. ◻</p>
</div>
<h4 id="sec:optimization">§5.11. Optimization</h4>
<p>We now optimize (as in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 6.6)</a>).
The results of §<a href="#sec:main-term-estimates"
data-reference-type="ref"
data-reference="sec:main-term-estimates">3.8</a> and §<a
href="#sec:error-term-estimates" data-reference-type="ref"
data-reference="sec:error-term-estimates">3.10</a> combine to give <span
class="math display">\[\mathcal{M} + \mathcal{E} \ll
  T^{n/2 + o(1)} (
  L^{-\mathfrak{j}}+ T^{-1/2 + n \kappa} L^{(3(n+1)^2 + n)
\mathfrak{j}})\]</span> We insert this bound into the decompositions <a
href="#eq:mathcalr-ll-sum" data-reference-type="eqref"
data-reference="eq:mathcalr-ll-sum">\((5.25)\)</a> and <a
href="#eq:mathc-=-mathc" data-reference-type="eqref"
data-reference="eq:mathc-=-mathc">\((5.26)\)</a> to see that the
quantity <span class="math inline">\(\mathcal{R}\)</span> defined in <a
href="#eq:leftlvert-int-_h" data-reference-type="eqref"
data-reference="eq:leftlvert-int-_h">\((5.20)\)</a>
satisfies, for fixed <span class="math inline">\(\varepsilon&gt;
0\)</span>, <span class="math display">\[\begin{align}
  \frac{\mathcal{R}}{L^2 T^{n/2}}
  &amp;\ll T^{o(1)}  \sum_{\mathfrak{j}=1}^{n+1} \left(
L^{-\mathfrak{j}} + T^{-1/2 + n \kappa} L^{(3(n+1)^2  + n) \mathfrak{j}}
    \right) \\
  &amp;\quad + T^{o(1)} L^{-1} \sum _{\mathfrak{j} = 0}^{n+1} \left(
    L^{- \mathfrak{j}} + T^{-1/2 + n \kappa}  L^{(3(n+1)^2  + n)
\mathfrak{j}}
    \right).
\end{align}\]</span> By the results of §<a
href="#sec:reduct-peri-bounds" data-reference-type="ref"
data-reference="sec:reduct-peri-bounds">3.3</a> and §<a
href="#sec:intr-an-ampl" data-reference-type="ref"
data-reference="sec:intr-an-ampl">3.6</a>, we have the following
implication, for fixed <span class="math inline">\(\kappa \in (0,
1/2)\)</span> and <span class="math inline">\(\delta &gt; 0\)</span>:
<span class="math display">\[\frac{\mathcal{R}}{L^2 T^{n/2}} \ll T^{- 2
\delta + o(1)}
  \implies
  L(\pi,\tfrac{1}{2})^n \ll C(\pi_{\mathop{\mathrm{fin}}})^{n/2}
T^{n(n+1)/4 - \min(\kappa/2,\delta) + o(1)}.\]</span> To optimize, we
take <span class="math inline">\(\kappa = 2 \delta\)</span>, which
forces <span class="math inline">\(\delta &lt; 1/4\)</span>, and <span
class="math inline">\(L = T^{2 \delta}\)</span>. Our estimate for <span
class="math inline">\(\mathcal{R}\)</span> then reads <span
class="math display">\[\frac{\mathcal{R}}{L^2 T^{n/2}}
  \ll
  T^{- 2 \delta + o(1)} ( 1 + T^{\alpha} )\]</span> with <span
class="math display">\[\begin{align}
  \alpha
  &amp;:=
    2 \delta -1/2 + n \kappa
  +
  (3 (n+1)^2 + n)(n+1) \delta  \\
  &amp;=
    (2 + 2 n + (3 (n+1)^2  + n)(n+1)) \delta - 1/2.
\end{align}\]</span> We have <span class="math inline">\(\alpha
\leqslant 0\)</span> provided that <span class="math display">\[\delta
\leqslant\frac{1}{2 (2 + 2 n + (3 (n+1)^2 + n)(n+1))},\]</span> in which
case we obtain <span class="math display">\[L(\pi,\tfrac{1}{2})^n \ll
C(\pi_{\mathop{\mathrm{fin}}})^{n/2} T^{n(n+1)/4 - \delta +
o(1)}.\]</span> Equivalently, for any fixed <span
class="math display">\[\delta &lt; \delta_{n+1} ^\sharp  :=
\frac{2}{n(n+1) (2 + 2 n + (3 (n+1)^2 + n)(n+1))}.\]</span> we have
<span class="math display">\[L(\pi,\tfrac{1}{2}) \ll
C(\pi_{\mathop{\mathrm{fin}}})^{1/2} T^{\frac{n+1}{4}(1 -
\delta)}.\]</span> We verify readily that <span
class="math inline">\(\delta_n ^\sharp\)</span> simplifies to the
fraction indicated in the introduction, i.e., that, <span
class="math display">\[n(n+1) (2 + 2 n + (3 (n+1)^2 + n)(n+1))
  = 3 ( n+1)^5 - 2 (n+1)^4 - (n+1)^2.\]</span> 0◻</p>
<p>This completes the deduction of Theorem <a
href="#thm:main-result-reformulated" data-reference-type="ref"
data-reference="thm:main-result-reformulated">10</a> from Theorems <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a> and
<a href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>. The remainder
of the paper is devoted to proofs of the latter results. Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a> is
the subject of Parts <a href="#part:constr-test-vect"
data-reference-type="ref" data-reference="part:constr-test-vect"></a>
and <a href="#part:asympt-analys-kirill" data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>, while Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a> is taken up in
Part <a href="#part:local-l2-growth" data-reference-type="ref"
data-reference="part:local-l2-growth"></a>.</p>
<h1 id="part:constr-test-vect">§2. Construction of test vectors</h1>
<p>Here we develop the proof of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>.
That result asserts the existence of, among other things, vectors <span
class="math inline">\(f \in \mathcal{S}^e(U_H \backslash
H)^{W_H}\)</span> and <span class="math inline">\(W \in
\mathcal{W}(\pi,\psi)\)</span> having favorable properties. The main
point of Part <a href="#part:constr-test-vect" data-reference-type="ref"
data-reference="part:constr-test-vect"></a> is to construct <span
class="math inline">\(f\)</span> and <span
class="math inline">\(W\)</span>. The construction of <span
class="math inline">\(W\)</span> is given in §<a
href="#sec:asympt-analys-local" data-reference-type="ref"
data-reference="sec:asympt-analys-local">3</a>, that of <span
class="math inline">\(f\)</span> in §<a href="#sec:some-analysis-basic"
data-reference-type="ref"
data-reference="sec:some-analysis-basic">4</a>. Some ingredients and
language common to both constructions are given in §<a
href="#sec:modul-bump-funct" data-reference-type="ref"
data-reference="sec:modul-bump-funct">1</a>.</p>
<h3 id="sec:modul-bump-funct">§6. Lie-theoretic preliminaries</h3>
<p>Let <span class="math inline">\(F\)</span> be a fixed completion of
<span class="math inline">\(\mathbb{Q}\)</span>, thus <span
class="math inline">\(F\)</span> is either <span
class="math inline">\(\mathbb{R}\)</span> or <span
class="math inline">\(\mathbb{Q}_p\)</span> for some fixed prime <span
class="math inline">\(p\)</span>. This section concerns Lie theory over
<span class="math inline">\(F\)</span>. We remark that any algebraic
group over a local field of characteristic zero may be regarded as a Lie
group over some such <span class="math inline">\(F\)</span>, so there is
little loss of generality in our assumptions. Our aim is to record some
basic properties of “microlocalized” functions on Lie groups over <span
class="math inline">\(F\)</span>. It seemed clearest to develop the main
arguments first in the category of analytic manifolds, and then to
specialize at the end to the setting of Lie groups.</p>
<p>The <span class="math inline">\(p\)</span>-adic case of the present
discussion is not applied in this paper. It could be useful for
generalizating the results of this paper to the depth aspect, although
simpler approaches are likely possible for that. Our main motivation for
discussing the <span class="math inline">\(p\)</span>-adic case is that
many statements and proofs are simpler in that case, and we feel that
including them helps motivate the ideal that we are striving for with
our treatment of the real case.</p>
<p>The main exports of this section are Definition <a
href="#defn:we-henceforth-denote" data-reference-type="ref"
data-reference="defn:we-henceforth-denote">115</a> and Propositions <a
href="#lem:standard2:class-mathfrakcm-p" data-reference-type="ref"
data-reference="lem:standard2:class-mathfrakcm-p">114</a>, <a
href="#lem:assume-that-rho" data-reference-type="ref"
data-reference="lem:assume-that-rho">123</a>, <a
href="#lem:archimedean-vector-field-act-on-C-2"
data-reference-type="ref"
data-reference="lem:archimedean-vector-field-act-on-C-2">133</a>, <a
href="#lem:sub-gln:let-gamma-in" data-reference-type="ref"
data-reference="lem:sub-gln:let-gamma-in">134</a> and <a
href="#lem:standard:subcl-mathfr-theta" data-reference-type="ref"
data-reference="lem:standard:subcl-mathfr-theta">135</a>. These give a
well-defined notion of, roughly, a “smooth modulated bump concentrated
on <span class="math inline">\(p + \operatorname{O}(T^{-1/2})\)</span>
and oscillating with frequency <span class="math inline">\(\ll
T\)</span>” with good functorial properties (under pushforward, the
action of a Lie group, convolution, etc.). The proofs are direct
applications of Taylor’s theorem, using that the quadratic and higher
terms do not contribute significantly in the indicated range.</p>
<h4 id="preliminaries">Preliminaries</h4>
<h5 id="sec:pontry-dual-vect">§6.1.1. Pontryagin duality for vector spaces</h5>
<p>In this section, “vector space” always means “finite-dimensional
vector space over <span class="math inline">\(F\)</span>.”</p>
<p>Let <span class="math inline">\(V\)</span> be a vector space. We
denote by <span class="math inline">\(V^*\)</span> the dual space,
consisting of <span class="math inline">\(F\)</span>-linear maps <span
class="math inline">\(V \rightarrow F\)</span>. We denote by <span
class="math inline">\(V^\wedge\)</span> the Pontryagin dual, consisting
of continuous group homomorphisms <span class="math inline">\(V
\rightarrow \mathop{\mathrm{U}}(1)\)</span>, with <span
class="math inline">\(\mathop{\mathrm{U}}(1) \subseteq
\mathbb{C}^\times\)</span> the circle group. Using (say) the “standard”
nontrivial unitary character <span class="math inline">\(\psi_F : F
\rightarrow \mathop{\mathrm{U}}(1)\)</span> (§<a
href="#sec:stand-nond-char" data-reference-type="ref"
data-reference="sec:stand-nond-char">2.11</a>), we may identify <span
class="math inline">\(V^*\)</span> with <span
class="math inline">\(V^\wedge\)</span>: to <span
class="math inline">\(\ell \in V^*\)</span> corresponds <span
class="math inline">\([V \ni v \mapsto \psi_F(\ell(v)) \in
\mathop{\mathrm{U}}(1)] \in V^\wedge\)</span>. In particular, <span
class="math inline">\(V^\wedge\)</span> is naturally a vector space of
the same dimension as <span class="math inline">\(V\)</span>. We will
generally avoid making such identifications here.</p>
<p>As a matter of notation, given <span class="math inline">\(\xi \in
V^\wedge\)</span>, we denote by <span class="math display">\[\psi_\xi :
V \rightarrow \mathop{\mathrm{U}}(1)\]</span> the homomorphism
canonically associated to it. In the archimedean case <span
class="math inline">\(F = \mathbb{R}\)</span>, we define the bilinear
pairing <span class="math display">\[\langle ,  \rangle : V \otimes
V^\wedge \rightarrow i \mathbb{R}\]</span> to be the differential of the
canonical pairing <span class="math inline">\(V \times V^\wedge
\rightarrow \mathop{\mathrm{U}}(1)\)</span>, i.e., <span
class="math display">\[\langle x, \xi  \rangle := \partial_{t=0} \psi_{t
\xi}(x) = \partial_{t=0} \psi_{\xi}(t x),\]</span> so that <span
class="math inline">\(\psi_{\xi}(x) = \exp(\langle x,
\xi  \rangle)\)</span>. In this way, <span
class="math inline">\(V^\wedge\)</span> identifies naturally with the
imaginary dual of <span class="math inline">\(V\)</span>.</p>
<h5 id="sec:local-maps">§6.1.2. Local maps</h5>
<p>Given topological spaces <span class="math inline">\(X\)</span> and
<span class="math inline">\(Y\)</span>, a <em>local map</em> <span
class="math inline">\(f : X %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
Y\)</span> is a pair <span
class="math inline">\((\mathop{\mathrm{dom}}(f), f)\)</span>, where</p>
<ul>
<li><p><span class="math inline">\(\mathop{\mathrm{dom}}(f)\)</span>,
called the <em>domain</em> of <span class="math inline">\(f\)</span>, is
an open subset of <span class="math inline">\(X\)</span>, and</p></li>
<li><p><span class="math inline">\(f : \mathop{\mathrm{dom}}(f)
\rightarrow Y\)</span> is a continuous map.</p></li>
</ul>
<p>We say that <span class="math inline">\(f\)</span> is
<em>defined</em> at an element <span class="math inline">\(p\)</span> of
<span class="math inline">\(X\)</span> if <span class="math inline">\(p
\in \mathop{\mathrm{dom}}(f)\)</span>.</p>
<p>Given two local maps <span class="math inline">\(f : X %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
Y\)</span> and <span class="math inline">\(g : Y %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
Z\)</span>, we may define their composition <span
class="math inline">\(g \circ f : X %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
Z\)</span>, which is a local map with (possibly empty) domain <span
class="math display">\[\mathop{\mathrm{dom}}(g \circ f) :=
\mathop{\mathrm{dom}}(f) \cap
f^{-1}(\mathop{\mathrm{dom}}(g)).\]</span></p>
<h5 id="sec:multi-index-notation">§6.1.3. Multi-index notation</h5>
<p>Let <span class="math inline">\(V\)</span> be a vector space. By
choosing a basis for <span class="math inline">\(V\)</span>, we may
identify it with <span class="math inline">\(F^n\)</span> for some <span
class="math inline">\(n\)</span>. By a <em>multi-index</em> for <span
class="math inline">\(V\)</span>, we mean an <span
class="math inline">\(n\)</span>-tuple <span
class="math inline">\(\alpha = (\alpha _1, \dotsc, \alpha _n ) \in
\mathbb{Z} _{\geqslant 0} ^n\)</span> of nonnegative integers. For a
multi-index <span class="math inline">\(\alpha\)</span> and <span
class="math inline">\(x \in V\)</span>, we set <span
class="math inline">\(x^\alpha := \prod_i x_i^{\alpha_i}\)</span> and
<span class="math inline">\(|\alpha| := \sum_i \alpha_i\)</span>. In the
archimedean case (thus <span class="math inline">\(V =
\mathbb{R}^n\)</span>), we denote by <span
class="math inline">\(\partial^\alpha := \prod_i
\frac{\partial^{\alpha_i}}{\partial ^{\alpha_i} x_i}\)</span> the
translation-invariant differential operator on <span
class="math inline">\(C^\infty(V)\)</span> associated to a multi-index
<span class="math inline">\(\alpha\)</span>.</p>
<h5 id="sec:analytic-functions">§6.1.4. Analytic maps</h5>
<p>Let <span class="math inline">\(V\)</span> be a vector space. By
choosing a basis, we may identify it with <span
class="math inline">\(F^n\)</span> for some <span
class="math inline">\(n \in \mathbb{Z}_{\geqslant 0}\)</span>. We denote
by <span class="math inline">\(|.|\)</span> the norm on <span
class="math inline">\(F^n\)</span> given by <span
class="math inline">\(|x| := \max_{i} |x_i|\)</span>.</p>
<p>Let <span class="math inline">\(V_1\)</span> and <span
class="math inline">\(V_2\)</span> be vector spaces, and let <span
class="math inline">\(f : V_1 %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
V_2\)</span> be a local map. We recall that</p>
<ul>
<li><p><span class="math inline">\(f\)</span> is <em>analytic</em> at a
point <span class="math inline">\(p \in
\mathop{\mathrm{dom}}(f)\)</span> if it may be expressed in some
neighborhood of <span class="math inline">\(p\)</span> by a convergent
power series, and</p></li>
<li><p><span class="math inline">\(f\)</span> is <em>analytic</em> if it
is analytic at every point of its domain.</p></li>
</ul>
<p>By choosing bases, we may identify <span
class="math inline">\(V_i\)</span> with <span
class="math inline">\(F^{n_i}\)</span> for some <span
class="math inline">\(n_i \in \mathbb{Z}_{\geqslant 0}\)</span>. For
analytic <span class="math inline">\(f\)</span>, the power series
representation of <span class="math inline">\(f\)</span> at <span
class="math inline">\(p \in \mathop{\mathrm{dom}}(f)\)</span> may be
written <span id="eq:phip-+-x" class="math display">\[\label{eq:phip-+-x}\tag{6.1}
  f(p + x) = \sum _{\alpha } c_\alpha x^\alpha,\]</span> where <span
class="math inline">\(\alpha\)</span> runs over multi-indices for <span
class="math inline">\(V_1\)</span> and <span
class="math inline">\(c_\alpha \in V_2 = F^{n_2}\)</span>. The
analyticity condition implies that there exist <span
class="math inline">\(C \geqslant 0\)</span> and <span
class="math inline">\(r &gt; 0\)</span> so that for all <span
class="math inline">\(\alpha\)</span>, <span id="eq:c_alpha-leq-c_0" class="math display">\[\label{eq:c_alpha-leq-c_0}\tag{6.2}
  |c_\alpha| \leqslant C r^{-|\alpha|}.\]</span> We say then that <span
class="math inline">\(f\)</span> is <em><span
class="math inline">\((C,r)\)</span>-controlled at <span
class="math inline">\(p\)</span></em>.</p>
<p>The following elementary results may be verified by effectivizing the
proofs of <a href="#ref-MR2179691" class="citation" data-cites="MR2179691">(Serre 2006,
1500:p69, Theorem)</a> and <a href="#ref-MR2179691" class="citation"
data-cites="MR2179691">(Serre 2006, 1500:p70, Theorem)</a>,
respectively.</p>
<div id="lem:standard2:elementary-analytic-translate" class="lemma">
<p><strong>Lemma 78</strong>. Let <span
class="math inline">\(V_1\)</span> and <span
class="math inline">\(V_2\)</span> be vector spaces equipped with bases,
hence with norms <span class="math inline">\(|.|\)</span> as above. Let
<span class="math inline">\(C \geqslant 0\)</span> and <span
class="math inline">\(r, r&#39;, r&#39;&#39; &gt; 0\)</span> with <span
class="math inline">\(r&#39; + r&#39;&#39; &lt; r\)</span>. There exists
<span class="math inline">\(C&#39; \geqslant 0\)</span> with the
following property. Let <span class="math inline">\(p \in V_1\)</span>.
Let <span class="math inline">\(f : V_1 %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
V_2\)</span> be analytic, defined at <span
class="math inline">\(p\)</span>, and <span
class="math inline">\((C,r)\)</span>-controlled at <span
class="math inline">\(p\)</span>. Let <span class="math inline">\(p&#39;
\in V_1\)</span> with <span class="math inline">\(|p&#39; - p| \leqslant
r&#39;\)</span>. Then <span class="math inline">\(f\)</span> is <span
class="math inline">\((C&#39;,r&#39;&#39;)\)</span>-controlled at <span
class="math inline">\(p&#39;\)</span>.</p>
</div>
<div id="lem:standard2:elementary-analytic-compose" class="lemma">
<p><strong>Lemma 79</strong>. Let <span class="math inline">\(V_1, V_2,
V_3\)</span> be vector spaces equipped with bases, hence with norms
<span class="math inline">\(|.|\)</span> as above. Let <span
class="math inline">\(C_1, C_2 \geqslant 0\)</span> and <span
class="math inline">\(r_1, r_2 &gt; 0\)</span>. There exists <span
class="math inline">\(C_3 \geqslant 0\)</span> and <span
class="math inline">\(r_3 &gt; 0\)</span> with the following property.
Let <span class="math inline">\(p_1 \in V_1\)</span> and <span
class="math inline">\(p_2 \in V_2\)</span>. For <span
class="math inline">\(i=1,2\)</span>, let <span
class="math inline">\(f_i : V_i %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
V_{i+1}\)</span> be analytic, defined at <span
class="math inline">\(p_i\)</span>, and <span
class="math inline">\((C_i,r_i)\)</span>-controlled at <span
class="math inline">\(p_i\)</span>. Then <span class="math inline">\(f_2
\circ f_1 : V_1 %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
V_3\)</span> is analytic, defined at <span
class="math inline">\(p_1\)</span>, and <span
class="math inline">\((C_3,r_3)\)</span>-controlled at <span
class="math inline">\(p_1\)</span>.</p>
</div>
<h5 id="sec:manifolds">§6.1.5. Manifolds</h5>
<p>We recall that an <em>analytic manifold</em> <span
class="math inline">\(M\)</span> over <span
class="math inline">\(F\)</span> is a topological space equiped with a
maximal atlas of coordinate charts, taking values in finite-dimensional
vector spaces over <span class="math inline">\(F\)</span>, for which the
transition maps are analytic (see <a href="#ref-MR2179691" class="citation"
data-cites="MR2179691">(Serre 2006, vol. 1500, pt. II, Chapter
III)</a> for details). In what follows, “manifold” always means
“analytic manifold over <span class="math inline">\(F\)</span>,” and
“chart” refers to the analytic structure.</p>
<p>A <em>morphism</em> <span class="math inline">\(f : M_1 \rightarrow
M_2\)</span> of manifolds is an analytic map, i.e., a map that is
described in local coordinates, with respect to every pair
(equivalently, sufficiently many pairs) of charts <span
class="math inline">\(c_1\)</span> on <span
class="math inline">\(M_1\)</span> and <span
class="math inline">\(c_2\)</span> on <span
class="math inline">\(M_2\)</span>, by an analytic map of vector spaces
as in §<a href="#sec:analytic-functions" data-reference-type="ref"
data-reference="sec:analytic-functions">1.1.4</a>. We then define
<em>isomorphisms</em> in the usual way as the morphisms that admit
two-sided inverses.</p>
<p>For each <span class="math inline">\(p \in M\)</span>, we denote by
<span class="math inline">\(T_p(M)\)</span> the tangent space, <span
class="math inline">\(T_p^*(M)\)</span> the cotangent space, and <span
class="math inline">\(T_p^\wedge(M)\)</span> the Pontryagin dual of the
tangent space.</p>
<h5 id="sec:pointed-manifolds">§6.1.6. Pointed manifolds</h5>
<p>By a <em>pointed manifold</em> <span
class="math inline">\((M,p)\)</span>, we mean a pair consisting of a
manifold <span class="math inline">\(M\)</span> and a point <span
class="math inline">\(p \in M\)</span>. A <em>morphism</em> of pointed
manifolds <span class="math inline">\((M_1, p_1) \rightarrow (M_2,
p_2)\)</span> is a morphism of manifolds <span class="math inline">\(M_1
\rightarrow M_2\)</span> that maps <span
class="math inline">\(p_1\)</span> to <span
class="math inline">\(p_2\)</span>. A <em>local morphism</em> of pointed
manifolds <span class="math inline">\(f : (M_1,p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2,p_2)\)</span> is a local map for which</p>
<ul>
<li><p><span class="math inline">\(p_1\)</span> belongs to the domain of
<span class="math inline">\(f\)</span>,</p></li>
<li><p><span class="math inline">\(f\)</span> is analytic on its domain,
and</p></li>
<li><p><span class="math inline">\(f(p_1) = p_2\)</span>.</p></li>
</ul>
<p>It would be cleaner for some purposes to pass to germs, but we do not
do so here.</p>
<p>A composition of local morphisms of pointed manifolds, defined as in
§<a href="#sec:local-maps" data-reference-type="ref"
data-reference="sec:local-maps">1.1.2</a>, is likewise a local
morphism.</p>
<p>Let <span class="math inline">\(f : (M_1,p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2,p_2)\)</span> and <span class="math inline">\(g : (M_2,p_2) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_1,p_1)\)</span> be local morphisms of pointed manifolds. We say that
<span class="math inline">\(g\)</span> is an <em>inverse</em> for <span
class="math inline">\(f\)</span> if <span
class="math inline">\(\mathop{\mathrm{dom}}(g) =
\mathop{\mathrm{image}}(f)\)</span>, <span
class="math inline">\(\mathop{\mathrm{image}}(g) =
\mathop{\mathrm{dom}}(f)\)</span>, and <span class="math inline">\(f
\circ g\)</span> (resp. <span class="math inline">\(g \circ f\)</span>)
coincides with the identity map on <span
class="math inline">\(\mathop{\mathrm{dom}}(g)\)</span> (resp. <span
class="math inline">\(\mathop{\mathrm{dom}}(f)\)</span>); in that case,
<span class="math inline">\(g\)</span> is uniquely determined, and we
denote it by <span class="math inline">\(f^{-1}\)</span>. We say that
<span class="math inline">\(f\)</span> is a <em>local isomorphism</em>
if it admits an inverse. We note that if <span
class="math inline">\(f\)</span> satisfies the weaker condition that
there exists <span class="math inline">\(g\)</span> for which <span
class="math inline">\(f \circ g\)</span> (resp.) <span
class="math inline">\(g \circ f\)</span> coincides with the identity map
on some neighborhood of <span class="math inline">\(p_2\)</span> (resp.
<span class="math inline">\(p_1\)</span>), then by shrinking the domain
of <span class="math inline">\(f\)</span> to a suitable neighborhood of
<span class="math inline">\(p\)</span>, we obtain a local isomorphism in
the indicated sense.</p>
<p>In this terminology, a chart <span class="math inline">\(c\)</span>
for <span class="math inline">\(M\)</span> at <span
class="math inline">\(p\)</span> is a local isomorphism <span
class="math inline">\((M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,q)\)</span> for some vector space <span
class="math inline">\(V\)</span>. By composing with a translation, we
may always arrange that <span class="math inline">\(q\)</span> is the
origin <span class="math inline">\(0 \in V\)</span>. The derivative of
<span class="math inline">\(c&#39;(p)\)</span> of <span
class="math inline">\(c\)</span> at <span
class="math inline">\(p\)</span> induces a linear isomorphism between
<span class="math inline">\(T_p(M)\)</span> and <span
class="math inline">\(T_{c(p)} V = V\)</span>. There is thus little loss
of generality in taking <span class="math inline">\(c\)</span> of the
form <span id="eq:c-:-m" class="math display">\[\label{eq:c-:-m}\tag{6.3}
  c : (M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(T_p(M), 0),
  \quad
  c&#39;(p) = \text{ the identity map on } T_p(M).\]</span> For example,
if <span class="math inline">\(M\)</span> is a Lie group and <span
class="math inline">\(p\)</span> the identity element, then the
logarithm defines a chart of this form.</p>
<h5 id="sec:inverse-funct-theor">§6.1.7. Inverse function theorem</h5>
<p>Let <span class="math inline">\(\rho : (M_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2, p_2)\)</span> be a morphism of pointed manifolds. We recall that
<span class="math inline">\(\rho\)</span> is <em>submersive</em> at
<span class="math inline">\(p_1\)</span> if the map <span
class="math inline">\((d \rho)_{p_1} : T_{p_1}(M_1) \rightarrow
T_{p_2}(M_2)\)</span> is surjective. In that case, the implicit function
theorem implies that there are vector spaces <span
class="math inline">\(V_j\)</span>, coordinate charts <span
class="math inline">\(c_j : (M_j, p_j) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_j,0)\)</span> and a surjective linear map <span
class="math inline">\(\ell : V_1 \rightarrow V_2\)</span> so that the
diagram <span class="math display">\[\begin{CD}         
    M_1 @&gt;\phi&gt;&gt;M_2\\
    @Vc_1VV  @VVc_2V \\
    V_1 @&gt;&gt;\ell&gt;V_2\\
  \end{CD}\]</span> is defined and commutes in some neighborhood of
<span class="math inline">\(p_1\)</span>.</p>
<p>We recall that a morphism <span class="math inline">\(\rho : M_1
\rightarrow M_2\)</span> of manifolds is <em>submersive</em> if for each
<span class="math inline">\(p \in M\)</span>, the induced morphism <span
class="math inline">\((M_1, p) \rightarrow (M_2, \rho(p))\)</span> is
submersive in the above sense.</p>
<h5 id="smooth-measures">Smooth measures</h5>
<p>Let <span class="math inline">\(V\)</span> be a vector space. We may
speak of smooth functions <span class="math inline">\(V \rightarrow
\mathbb{C}\)</span>. In the archimedean case, this carries the usual
meaning (“smooth over <span class="math inline">\(\mathbb{R}\)</span>”).
In the non-archimedean case, it means “locally constant;” we will
primarily consider compactly-supported measures, for which it is
equivalent to ask for invariance under some open subgroup of <span
class="math inline">\(V\)</span>. By a <em>smooth measure</em> on <span
class="math inline">\(V\)</span>, we mean a complex-valued measure
obtained by multiplying a Haar measure by a smooth function.</p>
<p>Let <span class="math inline">\(M\)</span> be a manifold. By a
<em>smooth measure</em> <span class="math inline">\(\gamma\)</span> on
<span class="math inline">\(M\)</span>, we mean a complex-valued measure
with the following property: for each <span class="math inline">\(p \in
M\)</span>, there is a coordinate chart <span class="math inline">\(c :
(M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V, 0)\)</span> and a smooth measure <span
class="math inline">\(\gamma_c\)</span> on <span
class="math inline">\(V\)</span> so that <span
class="math display">\[c_*(\gamma|_{\mathop{\mathrm{dom}}(c)}) =
\gamma_c |_{\mathop{\mathrm{image}}(c)}.\]</span> We denote by <span
class="math inline">\(\mathcal{M}(M)\)</span> (resp. <span
class="math inline">\(\mathcal{M}_c(M)\)</span>) the space of smooth
measures (resp. the space of smooth measures of compact support) on
<span class="math inline">\(M\)</span>.</p>
<p>Let <span class="math inline">\(\phi : M_1 \rightarrow M_2\)</span>
be an isomorphism of manifolds. The pushforward map <span
class="math inline">\(\phi_*\)</span> on measures induces isomorphisms
<span class="math inline">\(\phi_* : \mathcal{M}(M_1) \rightarrow
\mathcal{M}(M_2)\)</span>, preserving the compactly-supported subsets.
We write <span class="math display">\[\phi^* := \phi_*^{-1} =
(\phi^{-1})_* : \mathcal{M}(M_2) \rightarrow \mathcal{M}(M_1)\]</span>
for the inverse map. It will be convenient to describe such maps in
local coordinates. In doing so, we may assume that each <span
class="math inline">\(M_i\)</span> is an open subset of some vector
space <span class="math inline">\(V_i\)</span>. Choose Haar measures
<span class="math inline">\(d x\)</span> on <span
class="math inline">\(V_1\)</span> and <span class="math inline">\(d
y\)</span> on <span class="math inline">\(V_2\)</span>. Then, writing
<span class="math inline">\(y = \phi(x)\)</span>, we have <span
class="math display">\[d y = |\phi &#39;(x)| \, d x,\]</span> where
<span class="math inline">\(|\phi &#39;(x)|\)</span> denotes the
normalized absolute value of the Jacobian of <span
class="math inline">\(\phi\)</span> with respect to <span
class="math inline">\(d x\)</span> and <span class="math inline">\(d
y\)</span>; if we identify both <span class="math inline">\(V_1\)</span>
and <span class="math inline">\(V_2\)</span> with <span
class="math inline">\(F^n\)</span> and choose <span
class="math inline">\(d x\)</span> and <span class="math inline">\(d
y\)</span> compatibly, then <span class="math inline">\(|\phi
&#39;(x)|\)</span> is the absolute value of the determinant of the
matrix of partial derivatives. Let <span class="math inline">\(\gamma
\in \mathcal{M}(M_2)\)</span>. We identify <span
class="math inline">\(\gamma\)</span> (resp. <span
class="math inline">\(\phi^* \gamma\)</span>) with a smooth function on
<span class="math inline">\(M_2\)</span> (resp. <span
class="math inline">\(M_1\)</span>) by dividing by the Haar measure
<span class="math inline">\(d y\)</span> (resp. <span
class="math inline">\(d x\)</span>). Then <span id="eq:phi-gammax-=jacobian" class="math display">\[\label{eq:phi-gammax-=jacobian}\tag{6.4}
  \phi^* \gamma(x) = |\phi &#39;(x)| \gamma(\phi(x)).\]</span></p>
<p>In the archimedean case, given a vector field <span
class="math inline">\(X\)</span> on <span
class="math inline">\(M\)</span> and a smooth measure <span
class="math inline">\(\gamma\)</span>, we may define the smooth measure
<span class="math inline">\(X \gamma\)</span> via duality. We explicate
this definition in local coordinates. Suppose that <span
class="math inline">\(M\)</span> is an open subset of <span
class="math inline">\(\mathbb{R}^n\)</span>. Identify <span
class="math inline">\(\gamma\)</span> with a smooth function on <span
class="math inline">\(M\)</span> by dividing by Lebesgue measure. Write
<span class="math inline">\(\nabla_X \gamma\)</span> for the ordinary
derivative of the smooth function <span
class="math inline">\(\gamma\)</span> with respect to <span
class="math inline">\(X\)</span>. Let <span
class="math inline">\(\operatorname{div}X : M \rightarrow
\mathbb{R}\)</span> denote the divergence of <span
class="math inline">\(X\)</span> with respect to the given coordinates.
Then the smooth measure <span class="math inline">\(X \gamma\)</span>,
identified with a smooth function by dividing by Lebesgue measure, is
given by <span class="math display">\[X \gamma = \nabla_X \gamma +
(\operatorname{div}X) \gamma.\]</span> The verification of this identity
is an application of integration by parts.</p>
<p>Let <span class="math inline">\(\rho : M_1 \rightarrow M_2\)</span>
be a submersive morphism of manifolds. Using the implicit function
theorem, we see that the pushforward map <span
class="math inline">\(\rho_*\)</span> on measures induces a surjective
linear map <span class="math display">\[\rho_* : \mathcal{M}_c(M_1)
\rightarrow \mathcal{M}_c(M_2).\]</span></p>
<h4 id="some-nonstandard-formalism">Some nonstandard formalism</h4>
<h5 id="infinitesimal-neighborhoods">Infinitesimal neighborhoods</h5>
<p>Let <span class="math inline">\(X\)</span> be a fixed topological
space (e.g., a fixed manifold <span
class="math inline">\(M\)</span>).</p>
<div class="notation">
<p><strong>Notation 80</strong>. For <span class="math inline">\(x,y \in
X\)</span>, we write <span class="math inline">\(x \simeq y\)</span> to
signify that there is a fixed element <span class="math inline">\(z \in
X\)</span> so that <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> are both contained in each fixed
neighborhood of <span class="math inline">\(z\)</span>.</p>
</div>
<div class="example">
<p><strong>Example 81</strong>. Suppose that <span
class="math inline">\(X\)</span> is a fixed normed space <span
class="math inline">\((X,|.|)\)</span>, so that notation such as <span
class="math inline">\(x \ll y\)</span> and <span class="math inline">\(x
= o(y)\)</span> is defined for <span class="math inline">\(x \in
X\)</span> and <span class="math inline">\(y \in X \cup
\mathbb{R}_{\geqslant 0}\)</span>. Then for <span
class="math inline">\(x,y \in X\)</span> with <span
class="math inline">\(x,y \ll 1\)</span>, the notation <span
class="math inline">\(x \simeq y\)</span> has the same meaning as the
notation <span class="math inline">\(x = y + o(1)\)</span> defined in
§<a href="#sec:asymptotic-notation-overview" data-reference-type="ref"
data-reference="sec:asymptotic-notation-overview">2.1.1</a> and §<a
href="#sec:furth-notat-conv" data-reference-type="ref"
data-reference="sec:furth-notat-conv">2.1.6</a>.</p>
</div>
<div class="notation">
<p><strong>Notation 82</strong>. Let <span
class="math inline">\(p\)</span> belong to some fixed compact subset of
<span class="math inline">\(X\)</span>. We write <span
class="math inline">\(p + o(1)\)</span> for the subclass of <span
class="math inline">\(X\)</span> consisting of all <span
class="math inline">\(x \in X\)</span> for which <span
class="math inline">\(x \simeq p\)</span>. We write “<span
class="math inline">\(x = p + o(1)\)</span>” and “<span
class="math inline">\(x \in p + o(1)\)</span>” synonymously; each of
these has the same meaning as “<span class="math inline">\(x \simeq
p\)</span>.”</p>
</div>
<div class="lemma">
<p><strong>Lemma 83</strong>. The following conditions on an element
<span class="math inline">\(p \in X\)</span> are equivalent:</p>
<ol type="i">
<li><p><span class="math inline">\(p\)</span> belongs to some fixed
compact subset of <span class="math inline">\(X\)</span>.</p></li>
<li><p>There is a fixed element <span class="math inline">\(q \in
X\)</span> with <span class="math inline">\(p \simeq
q\)</span>.</p></li>
</ol>
<p>In that case, the element <span class="math inline">\(q\)</span> is
unique provided that <span class="math inline">\(X\)</span> is
Hausdorff.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This is <a href="#ref-MR469763" class="citation"
data-cites="MR469763">(E. Nelson 1977, Thm 6.1)</a>. ◻</p>
</div>
<p>We refer to the element <span class="math inline">\(q\)</span>, as in
the conclusion of the lemma, as the <em>fixed part</em> of <span
class="math inline">\(p\)</span>. This element has the following
property: a fixed open subset <span class="math inline">\(E\)</span> of
<span class="math inline">\(X\)</span> contains <span
class="math inline">\(q\)</span> if and only if it contains <span
class="math inline">\(p + o(1)\)</span>.</p>
<h5 id="sec:control">§6.2.2. Control</h5>
<p>We may prepend the adjective “fixed” to any of the objects defined
above: “fixed manifold,” “fixed chart,” etc. To allow more flexibility,
we define “controlled” analogues of such objects.</p>
<div id="defn:standard2:emphc-point-manif" class="definition">
<p><strong>Definition 84</strong>. Let <span
class="math inline">\((M,p)\)</span> be a pointed manifold. We say that
<span class="math inline">\((M,p)\)</span> is <em>controlled</em> if</p>
<ul>
<li><p><span class="math inline">\(M\)</span> is fixed, and</p></li>
<li><p><span class="math inline">\(p\)</span> belongs to some fixed
compact subset of <span class="math inline">\(M\)</span>.</p></li>
</ul>
</div>
<p>The terminology applies in particular to pointed vector spaces <span
class="math inline">\((V,p)\)</span>.</p>
<div id="defn:standard2:let-f-controlled-at-p" class="definition">
<p><strong>Definition 85</strong>. Let <span class="math inline">\(f :
V_1 %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
V_2\)</span> be an analytic map between vector spaces. Fix bases for
<span class="math inline">\(V_1, V_2\)</span>, hence norms <span
class="math inline">\(|.|\)</span> as in §<a
href="#sec:analytic-functions" data-reference-type="ref"
data-reference="sec:analytic-functions">1.1.4</a>. Let <span
class="math inline">\(p \in V_1\)</span>. We say that <span
class="math inline">\(f\)</span> is <em>controlled at <span
class="math inline">\(p\)</span></em> if <span
class="math inline">\(f\)</span> is <span
class="math inline">\((C,r)\)</span>-controlled at <span
class="math inline">\(p\)</span>, in the sense of §<a
href="#sec:analytic-functions" data-reference-type="ref"
data-reference="sec:analytic-functions">1.1.4</a>, for some <span
class="math inline">\(C \ll 1\)</span> and <span class="math inline">\(r
\gg 1\)</span>.</p>
</div>
<div id="lem:standard2:sett-defin-refd" class="lemma">
<p><strong>Lemma 86</strong>. In the setting of Definition <a
href="#defn:standard2:let-f-controlled-at-p" data-reference-type="ref"
data-reference="defn:standard2:let-f-controlled-at-p">85</a>, if <span
class="math inline">\(f\)</span> is controlled at <span
class="math inline">\(p\)</span>, then it is controlled at every element
of the form <span class="math inline">\(p + o(1)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemma <a
href="#lem:standard2:elementary-analytic-translate"
data-reference-type="ref"
data-reference="lem:standard2:elementary-analytic-translate">78</a>
(with quantification over <span class="math inline">\(V_1, V_2, |.|, C,
r, r&#39;, r&#39;&#39;, C&#39;\)</span> restricted to fixed
quantities). ◻</p>
</div>
<div id="example:standard2:if-v_1-v_2" class="example">
<p><strong>Example 87</strong>. If <span
class="math inline">\(V_1\)</span>, <span
class="math inline">\(V_2\)</span>, <span
class="math inline">\(f\)</span> and <span
class="math inline">\(p\)</span> are fixed, then <span
class="math inline">\(f\)</span> is controlled at <span
class="math inline">\(p\)</span>. Lemma <a
href="#lem:standard2:sett-defin-refd" data-reference-type="ref"
data-reference="lem:standard2:sett-defin-refd">86</a> implies that the
same conclusion holds more generally if <span
class="math inline">\(p\)</span> belongs to some fixed compact set,
since in that case we have <span class="math inline">\(p = q +
o(1)\)</span> for some fixed <span class="math inline">\(q\)</span>.</p>
</div>
<div id="lem:standard2:controlled-composition" class="lemma">
<p><strong>Lemma 88</strong>. Let <span class="math inline">\(f_1 : V_1
%
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
V_2\)</span> and <span class="math inline">\(f_2 : V_2 %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
V_3\)</span> be defined and controlled at <span
class="math inline">\(p_1\)</span> and <span
class="math inline">\(p_2\)</span>, respectively. Then <span
class="math inline">\(f_2 \circ f_1\)</span> is defined and controlled
at <span class="math inline">\(p_1\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemma <a
href="#lem:standard2:elementary-analytic-compose"
data-reference-type="ref"
data-reference="lem:standard2:elementary-analytic-compose">79</a>. ◻</p>
</div>
<div id="defn:let-v_1-v_2" class="definition">
<p><strong>Definition 89</strong>. We say that a local morphism <span
class="math inline">\(f : (V_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_2, p_2)\)</span> of controlled pointed vector spaces is
<em>controlled</em> if <span class="math inline">\(f\)</span> is defined
and controlled at every element of the form <span
class="math inline">\(p_1 + o(1)\)</span>.</p>
</div>
<div class="remark">
<p><strong>Remark 90</strong>. It is clear that Definition <a
href="#defn:let-v_1-v_2" data-reference-type="ref"
data-reference="defn:let-v_1-v_2">89</a> depends only upon the class
<span class="math inline">\(p_1 + o(1)\)</span> and not the basepoint
<span class="math inline">\(p_1\)</span> itself. The crucial condition
is that <span class="math inline">\(f\)</span> be controlled at
<em>some</em> element of the form <span class="math inline">\(p_1 +
o(1)\)</span>; in that case, the Taylor series for <span
class="math inline">\(f\)</span> at such a point permits us to extend
the definition of <span class="math inline">\(f\)</span> to a region
containing every element of the form <span class="math inline">\(p_1 +
o(1)\)</span>.</p>
</div>
<p>The basic axioms of a category are satisfied (although for
set-theoretic reasons, we will not introduce that language
explicitly):</p>
<div id="lem:identity-map--m-0" class="lemma">
<p><strong>Lemma 91</strong>. The identity map <span
class="math inline">\((V,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,p)\)</span> on a fixed pointed vector space is controlled. The
composition <span class="math inline">\((V_1,p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_2, p_2) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_3, p_3)\)</span> of any pair of controlled local morphisms is
controlled.</p>
</div>
<div class="proof">
<p><em>Proof.</em> The assertion concerning the identity map is clear,
while that concerning compositions follows from Lemma <a
href="#lem:standard2:controlled-composition" data-reference-type="ref"
data-reference="lem:standard2:controlled-composition">88</a>. ◻</p>
</div>
<p>We now extend the above discussion to manifolds. Let <span
class="math inline">\(f : M_1 \rightarrow M_2\)</span> be a morphism
(i.e., analytic map) between manifolds <span
class="math inline">\(M_1\)</span> and <span
class="math inline">\(M_2\)</span>. Thus, for each <span
class="math inline">\(p_1 \in M_1\)</span>, each chart <span
class="math inline">\(c_1 : (M_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_1, 0)\)</span> and each chart <span class="math inline">\(c_2 : (M_2,
f(p_2)) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_2,0)\)</span>, the composition <span
class="math display">\[f_{c_1,c_2} : (V_1,0) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{c_1^{-1}}{}\mathchar&quot;0\hexnumber@\symAMSa
4B {\,}{}}{}%
  }%
(M_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{f}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2, p_2) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{c_2}{}\mathchar&quot;0\hexnumber@\symAMSa
4B {\,}{}}{}%
  }%
(V_2,0)\]</span> is analytic in the sense of §<a
href="#sec:analytic-functions" data-reference-type="ref"
data-reference="sec:analytic-functions">1.1.4</a>.</p>
<div id="defn:standard2:f-controlled-M1-M2" class="definition">
<p><strong>Definition 92</strong>. Let <span class="math inline">\(f :
(M_1,p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2,p_2)\)</span> be a local morphism between controlled point
manifolds. Let <span class="math inline">\(q_1 \in M_1\)</span> and
<span class="math inline">\(q_2 \in M_2\)</span> denote the respective
fixed parts of <span class="math inline">\(p_1\)</span> and <span
class="math inline">\(p_2\)</span>. We say that <span
class="math inline">\(f\)</span> is <em>controlled</em> if</p>
<ol type="i">
<li><p>the domain of <span class="math inline">\(f\)</span> contains
every element of the form <span class="math inline">\(p_1 +
o(1)\)</span>,</p></li>
<li><p>for each <span class="math inline">\(x = p_1 + o(1)\)</span>, we
have <span class="math inline">\(f(x) = p_2 + o(1)\)</span>,
and</p></li>
<li><p>for all fixed charts <span class="math inline">\(c_1 : (M_1,q_1)
%
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_1,0)\)</span> and <span class="math inline">\(c_2 : (M_2, q_2) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_2,0)\)</span>, the map <span class="math inline">\(f_{c_1,c_2} :
(V_1,0) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_2,0)\)</span> as above is controlled at the origin (in the sense of
Definition <a href="#defn:standard2:let-f-controlled-at-p"
data-reference-type="ref"
data-reference="defn:standard2:let-f-controlled-at-p">85</a>).</p></li>
</ol>
</div>
<div id="lem:identity-map-m" class="lemma">
<p><strong>Lemma 93</strong>. The identity map <span
class="math inline">\(M \rightarrow M\)</span> on a fixed manifold is
controlled. Any fixed morphism between fixed manifolds is controlled.
The composition of any pair of controlled morphisms is controlled.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Immediate from the definitions and Lemma <a
href="#lem:identity-map--m-0" data-reference-type="ref"
data-reference="lem:identity-map--m-0">91</a>. ◻</p>
</div>
<div class="definition">
<p><strong>Definition 94</strong>. We say that a controlled local
morphism <span class="math inline">\(f : (M_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2, p_2)\)</span> is a <em>controlled local isomorphism</em> if it
admits an inverse (resp. <span class="math inline">\(g : (M_2, p_2) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_1, M_2)\)</span> that is a controlled local morphism; such an inverse
is then unique and denoted <span
class="math inline">\(f^{-1}\)</span>.</p>
</div>
<div class="definition">
<p><strong>Definition 95</strong>. Given a controlled pointed manifold
<span class="math inline">\((M,p)\)</span> and a fixed vector space
<span class="math inline">\(V\)</span>, a <em>controlled chart</em>
<span class="math inline">\(c : (M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,0)\)</span> is a chart that defines a controlled local
isomorphism.</p>
</div>
<div id="lem:families-controlled-maps" class="lemma">
<p><strong>Lemma 96</strong>. Let <span
class="math inline">\((X,x_0),(Y,y_0),(Z,z_0)\)</span> be controlled
pointed manifolds. Let <span class="math inline">\(\phi : X \times Z
\rightarrow Y\)</span> a fixed analytic map with <span
class="math inline">\(\phi(x_0,z_0) = y_0\)</span>. Then for each <span
class="math inline">\(z \in Z\)</span> with <span
class="math inline">\(z \simeq z_0\)</span>, we have <span
class="math inline">\(\phi(x_0,z) \simeq y_0\)</span>, and the map <span
class="math display">\[\phi_z : (X,x_0) \rightarrow
(Y,\phi(x_0,z))\]</span> <span class="math display">\[x \mapsto
\phi(x,z)\]</span> defines a controlled local morphism.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We can reduce to the case that <span
class="math inline">\(X,Y,Z\)</span> are vector spaces with <span
class="math inline">\(x_0,y_0,z_0\)</span> of the form <span
class="math inline">\(o(1)\)</span>, say. Since <span
class="math inline">\(\phi\)</span> is fixed and analytic, we may write,
for <span class="math inline">\((x,z) \in X \times Z\)</span> with <span
class="math inline">\(x,z = o(1)\)</span>, <span
class="math display">\[\phi_z(x) = \phi(x,z) = \sum_{\alpha,\beta}
c_{\alpha,\beta} x^\alpha z^\beta\]</span> where <span
class="math inline">\(|c_{\alpha, \beta}| \leqslant C r^{-|\alpha| -
|\beta|}\)</span> for some <span class="math inline">\(C \ll 1\)</span>
and <span class="math inline">\(r \gg 1\)</span>. Thus <span
class="math display">\[\phi_z(x) = \sum_{\alpha} c_\alpha(z) x^\alpha,
\quad
    c_\alpha(z) := \sum_{\beta} c_{\alpha,\beta} z^\beta.\]</span> Since
<span class="math inline">\(z = o(1)\)</span>, we have <span
class="math inline">\(\sum_{\beta} r^{-|\beta|} |z^\beta| \ll
1\)</span>, hence <span class="math inline">\(c_\alpha(z) \ll
r^{-|\alpha|}\)</span>. Thus <span class="math inline">\(\phi_z\)</span>
is controlled at <span class="math inline">\(x\)</span>, as
required. ◻</p>
</div>
<h5 id="sec:distances">§6.2.3. Distances</h5>
<div id="defn:standard2:let-m-p-distances" class="definition">
<p><strong>Definition 97</strong>. Let <span
class="math inline">\((M,p)\)</span> be a controlled pointed manifold,
with <span class="math inline">\(p\)</span> having fixed part <span
class="math inline">\(q\)</span>. Let <span class="math inline">\(c :
(M,q) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,0)\)</span> be a fixed chart. Let <span
class="math inline">\(|.|\)</span> be a fixed norm on <span
class="math inline">\(V\)</span>. We then define, for any <span
class="math inline">\(x,y \in M\)</span> of the form <span
class="math inline">\(x,y = p + o(1)\)</span> (equivalently, <span
class="math inline">\(q + o(1)\)</span>) the distance <span
class="math inline">\({\mathop{\mathrm{dist}}}_{c,|.|}(x,y)\)</span> to be
<span class="math inline">\(|c(x) - c(y)|\)</span>.</p>
</div>
<div class="lemma">
<p><strong>Lemma 98</strong>. In the context of Definition <a
href="#defn:standard2:let-m-p-distances" data-reference-type="ref"
data-reference="defn:standard2:let-m-p-distances">97</a>, for any two
fixed choices <span class="math inline">\(c_i, |.|_i\)</span> (<span
class="math inline">\(i=1,2\)</span>) of fixed charts <span
class="math inline">\(c_i : (M, q) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_i,0)\)</span> and fixed norms <span
class="math inline">\(|.|_i\)</span> on <span
class="math inline">\(V\)</span>, we have <span
class="math inline">\({\mathop{\mathrm{dist}}}_{c_1,|.|_1}(x,y) \asymp
{\mathop{\mathrm{dist}}}_{c_2,|.|_2}(x,y)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> The proof is carried out in a more general setting,
below, in the proof of Lemma <a
href="#lem:controlled-uniform-continuity-origin"
data-reference-type="ref"
data-reference="lem:controlled-uniform-continuity-origin">99</a>. ◻</p>
</div>
<p>We henceforth write <span
class="math inline">\({\mathop{\mathrm{dist}}}_M\)</span>, or <span
class="math inline">\(\mathop{\mathrm{dist}}\)</span> for short, for
some function of the form <span
class="math inline">\({\mathop{\mathrm{dist}}}_{c,|.|}\)</span> as above,
which is thus “essentially well-defined.” In particular, for <span
class="math inline">\(C \ll 1\)</span> or <span
class="math inline">\(\varepsilon\lll 1\)</span>, the conditions “<span
class="math inline">\(\mathop{\mathrm{dist}}(x,y) \lll C\)</span>” and
“<span class="math inline">\(\mathop{\mathrm{dist}}(x,y) \ll
\varepsilon\)</span>” are well-defined, i.e., independent of the choice
of <span class="math inline">\((c,|.|)\)</span>. The same conditions
will often be denoted respectively by <span class="math display">\[x = y
+ o(C), \quad x = y + \operatorname{O}(\varepsilon).\]</span></p>
<p>Similar definitions apply to elements of <span
class="math inline">\(T_p^*(M)\)</span> and <span
class="math inline">\(T_p^\wedge(M)\)</span>. For example, given <span
class="math inline">\(C \geqslant 0\)</span> and <span
class="math inline">\(\theta \in T_p^\wedge(M)\)</span>, we say that
<span class="math inline">\(\theta \ll C\)</span> if for some
(equivalently, any) controlled chart <span class="math inline">\(c :
(M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,0)\)</span>, the following condition holds. Let <span
class="math inline">\(c_* \theta \in T_{c(p)}^\wedge(V)\)</span> denote
the pushforward of <span class="math inline">\(\theta\)</span>. Using
the standard identification of <span class="math inline">\(T_{c(p)}
V\)</span> with <span class="math inline">\(V\)</span>, we may identify
<span class="math inline">\(c_* \theta\)</span> with an element of <span
class="math inline">\(V^\wedge\)</span>. Then, with respect to some
(equivalently, any) fixed norm <span class="math inline">\(|.|\)</span>
on <span class="math inline">\(V^\wedge\)</span>, we have <span
class="math inline">\(|c_* \theta| \ll C\)</span>.</p>
<p>Controlled morphisms satisfy a uniform Lipschitz condition.</p>
<div id="lem:controlled-uniform-continuity-origin" class="lemma">
<p><strong>Lemma 99</strong>. Let <span class="math inline">\(f : (M_1,
p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2, p_2)\)</span> be a controlled local morphism between controlled
pointed manifolds. Then for all <span class="math inline">\(x,y \in
M_1\)</span> with <span class="math inline">\(x,y \simeq p_1\)</span>,
we have <span class="math display">\[\mathop{\mathrm{dist}}(f(x), f(y))
\ll \mathop{\mathrm{dist}}(x,y).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Passing to local coordinates, we reduce to the case
that each <span class="math inline">\(M_i\)</span> is a vector space
<span class="math inline">\(V_i\)</span>. It is enough to show then that
for all <span class="math inline">\(x, y \in V_1\)</span> with <span
class="math inline">\(x, y = o(1)\)</span>, we have <span id="eq:fp_1-+-x" class="math display">\[\label{eq:fp_1-+-x}\tag{6.5}
    f(p_1 + x) - f(p_1 + y) \ll x - y.\]</span> We note that, per the
above discussion, the precise meaning of <a href="#eq:fp_1-+-x"
data-reference-type="eqref"
data-reference="eq:fp_1-+-x">\((6.5)\)</a> is that the estimate
<span class="math display">\[|f(p_1 + x) - f(p_1 + y)|_2 \ll |x -
y|_1\]</span> holds for some (equivalently, any) fixed norms <span
class="math inline">\(|.|_1\)</span> and <span
class="math inline">\(|.|_2\)</span> on <span
class="math inline">\(V_1\)</span> and <span
class="math inline">\(V_2\)</span>.</p>
<p>Writing <span class="math inline">\(c_\alpha \in V_2\)</span> (<span
class="math inline">\(\alpha \in \mathbb{Z}_{\geqslant
0}^{\dim(V_1)}\)</span>) for the Taylor coefficients of <span
class="math inline">\(f\)</span> at <span
class="math inline">\(p\)</span>, we have <span
class="math display">\[f(p_1 + x) - f(p_2 + y) = \sum_{|\alpha|
\geqslant 1} c_\alpha (x^\alpha - y^\alpha).\]</span> Fix a norm <span
class="math inline">\(|.|\)</span> on <span
class="math inline">\(V_1\)</span>, and choose <span
class="math inline">\(\varepsilon&gt; 0\)</span> with <span
class="math inline">\(\varepsilon= o(1)\)</span> so that <span
class="math inline">\(|x|, |y| \leqslant\varepsilon\)</span>. Any
difference of monomials <span class="math inline">\(x^\alpha -
y^\alpha\)</span> with <span class="math inline">\(|\alpha| \geqslant
1\)</span> is divisible by some difference of coordinates <span
class="math inline">\(x_i - y_i\)</span>. The resulting quotient
polynomial consists is a sum of <span
class="math inline">\(\operatorname{O}(|\alpha|)\)</span> many
monomials, each of degree <span class="math inline">\(|\alpha|
-1\)</span>, and with coefficients of size <span
class="math inline">\(\operatorname{O}(1)\)</span>. Thus <span
class="math display">\[x^\alpha - y^\alpha \ll |\alpha| |x-y|
\varepsilon^{|\alpha| - 1}.\]</span> Using that <span
class="math inline">\(c_\alpha \ll \exp(C_1 |\alpha|)\)</span> with
<span class="math inline">\(C_1 \ll 1\)</span>, we deduce that <span
class="math display">\[f (p_1 + x) - f (p_2 + y) \ll |x-y| \sum
_{|\alpha| \geqslant 1} |\alpha|
(\varepsilon\exp(C_1))^{|\alpha|-1}.\]</span> This last sum may be
bounded by a product of convergent geometric series, of size <span
class="math inline">\(\operatorname{O}(1)\)</span>. ◻</p>
</div>
<div id="lem:standard:let-phi-controlled-dist-preserve"
class="corollary">
<p><strong>Corollary 100</strong>. <em>Let <span class="math inline">\(f
: (M_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2, p_2)\)</span> be a controlled local isomorphism between controlled
pointed manifolds. Then for all <span class="math inline">\(x,y \in
M_1\)</span> with <span class="math inline">\(x,y \simeq p_1\)</span>,
we have <span class="math display">\[\mathop{\mathrm{dist}}(f(x), f(y))
\asymp \mathop{\mathrm{dist}}(x,y).\]</span></em></p>
</div>
<h5 id="bumps">Bumps</h5>
<div id="item:epsilon-bump-3" class="definition">
<p><strong>Definition 101</strong>. Let <span
class="math inline">\(V\)</span> be a fixed vector space. Let <span
class="math inline">\(p \in V\)</span>. Let <span
class="math inline">\(\varepsilon&gt; 0\)</span> with <span
class="math inline">\(\varepsilon\lll 1\)</span>. We say that a smooth
function <span class="math inline">\(\gamma\)</span> on <span
class="math inline">\(V\)</span> is an <em><span
class="math inline">\(\varepsilon\)</span>-bump at <span
class="math inline">\(p\)</span></em> if it satisfies the following
conditions.</p>
<ol type="i">
<li><p><span class="math inline">\(\gamma\)</span> is supported on <span
class="math inline">\(p + o(1)\)</span>.</p></li>
<li><p>In the non-archimedean case, we require that <span
class="math display">\[\|\gamma\|_\infty \ll
\varepsilon^{-\dim(V)}\]</span> and that, for all <span
class="math inline">\(x, u \in V\)</span>, <span
class="math display">\[\begin{align}
    \gamma(x) \neq 0 &amp;\implies x - p \ll  \varepsilon, \\
    u \lll \varepsilon&amp;\implies \gamma(x+u) = \gamma(x).
  
\end{align}\]</span></p></li>
<li><p>In the archimedean case, we require that for all fixed <span
class="math inline">\(k,m \in \mathbb{Z}_{\geqslant 0}\)</span>, fixed
vector fields <span class="math inline">\(X_1,\dotsc,X_m\)</span> on
<span class="math inline">\(V\)</span>, and all <span
class="math inline">\(x \in V\)</span> (with <span
class="math inline">\(x = p + o(1)\)</span>), we have <span id="eq:y_1-dotsb-y_m" class="math display">\[\label{eq:y_1-dotsb-y_m}\tag{6.6}
    X_1 \dotsb X_m \gamma(x)
    \ll \varepsilon^{-(\dim(V) + m)} \left( 1 +
\frac{|x-p|}{\varepsilon} \right)^{-k}.\]</span></p></li>
</ol>
<p>Similarly, we say that a smooth measure <span
class="math inline">\(\gamma\)</span> on <span
class="math inline">\(V\)</span> is an <em><span
class="math inline">\(\varepsilon\)</span>-bump at <span
class="math inline">\(p\)</span></em> if the smooth function obtained by
dividing <span class="math inline">\(\gamma\)</span> by a fixed Haar
measure is an <span class="math inline">\(\varepsilon\)</span>-bump in
the above sense.</p>
</div>
<div class="remark">
<p><strong>Remark 102</strong>. The formulation of condition <a
href="#item:epsilon-bump-3" data-reference-type="eqref"
data-reference="item:epsilon-bump-3">\((iii)\)</a> is
convenient because when we pass to the setting of (fixed) manifolds,
“(fixed) vector fields” has an intrinsic meaning, independent of
coordinate charts. For computations, it is convenient to note the
following reformulation of that condition: for each fixed <span
class="math inline">\(k \in \mathbb{Z}_{\geqslant 0}\)</span> and
multi-index <span class="math inline">\(\alpha\)</span> for <span
class="math inline">\(V_1\)</span>, we have <span id="eq:part-gamm-ll" class="math display">\[\label{eq:part-gamm-ll}\tag{6.7}
  \partial^\alpha \gamma(x) \ll \varepsilon^{ -(\dim (V) +
|\alpha|)}  \left( 1 + \frac{|x-p|}{\varepsilon} \right)^{-k}.\]</span>
The equivalence between the two formulations follows from the product
rule for derivatives.</p>
</div>
<div id="lem:let-v_1-v_2" class="lemma">
<p><strong>Lemma 103</strong>. Let <span
class="math inline">\(V_1\)</span> and <span
class="math inline">\(V_2\)</span> be fixed vector spaces. Let <span
class="math inline">\(p_1 \in V_1\)</span> and <span
class="math inline">\(p_2 \in V_2\)</span>. Let <span
class="math inline">\(\phi : (V_1,p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V_2,p_2)\)</span> be a controlled local isomorphism. Then pushforward
and pullback under <span class="math inline">\(\phi\)</span> induce
mutually inverse bijective class maps <span id="eq:lefttexteps-bumps-at" class="math display">\[\label{eq:lefttexteps-bumps-at}\tag{6.8}
    \left\{\text{$\varepsilon$-bumps at $p_1$} \right\}
    \leftrightarrow
    \left\{\text{$\varepsilon$-bumps at $p_2$} \right\},\]</span> either
in the sense of functions or measures.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Consider first the case of functions. Let <span
class="math inline">\(\gamma_2\)</span> be an <span
class="math inline">\(\varepsilon\)</span>-bump function at <span
class="math inline">\(p_2\)</span>. Let <span
class="math inline">\(\gamma_1\)</span> denote the pullback of <span
class="math inline">\(\gamma_2\)</span> under <span
class="math inline">\(\phi\)</span>, i.e., the function supported on
<span class="math inline">\(p_1 + o(1)\)</span> and given there by <span
class="math inline">\(\gamma_1(x) := \gamma_2(\phi(x))\)</span>. Since
<span class="math inline">\(\phi\)</span> is controlled, all of its
fixed partial derivatives are of size <span
class="math inline">\(\operatorname{O}(1)\)</span>. By the chain rule,
it follows that condition <a href="#eq:part-gamm-ll"
data-reference-type="eqref"
data-reference="eq:part-gamm-ll">\((6.7)\)</a> for <span
class="math inline">\(\gamma_2\)</span> implies the same condition for
<span class="math inline">\(\gamma_1\)</span>. Therefore <span
class="math inline">\(\gamma_1\)</span> is an <span
class="math inline">\(\varepsilon\)</span>-bump at <span
class="math inline">\(p_1\)</span>. The same argument applied to <span
class="math inline">\(\phi^{-1}\)</span> yields the required
bijection.</p>
<p>For the case of measures, we use the formula <a
href="#eq:phi-gammax-=jacobian" data-reference-type="eqref"
data-reference="eq:phi-gammax-=jacobian">\((6.4)\)</a>
expressing the pullback in terms of the Jacobian <span
class="math inline">\(|\phi &#39;(x)|\)</span>. Since <span
class="math inline">\(\phi\)</span> is controlled, that Jacobian and its
first partial derivatives are of size <span
class="math inline">\(\operatorname{O}(1)\)</span>. The proof is
otherwise as in the case of functions. ◻</p>
</div>
<p>We now extend to manifolds:</p>
<div id="defn:let-m-p-1" class="definition">
<p><strong>Definition 104</strong>. Let <span
class="math inline">\((M,p)\)</span> be a controlled pointed manifold.
Let <span class="math inline">\(\varepsilon\lll 1\)</span>. By an
<em><span class="math inline">\(\varepsilon\)</span>-bump at <span
class="math inline">\(p\)</span></em>, we mean a smooth measure <span
class="math inline">\(\gamma\)</span> on <span
class="math inline">\(M\)</span>, supported on <span
class="math inline">\(p + o(1)\)</span>, such that for some controlled
chart <span class="math inline">\(c : (M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,0)\)</span>, the pushforward <span class="math inline">\(c_*
\gamma\)</span> is an <span
class="math inline">\(\varepsilon\)</span>-bump at <span
class="math inline">\(0\)</span>.</p>
</div>
<div class="remark">
<p><strong>Remark 105</strong>. We could just a well make the analogous
definition for functions, or more generally for sections of fixed
bundles, but in what follows, we require only the given definition
concerning measures.</p>
</div>
<div class="lemma">
<p><strong>Lemma 106</strong>. If the hypotheses of Definition <a
href="#defn:let-m-p-1" data-reference-type="ref"
data-reference="defn:let-m-p-1">104</a> hold for some <span
class="math inline">\(c\)</span>, then they hold for all <span
class="math inline">\(c\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemma <a href="#lem:let-v_1-v_2"
data-reference-type="ref"
data-reference="lem:let-v_1-v_2">103</a>. ◻</p>
</div>
<div id="lem:standard2:any-controlled-local" class="lemma">
<p><strong>Lemma 107</strong>. Any controlled local isomorphism of
pointed manifolds <span class="math inline">\(\rho : (M_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2, p_2)\)</span> induces a bijective class map of <span
class="math inline">\(\varepsilon\)</span>-bumps as in <a
href="#eq:lefttexteps-bumps-at" data-reference-type="eqref"
data-reference="eq:lefttexteps-bumps-at">\((6.8)\)</a>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Immediate from the definitions, since (by Lemma <a
href="#lem:identity-map-m" data-reference-type="ref"
data-reference="lem:identity-map-m">93</a>) controlled charts for <span
class="math inline">\((M_1,p_1)\)</span> and <span
class="math inline">\((M_2,p_2)\)</span> correspond to one another via
<span class="math inline">\(\rho\)</span>. ◻</p>
</div>
<div id="lem:standard2:bump-preserved-under-vector-field" class="lemma">
<p><strong>Lemma 108</strong>. Assume that <span class="math inline">\(F
= \mathbb{R}\)</span>. Let <span class="math inline">\(X\)</span> be a
fixed vector field on <span class="math inline">\(M\)</span>. Let <span
class="math inline">\(\gamma\)</span> be an <span
class="math inline">\(\varepsilon\)</span>-bump on <span
class="math inline">\(M\)</span> at <span
class="math inline">\(p\)</span>. Then <span
class="math inline">\(\varepsilon X \gamma\)</span> is also an <span
class="math inline">\(\varepsilon\)</span>-bump on <span
class="math inline">\(M\)</span> at <span
class="math inline">\(p\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Immediate from the definition (especially <a
href="#eq:y_1-dotsb-y_m" data-reference-type="eqref"
data-reference="eq:y_1-dotsb-y_m">\((6.6)\)</a>). ◻</p>
</div>
<div id="lem:standard2:let-f-vanish-at-p-eps-bump" class="lemma">
<p><strong>Lemma 109</strong>. Assume that <span class="math inline">\(F
= \mathbb{R}\)</span>. Let <span class="math inline">\(f : M \rightarrow
\mathbb{C}\)</span> be a smooth function that vanishes at <span
class="math inline">\(p\)</span> and has the property that its image
under any fixed differential operator has size <span
class="math inline">\(\operatorname{O}(1)\)</span> on <span
class="math inline">\(p + o(1)\)</span>. Let <span
class="math inline">\(\gamma\)</span> be an <span
class="math inline">\(\varepsilon\)</span>-bump on <span
class="math inline">\(M\)</span> at <span
class="math inline">\(p\)</span>. Then <span
class="math inline">\(\varepsilon^{-1} f \gamma\)</span> is also an
<span class="math inline">\(\varepsilon\)</span>-bump on <span
class="math inline">\(M\)</span> at <span
class="math inline">\(p\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We may assume that <span
class="math inline">\(M\)</span> is a vector space <span
class="math inline">\(V\)</span>. After dividing by a fixed Haar
measure, it will suffice to consider the variant problem in which <span
class="math inline">\(\gamma\)</span> is an <span
class="math inline">\(\varepsilon\)</span>-bump function (rather than a
measure). We must check then that for each fixed multi-index <span
class="math inline">\(\alpha\)</span>, fixed <span
class="math inline">\(k \in \mathbb{Z}_{\geqslant 0}\)</span> and all
<span class="math inline">\(x = p + o(1)\)</span>, <span id="eq:partialalpha-eps-1" class="math display">\[\label{eq:partialalpha-eps-1}\tag{6.9}
    \partial^\alpha (\varepsilon^{-1} f  \gamma)(x) \ll \varepsilon^{
-(\dim (V) + |\alpha|)}  \left( 1 + \frac{|x-p|}{\varepsilon}
\right)^{-k}.\]</span> Our hypotheses on <span
class="math inline">\(f\)</span> imply that <span
class="math display">\[f(x) \ll |x - p| \ll \varepsilon\left( 1 +
\frac{|x-p|}{\varepsilon} \right)\]</span> and, for <span
class="math inline">\(|\alpha| \geqslant 1\)</span>, <span
class="math display">\[\partial^\alpha f(x) \ll 1.\]</span> Using these
estimates, the product rule for differentiation and <a
href="#eq:part-gamm-ll" data-reference-type="eqref"
data-reference="eq:part-gamm-ll">\((6.7)\)</a>, the required
estimate <a href="#eq:partialalpha-eps-1" data-reference-type="eqref"
data-reference="eq:partialalpha-eps-1">\((6.9)\)</a>
follows. ◻</p>
</div>
<h4 id="sec:class-bumps">§6.3. Modulated bumps on manifolds</h4>
<h5 id="basic-definition">Basic definition</h5>
<div id="defn:standard2:given-point-manif" class="definition">
<p><strong>Definition 110</strong>. Given a pointed manifold <span
class="math inline">\((M,p)\)</span>, a chart <span
class="math inline">\(c\)</span> as in <a href="#eq:c-:-m"
data-reference-type="eqref" data-reference="eq:c-:-m">\((6.3)\)</a> and
an element <span class="math inline">\(\theta \in
T_p^\wedge(M)\)</span>, we denote by <span
class="math display">\[\psi_{\theta,c} : M %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
\mathop{\mathrm{U}}(1)\]</span> the local map, defined at <span
class="math inline">\(p\)</span>, given by <span class="math inline">\(x
\mapsto \psi_\theta(c(x))\)</span>.</p>
</div>
<div id="lem:standard2:bumps-modulated-become-bumps" class="lemma">
<p><strong>Lemma 111</strong>. Let <span class="math inline">\((M,
p)\)</span> be a controlled pointed manifold. Let <span
class="math inline">\(\theta_1, \theta_2 \in T_p^\wedge(M)\)</span> and
<span class="math inline">\(\varepsilon&gt; 0\)</span> with <span
class="math inline">\(\varepsilon\lll 1\)</span> and <span id="eq:epsth-thet-ll" class="math display">\[\label{eq:epsth-thet-ll}\tag{6.10}
    \varepsilon|\theta_1 - \theta_2| \ll 1, \quad
    \varepsilon^2 |\theta_1| \ll 1,
    \quad
    \varepsilon^2 |\theta_2| \ll 1.\]</span> Let <span
class="math inline">\(\gamma\)</span> be an <span
class="math inline">\(\varepsilon\)</span>-bump at <span
class="math inline">\(p\)</span>. Let <span
class="math inline">\(c_1\)</span> and <span
class="math inline">\(c_2\)</span> be controlled charts <span
class="math inline">\(c_i : (M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(T_p(M), 0)\)</span>. Then <span id="eq:psi_theta_1-c_1-1" class="math display">\[\label{eq:psi_theta_1-c_1-1}\tag{6.11}
    \psi_{\theta_1,c_1}^{-1} \psi_{\theta_2, c_2} \gamma
    \quad
    \text{ and }
    \quad
    \psi_{\theta_2,c_2}^{-1} \psi_{\theta_1, c_1} \gamma\]</span> are
<span class="math inline">\(\varepsilon\)</span>-bumps at <span
class="math inline">\(p\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By symmetry, it suffices to show that the first
quantity in <a href="#eq:psi_theta_1-c_1-1" data-reference-type="eqref"
data-reference="eq:psi_theta_1-c_1-1">\((6.11)\)</a> is an
<span class="math inline">\(\varepsilon\)</span>-bump. By applying a
controlled chart, we may reduce to the case that <span
class="math inline">\((M,p) = (V,0)\)</span> for a fixed vector space
<span class="math inline">\(V\)</span>. We may assume then that <span
class="math inline">\(c_1\)</span> is the identity, while <span
class="math inline">\(c_2\)</span> is some controlled morphism <span
class="math inline">\(\phi : (V,0) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,0)\)</span> with <span id="eq:phi0-=-0" class="math display">\[\label{eq:phi0-=-0}\tag{6.12}
    \phi(0) = 0, \quad \phi &#39;(0) = \text{identity}.\]</span> Then
<span class="math display">\[\varphi(x) := \psi_{\theta_1,c_1}^{-1}(x)
\psi_{\theta_2,c_2}(x) = \psi_{\theta_2}(\phi(x))
\psi_{\theta_1}^{-1}(x).\]</span> It is clear that <span
class="math inline">\(\varphi \gamma\)</span> satisfies the same support
condition as <span class="math inline">\(\gamma\)</span>. Our task
reduces to verifying the following:</p>
<ul>
<li><p>In the non-archimedean case, for <span class="math inline">\(x
\in V\)</span> with <span class="math inline">\(x \lll
\varepsilon\)</span>, we have <span class="math display">\[\varphi(x) =
1.\]</span></p></li>
<li><p>In the archimedean case, for each fixed multi-index <span
class="math inline">\(\alpha\)</span> and each <span
class="math inline">\(x \in V\)</span> with <span
class="math inline">\(x \lll 1\)</span>, we have <span id="eq:part-varphi-x" class="math display">\[\label{eq:part-varphi-x}\tag{6.13}
      \partial^{\alpha} \varphi (x)
      \ll \varepsilon^{-|\alpha|} \left( 1 + \frac{|x|}{\varepsilon}
\right)^{\operatorname{O}(1)}.\]</span></p></li>
</ul>
<p>Consider first the non-archimedean case. Let <span
class="math inline">\(x \lll 1\)</span>. Since <span
class="math inline">\(\phi\)</span> is controlled at <span
class="math inline">\(0\)</span>, we have <span
class="math inline">\(\phi(x) = \phi(0) + \phi &#39;(0) x +
\operatorname{O}(|x|^2)\)</span>. Assuming further that <span
class="math inline">\(x \lll \varepsilon\)</span>, we deduce from <a
href="#eq:phi0-=-0" data-reference-type="eqref"
data-reference="eq:phi0-=-0">\((6.12)\)</a> that <span
class="math inline">\(\phi(x) = x + o(\varepsilon^2)\)</span>. Since
<span class="math inline">\(\varepsilon^2 \theta_2 \ll 1\)</span>, it
follows that <span class="math inline">\(\psi_{\theta_2}(\phi(x)) =
\psi_{\theta_2}(x)\)</span>. Therefore <span
class="math inline">\(\varphi(x) = \psi_{\theta_2 -
\theta_1}(x)\)</span>. On the other hand, since <span
class="math inline">\(\varepsilon|\theta_1 - \theta_2| \ll 1\)</span>,
we have <span class="math inline">\(|x| \cdot |\theta_1 - \theta_2| \lll
1\)</span>. Therefore <span class="math inline">\(\varphi(x) =
1\)</span>, as required.</p>
<p>We turn to the archimedean case. By definition, <span
class="math display">\[\varphi(x) = \exp(\Phi(x)), \quad
    \Phi(x) := \left\langle \theta_2, \phi(x) \right\rangle -
\left\langle \theta_1, x \right\rangle.\]</span> Since <span
class="math inline">\(\Phi\)</span> is imaginary-valued, we may reduce
via the chain rule to verifying the analogue of <a
href="#eq:part-varphi-x" data-reference-type="eqref"
data-reference="eq:part-varphi-x">\((6.13)\)</a> for <span
class="math inline">\(\Phi\)</span>. Let <span class="math inline">\(x
\lll 1\)</span>. Since <span class="math inline">\(\phi\)</span> is
controlled, we have <span class="math display">\[\Phi(x) = \langle
\theta_2 - \theta_1, x \rangle +
\operatorname{O}(\max(|\theta_1|,|\theta_2|) |x|^2),\]</span> thus <span
class="math display">\[\begin{align}
    \Phi(x)
    &amp;\lll
    | \theta_1 - \theta_2| \, |x| +
    \max(|\theta_1|, |\theta_2|) |x|^2 \\
    &amp;\leqslant
    \varepsilon| \theta_1 - \theta_2|  \left( 1 +
\frac{|x|}{\varepsilon} \right)
    +
    \varepsilon^2 \max(|\theta_1|, |\theta_2|)
      \left( 1 + \frac{|x|}{\varepsilon} \right)^2.
  
\end{align}\]</span> The required bound <a href="#eq:part-varphi-x"
data-reference-type="eqref"
data-reference="eq:part-varphi-x">\((6.13)\)</a> in the case
<span class="math inline">\(\alpha = 0\)</span> thus follows from our
hypothesis <a href="#eq:epsth-thet-ll" data-reference-type="eqref"
data-reference="eq:epsth-thet-ll">\((6.10)\)</a>. Suppose next
that <span class="math inline">\(|\alpha| = 1\)</span>. Then, using
again that <span class="math inline">\(\phi\)</span> is controlled, we
obtain <span class="math display">\[\begin{align}
    \partial^\alpha \Phi(x)
    &amp;\ll |\theta_1 - \theta_2| + \max(|\theta_1|,|\theta_2|) |x| \\
    &amp;\ll \varepsilon^{-1} \left(
       \varepsilon|\theta_1 - \theta_2| +
      \varepsilon^2 \max(|\theta_1|,|\theta_2|) \left( 1 +
\frac{x}{|\varepsilon|} \right) \right),
  
\end{align}\]</span> and we may conclude as in the <span
class="math inline">\(\alpha = 0\)</span> case. Finally, for fixed <span
class="math inline">\(\alpha\)</span> with <span
class="math inline">\(|\alpha| \geqslant 2\)</span>, we have <span
class="math display">\[\partial^\alpha \Phi(x)
    \ll \max(|\theta_1|, |\theta_2|) \ll \varepsilon^{-2},\]</span>
which is at least as good as the required estimate. ◻</p>
</div>
<div id="defn:standard:let-v-be" class="definition">
<p><strong>Definition 112</strong>. Let <span
class="math inline">\((M,p)\)</span> be a controlled pointed manifold.
Given <span class="math inline">\(\theta \in T_p^\wedge(M)\)</span> with
<span class="math inline">\(\theta \ll 1\)</span>, <span
class="math inline">\(T \in F\)</span> with <span
class="math inline">\(|T| \ggg 1\)</span>, <span
class="math inline">\(\delta \in (0,1/2]\)</span> fixed, and a
controlled chart <span class="math inline">\(c : (M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(T_p(M),0)\)</span>, we define <span
class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)_c\)</span> to
consist of all smooth measures <span
class="math inline">\(\gamma\)</span> on <span
class="math inline">\(M\)</span>, supported on <span
class="math inline">\(p + o(1)\)</span>, for which <span
class="math inline">\(\psi_{T \theta,c}^{-1} \gamma\)</span> is a <span
class="math inline">\(|T|^{\delta-1}\)</span>-bump at <span
class="math inline">\(p\)</span>, and, in the archimedean case, for
which <span class="math inline">\(\gamma\)</span> is in fact supported
on <span class="math inline">\(p +
\operatorname{O}(|T|^{\delta_+-1})\)</span> for some fixed element <span id="eq:delt-in-beginc-1" class="math display">\[\label{eq:delt-in-beginc-1}\tag{6.14}
  \delta_+ \in \begin{cases}
    (\delta,1/2) &amp; \text{ if } \delta &lt; 1/2, \\
    \{1/2\} &amp; \text{ if } \delta = 1/2.
  \end{cases}\]</span></p>
</div>
<div class="remark">
<p><strong>Remark 113</strong>. Informally, an element of the class
<span class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)\)</span>
is an approximate modulated delta mass, concentrated on elements of the
form <span class="math inline">\(p +
\operatorname{O}(|T|^{1-\delta})\)</span> and oscillating there with
frequency <span class="math inline">\(\theta\)</span>.</p>
<p>The support condition in the archimedean case may seem artificial. It
is motivated by two considerations. On the one hand, we want to retain
some absolute control over the support of <span
class="math inline">\(\gamma\)</span>, which is more convenient in
practice than the decay condition <a href="#eq:y_1-dotsb-y_m"
data-reference-type="eqref"
data-reference="eq:y_1-dotsb-y_m">\((6.6)\)</a> alone. On the
other hand, we will eventually produce and study <span
class="math inline">\(\gamma\)</span> via truncated Fourier transforms
(§<a href="#sec:quant-prel" data-reference-type="ref"
data-reference="sec:quant-prel">5.2</a>); it will be useful then to
truncate to <span class="math inline">\(p +
\operatorname{O}(|T|^{\delta_+-1})\)</span>, rather than to the smallest
possible range <span class="math inline">\(p +
\operatorname{O}(|T|^{\delta-1})\)</span>, so that the truncation has a
truly negligible effect rather than merely a small effect.</p>
</div>
<div id="lem:standard2:class-mathfrakcm-p" class="proposition">
<p><strong>Proposition 114</strong>. <em>The class <span
class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)_c\)</span> given
by Definition <a href="#defn:standard:let-v-be"
data-reference-type="ref"
data-reference="defn:standard:let-v-be">112</a> is independent of the
choice of <span class="math inline">\(c\)</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline">\(c_1, c_2 : (M, p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(T_p(M),0)\)</span> be controlled charts. Let <span
class="math inline">\(\gamma\)</span> be an element of <span
class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)_{c_1}\)</span>,
so that <span class="math inline">\(\gamma\)</span> satisfies the stated
support conditions and has the property that its multiple <span
class="math inline">\(\psi_{T \theta,c_1}^{-1} \gamma\)</span> is a
<span class="math inline">\(|T|^{\delta-1}\)</span>-bump at <span
class="math inline">\(p\)</span>. We apply Lemma <a
href="#lem:standard2:bumps-modulated-become-bumps"
data-reference-type="ref"
data-reference="lem:standard2:bumps-modulated-become-bumps">111</a> with
<span class="math inline">\(\varepsilon:= |T|^{\delta-1}\)</span> and
<span class="math inline">\(\theta_1 = \theta_2 = T \theta\)</span>. In
view of our assumption <span class="math inline">\(\delta \leqslant
1/2\)</span>, we have <span class="math display">\[\varepsilon^2
|\theta|  \ll |T|^{2 (\delta - 1) + 1} \leqslant 1,\]</span> so
condition <a href="#eq:epsth-thet-ll" data-reference-type="ref"
data-reference="eq:epsth-thet-ll">6.10</a> is satisfied.
The conclusion of that lemma implies that <span
class="math inline">\(\psi_{T \theta, c_2}^{-1} \gamma\)</span> is a
<span class="math inline">\(|T|^{\delta-1}\)</span>-bump at <span
class="math inline">\(p\)</span>. Therefore <span
class="math inline">\(\gamma \in
\mathfrak{C}(M,p,\theta,T,\delta)_{c_2}\)</span>. The reverse inclusion
is proved in the same way. ◻</p>
</div>
<div id="defn:we-henceforth-denote" class="definition">
<p><strong>Definition 115</strong>. We henceforth denote by <span
class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)\)</span> the
common value of the classes attached as in Definition <a
href="#defn:standard:let-v-be" data-reference-type="ref"
data-reference="defn:standard:let-v-be">112</a> to controlled charts
<span class="math inline">\(c\)</span>.</p>
</div>
<div id="example:standard2:smooth-modulated-bump-in-frak-C"
class="example">
<p><strong>Example 116</strong>. In the setting of Definition <a
href="#defn:standard:let-v-be" data-reference-type="ref"
data-reference="defn:standard:let-v-be">112</a>, suppose given <span
class="math inline">\(t \in F\)</span> with <span
class="math inline">\(|t| \asymp |T|^{\delta-1}\)</span>. Let <span
class="math inline">\(c : (M, p ) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,0)\)</span> be a controlled chart. Fix a smooth compactly-supported
measure <span class="math inline">\(\nu\)</span> on <span
class="math inline">\(V\)</span>. Define the measure <span
class="math inline">\(\gamma\)</span> on <span
class="math inline">\(M\)</span> by requiring that, for <span
class="math inline">\(f \in C_c(M)\)</span>, <span
class="math display">\[\int_M f \gamma
    = \int _{x \in V}
    f(c^{-1}(x/t))
    \psi_{T \theta}(x)
    \, d \nu(x).\]</span> Then we may verify readily that <span
class="math inline">\(\gamma\)</span> defines an element of <span
class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)\)</span>.</p>
</div>
<div id="lem:if-rho-local" class="lemma">
<p><strong>Lemma 117</strong>. Let <span class="math inline">\(\rho :
(M_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2,p_2)\)</span> be a controlled local isomorphism, and let <span
class="math inline">\(\theta_1 \in T_{p_1}^\wedge(M_1)\)</span> and
<span class="math inline">\(\theta_2 \in T_{p_2}^\wedge(M_2)\)</span>
with <span class="math inline">\(\theta_1, \theta_2 \ll 1\)</span> and
<span class="math inline">\(\rho^*(\theta_2) = \theta_1\)</span>. Then
the pushforward map <span class="math inline">\(\rho_*\)</span> induces
a bijective class map <span
class="math inline">\(\mathfrak{C}(M_1,p_1,\theta_1,T,\delta)
\rightarrow \mathfrak{C}(M_2,p_2,\theta_2,T,\delta)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Immediate from the definitions (as in the proof of
Lemma <a href="#lem:standard2:any-controlled-local"
data-reference-type="ref"
data-reference="lem:standard2:any-controlled-local">107</a>). ◻</p>
</div>
<h5 id="explication-in-local-coordinates">Explication in local
coordinates</h5>
<div id="item:class-CGthetaTdelta:2" class="example">
<p><strong>Example 118</strong>. <span id="example:standard2:let-v-p"
label="example:standard2:let-v-p"></span> Let <span
class="math inline">\((V,p)\)</span> be a controlled pointed vector
space. Let <span class="math inline">\(\theta\)</span> be an element of
the Pontryagin dual <span class="math inline">\(V^\wedge\)</span> with
<span class="math inline">\(\theta \ll 1\)</span>. Then, expanding all
definitions, we see that <span class="math inline">\(\mathfrak{C}(V, p,
\theta, T, \delta)\)</span> is the class of smooth measures <span
class="math inline">\(\gamma\)</span> on <span
class="math inline">\(V\)</span> with the following properties.</p>
<p>Fix a Haar measure <span class="math inline">\(d x\)</span> on <span
class="math inline">\(V\)</span>. Using <span class="math inline">\(d
x\)</span>, we may and shall identify smooth measure on <span
class="math inline">\(V\)</span> with smooth functions on <span
class="math inline">\(V\)</span>. Since any two choices for <span
class="math inline">\(d x\)</span> are related by a positive real <span
class="math inline">\(C \asymp 1\)</span>, the conditions that follow
are clearly independent of the choice of <span class="math inline">\(d
x\)</span>.</p>
<p>In the non-archimedean case, <span
class="math display">\[\|\gamma\|_{\infty} \ll |T|^{(1 - \delta)
\dim(V)}\]</span> and, for all <span class="math inline">\(x,u \in
V\)</span>, <span class="math display">\[\begin{align}
    \gamma(x) \neq 0 &amp;\implies x - p \ll  |T|^{\delta-1}, \\
    u \lll |T|^{\delta-1} &amp;\implies \gamma(x+u) = \psi_{T \theta}(u)
\gamma(x).
  
\end{align}\]</span></p>
<p>In the archimedean case, we require the following slightly more
technical conditions:</p>
<ol type="i">
<li><p><span id="item:class-CGthetaTdelta:1"
label="item:class-CGthetaTdelta:1"></span> There is a fixed element
<span class="math display">\[\delta_+ \in \begin{cases}
        (\delta,1/2) &amp; \text{ if } \delta &lt; 1/2, \\
        \{1/2\} &amp; \text{ if } \delta = 1/2
      \end{cases}\]</span> so that <span
class="math inline">\(\gamma\)</span> is supported on <span
class="math inline">\(p + \operatorname{O}(|T|^{-1 +
\delta_+})\)</span>.</p></li>
<li><p>Let <span class="math inline">\(\gamma^{\flat}\)</span> denote
the smooth measure given by <span id="eq:gammaflatx-:=-psi_t" class="math display">\[\label{eq:gammaflatx-:=-psi_t}\tag{6.15}
      \gamma^{\flat}(x) := \psi_{T \theta}^{-1}(x) \gamma(x).\]</span>
Identify it with a smooth function on <span
class="math inline">\(V\)</span> by dividing by a fixed Haar measure.
Then for all fixed <span class="math inline">\(k \in
\mathbb{Z}_{\geqslant 0}\)</span>, fixed multi-indices <span
class="math inline">\(\alpha \in \mathbb{Z}_{\geqslant
0}^{\dim(V)}\)</span> and all <span class="math inline">\(x \in
V\)</span>, <span id="eq:y_1-dotsb-y_m-2" class="math display">\[\label{eq:y_1-dotsb-y_m-2}\tag{6.16}
      \partial^\alpha  \gamma^{\flat}(x)
      \ll |T|^{(1 - \delta) (\dim(V) + |\alpha|)} \left( 1 +
\frac{|x-p|}{|T|^{\delta -1}} \right)^{-k}.\]</span></p></li>
</ol>
</div>
<h5 id="insensitivity">Insensitivity</h5>
<div id="lem:standard2:retain-setting-above" class="lemma">
<p><strong>Lemma 119</strong>. Retain the setting of the above
definitions. Let <span class="math inline">\(\theta_1, \theta_2 \in
T_p^\wedge(M)\)</span> with <span class="math display">\[\theta_1 =
\theta_2 + \operatorname{O}(|T|^{-\delta}).\]</span> Then <span
class="math inline">\(\mathfrak{C}(M,p,\theta_1,T,\delta) =
\mathfrak{C}(M,p,\theta_2,T,\delta)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline">\(c : (M, p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(T_p(M), 0)\)</span> be a controlled chart. Let <span
class="math inline">\(\gamma \in
\mathfrak{C}(M,p,\theta_1,T,\delta)\)</span>; in particular, <span
class="math inline">\(\psi_{T \theta_1, c}^{-1} \gamma\)</span> is a
<span class="math inline">\(|T|^{\delta-1}\)</span>-bump at <span
class="math inline">\(p\)</span>. Lemma <a
href="#lem:standard2:bumps-modulated-become-bumps"
data-reference-type="ref"
data-reference="lem:standard2:bumps-modulated-become-bumps">111</a>,
applied exactly as in the proof of Proposition <a
href="#lem:standard2:class-mathfrakcm-p" data-reference-type="ref"
data-reference="lem:standard2:class-mathfrakcm-p">114</a>, implies that
<span class="math inline">\(\psi_{T \theta_2, c}^{-1} \gamma\)</span> is
likewise a <span class="math inline">\(|T|^{\delta-1}\)</span>-bump at
<span class="math inline">\(p\)</span>. The support conditions
concerning <span class="math inline">\(\gamma\)</span> do not depend
upon <span class="math inline">\(\theta\)</span>, so we deduce the
containment <span
class="math inline">\(\mathfrak{C}(M,p,\theta_1,T,\delta) \subseteq
\mathfrak{C}(M,p,\theta_2,T,\delta)\)</span>. The reverse containment is
verified in the same way. ◻</p>
</div>
<div id="lem:insensitivity" class="lemma">
<p><strong>Lemma 120</strong>. Retain the setting of Example <a
href="#example:standard2:let-v-p" data-reference-type="ref"
data-reference="example:standard2:let-v-p">6.41</a>.
Let <span class="math inline">\(p_1, p_2 \in V\)</span> and <span
class="math inline">\(\theta_1, \theta_2 \in V^\wedge\)</span> with
<span class="math inline">\(\theta_1, \theta_2 \ll 1\)</span>. Assume
that <span class="math display">\[p_1 = p_2 +
o(|T|^{\delta-1}),\]</span> <span class="math display">\[\theta_1 =
\theta_2 + O(|T|^{-\delta}).\]</span> Then <span
class="math inline">\(\mathfrak{C}(V,p_1,\theta_1,T,\delta) =
\mathfrak{C}(V,p_2,\theta_2,T,\delta)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> It is easy to see that none of the conditions stated
in Example <a href="#example:standard2:let-v-p"
data-reference-type="ref"
data-reference="example:standard2:let-v-p">6.41</a>
change if we swap <span class="math inline">\(p_1\)</span> for <span
class="math inline">\(p_2\)</span>, so we may reduce to the case that
<span class="math inline">\(p_1 = p_2 = p\)</span>. We then appeal to
Lemma <a href="#lem:standard2:retain-setting-above"
data-reference-type="ref"
data-reference="lem:standard2:retain-setting-above">119</a>. ◻</p>
</div>
<p>For the remainder of this section, we retain the setting of the above
definitions concerning <span class="math inline">\(M, p, \theta, T,
\delta\)</span>. We focus moreover on individual values of <span
class="math inline">\(T\)</span> and <span
class="math inline">\(\delta\)</span>, and accordingly abbreviate <span
class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)\)</span> to
<span class="math inline">\(\mathfrak{C}(M,p,\theta)\)</span>. We will
also write, e.g., <span class="math inline">\(p_1, p_2\)</span> or <span
class="math inline">\(\theta_1, \theta_2\)</span> for quantities
satisfying the same conditions as <span class="math inline">\(p\)</span>
and <span class="math inline">\(\theta\)</span>.</p>
<h5 id="total-variation-norm">Total variation norm</h5>
<div id="lem:standard:each-gamma-in" class="lemma">
<p><strong>Lemma 121</strong>. For each <span
class="math inline">\(\gamma \in \mathfrak{C}(M,p,\theta)\)</span>, the
total variation <span class="math inline">\(\|\gamma \|_1\)</span> is
<span class="math inline">\(\ll 1\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We can check this in local coordinates, where it is
immediate from the concentration property <a href="#eq:y_1-dotsb-y_m-2"
data-reference-type="eqref"
data-reference="eq:y_1-dotsb-y_m-2">\((6.16)\)</a> applied
with <span class="math inline">\(\alpha =0\)</span>. ◻</p>
</div>
<h5 id="sec:modulation">§6.3.5. Modulation</h5>
<div id="lem:modulation" class="lemma">
<p><strong>Lemma 122</strong>. Let <span class="math inline">\(\delta
\in T_p^\wedge(M)\)</span> with <span class="math inline">\(\delta \ll
1\)</span>. Let <span class="math inline">\(c : (M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(T_p(M), 0)\)</span> be a controlled chart. Then multiplication by <span
class="math inline">\(\psi_{T \delta,c}\)</span> (Definition <a
href="#defn:standard2:given-point-manif" data-reference-type="ref"
data-reference="defn:standard2:given-point-manif">110</a>) induces a
bijective class map <span class="math inline">\(\mathfrak{C}(M,p,\theta)
\rightarrow \mathfrak{C}(M,p,\theta+\delta)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Immediate from Definition <a
href="#defn:standard:let-v-be" data-reference-type="ref"
data-reference="defn:standard:let-v-be">112</a>. ◻</p>
</div>
<h5 id="pushforward">Pushforward</h5>
<p>Let <span class="math inline">\(\rho : (M_1, p_1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(M_2, p_2)\)</span> be a fixed local morphism of fixed pointed
manifolds. (The discussion to follow applies with “fixed” replaced by
“controlled,” but is slightly more involved, and we do not require such
generality.) Then, if <span class="math inline">\(\rho\)</span> is
submersive, the charts <span class="math inline">\(c_1, c_2\)</span> and
the linear map <span class="math inline">\(\ell\)</span> arising from
application of the inverse function theorem (§<a
href="#sec:inverse-funct-theor" data-reference-type="ref"
data-reference="sec:inverse-funct-theor">1.1.7</a>) may also be taken
fixed.</p>
<p>Let <span class="math inline">\(\theta_2 \in
T_{p_2}(M_2)^\wedge\)</span> with <span class="math inline">\(\theta_2
\ll 1\)</span>. Set <span class="math inline">\(\theta_1 := \rho^*
\theta_2 \in T_{p_1}(M_1)^\wedge\)</span>. As noted earlier, we then
have <span class="math inline">\(\theta_1 \ll 1\)</span>.</p>
<div id="lem:assume-that-rho" class="proposition">
<p><strong>Proposition 123</strong>. <em>Assume that <span
class="math inline">\(\rho\)</span> is submersive at <span
class="math inline">\(p_1\)</span>. Then the pushforward map <span
class="math inline">\(\rho_*\)</span> on spaces of measures induces a
surjective class map <span id="eq:phi_-:-mathcalcm_1" class="math display">\[\label{eq:phi_-:-mathcalcm_1}\tag{6.17}
    \rho_* : \mathcal{C}(M_1,p_1,\theta_1) \rightarrow
\mathfrak{C}(M_2,p_2,\theta_2).\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> We may reduce to the case that <span
class="math inline">\((M_1,p_1) = (V_1,0)\)</span> and <span
class="math inline">\((M_2,p_2) = (V_2,0)\)</span>, where <span
class="math inline">\(V_1, V_2\)</span> are vector spaces, and <span
class="math inline">\(\rho : V_1 \rightarrow V_2\)</span> is a fixed
surjective linear map. Set <span class="math inline">\(U :=
\ker(\rho)\)</span>. By fixing a splitting of <span
class="math inline">\(\rho\)</span>, we may identify <span
class="math inline">\(V_1\)</span> with <span class="math inline">\(V_2
\oplus U\)</span>. We write elements of <span
class="math inline">\(V_1\)</span> as <span
class="math inline">\((x,y)\)</span>, with <span class="math inline">\(x
\in V_2\)</span> and <span class="math inline">\(y \in U\)</span>, so
that <span class="math inline">\(\rho(x,y) = x\)</span>. By fixing Haar
measures on all vector spaces, we may identify smooth measures with
smooth functions. For <span class="math inline">\(\gamma \in
\mathfrak{C}(V_1, 0, \theta_1)\)</span>, we have <span
class="math display">\[\rho_*(\gamma)(x) = \int _{y \in U}
    \gamma(x, y) \, d y.\]</span> We are given <span
class="math inline">\(\theta_2 \in V_2^\wedge\)</span> with <span
class="math inline">\(\theta_2 \ll 1\)</span>. The element <span
class="math inline">\(\theta_1 = \rho^* \theta_2 \in V_1^\wedge\)</span>
is given by <span class="math inline">\(\langle \theta_1, (x,y) \rangle
= \langle \theta_2, x \rangle\)</span>.</p>
<p>Let us show first that if <span class="math inline">\(\gamma \in
\mathfrak{C}(V_1, 0, \theta_1)\)</span>, then <span
class="math inline">\(\rho_*(\gamma) \in
\mathfrak{C}(V_2,0,\theta_2)\)</span>. We consider the non-archimedean
case; the archimedean case may be treated similarly, substituting
discussion of invariance with estimates involving derivatives. We are
given that <span class="math inline">\(\gamma\)</span> has <span
class="math inline">\(L^\infty\)</span>-norm <span
class="math inline">\(\ll |T|^{\dim(V_1)}\)</span>, is supported on
elements of size <span
class="math inline">\(\operatorname{O}(|T|^{\delta-1})\)</span>, and,
for all <span class="math inline">\(u \in V_1\)</span> of size <span
class="math inline">\(o(|T|^{\delta-1})\)</span>, satisfies <span
class="math inline">\(\gamma(v + u) = \psi_{T \theta_1}(u)
\gamma(v)\)</span> for all <span class="math inline">\(v \in
V_1\)</span>. For each <span class="math inline">\(x \in V_2\)</span>,
the volume of <span class="math inline">\(\{y \in U : \gamma(x,y) \neq
0\}\)</span> is <span class="math inline">\(\ll |T|^{\delta-1}\)</span>,
so the triangle inequality gives <span
class="math inline">\(\|\rho_*(\gamma)\|_{\infty} \ll
|T|^{\dim(V_2)}\)</span>. The support condition on <span
class="math inline">\(\gamma\)</span> implies that <span
class="math inline">\(\rho_*(\gamma)\)</span> is supported on elements
of the form <span
class="math inline">\(\operatorname{O}(|T|^{\delta-1})\)</span>. The
equivariance property of <span class="math inline">\(\gamma\)</span>
implies that <span class="math inline">\(\rho_*(\gamma)(x + u) = \psi_{T
\theta_2}(u) \rho*(\gamma)(x)\)</span> for all <span
class="math inline">\(u \in V_2\)</span>. Thus <span
class="math inline">\(\rho_*(\gamma) \in
\mathfrak{C}(V_2,0,\theta_2)\)</span>, as claimed.</p>
<p>It remains to check that the class map <a
href="#eq:phi_-:-mathcalcm_1" data-reference-type="eqref"
data-reference="eq:phi_-:-mathcalcm_1">\((6.17)\)</a> is
surjective. Let <span class="math inline">\(\gamma_1 \in
\mathfrak{C}(V_2,0,\theta_2)\)</span> be given. We may find <span
class="math inline">\(\gamma_2 \in \mathfrak{C}(U,0,0)\)</span> with
<span class="math inline">\(\int_U \gamma_2 = 1\)</span>. (For instance,
take the rescaling by <span class="math inline">\(t \in
F^\times\)</span>, with <span class="math inline">\(|t| \asymp
|T|^{1-\delta}\)</span>, of a fixed bump function of total mass one.)
Define <span class="math inline">\(\gamma(x,y) := \gamma_1(x)
\gamma_2(y)\)</span>. It is then easy to see that <span
class="math inline">\(\gamma \in \mathfrak{C}(V_1,0,\theta_1)\)</span>
and <span class="math inline">\(\rho_*(\gamma) =
\gamma_1\)</span>. ◻</p>
</div>
<div class="remark">
<p><strong>Remark 124</strong>. More generally, if <span
class="math inline">\(\theta_1\)</span> is far enough away from the
image of <span class="math inline">\(\rho^* : T_{p_2}^*(M_2)
\hookrightarrow T_{p_1}^*(M_1)\)</span>, then the induced class map is
negligible in a certain sense; special cases of this feature follow from
the star product asymptotics recalled in §<a
href="#sec:star-prod-asymptotics" data-reference-type="ref"
data-reference="sec:star-prod-asymptotics">2.5.4</a>.</p>
</div>
<h5 id="negligible-bumps">Negligible bumps</h5>
<p>Given any complex scalar <span class="math inline">\(t\)</span>, we
may define the rescaled class <span class="math inline">\(t
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>, consisting of smooth
measures on <span class="math inline">\(M\)</span> of the form <span
class="math inline">\(t \gamma\)</span> for some <span
class="math inline">\(\gamma \in
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>. This notation applies in
particular when <span class="math inline">\(t\)</span> is a power of
<span class="math inline">\(|T|\)</span>. We denote by <span
class="math display">\[|T|^{-\infty}
\mathfrak{C}(M,p,\theta,T,\delta)\]</span> the intersection over all
fixed <span class="math inline">\(m \geqslant 0\)</span> of the classes
<span class="math inline">\(|T|^{-m}
\mathfrak{C}(M,p,\theta,T,\delta)\)</span> (cf. §<a
href="#sec:furth-notat-conv" data-reference-type="ref"
data-reference="sec:furth-notat-conv">2.1.6</a>). Passing to local
coordinates as in Example <a href="#example:standard2:let-v-p"
data-reference-type="ref"
data-reference="example:standard2:let-v-p">6.41</a>,
we readily obtain the following explicit description of that class:</p>
<div id="lem:standard2:let-v-p" class="lemma">
<p><strong>Lemma 125</strong>. Let <span
class="math inline">\((V,p)\)</span> be a controlled point vector space,
and let <span class="math inline">\((\theta,T,\delta)\)</span> be as in
Example <a href="#example:standard2:let-v-p" data-reference-type="ref"
data-reference="example:standard2:let-v-p">6.41</a>.
We identify smooth measures on <span class="math inline">\(V\)</span>
with smooth functions via some fixed Haar measure.</p>
<p>In the non-archimedean case, <span
class="math inline">\(|T|^{-\infty}
\mathfrak{C}(V,p,\theta,T,\delta)\)</span> identifies with the space of
smooth functions <span class="math inline">\(\gamma\)</span> on <span
class="math inline">\(V\)</span> such that <span id="eq:gamma-_infty-ll" class="math display">\[\label{eq:gamma-_infty-ll}\tag{6.18}
    \|\gamma \|_{\infty} \ll |T|^{-\infty},\]</span> (i.e., following
the conventions of §<a href="#sec:asympt-notat-term"
data-reference-type="ref"
data-reference="sec:asympt-notat-term">2.1</a>, <span
class="math inline">\(\|\gamma \|_{\infty} \ll |T|^{-m}\)</span> for
each fixed <span class="math inline">\(m\)</span>), and, for all <span
class="math inline">\(x,u \in V\)</span>, <span
class="math display">\[\begin{align}
    \gamma(x) \neq 0 &amp;\implies x - p \ll  |T|^{\delta-1}, \\
    u \lll |T|^{\delta-1} &amp;\implies \gamma(x+u) = \psi_{T \theta}(u)
\gamma(x).
  
\end{align}\]</span></p>
<p>In the archimedean case, <span class="math inline">\(|T|^{-\infty}
\mathfrak{C}(V,p,\theta,T,\delta)\)</span> identifies with the space of
smooth functions <span class="math inline">\(\gamma\)</span> on <span
class="math inline">\(V\)</span> that are supported on <span
class="math inline">\(p + \operatorname{O}(|T|^{-1 + \delta_+})\)</span>
for some fixed <span class="math inline">\(\delta_+\)</span> as in <a
href="#item:class-CGthetaTdelta:1" data-reference-type="eqref"
data-reference="item:class-CGthetaTdelta:1">\((i)\)</a>
and such that for all fixed <span class="math inline">\(\ell \in
\mathbb{Z}_{\geqslant 0}\)</span> and <span class="math inline">\(\alpha
\in \mathbb{Z}_{\geqslant 0}^{\dim(V)}\)</span>, <span
class="math display">\[\|\partial^\alpha \gamma\|_{\infty}
      \ll |T|^{-\ell}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Abbreviate <span class="math inline">\(\mathfrak{C}
:= \mathfrak{C}(V,p,\theta,T,\delta)\)</span>. It is easy to see that
any <span class="math inline">\(\gamma\)</span> satisfying the above
conditions lies in <span class="math inline">\(|T|^{-\ell}
\mathfrak{C}\)</span> for each fixed <span
class="math inline">\(\ell\)</span>, hence lies in <span
class="math inline">\(|T|^{-\infty} \mathfrak{C}\)</span>. Conversely,
suppose <span class="math inline">\(\gamma\)</span> lies in <span
class="math inline">\(|T|^{-\ell} \mathfrak{C}\)</span> for each fixed
<span class="math inline">\(\ell\)</span>. Consider first the
non-archimedean case. Then our hypothesis, applied with <span
class="math inline">\(\ell = 0\)</span>, gives the required support and
invariance conditions. Applying our hypothesis again but with <span
class="math inline">\(\ell\)</span> arbitary then gives the required
<span class="math inline">\(L^\infty\)</span> bound <a
href="#eq:gamma-_infty-ll" data-reference-type="eqref"
data-reference="eq:gamma-_infty-ll">\((6.18)\)</a>. Consider
next the archimedean case. Our hypothesis, applied with <span
class="math inline">\(\ell = 0\)</span>, gives the required support
condition. Applying our hypothesis again but with <span
class="math inline">\(\ell\)</span> arbitrary gives, with <span
class="math inline">\(\gamma^{\flat}\)</span> defined as in <a
href="#eq:gammaflatx-:=-psi_t" data-reference-type="eqref"
data-reference="eq:gammaflatx-:=-psi_t">\((6.15)\)</a>,
the following assertion: for fixed <span class="math inline">\(k,\ell
\in \mathbb{Z}_{\geqslant 0}\)</span> and <span
class="math inline">\(\alpha \in \mathbb{Z}_{\geqslant
0}^{\dim(V)}\)</span>, <span class="math display">\[\partial^\alpha
\gamma^{\flat}(x) \ll
    |T|^{-\ell + (1 - \delta)(\dim(V) + |\alpha|)} \left( 1 + \frac{|x -
p|}{|T|^{\delta - 1}} \right)^{-k}.\]</span> In view of the support
condition that <span class="math inline">\(x - p \ll |T|^{\delta_+ -
1}\)</span>, it is equivalent to ask simply that for all fixed <span
class="math inline">\(\ell, m \in \mathbb{Z}_{\geqslant 0}\)</span> and
fixed <span class="math inline">\(\alpha\)</span>, we have <span id="eq:part-gamm-ll-1" class="math display">\[\label{eq:part-gamm-ll-1}\tag{6.19}
    \|\partial^\alpha \gamma^{\flat}\|_{\infty} \ll
|T|^{-\ell}.\]</span> Finally, since the estimate <span
class="math inline">\(\partial^\alpha \psi_{T \theta}(x) \ll
|T|^{|\alpha|}\)</span> holds for fixed <span
class="math inline">\(\alpha\)</span>, we deduce that the estimates <a
href="#eq:gamma-_infty-ll" data-reference-type="eqref"
data-reference="eq:gamma-_infty-ll">\((6.18)\)</a> and <a
href="#eq:part-gamm-ll-1" data-reference-type="eqref"
data-reference="eq:part-gamm-ll-1">\((6.19)\)</a>, taken over
all fixed <span class="math inline">\(\ell \geqslant 0\)</span>, are
equivalent. ◻</p>
</div>
<p>The following technical lemma will be needed at one point, in the
proof of Proposition <a href="#prop:standard2:each-fixed-x"
data-reference-type="ref"
data-reference="prop:standard2:each-fixed-x">258</a>.</p>
<div id="lem:standard2:overspill-frak-C-M" class="lemma">
<p><strong>Lemma 126</strong>. Suppose that <span
class="math inline">\(\gamma \in |T|^{-\infty}
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>. Then there exists a natural
number <span class="math inline">\(\ell \ggg 1\)</span> such that <span
class="math inline">\(|T|^{\ell} \gamma \in |T|^{-\infty}
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Abbreviate <span class="math inline">\(\mathfrak{C}
:= \mathfrak{C}(M,p,\theta,T,\delta)\)</span>. We can assume that <span
class="math inline">\((M,p) = (V,p)\)</span>, so that the description of
Lemma <a href="#lem:standard2:let-v-p" data-reference-type="ref"
data-reference="lem:standard2:let-v-p">125</a> applies. Our hypothesis
is that <span class="math inline">\(\gamma \in |T|^{-\infty}
\mathfrak{C}\)</span>. The desired conclusion is that <span
class="math inline">\(|T|^{\ell} \gamma \in |T|^{-\infty}
\mathfrak{C}\)</span> for some <span class="math inline">\(\ell
\geqslant 0\)</span> with <span class="math inline">\(\ell \ggg
1\)</span>. As we now explain, this is a simple application of
overspill.</p>
<p>In the non-archimedean case, the required support and invariance
conditions for <span class="math inline">\(|T|^{\ell} \gamma\)</span>,
for any <span class="math inline">\(\ell\)</span>, follow immediately
from our hypothesis. Our hypothesis <a href="#eq:gamma-_infty-ll"
data-reference-type="eqref"
data-reference="eq:gamma-_infty-ll">\((6.18)\)</a> implies
also that, for each fixed <span class="math inline">\(\ell\)</span>, we
have <span class="math inline">\(\||T|^{\ell} \gamma \|_{\infty}
\leqslant|T|^{-\ell}\)</span>. By overspill, we may find <span
class="math inline">\(\ell \ggg 1\)</span> for which <span
class="math inline">\(\||T|^{\ell} \gamma \|_{\infty}
\leqslant|T|^{-\ell}\)</span>. Then <span
class="math inline">\(\||T|^{\ell} \gamma \|_{\infty} \ll
|T|^{-\infty}\)</span>, as required.</p>
<p>In the archimedean case, the support condition again follows
immediately from our hypothesis. We also know that for each fixed <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, we
have <span class="math inline">\(\|\partial^\alpha |T|^{\ell}
\gamma(x)\|_{\infty} \leqslant|T|^{-\ell}\)</span> for all multi-indices
<span class="math inline">\(\alpha\)</span> with <span
class="math inline">\(|\alpha| \leqslant\ell\)</span>, say. By
overspill, the same conclusion holds for some <span
class="math inline">\(\ell \ggg 1\)</span>. With this choice of <span
class="math inline">\(\ell\)</span>, we then have <span
class="math inline">\(\|\partial^\alpha |T|^{\ell} \gamma (x)\|_{\infty}
\ll |T|^{-\infty}\)</span>, whence <span
class="math inline">\(|T|^{\ell} \gamma \in \mathfrak{C}\)</span>, as
required. ◻</p>
</div>
<h5 id="fourier-analytic-description">Fourier-analytic description</h5>
<p>For a vector space <span class="math inline">\(V\)</span> over <span
class="math inline">\(F\)</span>, we denote by <span
class="math inline">\(\mathcal{S}(V)\)</span> the Schwartz space of
<span class="math inline">\(V\)</span>, by <span
class="math inline">\(\mathcal{M}_{\mathcal{S}}(V)\)</span> the space of
Schwartz measures on <span class="math inline">\(V\)</span> (i.e.,
measures of the form <span class="math inline">\(\varphi(x) \, d
x\)</span>, where <span class="math inline">\(\varphi \in
\mathcal{S}(V)\)</span> and <span class="math inline">\(d x\)</span> is
a Haar measure on <span class="math inline">\(V\)</span>), and by <span
class="math inline">\(V^\wedge\)</span> the Pontryagin dual of <span
class="math inline">\(V\)</span>. We denote by <span
class="math inline">\(f \mapsto f^\wedge\)</span> the Fourier transform
<span class="math inline">\(\mathcal{M}_{\mathcal{S}}(V) \rightarrow
\mathcal{S}(V^\wedge)\)</span> given by <span
class="math display">\[f^\wedge(\xi) = \int_{x \in V} f(x)
\psi_\xi(x),\]</span> and by <span class="math inline">\(f \mapsto
f^\vee\)</span> its inverse. Given <span class="math inline">\(T \in
F^\times\)</span>, we define the rescaled Fourier transform <span
class="math display">\[\mathcal{F}_T : \mathcal{M}_{\mathcal{S}}(V)
\rightarrow \mathcal{S}(V^\wedge)\]</span> by the formula <span
class="math inline">\(\mathcal{F}_T(f)(\xi) := f^\wedge(T \xi)\)</span>.
We denote by <span class="math inline">\(\mathcal{F}_T^{-1}\)</span> its
inverse.</p>
<div id="defn:let-mathfrakav-theta" class="definition">
<p><strong>Definition 127</strong>. Let <span
class="math inline">\(\mathfrak{A}(V,\theta,T,\delta)\)</span> denote
the class of all smooth functions <span class="math inline">\(a\)</span>
on <span class="math inline">\(V^\wedge\)</span> with the following
properties.</p>
<ul>
<li><p>In the archimedean case, each derivative of <span
class="math inline">\(a\)</span> is of rapid decay. Moreover, for each
fixed <span class="math inline">\(m, \ell \in \mathbb{Z}_{\geqslant
0}\)</span> and fixed vector fields <span
class="math inline">\(X_1,\dotsc,X_m\)</span> on <span
class="math inline">\(V^\wedge\)</span>, we have <span
class="math display">\[X_1 \dotsb X_m a(\xi) \ll |T|^{m \delta}
\left\langle |T|^{\delta} (\xi + \theta )
\right\rangle^{-\ell}.\]</span></p></li>
<li><p>In the non-archimedean case, for <span class="math inline">\(\xi,
\eta \in V^\wedge\)</span>, <span class="math display">\[\begin{align}
      a(\xi ) \neq 0 &amp;\implies |\xi + \theta| \ll |T|^{-\delta}, \\
      |\eta| \lll |T|^{-\delta} &amp;\implies a(\xi + \eta  ) = a(\xi).
    
\end{align}\]</span></p></li>
</ul>
</div>
<div id="itm:standard:fourier-description-of-bumps-arch" class="lemma">
<p><strong>Lemma 128</strong>. <span id="lem:let-c-frakC-vs-frakA"
label="lem:let-c-frakC-vs-frakA"></span> Let <span
class="math inline">\(c : (M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(T_p(M), 0)\)</span> be a controlled chart.</p>
<ol type="i">
<li><p>Let <span class="math inline">\(\gamma \in
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>. Then the rescaled Fourier
transform <span class="math inline">\(\mathcal{F}_T(c_*\gamma) \in
\mathcal{S}(T_p^\wedge(M))\)</span> lies in <span
class="math inline">\(\mathfrak{A}(T_p(M),\theta,T,\delta)\)</span>.</p></li>
<li><p>Suppose <span class="math inline">\(F\)</span> is
non-archimedean. Let <span class="math inline">\(a \in
\mathfrak{A}(T_p(M),\theta,T,\delta)\)</span>. Then <span
class="math inline">\(c^* \mathcal{F}_T^{-1}(a) \in
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>. Thus the maps <span
class="math display">\[\mathcal{F}_T \circ c_* :
\mathfrak{C}(M,p,\theta,T,\delta) \rightarrow
\mathfrak{A}(T_p(M),\theta,T,\delta),\]</span> <span
class="math display">\[c^* \circ \mathcal{F}_T^{-1}  :
\mathfrak{A}(T_p(M),\theta,T,\delta) \rightarrow
\mathfrak{C}(M,p,\theta,T,\delta)\]</span> are mutually inverse class
bijections.</p></li>
<li><p>Suppose <span class="math inline">\(F\)</span> is archimedean.
Let <span class="math inline">\(a \in
\mathfrak{A}(T_p(M),\theta,T,\delta)\)</span>. Let <span
class="math inline">\(\chi \in C_c^\infty(M)\)</span> be supported on
<span class="math inline">\(p +
\operatorname{O}(|T|^{\delta_+-1})\)</span> for some fixed <span
class="math inline">\(\delta_+\)</span> as in <a
href="#eq:delt-in-beginc-1" data-reference-type="eqref"
data-reference="eq:delt-in-beginc-1">\((6.14)\)</a>, and
suppose that <span class="math inline">\(\partial^\alpha \chi(x) \ll
|T|^{(1 - \delta) |\alpha|}\)</span> for all fixed <span
class="math inline">\(\alpha\)</span> and all <span
class="math inline">\(x\)</span>. Then <span class="math inline">\(\chi
\cdot c^* \mathcal{F}_T^{-1}(a)\)</span> lies in the class <span
class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)\)</span>.
Conversely, every element of that class arises in this way.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> Assertions (i) and (ii), and all but the final
assertion of (iii), are essentially a multi-dimensional variant of Lemma
<a href="#lem:four-transf-begin" data-reference-type="ref"
data-reference="lem:four-transf-begin">12</a>; they follow again by
repeated integration by parts in the definition of the Fourier integral.
For the final assertion, let <span class="math inline">\(\gamma \in
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>. We may construct <span
class="math inline">\(\chi\)</span>, as indicated, with the additional
property that <span class="math inline">\(\chi\)</span> takes the value
<span class="math inline">\(1\)</span> on all elements of the form <span
class="math inline">\(p + o(|T|^{\delta_+-1})\)</span>. Then <span
class="math inline">\(\chi \gamma = \gamma\)</span>, hence <span
class="math inline">\(\gamma = \chi \cdot c^* \mathcal{F}_T^{-1}
(a)\)</span> with <span class="math inline">\(a := \mathcal{F}_T (c_*
\gamma)\)</span>. ◻</p>
</div>
<div class="remark">
<p><strong>Remark 129</strong>. In the non-archimedean case, we thus
have a clear Fourier-analytic interpretation of <span
class="math inline">\(\mathfrak{C}(M,p,\theta,T,\delta)\)</span>. In the
archimedean case, for <span class="math inline">\(\chi\)</span> as in
assertion <a href="#itm:standard:fourier-description-of-bumps-arch"
data-reference-type="eqref"
data-reference="itm:standard:fourier-description-of-bumps-arch">\((iii)\)</a>
and <span class="math inline">\(\gamma \in
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>, it is not hard to see that
<span class="math inline">\(\chi \cdot \gamma - \gamma \in |T|^{-\infty}
\mathfrak{C}(M,p,\theta,T,\delta)\)</span>. Thus the maps <span
class="math display">\[\mathcal{F}_T \circ c_* :
\mathfrak{C}(M,p,\theta,T,\delta) \rightarrow
\mathfrak{A}(T_p(M),\theta,T,\delta),\]</span> <span
class="math display">\[\chi \cdot c^* \circ \mathcal{F}_T^{-1}  :
\mathfrak{A}(T_p(M),\theta,T,\delta) \rightarrow
\mathfrak{C}(M,p,\theta,T,\delta)\]</span> are, in a certain sense,
asymptotically inverse to one another.</p>
</div>
<h5 id="action-by-vector-fields">Action by vector fields</h5>
<div id="lem:archimedean-vector-field-act-on-C" class="lemma">
<p><strong>Lemma 130</strong>. Assume that <span class="math inline">\(F
= \mathbb{R}\)</span>. Let <span class="math inline">\(X\)</span> be a
fixed vector field on <span class="math inline">\(M\)</span>. Let <span
class="math inline">\(\gamma \in \mathfrak{C}(M,p,\theta)\)</span>. Then
<span class="math display">\[X \gamma - \langle T \theta, X(p) \rangle
\gamma
    \in
    |T|^{1-\delta}
    \mathfrak{C}(M,p,\theta).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We may reduce to the case <span
class="math inline">\((M,p) = (V,0)\)</span>, <span
class="math inline">\(\theta \in V^\wedge\)</span>. We write <span
class="math inline">\(\gamma = \psi_{T \theta} \gamma^{\flat}\)</span>,
where <span class="math inline">\(\gamma^{\flat}\)</span> is a <span
class="math inline">\(|T|^{\delta-1}\)</span>-bump. By the product rule,
<span class="math inline">\(X \gamma = (X \psi_{T \theta})
\gamma^{\flat} + \psi_{T \theta} (X \gamma^{\flat})\)</span>. By Lemma
<a href="#lem:standard2:bump-preserved-under-vector-field"
data-reference-type="ref"
data-reference="lem:standard2:bump-preserved-under-vector-field">108</a>,
we know that <span class="math inline">\(|T|^{\delta - 1}
X  \gamma^{\flat}\)</span> is a <span
class="math inline">\(|T|^{\delta-1}\)</span>-bump, hence that <span
class="math inline">\(\psi_{T \theta} (X \gamma^{\flat}) \in |T|^{1-
\delta} \mathfrak{C}(M,p,\theta)\)</span>. We thereby reduce to
verifying that <span id="eq:x-psi_t-theta" class="math display">\[\label{eq:x-psi_t-theta}\tag{6.20}
    (X \psi_{T \theta}) \gamma^{\flat} - \langle T \theta, X(0) \rangle
\gamma \in |T|^{1-\delta} \mathfrak{C}(M,p,\theta).\]</span> To that
end, observe that <span class="math display">\[(X \psi_{T \theta})
\gamma^{\flat} - \langle T \theta, X(0) \rangle \gamma
    =
    \langle
    T \theta, X(x) - X(0)
    \rangle
    \gamma.\]</span> Write <span class="math display">\[f(x) :=
    \frac{
      \langle
      T \theta, X(x) - X(0)
      \rangle
    }{
      |T|
    }.\]</span> Then <span class="math inline">\(f\)</span> is a smooth
function that vanishes at the origin and has each fixed derivative of
size <span class="math inline">\(\operatorname{O}(1)\)</span>. By Lemma
<a href="#lem:standard2:let-f-vanish-at-p-eps-bump"
data-reference-type="ref"
data-reference="lem:standard2:let-f-vanish-at-p-eps-bump">109</a>, we
deduce that <span class="math inline">\(|T|^{1 - \delta} f
\gamma^{\flat}\)</span> is a <span
class="math inline">\(|T|^{\delta-1}\)</span> bump, thus <span
class="math inline">\(|T|^{1- \delta} f \gamma \in
\mathfrak{C}(M,p,\theta)\)</span>, which implies the required membership
<a href="#eq:x-psi_t-theta" data-reference-type="eqref"
data-reference="eq:x-psi_t-theta">\((6.20)\)</a> in view of the
inequality <span class="math inline">\(\delta \leqslant 1 -
\delta\)</span> following from our assumption that <span
class="math inline">\(\delta \leqslant 1/2\)</span>. ◻</p>
</div>
<h5 id="sec:translation">§6.3.10. Action by Lie groups</h5>
<p>Let <span class="math inline">\(G\)</span> be a fixed analytic group
over <span class="math inline">\(F\)</span>, i.e., a topological group
that is also a manifold (analytic, by our conventions) for which the
multiplication and inversion maps are analytic <a href="#ref-MR2179691" class="citation"
data-cites="MR2179691">(Serre 2006, vol. 1500, sec. II.IV)</a>. We
denote by <span class="math inline">\(1 \in G\)</span> the identity
element and by <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span> the Lie algebra,
which is a vector space over <span class="math inline">\(F\)</span>. The
group logarithm defines a (fixed) chart <span
class="math inline">\((G,1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(\mathop{\mathrm{Lie}}(G), 0)\)</span>.</p>
<p>Assume given a fixed action <span class="math inline">\(G \times M
\rightarrow M\)</span> our on manifold <span
class="math inline">\(M\)</span>. We denote this action simply by
juxtaposition. This action induces one of <span
class="math inline">\(G\)</span> on functions on <span
class="math inline">\(M\)</span>, measures on <span
class="math inline">\(M\)</span>, and so on.</p>
<div id="lem:standard2:G-defines-controlled-local-isoms" class="lemma">
<p><strong>Lemma 131</strong>. Let <span
class="math inline">\(p\)</span> belong to some fixed compact subset of
<span class="math inline">\(M\)</span>. Let <span
class="math inline">\(g \in G\)</span> with <span
class="math inline">\(g = 1 + o(1)\)</span>. Then</p>
<ol type="i">
<li><p><span class="math inline">\(g p\)</span> likewise belongs to some
fixed compact subset of <span class="math inline">\(M\)</span>, so <span
class="math inline">\((M,p)\)</span> and <span class="math inline">\((M,
gp)\)</span> are controlled pointed manifolds in the sense of §<a
href="#sec:control" data-reference-type="ref"
data-reference="sec:control">1.2.2</a>, and</p></li>
<li><p>the induced map <span id="eq:g-:-m" class="math display">\[\label{eq:g-:-m}\tag{6.21}
      g : (M,p) \rightarrow  (M, g p)\]</span> defines a controlled
local isomorphism.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> Lemma <a href="#lem:families-controlled-maps"
data-reference-type="ref"
data-reference="lem:families-controlled-maps">96</a> (applied with <span
class="math inline">\(X, Y = M\)</span> and <span
class="math inline">\(Z = G\)</span>) implies that <a href="#eq:g-:-m"
data-reference-type="eqref" data-reference="eq:g-:-m">\((6.21)\)</a> is
defines controlled local morphism. The required conclusion then follows
from the same argument applied to <span
class="math inline">\(g^{-1}\)</span>. ◻</p>
</div>
<div class="definition">
<p><strong>Definition 132</strong>. Let <span
class="math inline">\(p\)</span> belong to a fixed compact subset of
<span class="math inline">\(M\)</span>. Let <span
class="math display">\[\mu : T_p^\wedge(M) \rightarrow
\mathop{\mathrm{Lie}}(G)^\wedge\]</span> denote the dual of the
differential of the orbit map <span class="math inline">\(G \rightarrow
M\)</span>, <span class="math inline">\(g \mapsto g p\)</span>.</p>
</div>
<p>In particular, for each <span class="math inline">\(g \in G\)</span>
with <span class="math inline">\(g = 1 + o(1)\)</span>, we may define
<span class="math inline">\(\psi_{\mu(T \theta)}(\log(g)) \in
\mathop{\mathrm{U}}(1)\)</span>.</p>
<p>We have the following consequence of Lemma <a
href="#lem:archimedean-vector-field-act-on-C" data-reference-type="ref"
data-reference="lem:archimedean-vector-field-act-on-C">130</a>:</p>
<div id="lem:archimedean-vector-field-act-on-C-2" class="proposition">
<p><strong>Proposition 133</strong>. <em>Assume that <span
class="math inline">\(F\)</span> is archimedean. Let <span
class="math inline">\(x \in \mathop{\mathrm{Lie}}(G)\)</span>. Let <span
class="math inline">\(X\)</span> denote the vector field on <span
class="math inline">\(M\)</span> associated to <span
class="math inline">\(x\)</span> and the given action of <span
class="math inline">\(G\)</span>. Let <span class="math inline">\(\gamma
\in \mathfrak{C}(M,p,\theta)\)</span>. Then <span
class="math display">\[X \gamma - \langle \mu(T \theta), x \rangle
\gamma
    \in
    |T|^{1-\delta}    |x|    \mathfrak{C}(M,p,\theta).\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Fix a basis <span
class="math inline">\(\{X_1,\dotsc,X_n\}\)</span> of <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>, and write <span
class="math inline">\(X = \sum c_j X_j\)</span>. Then <span
class="math inline">\(|x| \asymp \max_j |c_j|\)</span>. By definition,
<span class="math inline">\(\langle \mu(T \theta), x \rangle = \langle T
\theta, X(p) \rangle\)</span>. The claim follows by summing up the
application of Lemma <a href="#lem:archimedean-vector-field-act-on-C"
data-reference-type="ref"
data-reference="lem:archimedean-vector-field-act-on-C">130</a> to each
basis element <span class="math inline">\(X_j\)</span>. ◻</p>
</div>
<p>We now record the effect of the group action on the classes <span
class="math inline">\(\mathfrak{C}(M,p,\theta)\)</span>.</p>
<div id="lem:sub-gln:let-gamma-in" class="proposition">
<p><strong>Proposition 134</strong>. <em>Let <span
class="math inline">\(\gamma \in \mathfrak{C}(M,p,\theta)\)</span>. Let
<span class="math inline">\(g \in G\)</span> with <span
class="math inline">\(g = 1 + o(|T|^{\delta-1})\)</span>. Then the
pushforward <span class="math inline">\(g_* \gamma\)</span> of <span
class="math inline">\(\gamma\)</span> under the action map belongs to
<span class="math inline">\(\mathfrak{C}(M,p,\theta)\)</span>. More
precisely,</em></p>
<ul>
<li><p><em>in the non-archimedean case, we have <span id="eq:g_-gamma-equivariance-non-arch" class="math display">\[\label{eq:g_-gamma-equivariance-non-arch}\tag{6.22}
      g_* \gamma = \psi_{\mu(T \theta)} (\log (g)) \gamma,\]</span>
while</em></p></li>
<li><p><em>in the archimedean case, <span class="math display">\[g_*
\gamma - \psi_{\mu(T \theta)}(\log(g)) \gamma \in |T|^{1 - \delta}
{\mathop{\mathrm{dist}}}_G(g,1)
\mathfrak{C}(M,p,\theta).\]</span></em></p></li>
</ul>
</div>
<div class="proof">
<p><em>Proof.</em> We show first that <span class="math inline">\(g_*
\gamma \in \mathfrak{C}(M,p,\theta)\)</span>. We choose a controlled
chart <span class="math inline">\(c : (M,p) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V,0)\)</span>. Let <span class="math inline">\(g \in G\)</span> with
<span class="math inline">\(g = 1 + o(|T|^{\delta-1})\)</span>. Let
<span class="math inline">\(\phi_g : V %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
V\)</span> denote the transport, via <span
class="math inline">\(c\)</span>, of the action map for <span
class="math inline">\(g\)</span>. By Lemma <a
href="#lem:standard2:G-defines-controlled-local-isoms"
data-reference-type="ref"
data-reference="lem:standard2:G-defines-controlled-local-isoms">131</a>,
it defines a controlled local isomorphism <span
class="math inline">\((V,0) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(V, \phi_g(0))\)</span>. Using <span class="math inline">\(c\)</span>,
we may identify <span
class="math inline">\(\mathfrak{C}(M,p,\theta)\)</span> with <span
class="math inline">\(\mathfrak{C}(V,0,\eta)\)</span> for some <span
class="math inline">\(\eta \in V^\wedge\)</span> with <span
class="math inline">\(\eta \ll 1\)</span>. Define <span
class="math inline">\(\eta &#39;\)</span> by requiring that <span
class="math inline">\(\phi &#39;_g(0)^* \eta &#39; = \eta\)</span>. By
Lemma <a href="#lem:if-rho-local" data-reference-type="ref"
data-reference="lem:if-rho-local">117</a>, we have <span
class="math display">\[(\phi_g)_* c_* \gamma \in \mathfrak{C}(V,
\phi_g(0), \eta &#39;).\]</span> Since <span class="math inline">\(\|g -
1\| \lll |T|^{\delta-1} \leqslant|T|^{-1/2}\)</span>, we have <span
class="math inline">\(\phi_g(0) \lll |T|^{\delta-1}\)</span> and <span
class="math inline">\(\eta &#39; = \eta + o(|T|^{-1/2})\)</span>, so by
Lemma <a href="#lem:insensitivity" data-reference-type="ref"
data-reference="lem:insensitivity">120</a>, <span
class="math display">\[\mathfrak{C}(V, \phi_g(0), \eta &#39;)
  =
  \mathfrak{C}(V,0,\eta &#39;) = \mathfrak{C}(V,0,\eta).\]</span> Thus
<span class="math inline">\((\phi_g)_* c_* \gamma  \in
\mathfrak{C}(V,0,\eta)\)</span> and so <span class="math inline">\(g_*
\gamma \in \mathfrak{C}(M,p,\theta)\)</span>, as required.</p>
<p>We now establish the refined assertions. In the non-archimedean case,
we see from</p>
<ul>
<li><p>the hypothesis <span class="math inline">\(g = 1 +
o(|T|^{\delta-1})\)</span>, and</p></li>
<li><p>Lemma <a href="#lem:controlled-uniform-continuity-origin"
data-reference-type="ref"
data-reference="lem:controlled-uniform-continuity-origin">99</a>,
applied to the given action map <span class="math inline">\(G \times M
\rightarrow  M\)</span>,</p></li>
</ul>
<p>that, for all <span class="math inline">\(v \in V\)</span> with <span
class="math inline">\(v = o(1)\)</span>, we have <span
class="math display">\[\phi_g(v) = v + o(|T|^{\delta-1}).\]</span> The
claimed equivariance property <a
href="#eq:g_-gamma-equivariance-non-arch" data-reference-type="eqref"
data-reference="eq:g_-gamma-equivariance-non-arch">\((6.22)\)</a>
then follows immediately from Definition <a
href="#defn:standard:let-v-be" data-reference-type="ref"
data-reference="defn:standard:let-v-be">112</a>.</p>
<p>Turning to the archimedean case, write <span class="math inline">\(g
= \exp(x)\)</span> with <span class="math inline">\(x \in
\mathop{\mathrm{Lie}}(G)\)</span>. Then each of the elements <span
class="math inline">\(\exp(t x)\)</span>, for <span
class="math inline">\(t \in [0,1]\)</span>, is likewise of the form
<span class="math inline">\(1 + o(|T|^{\delta-1})\)</span>, so by what
was just shown, each of the elements <span
class="math display">\[\gamma_t := \psi_{\mu(T \theta)}^{-1}(t x)
(\phi_{\exp(t x)})_* \gamma,\]</span> for <span class="math inline">\(t
\in [0,1]\)</span>, lies in the class <span
class="math inline">\(\mathfrak{C}(V,0,\theta,T,\delta)\)</span>. Our
aim is to verify that <span class="math display">\[\gamma_1 - \gamma_0
\in |T|^{1-\delta} \|g - 1\| \mathfrak{C}(V,0,\theta).\]</span> By the
fundamental theorem of calculus, it is enough to show that, for all
<span class="math inline">\(t \in [0,1]\)</span>, <span id="eq:partial_t-gamma_t-in" class="math display">\[\label{eq:partial_t-gamma_t-in}\tag{6.23}
  \partial_t \gamma_t  \in |T|^{1-\delta} \|g - 1\|
\mathfrak{C}(V,0,\theta).\]</span> Let <span
class="math inline">\(X\)</span> denotes vector field on <span
class="math inline">\(V\)</span>, defined near the origin, associated to
<span class="math inline">\(x\)</span>. Then <span
class="math display">\[\partial_t \gamma_t
  =
  X
  \gamma_t
  -
  \langle \mu(T \theta), x \rangle \gamma_t.\]</span> By Proposition <a
href="#lem:archimedean-vector-field-act-on-C-2"
data-reference-type="ref"
data-reference="lem:archimedean-vector-field-act-on-C-2">133</a>, it
follows that <span class="math display">\[\partial_t \gamma_t \in |T|^{1
- \delta} |x| \mathfrak{C}(V,0,\theta).\]</span> Since <span
class="math inline">\(|x| \asymp \|g-1\|\)</span>, the required
membership <a href="#eq:partial_t-gamma_t-in"
data-reference-type="eqref"
data-reference="eq:partial_t-gamma_t-in">\((6.23)\)</a>
follows. ◻</p>
</div>
<h4 id="sec:spec-group-sett">§6.4. Modulated bumps on Lie groups</h4>
<p>We may specialize Definition <a href="#defn:we-henceforth-denote"
data-reference-type="ref"
data-reference="defn:we-henceforth-denote">115</a> to the case that
<span class="math inline">\((M,p) = (G,1)\)</span> for some fixed
analytic group <span class="math inline">\(G\)</span> with identity
element <span class="math inline">\(1\)</span>. The group <span
class="math inline">\(G\)</span> acts on itself in three standard ways:
by left translation, right translation, and conjugation. The discussion
of §<a href="#sec:translation" data-reference-type="ref"
data-reference="sec:translation">1.3.10</a> applies to all three actions
(although in the case of conjugation, more precise estimates are
possible).</p>
<p>We often focus on the case that <span
class="math inline">\(p\)</span> is the identity element <span
class="math inline">\(1\)</span>, and accordingly abbreviate <span id="eq:mathfrakcg-theta-t" class="math display">\[\label{eq:mathfrakcg-theta-t}\tag{6.24}
\mathfrak{C}(G,\theta,T,\delta) :=
\mathfrak{C}(G,1,\theta,T,\delta)\]</span> We further abbreviate <span
class="math inline">\(\mathfrak{C}(G,\theta) := \mathfrak{C}(G, \theta,
T,\delta)\)</span> when <span class="math inline">\(T\)</span>, <span
class="math inline">\(\delta\)</span> are clear from context.</p>
<p>Recall that <span class="math inline">\(\mathcal{M}_c(G)\)</span>
denotes the space of compactly-supported smooth measures on <span
class="math inline">\(G\)</span>, of which <span
class="math inline">\(\mathfrak{C}(G,\theta)\)</span> is a subclass. For
<span class="math inline">\(\gamma \in \mathcal{M}_c(G)\)</span>, we
denote by <span class="math inline">\(\gamma^*\)</span> its adjoint,
i.e., the complex conjugate of the pushforward under the inversion map.
For <span class="math inline">\(\gamma_1, \gamma_2 \in
\mathcal{M}_c(G)\)</span>, we denote by <span
class="math inline">\(\gamma_1 \ast \gamma_2\)</span> their convolution,
i.e., the pushforward of <span class="math inline">\(\gamma_1 \times
\gamma_2\)</span> under the multiplication map <span
class="math inline">\(G \times G \rightarrow G\)</span>.</p>
<div id="lem:standard:subcl-mathfr-theta" class="proposition">
<p><strong>Proposition 135</strong>. <em>The subclass <span
class="math inline">\(\mathfrak{C}(G,\theta)\)</span> of <span
class="math inline">\(\mathcal{M}_c(G)\)</span> is closed under taking
adjoints and convolution.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline">\(\iota : G \rightarrow
G\)</span> denote the inversion map. Then <span
class="math inline">\(\iota^*(-\theta) = \theta\)</span>, so by Lemma <a
href="#lem:if-rho-local" data-reference-type="ref"
data-reference="lem:if-rho-local">117</a>, we obtain the class map <span
class="math inline">\(\iota_* : \mathfrak{C}(G,\theta) \rightarrow
\mathfrak{C}(G,-\theta)\)</span>. We verify readily that complex
conjugation induces <span class="math inline">\(\mathfrak{C}(G,-\theta)
\rightarrow \mathfrak{C}(G,\theta)\)</span>. We conclude that the
adjoint map <span class="math inline">\(\gamma \mapsto \gamma^*\)</span>
induces <span class="math inline">\(\mathfrak{C}(G,\theta) \rightarrow
\mathfrak{C}(G,\theta)\)</span>.</p>
<p>The multiplication map <span class="math inline">\(\mu : G \times G
\rightarrow G\)</span> is submersive at the identity and satisfies <span
class="math inline">\(\mu^*(\theta) = (\theta,\theta)\)</span>, so
closure under convolution follows from Proposition <a
href="#lem:assume-that-rho" data-reference-type="ref"
data-reference="lem:assume-that-rho">123</a>. ◻</p>
</div>
<h3 id="sec:parameters-stability">§7. Parameters and stability</h3>
<p>In this section, given a Lie group <span
class="math inline">\(G\)</span> over <span
class="math inline">\(\mathbb{R}\)</span>, we often denote simply by
<span class="math inline">\(\mathfrak{g} :=
\mathop{\mathrm{Lie}}(G)\)</span> its Lie algebra and by <span
class="math inline">\(\mathfrak{g}^\wedge :=
\mathop{\mathrm{Lie}}(G)^\wedge\)</span> the Pontryagin dual of the Lie
algebra. As explained in §<a href="#sec:pontry-dual-vect"
data-reference-type="ref"
data-reference="sec:pontry-dual-vect">1.1.1</a>, we may identify <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> with the imaginary
dual <span class="math inline">\(i \mathfrak{g}^* =
\mathop{\mathrm{Hom}}(\mathfrak{g}, i \mathbb{R})\)</span> of <span
class="math inline">\(\mathfrak{g}\)</span>. We write <span
class="math inline">\(\mathfrak{g}_\mathbb{C} :=
\mathfrak{g}\otimes_{\mathbb{R}} \mathbb{C}\)</span> for the
complexification of the Lie algebra and <span
class="math inline">\(\mathfrak{g}_\mathbb{C}^*\)</span> for the complex
dual, which identifies naturally with the complexification of <span
class="math inline">\(\mathfrak{g}^\wedge\)</span>.</p>
<p>We recall that <span class="math inline">\(\mathfrak{U}(G)\)</span>
and <span class="math inline">\(\mathfrak{Z}(G)\)</span> denote the
universal enveloping algebra and center for <span
class="math inline">\(\mathfrak{g}_{\mathbb{C}}\)</span>. We similarly
define <span class="math inline">\(\mathfrak{U}(\mathfrak{h})\)</span>,
<span
class="math inline">\(\mathfrak{U}(\mathfrak{h}_{\mathbb{C}})\)</span>
for any Lie algebra <span
class="math inline">\(\mathfrak{h}\)</span>.</p>
<h4 id="sec:prel-real-reduct">§7.1. Preliminaries on real reductive
groups</h4>
<p>Let <span class="math inline">\(G\)</span> be a connected reductive
group over <span class="math inline">\(\mathbb{R}\)</span>. In
particular, we may regard <span class="math inline">\(G\)</span> as a
Lie group over <span class="math inline">\(\mathbb{R}\)</span>.</p>
<h5 id="sec:regular-elements">§7.1.1. Regular elements</h5>
<p>A subscripted <span
class="math inline">\(\mathop{\mathrm{reg}}\)</span>, as in <span
class="math inline">\(\mathfrak{g}_{\mathop{\mathrm{reg}}}\)</span> or
<span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>,
denotes the subset of <em>regular</em> elements, i.e., those with <span
class="math inline">\(\mathfrak{g}\)</span>-centralizer of minimal
dimension.</p>
<h5 id="invariant-theoretic-quotients">Invariant-theoretic
quotients</h5>
<p>We denote by <span
class="math inline">\([\mathfrak{g}_\mathbb{C}^*]\)</span> the geometric
invariant theory quotient <span
class="math inline">\(\mathfrak{g}_\mathbb{C}^* /\!\!/G\)</span>, i.e.,
the spectrum of the ring of <span
class="math inline">\(G\)</span>-invariant polynomials <span
class="math inline">\(\mathfrak{g}_\mathbb{C}^* \rightarrow
\mathbb{C}\)</span>, and <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span> for its real form
corresponding to polynomials that are real-valued on <span
class="math inline">\(\mathfrak{g}^\wedge\)</span>. These come with
natural maps <span class="math display">\[\mathfrak{g}_\mathbb{C}^*
\rightarrow [\mathfrak{g}_\mathbb{C}^*], \quad \mathfrak{g}^\wedge
\rightarrow [\mathfrak{g}^\wedge],\]</span> which we denote by <span
class="math inline">\(\xi \mapsto [\xi]\)</span>.</p>
<p>There is a natural scaling action of <span
class="math inline">\(\mathbb{R}\)</span> on <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span> and of <span
class="math inline">\(\mathbb{C}\)</span> on <span
class="math inline">\([\mathfrak{g}_{\mathbb{C}}^*]\)</span>, compatible
with the vector space operations of <span
class="math inline">\(\mathbb{R}\)</span> on <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> and of <span
class="math inline">\(\mathbb{C}\)</span> on <span
class="math inline">\(\mathfrak{g}_{\mathbb{C}}^*\)</span>.</p>
<h5 id="harishchandra-isomorphism">Harish–Chandra isomorphism</h5>
<p>The Harish–Chandra isomorphism (see, e.g., <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
9.4)</a>) identifies the center <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g}_\mathbb{C})\)</span> of
the universal enveloping algebra with the ring <span
class="math inline">\(\mathop{\mathrm{Sym}}(\mathfrak{g}_{\mathbb{C}})^G\)</span>
of regular functions on <span
class="math inline">\([\mathfrak{g}_\mathbb{C}^*]\)</span>. We recall
its construction. Choose a Cartan subalgebra <span
class="math inline">\(\mathfrak{t}
\leqslant\mathfrak{g}_\mathbb{C}\)</span> and a decomposition <span
class="math inline">\(\mathfrak{g}_\mathbb{C} =
\mathfrak{n}_{\mathbb{C}}^- \oplus \mathfrak{t}_\mathbb{C} \oplus
\mathfrak{n}_{\mathbb{C}}\)</span> into positive and negative root
spaces. We may identify <span
class="math inline">\(\mathfrak{U}(\mathfrak{t}_\mathbb{C})\)</span>
with the symmetric algebra <span
class="math inline">\(\mathop{\mathrm{Sym}}(\mathfrak{t}_\mathbb{C})\)</span>.
Then <span id="eqn:decomposition-for-HC" class="math display">\[\label{eqn:decomposition-for-HC}\tag{7.1}
  \mathfrak{U}(\mathfrak{g}_\mathbb{C})
  = (\mathfrak{n}_{\mathbb{C}}^- \mathfrak{U}(\mathfrak{g}_{\mathbb{C}})
  + \mathfrak{U}(\mathfrak{g}_{\mathbb{C}})
  \mathfrak{n}_{\mathbb{C}})
  \oplus \mathop{\mathrm{Sym}}(\mathfrak{t}_\mathbb{C}).\]</span> Let
<span class="math inline">\(\rho \in \mathfrak{t}_\mathbb{C}^*\)</span>
denote the half-sum of positive roots. Let <span
class="math inline">\(\sigma\)</span> denote the algebra automorphism of
<span
class="math inline">\(\mathop{\mathrm{Sym}}(\mathfrak{t}_\mathbb{C})\)</span>
given on <span class="math inline">\(\mathfrak{t}_\mathbb{C}\)</span> by
<span class="math inline">\(t \mapsto t - \rho(t)\)</span>. The
Harish–Chandra isomorphism is then the composition <span
class="math display">\[\mathfrak{Z}(\mathfrak{g}_\mathbb{C})
\xrightarrow{\mathop{\mathrm{HC}}}
\mathop{\mathrm{Sym}}(\mathfrak{t}_\mathbb{C})^W
  \cong
  \mathop{\mathrm{Sym}}(\mathfrak{g}_{\mathbb{C}})^G \cong
\{\text{regular functions on } [\mathfrak{g}_\mathbb{C}^*]\}\]</span>
<span class="math display">\[\mathop{\mathrm{HC}}(z) :=
\sigma(z_T),\]</span> where <span class="math inline">\(z_T \in
\mathop{\mathrm{Sym}}(\mathfrak{g}_\mathbb{C})\)</span> denotes the
component of <span class="math inline">\(z\)</span> with respect to the
decomposition <a href="#eqn:decomposition-for-HC"
data-reference-type="eqref"
data-reference="eqn:decomposition-for-HC">\((7.1)\)</a>.</p>
<h5 id="sec:infin-char">§7.1.4. Infinitesimal characters</h5>
<p>Let <span class="math inline">\(\pi\)</span> be an irreducible
admissible representation of <span class="math inline">\(G\)</span>.
Then <span
class="math inline">\(\mathfrak{Z}(\mathfrak{g}_{\mathbb{C}})\)</span>
acts on <span class="math inline">\(\pi\)</span> by scalars. Using the
Harish–Chandra isomorphism, we may thus associate to <span
class="math inline">\(\pi\)</span> an <em>infinitesimal character</em>
<span class="math inline">\(\lambda_\pi \in
[\mathfrak{g}^*_{\mathbb{C}}]\)</span>, characterized as follows: <span
class="math inline">\(z \in
\mathfrak{Z}(\mathfrak{g}_{\mathbb{C}})\)</span> acts on <span
class="math inline">\(\pi\)</span> as multiplication by <span
class="math inline">\(\mathop{\mathrm{HC}}(z)(\lambda_\pi)\)</span>,
where we identify <span
class="math inline">\(\mathop{\mathrm{HC}}(z)\)</span> with a regular
function on <span
class="math inline">\([\mathfrak{g}^*_{\mathbb{C}}]\)</span> as above.
If <span class="math inline">\(\pi\)</span> is unitary, then <span
class="math inline">\(\lambda_\pi \in [\mathfrak{g}^\wedge]\)</span>
(see <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P. D.
Nelson and Venkatesh 2021, sec. 9.5)</a>).</p>
<h5 id="dual-groups">Dual groups</h5>
<p>We write <span class="math inline">\(G^\vee\)</span> for the complex
dual group and <span class="math inline">\(\mathfrak{g}^\vee\)</span>
for its complex Lie algebra. For any Cartan subalgebras <span
class="math inline">\(\mathfrak{t}_\mathbb{C}
\leqslant\mathfrak{g}_\mathbb{C}\)</span> and <span
class="math inline">\(\mathfrak{t}^\vee
\leqslant\mathfrak{g}^\vee\)</span>, we may canonically identify <span id="eqn:inf-chars-via-langlands-params" class="math display">\[\label{eqn:inf-chars-via-langlands-params}\tag{7.2}
  \mathfrak{g}^\vee /\!\!/G^\vee
  \cong \mathfrak{t}^\vee / W
  \cong \mathfrak{t}_\mathbb{C}^*/W \cong
[\mathfrak{g}_\mathbb{C}^*],\]</span> where <span
class="math inline">\(W\)</span> denotes the Weyl group (see <a href="#ref-nelson-venkatesh-1"
class="citation" data-cites="nelson-venkatesh-1">(P. D. Nelson and
Venkatesh 2021, sec. 15.1)</a>).</p>
<h4 id="sec:gener-line-groups">§7.2. General linear groups</h4>
<p>We may specialize the above discussion to the case of a general
linear group <span class="math inline">\(G\)</span> over the reals, say
<span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. Then <span
class="math inline">\(\mathfrak{g}\)</span> is the space <span
class="math inline">\({\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R})\)</span>
of <span class="math inline">\(n \times n\)</span> real matrices. We
have <span class="math inline">\(G^\vee =
{\mathop{\mathrm{GL}}}_n(\mathbb{C})\)</span> and <span
class="math inline">\(\mathfrak{g}^\vee =
{\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{C})\)</span>.</p>
<h5 id="sec:char-polyn">§7.2.1. Characteristic polynomials</h5>
<p>We denote by <span class="math inline">\(e :
{\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R}) \rightarrow
\mathop{\mathrm{Sym}}(\mathfrak{g})\)</span> the “identity map” coming
from the identity <span
class="math inline">\({\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R})
= \mathfrak{g}\)</span> and the inclusion <span
class="math inline">\(\mathfrak{g} \hookrightarrow
\mathop{\mathrm{Sym}}(\mathfrak{g})\)</span>. We regard <span
class="math inline">\(e\)</span> as a matrix <span
class="math inline">\((e_{i j})\)</span>, with entries <span
class="math inline">\(e_{i j} \in \mathfrak{g} \hookrightarrow
\mathop{\mathrm{Sym}}(\mathfrak{g})\)</span>, and form the
characteristic polynomial <span id="eq:detx-+-e" class="math display">\[\begin{align}
\label{eq:detx-+-e}\tag{7.3}
  \det(X + e)
  &amp;:=
    \sum _{\sigma \in S(n)}
    (-1)^\sigma
    \prod_{i=1}^n
    (1_{i=\sigma(i)} X
    + e_{i,\sigma(i)})
  \\ \nonumber
  &amp;=
    X^n +
    \mathfrak{c}_1 X^{n-1}
    + \dotsb + \mathfrak{c}_n,
\end{align}\]</span> which defines a polynomial in the variable <span
class="math inline">\(X\)</span> with coefficients <span
class="math inline">\(\mathfrak{c}_j\)</span> in the ring <span
class="math inline">\(\mathop{\mathrm{Sym}}(\mathfrak{g})^G\)</span> of
<span class="math inline">\(G\)</span>-invariant elements of <span
class="math inline">\(\mathop{\mathrm{Sym}}(\mathfrak{g})\)</span>. We
may identify each <span class="math inline">\(\mathfrak{c}_j\)</span>
with a <span class="math inline">\(G\)</span>-invariant polynomial <span
class="math inline">\(\mathfrak{g}_\mathbb{C}^* \rightarrow
\mathbb{C}\)</span>, hence with a regular function <span
class="math inline">\([\mathfrak{g}_\mathbb{C}^*] \rightarrow
\mathbb{C}\)</span>. The resulting map <span
class="math display">\[\det(X + e) : [\mathfrak{g}_\mathbb{C}^*]
\rightarrow \{ \text{monic degree $n$ polynomials over $\mathbb{C}$}
\}\]</span> is an isomorphism. For <span class="math inline">\(\lambda
\in [\mathfrak{g}_{\mathbb{C}}^*]\)</span>, we denote by <span
class="math inline">\(\mathcal{P}_\lambda(X) \in \mathbb{C}[X]\)</span>
the corresponding polynomial, i.e., <span id="eq:polynomial-P-lambda" class="math display">\[\label{eq:polynomial-P-lambda}\tag{7.4}
  \mathcal{P}_\lambda(X) := \det(X+e)(\lambda) = X^n +
\mathfrak{c}_1(\lambda) X^{n-1} + \dotsb +
\mathfrak{c}_n(\lambda).\]</span></p>
<p>We have noted that the space <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> identifies
(canonically) with the imaginary dual of <span
class="math inline">\(\mathfrak{g}\)</span>, hence, via the trace
pairing, with the space <span class="math inline">\(i
{\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R})\)</span> of
<span class="math inline">\(n \times n\)</span> imaginary matrices:
<span class="math display">\[i
{\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R}) \cong
\mathfrak{g}^\wedge\]</span> <span class="math display">\[\xi \mapsto [x
\mapsto \mathop{\mathrm{trace}}(x \xi)].\]</span> With respect to this
identification, we see that for <span class="math inline">\(\xi \in
\mathfrak{g}^\wedge\)</span> with image <span
class="math inline">\([\xi] \in [\mathfrak{g}^\wedge]\)</span>, <span
class="math display">\[\det(X + \xi) = \mathcal{P}_{[\xi]}(X) = \det(X +
e)(\xi).\]</span> In other words, the map <span
class="math inline">\(\xi \mapsto \mathcal{P}_{[\xi]}(X)\)</span>
associates to <span class="math inline">\(\xi\)</span> its
characteristic polynomial.</p>
<h5 id="eigenvalues">Eigenvalues</h5>
<p>Let <span class="math inline">\(\lambda \in
[\mathfrak{g}_\mathbb{C}^*]\)</span>. Under <a
href="#eqn:inf-chars-via-langlands-params" data-reference-type="eqref"
data-reference="eqn:inf-chars-via-langlands-params">\((7.2)\)</a>,
we may identify <span class="math inline">\(\lambda\)</span> with an
element of <span class="math inline">\(\mathfrak{t}^\vee/W\)</span>. We
write <span class="math inline">\(t_\lambda \in
\mathfrak{t}^\vee\)</span> for any lift of that element, well-defined up
to <span class="math inline">\(W\)</span>. We write <span
class="math display">\[\mathop{\mathrm{eval}}(\lambda) =
\{\lambda_1,\dotsc,\lambda_n\}\]</span> for the multiset of eigenvalues
of <span class="math inline">\(t_\lambda\)</span>. (This definition is
consistent with that of <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
13.4.1)</a>.) The characteristic polynomial <span
class="math inline">\(\det(X + t_\lambda) \in \mathbb{C}[X]\)</span>
then coincides with <span
class="math inline">\(\mathcal{P}_\lambda(X)\)</span>, as defined above:
<span id="eq:detx-+-t_lambda" class="math display">\[\label{eq:detx-+-t_lambda}\tag{7.5}
  \det(X + t_\lambda) = \mathcal{P}_{\lambda}(X).\]</span></p>
<h5
id="characterizations-of-mathfrakgwedge-subseteq-mathfrakg_mathbbc">Characterizations
of <span class="math inline">\([\mathfrak{g}^\wedge] \subseteq
[\mathfrak{g}_{\mathbb{C}}^*]\)</span></h5>
<p>We observe that the following conditions on <span
class="math inline">\(\lambda \in [\mathfrak{g}_\mathbb{C}^*]\)</span>
are equivalent to each other.</p>
<ul>
<li><p><span class="math inline">\(\lambda \in
[\mathfrak{g}^\wedge]\)</span>.</p></li>
<li><p><span class="math inline">\(- \overline{t_\lambda} \in W \cdot
t_\lambda\)</span>.</p></li>
<li><p><span class="math inline">\(\mathfrak{c}_1(\lambda),
\mathfrak{c}_3(\lambda), \mathfrak{c}_5(\lambda), \dotsc \in i
\mathbb{R}\)</span>, <span
class="math inline">\(\mathfrak{c}_2(\lambda), \mathfrak{c}_4(\lambda),
\mathfrak{c}_6(\lambda), \dotsc \in \mathbb{R}\)</span>.</p></li>
</ul>
<p>Thus the map <span class="math inline">\(\lambda \mapsto
\mathcal{P}_\lambda\)</span> defines a bijection between <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span> and the space of
polynomials <span class="math inline">\(X^n + c_1 X^{n-1} + \dotsb +
c_n\)</span> with <span class="math inline">\(c_{2 j} \in
\mathbb{R}\)</span> and <span class="math inline">\(c_{2j - 1} \in i
\mathbb{R}\)</span>.</p>
<h5 id="scaling">Scaling</h5>
<p>The scaling action of <span class="math inline">\(\mathbb{R}\)</span>
on <span class="math inline">\([\mathfrak{g}^\wedge]\)</span> (or of
<span class="math inline">\(\mathbb{C}\)</span> on <span
class="math inline">\([\mathfrak{g}_{\mathbb{C}}^*]\)</span>) may be
described explicitly as follows. For <span
class="math inline">\((t,\lambda) \in \mathbb{R} \times
[\mathfrak{g}^\wedge]\)</span>, the scaled element <span
class="math inline">\(t \lambda \in [\mathfrak{g}^\wedge]\)</span> is
characterized by <span id="eq:cal-P-t-lambda" class="math display">\[\label{eq:cal-P-t-lambda}\tag{7.6}
  \mathcal{P}_{t \lambda}(X) = t^{n} \mathcal{P}_{\lambda}(t^{-1} X)
  =
  X^n + t \mathfrak{c}_1(\lambda) X^{n-1} + \dotsb + t^n
\mathfrak{c}_n(\lambda).\]</span> Equivalently, the roots of <span
class="math inline">\(\mathcal{P}_{t \lambda}\)</span> are obtained by
multiplying those of <span
class="math inline">\(\mathcal{P}_{\lambda}\)</span> by <span
class="math inline">\(t\)</span>.</p>
<h5 id="infinitesimal-characters-and-parameters">Infinitesimal
characters and parameters</h5>
<p>Let <span class="math inline">\(\pi\)</span> be an irreducible
admissible representation of <span class="math inline">\(G\)</span>. It
has an infinitesimal character <span class="math inline">\(\lambda_\pi
\in [\mathfrak{g}_{\mathbb{C}}^*]\)</span>, which, as we have noted (§<a
href="#sec:infin-char" data-reference-type="ref"
data-reference="sec:infin-char">2.1.4</a>), belongs to <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span> when <span
class="math inline">\(\pi\)</span> is unitary. We may in any case
associate to <span class="math inline">\(\pi\)</span> a semisimple
element <span class="math inline">\(t_{\lambda_\pi}\)</span> and a
multiset <span
class="math inline">\(\mathop{\mathrm{eval}}(\lambda_{\pi}) =
\{\lambda_{\pi,1},\dotsc, \lambda_{\pi,n}\}\)</span> of complex numbers.
We refer to these numbers as the “archimedean Satake parameters” of
<span class="math inline">\(\pi\)</span>.</p>
<p>By the discussion of <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
15.4)</a>, the standard local <span
class="math inline">\(L\)</span>-factor for <span
class="math inline">\(\pi\)</span> is given in terms of the
infinitesimal character by <span class="math display">\[L(\pi,s) =
  \prod_j \Gamma_\mathbb{R}(s + \lambda_{\pi,j}^+ + a_j),\]</span> where
the elements <span class="math inline">\(a_j \in \{0, 1\}\)</span>
depend upon <span class="math inline">\(\pi\)</span> and we set <span
class="math display">\[(x + i y)^+ := |x| + i y, \quad
\Gamma_\mathbb{R}(s) := \pi^{-s/2} \Gamma(s/2), \quad
\Gamma_{\mathbb{C}}(s) := 2 (2 \pi)^{-s} \Gamma(s).\]</span> (Strictly
speaking, it is assumed in parts of <em>loc. cit.</em> that <span
class="math inline">\(\pi\)</span> is tempered, but the same argument
applies in general, using the Langlands decomposition <a href="#ref-MR855239"
class="citation" data-cites="MR855239">(Knapp 1986, Theorem 8.54)</a>
and the compatibility of infinitesimal characters with induction <a href="#ref-MR855239"
class="citation" data-cites="MR855239">(Knapp 1986, Proposition
8.22)</a> to reduce to the tempered case. See also <a href="#ref-MR1395406"
class="citation" data-cites="MR1395406">(Rudnick and Sarnak 1996,
Appendix)</a>.)</p>
<p>In §<a href="#sec:subc-bounds-assum" data-reference-type="ref"
data-reference="sec:subc-bounds-assum">1.2</a>, we referred to the
numbers <span class="math inline">\(t_j = \lambda_{\pi,j}^+ +
a_j\)</span> as the “archimedean <span
class="math inline">\(L\)</span>-function parameters” of <span
class="math inline">\(\pi\)</span> (or more precisely, of a global
automorphic representation having <span
class="math inline">\(\pi\)</span> as its local component at <span
class="math inline">\(\infty\)</span>). These are not quite the same as
the “archimedean Satake parameters” <span
class="math inline">\(\lambda_{\pi,j}\)</span> described above, but they
have very similar asymptotic behavior. For instance:</p>
<div id="itm:standard2:compare-parameters-3" class="lemma">
<p><strong>Lemma 136</strong>. <span id="lem:standard:let-t-geq"
label="lem:standard:let-t-geq"></span> Let <span class="math inline">\(T
\geqslant 1\)</span>. Let <span class="math inline">\(\pi\)</span> be an
irreducible admissible representation of <span
class="math inline">\(G\)</span>. The following are equivalent:</p>
<ol type="i">
<li><p><span id="itm:standard2:compare-parameters-1"
label="itm:standard2:compare-parameters-1"></span> The rescaled
infinitesimal character <span class="math inline">\(T^{-1}
\lambda_\pi\)</span> lies in some fixed compact subset of <span
class="math inline">\([\mathfrak{g}_{\mathbb{C}}^*]\)</span>.</p></li>
<li><p><span id="itm:standard2:compare-parameters-2"
label="itm:standard2:compare-parameters-2"></span> Each archimedean
Satake parameter <span class="math inline">\(\lambda_{\pi,j}\)</span> is
of the form <span
class="math inline">\(\operatorname{O}(T)\)</span>.</p></li>
<li><p>Each archimedean <span class="math inline">\(L\)</span>-function
parameter <span class="math inline">\(\lambda_{\pi,j}^+ + a_j\)</span>
is of the form <span
class="math inline">\(\operatorname{O}(T)\)</span>.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> By <a href="#eq:detx-+-t_lambda"
data-reference-type="eqref"
data-reference="eq:detx-+-t_lambda">\((7.5)\)</a> and <a
href="#eq:cal-P-t-lambda" data-reference-type="eqref"
data-reference="eq:cal-P-t-lambda">\((7.6)\)</a>, <span
class="math display">\[\mathcal{P}_{T^{-1} \lambda_\pi}(X) = \prod_j (X
+ T^{-1} \lambda_{\pi_j}).\]</span> The equivalence between <a
href="#itm:standard2:compare-parameters-1" data-reference-type="eqref"
data-reference="itm:standard2:compare-parameters-1">\((i)\)</a>
and <a href="#itm:standard2:compare-parameters-2"
data-reference-type="eqref"
data-reference="itm:standard2:compare-parameters-2">\((ii)\)</a>
follows from the fact that a degree <span
class="math inline">\(n\)</span> monic polynomial has coefficients of
size <span class="math inline">\(\operatorname{O}(1)\)</span> if and
only if its (negated) roots are of size <span
class="math inline">\(\operatorname{O}(1)\)</span>. The equivalence
between <a href="#itm:standard2:compare-parameters-2"
data-reference-type="eqref"
data-reference="itm:standard2:compare-parameters-2">\((ii)\)</a>
and <a href="#itm:standard2:compare-parameters-3"
data-reference-type="eqref"
data-reference="itm:standard2:compare-parameters-3">\((iii)\)</a>
follows from the fact that <span class="math inline">\(a_j \in
\{0,1\}\)</span> and <span class="math inline">\(|z| =
|z^+|\)</span>. ◻</p>
</div>
<h4 id="general-linear-pairs">General linear pairs</h4>
<p>Let <span class="math inline">\((G,H)\)</span> be a general linear
pair over <span class="math inline">\(\mathbb{R}\)</span>, say <span
class="math inline">\((G,H) = ({\mathop{\mathrm{GL}}}_n(\mathbb{R}),
{\mathop{\mathrm{GL}}}_{n-1}(\mathbb{R}))\)</span>. The above discussion
then applies both to <span class="math inline">\(\mathfrak{g} =
\mathop{\mathrm{Lie}}(G)\)</span> and to <span
class="math inline">\(\mathfrak{h} = \mathop{\mathrm{Lie}}(H)\)</span>.
For <span class="math inline">\(\xi \in \mathfrak{g}^\wedge\)</span>, we
let <span class="math inline">\(\xi_H \in \mathfrak{h}^\wedge\)</span>
denote its restriction.</p>
<h5 id="sec:stability">§7.3.1. Stability</h5>
<div class="definition">
<p><strong>Definition 137</strong>. We say that a pair <span
class="math inline">\((\lambda, \mu ) \in [\mathfrak{g} ^\wedge ] \times
[\mathfrak{h} ^\wedge ]\)</span> is <em>stable</em> if the eigenvalue
multisets <span
class="math inline">\(\mathop{\mathrm{eval}}(\lambda)\)</span> and <span
class="math inline">\(\mathop{\mathrm{eval}}(\mu)\)</span> have no
common element.</p>
</div>
<div class="definition">
<p><strong>Definition 138</strong>. We say that <span
class="math inline">\(\xi \in \mathfrak{g}^\wedge\)</span> is
<em>stable</em> if it is stable with respect to <span
class="math inline">\(H\)</span> in the sense of geometric invariant
theory, i.e., if it has finite <span
class="math inline">\(H\)</span>-stabilizer and (Zariski) closed <span
class="math inline">\(H\)</span>-orbit. We denote by <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}
\subseteq \mathfrak{g}^\wedge\)</span> the subset consisting of stable
elements.</p>
</div>
<p>The two definitions are related as follows (see, e.g., <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
Lemma 11.4)</a>):</p>
<div class="lemma">
<p><strong>Lemma 139</strong>. The stable subset <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>
of <span class="math inline">\(\mathfrak{g}^\wedge\)</span> is the
preimage of <span class="math inline">\(\{\text{stable } (\lambda, \mu )
\in [\mathfrak{g}^\wedge] \times [\mathfrak{h}^\wedge]\}\)</span> under
the map <span class="math inline">\(\xi \mapsto ([\xi],
[\xi_H])\)</span>.</p>
</div>
<p>In particular, <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>
is the dense open subset of <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> given by the
nonvanishing of the polynomial <span
class="math display">\[\mathfrak{g}^\wedge  \ni \xi \mapsto
\mathcal{R}(\xi) := \operatorname{Resultant} (\mathcal{P}_{[\xi]},
\mathcal{P}_{[\xi_H]}).\]</span> Here <span class="math inline">\([\xi]
\in [\mathfrak{g}^\wedge] \subseteq
[\mathfrak{g}_{\mathbb{C}}^*]\)</span> and <span
class="math inline">\([\xi_H] \in [\mathfrak{h}^\wedge] \subseteq
[\mathfrak{h}_{\mathbb{C}}^*]\)</span> give rise to polynomials <span
class="math inline">\(\mathcal{P}_{[\xi]},
\mathcal{P}_{[\xi_H]}\)</span> via <a href="#eq:polynomial-P-lambda"
data-reference-type="eqref"
data-reference="eq:polynomial-P-lambda">\((7.4)\)</a>.</p>
<p>We obtain the following equivalence:</p>
<div id="lem:standard2:stability-vs-resultant" class="lemma">
<p><strong>Lemma 140</strong>. Let <span
class="math inline">\(\tau\)</span> belong to some fixed compact subset
of <span class="math inline">\(\mathfrak{g}^\wedge\)</span>. Then the
following are equivalent:</p>
<ol type="i">
<li><p><span class="math inline">\(\tau\)</span> belongs to some fixed
compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>.</p></li>
<li><p><span class="math inline">\(\mathcal{R}(\xi) \gg
1\)</span>.</p></li>
</ol>
</div>
<h5 id="sec:parameter-theta">§7.3.2. The parameter <span
class="math inline">\(\theta\)</span></h5>
<p>Let <span class="math inline">\(P\)</span> denote the mirabolic
subgroup of <span class="math inline">\(G\)</span>, consisting of
elements with bottom row <span
class="math inline">\((0,\dotsc,0,1)\)</span>. Recall that <span
class="math inline">\(\bar{B}_H\)</span> denotes the lower-triangular
Borel subgroup of <span class="math inline">\(H\)</span>. The Lie
algebra of the mirabolic subgroup then decomposes as <span
class="math display">\[\mathop{\mathrm{Lie}}(P) =
\mathop{\mathrm{Lie}}(N) \oplus
\mathop{\mathrm{Lie}}(\bar{B}_H).\]</span></p>
<p>Let <span class="math inline">\(\psi\)</span> be a nondegenerate
unitary character of <span class="math inline">\(N\)</span>. We denote
by <span class="math display">\[\theta_P(\psi)  \in
\mathop{\mathrm{Lie}}(P)^\wedge\]</span> the unique element with trivial
restriction to <span
class="math inline">\(\mathop{\mathrm{Lie}}(\bar{B}_H)\)</span> that
satisfies, for all <span class="math inline">\(x \in
\mathop{\mathrm{Lie}}(N)\)</span>, <span
class="math display">\[\psi(\exp(x)) = \exp (\langle x,
\theta_P(\psi)  \rangle).\]</span> We recall that, by Definition <a
href="#defn:standard2:given-point-manif" data-reference-type="ref"
data-reference="defn:standard2:given-point-manif">110</a>, we may
associate to each <span class="math inline">\(\xi \in
\mathop{\mathrm{Lie}}(P)^\wedge\)</span> and chart <span
class="math inline">\(c : (P,1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(\mathop{\mathrm{Lie}}(P),0)\)</span> a function <span
class="math inline">\(\psi_{\xi, \log} : P %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
\mathop{\mathrm{U}}(1)\)</span>, defined near the identity element. (The
use of “<span class="math inline">\(\psi\)</span>” in this notation is
purely symbolic, unrelated to the character <span
class="math inline">\(\psi\)</span> under consideration.) In particular,
we may define <span
class="math inline">\(\psi_{\theta_P(\psi),\log}\)</span> with respect
to the chart <span class="math inline">\(\log :  (P, 1) %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
(\mathop{\mathrm{Lie}}(P), 0)\)</span>. Then <span
class="math display">\[\psi(\exp(x)) = \psi_{\theta_P(\psi), \log}(x)
\quad \text{ for } x \in N,\]</span> while <span
class="math inline">\(\psi_{\theta_P(\psi), \log}(x) = 1\)</span> for
<span class="math inline">\(x \in \bar{B}_H\)</span>.</p>
<p>Using the trace form, we may identify <span
class="math inline">\(\mathop{\mathrm{Lie}}(P)^\wedge\)</span> with a
quotient of <span class="math inline">\(\mathfrak{g}^\wedge = i
{\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R})\)</span>, e.g.,
when <span class="math inline">\(n=4\)</span>, <span
class="math display">\[\mathop{\mathrm{Lie}}(P)^\wedge \leftrightarrow
  \begin{pmatrix}
    \ast &amp; \ast &amp; \ast &amp; ? \\
    \ast &amp; \ast &amp; \ast &amp; ? \\
    \ast &amp; \ast &amp; \ast &amp; ? \\
    \ast &amp; \ast &amp; \ast &amp; ?
  \end{pmatrix}.\]</span> The meaning of this notation is that <span
class="math inline">\(\mathop{\mathrm{Lie}}(P)^\wedge\)</span>
identifies with the space of equivalence clases of <span
class="math inline">\(n \times n\)</span> imaginary matrices, where two
such matrices are declared equivalent if they have the same entries
except possibly in their rightmost columns. We may write <span id="eq:psiu-=-sum_i=1n" class="math display">\[\label{eq:psiu-=-sum_i=1n}\tag{7.7}
  \psi(u) = \sum_{i=1}^{n-1} \exp(\eta_i u_{i,i+1})\]</span> for some
nonzero imaginary numbers <span
class="math inline">\(\eta_1,\dotsc,\eta_{n-1}\)</span> (e.g., each
<span class="math inline">\(\eta_j = 2 \pi \sqrt{-1}\)</span> for a
suitable sign). Then, under the above identification, <span id="eq:theta-leftr-beginpm" class="math display">\[\label{eq:theta-leftr-beginpm}\tag{7.8}
  \theta_P(\psi)
  \leftrightarrow
  \begin{pmatrix}
    0 &amp; 0 &amp; 0 &amp; ? \\
    \eta_1  &amp; 0 &amp; 0 &amp; ? \\
    0 &amp; \eta_2  &amp; 0 &amp; ? \\
    0 &amp; 0 &amp; \eta_3  &amp; ?
  \end{pmatrix}.\]</span></p>
<h5 id="sec:parameter-tau">§7.3.3. The parameter <span
class="math inline">\(\tau\)</span></h5>
<p>For <span class="math inline">\(\xi \in \mathfrak{g}^\wedge\)</span>,
we denote by <span class="math inline">\(\xi_P \in
\mathop{\mathrm{Lie}}(P)^\wedge\)</span> its restriction. We have the
following simple linear algebra lemma, closely related to “rational
canonical form:”</p>
<div id="lem:construction-tau-from-theta" class="lemma">
<p><strong>Lemma 141</strong>. For each nondegenerate unitary character
<span class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span> and <span class="math inline">\(\lambda
\in [\mathfrak{g}^\wedge]\)</span>, there is a unique element <span
class="math inline">\(\tau = \tau(\psi,\lambda) \in
\mathfrak{g}^\wedge\)</span> such that <span
class="math display">\[[\tau] = \lambda, \quad \tau_P =
\theta_P(\psi).\]</span> Moreover, <span
class="math inline">\(\tau\)</span> may be given explicitly with respect
to the identification <span class="math inline">\(\mathfrak{g}^\wedge =
i {\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R})\)</span> by
<span class="math display">\[\tau_{i j} =
    \begin{cases}
      \eta_j   &amp; \text{ if } i = j+1, \\
      (-\eta_n) \dotsb (-\eta_{i+1}) \mathfrak{c}_{n+1-i}
      &amp; \text{ if } j = n, \\
      0 &amp; \text{ otherwise}.
    \end{cases}\]</span></p>
</div>
<p>For example, when <span class="math inline">\(n=4\)</span> and <span
class="math inline">\(\psi\)</span> is as in <a
href="#eq:psiu-=-sum_i=1n" data-reference-type="eqref"
data-reference="eq:psiu-=-sum_i=1n">\((7.7)\)</a>, the
element <span class="math inline">\(\tau\)</span> is given by <span id="eqn:tau-three-by-three-theta-lambda" class="math display">\[\label{eqn:tau-three-by-three-theta-lambda}\tag{7.9}
  \tau
  =
  \begin{pmatrix}
    0 &amp; 0 &amp; 0 &amp;  - \mathfrak{c}_4(\lambda)  / \eta_1 \eta_2
\eta_3 \\
    \eta_1  &amp; 0 &amp; 0 &amp; \mathfrak{c}_3(\lambda)  / \eta_2
\eta_3\\
    0 &amp; \eta_2 &amp; 0 &amp; -\mathfrak{c}_2(\lambda)/ \eta_3 \\
    0 &amp; 0 &amp; \eta_3 &amp; \mathfrak{c}_1(\lambda)
  \end{pmatrix}.\]</span></p>
<div class="proof">
<p><em>Proof.</em> It is clear that <span
class="math inline">\(\tau\)</span> as in <a
href="#eqn:tau-three-by-three-theta-lambda" data-reference-type="eqref"
data-reference="eqn:tau-three-by-three-theta-lambda">\((7.9)\)</a>
satisfies <span class="math inline">\(\tau_P = \theta_P(\psi)\)</span>,
and a direct calculation gives <span class="math inline">\(\det(X +
\tau) = \mathcal{P}_\lambda(X)\)</span>.</p>
<p>As for uniqueness, the condition <span class="math inline">\(\tau_P =
\theta_P(\psi)\)</span> implies that <span
class="math inline">\(\theta_P(\psi)\)</span> looks like <a
href="#eqn:tau-three-by-three-theta-lambda" data-reference-type="eqref"
data-reference="eqn:tau-three-by-three-theta-lambda">\((7.9)\)</a>,
except possibly with a different rightmost column; to determine that
column, we evaluate the characteristic polynomial <span
class="math inline">\(\det(X + \tau)\)</span> and compare its
coefficients with those of <span
class="math inline">\(\mathcal{P}_\lambda(X)\)</span>. ◻</p>
</div>
<p>Lemma <a href="#lem:construction-tau-from-theta"
data-reference-type="ref"
data-reference="lem:construction-tau-from-theta">141</a> allows us to
make the following definition.</p>
<div id="defn:parameter-tau-pi-T" class="definition">
<p><strong>Definition 142</strong>. Let <span
class="math inline">\(\psi\)</span> be a nondegenerate unitary character
of <span class="math inline">\(N\)</span>. Let <span
class="math inline">\(T \geqslant 1\)</span>. Let <span
class="math inline">\(\pi\)</span> be an irreducible unitary
representation of <span class="math inline">\(G\)</span>. We denote by
<span class="math inline">\(\tau(\pi,\psi,T) \in
\mathfrak{g}^\wedge\)</span> the unique element with <span id="eq:tau-characterize-via-pi" class="math display">\[\label{eq:tau-characterize-via-pi}\tag{7.10}
  [\tau(\pi,\psi,T)] = T^{-1} \lambda_\pi,
  \quad
  \tau(\pi,\psi,T)_P = \theta_P(\psi).\]</span></p>
</div>
<div class="lemma">
<p><strong>Lemma 143</strong>. In the setting of Definition <a
href="#defn:parameter-tau-pi-T" data-reference-type="ref"
data-reference="defn:parameter-tau-pi-T">142</a>, assume that <span
class="math inline">\(\psi\)</span> is fixed and that <span
class="math inline">\(T^{-1} \lambda_\pi\)</span> belongs to some fixed
compact subset of <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span>. Then <span
class="math inline">\(\tau(\pi,\psi,T)\)</span> belongs to some fixed
compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Fix <span class="math inline">\(C \geqslant
0\)</span> so that each <span class="math inline">\(|\mathfrak{c}_j
(T^{-1} \lambda_\pi)| \leqslant C\)</span>. Let <span
class="math inline">\(\mathcal{D} \subseteq \mathfrak{g}^\wedge\)</span>
denote the set of matrices of the form, e.g., for <span
class="math inline">\(n=4\)</span>, <span
class="math display">\[\begin{pmatrix}
      0 &amp; 0 &amp; 0 &amp; \ast \\
      \eta_1  &amp; 0 &amp; 0 &amp; \ast \\
      0 &amp; \eta_2  &amp; 0 &amp; \ast \\
      0 &amp; 0 &amp; \eta_3  &amp;  \ast
    \end{pmatrix},\]</span> where each entry <span
class="math inline">\(\ast\)</span> has magnitude bounded by <span
class="math inline">\(C\)</span>. Then <span
class="math inline">\(\tau(\pi,\psi,T) \in \mathcal{D}\)</span>. Every
element of <span class="math inline">\(\mathcal{D}\)</span> is regular
(e.g., because the standard basis element <span
class="math inline">\(e_1\)</span> is a cyclic vector for such
elements), and <span class="math inline">\(\mathcal{D}\)</span> is fixed
and compact, thus <span class="math inline">\(\mathcal{D}\)</span> is a
fixed compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>. ◻</p>
</div>
<div id="itm:standard2:characterize-arch-parameters-conductor-drop-3"
class="lemma">
<p><strong>Lemma 144</strong>. <span
id="lem:standard2:no-conductor-drop-vs-tau"
label="lem:standard2:no-conductor-drop-vs-tau"></span> Fix a
nondegenerate unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span>. Let <span class="math inline">\(T \ggg
1\)</span>. Let <span class="math inline">\(\pi\)</span> be an
irreducible unitary representation of <span
class="math inline">\(G\)</span>. Assume that <span
class="math inline">\(T^{-1} \lambda_\pi\)</span> belongs to some fixed
compact subset of <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span>. The following are
then equivalent.</p>
<ol type="i">
<li><p><span
id="itm:standard2:characterize-arch-parameters-conductor-drop-1"
label="itm:standard2:characterize-arch-parameters-conductor-drop-1"></span>
<span class="math inline">\(\tau(\pi,\psi,T)\)</span> belongs to some
fixed compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>.</p></li>
<li><p><span
id="itm:standard2:characterize-arch-parameters-conductor-drop-2"
label="itm:standard2:characterize-arch-parameters-conductor-drop-2"></span>
Each archimedean Satake parameter of <span
class="math inline">\(\pi\)</span> satisfies <span
class="math inline">\(\lambda_{\pi,j} \asymp T\)</span>.</p></li>
<li><p>Each archimedean <span class="math inline">\(L\)</span>-function
parameter of <span class="math inline">\(\pi\)</span> satisfies <span
class="math inline">\(\lambda_{\pi,j}^+ + a_j \asymp
T\)</span>.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> The equivalence of <a
href="#itm:standard2:characterize-arch-parameters-conductor-drop-2"
data-reference-type="eqref"
data-reference="itm:standard2:characterize-arch-parameters-conductor-drop-2">\((ii)\)</a>
and <a
href="#itm:standard2:characterize-arch-parameters-conductor-drop-3"
data-reference-type="eqref"
data-reference="itm:standard2:characterize-arch-parameters-conductor-drop-3">\((iii)\)</a>
follows from our assumption <span class="math inline">\(T \ggg
1\)</span> and the fact that <span class="math inline">\(a_j \in
\{0,1\}\)</span>. To see the equivalence between <a
href="#itm:standard2:characterize-arch-parameters-conductor-drop-1"
data-reference-type="eqref"
data-reference="itm:standard2:characterize-arch-parameters-conductor-drop-1">\((i)\)</a>
and <a
href="#itm:standard2:characterize-arch-parameters-conductor-drop-2"
data-reference-type="eqref"
data-reference="itm:standard2:characterize-arch-parameters-conductor-drop-2">\((ii)\)</a>,
we note that, writing <span class="math inline">\(\tau =
\tau(\pi,\psi,T)\)</span>, <span
class="math display">\[\mathcal{P}_{[\tau]} = \prod_j (X + T^{-1}
\lambda_{\pi,j}),
    \quad
    \mathcal{P}_{[\tau_H]}(X) = X^{n-1},\]</span> hence <span
class="math display">\[\mathcal{R}(\tau) = \pm \prod_{j=1}^n (T^{-1}
\lambda_{\pi,j})^{n-1}.\]</span> In view of our assumption that each
<span class="math inline">\(T^{-1} \lambda_{\pi, j} =
\operatorname{O}(1)\)</span>, it follows that <span
class="math display">\[\mathcal{R}(\tau) \gg 1 \iff \text{ each } T^{-1}
\lambda_{\pi,j} \asymp 1.\]</span> The required equivalence then follows
from Lemma <a href="#lem:standard2:stability-vs-resultant"
data-reference-type="ref"
data-reference="lem:standard2:stability-vs-resultant">140</a>. ◻</p>
</div>
<h3 id="sec:asympt-analys-local">§8. Localized elements of the Kirillov
model</h3>
<p>Let <span class="math inline">\((G,H)\)</span> be a fixed general
linear pair over <span class="math inline">\(\mathbb{R}\)</span>. Recall
that we write <span class="math inline">\(N \leqslant G\)</span> and
<span class="math inline">\(N_H \leqslant H\)</span> for the standard
upper-triangular maximal unipotent subgroups. We denote as in §<a
href="#sec:parameter-theta" data-reference-type="ref"
data-reference="sec:parameter-theta">2.3.2</a> by <span
class="math inline">\(P \leqslant G\)</span> the mirabolic subgroup.</p>
<p>Let <span class="math inline">\(\pi\)</span> be a generic irreducible
unitary representation of <span class="math inline">\(G\)</span>.</p>
<p>The main result of this section is Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>,
stated below in §<a href="#sec:behavior-under-g"
data-reference-type="ref" data-reference="sec:behavior-under-g">3.3</a>.
Informally speaking, that result supplies us with a class of
microlocalized vectors <span class="math inline">\(v\)</span> in <span
class="math inline">\(\pi\)</span> that concentrate in the Kirillov
model near a specific point, together with some quantitative control
over how the group <span class="math inline">\(G\)</span> acts on such
vectors.</p>
<h4 id="sec:kirillov-model">§8.1. The Kirillov model</h4>
<p>Let <span class="math inline">\(\psi\)</span> be a nondegenerate
unitary character of <span class="math inline">\(N\)</span>. We denote
also simply by <span class="math inline">\(\psi\)</span> the restriction
of <span class="math inline">\(\psi\)</span> to <span
class="math inline">\(N_H\)</span>, which is again nondegenerate.</p>
<p>We denote in what follows by <span
class="math inline">\(\pi^0\)</span> the underlying Hilbert space, by
<span class="math inline">\(\pi^\infty\)</span> the space of smooth
vectors, and by <span class="math inline">\(\pi^{-\infty}\)</span> the
space of distributional vectors, i.e., the continuous dual of <span
class="math inline">\(\pi^\infty\)</span>; these spaces are related via
natural inclusions <span class="math display">\[\pi^\infty \subseteq
\pi^0 \subseteq \pi^{-\infty}.\]</span></p>
<p>By the definition of “generic,” there is a nonzero distributional
vector <span class="math inline">\(\Theta_{\pi,\psi} \in
\pi^{-\infty}\)</span>, unique up to scalars <a href="#ref-MR348047" class="citation"
data-cites="MR348047">(Shalika 1974)</a>, for which <span
class="math inline">\(\pi(n) \Theta_{\pi,\psi} = \psi(n)
\Theta_{\pi,\psi}\)</span> for all <span class="math inline">\(n \in
N\)</span>. The map <span class="math inline">\(v \mapsto [g \mapsto
\langle \pi(g) v, \Theta_{\pi,\psi} \rangle]\)</span> defines the <span
class="math inline">\(\psi\)</span>-Whittaker model <span
class="math inline">\(\mathcal{W}(\pi,\psi)\)</span> of <span
class="math inline">\(\pi\)</span>, which consists of <span
class="math inline">\(W : G \rightarrow \mathbb{C}\)</span> satisfying
<span class="math inline">\(W(n g) = \psi(n) W(g)\)</span> for all <span
class="math inline">\((n,g) \in N \times G\)</span>. It follows from the
results of <a href="#ref-MR1999922" class="citation" data-cites="MR1999922">(Baruch
2003a)</a> (see also <a href="#ref-MR748505" class="citation" data-cites="MR748505">(J.
N. Bernstein 1984)</a> and <a href="#ref-MR0579172" class="citation"
data-cites="MR0579172">(I. N. Bernstein and Zelevinsky 1977, Ch.
III)</a>) that by restricting elements of the model <span
class="math inline">\(\mathcal{W}(\pi,\psi)\)</span> to the subgroup
<span class="math inline">\(H\)</span>, we may realize <span
class="math inline">\(\pi^0\)</span> as the Hilbert space of all
measurable functions <span class="math inline">\(W : H \rightarrow
\mathbb{C}\)</span> satisfying <span id="eqn:kirillov-model-defn" class="math display">\[\label{eqn:kirillov-model-defn}\tag{8.1}
  W(n h) = \psi(n) W(h)
  \text{ for all } (n,h) \in N_H \times H,\]</span> <span id="eq:int_n_h-backslash-h" class="math display">\[\label{eq:int_n_h-backslash-h}\tag{8.2}
  \int_{N_H \backslash H} |W|^2 &lt; \infty,\]</span> with an invariant
inner product on <span class="math inline">\(\pi\)</span> given
integration over <span class="math inline">\(N_H \backslash
H\)</span>.</p>
<p>By analogy to §<a href="#sec:whittaker-functions-1"
data-reference-type="ref"
data-reference="sec:whittaker-functions-1">2.12</a>, we denote by <span
class="math inline">\(C_c^\infty(N_H \backslash H,\psi)\)</span> the
space of smooth compactly-supported functions <span
class="math inline">\(H \rightarrow \mathbb{C}\)</span> satisfying <a
href="#eqn:kirillov-model-defn" data-reference-type="eqref"
data-reference="eqn:kirillov-model-defn">\((8.1)\)</a>.
It is known, and relatively straightforward to see, that the space <span
class="math inline">\(C_c^\infty(N_H \backslash H, \psi)\)</span> is
contained in the Hilbert space <span
class="math inline">\(\pi^0\)</span> and is smooth under the action of
<span class="math inline">\(H\)</span>. Jacquet <a href="#ref-MR2733072" class="citation"
data-cites="MR2733072">(Hervé Jacquet 2010, Prop 5)</a> established
the deeper fact that it is smooth under the action of <span
class="math inline">\(G\)</span>, i.e., that <span
class="math display">\[C_c^\infty(N_H \backslash H, \psi) \subseteq
\pi^\infty.\]</span> Jacquet’s proof shows in particular that the
inclusion is continuous and that for any bounded open subset <span
class="math inline">\(E\)</span> of <span class="math inline">\(N_H
\backslash H\)</span>, the subspace <span
class="math inline">\(C_c^\infty(E, \psi)\)</span> (consisting of
elements supported on the preimage of <span
class="math inline">\(E\)</span>) is invariant by <span
class="math inline">\(\mathfrak{U}(G)\)</span>.</p>
<p>In more detail, by the proof of <a href="#ref-MR2733072" class="citation"
data-cites="MR2733072">(Hervé Jacquet 2010, Prop 5)</a>, we may write
any element of <span class="math inline">\(C_c^\infty(N_H \backslash H,
\psi)\)</span> in the form <span class="math inline">\(\pi(f)
\Theta_{\pi,\psi}\)</span> for some <span class="math inline">\(f \in
C_c^\infty(H)\)</span>. We recall <a href="#ref-MR2733072" class="citation"
data-cites="MR2733072">(Hervé Jacquet 2010, Lem 7)</a>: <span id="eq:pif-theta_pi-h" class="math display">\[\label{eq:pif-theta_pi-h}\tag{8.3}
  \pi(f) \Theta_{\pi,\psi} (h)
  =
  \int_{n \in N_H}
  f(h^{-1} n)
  \psi(n) \, d n\]</span></p>
<div id="thm:jacquet-on-kirillov-model" class="theorem">
<p><strong>Theorem 145</strong> (Jacquet). <em>Let <span
class="math inline">\(f \in C_c^\infty(H)\)</span>. Then <span
class="math inline">\(\pi(f) \Theta_{\pi,\psi} \in \pi^\infty\)</span>.
More precisely, for each <span class="math inline">\(x \in
\mathfrak{U}(G)\)</span>, we have <span id="eqn:pi-x-pi-f-Theta-pi-f-prime" class="math display">\[\label{eqn:pi-x-pi-f-Theta-pi-f-prime}\tag{8.4}
    \pi(x) \pi(f) \Theta_{\pi,\psi} = \pi(f&#39;)
\Theta_{\pi,\psi},\]</span> where <span class="math inline">\(f&#39; \in
C_c^\infty(H)\)</span> with <span
class="math inline">\(\mathop{\mathrm{supp}}(f&#39;) \subseteq
\mathop{\mathrm{supp}}(f)\)</span>, and <span class="math inline">\(f
\mapsto f&#39;\)</span> is continuous.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> See <a href="#ref-MR2733072" class="citation"
data-cites="MR2733072">(Hervé Jacquet 2010, sec. 3.2)</a>. ◻</p>
</div>
<p>We note that the above discussion may be reformulated using the
bijection <span class="math inline">\(N_H \backslash H = N \backslash
P\)</span>. In particular:</p>
<div id="thm:jacquet-on-kirillov-model-P" class="theorem">
<p><strong>Theorem 146</strong> (Jacquet). <em>Let <span
class="math inline">\(f \in C_c^\infty(P)\)</span>. Then <span
class="math inline">\(\pi(f) \Theta_{\pi,\psi} \in \pi^\infty\)</span>,
and the resulting map <span class="math inline">\(C_c^\infty(P)
\rightarrow \pi^\infty\)</span> is continuous.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> <a href="#ref-MR2733072" class="citation" data-cites="MR2733072">(Hervé
Jacquet 2010, Prop 4)</a> gives the same result, but with <span
class="math inline">\(P\)</span> replaced by <span
class="math inline">\(H\)</span>. Write <span
class="math inline">\(U_P\)</span> for the unipotent radical of <span
class="math inline">\(P\)</span>. By the transformation property for
<span class="math inline">\(P\)</span> under <span
class="math inline">\((N,\psi)\)</span>, hence under <span
class="math inline">\((U_P,\psi)\)</span>, we may write <span
class="math display">\[\pi(f) \Theta_{\pi,\psi} = \pi(f &#39;)
\Theta_{\pi,\psi},\]</span> where <span class="math inline">\(f&#39; \in
C_c^\infty(H)\)</span> and the map <span class="math inline">\(f \mapsto
f&#39;\)</span> is continuous. The cited result gives the continuity of
<span class="math inline">\(f&#39; \mapsto \pi (f&#39;)
\Theta_{\pi,\psi}\)</span>, and the required continuity follows. ◻</p>
</div>
<h4 id="sec:class-bump-functions">§8.2. A class of bump functions in the
Kirillov model</h4>
<p>We now take the nondegenerate unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span> to be <em>fixed</em>. We define <span
class="math inline">\(\theta_P(\psi) \in
\mathop{\mathrm{Lie}}(P)^\wedge\)</span> as in §<a
href="#sec:parameter-theta" data-reference-type="ref"
data-reference="sec:parameter-theta">2.3.2</a>. We denote by <span
class="math inline">\(\theta_H(\psi) \in
\mathop{\mathrm{Lie}}(H)^\wedge\)</span> the restriction of <span
class="math inline">\(\theta_P(\psi)\)</span>.</p>
<p>Let <span class="math inline">\(T\)</span> be a positive parameter
with <span class="math inline">\(T \ggg 1\)</span>. We define the
rescaled nondegenerate character <span
class="math inline">\(\psi_T\)</span> of <span
class="math inline">\(N\)</span> by requiring that, for <span
class="math inline">\(x \in \mathop{\mathrm{Lie}}(N)\)</span>, <span
class="math display">\[\psi_T(\exp(x)) = \psi(\exp(T x)).\]</span> Thus
<span class="math inline">\(\psi_T(\exp(x)) = \psi_{T \theta_P(\psi),
\log}(x)\)</span>. Equivalently, <span class="math inline">\(\psi_T(n) =
\psi (T^{\rho_N^\vee} n T^{-\rho_N^\vee})\)</span>. In the notation of
§<a href="#sec:parameter-theta" data-reference-type="ref"
data-reference="sec:parameter-theta">2.3.2</a>, we pass from <span
class="math inline">\(\psi\)</span> to <span
class="math inline">\(\psi_T\)</span> by replacing each <span
class="math inline">\(\eta_i\)</span> by its multiple <span
class="math inline">\(T \eta_i\)</span>.</p>
<p>In this section, we identify <span class="math inline">\(\pi\)</span>
with its <span class="math inline">\(\psi_T\)</span>-Whittaker model
<span class="math inline">\(\mathcal{W}(\pi,\psi_T)\)</span>. We
identify the latter, in turn, with the <span
class="math inline">\(\psi_T\)</span>-Kirillov model, a subspace of
<span class="math inline">\(C^\infty(N_H \backslash H, \psi_T)\)</span>.
By restricting further to <span class="math inline">\(Q_H\)</span>, we
may identify the <span class="math inline">\(\psi_T\)</span>-Kirillov
model with a subspace of <span
class="math inline">\(C^\infty(Q_H)\)</span>. By multiplying by some
fixed right Haar measure on <span class="math inline">\(Q_H\)</span>, we
may identify <span class="math inline">\(C^\infty(Q_H)\)</span>, in
turn, with the space of smooth measures <span
class="math inline">\(\mathcal{M}(Q_H)\)</span>. We denote by <span
class="math inline">\(\iota : \pi^\infty \hookrightarrow
\mathcal{M}(Q_H)\)</span> the resulting embedding. By Jacquet’s results,
the maps <span id="eq:mathc-right-mathc" class="math display">\[\label{eq:mathc-right-mathc}\tag{8.5}
  \mathcal{M}_c(H) \rightarrow \mathcal{M}(Q_H)\]</span> and <span
class="math display">\[\mathcal{M}_c(P) \rightarrow
\mathcal{M}(Q_H),\]</span> both given by <span class="math display">\[f
\mapsto \iota(\pi(f) \Theta_{\pi,\psi_T}),\]</span> are defined.</p>
<p>Recall the notation <span
class="math inline">\(\mathfrak{C}(\dotsb)\)</span> from §<a
href="#sec:class-bumps" data-reference-type="ref"
data-reference="sec:class-bumps">1.3</a>.</p>
<div id="lem:fix-delta-in" class="lemma">
<p><strong>Lemma 147</strong>. Fix <span class="math inline">\(\delta
\in (0,1/2]\)</span>. The above maps induce surjective class maps <span
class="math display">\[\mathfrak{C}(H,-\theta_H(\psi),T,\delta)
\rightarrow \mathfrak{C}(Q_H,0,T,\delta),\]</span> <span
class="math display">\[\mathfrak{C}(P,-\theta_P(\psi),T,\delta)
\rightarrow \mathfrak{C}(Q_H,0,T,\delta).\]</span> In particular, <span
class="math inline">\(\mathfrak{C}(H,-\theta_H(\psi),T,\delta)\)</span>
and <span
class="math inline">\(\mathfrak{C}(P,-\theta_P(\psi),T,\delta)\)</span>
have the same images under the above maps.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We start by giving the proof for the first map,
involving <span class="math inline">\(H\)</span>. The proof will make
use of the analytic map <span class="math display">\[j : N_H \times Q_H
\rightarrow H\]</span> <span class="math display">\[(n,g) \mapsto g^{-1}
n,\]</span> which defines a local analytic isomorphism in some small
neighborhood of the identity. An essentially identical argument works
for <span class="math inline">\(P\)</span>, using the analogously
defined local analytic isomorphism <span class="math inline">\(N \times
Q_H \rightarrow P\)</span>.</p>
<p>To simplify notation in what follows, we write simply <span
class="math inline">\(\theta\)</span> for <span
class="math inline">\(\theta_H(\psi)\)</span>.</p>
<p>The conclusion is independent of our normalization of Haar measure,
provided that it is fixed, since any two fixed Haar measures are related
by a scalar <span class="math inline">\(\asymp 1\)</span>. We may thus
suppose given Haar measures on <span class="math inline">\(H\)</span>
and <span class="math inline">\(N_H\)</span>, and a right Haar measure
on <span class="math inline">\(Q_H\)</span>, that are related by the
identity <span id="eq:int-_h-phih" class="math display">\[\label{eq:int-_h-phih}\tag{8.6}
    \int _{H} \phi(h) \, d h
    =
    \int _{n \in N_H}
    \int _{g \in Q_H} \phi(g^{-1} n) \, d n \, d g,\]</span> using here
that <span class="math inline">\(N_H\)</span> is unimodular.</p>
<p>Let us explicate the indicated maps. Let <span
class="math inline">\(f \in \mathcal{M}_c(H)\)</span>. We may write
<span class="math inline">\(f(h) = f_0(h) \, d h\)</span> with <span
class="math inline">\(f_0 \in C_c^\infty(H)\)</span>. By <a
href="#eq:pif-theta_pi-h" data-reference-type="eqref"
data-reference="eq:pif-theta_pi-h">\((8.3)\)</a>, we have
<span class="math display">\[\pi(f) \Theta_{\pi,\psi_T}(g) =  \int _{n
\in N_H} f_0(g^{-1} n ) \psi_T(n) \, d n.\]</span> Thus <span
class="math inline">\(\iota(\pi(f) \Theta_{\pi,\psi_T})\)</span> is the
measure on <span class="math inline">\(Q_H\)</span> assigning to a
function <span class="math inline">\(\phi \in C_c(Q_H)\)</span> the
value <span id="eq:int-_q_h-phi" class="math display">\[\label{eq:int-_q_h-phi}\tag{8.7}
    \int _{Q_H} \phi \cdot \iota(\pi(f) \Theta_{\pi,\psi_T})
    =
    \int _{g \in Q_H}
    \int _{n \in N_H}
    f_0(g^{-1} n) \psi_T(n) \phi(g)
    \, d n
    \, d g.\]</span></p>
<p>Consider the chart <span class="math display">\[c : H %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
\mathop{\mathrm{Lie}}(N_H) \oplus  \mathop{\mathrm{Lie}}(Q_H) \cong
\mathop{\mathrm{Lie}}(H),\]</span> defined near the identity, given by
<span class="math inline">\(j^{-1}\)</span> composed with the logarithm.
Let <span class="math inline">\(\psi_{T \theta, c} : H %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
\mathop{\mathrm{U}}(1)\)</span> denote the function given, as in
Definition <a href="#defn:standard2:given-point-manif"
data-reference-type="ref"
data-reference="defn:standard2:given-point-manif">110</a>, by <span
class="math inline">\(h \mapsto \psi_{T \theta}(c(h))\)</span>. Thus for
<span class="math inline">\((n,g) \in N_H \times Q_H\)</span>, we have
<span class="math inline">\(\psi_{T \theta, c}(g^{-1} n) =
\psi_T(n)\)</span>. We may rewrite the RHS of <a href="#eq:int-_q_h-phi"
data-reference-type="eqref"
data-reference="eq:int-_q_h-phi">\((8.7)\)</a> as <span id="eq:int_g-in-q_h" class="math display">\[\label{eq:int_g-in-q_h}\tag{8.8}
    \int_{g \in Q_H} \phi(g) \int _{n \in N_H} \psi_{T \theta, c}(g^{-1}
n) f_0(g^{-1} n) \, d n \, d g.\]</span> Consider the following analytic
map, defined near the origin and submersive there: <span
class="math display">\[\rho : H %
  \mathrel{%
    \mathpalette{\da@xarrow{}{}{}\mathchar&quot;0\hexnumber@\symAMSa 4B
{\,}{}}{}%
  }%
Q_H\]</span> <span class="math display">\[g^{-1} n \mapsto g \text{ for
} (n,g) \in N_H \times Q_H.\]</span> Then, in view of <a
href="#eq:int-_h-phih" data-reference-type="eqref"
data-reference="eq:int-_h-phih">\((8.6)\)</a>, we may rewrite <a
href="#eq:int_g-in-q_h" data-reference-type="eqref"
data-reference="eq:int_g-in-q_h">\((8.8)\)</a> further as <span
class="math display">\[\int _{g \in H} \phi(\rho(g)) \psi_{T \theta ,
c}(g) f_0(g) \, d g.\]</span> Let <span class="math inline">\(m :
\mathcal{M}_c(H) \rightarrow \mathcal{M}_c(H)\)</span> denote
multiplication by <span class="math inline">\(\psi_{T \theta,
c}\)</span>. The map <a href="#eq:mathc-right-mathc"
data-reference-type="eqref"
data-reference="eq:mathc-right-mathc">\((8.5)\)</a> may be
written as the composition <span class="math display">\[\mathcal{M}_c(H)
\xrightarrow{m} \mathcal{M}_c(H) \xrightarrow{\rho_*}
\mathcal{M}_c(Q_H).\]</span> By Lemma <a href="#lem:modulation"
data-reference-type="ref" data-reference="lem:modulation">122</a> and
Proposition <a href="#lem:assume-that-rho" data-reference-type="ref"
data-reference="lem:assume-that-rho">123</a>, this composition induces
class maps <span class="math display">\[\mathfrak{C}(H,-\theta,T,\delta)
\xrightarrow{m} \mathfrak{C}(H,0,T,\delta) \xrightarrow{\rho_*}
\mathfrak{C}(Q_H,0,T,\delta),\]</span> with the first map bijective and
the second map surjective. The required conclusion follows. ◻</p>
</div>
<div id="defn:we-denote-mathfr-frakW" class="definition">
<p><strong>Definition 148</strong>. We denote by <span
class="math inline">\(\mathfrak{W}(\pi,\psi,T,\delta)\)</span> the
subclass of <span class="math inline">\(\mathcal{W}(\pi,\psi_T)\)</span>
consisting of all elements <span class="math inline">\(W\)</span>
satisfying the following conditions, which, in view of Lemma <a
href="#lem:fix-delta-in" data-reference-type="ref"
data-reference="lem:fix-delta-in">147</a>, are equivalent to one
another.</p>
<ul>
<li><p><span class="math inline">\(W = \pi(\gamma)
\Theta_{\pi,\psi_T}\)</span> for some <span class="math inline">\(\gamma
\in \mathfrak{C}(H,-\theta_H(\psi),T,\delta)\)</span>.</p></li>
<li><p><span class="math inline">\(W = \pi(\gamma)
\Theta_{\pi,\psi_T}\)</span> for some <span class="math inline">\(\gamma
\in \mathfrak{C}(P,-\theta_P(\psi),T,\delta)\)</span>.</p></li>
<li><p><span class="math inline">\(\iota(W) \in \mathfrak{C}(Q_H, 0, T,
\delta)\)</span>.</p></li>
</ul>
</div>
<p>Informally, <span
class="math inline">\(\mathfrak{W}(\pi,\psi,T,\delta)\)</span> consists
of <span class="math inline">\(W \in \mathcal{W}(\pi,\psi_T)\)</span>
for which <span class="math inline">\(W|_{Q_H}\)</span> is a smooth
<span class="math inline">\(L^1\)</span>-normalized bump function
concentrated on <span class="math inline">\(1 +
\operatorname{O}(T^{\delta-1})\)</span>.</p>
<div id="lem:let-w-in-square-integral" class="lemma">
<p><strong>Lemma 149</strong>. Let <span class="math inline">\(W \in
\mathfrak{W}(\pi,\psi,T,\delta)\)</span>. Then <span
class="math display">\[\int _{N_H \backslash H} |W|^2 \ll T^{(1- \delta)
\dim(Q_H)}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> With suitable measure normalization, we have <span
class="math inline">\(\int_{N_H \backslash H} |W|^2 = \int_{Q_H}
|W|^2\)</span>, and <span class="math inline">\(W|_{Q_H} \in
\mathfrak{C}(Q_H,0,T,\delta)\)</span>. We can compute the integral in
local coordinates. The <span class="math inline">\(L^1\)</span>-norm of
<span class="math inline">\(W|_{Q_H}\)</span> is <span
class="math inline">\(\ll 1\)</span>, while the <span
class="math inline">\(L^\infty\)</span>-norm is <span
class="math inline">\(\ll T^{(1 - \delta) \dim(Q_H)}\)</span>. The claim
follows. ◻</p>
</div>
<div id="lem:there-exists-w-big-group-big" class="lemma">
<p><strong>Lemma 150</strong>. There exists <span
class="math inline">\(W \in \mathfrak{W}(\pi,\psi,T,\delta)\)</span> so
that <span class="math inline">\(W|_{Q_H} \geqslant 0\)</span>, <span
class="math inline">\(\int_{Q_H} W = 1\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> It is easy to see that there exists <span
class="math inline">\(\gamma \in \mathfrak{C}(Q_H,0,T,\delta)\)</span>
which is positive and has total mass one (take the rescaling of a fixed
bump function, as in Example <a
href="#example:standard2:smooth-modulated-bump-in-frak-C"
data-reference-type="ref"
data-reference="example:standard2:smooth-modulated-bump-in-frak-C">116</a>).
By the surjectivity assertion of Lemma <a href="#lem:fix-delta-in"
data-reference-type="ref" data-reference="lem:fix-delta-in">147</a>,
there exists <span class="math inline">\(W \in
\mathfrak{W}(\pi,\psi,T,\delta)\)</span> so that <span
class="math inline">\(\iota(W) = \gamma\)</span>. The claim
follows. ◻</p>
</div>
<h4 id="sec:behavior-under-g">§8.3. Behavior under <span
class="math inline">\(G\)</span></h4>
<p>We will show that elements <span class="math inline">\(W\)</span> of
the class <span
class="math inline">\(\mathfrak{W}(\pi,\psi,T,\delta)\)</span> are
approximately invariant under integral operators defined by test
functions <span class="math inline">\(\omega_0 \in
C_c^\infty(G)\)</span> with favorable properties.</p>
<div id="thm:big-group-whittaker-behavior-under-G" class="theorem">
<p><strong>Theorem 151</strong>. <em>Fix <span
class="math inline">\(\varepsilon&gt; 0\)</span>. Fix <span
class="math inline">\(\delta \in (0,1/2)\)</span> with <span
class="math inline">\(1/2 - \delta\)</span> sufficiently small in terms
of <span class="math inline">\(\varepsilon\)</span>. Let <span
class="math inline">\(T \ggg 1\)</span>. Let <span
class="math inline">\(\pi\)</span> be a generic irreducible unitary
representation of <span class="math inline">\(G\)</span>. Assume that
the rescaled infinitesimal character <span class="math inline">\(T^{-1}
\lambda_\pi\)</span> belongs to a fixed compact set.</em></p>
<p><em>There exists <span class="math inline">\(\omega_0 \in
C_c^\infty(G)\)</span> with the following properties. Set <span
class="math inline">\(\bar{G} = G/Z\)</span>. Define <span
class="math inline">\(\omega := \omega_0 \ast \omega_0^\ast \in
C_c^\infty(G)\)</span> and <span class="math inline">\(\omega^\sharp \in
C_c^\infty(\bar{G})\)</span>, as previously, by <span
class="math display">\[\omega(g) := \int _{h \in G} \omega(g h^{-1})
\overline{\omega(h^{-1})} \, d h,\]</span> <span
class="math display">\[\omega^\sharp (g) := \int _{z \in Z}
    \pi|_Z (z) \omega(z g) \, d z,\]</span> where <span
class="math inline">\(\pi|_Z\)</span> denotes the central character of
<span class="math inline">\(\pi\)</span>. Then:</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(\omega(g) \neq 0\)</span> only if
<span class="math inline">\(g = 1 + o(1)\)</span> and <span
class="math inline">\({\mathop{\mathrm{Ad}}}^*(g) \tau = \tau +
o(T^{-1/2})\)</span>, where <span class="math inline">\(\tau =
\tau(\pi,\psi,T)\)</span> is given by <a
href="#eq:tau-characterize-via-pi" data-reference-type="eqref"
data-reference="eq:tau-characterize-via-pi">\((7.10)\)</a>.</em></p></li>
<li><p><em><span class="math inline">\(\|\omega^\sharp\|_{\infty} \ll
T^{\dim(N)+\varepsilon}\)</span>.</em></p></li>
<li><p><em>If <span class="math inline">\(\tau\)</span> lies in some
fixed compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>,
then <span class="math inline">\(\int_H |\omega^\sharp| \ll
T^{\mathop{\mathrm{rank}}(H)/2 + \varepsilon}\)</span>.</em></p></li>
<li><p><em>For each <span class="math inline">\(W \in
\mathfrak{W}(\pi,\psi,T,\delta)\)</span> and fixed <span
class="math inline">\(x \in \mathfrak{U}(G)\)</span>, we have <span
class="math display">\[\|\pi(x) (\pi(\omega_0)W - W)\| \ll
T^{-\infty}.\]</span></em></p></li>
</ol>
</div>
<p>The proof is given in Part <a href="#part:asympt-analys-kirill"
data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>.</p>
<p>We refer again to §<a href="#sec:elem-form" data-reference-type="ref"
data-reference="sec:elem-form">6</a> for an elementary reformulation of
this result, without the language of nonstandard analysis.</p>
<h3 id="sec:some-analysis-basic">§9. Analysis on <span
class="math inline">\(U \backslash G\)</span>: qualitative</h3>
<h4 id="preliminaries-1">Preliminaries</h4>
<p>Let <span class="math inline">\(G\)</span> be a split connected
reductive group over an archimedean local field <span
class="math inline">\(F\)</span>, thus <span class="math inline">\(F =
\mathbb{R}\)</span> or <span class="math inline">\(F =
\mathbb{C}\)</span>. In what follows, we view <span
class="math inline">\(G\)</span> primarily as a Lie group over <span
class="math inline">\(\mathbb{R}\)</span> (even if <span
class="math inline">\(F = \mathbb{C}\)</span>), so that the discussion
of §<a href="#sec:modul-bump-funct" data-reference-type="ref"
data-reference="sec:modul-bump-funct">1</a> applies. We expect that the
discussion to follow applies more generally to any quasi-split real
reductive group (cf. Lemma <a href="#lem:assume-that-g"
data-reference-type="ref" data-reference="lem:assume-that-g">169</a>
below).</p>
<p>We retain the general notation of §<a href="#sec:gener-prel"
data-reference-type="ref" data-reference="sec:gener-prel">2.3</a>, thus
<span class="math inline">\(B = A N\)</span> and <span
class="math inline">\(Q = AU\)</span> are Borel subgroups of <span
class="math inline">\(G\)</span>, with common maximal torus <span
class="math inline">\(A\)</span>. For computational convenience, we
assume that these choices are opposite to one another, i.e., <span
class="math display">\[N = \bar{U},\]</span> so that the image of <span
class="math inline">\(A N\)</span> in <span class="math inline">\(U
\backslash G\)</span> is open.</p>
<p>Given a measure <span class="math inline">\(\gamma\)</span> on <span
class="math inline">\(G\)</span> and <span class="math inline">\(g \in
G\)</span>, we write <span class="math inline">\(g \ast \gamma\)</span>
and <span class="math inline">\(\gamma \ast g\)</span> for the
convolutions of <span class="math inline">\(\gamma\)</span> with the
<span class="math inline">\(\delta\)</span>-mass at <span
class="math inline">\(g\)</span>. We define in the same way <span
class="math inline">\(x \ast \gamma\)</span> and <span
class="math inline">\(\gamma \ast x\)</span> for <span
class="math inline">\(x \in \mathfrak{U}(G)\)</span>, regarding <span
class="math inline">\(x\)</span> as a distribution supported at the
identity element.</p>
<p>Recall (§<a href="#sec:schwartz-spaces" data-reference-type="ref"
data-reference="sec:schwartz-spaces">2.6</a>) that we have defined the
spaces <span class="math inline">\(\mathcal{S}(G)\)</span> and <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> of Schwartz
functions. These spaces are related as folllows:</p>
<div id="lem:cal-S-G-to-cal-S-U-G" class="lemma">
<p><strong>Lemma 152</strong>. For <span class="math inline">\(f \in
\mathcal{S}(G)\)</span> and <span class="math inline">\(g \in
G\)</span>, the integral <span class="math inline">\(f_U(g) := \int _{u
\in U} f(u g) \, d u\)</span> converges absolutely and defines an
element <span class="math inline">\(f_U\)</span> of <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span>. The
resulting map <span class="math inline">\(\mathcal{S}(G) \rightarrow
\mathcal{S}(U \backslash G)\)</span> is continuous.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This follows readily the definitions and the fact
that some negative power of the norm <span
class="math inline">\(\|.\|\)</span> on <span
class="math inline">\(G\)</span> is integrable over <span
class="math inline">\(U\)</span> <a href="#ref-MR1001613" class="citation"
data-cites="MR1001613">(Casselman 1989, Cor 1.3)</a>. ◻</p>
</div>
<h4 id="smoothened-whittaker-distributions">Smoothened Whittaker
distributions</h4>
<div class="definition">
<p><strong>Definition 153</strong>. Let <span
class="math inline">\(\psi\)</span> be a nondegenerate unitary character
of <span class="math inline">\(N\)</span>. Let <span
class="math inline">\(\beta \in \mathcal{S}(A)\)</span>. We define a
function <span class="math display">\[\mathcal{J}[\psi,\beta] : U
\backslash G \rightarrow \mathbb{C}\]</span> by requiring that <span
class="math inline">\(\mathcal{J}[\psi,\beta]\)</span> be supported on
the open cell represented by elements of the form <span
class="math inline">\(a n\)</span> with <span
class="math inline">\((a,n) \in A \times N\)</span>, and given on such
elements by <span class="math display">\[\mathcal{J}[\psi,\beta](a n) =
\delta_U^{1/2}(a) \beta(a) \psi(n).\]</span></p>
</div>
<p>It is clear from construction that <span
class="math inline">\(\mathcal{J}[\psi,\beta]\)</span> defines a bounded
function on <span class="math inline">\(U \backslash G\)</span>; more
precisely, <span id="eq:mathc-beta_-leq" class="math display">\[\label{eq:mathc-beta_-leq}\tag{9.1}
  \|\mathcal{J}[\psi,\beta]\|_{\infty} \leqslant\|\delta_U^{1/2} \beta
\|_{\infty}.\]</span> It is smooth under the left action of <span
class="math inline">\(A\)</span>. For <span class="math inline">\(x \in
\mathfrak{U}(A)\)</span>, we have <span id="eq:lx-mathcalj_psi-beta" class="math display">\[\label{eq:lx-mathcalj_psi-beta}\tag{9.2}
  L(x) \mathcal{J}[\psi,\beta] = \mathcal{J}[\psi,L(x)
\beta].\]</span></p>
<div class="definition">
<p><strong>Definition 154</strong>. Let <span
class="math inline">\((\psi,\beta)\)</span> be as above, and let <span
class="math inline">\(\gamma \in \mathcal{S}(G)\)</span>. We define
<span class="math display">\[\mathcal{J}[\psi,\beta,\gamma] : =
R(\gamma) \mathcal{J}[\psi,\beta] : U \backslash G \rightarrow
\mathbb{C},\]</span> i.e., <span
class="math display">\[\mathcal{J}[\psi,\beta,\gamma](h) :=
  \int _{g \in G}
  \gamma(g) \mathcal{J}[\psi,\beta](h g) \, d g.\]</span></p>
</div>
<p>Since <span class="math inline">\(\mathcal{J}[\psi,\beta]\)</span> is
bounded and <span class="math inline">\(\gamma\)</span> is integrable,
such integrals converge absolutely. For <span
class="math inline">\(\gamma_1, \gamma_2 \in \mathcal{S}(G)\)</span>, we
have <span id="eq:rgamm-mathc-beta" class="math display">\[\label{eq:rgamm-mathc-beta}\tag{9.3}
  R(\gamma_1) \mathcal{J}[\psi,\beta,\gamma_2]
  = \mathcal{J}[\psi,\beta,\gamma_1 \ast \gamma_2].\]</span> The
functions <span
class="math inline">\(\mathcal{J}[\psi,\beta,\gamma]\)</span> are
smooth; more precisely, for <span class="math inline">\(x \in
\mathfrak{U}(G)\)</span>, we have <span id="eq:rx-mathcald_psi-beta" class="math display">\[\label{eq:rx-mathcald_psi-beta}\tag{9.4}
R(x) \mathcal{J}[\psi,\beta,\gamma] = \mathcal{J}[\psi,\beta,x
\ast  \gamma].\]</span> We note the corresponding identity for the left
action by <span class="math inline">\(A\)</span> on <span
class="math inline">\(U \backslash G\)</span>: for <span
class="math inline">\(x \in A\)</span> or <span class="math inline">\(x
\in \mathfrak{U}(A)\)</span>, we have <span id="eq:lx-mathcald_psi-beta" class="math display">\[\label{eq:lx-mathcald_psi-beta}\tag{9.5}
  L(x) \mathcal{J}[\psi,\beta,\gamma] = \mathcal{J}[\psi,L(x) \beta,
\gamma].\]</span> We note also that, in view of <a
href="#eq:mathc-beta_-leq" data-reference-type="eqref"
data-reference="eq:mathc-beta_-leq">\((9.1)\)</a>, <span id="eq:mathc-beta-gamm" class="math display">\[\label{eq:mathc-beta-gamm}\tag{9.6}
  \|\mathcal{J}[\psi,\beta,\gamma]\|_{\infty} \leqslant
  \|\delta_U^{1/2} \beta \|_{\infty} \|\gamma \|_{1},\]</span> where
<span class="math inline">\(\|\gamma \|_1\)</span> denotes the <span
class="math inline">\(L^1\)</span>-norm (i.e., the total variation norm
of the corresponding Schwartz measure).</p>
<p>The rapid decay of such functions is a deeper fact, related to the
analytic continuation of Jacquet integrals:</p>
<div id="lem:sub-gln:each-psi-beta" class="proposition">
<p><strong>Proposition 155</strong>. <em>For each nondegenerate unitary
character <span class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span> and <span
class="math inline">\((\beta,\gamma) \in \mathcal{S}^e(A) \times
\mathcal{S}(G)\)</span>, we have <span
class="math inline">\(\mathcal{J}[\psi,\beta,\gamma] \in \mathcal{S}^e(U
\backslash G)\)</span>. For each <span
class="math inline">\(\psi\)</span>, the map <span
class="math display">\[\mathcal{S}^e(A) \times \mathcal{S}(G)
\rightarrow \mathcal{S}^e(U \backslash G)\]</span> <span id="eq:beta-gamma-mapsto" class="math display">\[\label{eq:beta-gamma-mapsto}\tag{9.7}
    (\beta,\gamma) \mapsto \mathcal{J}[\psi,\beta,\gamma]\]</span> is
continuous.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> It is clear from the equivariance property <a
href="#eq:lx-mathcald_psi-beta" data-reference-type="eqref"
data-reference="eq:lx-mathcald_psi-beta">\((9.5)\)</a>
that <span class="math inline">\(\mathcal{J}[\psi,\beta,\gamma]\)</span>
is left-invariant under the maximal compact subgroup of <span
class="math inline">\(A\)</span>, hence lies in <span
class="math inline">\(\mathcal{S}^e(U \backslash G)\)</span> provided
that it lies in <span class="math inline">\(\mathcal{S}(U \backslash
G)\)</span>. To establish membership in the latter and verify the
required continuity, we must show that for each <span
class="math inline">\((y,m) \in \mathfrak{U}(G) \times
\mathbb{Z}_{\geqslant 0}\)</span>, there are continuous seminorms <span
class="math inline">\(\mu_1\)</span> on <span
class="math inline">\(\mathcal{S}^e(A)\)</span> and <span
class="math inline">\(\mu_2\)</span> on <span
class="math inline">\(\mathcal{S}(G)\)</span> so that for all <span
class="math inline">\((\beta,\gamma) \in \mathcal{S}^e(A) \times
\mathcal{S}(G)\)</span>, we have <span class="math display">\[\sup_{h
\in U \backslash G} \|h\|_{U \backslash G}^m \left\lvert R(y)
\mathcal{J}[\psi,\beta,\gamma](h) \right\rvert
  \leqslant
  \mu_1(\beta) \mu_2(\gamma).\]</span> Using the equivariance properties
<a href="#eq:rx-mathcald_psi-beta" data-reference-type="eqref"
data-reference="eq:rx-mathcald_psi-beta">\((9.4)\)</a>
and <a href="#eq:lx-mathcald_psi-beta" data-reference-type="eqref"
data-reference="eq:lx-mathcald_psi-beta">\((9.5)\)</a>,
we may reduce to the case <span class="math inline">\(y=1\)</span>. By
Paley–Wiener theory for <span class="math inline">\(\mathcal{S}^e(U
\backslash G)\)</span>, it will suffice to show that there is a
holomorphic family <span class="math inline">\(f[s] \in
\mathcal{I}(s)\)</span>, indexed by <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span>, with the following properties.</p>
<ul>
<li><p>The family <span class="math inline">\(\{f[s]\}\)</span> is of
rapid vertical decay, so that its Mellin inverse may be defined. That
Mellin inverse equals <span class="math inline">\(f\)</span>.</p></li>
<li><p>For each compact <span class="math inline">\(\mathcal{D}
\subseteq \mathfrak{a}^*\)</span> and <span class="math inline">\(m \in
\mathbb{Z}_{\geqslant 0}\)</span>, there are seminorms <span
class="math inline">\((\mu_1,\mu_2)\)</span> as above so that <span id="eq:sup_-substack-s-1" class="math display">\[\label{eq:sup_-substack-s-1}\tag{9.8}
    \sup_{
      \substack{
        s \in \mathfrak{a}_{\mathbb{C}}^* :   \\
         \Re(s) \in \mathcal{D}
      }
    }
    (1 + |s|)^{m} \sup_{k \in K} |f[s](k)|  \leqslant\mu_1(\beta)
\mu_2(\gamma).\]</span></p></li>
</ul>
<p>Let us abbreviate <span class="math inline">\(f :=
\mathcal{J}[\psi,\beta,\gamma]\)</span>. The substitution <span
class="math inline">\(g \mapsto h^{-1} g\)</span> gives <span
class="math display">\[f(h) = \int _{g \in G} \gamma(h^{-1} g)
\mathcal{J}[\psi,\beta](g) \, d g.\]</span> For convenience, let us
suppose that our Haar measures on <span class="math inline">\(U,
A\)</span> and <span class="math inline">\(N\)</span> are chosen so that
the multiplication map <span class="math inline">\(A \times U \times N
\rightarrow G\)</span> is measure-preserving, i.e., <span
class="math display">\[\int _{G} \phi (g) \,d g
    =
    \int _N \int _A \int _U \phi (u a n ) \, d u \, \frac{d a}{
\delta_U(a)} \, d n.\]</span> Inserting the definitions of <span
class="math inline">\(\mathcal{J}[\psi,\beta]\)</span>, we obtain <span id="eq:int-_v-in" class="math display">\[\label{eq:int-_v-in}\tag{9.9}
    f(h) =
    \int _{n \in N}
    \int _{a \in A}
    \int _{u \in U}
    \gamma(h^{-1} u a n)
    \beta(a) \psi(n)
    \, d u \, \frac{d a}{\delta_U^{1/2}(a)} \, d n.\]</span> For each
<span class="math inline">\(h \in G\)</span>, we define <span
class="math inline">\(\alpha[h] \in \mathcal{S}(U \backslash G)\)</span>
(following Lemma <a href="#lem:cal-S-G-to-cal-S-U-G"
data-reference-type="ref"
data-reference="lem:cal-S-G-to-cal-S-U-G">152</a>) by <span
class="math display">\[\alpha[h](g) := \int _{u \in U} \gamma(h^{-1} u
g) \, d u.\]</span> Then <a href="#eq:int-_v-in"
data-reference-type="eqref"
data-reference="eq:int-_v-in">\((9.9)\)</a> rearranges to <span id="eq:fh-=-int" class="math display">\[\label{eq:fh-=-int}\tag{9.10}
    f(h) =
    \int _{n \in N} \psi(n)
    \left(
      \int _{a \in A}
      \beta(a)
      \alpha[h](a n)
    \, \frac{d a}{\delta_U^{1/2}(a)}
    \right)
    \, d n.\]</span> We insert the Mellin expansion <span
class="math display">\[\beta(a) =
    \int _{(\sigma)}
    \tilde{\beta}(\chi)
    \chi(a) \, d \chi,\]</span> which converges for all <span
class="math inline">\(\sigma \in \mathfrak{a}^*\)</span>. The inner
integral in <a href="#eq:fh-=-int" data-reference-type="eqref"
data-reference="eq:fh-=-int">\((9.10)\)</a> evaluates to <span
class="math display">\[\int _{(\sigma)}
    \tilde{\beta}(\chi) \alpha[h,\chi](n) \, d \chi,\]</span> where
<span class="math display">\[\alpha[h,\chi](g) :=
    \int _{a \in A}
    \delta_U^{-1/2}(a)
    \chi(a) \alpha[h](a g) \, d a.\]</span> This defines a holomorphic
family of vectors in the normalized induced representations <span
class="math inline">\(\mathcal{I}(\chi)\)</span>. We obtain <span
class="math display">\[f(h) = \int _{n \in N } \psi(n)
    \left(
      \int _{(\sigma)} \tilde{\beta}(\chi) \alpha[h,\chi](n) \, d \chi
    \right)
    \, d n.\]</span> Take <span class="math inline">\(\sigma\)</span> to
be strictly dominant. Then this double integral converges absolutely (as
follows from the absolute convergence of the intertwining operator,
recalled in §<a href="#sec:basic-definition-intertwining-ops"
data-reference-type="ref"
data-reference="sec:basic-definition-intertwining-ops">2.13.1</a>), so
we may rearrange it as <span id="eq:fh-=-int-1" class="math display">\[\label{eq:fh-=-int-1}\tag{9.11}
    f(h) = \int _{(\sigma)} \tilde{\beta}(\chi) W[h,\chi,\psi](1) \, d
\chi,\]</span> where <span class="math display">\[W[h,\chi,\psi](g) :=
\int _{n \in N}
    \psi(n) \alpha[h,\chi](n g) \, d n.\]</span></p>
<p>Using the Iwasawa decomposition <span class="math inline">\(G = U A
K\)</span>, we may write our argument <span class="math inline">\(h \in
U \backslash G\)</span> as <span class="math inline">\(h = a k\)</span>,
with <span class="math inline">\((a,k) \in A \times K\)</span>. Then
<span class="math display">\[W[h,\chi,\psi](g) = \delta_{U}^{1/2}(a)
\chi(a) W[k,\chi,\psi](g),\]</span> and so <span id="eq:fa-k-=contour" class="math display">\[\label{eq:fa-k-=contour}\tag{9.12}
    f(a k)
    = \int _{(\sigma)} \tilde{\beta}(\chi) \delta_{U}^{1/2}(a) \chi(a)
W[k,\chi,\psi](1) \, d \chi.\]</span> In view of our hypothesis that
<span class="math inline">\(\beta \in \mathcal{S}^e(A)\)</span>, we have
<span class="math inline">\(\tilde{\beta}(\chi) = 0\)</span> unless
<span class="math inline">\(\chi\)</span> is of the form <span
class="math inline">\(|.|^s\)</span> with <span class="math inline">\(s
\in \mathfrak{a}_{\mathbb{C}}^*\)</span>. Thus, defining <span
class="math inline">\(f[s] \in \mathcal{I}(s)\)</span> by <span
class="math display">\[f[s](k) =
\tilde{\beta}(|.|^s)  W[k,|.|^s,\psi](1),\]</span> we obtain the Mellin
expansion <span class="math display">\[f = \int _{(\sigma)} f[s] \, d
\mu_{A}(s),\]</span> initially valid for strictly dominant <span
class="math inline">\(\sigma\)</span>.</p>
<p>We may understand <span class="math inline">\(W[k,|.|^s,
\psi](1)\)</span> as the application of the Jacquet integral to the
holomorphic family of vectors <span
class="math inline">\(\alpha[k,|.|^s]\)</span>. Since the Jacquet
integral varies analytically (see §<a href="#sec:whittaker-functions-1"
data-reference-type="ref"
data-reference="sec:whittaker-functions-1">2.12</a>, or §<a
href="#sec:analyt-cont-jacq" data-reference-type="ref"
data-reference="sec:analyt-cont-jacq">4.3</a> below), we see that <span
class="math inline">\(\{f[s]\}\)</span> defines a holomorphic family. We
claim that this family is of rapid vertical decay (§<a
href="#sec:mellin-paley-affine-quotients" data-reference-type="ref"
data-reference="sec:mellin-paley-affine-quotients">2.8.3</a>). In
checking this claim, we may once again invoke the equivariance property
<a href="#eq:rx-mathcald_psi-beta" data-reference-type="eqref"
data-reference="eq:rx-mathcald_psi-beta">\((9.4)\)</a>
to reduce to verifying the following estimate (without derivatives): for
each compact subset <span class="math inline">\(\mathcal{D}\)</span> of
<span class="math inline">\(\mathfrak{a}^*\)</span> and <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, <span id="eq:sup_-substack-s" class="math display">\[\label{eq:sup_-substack-s}\tag{9.13}
    \sup_{
      \substack{
        s \in \mathfrak{a}_{\mathbb{C}}^* :  \\
         \Re(s) \in \mathcal{D}
      }
    }
    (1 + |s|)^{\ell}
    \sup_{k \in K}
    \left\lvert
      f[s](k)
    \right\rvert &lt; \infty.\]</span> We will check the claim below,
and in doing so, see that the LHS is in fact bounded by continuous
seminorms of <span class="math inline">\(\beta\)</span> of <span
class="math inline">\(\gamma\)</span>, giving the required continuity
per the discussion preceding <a href="#eq:sup_-substack-s-1"
data-reference-type="eqref"
data-reference="eq:sup_-substack-s-1">\((9.8)\)</a>.</p>
<p>To that end, we observe first that for all <span
class="math inline">\(\mathcal{D}, \ell\)</span> as above, there is a
continuous seminorm <span class="math inline">\(\mu_1\)</span> on <span
class="math inline">\(\mathcal{S}(A)\)</span> so that <span
class="math display">\[\sup_{s : \Re(s) \in \mathcal{D}} (1 +
|s|)^{\ell} \left\lvert \tilde{\beta}(|.|^s) \right\rvert
\leqslant\mu_1(\beta).\]</span> We next apply Proposition <a
href="#prop:jacquet-integral-uniformity-question:let-eta-be"
data-reference-type="ref"
data-reference="prop:jacquet-integral-uniformity-question:let-eta-be">164</a>,
stated and proved below in §<a href="#sec:analyt-cont-jacq"
data-reference-type="ref" data-reference="sec:analyt-cont-jacq">4.3</a>,
which gives the following “polynomially effective” version of the
analytic continuation of Jacquet integrals: for each compact subset
<span class="math inline">\(\mathcal{D}\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span>, there exists <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span> and a
seminorm <span class="math inline">\(\mu_2\)</span> on <span
class="math inline">\(C^\infty(K)\)</span>, depending only upon <span
class="math inline">\(\mathcal{D}\)</span>, so that for all <span
class="math inline">\(k \in K\)</span> and <span class="math inline">\(s
\in \mathfrak{a}^*\)</span> with <span class="math inline">\(\Re(s) \in
\mathcal{D}\)</span>, <span class="math display">\[\sup_{s : \Re(s) \in
\mathcal{D}} |W[k,|.|^s,\psi](1)| \leqslant(1 + |s|)^{\ell}
\mu_2(\alpha[k,|.|^s]).\]</span> Therefore <a href="#eq:sup_-substack-s"
data-reference-type="eqref"
data-reference="eq:sup_-substack-s">\((9.13)\)</a> is bounded
by <span class="math display">\[\mu_1(\beta) \sup_{ s : \Re(s) \in
\mathcal{D} } \sup_{k \in K} \mu_2(\alpha[k,|.|^s]).\]</span> On the
other hand:</p>
<ul>
<li><p>For each compact subset <span
class="math inline">\(\mathcal{D}\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span>, the map <span
class="math display">\[\mathcal{S}(U \backslash G)
    \ni \eta
    \mapsto \sup_{
      \substack{
        \chi \in \mathfrak{X}(A):  \\
          \Re(\chi) \in \mathcal{D}
      }
    }
    \mu(\eta[\chi])\]</span> defines a continuous seminorm on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span>. This is
immediate from the discussion of §<a
href="#sec:mellin-paley-affine-quotients" data-reference-type="ref"
data-reference="sec:mellin-paley-affine-quotients">2.8.3</a>.</p></li>
<li><p>The family of maps <span class="math display">\[\mathcal{S}(G)
\ni \gamma \mapsto \alpha[k] \in \mathcal{S}(U \backslash G)
    \quad (k \in K)\]</span> is equicontinuous, as follows from Lemma <a
href="#lem:cal-S-G-to-cal-S-U-G" data-reference-type="ref"
data-reference="lem:cal-S-G-to-cal-S-U-G">152</a>.</p></li>
</ul>
<p>Combining these, we deduce that there is a continuous seminorm <span
class="math inline">\(\mu_3\)</span> on <span
class="math inline">\(\mathcal{S}(G)\)</span> so that <span
class="math display">\[\sup_{ s : \Re(s) \in \mathcal{D} } \sup_{k \in
K} \mu_2(\alpha[k,|.|^s]) \leqslant\mu_3(\gamma).\]</span> This
completes the proof of <a href="#eq:sup_-substack-s"
data-reference-type="eqref"
data-reference="eq:sup_-substack-s">\((9.13)\)</a> in the
required quantitative form. ◻</p>
</div>
<div class="remark">
<p><strong>Remark 156</strong>. The conclusion of the proposition is
closely related to arguments employed in some <em>proofs</em> of the
analytic continuation of Jacquet integrals (cf. <a href="#ref-MR563369" class="citation"
data-cites="MR563369">(Shahidi 1980, Thm 2.1)</a>), and could likely
be deduced by quantifying those arguments. We have instead argued the
other way, deducing the conclusion from (a quantitative form of) the
analytic continuation of Jacquet integrals.</p>
</div>
<div class="remark">
<p><strong>Remark 157</strong>. In <a href="#ref-MR2058615" class="citation"
data-cites="MR2058615">(Hervé Jacquet 2004)</a>, Jacquet gave some
results for <span class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span>
that are similar in spirit.</p>
</div>
<div id="rmk:standard2:we-expect-it-extend-S" class="remark">
<p><strong>Remark 158</strong>. We expect it to be true and provable
that the same assignment defines a continuous map <span
class="math inline">\(\mathcal{S}(A) \times \mathcal{S}(G) \rightarrow
\mathcal{S}(U \backslash G)\)</span>. We do not require such an
extension, whose verification would require additional effort (see
Remark <a href="#rmk:standard2:jacquet-analytic-refine"
data-reference-type="ref"
data-reference="rmk:standard2:jacquet-analytic-refine">171</a>).</p>
</div>
<p>For the following discussion, we take <span
class="math inline">\((\beta,\gamma) \in \mathcal{S}^e(A) \times
\mathcal{S}(G)\)</span> (although, for the reasons indicated in Remark
<a href="#rmk:standard2:we-expect-it-extend-S" data-reference-type="ref"
data-reference="rmk:standard2:we-expect-it-extend-S">158</a>, we expect
that all of these results should hold more generally for <span
class="math inline">\(\beta \in \mathcal{S}(A)\)</span>).</p>
<p>We have seen that <span
class="math inline">\(\mathcal{J}[\psi,\beta,\gamma]\)</span> lies in
<span class="math inline">\(\mathcal{S}(U \backslash G)\)</span>, so we
may define its Mellin components for <span class="math inline">\(\chi
\in \mathfrak{X}(A)\)</span> (which, by our assumptions on <span
class="math inline">\(\beta\)</span>, vanish for <span
class="math inline">\(\chi\)</span> outside <span
class="math inline">\(\mathfrak{X}^e(A)\)</span>). For typographical
reasons, we often denote these by <span
class="math display">\[\mathcal{J}[\psi,\beta,\gamma,\chi] :=
\mathcal{J}[\psi,\beta,\gamma][\chi] \in \mathcal{I}(\chi).\]</span></p>
<div id="lem:scratch-research:let-chi-in-1-v-J" class="lemma">
<p><strong>Lemma 159</strong>. Let <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span> with strictly dominant real part, and let <span
class="math inline">\(v \in \mathcal{I}(\chi)\)</span>. Then for all
<span class="math inline">\(\beta \in \mathcal{S}(A)\)</span>, the
integral <span class="math display">\[\int _{U \backslash G} v \cdot
\overline{\mathcal{J}[\psi, \beta ]}\]</span> converges absolutely, is
continuous in <span class="math inline">\(v\)</span> and <span
class="math inline">\(\beta\)</span>, and is equal to <span
class="math display">\[\overline{\tilde{\beta}(\bar{\chi}^{-1})}
    W[v, \psi](1)\]</span> provided that the Haar measure on <span
class="math inline">\(U \backslash G\)</span> is normalized so that the
multiplication map <span class="math inline">\(N \times A \rightarrow U
\backslash G\)</span> is measure-preserving.</p>
</div>
<div class="proof">
<p><em>Proof.</em> For <span class="math inline">\((a,n) \in A \times
N\)</span>, we have <span class="math inline">\(v(a n) = \delta_U^{1/2}
\chi(a) v(n)\)</span> and <span
class="math inline">\(\mathcal{J}[\psi,\beta](a n) = \delta_U^{1/2}(a)
\beta(a) \psi(n)\)</span>, so <span class="math display">\[\int _{U
\backslash G} v \cdot \overline{\mathcal{J}[\psi, \beta ]}
    =
    \int _{a \in A}
    \int _{u \in N}
    \chi(a) \overline{\beta}(a)
    v(n)
    \psi^{-1}(n) \, d n \, d a.\]</span> This integral factors as a
product of absolutely convergent integrals over <span
class="math inline">\(A\)</span> and <span
class="math inline">\(N\)</span>, which evaluate as indicated. These
absolutely convergent integrals are moreover bounded by continuous
seminorms, whence the continuity. ◻</p>
</div>
<p>Write, as before, <span class="math inline">\(\gamma^*(g) =
\overline{\gamma(g^{-1})}\)</span>.</p>
<div id="lem:scratch-research:let-chi-in" class="lemma">
<p><strong>Lemma 160</strong>. Let <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span> and <span class="math inline">\(v \in
\mathcal{I}(\chi)\)</span>. We have</p>
<p><span id="eq:int-_n-v" class="math display">\[\label{eq:int-_n-v}\tag{9.14}
  \overline{\tilde{\beta}(\bar{\chi}^{-1})}
  W[R(\gamma^*) v,\psi](g)
  =
  \int _{N} v \cdot \overline{\mathcal{J}[\psi, \beta, \gamma \ast
g^{-1}, \bar{\chi}^{-1}]}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We observe first that the RHS of the stated identity
makes sense. Indeed, we have seen that <span
class="math inline">\(\mathcal{J}[\psi,\beta,\gamma \ast
g^{-1}]\)</span> lies in <span class="math inline">\(\mathcal{S}(U
\backslash G)\)</span>, so its Mellin components define a holomorphic
family of vectors. Up to normalization of Haar measure, the integral on
the RHS of <a href="#eq:int-_n-v" data-reference-type="eqref"
data-reference="eq:int-_n-v">\((9.14)\)</a> over <span
class="math inline">\(N\)</span> may be replaced with the same integral
over <span class="math inline">\(K\)</span>. In particular, that
integral converges absolutely for all <span
class="math inline">\(\chi\)</span>.</p>
<p>We may reduce to the case <span class="math inline">\(g = 1\)</span>,
as follows. We have <span class="math display">\[W[ R(\gamma^* ) v,
\psi](g) = W[R(g) R(\gamma^* ) v, \psi](1),\]</span> <span
class="math inline">\(R(g ) R(\gamma^*) = R(g \ast \gamma^*)\)</span>
and <span class="math inline">\(g \ast \gamma^* = (\gamma \ast
g^{-1})^*\)</span> Thus if the identity <a href="#eq:int-_n-v"
data-reference-type="eqref"
data-reference="eq:int-_n-v">\((9.14)\)</a> holds for <span
class="math inline">\(g=1\)</span> and all <span
class="math inline">\(\gamma\)</span>, then it holds for all <span
class="math inline">\(g\)</span>. Our task is thus to verify that <span id="eq:overl-1-wgamma" class="math display">\[\label{eq:overl-1-wgamma}\tag{9.15}
  \overline{\tilde{\beta}(\bar{\chi}^{-1})}
  W[R(\gamma^*) v,\psi](1)
  =
  \int _{N} v \cdot \overline{\mathcal{J}[\psi, \beta, \gamma,
\bar{\chi}^{-1}]}.\]</span></p>
<p>Since <span class="math inline">\(\gamma\)</span> and its derivatives
are integrable, the assignment <span class="math inline">\(v \mapsto
R(\gamma^*) v\)</span> defines a continuous map from the representation
<span class="math inline">\(\mathcal{I}(\chi)\)</span>, equipped with
the <span class="math inline">\(L^2(K)\)</span>-topology, to the same
representation equipped with the usual smooth topology. It follows that
both sides of <a href="#eq:overl-1-wgamma" data-reference-type="eqref"
data-reference="eq:overl-1-wgamma">\((9.15)\)</a> depend
continuously upon <span class="math inline">\(v\)</span> with respect to
the <span class="math inline">\(L^2(K)\)</span>-topology. By a limiting
argument, we may thus reduce to the case that the restriction of <span
class="math inline">\(v\)</span> to <span
class="math inline">\(N\)</span> is compactly-supported.</p>
<p>We define in that case a holomorphic family <span
class="math inline">\(v[s] \in \mathcal{I}(\chi |.|^s)\)</span> by
requiring that <span class="math inline">\(v[s]|_{N} = v|_N\)</span>, so
that <span class="math inline">\(v[0] = v\)</span>. The LHS of <a
href="#eq:int-_n-v" data-reference-type="eqref"
data-reference="eq:int-_n-v">\((9.14)\)</a> is, by definition, the
value at <span class="math inline">\(s = 0\)</span> of the analytic
continuation of <span id="eq:overl-1.-bars" class="math display">\[\label{eq:overl-1.-bars}\tag{9.16}
    \overline{\tilde{\beta}(\bar{\chi}^{-1}|.|^{-\bar{s}})}
    W[R(\gamma^*) v[s], \psi](1),\]</span> defined initially for <span
class="math inline">\(\Re(s)\)</span> sufficiently dominant by an
absolutely convergent integral. For such <span
class="math inline">\(s\)</span>, we may apply Lemma <a
href="#lem:scratch-research:let-chi-in-1-v-J" data-reference-type="ref"
data-reference="lem:scratch-research:let-chi-in-1-v-J">159</a> to
rewrite the above as the absolutely convergent integral <span
class="math display">\[\int _{U \backslash G}
    R(\gamma^*) v[s] \cdot
    \overline{\mathcal{J}[\psi,\beta]},\]</span> This last integral may
be expanded as the double integral (absolutely convergent, again by
Lemma <a href="#lem:scratch-research:let-chi-in-1-v-J"
data-reference-type="ref"
data-reference="lem:scratch-research:let-chi-in-1-v-J">159</a>) <span
class="math display">\[\int _{g \in U \backslash G}
    \int _{h \in G} \gamma^*(h)
    v[s](g h) \overline{\mathcal{J}[\psi,\beta](g)} \, d h \, d
g.\]</span> The substitutions <span class="math inline">\(g \mapsto g
h^{-1}\)</span> and <span class="math inline">\(h \mapsto
h^{-1}\)</span> allow us to further rewrite the above as <span
class="math display">\[\int _{g \in U \backslash G}
    \int _{h \in G} \gamma^*(h^{-1})
    v[s](g) \overline{\mathcal{J}[\psi,\beta](g h)} \, d h \, d
g,\]</span> which, recalling the definition <span
class="math inline">\(R(\gamma) \mathcal{J}[\psi,\beta] =
\mathcal{J}[\psi,\beta,\gamma]\)</span>, may in turn be rewritten <span id="eq:int-_g-in-gu" class="math display">\[\label{eq:int-_g-in-gu}\tag{9.17}
    \int _{g \in U \backslash G}
    v[s](g) \overline{\mathcal{J}[\psi,\beta,\gamma](g)} \, d
g.\]</span> Since (by Proposition <a href="#lem:sub-gln:each-psi-beta"
data-reference-type="ref"
data-reference="lem:sub-gln:each-psi-beta">155</a>) we have <span
class="math inline">\(\mathcal{J}[\psi,\beta,\gamma] \in \mathcal{S}(U
\backslash G)\)</span>, this last integral converges absolutely for all
<span class="math inline">\(s\)</span>, hence defines an analytic
function of <span class="math inline">\(s\)</span> given by the same
formula. Specializing the equality between <a href="#eq:overl-1.-bars"
data-reference-type="eqref"
data-reference="eq:overl-1.-bars">\((9.16)\)</a> and <a
href="#eq:int-_g-in-gu" data-reference-type="eqref"
data-reference="eq:int-_g-in-gu">\((9.17)\)</a> to the case <span
class="math inline">\(s = 0\)</span> gives the desired identity <a
href="#eq:overl-1-wgamma" data-reference-type="eqref"
data-reference="eq:overl-1-wgamma">\((9.15)\)</a>. ◻</p>
</div>
<p>For the following result, we denote by <span
class="math inline">\(\check{\gamma}(g) := \gamma(g^{-1})\)</span> the
“real adjoint” of <span class="math inline">\(\gamma\)</span>.</p>
<div id="lem:standard:chi-in-mathfrakxa" class="lemma">
<p><strong>Lemma 161</strong>. For <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span> and <span class="math inline">\(v \in
\mathcal{I}(\chi^{-1})\)</span>, we have <span id="eq:mathc-beta-gamm-1" class="math display">\[\label{eq:mathc-beta-gamm-1}\tag{9.18}
    \int _{N}
    v \cdot
    \mathcal{J}[\psi,\beta,\gamma \ast g^{-1}][\chi]
    =
    \tilde{\beta}(\chi)
    W[R(\check{\gamma}) v, \psi^{-1}](g).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We apply complex conjugation to Lemma <a
href="#lem:scratch-research:let-chi-in" data-reference-type="ref"
data-reference="lem:scratch-research:let-chi-in">160</a>. ◻</p>
</div>
<p>Recall from §<a href="#sec:fourier-transforms"
data-reference-type="ref"
data-reference="sec:fourier-transforms">2.13.2</a> the unitary operators
<span class="math inline">\(\mathcal{F}_{w,\psi}\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> attached to
Weyl group elements <span class="math inline">\(w \in W\)</span>.</p>
<div id="lem:sub-gln:each-psi-beta-1" class="lemma">
<p><strong>Lemma 162</strong>. For <span class="math inline">\(w \in
W\)</span>, we have <span
class="math display">\[\mathcal{F}_{w,\psi^{-1}}
\mathcal{J}[\psi,\beta,\gamma] = \mathcal{J}[{\psi,{}^w
\beta,\gamma}],\]</span> where <span class="math inline">\({}^w \beta(a)
:= \beta(w^{-1} a)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> For the proof, we abbreviate <span
class="math inline">\(\mathcal{F}_w :=
\mathcal{F}_{w,\psi^{-1}}\)</span>. It is enough to check that for each
<span class="math inline">\(\chi \in [A]^\wedge\)</span>, we have <span
class="math display">\[(\mathcal{F}_w \mathcal{J}[\psi,\beta,\gamma])[ w
\chi] = \mathcal{J}[{\psi,{}^w \beta, \gamma}][w \chi].\]</span> By
definition, <span class="math display">\[(\mathcal{F}_w
\mathcal{J}[\psi,\beta,\gamma])[ w \chi] = \mathcal{F}_w
\mathcal{J}[\psi,\beta,\gamma][\chi]
    :=
    \mathcal{F}_w (\mathcal{J}[\psi,\beta,\gamma][\chi]).\]</span> It is
enough to check that for each <span class="math inline">\(v \in
\mathcal{I}(w \chi^{-1})\)</span>, we have <span
class="math display">\[(\mathcal{F}_w
\mathcal{J}[\psi,\beta,\gamma][\chi], v)
  =
  (\mathcal{J}[{\psi,{}^w \beta, \gamma}][w \chi], v),\]</span> where
<span class="math inline">\((,)\)</span> denotes the invariant pairing
given by integrating the product over <span
class="math inline">\(N\)</span>. By <a href="#eq:mathc-1-mathc"
data-reference-type="eqref"
data-reference="eq:mathc-1-mathc">\((2.28)\)</a> and <a
href="#eq:f_1chi-f_2chi-1" data-reference-type="eqref"
data-reference="eq:f_1chi-f_2chi-1">\((2.29)\)</a>, we have
<span class="math display">\[(\mathcal{F}_w
\mathcal{J}[\psi,\beta,\gamma][\chi], v) =
(\mathcal{J}[\psi,\beta,\gamma][\chi], \mathcal{F}_{w^{-1}} v).\]</span>
By Lemma <a href="#lem:standard:chi-in-mathfrakxa"
data-reference-type="ref"
data-reference="lem:standard:chi-in-mathfrakxa">161</a> (specialized to
<span class="math inline">\(g=1\)</span>) and the identity <span
class="math inline">\(\tilde{\beta}(\chi) = {}^w \tilde{\beta}(w
\chi)\)</span>, we reduce to checking that <span
class="math display">\[W[R(\check{\gamma}) \mathcal{F}_{w^{-1}} v,
\psi^{-1}](1)
  =
  W[R(\check{\gamma}) v, \psi^{-1}](1).\]</span> This follows from the
equivariance property <span class="math inline">\(R(\check{\gamma})
\mathcal{F}_{w^{-1}} v = \mathcal{F}_{w^{-1}} R(\check{\gamma})
v\)</span> of <span class="math inline">\(\mathcal{F}_{w^{-1}}\)</span>
and the defining property <a href="#eq:wmathcalf_w-fchi-psi"
data-reference-type="eqref"
data-reference="eq:wmathcalf_w-fchi-psi">\((2.27)\)</a>
of <span class="math inline">\(\mathcal{F}_{w^{-1}}\)</span>. ◻</p>
</div>
<div id="lem:scratch-research:let-beta_1-beta_2" class="lemma">
<p><strong>Lemma 163</strong>. Let <span class="math inline">\(\beta_1,
\beta_2 \in \mathcal{S}^e(A)\)</span>, <span
class="math inline">\(\gamma_1, \gamma_2 \in \mathcal{S}(G)\)</span>.
Set <span class="math inline">\(\gamma := \gamma_2^* \ast
\gamma_1\)</span> and <span class="math display">\[f :=
\mathcal{J}[\psi, \beta_1, \gamma] \in \mathcal{S}^e(U \backslash
G).\]</span> Then for each <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span> and <span class="math inline">\(g \in
G\)</span>, <span
class="math display">\[\overline{\tilde{\beta}_2(\bar{\chi}^{-1})}
    W[f[\chi], \psi](g)
    =
    \int _{N}
    \mathcal{J}[\psi, \beta_1, \gamma_1, \chi]
    \overline{\mathcal{J}[\psi, \beta_2, \gamma_2 \ast g^{-1},
\bar{\chi}^{-1}]}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Unwinding the definitions and applying <a
href="#eq:rgamm-mathc-beta" data-reference-type="eqref"
data-reference="eq:rgamm-mathc-beta">\((9.3)\)</a>, we see
that <span class="math display">\[f[\chi] = R(\gamma_2^*)
\mathcal{J}[\psi,\beta_1,\gamma_1][\chi].\]</span> By Lemma <a
href="#lem:scratch-research:let-chi-in" data-reference-type="ref"
data-reference="lem:scratch-research:let-chi-in">160</a> applied to
<span class="math inline">\(v :=
\mathcal{J}[\psi,\beta_1,\gamma_1][\chi]\)</span>, we then have <span
class="math display">\[\overline{\tilde{\beta}_2(\bar{\chi}^{-1})}
    W[f[\chi], \psi](g)
    =
    \int_N v \cdot \overline{\mathcal{J}[\psi,\beta_2, \gamma_2 \ast
g^{-1}, \bar{\chi}^{-1}]},\]</span> as required. ◻</p>
</div>
<h4 id="sec:analyt-cont-jacq">§9.3. Analytic continuation of the Jacquet
integral</h4>
<p>Let <span class="math inline">\(G\)</span> be a quasi-split reductive
group over <span class="math inline">\(\mathbb{R}\)</span>. We assume
moreover, for technical reasons (see Lemma <a href="#lem:assume-that-g"
data-reference-type="ref" data-reference="lem:assume-that-g">169</a>),
that <span class="math inline">\(G\)</span> arises via restriction of
scalars from a split group over <span
class="math inline">\(\mathbb{R}\)</span> or <span
class="math inline">\(\mathbb{C}\)</span>. In particular, the discussion
to follow applies to the groups <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span> and
<span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{C})\)</span>.</p>
<p>Since the notation here is a bit different from that in the rest of
the paper (where we typically take <span
class="math inline">\(G\)</span> split, for simplicity), we recap all
necessary notation.</p>
<p>We assume given a pair of Borel subgroups <span
class="math inline">\(B = M N\)</span> and <span class="math inline">\(Q
= M U\)</span> of <span class="math inline">\(G\)</span>, with maximal
torus <span class="math inline">\(M\)</span> and respective unipotent
radicals <span class="math inline">\(N\)</span> and <span
class="math inline">\(U\)</span>. (We will use the latter for induced
representations, the former for Whittaker functions.)</p>
<p>Let <span class="math inline">\(X(M)\)</span> denote the group of
algebraic characters of <span class="math inline">\(M\)</span>. Write
<span class="math display">\[\mathfrak{a}^* := X(M) \otimes_{\mathbb{Z}}
\mathbb{R} \hookrightarrow \mathfrak{a}_{\mathbb{C}}^* := X(M)
\otimes_{\mathbb{Z}} \mathbb{C}.\]</span> (We may identify <span
class="math inline">\(\mathfrak{a}^*\)</span> with the dual of <span
class="math inline">\(\mathop{\mathrm{Lie}}(A)\)</span>, where <span
class="math inline">\(A \leqslant M\)</span> denotes the maximal <span
class="math inline">\(\mathbb{R}\)</span>-split subtorus.) Let <span
class="math inline">\(\mathfrak{X}(M)\)</span> denote the group of
complex characters <span class="math inline">\(\chi : M \rightarrow
\mathbb{C}^\times\)</span>. To each <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span>, we may associate a character <span
class="math inline">\(|.|^s \in \mathfrak{X}(M)\)</span>, denoted <span
class="math inline">\(m \mapsto |m|^{s}\)</span>. For each <span
class="math inline">\(\chi \in \mathfrak{X}(M)\)</span>, we may define
<span class="math inline">\(\Re(\chi) \in \mathfrak{a}^*\)</span> by
writing <span class="math inline">\(|\chi(m)| =
|m|^{\Re(\chi)}\)</span>. For <span class="math inline">\(\chi \in
\mathfrak{X}(M)\)</span> and <span class="math inline">\(s \in
\mathfrak{a}^*_{\mathbb{C}}\)</span>, we abbreviate <span
class="math inline">\(\chi_s := \chi |.|^s \in \mathfrak{X}(M)\)</span>.
We denote by <span class="math inline">\(\delta_U : M \rightarrow
\mathbb{R}^\times_+\)</span> the modulus character.</p>
<p>Let <span class="math inline">\(K \leqslant G\)</span> be a maximal
compact subgroup such that <span class="math inline">\(K \cap M\)</span>
is a maximal compact subgroup of <span class="math inline">\(M\)</span>.
Let <span class="math inline">\(W\)</span> denote the Weyl group for
<span class="math inline">\((G,A)\)</span>. Let <span
class="math inline">\(\psi\)</span> be a nondegenerate unitary character
of <span class="math inline">\(N\)</span>. We choose Haar measures on
<span class="math inline">\(N\)</span> and <span
class="math inline">\(G\)</span>. We choose a <span
class="math inline">\(W\)</span>-invariant norm <span
class="math inline">\(|.|\)</span> on <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span>.</p>
<p>Let <span class="math inline">\(\Delta \subseteq
\mathfrak{a}^*\)</span> denote the set of simple roots attached to <span
class="math inline">\(U\)</span>. In this section, “dominant” always
refers to the sense defined by <span class="math inline">\(U\)</span>
(rather than <span class="math inline">\(N\)</span>).</p>
<p>For each <span class="math inline">\(\chi \in
\mathfrak{X}(M)\)</span>, we denote by <span
class="math inline">\(\mathcal{I}(\chi)\)</span> the corresponding
smooth principal series representation of <span
class="math inline">\(G\)</span>, consisting of all smooth functions
<span class="math inline">\(f : U \backslash G \rightarrow
\mathbb{C}\)</span> satisfying <span class="math inline">\(f(m g) =
\delta_U^{1/2}(m) \chi(m) f(g)\)</span> for all <span
class="math inline">\((m,g) \in M \times G\)</span>.</p>
<p>Let <span class="math inline">\(w_0 \in G\)</span> be a
representative for the Weyl group element such that <span
class="math inline">\(w_0 N = \bar{U} w_0\)</span>, where <span
class="math inline">\(\bar{U}\)</span> denotes the maximal unipotent
subgroup opposite to <span class="math inline">\(U\)</span>.</p>
<p>Let <span class="math inline">\(\chi \in \mathfrak{X}(M)\)</span> and
<span class="math inline">\(f \in \mathcal{I}(\chi)\)</span>. We define
<span class="math inline">\(W[f,\psi] : G \rightarrow
\mathbb{C}\)</span>, first for strictly dominant <span
class="math inline">\(\chi\)</span> by the absolutely convergent Jacquet
integral <span id="eq:wf-psig-:whittaker-analytic" class="math display">\[\label{eq:wf-psig-:whittaker-analytic}\tag{9.19}
  W[f,\psi](g) := \int _{n \in N } f (w_0 n g) \psi^{-1}(n) \, d
n,\]</span> then in general by analytic continuation along flat sections
(see <a href="#ref-MR563369" class="citation" data-cites="MR563369">(Shahidi 1980)</a>,
<a href="#ref-MR1170566" class="citation" data-cites="MR1170566">(Wallach 1992, vol. 132,
sec. 15.4)</a>). It defines an equivariant map <span
class="math display">\[W[\cdot, \psi] : \mathcal{I}(\chi) \rightarrow
C^\infty(N \backslash G, \psi).\]</span> We have seen some references in
which it is noted that such maps are “locally uniform” provided that
<span class="math inline">\(\chi\)</span> is constrained to a given
compact subset of <span class="math inline">\(\mathfrak{X}(M)\)</span>
(see, e.g., <a href="#ref-MR2533003" class="citation" data-cites="MR2533003">(Hervé Jacquet
2009, sec. 3.5)</a>). We require the following slightly finer
uniformity condition, in which only the real part of <span
class="math inline">\(\chi\)</span> is constrained.</p>
<div id="prop:jacquet-integral-uniformity-question:let-eta-be"
class="proposition">
<p><strong>Proposition 164</strong>. <em>Let <span
class="math inline">\(\chi \in \mathfrak{X}(M)\)</span>. Let <span
class="math inline">\(\mathcal{D}\)</span> be a compact subset of <span
class="math inline">\(\mathfrak{a}^*\)</span>. There exists <span
class="math inline">\(C_0 \geqslant 0\)</span>, <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span> and a
seminorm <span class="math inline">\(\mu\)</span> on <span
class="math inline">\(C^\infty(K)\)</span> so that for all <span
class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span> with
<span class="math inline">\(\Re(s) \in \mathcal{D}\)</span>, we have for
all <span class="math inline">\(f \in \mathcal{I}(\chi_s)\)</span> the
estimate <span class="math display">\[|W[f,\psi](1)|
  \leqslant
  C_0
  (1 + |s|)^{\ell}
  \mu(f).\]</span></em></p>
</div>
<p>We expect that such an estimate should follow (in sharper forms) by a
careful quantification of the proofs given in <a href="#ref-MR563369" class="citation"
data-cites="MR563369">(Shahidi 1980)</a> or <a href="#ref-MR1170566" class="citation"
data-cites="MR1170566">(Wallach 1992, vol. 132, sec. 15.4)</a>. For
the sake of completeness, we record an alternative proof below, roughly
in the spirit of <a href="#ref-MR1800349" class="citation" data-cites="MR1800349">(Gelbart
and Shahidi 2001, Proof of Lemma 5.6)</a>, that instead takes the
analytic continuation of the Jacquet integral as a “black box” and
deduces the desired uniformity using standard bounds for intertwining
operators and the functional equation. The proof will follow a series of
lemmas.</p>
<p>For <span class="math inline">\(w \in W\)</span> and <span
class="math inline">\(\chi \in \mathfrak{X}(M)\)</span>, we define the
meromorphic families of intertwining operators <span
class="math display">\[M_w = M_w[\chi] : \mathcal{I}(\chi) \rightarrow
\mathcal{I}(w \chi)\]</span> and their normalized variants <span
class="math display">\[\mathcal{F}_w = \mathcal{F}_{w,\psi}[\chi] :
\mathcal{I}(\chi) \rightarrow \mathcal{I}(w \chi)\]</span> exactly as in
§<a href="#sec:local-intertw-oper-four" data-reference-type="ref"
data-reference="sec:local-intertw-oper-four">2.13</a>. We retain the
notational conventions of those sections. We denote by <span
class="math inline">\(c(w,\chi)\)</span> the proportionality constant
(“local coefficient”) relating the two: <span
class="math display">\[\mathcal{F}_w[\chi] = c(w,\chi)
M_w[\chi].\]</span></p>
<p>By a <em>root polynomial</em> <span class="math inline">\(p\)</span>
on <span class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span>, we
mean a polynomial of the form <span class="math display">\[p(s) =
\prod_{(\alpha,c) \in \Sigma}
  ( \alpha^\vee(s) - c  )\]</span> for some finite set <span
class="math inline">\(\Sigma\)</span> consisting of pairs of roots <span
class="math inline">\(\alpha\)</span> and complex numbers <span
class="math inline">\(c\)</span>.</p>
<div id="lem:jacquet-integral-uniformity-question:let-chi-in"
class="lemma">
<p><strong>Lemma 165</strong>. Let <span class="math inline">\(\chi \in
\mathfrak{X}(M)\)</span>. Let <span
class="math inline">\(\mathcal{D}\)</span> be a compact subset of <span
class="math inline">\(\mathfrak{a}^*\)</span>. There is a root
polynomial <span class="math inline">\(p\)</span> on <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span> and scalars
<span class="math inline">\(C_0 \geqslant 0\)</span>, <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span> so that
for all <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span> with <span
class="math inline">\(\Re(s) \in \mathcal{D}\)</span>, we have <span
class="math display">\[|p(s) c(w,\chi_s)| \leqslant C_0 (1 +
|s|)^{\ell}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We may express <span
class="math inline">\(c(w,\chi)\)</span> as a product of local Tate
<span class="math inline">\(\gamma\)</span>-factors (see <a href="#ref-MR816396"
class="citation" data-cites="MR816396">(Shahidi 1985, Thm 1)</a>). It
follows from this expression that <span
class="math inline">\(c(w,\chi_s)\)</span> has at most finitely many
poles with <span class="math inline">\(\Re(s) \in \mathcal{D}\)</span>.
We construct <span class="math inline">\(p\)</span> to kill each such
pole. The required upper bound then follows from Stirling’s formula (as,
for instance, in <a href="#ref-2021arXiv210112106B" class="citation"
data-cites="2021arXiv210112106B">(Blomer, Jana, and Nelson 2023, sec.
2.2)</a>). ◻</p>
</div>
<div id="lem:jacquet-integral-uniformity-question:let-chi-in-1"
class="lemma">
<p><strong>Lemma 166</strong>. Let <span class="math inline">\(\chi \in
\mathfrak{X}(M)\)</span>. Let <span class="math inline">\(d \in
\mathbb{R}\)</span>. There exists <span class="math inline">\(\ell \in
\mathbb{Z}_{\geqslant 0}\)</span>, a seminorm <span
class="math inline">\(\mu\)</span> on <span
class="math inline">\(C^\infty(K)\)</span> and a root polynomial <span
class="math inline">\(p\)</span> on <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span> with the
following property. Let <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span> such that <span
class="math inline">\(\alpha^\vee(\sigma) \geqslant d\)</span> for all
<span class="math inline">\(\alpha \in \Delta\)</span> and <span
class="math inline">\(p(s) \neq 0\)</span>. Then <span
class="math inline">\(s\)</span> is not a pole of <span
class="math inline">\(M_w : \mathcal{I}(\chi_s) \rightarrow
\mathcal{I}(w \chi_s)\)</span>, and for all <span
class="math inline">\(f \in \mathcal{I}(\chi_s)\)</span>, <span
class="math display">\[\|p(s) M_w f\|_{L^\infty(K)} \leqslant(1 +
|s|)^{\ell} \mu(f).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a special case of a result of Lapid <a href="#ref-MR2402686"
class="citation" data-cites="MR2402686">(E. M. Lapid 2008, Cor
2)</a>, whose proof refers in turns to Wallach <a href="#ref-MR1170566" class="citation"
data-cites="MR1170566">(Wallach 1992, vol. 132, sec.
10.1.11)</a>. ◻</p>
</div>
<div id="lem:standard:let-alpha-F-w-alpha-holom" class="lemma">
<p><strong>Lemma 167</strong>. Let <span class="math inline">\(\alpha
\in \Delta\)</span>. Let <span class="math inline">\(w_\alpha\)</span>
denote the corresponding simple reflection, thus <span
class="math inline">\(w_\alpha^2 = 1\)</span>. The meromorphic family of
operators <span class="math display">\[\mathcal{F}_{w_\alpha} :
\mathcal{I}(w_\alpha \chi ) \rightarrow \mathcal{I}(\chi)\]</span> is
holomorphic on <span class="math inline">\(\{\chi : \langle \Re(\chi),
\alpha^\vee \rangle \geqslant 0\}\)</span>, or indeed, on <span
class="math inline">\(\{\chi : \langle \Re(\chi), \alpha^\vee \rangle
&gt;  -1\}\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We can reduce to the case <span
class="math inline">\(G = {\mathop{\mathrm{SL}}}_2\)</span> and appeal to
the theory of one-dimensional local Tate integrals. For instance, in the
case <span class="math inline">\(F = \mathbb{R}\)</span>, the conclusion
of the lemma is noted by Shahidi <a href="#ref-MR563369" class="citation"
data-cites="MR563369">(Shahidi 1980)</a>, just before the statement
of <a href="#ref-MR563369" class="citation" data-cites="MR563369">(Shahidi 1980, Lemma
2.3.2)</a>, to follow from <a href="#ref-MR563369" class="citation"
data-cites="MR563369">(Shahidi 1980, Prop 2.2.1)</a>. The general
case may be treated in the same way. ◻</p>
</div>
<div id="lem:jacquet-integral-uniformity-question:let-w-in"
class="lemma">
<p><strong>Lemma 168</strong>. Let <span class="math inline">\(w \in
W\)</span>. Then <span class="math display">\[\mathcal{F}_w :
\mathcal{I}(w^{-1} \chi) \rightarrow \mathcal{I}(\chi)\]</span> is
holomorphic for <span class="math inline">\(\chi\)</span> with dominant
real part.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We factor <span class="math inline">\(w\)</span> as a
minimal product <span class="math inline">\(w_{\alpha_1} \dotsb
w_{\alpha_{\ell}}\)</span> of simple reflections, as in <a href="#ref-MR610479"
class="citation" data-cites="MR610479">(Shahidi 1981, Thm 2.1.1)</a>;
by <a href="#ref-MR610479" class="citation" data-cites="MR610479">(Shahidi 1981, sec.
3.2)</a>, <span class="math inline">\(\mathcal{F}_w\)</span> then
factors as a composition of operators <span
class="math inline">\(\mathcal{F}_{w_{\alpha_j}}\)</span> to which Lemma
<a href="#lem:standard:let-alpha-F-w-alpha-holom"
data-reference-type="ref"
data-reference="lem:standard:let-alpha-F-w-alpha-holom">167</a>
applies. ◻</p>
</div>
<div id="lem:assume-that-g" class="lemma">
<p><strong>Lemma 169</strong>. Assume that <span
class="math inline">\(G\)</span> arises, possibly via restriction of
scalars, from a split reductive group over <span
class="math inline">\(\mathbb{R}\)</span> or <span
class="math inline">\(\mathbb{C}\)</span>. Let <span
class="math inline">\(\chi \in \mathfrak{X}(M)\)</span>. Let <span
class="math inline">\(f \in \mathcal{I}(\chi)\)</span> be <span
class="math inline">\(K\)</span>-finite. For <span
class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span>, let
<span class="math inline">\(f_s \in \mathcal{I}(\chi_s)\)</span> be the
element with <span class="math inline">\(f_s|_K = f\)</span>. Then the
analytic function <span class="math inline">\(s \mapsto
W[f_s,\psi](1)\)</span> is of finite order <span
class="math inline">\(\leqslant 1\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a special case of a result of McKee <a href="#ref-MR3043499"
class="citation" data-cites="MR3043499">(McKee 2013, Thm
5.2)</a>. ◻</p>
</div>
<div class="remark">
<p><strong>Remark 170</strong>. For the argument that follows, we
require the weaker conclusion that the restriction of <span
class="math inline">\(s \mapsto W[f_s,\psi](1)\)</span> to <span
class="math inline">\(\{s : \Re(s) \in \mathcal{D} \}\)</span> is of
finite order for each compact subset <span
class="math inline">\(\mathcal{D}\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span>. This conclusion may be
available for more general groups <span class="math inline">\(G\)</span>
(and without the assumption of <span
class="math inline">\(K\)</span>-finiteness) via the technique of <a href="#ref-MR1800349"
class="citation" data-cites="MR1800349">(Gelbart and Shahidi 2001, Proof
of Lemma 5.6)</a>, but we were unable to verify all details.</p>
</div>
<div class="proof">
<p><em>Proof of Proposition <a
href="#prop:jacquet-integral-uniformity-question:let-eta-be"
data-reference-type="ref"
data-reference="prop:jacquet-integral-uniformity-question:let-eta-be">164</a>.</em>
For notational convenience, we will assume that <span
class="math inline">\(N = \bar{U}\)</span> is opposite to <span
class="math inline">\(U\)</span>, so that <span
class="math inline">\(w_0\)</span> may be taken to be the identity
element and the definition <a href="#eq:wf-psig-:whittaker-analytic"
data-reference-type="ref"
data-reference="eq:wf-psig-:whittaker-analytic">9.19</a>
simplifies to <span id="eq:wf-psi1-=whittaker-integral-simplified" class="math display">\[\label{eq:wf-psi1-=whittaker-integral-simplified}\tag{9.20}
    W[f, \psi](1) = \int _{n \in N } f (n) \psi^{-1}(n) \, d
n.\]</span></p>
<p>Given <span class="math inline">\(f \in \mathcal{I}(\chi)\)</span>
and <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span>, we write <span
class="math inline">\(f_s \in \mathcal{I}(\chi_s)\)</span> for the
element with <span class="math inline">\(f_s|_{K} = f|_K\)</span>. It
suffices to show the following: for each finite subset <span
class="math inline">\(\mathcal{X}\)</span> of <span
class="math inline">\(\mathfrak{X}(M)\)</span> and compact <span
class="math inline">\(\mathcal{D} \subseteq \mathfrak{a}^*\)</span> as
above, there exists <span class="math inline">\(C_0 \geqslant
0\)</span>, <span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant
0}\)</span> and a seminorm <span class="math inline">\(\mu\)</span> on
<span class="math inline">\(C^\infty(K)\)</span> so that for all <span
class="math inline">\(\chi \in \mathcal{X}\)</span> and <span
class="math inline">\(f \in \mathcal{I}(\chi)\)</span>, <span id="eq:wfchi-psi1-leq" class="math display">\[\label{eq:wfchi-psi1-leq}\tag{9.21}
    \Re(s) \in \mathcal{D} \, \implies \, |W[f_s, \psi](1)| \leqslant
C_0 (1 + |s|)^{\ell} \mu(f).\]</span> For convenience, we may and shall
assume that <span class="math inline">\(\Re(\chi) = 0\)</span> for each
<span class="math inline">\(\chi \in \mathfrak{X}\)</span> (otherwise,
replace <span class="math inline">\(\chi\)</span> with <span
class="math inline">\(\chi |.|^{-\Re(\chi)}\)</span> and enlarge <span
class="math inline">\(\mathcal{D}\)</span> suitably). We may assume also
– enlarging <span class="math inline">\(\mathcal{X}\)</span> as
necessary – that <span class="math inline">\(w \chi \in
\mathcal{X}\)</span> for all <span class="math inline">\((w,\chi) \in W
\times \mathcal{X}\)</span>.</p>
<p>By the continuity of both sides of the desired inequality, we may
assume that <span class="math inline">\(f\)</span> is <span
class="math inline">\(K\)</span>-finite (but, of course, the quantities
<span class="math inline">\(C_0\)</span>, <span
class="math inline">\(\ell\)</span> and <span
class="math inline">\(\mu\)</span> must be independent of the <span
class="math inline">\(K\)</span>-type of <span
class="math inline">\(f\)</span>).</p>
<p>We may find a compact subset <span
class="math inline">\(\mathcal{D}_0\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span> with the following
properties:</p>
<ol type="i">
<li><p>Every element of <span
class="math inline">\(\mathcal{D}_0\)</span> is strictly
dominant.</p></li>
<li><p><span class="math inline">\(\mathcal{D}\)</span> is contained in
the convex hull of <span class="math inline">\(\cup_{w \in W} w
\mathcal{D}_0\)</span>.</p></li>
</ol>
<p>For <span class="math inline">\(w \in W\)</span>, we have <span
class="math inline">\(w(\chi_s) = (w \chi)_{w s}\)</span>. By
hypothesis, we have <span class="math inline">\(w \chi \in
\mathcal{X}\)</span>. Since the norm <span
class="math inline">\(|.|\)</span> on <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span> is <span
class="math inline">\(W\)</span>-invariant, we have <span
class="math inline">\(|s| = |w s|\)</span> for all <span
class="math inline">\((s,w) \in \mathfrak{a}_{\mathbb{C}}^* \times
W\)</span>. In view of Lemma <a href="#lem:assume-that-g"
data-reference-type="ref" data-reference="lem:assume-that-g">169</a> and
our assumption that <span class="math inline">\(f\)</span> is <span
class="math inline">\(K\)</span>-finite, the Phragmen–Lindelöf principle
is applicable. The required estimate <a href="#eq:wfchi-psi1-leq"
data-reference-type="eqref"
data-reference="eq:wfchi-psi1-leq">\((9.21)\)</a> will thus
follow if we can show, with quantifiers as above, that <span id="eq:wfchi-psi1-leq-2" class="math display">\[\label{eq:wfchi-psi1-leq-2}\tag{9.22}
    (\Re(s),w) \in \mathcal{D}_0 \times W \, \implies \,
    |W[f_{w s}, \psi](1)| \leqslant C_0 (1 + |s|)^{\ell}
\mu(f).\]</span></p>
<p>We consider first the case <span class="math inline">\(w =
1\)</span>. For <span class="math inline">\(\sigma \in
\mathfrak{a}^*\)</span>, let <span class="math inline">\(\phi_{\sigma }
\in \mathcal{I}(|.|^{\sigma})\)</span> denote the spherical vector
taking the value <span class="math inline">\(1\)</span> at the identity.
In particular, <span class="math inline">\(\phi_\sigma \geqslant
0\)</span>. If <span class="math inline">\(\sigma\)</span> is strictly
dominant, then the integral <span class="math inline">\(\int_{N}
\phi_\sigma\)</span> converges and is bounded by a continuous function
of <span class="math inline">\(\sigma\)</span> (see <a href="#ref-MR1170566"
class="citation" data-cites="MR1170566">(Wallach 1992, vol. 132, sec.
10.1.2)</a>). In particular, <span
class="math display">\[\sup_{\sigma \in \mathcal{D}_0} \int_N
\phi_\sigma(w_0 n) \, d n &lt; \infty.\]</span> On the other hand, for
<span class="math inline">\(f \in \mathcal{I}(\chi)\)</span>, <span
class="math inline">\(s \in \mathfrak{a}_\mathbb{C}^*\)</span> and <span
class="math inline">\(n \in N\)</span>, we have <span
class="math display">\[|f_s(n)| \leqslant\|f\|_{L^\infty(K)}
\phi_{\Re(s)}(u).\]</span> Thus, recalling <a
href="#eq:wf-psi1-=whittaker-integral-simplified"
data-reference-type="eqref"
data-reference="eq:wf-psi1-=whittaker-integral-simplified">\((9.20)\)</a>,
we obtain <span class="math display">\[\Re(s) \in \mathcal{D}_0
    \,
    \implies
    \,
    |W[f_s,\psi](1)|
    \leqslant
    C_0
    \|f\|_{L^\infty(K)},\]</span> where <span
class="math inline">\(C_0\)</span> depends only upon <span
class="math inline">\(\mathcal{D}_0\)</span>. This completes the proof
of the “<span class="math inline">\(w = 1\)</span> case” of the
implication <a href="#eq:wfchi-psi1-leq-2" data-reference-type="eqref"
data-reference="eq:wfchi-psi1-leq-2">\((9.22)\)</a>.</p>
<p>For the general case, we appeal to the functional equation <a
href="#eq:wmathcalf_w-fchi-psi" data-reference-type="eqref"
data-reference="eq:wmathcalf_w-fchi-psi">\((2.27)\)</a>
(i.e., the defining property of <span
class="math inline">\(\mathcal{F}_{w^{-1}}\)</span>), which gives <span
class="math display">\[W[f_{w s}, \psi](1)
    =
    W[\mathcal{F}_{w^{-1}} f_{w s}, \psi](1).\]</span> We have <span
class="math inline">\(\mathcal{F}_{w^{-1}} f_{w s} \in
\mathcal{I}(s)\)</span>, so for <span class="math inline">\(\Re(s) \in
\mathcal{D}_0\)</span>, we have seen that <span
class="math display">\[|W[\mathcal{F}_{w^{-1}} f_{w s}, \psi](1)|
\leqslant C_0 \|\mathcal{F}_w^{-1} f_{w s}\|_{L^\infty(K)}.\]</span> Our
task thereby reduces to verifying that <span id="eq:res-w-in" class="math display">\[\label{eq:res-w-in}\tag{9.23}
    (\Re(s), w) \in \mathcal{D}_0 \times W \implies
\|\mathcal{F}_{w^{-1}} f_{w s}\|_{L^\infty(K)} \leqslant C_0 (1 +
|s|)^{\ell} \mu(f).\]</span> To that end, we write <span
class="math inline">\(\mathcal{F}_{w^{-1}} =
\mathcal{F}_{w^{-1}}[\chi_{w s}] : \mathcal{I}(\chi_{w s}) \rightarrow
\mathcal{I}((w^{-1} \chi)_{s})\)</span> as <span
class="math display">\[\mathcal{F}_{w^{-1}}[\chi_{w s}] =
c(w^{-1},\chi_{w s}) M_{w^{-1}}[\chi_{w s}],\]</span> as above.
Combining Lemmas <a
href="#lem:jacquet-integral-uniformity-question:let-chi-in"
data-reference-type="ref"
data-reference="lem:jacquet-integral-uniformity-question:let-chi-in">165</a>
and <a href="#lem:jacquet-integral-uniformity-question:let-chi-in-1"
data-reference-type="ref"
data-reference="lem:jacquet-integral-uniformity-question:let-chi-in-1">166</a>,
we see that there is</p>
<ul>
<li><p>a root polynomial <span class="math inline">\(p\)</span> on <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span>,</p></li>
<li><p><span class="math inline">\(C_0 \geqslant 0\)</span>,</p></li>
<li><p><span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant
0}\)</span> and</p></li>
<li><p>a seminorm <span class="math inline">\(\mu\)</span> on <span
class="math inline">\(C^\infty(K)\)</span></p></li>
</ul>
<p>so that <span id="eq:res-w-in-1" class="math display">\[\label{eq:res-w-in-1}\tag{9.24}
    (\Re(s), w) \in \mathcal{D}_0 \times W \implies \|p(s)
\mathcal{F}_{w^{-1}} f_{w s}\|_{L^\infty(K)} \leqslant C_0 (1 +
|s|)^{\ell} \mu(f).\]</span> This is nearly the required implication,
except for the factor <span class="math inline">\(p(s)\)</span>. To
address that, we note that the real part of <span
class="math inline">\(w^{-1}  (\chi_{w s})\)</span> is the real part of
<span class="math inline">\(s\)</span>, which is strictly dominant, so
by Lemma <a href="#lem:jacquet-integral-uniformity-question:let-w-in"
data-reference-type="ref"
data-reference="lem:jacquet-integral-uniformity-question:let-w-in">168</a>,
the operator <span class="math inline">\(\mathcal{F}_{w^{-1}}[\chi_{w
s}]\)</span> is holomorphic in the relevant range. We may thus pass from
<a href="#eq:res-w-in-1" data-reference-type="eqref"
data-reference="eq:res-w-in-1">\((9.24)\)</a> to <a
href="#eq:res-w-in" data-reference-type="eqref"
data-reference="eq:res-w-in">\((9.23)\)</a> via Cauchy’s integral
formula. ◻</p>
</div>
<div id="rmk:standard2:jacquet-analytic-refine" class="remark">
<p><strong>Remark 171</strong>. It would be natural to further quantify
Proposition <a
href="#prop:jacquet-integral-uniformity-question:let-eta-be"
data-reference-type="ref"
data-reference="prop:jacquet-integral-uniformity-question:let-eta-be">164</a>
by explicating the dependence upon <span
class="math inline">\(\chi\)</span>. This would require explicating the
analogous dependence for <a href="#ref-MR2402686" class="citation"
data-cites="MR2402686">(E. M. Lapid 2008, Cor 2)</a>, hence in turn
for <a href="#ref-MR1170566" class="citation" data-cites="MR1170566">(Wallach 1992, vol.
132, sec. 10.1.11)</a>.</p>
</div>
<h3 id="analysis-on-u-backslash-g-quantitative">Analysis on <span
class="math inline">\(U \backslash G\)</span>: quantitative</h3>
<h4 id="sec:analysis-U-G-quantitative-setup">§10.1. Setup</h4>
<p>We retain the setting of §<a href="#sec:some-analysis-basic"
data-reference-type="ref"
data-reference="sec:some-analysis-basic">4</a>. We assume now that the
group <span class="math inline">\(G\)</span> is fixed.</p>
<p>We fix a nondegenerate unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span>. Its pullback <span
class="math inline">\(\exp^* \psi\)</span> to the Lie algebra defines an
element of the Pontryagin dual <span
class="math inline">\(\mathop{\mathrm{Lie}}(N)^\wedge\)</span>. By
analogy to §<a href="#sec:parameter-theta" data-reference-type="ref"
data-reference="sec:parameter-theta">2.3.2</a>, we denote by <span
class="math inline">\(\theta_G(\psi) \in
\mathop{\mathrm{Lie}}(G)^\wedge\)</span> the element whose restriction
to <span class="math inline">\(\mathop{\mathrm{Lie}}(N)\)</span> is
<span class="math inline">\(\exp^*\psi\)</span> and whose restriction to
<span class="math inline">\(\mathop{\mathrm{Lie}}(Q)\)</span> is
trivial. Thus, with notation as in §<a href="#sec:pontry-dual-vect"
data-reference-type="ref"
data-reference="sec:pontry-dual-vect">1.1.1</a>, we have <span
class="math inline">\(\psi(\exp(x)) = \exp (\langle x,
\theta_G(\psi)  \rangle)\)</span> for <span class="math inline">\(x \in
\mathop{\mathrm{Lie}}(N)\)</span>, while <span
class="math inline">\(\langle x, \theta_G(\psi) \rangle = 0\)</span> for
<span class="math inline">\(x \in \mathop{\mathrm{Lie}}(Q)\)</span>.</p>
<p>Let <span class="math inline">\(T\)</span> be a positive parameter
with <span class="math inline">\(T \ggg 1\)</span>. We define the class
<span
class="math display">\[\mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2})\]</span>
as in §<a href="#sec:spec-group-sett" data-reference-type="ref"
data-reference="sec:spec-group-sett">1.4</a>. We recall (Proposition <a
href="#lem:standard:subcl-mathfr-theta" data-reference-type="ref"
data-reference="lem:standard:subcl-mathfr-theta">135</a>) that this
class is closed under taking adjoints and convolution.</p>
<h4 id="sec:class-mathfrakba">§10.2. The class <span
class="math inline">\(\mathfrak{B}(A)\)</span></h4>
<div class="definition">
<p><strong>Definition 172</strong>. We denote by <span
class="math inline">\(\mathfrak{B}(A)\)</span> the class of functions
<span class="math inline">\(\beta \in \mathcal{S}^e(A)\)</span> that lie
in some fixed bounded subset of <span
class="math inline">\(\mathcal{S}(A)\)</span>. We denote by <span
class="math inline">\(\mathfrak{B}(A)^W
\leqslant\mathfrak{B}(A)\)</span> the subclass consisting of <span
class="math inline">\(W\)</span>-invariant elements.</p>
</div>
<p>It is clear that if <span class="math inline">\(x \in
\mathfrak{U}(A)\)</span> is fixed and <span class="math inline">\(\beta
\in \mathfrak{B}(A)\)</span>, then <span class="math inline">\(L(x)
\beta \in \mathfrak{B}(A)\)</span>.</p>
<div id="lem:standard:each-beta-in" class="lemma">
<p><strong>Lemma 173</strong>. Each <span class="math inline">\(\beta
\in \mathfrak{B}(A)\)</span> may be decomposed as <span
class="math inline">\(\beta = \beta ^\sharp + \beta ^\flat\)</span>,
where <span class="math inline">\(\beta ^\sharp, \beta ^\flat \in
\mathfrak{B}(A)\)</span> have the following properties:</p>
<ol type="i">
<li><p><span class="math inline">\(\beta ^\sharp(a) \neq 0\)</span> only
if <span class="math inline">\(\|a\| \ll T^{o(1)}\)</span>.</p></li>
<li><p><span class="math inline">\(\beta ^\flat \in T^{-\infty}
\mathfrak{B}(A)\)</span>.</p></li>
</ol>
<p>The same conclusion holds with <span
class="math inline">\(\mathfrak{B}(A)\)</span> replaced by <span
class="math inline">\(\mathfrak{B}(A)^W\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We may and shall assume that the norm <span
class="math inline">\(\|.\|\)</span> on <span
class="math inline">\(A\)</span> is defined so as to be <span
class="math inline">\(W\)</span>-invariant.</p>
<p>Fix <span class="math inline">\(\phi \in
C_c^\infty(\mathbb{R})\)</span> taking the value <span
class="math inline">\(1\)</span> in a neighborhood of zero. For each
<span class="math inline">\(t \geqslant 1\)</span>, define <span
class="math inline">\(\beta_t \in C_c^\infty(A)\)</span> by <span
class="math inline">\(\beta_t(x) := \phi(\|x\|/t) \beta(x)\)</span>.
Then the family <span class="math inline">\(\{\beta_t\}_{t \geqslant
1}\)</span> defines a bounded subset of <span
class="math inline">\(\mathcal{S}(A)\)</span> (and of <span
class="math inline">\(\mathcal{S}(A)^W\)</span>, provided that <span
class="math inline">\(\beta \in \mathcal{S}(A)^W\)</span>), and so <span
class="math inline">\(\beta_t\)</span> lies in <span
class="math inline">\(\mathfrak{B}(A)\)</span> (resp. <span
class="math inline">\(\mathfrak{B}(A)^W\)</span>) for each <span
class="math inline">\(t \geqslant 1\)</span>.</p>
<p>We specialize to <span class="math inline">\(t = t(\varepsilon) :=
T^{\varepsilon}\)</span> with <span
class="math inline">\(\varepsilon&gt; 0\)</span>. Fix a countable
collection <span class="math inline">\(\{\kappa_j\}_{j \geqslant
1}\)</span> of defining seminorms for <span
class="math inline">\(\mathcal{S}(A)\)</span>. We claim that for each
fixed <span class="math inline">\(\varepsilon&gt; 0\)</span>, we have
<span class="math inline">\(\kappa_j(\beta - \beta_{t(\varepsilon)})
\leqslant\varepsilon T^{-1/\varepsilon}\)</span> for all <span
class="math inline">\(j \leqslant 1/\varepsilon\)</span>. Indeed, we
have <span class="math inline">\((\beta - \beta_{t(\varepsilon)})(x) =
\Phi_\varepsilon(x) \beta(x)\)</span> with <span
class="math inline">\(\Phi_\varepsilon(x) := (1 - \phi(\|x\| /
T^\varepsilon))\)</span>. The function <span
class="math inline">\(\Phi_\varepsilon\)</span>, together with each of
its fixed derivatives, has magnitude <span class="math inline">\(\ll
1\)</span> and is supported on elements <span
class="math inline">\(x\)</span> with <span class="math inline">\(\|x\|
\gg T^{\varepsilon}\)</span>. Since each fixed derivative <span
class="math inline">\(\beta &#39;\)</span> of <span
class="math inline">\(\beta\)</span> satisfies <span
class="math inline">\(\|x\|^m |\beta &#39;(x)| \ll 1\)</span> for all
fixed <span class="math inline">\(m \geqslant 0\)</span>, the claim
follows.</p>
<p>By the overspill principle applied to the claim, we may thus find
<span class="math inline">\(\varepsilon&gt; 0\)</span> with <span
class="math inline">\(\varepsilon\lll 1\)</span> so that <span
class="math inline">\(\kappa_j(\beta - \beta_{t(\varepsilon)}) \ll
T^{-\infty}\)</span> for each fixed <span
class="math inline">\(j\)</span>. The same then holds for each fixed
seminorm <span class="math inline">\(\kappa\)</span>. With this value of
<span class="math inline">\(\varepsilon\)</span>, we take <span
class="math inline">\(\beta ^\sharp := \beta_{t(\varepsilon)}\)</span>
and <span class="math inline">\(\beta ^\flat := \beta -
\beta_{t(\varepsilon)}\)</span>. Then <span class="math inline">\(\beta
^\flat \in T^{-\infty} \mathfrak{B}(A)\)</span>, while <span
class="math inline">\(\beta ^\sharp\)</span> has the required support
properties. ◻</p>
</div>
<h4 id="the-rescaled-character-psi_t">The rescaled character <span
class="math inline">\(\psi_T\)</span></h4>
<p>As in §<a href="#sec:class-bump-functions" data-reference-type="ref"
data-reference="sec:class-bump-functions">3.2</a>, we define the
rescaled nondegenerate unitary character <span
class="math inline">\(\psi_T\)</span> of <span
class="math inline">\(N\)</span> by requiring that for <span
class="math inline">\(x \in \mathop{\mathrm{Lie}}(N)\)</span>, we have
<span class="math inline">\(\psi_T(\exp(x)) = \psi(\exp(T x))\)</span>.
For future reference, we record how the change of character <span
class="math inline">\(\psi \rightsquigarrow \psi_T\)</span> affects
Jacquet integrals (§<a href="#sec:whittaker-functions-1"
data-reference-type="ref"
data-reference="sec:whittaker-functions-1">2.12</a>).</p>
<div id="lem:phi-in-mathcalis" class="lemma">
<p><strong>Lemma 174</strong>. For <span class="math inline">\(f \in
\mathcal{I}(s)\)</span>, we have <span class="math display">\[W[f,
\psi](T^{-\rho_U^\vee} g) = T^{\langle \rho_U, \rho_U^\vee  \rangle -
\rho_U^\vee(s)} W[f, \psi_T](g).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> By definition, the LHS is <span
class="math display">\[\int _{n \in N} f(n T^{-\rho_U^\vee} g)
\psi^{-1}(n) \,  d n.\]</span> Recall that <span
class="math inline">\(N\)</span> is opposite to <span
class="math inline">\(U\)</span>.</p>
<p>We apply the change of variables <span class="math inline">\(N \ni n
\mapsto T^{-\rho_U^\vee} n T^{\rho_U^\vee}\)</span>, with Jacobian <span
class="math inline">\(T^{2 \langle \rho_U,
\rho_U^\vee  \rangle}\)</span>, to transform the above integral to <span
class="math display">\[T^{2 \langle \rho_U, \rho_U^\vee  \rangle}
    \int _{n \in N} f(T^{-\rho_U^\vee} n g) \psi_T^{-1}(n) \,  d
n.\]</span> We conclude via the transformation property <span
class="math display">\[f(T^{-\rho_U^\vee} n g) =
    T ^{-\langle \rho_U + s,  \rho_U^\vee \rangle } f(n
g).\]</span> ◻</p>
</div>
<h4 id="the-class-mathfrakfu-backslash-g-t-psi">The class <span
class="math inline">\(\mathfrak{F}(U \backslash G, T,
\psi)\)</span></h4>
<div id="defn:standard2:we-denote-mathfrakfu" class="definition">
<p><strong>Definition 175</strong>. We denote by <span
class="math inline">\(\mathfrak{F}(U \backslash G, \psi, T)\)</span> the
class of functions <span class="math inline">\(U \backslash G
\rightarrow \mathbb{C}\)</span> of the form <span
class="math display">\[f =
    \mathcal{J}_T[\psi,\beta,\gamma]
    :=
    L(T ^{\rho _U ^\vee })
    \mathcal{J}[\psi_T,\beta,\gamma]
    =
    L(T ^{\rho _U ^\vee })
    R(\gamma)
    \mathcal{J}[\psi_T,\beta]\]</span> for some <span
class="math inline">\(\beta \in \mathfrak{B}(A)\)</span> and <span
class="math inline">\(\gamma \in
\mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2})\)</span>.</p>
</div>
<div id="rmk:we-discuss-informal-cal-F-U-G-T" class="remark">
<p><strong>Remark 176</strong>. We discuss the informal content of the
above definition.</p>
<ol type="i">
<li><p>As we will see below (see, e.g,. Proposition <a
href="#prop:standard:each-f-in" data-reference-type="ref"
data-reference="prop:standard:each-f-in">10.16</a>),
elements of <span class="math inline">\(\mathfrak{F}(U \backslash G,
\psi, T)\)</span> concentrate near the image of <span
class="math inline">\(T^{-\rho^\vee}\)</span> in <span
class="math inline">\(U \backslash G\)</span>. Informally speaking, they
are uniformly smooth under left translation by <span
class="math inline">\(A\)</span>, while under right translation by <span
class="math inline">\(G\)</span>, they are approximate eigenfunctions of
group elements of size <span class="math inline">\(1 +
\operatorname{O}(T^{-1/2})\)</span>, with eigenvalue described by <span
class="math inline">\(\theta_G(\psi)\)</span>.</p></li>
<li><p>The uniform smoothness under left translation by <span
class="math inline">\(A\)</span> implies that the Mellin components
<span class="math inline">\(f[s] \in \mathcal{I}(s)\)</span> are small
unless <span class="math inline">\(s\)</span> is small. Since <span
class="math inline">\(f\)</span> concentrates near <span
class="math inline">\(T^{-\rho^\vee}\)</span>, the components <span
class="math inline">\(f[s]\)</span> will have magnitude roughly <span
class="math inline">\(T^{- \langle \rho^\vee, s \rangle}\)</span> and
satisfy the same equivariance condition under small elements of <span
class="math inline">\(G\)</span> as <span
class="math inline">\(f\)</span>. The analogous condition for the <span
class="math inline">\(p\)</span>-adic analogue of our discussion turns
out to describe a one-dimensional subspace of <span
class="math inline">\(\mathcal{I}(s)\)</span> consisting of <em>Howe
vectors</em> (see <a href="#ref-MR2016587" class="citation" data-cites="MR2016587">(Baruch
2003b, sec. 5)</a>, <a href="#ref-MR2192818" class="citation"
data-cites="MR2192818">(Baruch 2005, sec. 7.1)</a>, <a href="#ref-MR3683106"
class="citation" data-cites="MR3683106">(Chai 2017, sec. 5)</a>). One
can thus understand the Mellin components <span
class="math inline">\(f[s]\)</span> as analogues, over <span
class="math inline">\(\mathbb{R}\)</span>, of Howe vectors.</p></li>
<li><p>The reader might wonder why we construct the class <span
class="math inline">\(\mathfrak{F}(U \backslash G, \psi, T)\)</span> in
terms of the distributions <span
class="math inline">\(\mathcal{J}[\psi,\beta]\)</span>, rather than in
some more direct way. The reason is that by doing so, we trivialize the
problem of computing the images of elements of <span
class="math inline">\(\mathfrak{F}(U \backslash G, \psi, T)\)</span>
under intertwining operators (see Lemma <a href="#lem:each-f-in"
data-reference-type="ref" data-reference="lem:each-f-in">180</a>), which
will be very convenient for our global study of the Eisenstein series
associated to such elements (Part <a href="#part:local-l2-growth"
data-reference-type="ref"
data-reference="part:local-l2-growth"></a>).</p></li>
<li><p>We record an approximate reference picture for what elements
<span class="math inline">\(f\)</span> of <span
class="math inline">\(\mathfrak{F}(U \backslash G, \psi, T)\)</span>
look like in the special case <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>. Taking for <span
class="math inline">\(U\)</span> the lower-triangular unipotent
subgroup, we can identify <span class="math inline">\(U \backslash
G\)</span> with <span class="math inline">\(\mathbb{R}^2 -
\{0\}\)</span> via the map taking a matrix to its top row. Under this
identification, it turns out that <span class="math display">\[f(x,y)
\approx
    T^{-1/2}
    1_{x \asymp T^{1/2}}
    1_{y \ll 1}
    \psi(T y/x)\]</span> for some fixed unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(\mathbb{R}\)</span>. Equivalently, in polar
coordinates, <span class="math display">\[f(r \cos \alpha, r \sin
\alpha) \approx
    T^{-1/2} 1_{r \asymp T^{1/2}}
    1 _{\alpha \ll T^{-1/2}} \psi(T \alpha).\]</span></p></li>
</ol>
</div>
<div id="lem:standard2:mathfr-backsl-g" class="lemma">
<p><strong>Lemma 177</strong>. We have <span
class="math inline">\(\mathfrak{F}(U \backslash G, \psi, T) \subseteq
\mathcal{S}(U \backslash G)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a special case of Proposition <a
href="#lem:sub-gln:each-psi-beta" data-reference-type="ref"
data-reference="lem:sub-gln:each-psi-beta">155</a>. ◻</p>
</div>
<div id="lem:cal-J-T-vs-cal-J" class="lemma">
<p><strong>Lemma 178</strong>. We have <span
class="math display">\[\mathcal{J}_T[\psi,\beta,\gamma]
=  \delta_U^{-1/2}(T^{\rho_U^\vee}) R(T^{-\rho_N^\vee})
\mathcal{J}[\psi,\beta, T^{\rho_N^\vee} \ast \gamma \ast T ^{-
\rho_N^\vee }].\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Set <span class="math inline">\(f :=
\mathcal{J}_T[\psi,\beta,\gamma] = R(\gamma) L(T ^{\rho_U^\vee })
\mathcal{J}[\psi_T,\beta]\)</span>. We have <span
class="math display">\[L(T^{\rho_U^\vee}) \mathcal{J}[\psi_T,\beta] =
\delta_U^{-1/2}(T^{\rho_U^\vee}) R(T^{-\rho_N^\vee})
\mathcal{J}[\psi,\beta].\]</span> Indeed, evaluating at <span
class="math inline">\(a n\)</span> for <span class="math inline">\((a,n)
\in A \times N\)</span> gives for the LHS <span
class="math display">\[\begin{align}
    L(T^{\rho_U^\vee}) \mathcal{J}[\psi_T,\beta](a n) &amp;=
    \delta_U^{-1/2}(T^{\rho_U^\vee})  \mathcal{J}[\psi_T,\beta](T^{\rho_U^\vee}
a n) \\
    &amp;=
    \delta_U^{1/2}(a) \beta(T^{\rho_U^\vee} a) \psi_T(n),
  
\end{align}\]</span> and for the RHS <span
class="math display">\[\begin{align}
        \delta_U^{-1/2}(T^{\rho_U^\vee})  R(T^{-\rho_N^\vee})
\mathcal{J}[\psi,\beta](a n)
    &amp;=
        \delta_U^{-1/2}(T^{\rho_U^\vee})  \mathcal{J}[{\psi,\beta}](a n
T^{-\rho_N^\vee}) \\
    &amp;=
          \delta_U^{-1/2}(T^{\rho_U^\vee})   \mathcal{J}[{\psi,\beta}](T^{\rho_U^\vee}
a (T^{\rho_N^\vee} n T^{-\rho_N^\vee})) \\
    &amp;=
    \delta_U^{1/2}(a) \beta(T^{\rho_U^\vee} a) \psi_T(n),
  
\end{align}\]</span> as claimed. (We have used here that <span
class="math inline">\(N\)</span> is opposite to <span
class="math inline">\(U\)</span>, so that <span
class="math inline">\(\rho_U^\vee = - \rho_N^\vee\)</span>.) Thus <span
class="math display">\[\begin{align}
    f &amp;=
         R(\gamma)     L(T^{\rho_U^\vee}) \mathcal{J}[\psi_T,\beta] \\
      &amp;= \delta_U^{-1/2}(T^{\rho_U^\vee}) R(\gamma)
R(T^{-\rho_N^\vee}) \mathcal{J}[\psi,\beta] \\
      &amp;= \delta_U^{-1/2}(T^{\rho_U^\vee}) R(T^{-\rho_N^\vee})
R(T^{\rho_N^\vee} \ast \gamma \ast T ^{- \rho_N^\vee })
\mathcal{J}[\psi,\beta] \\
      &amp;= \delta_U^{-1/2}(T^{\rho_U^\vee}) R(T^{-\rho_N^\vee})
\mathcal{J}[\psi,\beta,  T^{\rho_N^\vee} \ast \gamma \ast T ^{-
\rho_N^\vee }].
  
\end{align}\]</span> ◻</p>
</div>
<div id="lem:scratch-research:each-fixed-seminorm" class="lemma">
<p><strong>Lemma 179</strong>. For each fixed seminorm <span
class="math inline">\(\kappa\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> and each
<span class="math inline">\(f \in \mathfrak{F}(U \backslash G, \psi,
T)\)</span>, we have <span class="math inline">\(\kappa(f) \ll
T^{\operatorname{O}(1)}\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Write <span class="math inline">\(f =
\mathcal{J}_T[\psi,\beta,\gamma]\)</span>. By Lemma <a
href="#lem:cal-J-T-vs-cal-J" data-reference-type="ref"
data-reference="lem:cal-J-T-vs-cal-J">178</a>, we have <span
class="math display">\[f = \delta_U^{-1/2}(T^{\rho_U^\vee})
\mathcal{J}[\psi,\beta, \gamma \ast T^{-\rho_N^\vee}].\]</span> By
Proposition <a href="#lem:sub-gln:each-psi-beta"
data-reference-type="ref"
data-reference="lem:sub-gln:each-psi-beta">155</a>, there are fixed
seminorms <span class="math inline">\(\mu_1\)</span> on <span
class="math inline">\(\mathcal{S}(A)\)</span> and <span
class="math inline">\(\mu_2\)</span> on <span
class="math inline">\(\mathcal{S}(G)\)</span> so that <span
class="math display">\[\kappa(f)
\leqslant\delta_U^{-1/2}(T^{\rho_U^\vee}) \mu_1(\beta) \mu_2(\gamma \ast
T^{-\rho_N^\vee}).\]</span> Clearly <span
class="math inline">\(\delta_U^{-1/2}(T^{\rho_U^\vee}) =
T^{\operatorname{O}(1)}\)</span>. By the definition of <span
class="math inline">\(\mathfrak{B}(A) \ni \beta\)</span>, we have <span
class="math inline">\(\mu_1(\beta) \ll 1\)</span>. It remains to check
that <span class="math inline">\(\mu_2(\gamma \ast T^{-\rho_N^\vee}) \ll
T^{\operatorname{O}(1)}\)</span>. Indeed, it follows readily from the
definitions that</p>
<ul>
<li><p><span class="math inline">\(\mu(\gamma) \ll
T^{\operatorname{O}(1)}\)</span> for each fixed seminorm <span
class="math inline">\(\mu\)</span> on <span
class="math inline">\(\mathcal{S}(G)\)</span> and all <span
class="math inline">\(\gamma \in
\mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2})\)</span>, and
that</p></li>
<li><p>translation by <span
class="math inline">\(T^{-\rho_N^\vee}\)</span> at most polynomially
distorts seminorms on <span
class="math inline">\(\mathcal{S}(G)\)</span>.</p></li>
</ul>
<p> ◻</p>
</div>
<p>Lemma <a href="#lem:scratch-research:each-fixed-seminorm"
data-reference-type="ref"
data-reference="lem:scratch-research:each-fixed-seminorm">179</a>
implies that each <span class="math inline">\(f \in \mathfrak{F}(U
\backslash G, \psi, T)\)</span> is of rapid decay, but in a
quantitatively weak sense with respect to <span
class="math inline">\(T\)</span>. We will return to the issue of
quantitative decay shortly.</p>
<h4 id="equivariance-under-fourier-transforms-1">Equivariance under
Fourier transforms</h4>
<div id="lem:each-f-in" class="lemma">
<p><strong>Lemma 180</strong>. Let <span
class="math inline">\((\beta,\gamma) \in \mathfrak{B}(A) \times
\mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2})\)</span> and <span
class="math inline">\(w \in W\)</span>. Then <span
class="math display">\[\mathcal{F}_{w,\psi ^{-1} }
\mathcal{J}_T[\psi,\beta,\gamma]
    = \mathcal{J}_T[\psi,{}^w \beta, \gamma].\]</span> In particular, if
<span class="math inline">\(\beta \in \mathfrak{B}(A)^W\)</span>, then
<span class="math display">\[\mathcal{F}_{w,\psi ^{-1} }
\mathcal{J}_T[\psi,\beta,\gamma]
    = \mathcal{J}_T[\psi,\beta,\gamma]\]</span> for all <span
class="math inline">\(w \in W\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemma <a href="#lem:cal-J-T-vs-cal-J"
data-reference-type="ref" data-reference="lem:cal-J-T-vs-cal-J">178</a>
and the <span class="math inline">\(G\)</span>-equivariance of <span
class="math inline">\(\mathcal{F}_{w,\psi}\)</span>, it is enough to
check that <span class="math display">\[\mathcal{F}_{w,\psi ^{-1}}
\mathcal{J}[\psi,\beta, \gamma&#39; ]
    =
    \mathcal{J}[{\psi,{}^w \beta, \gamma&#39; }]\]</span> for all <span
class="math inline">\(\gamma &#39; \in \mathcal{S}(G)\)</span>, which
follows in turn from Lemma <a href="#lem:sub-gln:each-psi-beta-1"
data-reference-type="ref"
data-reference="lem:sub-gln:each-psi-beta-1">162</a>. ◻</p>
</div>
<h4 id="behavior-with-respect-to-differentiation">Behavior with respect
to differentiation</h4>
<div id="lem:standard:each-fixed-x" class="lemma">
<p><strong>Lemma 181</strong>. For each fixed <span
class="math inline">\(x \in \mathfrak{U}(A)\)</span> and each <span
class="math inline">\(f \in \mathfrak{F}(U \backslash G, \psi,
T)\)</span>, we have <span class="math inline">\(L(x) f \in
\mathfrak{F}(U \backslash G, \psi, T)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Write <span class="math inline">\(f =
\mathcal{J}_T[\psi,\beta,\gamma] = L(T^{\rho_U^\vee})
\mathcal{J}[\psi_T,\beta,\gamma]\)</span>. By <a
href="#eq:lx-mathcald_psi-beta" data-reference-type="eqref"
data-reference="eq:lx-mathcald_psi-beta">\((9.5)\)</a>
and the commutativity of <span class="math inline">\(A\)</span>, we have
<span class="math display">\[L(x) f = L(T^{\rho_U^\vee})
\mathcal{J}[\psi_T, L(x) \beta, \gamma] = \mathcal{J}_T[\psi,L(x)
\beta,\gamma].\]</span> Since <span class="math inline">\(L(x) \beta \in
\mathfrak{B}(A)\)</span>, it follows that <span
class="math inline">\(L(x) f \in \mathfrak{F}(U \backslash G, \psi,
T)\)</span>. ◻</p>
</div>
<div id="lem:standard:each-fixed-x-1" class="lemma">
<p><strong>Lemma 182</strong>. For each fixed <span
class="math inline">\(x \in \mathfrak{g}\)</span> and each <span
class="math inline">\(f \in \mathfrak{F}(U \backslash G, \psi,
T)\)</span>, we have <span class="math display">\[\frac{R(x) - \langle T
\theta_G(\psi)  , x  \rangle }{T^{1/2}} f \in \mathfrak{F}(U \backslash
G, \psi, T).\]</span> In particular, <span class="math inline">\(R(x) f
\in T \mathfrak{F}(U \backslash G, \psi, T)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Write <span class="math inline">\(f =
L(T^{\rho_U^\vee}) \mathcal{J}[\psi_T,\beta,\gamma]\)</span>. By <a
href="#eq:rx-mathcald_psi-beta" data-reference-type="eqref"
data-reference="eq:rx-mathcald_psi-beta">\((9.4)\)</a>,
we have <span class="math display">\[R(x) f = L(T^{\rho_U^\vee})
\mathcal{J}[\psi_T,\beta,x \ast \gamma],\]</span> so it is enough to
check that <span class="math display">\[x \ast \gamma -  \langle T
\theta_G(\psi), x \rangle \gamma
    \in T^{1/2} \mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2}),\]</span>
which is the content of Lemma <a
href="#lem:archimedean-vector-field-act-on-C" data-reference-type="ref"
data-reference="lem:archimedean-vector-field-act-on-C">130</a> applied
to <span class="math inline">\(x\)</span>, regarded as a right-invariant
vector field on <span class="math inline">\(G\)</span>. ◻</p>
</div>
<h4 id="quantitative-decay">Quantitative decay</h4>
<p>Lemma <a href="#lem:standard2:mathfr-backsl-g"
data-reference-type="ref"
data-reference="lem:standard2:mathfr-backsl-g">177</a> implies that each
element of <span class="math inline">\(\mathfrak{F}(U \backslash G,
\psi, T)\)</span> lies in <span class="math inline">\(\mathcal{S}(U
\backslash G)\)</span>, hence decays at infinity. However, it gives no
quantitative information concerning the dependence of that decay upon
<span class="math inline">\(T\)</span>. In this section, we show that
such elements concentrate near the image of <span
class="math inline">\(T^{-\rho_U^\vee}\)</span> in <span
class="math inline">\(U \backslash G\)</span>.</p>
<h5 id="sec:dist-funct-restr">§10.7.1. Distance functions and restriction
norms</h5>
<p>In what follows, we use the standard nontrivial additive character
<span class="math inline">\(\psi_F\)</span> of <span
class="math inline">\(F\)</span> to identify Pontryagin duals of vector
spaces over <span class="math inline">\(F\)</span> with linear
duals.</p>
<p>Recall the notation <span class="math inline">\(\psi\)</span> and
<span class="math inline">\(\theta_G(\psi)\)</span> from §<a
href="#sec:analysis-U-G-quantitative-setup" data-reference-type="ref"
data-reference="sec:analysis-U-G-quantitative-setup">5.1</a>.</p>
<p>We fix on the compact real manifold <span class="math inline">\(Q
\backslash G\)</span> a locally Euclidean metric. We denote by <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash
G}(x,y)\)</span> the associated distance between a pair of points <span
class="math inline">\(x, y \in Q \backslash G\)</span>. In particular,
<span class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(x,y)
\ll 1\)</span> for all <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span>. We use this notation also when <span
class="math inline">\(x\)</span> and/or <span
class="math inline">\(y\)</span> belongs to <span
class="math inline">\(G\)</span>, referring in that case to their images
in <span class="math inline">\(Q \backslash G\)</span>.</p>
<p>We fix a Euclidean norm <span class="math inline">\(|.|\)</span> on
<span class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>, hence a
dual norm <span class="math inline">\(|.|\)</span> on <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)^\wedge\)</span>. We
denote by <span class="math inline">\(\nu : Q \backslash G \rightarrow
\mathbb{R}_{\geqslant 0}\)</span> the function sending <span
class="math inline">\(Q g\)</span> to the norm of the restriction of
<span class="math inline">\(\theta\)</span> to the subspace <span
class="math inline">\(\mathop{\mathrm{Ad}}(g)^{-1}
\mathop{\mathrm{Lie}}(Q)\)</span>, i.e., <span
class="math display">\[\nu(g) := \sup_{0 \neq y \in
\mathop{\mathrm{Ad}}(g)^{-1} \mathop{\mathrm{Lie}}(Q)}
  \frac{|\langle \theta, y \rangle|}{ |y|}.\]</span> We may also think
of <span class="math inline">\(\nu\)</span> as a left-<span
class="math inline">\(Q\)</span>-invariant function on <span
class="math inline">\(G\)</span>.</p>
<p>The following estimate will play an important role in the
“integration by parts” arguments of §<a href="#sec:integration-parts"
data-reference-type="ref"
data-reference="sec:integration-parts">5.7.2</a>.</p>
<div id="lem:sub-gln:g-in-q" class="lemma">
<p><strong>Lemma 183</strong>. For <span class="math inline">\(g \in Q
\backslash G\)</span>, we have <span id="eq:dist_q-backslash-gg" class="math display">\[\label{eq:dist_q-backslash-gg}\tag{10.1}
    {\mathop{\mathrm{dist}}}_{Q \backslash G}(g, 1) \asymp
\nu(g).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Since <span class="math inline">\(\psi\)</span> is
fixed, we abbreviate <span class="math inline">\(\theta :=
\theta_G(\psi)\)</span> here.</p>
<p>We observe first that <span class="math inline">\(\nu(g) = 0\)</span>
only if <span class="math inline">\(g \in Q\)</span>. Indeed, if <span
class="math inline">\(\nu(g) = 0\)</span>, then <span
class="math inline">\(\theta\)</span> has trivial restriction to <span
class="math inline">\(\mathop{\mathrm{Ad}}(g)^{-1}
\mathop{\mathrm{Lie}}(Q)\)</span>, or equivalently, <span
class="math inline">\({\mathop{\mathrm{Ad}}}^*(g) \theta\)</span> has
trivial restriction to <span
class="math inline">\(\mathop{\mathrm{Lie}}(Q)\)</span>. Let us fix a
faithful representation of <span
class="math inline">\(\mathfrak{g}\)</span>. The corresponding trace
pairing then induces an equivariant identification of <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)^\wedge\)</span> with
<span class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>. With
respect to this identification, the orthogonal complement of <span
class="math inline">\(\mathop{\mathrm{Lie}}(Q)\)</span> is its maximal
nilpotent subalgebra <span
class="math inline">\(\mathop{\mathrm{Lie}}(U)\)</span>. Thus <span
class="math inline">\(\theta\)</span> and <span
class="math inline">\({\mathop{\mathrm{Ad}}}^*(g) \theta\)</span> both
identify with regular nilpotent elements of <span
class="math inline">\(\mathop{\mathrm{Lie}}(U)\)</span>. By Lemma <a
href="#lem:scratch-research:let-mathfrakb-be" data-reference-type="ref"
data-reference="lem:scratch-research:let-mathfrakb-be">10.14</a>
below, we deduce that <span class="math inline">\(g \in Q\)</span>, as
required.</p>
<p>The function <span class="math inline">\(\nu\)</span> is continuous,
vanishes only at the trivial coset, and is defined on the compact set
<span class="math inline">\(Q \backslash G\)</span>. It follows that for
each fixed neighborhood <span class="math inline">\(E\)</span> of the
trivial coset in <span class="math inline">\(Q \backslash G\)</span>, we
have <span class="math inline">\(\nu(g) \asymp 1\)</span> for all <span
class="math inline">\(g \notin E\)</span>. The claimed estimate <a
href="#eq:dist_q-backslash-gg" data-reference-type="eqref"
data-reference="eq:dist_q-backslash-gg">\((10.1)\)</a>
thus holds except possibly when <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(g,1) \lll
1\)</span>. It remains to address the latter case.</p>
<p>By the Bruhat decomposition, the natural map <span
class="math inline">\(N \rightarrow Q \backslash G\)</span> is an
injective immersion whose image contains an open neighborhood of the
identity coset. It will thus suffice to check that if <span
class="math inline">\(n \in N\)</span> with <span
class="math inline">\(n \simeq 1\)</span>, then <span
class="math inline">\({\mathop{\mathrm{dist}}}_{N}(n,1) \asymp
\nu(n)\)</span> (with <span
class="math inline">\({\mathop{\mathrm{dist}}}_N\)</span> some fixed
Euclidean distance, as in §<a href="#sec:distances"
data-reference-type="ref" data-reference="sec:distances">1.2.3</a>).</p>
<p>To that end, let <span class="math inline">\(\mu : N \rightarrow
\mathop{\mathrm{Lie}}(Q)^\wedge\)</span> denote the composition <span
class="math display">\[N \xrightarrow{n \mapsto
{\mathop{\mathrm{Ad}}}^*(n) \theta } \mathop{\mathrm{Lie}}(G)^\wedge
\xrightarrow{\text{restriction}}
\mathop{\mathrm{Lie}}(Q)^\wedge.\]</span> This map has the following
properties.</p>
<ol type="i">
<li><p><span class="math inline">\(\mu(1) = 0\)</span>. Indeed, <span
class="math inline">\(\theta|_{\mathop{\mathrm{Lie}}(Q)} =
0\)</span>.</p></li>
<li><p>For each fixed compact subset <span
class="math inline">\(\Omega\)</span> of <span
class="math inline">\(N\)</span>, we have <span
class="math inline">\(\nu(n) \asymp \mu(n)\)</span> for all <span
class="math inline">\(n \in \Omega\)</span>. Indeed, since <span
class="math inline">\(n\)</span> lies in a fixed compact set, the norm
of the restriction of <span class="math inline">\(\theta\)</span> to
<span class="math inline">\(\mathop{\mathrm{Ad}}(n)^{-1}
\mathop{\mathrm{Lie}}(Q)\)</span> is comparable to the norm of the
restriction of <span class="math inline">\({\mathop{\mathrm{Ad}}}^*(n)
\theta\)</span> to <span
class="math inline">\(\mathop{\mathrm{Lie}}(Q)\)</span>, i.e., to <span
class="math inline">\(|\mu(n)|\)</span>.</p></li>
</ol>
<p>It will thus suffice to show that if <span class="math inline">\(n
\in N\)</span> with <span class="math inline">\(n \simeq 1\)</span>,
then <span class="math inline">\({\mathop{\mathrm{dist}}}_N(n,1) \asymp
\mu(n)\)</span>.</p>
<p>To establish this last estimate, it suffices to verify that <span
class="math inline">\(\mu\)</span> is a local immersion at the identity,
i.e., that the derivative <span class="math inline">\(d \mu\)</span> of
<span class="math inline">\(\mu\)</span> at <span
class="math inline">\(1\)</span> is injective. That derivative is the
composition <span class="math display">\[\mathop{\mathrm{Lie}}(N)
\xrightarrow{x \mapsto [x,\theta]} \mathop{\mathrm{Lie}}(G)^\wedge
\xrightarrow{\text{restriction}}
\mathop{\mathrm{Lie}}(Q)^\wedge,\]</span> where we write <span
class="math inline">\([x,\theta] :=
{\mathop{\mathrm{ad}}}^*(x)\theta\)</span>. Its kernel consists of all
<span class="math inline">\(x \in \mathop{\mathrm{Lie}}(N)\)</span> for
which <span class="math inline">\(\langle [x,\theta], y \rangle =
0\)</span> for all <span class="math inline">\(y \in
\mathop{\mathrm{Lie}}(Q)\)</span>. Since <span
class="math inline">\(\langle [x,\theta], y \rangle = -\langle x,
[y,\theta] \rangle\)</span>, we have in fact <span
class="math display">\[\ker(d \mu) = \mathop{\mathrm{Lie}}(N) \cap
[\mathop{\mathrm{Lie}}(Q), \theta]^\perp.\]</span> Using the trace
pairing, we identify <span class="math inline">\(\theta\)</span> with an
element of <span
class="math inline">\(\mathop{\mathrm{Lie}}(U)\)</span>.</p>
<p>We claim that <span class="math inline">\([\mathop{\mathrm{Lie}}(Q),
\theta] = \mathop{\mathrm{Lie}}(U)\)</span>. Indeed, let <span
class="math inline">\(n\)</span> denote the rank of <span
class="math inline">\(G\)</span>. (Here we define “rank” and “dimension”
either over <span class="math inline">\(F\)</span> or <span
class="math inline">\(\mathbb{R}\)</span>; as long as we are consistent,
it does not matter which.) Since <span
class="math inline">\(\theta\)</span> is regular, its <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>-centralizer is
<span class="math inline">\(n\)</span>-dimensional; since <span
class="math inline">\([\mathop{\mathrm{Lie}}(Q), \theta] \subseteq
\mathop{\mathrm{Lie}}(U)\)</span> and <span
class="math inline">\([\mathop{\mathrm{Lie}}(Q):\mathop{\mathrm{Lie}}(U)]
= n\)</span>, the claim follows.</p>
<p>The trace pairing induces a perfect pairing between <span
class="math inline">\(\mathop{\mathrm{Lie}}(N)\)</span> and <span
class="math inline">\(\mathop{\mathrm{Lie}}(U)\)</span>, so the claim
implies that <span class="math display">\[\mathop{\mathrm{Lie}}(N) \cap
[\mathop{\mathrm{Lie}}(Q), \theta]^\perp = \mathop{\mathrm{Lie}}(N) \cap
\mathop{\mathrm{Lie}}(U)^\perp\]</span> is trivial, hence that <span
class="math inline">\(d \mu\)</span> is injective, as required. ◻</p>
</div>
<p>We record below some linear algebraic facts that were needed above.
We first recall <a href="#ref-MR0114875" class="citation" data-cites="MR0114875">(Kostant
1959, Cor 5.6)</a>:</p>
<div id="lem:kostant-regular-nilpotent" class="lemma">
<p><strong>Lemma 184</strong>. Let <span
class="math inline">\(x\)</span> be a nilpotent element of a complex
semisimple Lie algebra <span
class="math inline">\(\mathfrak{g}\)</span>. Then <span
class="math inline">\(x\)</span> is regular if and only if it is
contained in exactly one maximal nilpotent subalgebra.</p>
</div>
<p>As a consequence, we deduce:</p>
<div id="itm:scratch-research:lemma-general-linear-remedial"
class="lemma">
<p><strong>Lemma 185</strong>. <span
id="lem:scratch-research:let-mathfrakb-be"
label="lem:scratch-research:let-mathfrakb-be"></span> Let <span
class="math inline">\(G\)</span> be a quasi-split real reductive group,
with Lie algebra <span class="math inline">\(\mathfrak{g}\)</span>.</p>
<ol type="i">
<li><p>Let <span class="math inline">\(x\)</span> be a regular nilpotent
element of <span class="math inline">\(\mathfrak{g}\)</span>. Then <span
class="math inline">\(x\)</span> is contained in at most one Borel
subalgebra of <span
class="math inline">\(\mathfrak{g}\)</span>.</p></li>
<li><p>Let <span class="math inline">\(B\)</span> be a Borel subgroup of
<span class="math inline">\(G\)</span>, with corresponding Borel
subalgebra <span class="math inline">\(\mathfrak{b}\)</span> of <span
class="math inline">\(\mathfrak{g}\)</span>. Let <span
class="math inline">\(x\)</span> be a regular nilpotent of <span
class="math inline">\(\mathfrak{g}\)</span> that is contained in <span
class="math inline">\(\mathfrak{b}\)</span>. Let <span
class="math inline">\(g \in G\)</span> be such that <span
class="math inline">\(\mathop{\mathrm{Ad}}(g) x \in
\mathfrak{b}\)</span>. Then <span class="math inline">\(g \in
B\)</span>.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> (i): It suffices to prove this after passing to the
semisimple part of <span class="math inline">\(\mathfrak{g}\)</span> and
extending scalars to <span class="math inline">\(\mathbb{C}\)</span>,
after which we can apply Lemma <a href="#lem:kostant-regular-nilpotent"
data-reference-type="ref"
data-reference="lem:kostant-regular-nilpotent">184</a>. (We remark that
for the cases <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n\)</span> of primary interest, the required
conclusion is an easy exercise with Jordan form.)</p>
<p>(ii): Our hypotheses imply that <span
class="math inline">\(\mathop{\mathrm{Ad}}(g)^{-1} \mathfrak{b}\)</span>
and <span class="math inline">\(\mathfrak{b}\)</span> are both Borel
subalgebras containing <span class="math inline">\(x\)</span>, so by
part (i), we have <span
class="math inline">\(\mathop{\mathrm{Ad}}(g)^{-1} \mathfrak{b} =
\mathfrak{b}\)</span>. Thus <span class="math inline">\(g\)</span>
normalizes the connected group <span class="math inline">\(B\)</span>,
which forces <span class="math inline">\(g \in B\)</span> <a href="#ref-MR1102012"
class="citation" data-cites="MR1102012">(Borel 1991, Thm
11.16)</a>. ◻</p>
</div>
<h5 id="sec:integration-parts">§10.7.2. Integration by parts</h5>
<div id="lem:scratch-research:let-h-in" class="lemma">
<p><strong>Lemma 186</strong>. Let <span class="math inline">\(f \in
\mathfrak{F}(U \backslash G, \psi, T)\)</span>. If <span
class="math inline">\(h \in U \backslash G\)</span> satisfies <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(h,1) \gg
T^{-1/2+\varepsilon}\)</span> for some fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>, then for each fixed
<span class="math inline">\(x \in \mathfrak{U}(A)\)</span> and <span
class="math inline">\(y \in \mathfrak{U}(G)\)</span>, <span
class="math display">\[L(x) R(y) f(h) \ll
    \|h\|_{U \backslash G}^{-\infty}
    T^{-\infty}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Using Lemmas <a href="#lem:standard:each-fixed-x"
data-reference-type="ref"
data-reference="lem:standard:each-fixed-x">181</a> and <a
href="#lem:standard:each-fixed-x-1" data-reference-type="ref"
data-reference="lem:standard:each-fixed-x-1">182</a>, we may and shall
reduce to the case <span class="math inline">\((x,y) = (1,1)\)</span>.
Our task is then to show that for each fixed <span
class="math inline">\(m \geqslant 0\)</span> and each <span
class="math inline">\(f \in \mathfrak{F}(U \backslash G, \psi,
T)\)</span>, we have <span id="eq:fg-ll-g_u" class="math display">\[\label{eq:fg-ll-g_u}\tag{10.2}
    f(h) \ll \|h\|_{U \backslash G}^{-m} T^{-m}.\]</span></p>
<p>By Lemma <a href="#lem:scratch-research:each-fixed-seminorm"
data-reference-type="ref"
data-reference="lem:scratch-research:each-fixed-seminorm">179</a>
applied to <span class="math inline">\(\kappa(f) := \sup_{g \in U
\backslash G} \|g\|_{U \backslash G}^{m+1} |f(g)|\)</span>, we have
<span id="eq:fg-ll-g_u-1" class="math display">\[\label{eq:fg-ll-g_u-1}\tag{10.3}
    f(h) \ll \|h\|_{U \backslash G}^{-m - 1} T^{C_m}\]</span> for some
fixed <span class="math inline">\(C_m \geqslant 0\)</span>.</p>
<p>If <span class="math inline">\(\|h\|_{U \backslash G} \geqslant T^{m
+ C_m}\)</span>, then <a href="#eq:fg-ll-g_u-1"
data-reference-type="eqref"
data-reference="eq:fg-ll-g_u-1">\((10.3)\)</a> implies <a
href="#eq:fg-ll-g_u" data-reference-type="eqref"
data-reference="eq:fg-ll-g_u">\((10.2)\)</a>. We focus henceforth on
the remaining range <span class="math inline">\(\|h\|_{U \backslash G}
&lt; T^{m + C_m}\)</span>. We then have <span
class="math inline">\(T^{-m(m+ C_m) - m} \leqslant\|h\|_{U \backslash
G}^{-m} T^{-m}\)</span>, so it will suffice to show the following:</p>
<ul>
<li><p>for each fixed <span class="math inline">\(\varepsilon&gt;
0\)</span>, <span class="math inline">\(C \geqslant 0\)</span> and <span
class="math inline">\(m \in \mathbb{Z}\)</span>, we have <span
class="math inline">\(f(h) \ll T^{-m}\)</span> whenever <span
class="math inline">\(\|h\|_{U \backslash G} &lt; T^{C}\)</span> and
<span class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(h,1)
\gg T^{-1/2+\varepsilon}\)</span>.</p></li>
</ul>
<p>Write <span class="math inline">\(f =
\mathcal{J}_T[\psi,\beta,\gamma] = L(T^{\rho_U^\vee})
\mathcal{J}[\psi_T, \beta, \gamma]\)</span> with <span
class="math inline">\((\beta,\gamma) \in \mathfrak{B}(A)
\times  \mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2})\)</span>. By
definition, <span class="math display">\[\delta_U^{1/2}(T^{\rho_U^\vee})
    f(h)
    =
    \int _{g \in G}
    \gamma(g)
    \phi_{h,\beta}(g),
    \quad
    \phi_{h,\beta}(g) :=
    \mathcal{J}[\psi_T, \beta](T^{\rho_U^\vee} h g) \, d g.\]</span> Let
us henceforth fix <span class="math inline">\(C \geqslant 0\)</span> and
<span class="math inline">\(\varepsilon&gt; 0\)</span>. It will then
suffice to show that for each fixed <span class="math inline">\(m \in
\mathbb{Z}_{\geqslant 0}\)</span>, the following assertion <span
class="math inline">\(S(m)\)</span> holds:</p>
<ul>
<li><p>for all <span class="math inline">\(\beta \in
\mathfrak{B}(A)\)</span>, <span class="math inline">\(\gamma \in
\mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2})\)</span> and <span
class="math inline">\(h \in G\)</span> (or <span class="math inline">\(h
\in U \backslash G\)</span>) with <span class="math inline">\(\|h\|_{U
\backslash G} &lt; T^C\)</span> and <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(h,1) \gg
T^{-1/2+\varepsilon}\)</span>, we have <span class="math display">\[\int
_{g \in G} \gamma(g) \phi_{h,\beta}(g) \ll T^{-m
\varepsilon}\]</span></p></li>
</ul>
<p>We will do so by induction on <span class="math inline">\(m\)</span>.
The idea is that integration by parts will save one factor of <span
class="math inline">\(T^{-\varepsilon}\)</span> per inductive step. The
base case <span class="math inline">\(m = 0\)</span> follows from Lemma
<a href="#lem:standard:each-gamma-in" data-reference-type="ref"
data-reference="lem:standard:each-gamma-in">121</a> and <a
href="#eq:mathc-beta_-leq" data-reference-type="eqref"
data-reference="eq:mathc-beta_-leq">\((9.1)\)</a>, which give
<span class="math inline">\(\|\gamma \|_1 \ll 1\)</span> and <span
class="math inline">\(\|\phi_{h,\beta}\|_{\infty} \ll 1\)</span>. Our
task is thus to verify the inductive step: fixing <span
class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span> and
assuming <span class="math inline">\(S(m)\)</span>, we will deduce <span
class="math inline">\(S(m+1)\)</span>.</p>
<p>Retain the hypotheses of <span class="math inline">\(S(m+1)\)</span>.
By Lemma <a href="#lem:sub-gln:g-in-q" data-reference-type="ref"
data-reference="lem:sub-gln:g-in-q">183</a>, we have <span
class="math inline">\(\nu(h) \gg T^{-1/2+\varepsilon}\)</span>. By the
definition of <span class="math inline">\(\nu\)</span>, we may thus find
<span class="math display">\[y \in \mathop{\mathrm{Ad}}(h)^{-1}
\mathop{\mathrm{Lie}}(Q) \subseteq \mathop{\mathrm{Lie}}(G),\]</span>
with <span class="math inline">\(y \ll T^{-1/2}\)</span>, so that <span
class="math inline">\(\langle T \theta_G(\psi), y \rangle \gg
T^{\varepsilon}\)</span>. We integrate by parts with respect to the
right-invariant vector field <span class="math inline">\(Y\)</span> on
<span class="math inline">\(G\)</span> corresponding to <span
class="math inline">\(y\)</span>, namely <span
class="math inline">\(Y(g) := \partial_{t=0} \exp(t y) g\)</span>. This
gives <span class="math display">\[\int_{g \in G} Y \gamma(g) \phi_{h,
\beta } (g)
    +
    \int_{g \in G} \gamma(g) Y \phi_{h, \beta } (g) = 0.\]</span> By
Proposition <a href="#lem:archimedean-vector-field-act-on-C-2"
data-reference-type="ref"
data-reference="lem:archimedean-vector-field-act-on-C-2">133</a>, we
have <span class="math display">\[Y \gamma = -\langle T \theta_G(\psi),
y \rangle \gamma + \gamma_0\]</span> for some <span
class="math inline">\(\gamma_0 \in
\mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2})\)</span>. Thus <span id="eq:langle-t-theta-1" class="math display">\[\label{eq:langle-t-theta-1}\tag{10.4}
    \langle T \theta_G(\psi) , y \rangle \int _{g \in G} \gamma(g)
\phi_{h,\beta}(g)
    =
    \int _{g \in G} \gamma_0(g) \phi_{h,\beta}(g) + \int _{g \in G}
\gamma(g) Y \phi_{h,\beta}(g).\]</span> Since <span
class="math inline">\(\langle T \theta_G(\psi), y \rangle \gg
T^{\varepsilon}\)</span>, our task reduces to verifying that each term
on the RHS of <a href="#eq:langle-t-theta-1" data-reference-type="eqref"
data-reference="eq:langle-t-theta-1">\((10.4)\)</a> is <span
class="math inline">\(\ll T^{-m \varepsilon}\)</span>. For the first
term, the required bound is the content of our inductive hypothesis
<span class="math inline">\(S(m)\)</span>, applied with <span
class="math inline">\(\gamma_0\)</span> in place of <span
class="math inline">\(\gamma\)</span>. It thus remains only to show that
<span id="eq:int-_g-in-1-9" class="math display">\[\label{eq:int-_g-in-1-9}\tag{10.5}
    \int _{g \in G} \gamma(g) Y \phi_{h,\beta}(g) \ll T^{-m
\varepsilon}.\]</span> To that end, we write <span
class="math display">\[y = \mathop{\mathrm{Ad}}(h)^{-1} x,\]</span> with
<span class="math inline">\(x \in \mathop{\mathrm{Lie}}(Q)\)</span>, and
decompose <span class="math display">\[x = x_U + x_A, \quad
    (x_U, x_A) \in \mathop{\mathrm{Lie}}(U)  \times
\mathop{\mathrm{Lie}}(A).\]</span> Then <span
class="math display">\[\begin{align}
    Y \phi_{h,\beta}(g)
    &amp;= \partial_{t=0} \mathcal{J}[\psi_T,\beta](T^{\rho_U^\vee} h
\exp(t y) g) \\
    &amp;=
      \partial_{t=0} \mathcal{J}[\psi_T, \beta](T^{\rho_U^\vee} \exp(t
x) h g)
    \\
    &amp;=
      \partial_{t=0} \mathcal{J}[\psi_T, \beta](\exp(t x_A)
T^{\rho_U^\vee} h g)
    \\
    &amp;=
      \mathcal{J}[\psi_T, L(x_A) \beta](T^{\rho_U^\vee} h g),
  
\end{align}\]</span> where</p>
<ul>
<li><p>in the third step, we have used that <span
class="math inline">\(\mathcal{J}[\psi_T,\beta]\)</span> is left-<span
class="math inline">\(U\)</span>-invariant (and that <span
class="math inline">\(A\)</span> is commutative), and</p></li>
<li><p>in the fourth step, we have appealed to <a
href="#eq:lx-mathcalj_psi-beta" data-reference-type="eqref"
data-reference="eq:lx-mathcalj_psi-beta">\((9.2)\)</a>.</p></li>
</ul>
<p>We claim that <span class="math inline">\(x_A \ll T^{-1/2}\)</span>.
To see this, it is equivalent to show that each coefficient of the
characteristic polynomial of <span class="math inline">\(T^{1/2}
x_A\)</span> (with respect to the given linear embedding of <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>) is <span
class="math inline">\(\operatorname{O}(1)\)</span>. The characteristic
polynomials of the elements <span class="math inline">\(x_A, x\)</span>
and <span class="math inline">\(y\)</span> are all the same, so the
conclusion follows from the fact that <span class="math inline">\(y \ll
T^{-1/2}\)</span>. In particular, <span class="math inline">\(L(x_A)
\beta = T^{-1/2} \beta_0\)</span> for some <span
class="math inline">\(\beta_0 \in \mathfrak{B}(A)\)</span>, and so by
our inductive hypothesis <span class="math inline">\(S(m)\)</span>,
<span class="math display">\[\int _{g \in G} Y \phi_{h,\beta}(g) =
    T^{-1/2}
    \int _{g \in G} \phi_{h,\beta_0}(g) \ll T^{-1/2 - m
\varepsilon}.\]</span> We thereby deduce the required estimate <a
href="#eq:int-_g-in-1-9" data-reference-type="eqref"
data-reference="eq:int-_g-in-1-9">\((10.5)\)</a> (in stronger
form). ◻</p>
</div>
<h5 id="decomposition-into-essential-and-negligible-parts">Decomposition
into essential and negligible parts</h5>
<div id="itm:standard:prop-decompose-frakF-4" class="proposition">
<p><strong>Proposition 187</strong>. <em><span
id="prop:standard:each-f-in" label="prop:standard:each-f-in"></span>
Each <span class="math inline">\(f \in \mathfrak{F}(U \backslash G,
\psi, T)\)</span> may be decomposed as <span class="math inline">\(f =
f^\sharp + f^\flat\)</span>, where <span class="math inline">\(f
^\sharp, f^{\flat} \in \mathcal{S}(U \backslash G)\)</span> have the
following properties:</em></p>
<ol type="i">
<li><p><em>For <span class="math inline">\(g \in G\)</span>, we have
<span class="math inline">\(f ^\sharp (g) \neq 0\)</span> only if <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(g,1) \ll
T^{-1/2 + o(1)}\)</span>. More precisely, for <span
class="math inline">\((a,n) \in A \times N\)</span>, we have <span
class="math display">\[f ^\sharp (T^{-\rho _U^\vee} a n) \neq 0 \implies
\|a\| \ll T^{o(1)}, \quad n = 1 +
\operatorname{O}(T^{-1/2+o(1)}).\]</span></em></p></li>
<li><p><em><span class="math inline">\(\|f ^\sharp \|_{\infty} \ll
\delta_U^{1/2}(T^{-\rho_U^\vee})\)</span>.</em></p></li>
<li><p><em><span class="math inline">\(\kappa(f^{\flat}) \ll
T^{-\infty}\)</span> for each fixed seminorm <span
class="math inline">\(\kappa\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash
G)\)</span>.</em></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> Write <span class="math inline">\(f = L(T ^{\rho _U
^\vee }) \mathcal{J}[\psi_T, \beta, \gamma]\)</span>, as usual. We first
decompose <span class="math inline">\(\beta = \beta ^\sharp + \beta
^\flat\)</span> according to Lemma <a href="#lem:standard:each-beta-in"
data-reference-type="ref"
data-reference="lem:standard:each-beta-in">173</a>. By combining the
conclusion of that lemma with the <em>a priori</em> bounds of Lemma <a
href="#lem:scratch-research:each-fixed-seminorm"
data-reference-type="ref"
data-reference="lem:scratch-research:each-fixed-seminorm">179</a>, we
see that <span class="math display">\[\kappa(L(T^{\rho_U^\vee})
\mathcal{J}[\psi_T,\beta^\flat,\gamma]) \ll T^{-\infty}\]</span> for
each fixed seminorm <span class="math inline">\(\kappa\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span>. The
contribution of <span class="math inline">\(\beta^{\flat}\)</span> may
thus be absorbed into the term <span
class="math inline">\(f^{\flat}\)</span> that we will produce below, and
so we may assume that <span class="math inline">\(\beta =
\beta^\sharp\)</span>. In particular, we have reduced to the case that
<span class="math inline">\(\beta(a) \neq 0\)</span> only if <span
class="math inline">\(\|a\| \ll T^{o(1)}\)</span>.</p>
<p>Fix <span class="math inline">\(\phi \in
C_c^\infty(\mathbb{R})\)</span> taking the value <span
class="math inline">\(1\)</span> in a neighborhood of zero. For small
<span class="math inline">\(t &gt; 0\)</span>, define <span
class="math inline">\(f_t : U \backslash G \rightarrow
\mathbb{C}\)</span> by <span class="math display">\[f_t(g) :=
    f(g) \phi ({\mathop{\mathrm{dist}}}_{Q \backslash G}(g,1) /
t).\]</span> Then <span class="math inline">\(f_t\)</span> is smooth. We
specialize to <span class="math inline">\(t = t(\varepsilon) :=
T^{-1/2+\varepsilon}\)</span>. If <span class="math inline">\(n \in
N\)</span> satisfies <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(n,1) \gg
t(\varepsilon)\)</span> for some fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>, then <span
class="math display">\[{\mathop{\mathrm{dist}}}_{Q \backslash G}(a n,1) =
{\mathop{\mathrm{dist}}}_{Q \backslash G}(n, 1) \gg
T^{-1/2+\varepsilon}\]</span> for all <span class="math inline">\(a \in
A\)</span>, so Lemma <a href="#lem:scratch-research:let-h-in"
data-reference-type="ref"
data-reference="lem:scratch-research:let-h-in">186</a> gives strong
bounds for <span class="math inline">\(f\)</span> and its derivatives at
<span class="math inline">\(a n\)</span>. Fixing a defining countable
collection <span class="math inline">\(\{\kappa_j\}_j\)</span> of
seminorms on <span class="math inline">\(\mathcal{S}(U \backslash
G)\)</span>, we deduce that for each fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>, we have <span
class="math inline">\(\kappa_j(f - f_t) \leqslant
T^{-1/\varepsilon}\)</span> for each <span class="math inline">\(j
\leqslant 1/\varepsilon\)</span>. By overspill, we may thus find <span
class="math inline">\(\varepsilon&gt; 0\)</span> with <span
class="math inline">\(\varepsilon\lll 1\)</span> so that for each fixed
seminorm <span class="math inline">\(\kappa\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span>, we have
<span class="math inline">\(\kappa(f - f_t) \ll T^{-\infty}\)</span>.
With this value of <span class="math inline">\(\varepsilon\)</span>, we
take <span class="math inline">\(f^{\sharp} := f_t\)</span> and <span
class="math inline">\(f ^\flat := f - f_t\)</span>. We verify each of
the required assertions in turn:</p>
<ol type="i">
<li><p>The first claimed support property of <span
class="math inline">\(f ^\sharp\)</span> follows immediately from its
construction and the compact support of <span
class="math inline">\(\phi\)</span>. For the second assertion, note
that, by construction, for <span class="math inline">\((a,n) \in A
\times N\)</span>, <span id="eq:f-sharp-t" class="math display">\[\label{eq:f-sharp-t}\tag{10.6}
      f ^\sharp (T^{-\rho_U^\vee} a n) = f( T^{-\rho_U^\vee} a n)
\phi\left(\frac{{\mathop{\mathrm{dist}}}_{Q \backslash G}(n,1) }{
T^{-1/2+\varepsilon}}\right).\]</span> Since the natural map <span
class="math inline">\(N \rightarrow Q \backslash G\)</span> is an
injective immersion (at the identity), we have <span
class="math display">\[{\mathop{\mathrm{dist}}}_{Q \backslash G} (n,1) \ll
T^{-1/2+\varepsilon} \implies \|n - 1\| \ll T^{-1/2 +
\varepsilon}.\]</span> Thus the fixed compact support of <span
class="math inline">\(\phi\)</span> forces <span class="math inline">\(f
^\sharp (T ^{- \rho _U ^\vee } a n )\)</span> to vanish unless <span
class="math inline">\(n = 1 +
\operatorname{O}(T^{-1/2+\varepsilon})\)</span>.</p>
<p>It remains to constrain the support of <span class="math inline">\(f
^\sharp (T ^{- \rho _U ^\vee } a n)\)</span> with respect to the
variable <span class="math inline">\(a\)</span>.</p>
<p>For this, we introduce some notation. For <span
class="math inline">\(g \in G\)</span> (or <span class="math inline">\(g
\in U \backslash G\)</span>), define <span class="math inline">\(g_A :=
a\)</span> if <span class="math inline">\(g = u a n\)</span> with <span
class="math inline">\((u,a,n) \in U \times A \times N\)</span>;
otherwise, leave <span class="math inline">\(g_A\)</span> undefined and
formally set <span class="math inline">\(\|g_A\| := +\infty\)</span>.
Our task is then to show that <span id="eq:f-t-" class="math display">\[\label{eq:f-t-}\tag{10.7}
      f ^\sharp (T ^{- \rho _U ^\vee } h) \neq 0
      \implies
      \|h_A\| \ll T^{o(1)}.\]</span> The support condition that we
imposed on <span class="math inline">\(\beta\)</span> implies that <span id="eq:mathc-betag-neq" class="math display">\[\label{eq:mathc-betag-neq}\tag{10.8}
      \mathcal{J}[\psi_T,\beta](g) \neq 0 \implies \|g_A\| \ll
T^{o(1)}.\]</span></p>
<p>We observe that if <span class="math inline">\((a,g) \in A \times
G\)</span> with <span class="math inline">\(g = 1 + o(1)\)</span>, then
<span class="math inline">\((a g)_A\)</span> is defined and satisfies
<span id="eq:mathfraka-a-g" class="math display">\[\label{eq:mathfraka-a-g}\tag{10.9}
      a^{-1} (a g)_A = 1 + o(1)\]</span> To see this, we use that the
multiplication map <span class="math inline">\(U \times A \times N
\rightarrow G\)</span> is an injective immersion with open image to
write <span class="math inline">\(g = u b n\)</span> with <span
class="math inline">\((u,b,n) \in U \times A \times N\)</span>. Then,
since <span class="math inline">\(A\)</span> normalizes <span
class="math inline">\(U\)</span> and <span
class="math inline">\(N\)</span>, we have <span class="math inline">\((a
g)_A = a b\)</span>, hence <span class="math inline">\(a^{-1} (a g)_A =
b = 1 + o(1)\)</span>.</p>
<p>We observe next that, for <span class="math inline">\(h \in U
\backslash G\)</span>, <span class="math display">\[\begin{align}
      f(h)
      &amp;= L(T^{\rho_U^\vee}) R(\gamma) \mathcal{J}[\psi_T,\beta](h)
      \\
      &amp;=
        R(\gamma) L(T^{\rho_U^\vee})  \mathcal{J}[\psi_T,\beta](h)
      \\
      &amp;=
        \delta_U^{-1/2}(T^{\rho_U^\vee})
        \int _{g \in G}  \mathcal{J}[\psi_T,\beta]( T^{\rho_U^\vee} h g)
\gamma(g),
    
\end{align}\]</span> hence <span id="eq:f-t--1" class="math display">\[\label{eq:f-t--1}\tag{10.10}
      f (T ^{- \rho _U ^\vee } h)
      =
      \delta_U^{-1/2}(T^{\rho_U^\vee})
      \int _{g \in G}
      \mathcal{J}[\psi_T,\beta](h g) \gamma(g).\]</span> Suppose now
that <span class="math inline">\(f^\sharp(T^{-\rho_U^\vee} h) \neq
0\)</span>. In particular, <span
class="math inline">\(f(T^{-\rho_U^\vee} h) \neq 0\)</span>. We saw
above that then <span class="math inline">\(h = a n\)</span> with <span
class="math inline">\((a,n) \in A \times N\)</span> and <span
class="math inline">\(n = 1 + \operatorname{O}(T^{-1/2+o(1)})\)</span>,
hence in particular <span class="math inline">\(n = 1 + o(1)\)</span>.
We see also from <a href="#eq:f-t--1" data-reference-type="eqref"
data-reference="eq:f-t--1">\((10.10)\)</a> that for some <span
class="math inline">\(g\)</span> in the support of <span
class="math inline">\(\gamma\)</span>, we have <span
class="math inline">\(\mathcal{J}[\psi_T,\beta](h g) \neq 0\)</span>. By
<a href="#eq:mathc-betag-neq" data-reference-type="eqref"
data-reference="eq:mathc-betag-neq">\((10.8)\)</a>, it follows
that <span id="eq:mathfrakah-g-ll" class="math display">\[\label{eq:mathfrakah-g-ll}\tag{10.11}
      \|(h g)_A\| \ll T^{o(1)}.\]</span> Recall that, by the definition
of <span
class="math inline">\(\mathfrak{C}(G,-\theta_G(\psi),T,1/2)\)</span>
(Definition <a href="#defn:standard:let-v-be" data-reference-type="ref"
data-reference="defn:standard:let-v-be">112</a>, <a
href="#eq:mathfrakcg-theta-t" data-reference-type="eqref"
data-reference="eq:mathfrakcg-theta-t">\((6.24)\)</a>), we
have for each such <span class="math inline">\(g\)</span> that <span
class="math inline">\(g = 1 + \operatorname{O}(T^{-1/2}) = 1 +
o(1)\)</span>, hence <span class="math inline">\(n g = 1 +
o(1)\)</span>. By <a href="#eq:mathfraka-a-g"
data-reference-type="eqref"
data-reference="eq:mathfraka-a-g">\((10.9)\)</a> and the
identity <span class="math inline">\(h g = a n g\)</span>, it follows
that <span class="math inline">\(a^{-1} (h g)_A = 1 + o(1)\)</span>. By
<a href="#eq:mathfrakah-g-ll" data-reference-type="eqref"
data-reference="eq:mathfrakah-g-ll">\((10.11)\)</a>, we obtain
<span class="math inline">\(\|a\| \ll T^{o(1)}\)</span>. This completes
the proof of the required estimate <a href="#eq:f-t-"
data-reference-type="eqref"
data-reference="eq:f-t-">\((10.7)\)</a>.</p></li>
<li><p>Since <span class="math inline">\(\phi\)</span> is fixed, we have
<span class="math inline">\(\|\phi \|_\infty \ll 1\)</span>, hence <span
class="math inline">\(\|f ^\sharp \| _\infty \ll \|f\| _\infty\)</span>.
We recall that <span class="math inline">\(f =  R(\gamma) L(T ^{\rho _U
^\vee }) \mathcal{J}[\psi_T, \beta]\)</span>, hence <span
class="math display">\[\|f\|_\infty \leqslant\|\gamma\|_1 \|L(T ^{\rho
_U ^\vee }) \mathcal{J}[\psi_T, \beta]\|_{\infty}.\]</span> By Lemma <a
href="#lem:standard:each-gamma-in" data-reference-type="ref"
data-reference="lem:standard:each-gamma-in">121</a>, we have <span
class="math inline">\(\|\gamma \|_1 \ll 1\)</span>. For <span
class="math inline">\((a,n) \in A \times N\)</span>, we have <span
class="math display">\[L(T^{\rho_U^\vee}) \mathcal{J}[\psi_T,\beta](a n)
      =
      \delta_U^{-1/2}(T^{\rho_U^\vee})  \delta_U^{1/2}(T^{\rho_U^\vee}
a) \beta(T^{\rho_U^\vee} a) \psi_T(n).\]</span> Since <span
class="math inline">\(\|\delta_U^{1/2} \beta \|_{\infty} \ll 1\)</span>,
it follows that <span class="math display">\[\|L(T^{\rho_U^\vee})
\mathcal{J}[\psi_T,\beta]\|_{\infty} \ll
\delta_U^{-1/2}(T^{\rho_U^\vee}).\]</span> The required bound for <span
class="math inline">\(\|f\|_\infty\)</span> follows.</p></li>
<li><p>Set <span class="math inline">\(\Phi(g) := \phi
\left({\mathop{\mathrm{dist}}}_{Q \backslash G}(g,1) /
T^{-1/2+\varepsilon} \right)\)</span>, so that <span
class="math inline">\(f ^\flat = (1 - \Phi) f\)</span>. For each fixed
<span class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span> and
<span class="math inline">\(y \in \mathfrak{U}(G)\)</span>, we have
<span id="eq:sup_g-in-u" class="math display">\[\label{eq:sup_g-in-u}\tag{10.12}
      \sup_{g \in U \backslash G} \|g\|_{U \backslash G}^m
\left\lvert  R(y) (1 - \Phi)(g) \right\rvert
      \ll T^{\operatorname{O}(1)}.\]</span> On the other hand, for each
<span class="math inline">\(g\)</span> in the support of <span
class="math inline">\(1 - \Phi\)</span>, we have <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(g,1) \gg
T^{-1/2+\varepsilon}\)</span>, hence by Lemma <a
href="#lem:scratch-research:let-h-in" data-reference-type="ref"
data-reference="lem:scratch-research:let-h-in">186</a>, <span id="eq:g_u-backslash-gm" class="math display">\[\label{eq:g_u-backslash-gm}\tag{10.13}
      \|g\|_{U \backslash G}^m \left\lvert  R(y) f (g) \right\rvert
      \ll T^{-\infty }.\]</span> Combining the estimates <a
href="#eq:sup_g-in-u" data-reference-type="eqref"
data-reference="eq:sup_g-in-u">\((10.12)\)</a> and <a
href="#eq:g_u-backslash-gm" data-reference-type="eqref"
data-reference="eq:g_u-backslash-gm">\((10.13)\)</a> using the
product rule for differentiation, we deduce that <span
class="math inline">\(\kappa(f ^\flat ) \ll T^{-\infty}\)</span> for
each fixed seminorm <span class="math inline">\(\kappa\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span>, as
required.</p></li>
</ol>
<p> ◻</p>
</div>
<h4 id="l2-estimates"><span
class="math inline">\(L^2\)</span>-estimates</h4>
<div class="lemma">
<p><strong>Lemma 188</strong>. For <span class="math inline">\(f \in
\mathfrak{F}(U \backslash G, \psi, T)\)</span>, we have <span
class="math inline">\(\int _{U \backslash G} |f|^2 \ll T^{-\dim(N)/2 +
o(1)}\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We decompose <span class="math inline">\(f = f
^\sharp + f ^\flat\)</span> as in Proposition <a
href="#prop:standard:each-f-in" data-reference-type="ref"
data-reference="prop:standard:each-f-in">10.16</a>.
Writing <span class="math inline">\(\|.\|_2\)</span> for the <span
class="math inline">\(L^2\)</span>-norm on <span class="math inline">\(U
\backslash G\)</span>, the triangle inequality gives <span
class="math inline">\(\|f\|_2 \leqslant\|f ^\sharp \|_2 + \|f ^\flat
\|_2\)</span>. The conclusion of the cited proposition gives <span
class="math inline">\(\|f ^\flat \|_2 \ll T^{-\infty}\)</span>. By our
Haar measure convention <a href="#eq:int-_g-in-U-bakslash-G"
data-reference-type="eqref"
data-reference="eq:int-_g-in-U-bakslash-G">\((2.4)\)</a>,
we have <span class="math display">\[\|f ^\sharp \|_2^2
    =
    \int _{a \in A}
    \int _{n \in N}
    |f ^\sharp|^2 (a n) \, \frac{d a }{ \delta_U(a)} \, d n.\]</span>
The change of variables <span class="math inline">\(a \mapsto
T^{-\rho_U^\vee} a\)</span> gives <span class="math display">\[\|f
^\sharp \|_2^2
    =
    \delta_U(T^{\rho_U^\vee})
    \int _{a \in A}
    \int _{n \in N}
    |f ^\sharp|^2 (T^{-\rho_U^\vee} a n) \, \frac{d a }{ \delta_U(a)} \,
d n.\]</span> By construction, <span class="math inline">\(f ^\sharp (T
^{- \rho _U ^\vee } a n ) \neq 0\)</span> only if <span
class="math inline">\(\|a\| \ll T^{o(1)}\)</span> and <span
class="math inline">\(n = 1 + \operatorname{O}(T^{-1/2+o(1)})\)</span>.
For such <span class="math inline">\(a\)</span>, we have <span
class="math inline">\(\delta_U(a) = T^{o(1)}\)</span>. On the other
hand, <span class="math inline">\(\|f ^\sharp \|  _\infty \ll
\delta_U(T^{\rho_U^\vee})^{-1/2}\)</span>. This size and support
estimates yield the required bound. ◻</p>
</div>
<h4 id="basic-mellin-component-bounds">Basic Mellin component
bounds</h4>
<div id="lem:standard:each-comp-mathc" class="lemma">
<p><strong>Lemma 189</strong>. For each compact <span
class="math inline">\(\mathcal{D} \subseteq \mathfrak{a}^*\)</span>,
<span class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span> and
seminorm <span class="math inline">\(\kappa_0\)</span> on <span
class="math inline">\(C^\infty(K)\)</span>, there is a seminorm <span
class="math inline">\(\kappa\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> so that for
all <span class="math inline">\(f \in \mathcal{S}(U \backslash
G)\)</span> and all <span class="math inline">\(\chi \in
\mathfrak{X}^e(A)\)</span> with <span class="math inline">\(\Re(\chi)
\in \mathcal{D}\)</span>, we have <span
class="math display">\[\kappa_0(f[\chi]) \leqslant\kappa(f)
C(\chi)^{-m}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We may find <span class="math inline">\(x \in
\mathfrak{U}(A)\)</span> so that <span class="math inline">\(L(x)
f[\chi] = c f[\chi]\)</span> with <span class="math inline">\(|c|
\geqslant C(\chi)^{m}\)</span>. Since <span class="math inline">\(L(x) :
\mathcal{S}(U \backslash G) \rightarrow \mathcal{S}(U \backslash
G)\)</span> is continuous, we may reduce to the case <span
class="math inline">\(m = 0\)</span>.</p>
<p>We may assume that <span class="math inline">\(\kappa_0(v) = \|R(y)
v\|_{L^\infty(K)}\)</span> for some <span class="math inline">\(y \in
\mathfrak{U}(K)\)</span>, so that <span
class="math display">\[\kappa_0(f[\chi]) =
    \sup _{k \in K}
    \left\lvert
      \int _{a \in A}
      \delta_U^{1/2}(a) \chi(a)
      R(y) f(a^{-1} k)
      \, \frac{d a}{\delta_U(a)}
    \right\rvert.\]</span></p>
<p>We may find <span class="math inline">\(\ell \geqslant 0\)</span> so
that <span class="math display">\[C_0 := \sup_{
    \substack{
      \chi \in \mathfrak{X}^e(A) :  \\
       \Re(\chi) \in \mathcal{D}
    }
  }
  \int_{a \in A} \|a\|^{-\ell} \delta_U^{1/2}(a) |\chi(a)|  \, \frac{d
a}{\delta_U(a)} &lt; \infty.\]</span> We may find <span
class="math inline">\(C_1 \geqslant 0\)</span> so that <span
class="math inline">\(\|a k\|_{U \backslash G}^{\ell} \leqslant C_1
\|a\|^{\ell}\)</span> for all <span class="math inline">\((a,k) \in A
\times K\)</span>. The conclusion then holds with <span
class="math display">\[\kappa(f) := C_0 C_1 \sup_{g \in N \backslash G}
\|g\|_{U \backslash G}^{\ell} |R(y) f(g)|.\]</span> ◻</p>
</div>
<div id="lem:standard:let-chi-in" class="lemma">
<p><strong>Lemma 190</strong>. Let <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span> with <span class="math inline">\(\Re(\chi) \ll
1\)</span>. Let <span class="math inline">\(f \in \mathfrak{F}(U
\backslash G, \psi, T)\)</span>. Let <span class="math inline">\(k \in
K\)</span>. Then <span class="math display">\[f[\chi](k) \ll T^{-\infty}
C(\chi)^{-\infty}\]</span> unless <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(k,1) \ll
T^{-1/2+o(1)}\)</span>, in which case <span
class="math display">\[f[\chi](k) \ll T^{\langle \rho_U^\vee , \Re(\chi)
\rangle + o(1)} C(\chi)^{-\infty}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> First, for each fixed <span class="math inline">\(m
\in \mathbb{Z}_{\geqslant 0}\)</span>, we may find a fixed element <span
class="math inline">\(x \in \mathfrak{U}(A)\)</span> so that <span
class="math inline">\(d \chi(x) \gg C(\chi)^m\)</span>, hence <span
class="math display">\[f[\chi](k) \ll C(\chi)^{-m} L(x)
f[\chi](k).\]</span> By Lemma <a href="#lem:standard:each-fixed-x"
data-reference-type="ref"
data-reference="lem:standard:each-fixed-x">181</a>, we may thus reduce
to verifying the ostensibly weaker estimates obtained by omitting the
“factor” <span class="math inline">\(C(\chi)^{-\infty}\)</span>. Next,
write <span class="math inline">\(f = f ^\sharp + f ^\flat\)</span> as
in Proposition <a href="#prop:standard:each-f-in"
data-reference-type="ref"
data-reference="prop:standard:each-f-in">10.16</a>.
Using Lemma <a href="#lem:standard:each-comp-mathc"
data-reference-type="ref"
data-reference="lem:standard:each-comp-mathc">189</a>, we see that <span
class="math inline">\(f ^\flat\)</span> satisfies the required
conclusions (in stronger form). It remains to treat the contribution of
<span class="math inline">\(f ^\sharp\)</span>. To that end, we change
variables in the definition to see that <span
class="math display">\[f^\sharp[\chi](k) = \delta_U^{1/2} \chi  (T
^{\rho _U ^\vee}) \int _{a \in A} \delta_U^{1/2} \chi(a) f^\sharp(T ^{-
\rho _U ^\vee } a^{-1} k) \, d a.\]</span> By construction, we have
<span class="math inline">\(f ^\sharp  (T ^{- \rho _U ^\vee } a^{-1} k)
\neq 0\)</span> only if <span
class="math inline">\({\mathop{\mathrm{dist}}}_{Q \backslash G}(k,1) \ll
T^{-1/2 + o(1)}\)</span>. In that case, we may write <span
class="math inline">\(k = u b n\)</span> with <span
class="math inline">\((u,b,n) \in U \times A \times N\)</span>, <span
class="math inline">\(\|b\| \ll T^{o(1)}\)</span> and <span
class="math inline">\(n = 1 + \operatorname{O}(T^{-1/2+o(1)})\)</span>.
Then <span class="math display">\[f ^\sharp (T ^{- \rho _U ^\vee } a
^{-1} k)
    =
    f ^\sharp (T ^{- \rho _U ^\vee } a ^{-1} b n).\]</span> This
vanishes unless <span class="math inline">\(\|a^{-1} b \| \ll
T^{o(1)}\)</span>, in which case <span class="math inline">\(\|a\| \ll
T^{o(1)}\)</span>. Since <span class="math inline">\(\Re(\chi) \ll
1\)</span> and <span class="math inline">\(\|f ^\sharp \| _\infty \ll
\delta_U^{-1/2}(T^{\rho_U^\vee}) T^{o(1)}\)</span>, we obtain <span id="eq:f-sharp-chik" class="math display">\[\label{eq:f-sharp-chik}\tag{10.14}
    f ^\sharp [\chi](k) \ll \chi (T ^{\rho_U^\vee })
    T^{o(1)}
    \ll
    T ^{\langle \rho _U ^\vee , \Re(\chi) \rangle + o(1)},\]</span> as
required. ◻</p>
</div>
<div id="lem:scratch-research:let-f-in" class="lemma">
<p><strong>Lemma 191</strong>. Let <span class="math inline">\(f \in
\mathfrak{F}(U \backslash G, \psi, T)\)</span>. Let <span
class="math inline">\(\chi \in \mathfrak{X}(A)\)</span> with <span
class="math inline">\(\Re(\chi) \ll 1\)</span>. Then for fixed <span
class="math inline">\(x \in \mathfrak{U}(A)\)</span>, <span
class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span> and <span
class="math inline">\(y_1,\dotsc,y_m \in
\mathop{\mathrm{Lie}}(G)\)</span>, <span class="math display">\[\int_K
\left\lvert L(x) R(y) f[\chi] \right\rvert^2 \ll T^{2 \langle
\rho_U^\vee, \Re(\chi) \rangle -\dim(N)/2 + 2 m + o(1)}
C(\chi)^{-\infty}.\]</span> In particular, <span id="eq:int_k-fchi2-ll" class="math display">\[\label{eq:int_k-fchi2-ll}\tag{10.15}
    \int_K \left\lvert f[\chi] \right\rvert^2 \ll T^{2 \langle
\rho_U^\vee, \Re(\chi) \rangle -\dim(N)/2 + o(1)}
C(\chi)^{-\infty}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Using Lemmas <a href="#lem:standard:each-fixed-x"
data-reference-type="ref"
data-reference="lem:standard:each-fixed-x">181</a> and <a
href="#lem:standard:each-fixed-x-1" data-reference-type="ref"
data-reference="lem:standard:each-fixed-x-1">182</a>, we may reduce to
the case <span class="math inline">\(x = 1\)</span>, <span
class="math inline">\(m = 0\)</span>. We then apply Lemma <a
href="#lem:standard:let-chi-in" data-reference-type="ref"
data-reference="lem:standard:let-chi-in">190</a> and integrate over
<span class="math inline">\(K\)</span>, noting that for small <span
class="math inline">\(\varepsilon&gt; 0\)</span>, <span
class="math display">\[\mathop{\mathrm{vol}}\{k \in K :
{\mathop{\mathrm{dist}}}_{Q \backslash G}(k,1) \leqslant\varepsilon\}
\asymp \varepsilon^{\dim(N)}.\]</span> ◻</p>
</div>
<h4 id="whittaker-function-upper-bounds">Whittaker function upper
bounds</h4>
<div id="lem:standard:each-comp-mathc-1" class="lemma">
<p><strong>Lemma 192</strong>. For each compact <span
class="math inline">\(\mathcal{D} \subseteq \mathfrak{a}^*\)</span> and
<span class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span>,
there is a seminorm <span class="math inline">\(\kappa\)</span> on <span
class="math inline">\(\mathcal{S}(U \backslash G)\)</span> so that for
all <span class="math inline">\(f \in \mathcal{S}(U \backslash
G)\)</span> and all unramified <span class="math inline">\(\chi \in
\mathfrak{X}(A)\)</span> with <span class="math inline">\(\Re(\chi) \in
\mathcal{D}\)</span>, we have <span class="math display">\[|W[f[\chi],
\psi](1)| \leqslant\kappa(f) C(\chi)^{-m}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We combine Proposition <a
href="#prop:jacquet-integral-uniformity-question:let-eta-be"
data-reference-type="ref"
data-reference="prop:jacquet-integral-uniformity-question:let-eta-be">164</a>
and Lemma <a href="#lem:standard:each-comp-mathc"
data-reference-type="ref"
data-reference="lem:standard:each-comp-mathc">189</a>. ◻</p>
</div>
<div id="lem:all-f-in" class="proposition">
<p><strong>Proposition 193</strong>. <em>For all <span
class="math inline">\(f \in \mathfrak{F}(U \backslash G, \psi,
T)\)</span>, all <span class="math inline">\(g \in Q\)</span> with <span
class="math inline">\(g = 1 + o(T^{-1/2})\)</span>, and all <span
class="math inline">\(\chi \in \mathfrak{X}(A)\)</span> with <span
class="math inline">\(\Re(\chi) \ll 1\)</span>, we have <span id="eq:wfchi-psi_tg-ll" class="math display">\[\label{eq:wfchi-psi_tg-ll}\tag{10.16}
  W[f[\chi], \psi_T](g)
  \ll T^{\langle \rho_U^\vee, \Re(\chi) \rangle - \dim(N)/2 + o(1)}
C(\chi)^{-\infty}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Replacing <span class="math inline">\(f\)</span> by
<span class="math inline">\(L(x) f\)</span> for suitable <span
class="math inline">\(x \in \mathfrak{U}(A)\)</span> as in the proof of
Lemma <a href="#lem:standard:let-chi-in" data-reference-type="ref"
data-reference="lem:standard:let-chi-in">190</a>, we reduce to showing
the same estimate, but without the “factor” <span
class="math inline">\(C(\chi)^{-\infty}\)</span>. Write <span
class="math inline">\(f = \mathcal{J}_T[\psi, \beta, \gamma]\)</span>.
By <a href="#eq:rgamm-mathc-beta" data-reference-type="eqref"
data-reference="eq:rgamm-mathc-beta">\((9.3)\)</a>, we have
<span class="math inline">\(R(g) f = \mathcal{J}_T[\psi,\beta, g \ast
\gamma]\)</span>. By Proposition <a href="#lem:sub-gln:let-gamma-in"
data-reference-type="ref"
data-reference="lem:sub-gln:let-gamma-in">134</a> and our assumption
<span class="math inline">\(g = 1 + o(T^{-1/2})\)</span>, we have <span
class="math display">\[g \ast \gamma \in
\mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2}),\]</span> hence likewise
<span class="math display">\[R(g) f \in \mathfrak{F}(U \backslash G,
\psi, T).\]</span> We may thus reduce further to the case <span
class="math inline">\(g = 1\)</span>. Our task is then to show that
<span class="math display">\[W[f[\chi], \psi_T](1)
  \ll T^{\langle \rho_U^\vee, \Re(\chi) \rangle - \dim(N)/2 +
o(1)}.\]</span> To that end, we write <span class="math inline">\(f = f
^\sharp + f ^\flat\)</span> as in Proposition <a
href="#prop:standard:each-f-in" data-reference-type="ref"
data-reference="prop:standard:each-f-in">10.16</a>.
By Lemma <a href="#lem:standard:each-comp-mathc-1"
data-reference-type="ref"
data-reference="lem:standard:each-comp-mathc-1">192</a>, we see that
<span class="math inline">\(f ^\flat\)</span> gives an acceptable
contribution. It remains to estimate <span class="math inline">\(W [f
^\sharp [\chi ], \psi _T ] (1)\)</span>. Using the support condition on
<span class="math inline">\(f ^\sharp\)</span> stated in Proposition <a
href="#prop:standard:each-f-in" data-reference-type="ref"
data-reference="prop:standard:each-f-in">10.16</a>,
we see that <span class="math inline">\(f ^\sharp [\chi ]|_{N}\)</span>
is supported on <span class="math inline">\(1 +
\operatorname{O}(T^{-1/2+o(1)})\)</span>. In particular, <span
class="math inline">\(f ^\sharp [\chi ]|_{N}\)</span> has compact
support, so the Jacquet integral for <span class="math inline">\(W [f
^\sharp [\chi ], \psi _T ] (1)\)</span> converges absolutely for all
<span class="math inline">\(\chi\)</span>, without need for analytic
continuation. Thus <span class="math display">\[|W[f ^\sharp
[\chi],\psi_T](1)|
    =
    \left\lvert
      \int_N f ^\sharp [\chi](n) \psi_T^{-1}(n) \, d n
    \right\rvert
    \leqslant
    \int _{N} |f ^\sharp [\chi](n)| \, d n.\]</span> By the proof of
Lemma <a href="#lem:standard:let-chi-in" data-reference-type="ref"
data-reference="lem:standard:let-chi-in">190</a> (namely, <a
href="#eq:f-sharp-chik" data-reference-type="eqref"
data-reference="eq:f-sharp-chik">\((10.14)\)</a>), we see moreover
that <span class="math display">\[f ^\sharp [\chi](n) \ll  T^{\langle
\rho_U^\vee , \Re(\chi) \rangle + o(1)} C(\chi)^{-\infty}.\]</span>
Combining this pointwise upper bound with the noted support condition
yields the required estimate <a href="#eq:wfchi-psi_tg-ll"
data-reference-type="eqref"
data-reference="eq:wfchi-psi_tg-ll">\((10.16)\)</a> for <span
class="math inline">\(W[f ^\sharp [\chi],\psi_T](1)\)</span>. ◻</p>
</div>
<h4 id="sec:whitt-funct-lower">§10.11. Whittaker function lower bounds</h4>
<div class="notation">
<p><strong>Notation 194</strong>. The following notation is active only
for §<a href="#sec:whitt-funct-lower" data-reference-type="ref"
data-reference="sec:whitt-funct-lower">5.11</a> (note that it differs
from that employed in the proof of Proposition <a
href="#prop:standard:each-f-in" data-reference-type="ref"
data-reference="prop:standard:each-f-in">10.16</a>).
Let <span class="math inline">\(g \in G\)</span> (or <span
class="math inline">\(U \backslash G\)</span>). If <span
class="math inline">\(g\)</span> is of the form <span
class="math inline">\(u a n\)</span> for some <span
class="math inline">\((u,a,n) \in U \times A \times N\)</span>, then we
define <span class="math display">\[g_A := a,
    \quad
    g_N := n.\]</span> Otherwise, we leave <span
class="math inline">\(g_A\)</span> and <span
class="math inline">\(g_N\)</span> undefined.</p>
</div>
<div class="lemma">
<p><strong>Lemma 195</strong>. Let <span class="math inline">\(T \ggg
1\)</span>. Fix <span class="math inline">\(\phi \in
C_c^\infty(\mathfrak{g})\)</span> with <span class="math inline">\(\int
\phi \neq 0\)</span>. Let <span class="math inline">\(t &gt; 0\)</span>
with <span class="math inline">\(t \lll T^{-1/2}\)</span>. Introduce the
temporary notation: for <span class="math inline">\(n \in N\)</span>,
<span class="math display">\[I(n) :=
    \int _{x \in \mathfrak{g}}
    \phi(x) \delta_U^{1/2}((n \exp(t x))_A)
    \psi_T ( (n \exp(t x))_N)
    \exp (- \langle T \theta_G(\psi), t x \rangle) \, d x.\]</span> Then
<span class="math display">\[\int _{n \in N}
    \left\lvert
      I(n)
    \right\rvert^2
    \, d n
    \gg T^{-\dim(N)/2}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> It will suffice to show that <span
class="math inline">\(I(n) \gg 1\)</span> whenever <span
class="math inline">\(n = 1 + \operatorname{O}(T^{-1/2})\)</span>. For
such <span class="math inline">\(n\)</span>, we may write <span
class="math inline">\(n = \exp(y)\)</span> with <span
class="math inline">\(y \in \mathop{\mathrm{Lie}}(N)\)</span>. Using
Baker–Campbell–Hausdorff, we see that for <span class="math inline">\(x
\in \mathop{\mathrm{supp}}(\phi)\)</span>, <span
class="math display">\[(n \exp(tx))_N = \exp(y + t x_N +
\operatorname{O}(T^{-1/2} t)),\]</span> where <span
class="math inline">\(x_N \in \mathop{\mathrm{Lie}}(N)\)</span> denotes
the component of <span class="math inline">\(x\)</span> with respect to
the decomposition <span class="math inline">\(\mathop{\mathrm{Lie}}(G) =
\mathop{\mathrm{Lie}}(N) \oplus \mathop{\mathrm{Lie}}(Q)\)</span>. Since
<span class="math inline">\(T^{1/2} t \lll 1\)</span>, it follows that
<span class="math display">\[\psi_T((n \exp(t x))_N) = \psi_T(n) \exp
(\langle T \theta_G(\psi), t x \rangle) + o(1).\]</span> We derive
similarly that <span class="math display">\[\delta_U^{1/2}((n \exp(t
x))_A) = 1 + o(T^{-1/2} t) = 1 + o(T^{-1}) = 1 + o(1).\]</span> Thus the
integrand in the definition of <span class="math inline">\(I(n)\)</span>
is <span class="math inline">\(\psi_T(n) \phi(x) + o(|\phi(x)|)\)</span>
on its support. Integrating over <span class="math inline">\(x\)</span>,
we obtain <span class="math display">\[I(n) = \psi_T(n) \int
_{\mathfrak{g} } \phi(x) \, d x + o( \int _{x \in \mathfrak{g} }
|\phi(x)| \, d x)
  \asymp 1.\]</span> ◻</p>
</div>
<div id="cor:sub-gln:there-exists-fixed" class="corollary">
<p><strong>Corollary 196</strong>. <em>There exists a fixed <span
class="math inline">\(\phi \in C_c^\infty(\mathfrak{g})\)</span> with
the following property. Set <span class="math display">\[\begin{align}
    &amp;I(n) \\
    &amp;:=
      \int _{x \in \mathfrak{g}}
      \phi(x) \delta_U^{1/2} \left( (n
\exp(\tfrac{x}{T^{1/2}}))_A  \right)
      \psi_T ( (n \exp(\tfrac{x}{T^{1/2}}))_N )
      \exp (- \langle T \theta_G(\psi), \tfrac{x}{T^{1/2}} \rangle) \, d
x.
  
\end{align}\]</span> Then <span class="math display">\[\int _{n \in N}
    \left\lvert
      I(n)
    \right\rvert^2
    \, d n
    \gg T^{-\dim(N)/2}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Call the LHS of the desired estimate <span
class="math inline">\(I(\phi)\)</span>. Fix <span
class="math inline">\(\phi_1 \in C_c^\infty(\mathfrak{g})\)</span> with
<span class="math inline">\(\int \phi_1 \neq 0\)</span>. For <span
class="math inline">\(\varepsilon&gt; 0\)</span>, set <span
class="math inline">\(\phi_\varepsilon(x) :=
\varepsilon^{-\dim(\mathfrak{g})} \phi(x/\varepsilon)\)</span>. The
previous lemma implies that whenever <span
class="math inline">\(\varepsilon\lll 1\)</span>, we have <span
class="math inline">\(I(\phi_\varepsilon) \gg T^{-\dim(N)/2}\)</span>.
We deduce via overspill that the same estimate holds for some fixed
<span class="math inline">\(\varepsilon&gt; 0\)</span>. (Indeed, the set
<span class="math inline">\(\{\varepsilon&gt; 0 : I(\phi_{\varepsilon})
\geqslant\varepsilon T^{-\dim(N)/2} \}\)</span> contains all positive
reals <span class="math inline">\(\varepsilon\lll 1\)</span>, hence must
contain some fixed positive real.) We conclude by taking <span
class="math inline">\(\phi = \phi_\varepsilon\)</span>. ◻</p>
</div>
<p>For the following proposition and its proof, we denote by <span
class="math display">\[\mathbf{1} := |.|^0 \in \mathfrak{X}(A)\]</span>
the trivial character. Thus, for instance, <span
class="math display">\[\mathcal{J}_T[\psi,\beta,\gamma][\mathbf{1}] =
  \mathcal{J}_T[\psi,\beta,\gamma,\mathbf{1}]\]</span> denotes the
Mellin component at the trivial character of the elements <span
class="math inline">\(\mathcal{J}_T[\psi,\beta,\gamma] \in
\mathcal{S}^e(U \backslash G)\)</span> constructed previously.</p>
<div id="prop:there-exists-gamma" class="proposition">
<p><strong>Proposition 197</strong>. <em>There exists <span
class="math inline">\(\gamma \in
\mathfrak{C}(G,-\theta_G(\psi),T,\tfrac{1}{2})\)</span> so that for each
<span class="math inline">\(\beta \in \mathfrak{B}(A)\)</span> with
<span class="math inline">\(\int_{A} \beta \asymp 1\)</span>, the
element <span id="eq:f-:=-mathcalj_tpsi" class="math display">\[\label{eq:f-:=-mathcalj_tpsi}\tag{10.17}
    f := \mathcal{J}_T[\psi,\beta,\gamma] = L (T ^{\rho _U ^\vee })
\mathcal{J}[\psi_T,\beta,\gamma] \in \mathfrak{F}(U \backslash G, \psi,
T)\]</span> has the following property. There is a fixed <span
class="math inline">\(C_0 &gt; 0\)</span> so that for all <span
class="math inline">\(g \in Q\)</span> for which <span
class="math inline">\(g = 1 +
\operatorname{O}(T^{-1/2-\varepsilon})\)</span> for some fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>, we have <span id="eq:real-part-W-lower-bound" class="math display">\[\label{eq:real-part-W-lower-bound}\tag{10.18}
    \Re(W[f[\mathbf{1}], \psi_T](g)) \geqslant C_0
T^{-\dim(N)/2}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> We abbreviate <span class="math inline">\(\theta :=
\theta_G(\psi)\)</span>.</p>
<p>Let <span class="math inline">\(\phi\)</span> be as in the conclusion
of Corollary <a href="#cor:sub-gln:there-exists-fixed"
data-reference-type="ref"
data-reference="cor:sub-gln:there-exists-fixed">196</a>. Let <span
class="math inline">\(\gamma_0\)</span> denote the smooth measure on
<span class="math inline">\(\mathfrak{g}\)</span> given by <span
class="math display">\[\gamma_0(x) = T^{\dim(G)/2} \phi(T^{1/2} x)
\psi_{- T \theta}(x) \, d x.\]</span> The measure <span
class="math inline">\(\gamma_0\)</span> is supported near the origin,
hence identifies via pushforward under the exponential map with a smooth
measure on <span class="math inline">\(G\)</span>, characterized as
follows: for any locally integrable function <span
class="math inline">\(\Phi\)</span> on <span
class="math inline">\(G\)</span>, <span id="eq:int-_g-gamma_0" class="math display">\[\label{eq:int-_g-gamma_0}\tag{10.19}
    \int _{G} \gamma_0 \cdot \Phi
    = \int _{x \in \mathfrak{g} }
    \phi(x)
    \Phi (\exp (\tfrac{x}{T ^{1/2} }))
    \exp (- \langle T \theta, \tfrac{x}{ T ^{1/2} } \rangle)
    \, d x.\]</span> It is easy to see, as in Example <a
href="#example:standard2:smooth-modulated-bump-in-frak-C"
data-reference-type="ref"
data-reference="example:standard2:smooth-modulated-bump-in-frak-C">116</a>,
that <span class="math inline">\(\gamma_0\)</span> lies in the class
<span
class="math inline">\(\mathfrak{C}(G,-\theta,T,\tfrac{1}{2})\)</span>.
By Proposition <a href="#lem:standard:subcl-mathfr-theta"
data-reference-type="ref"
data-reference="lem:standard:subcl-mathfr-theta">135</a>, we have
likewise <span class="math display">\[\gamma := \gamma_0^* \ast \gamma_0
\in \mathfrak{C}(G,-\theta,T,\tfrac{1}{2}).\]</span> We claim that this
element <span class="math inline">\(\gamma\)</span> satisfies the
required conclusions.</p>
<p>Indeed, let <span class="math inline">\(\beta\)</span> be as in our
hypotheses, and define <span class="math inline">\(f\)</span> as in <a
href="#eq:f-:=-mathcalj_tpsi" data-reference-type="eqref"
data-reference="eq:f-:=-mathcalj_tpsi">\((10.17)\)</a>.
Without loss of generality, suppose that <span
class="math inline">\(\int_{A} \beta = 1\)</span>. Then by Lemma <a
href="#lem:scratch-research:let-beta_1-beta_2" data-reference-type="ref"
data-reference="lem:scratch-research:let-beta_1-beta_2">163</a> (applied
with “<span class="math inline">\(\psi\)</span>” the rescaled character
<span class="math inline">\(\psi_T\)</span>) and the identity <span
class="math display">\[\begin{align}
  \mathcal{J}_T[\psi,\beta,\gamma_0,\mathbf{1}](h)
  &amp;=
    \delta_U^{-1/2} (T^{\rho_U^\vee}) \mathcal{J}[\psi_T,\beta,\gamma_0,
\mathbf{1}](T^{\rho_U^\vee} h)
  \\
  &amp;=
    \mathcal{J}[\psi_T,\beta,\gamma_0,\mathbf{1}](h),
\end{align}\]</span> we have <span id="eq:whittaker-evaluate-at-1-via-integral-distributions-convolved-appl" class="math display">\[\label{eq:whittaker-evaluate-at-1-via-integral-distributions-convolved-appl}\tag{10.20}
  W[f[\mathbf{1}], \psi_T](g) = \int_N \mathcal{J}[\psi_T, \beta,
\gamma_0,\mathbf{1}] \overline{\mathcal{J}[\psi_T, \beta, \gamma_0 \ast
g^{-1},\mathbf{1}]}.\]</span> We must bound the real part of this from
below.</p>
<p>Consider first the case of the identity element <span
class="math inline">\(g = 1\)</span>. An important feature in this case
is that the integrand in <a
href="#eq:whittaker-evaluate-at-1-via-integral-distributions-convolved-appl"
data-reference-type="eqref"
data-reference="eq:whittaker-evaluate-at-1-via-integral-distributions-convolved-appl">\((10.20)\)</a>
is nonnegative. For <span class="math inline">\(n \in N\)</span>, we
have <span class="math display">\[\begin{align}
  \mathcal{J}[\psi_T,\beta,\gamma_0,\mathbf{1}](n)
  &amp;=
    \int_{a \in A} \delta_U^{-1/2}(a) \mathcal{J}[\psi_T, \beta,
\gamma_0](a n) \, d a \\
  &amp;=
    \int _{a \in A} \delta_U^{-1/2}(a)
    \int _{h \in G }  \gamma_0(h) \mathcal{J}[\psi_T,\beta](a n h) \, d
a.\
\end{align}\]</span> By definition, <span
class="math inline">\(\mathcal{J}[\psi_T,\beta](g)
=  \delta_U^{1/2}(g_A) \beta(g_A) \psi_T(g_N)\)</span>. We have <span
class="math display">\[(a n h)_A = a (n h)_A, \quad (a n h)_N = (n
h)_N,\]</span> so the above simplifies to <span
class="math display">\[\int _{a \in A}
    \int _{h \in G} \gamma_0(h)
    \delta_U^{1/2}((n h)_A)
    \beta(a (n h)_A)
    \psi_T((n h)_N) \, d a.\]</span> This double integral converges
absolutely. Indeed, the integrand is compactly-supported in <span
class="math inline">\(h\)</span> due to the factor <span
class="math inline">\(\gamma_0(h)\)</span>, then compactly-supported in
<span class="math inline">\(a\)</span> due to the factor <span
class="math inline">\(\beta(a(n h)_A)\)</span>. After interchanging the
order of integration and substituting <span class="math inline">\(a
\mapsto a (n h)_A^{-1}\)</span>, the remaining <span
class="math inline">\(a\)</span>-integral evaluates to <span
class="math inline">\(\int_A \beta  = 1\)</span>, and we are left with
<span class="math display">\[\int _{h \in G} \gamma_0(h)
    \delta_U^{1/2}((n h)_A)
    \psi_T((n h)_N).\]</span> Appealing to the definition <a
href="#eq:int-_g-gamma_0" data-reference-type="eqref"
data-reference="eq:int-_g-gamma_0">\((10.19)\)</a> of <span
class="math inline">\(\gamma_0\)</span>, we conclude that <span
class="math display">\[\begin{align}
    &amp;\mathcal{J}[\psi_T,\beta,\gamma_0, \mathbf{1}](n)   \\
    &amp;\quad
      =
    \int _{x \in \mathfrak{g} }
    \phi (x) \delta_U^{1/2}((n \exp(\tfrac{x}{T^{1/2}}))_A) \psi_T ((n
\exp(\tfrac{x}{T ^{1/2} }))_N)
    \psi ( - \langle T \theta, \tfrac{x}{ T ^{1/2} } \rangle) \, d x.
  
\end{align}\]</span> By the conclusion of Corollary <a
href="#cor:sub-gln:there-exists-fixed" data-reference-type="ref"
data-reference="cor:sub-gln:there-exists-fixed">196</a>, it follows that
<span class="math display">\[\int _{n \in N} \left\lvert
\mathcal{J}[\psi_T,\beta,\gamma_0, \mathbf{1}](n) \right\rvert^2 \, d n
\gg T^{-\dim(N)/2}.\]</span> Via <a
href="#eq:whittaker-evaluate-at-1-via-integral-distributions-convolved-appl"
data-reference-type="eqref"
data-reference="eq:whittaker-evaluate-at-1-via-integral-distributions-convolved-appl">\((10.20)\)</a>,
we obtain the required formula <a href="#eq:real-part-W-lower-bound"
data-reference-type="eqref"
data-reference="eq:real-part-W-lower-bound">\((10.18)\)</a>
in the case <span class="math inline">\(g = 1\)</span>.</p>
<p>It remains to treat the more general case in which <span
class="math inline">\(\mathop{\mathrm{dist}}(g,1) \ll
T^{-1/2-\varepsilon}\)</span>. We will deduce this case from the <span
class="math inline">\(g = 1\)</span> case via “continuity,” as follows.
Set <span class="math display">\[v_g :=
\mathcal{J}[\psi_T,\beta,\gamma_0 \ast g^{-1}, \mathbf{1}] =
\mathcal{J}_T[\psi,\beta,\gamma_0 \ast g^{-1}, \mathbf{1}].\]</span> Let
<span class="math inline">\(\langle ,  \rangle\)</span> denote the inner
product on the unitary representation <span
class="math inline">\(\mathcal{I}(1)\)</span> defined by integration
over <span class="math inline">\(N\)</span>, and <span
class="math inline">\(\|v\| := \langle v, v \rangle^{1/2}\)</span> the
associated norm. We may rewrite <a
href="#eq:whittaker-evaluate-at-1-via-integral-distributions-convolved-appl"
data-reference-type="eqref"
data-reference="eq:whittaker-evaluate-at-1-via-integral-distributions-convolved-appl">\((10.20)\)</a>
as <span class="math display">\[W[f[\mathbf{1}], \psi_T](g) = \langle
v_1, v_g \rangle.\]</span> We have seen already that <span
class="math inline">\(\langle v_1, v_1 \rangle \gg
T^{-\dim(N)/2}\)</span>. To obtain the required estimate, it is enough
to check that <span class="math inline">\(\langle v_1, v_g - v_1 \rangle
\lll T^{-\dim(N)/2}\)</span> whenever <span
class="math inline">\(\mathop{\mathrm{dist}}(g,1) \ll
T^{-1/2-\varepsilon}\)</span>. By Cauchy–Schwarz, we reduce further to
checking that <span id="eq:v_12-ll-t" class="math display">\[\label{eq:v_12-ll-t}\tag{10.21}
    \|v_1\|^2 \ll T^{-\dim(N)/2 + o(1)},\]</span> <span id="eq:v_g-v_12-ll" class="math display">\[\label{eq:v_g-v_12-ll}\tag{10.22}
    \|v_g - v_1\|^2 \ll T^{-\dim(N)/2 - 2 \varepsilon+ o(1)}.\]</span>
The first estimate <a href="#eq:v_12-ll-t" data-reference-type="eqref"
data-reference="eq:v_12-ll-t">\((10.21)\)</a> is a consequence of
Lemma <a href="#lem:scratch-research:let-f-in" data-reference-type="ref"
data-reference="lem:scratch-research:let-f-in">191</a>, and in
particular the <span class="math inline">\(L^2\)</span> estimate <a
href="#eq:int_k-fchi2-ll" data-reference-type="eqref"
data-reference="eq:int_k-fchi2-ll">\((10.15)\)</a>, applied to
<span class="math inline">\(\mathcal{J}_T[\psi,\beta,\gamma_0] \in
\mathfrak{F}(U \backslash G, \psi, T)\)</span>. For the second estimate,
we note first by Proposition <a href="#lem:sub-gln:let-gamma-in"
data-reference-type="ref"
data-reference="lem:sub-gln:let-gamma-in">134</a> that <span
class="math display">\[\gamma_0 \ast g^{-1} - \gamma_0 \in T^{1/2}
{\mathop{\mathrm{dist}}}_G(g,1) \mathfrak{C}(G,-\theta,T,\tfrac{1}{2})
    \subseteq
    T^{-\varepsilon} \mathfrak{C}(G,-\theta,T,\tfrac{1}{2}).\]</span>
(Here we have used our assumption <span class="math inline">\(g \in
Q\)</span>, which implies that <span class="math inline">\(\psi_{- T
\theta, \log}(g) = 1\)</span>.) It follows that <span
class="math inline">\(v_g - v_1 = f_g[\mathbf{1}]\)</span>, where <span
class="math display">\[f_g := \mathcal{J}_T[\psi, \beta, \gamma_0 \ast
g^{-1} - \gamma_0] \in T^{-\varepsilon} \mathfrak{F}(U \backslash G,
\psi, T).\]</span> We deduce <a href="#eq:v_g-v_12-ll"
data-reference-type="eqref"
data-reference="eq:v_g-v_12-ll">\((10.22)\)</a> once again via
Lemma <a href="#lem:scratch-research:let-f-in" data-reference-type="ref"
data-reference="lem:scratch-research:let-f-in">191</a>. ◻</p>
</div>
<h3 id="sec:constr-test-vect-proofs">§11. Construction of test vectors:
proofs</h3>
<h4 id="sec:constr-test-vec-setup">§11.1. Setup</h4>
<p>We retain the setting of Theorem <a href="#thm:main-local-results"
data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>:
<span class="math inline">\((G,H) =
({\mathop{\mathrm{GL}}}_{n+1}(\mathbb{R}),{\mathop{\mathrm{GL}}}_n(\mathbb{R}))\)</span>
for some fixed <span class="math inline">\(n\)</span> (with the usual
accompanying notation), <span class="math inline">\(\psi\)</span> is a
fixed nondegenerate unitary character of <span
class="math inline">\(N\)</span>, <span class="math inline">\(T \ggg
1\)</span> is a large positive real, and <span
class="math inline">\(\pi\)</span> is a generic irreducible unitary
representation of <span class="math inline">\(G\)</span> with
archimedean <span class="math inline">\(L\)</span>-function parameters
of magnitude <span class="math inline">\(\asymp T\)</span>. We will
construct the required vectors and verify all claimed properties.</p>
<p>We continue to denote also by <span
class="math inline">\(\psi\)</span> its restriction to <span
class="math inline">\(N_H\)</span>. We continue to denote by <span
class="math inline">\(P\)</span> the mirabolic subgroup of <span
class="math inline">\(G\)</span>, consisting of elements with bottom row
<span class="math inline">\((0,\dotsc,0,1)\)</span>. We define <span
class="math inline">\(\theta_P(\psi)\)</span> as in §<a
href="#sec:parameter-theta" data-reference-type="ref"
data-reference="sec:parameter-theta">2.3.2</a> and <span
class="math inline">\(\theta_H(\psi^{-1}) = - \theta_H(\psi)\)</span> as
in §<a href="#sec:analysis-U-G-quantitative-setup"
data-reference-type="ref"
data-reference="sec:analysis-U-G-quantitative-setup">5.1</a>. We define
the rescaled character <span class="math inline">\(\psi_T\)</span> as in
§<a href="#sec:class-bump-functions" data-reference-type="ref"
data-reference="sec:class-bump-functions">3.2</a>. We define the classes
<span class="math inline">\(\mathfrak{W}(\pi,\psi,T,\delta)\)</span>
(for fixed <span class="math inline">\(\delta \in (0,1/2)\)</span>) as
in Definition <a href="#defn:we-denote-mathfr-frakW"
data-reference-type="ref"
data-reference="defn:we-denote-mathfr-frakW">148</a>, <span
class="math inline">\(\mathfrak{F}(U_H \backslash H, \psi^{-1},
T)\)</span> as in Definition <a
href="#defn:standard2:we-denote-mathfrakfu" data-reference-type="ref"
data-reference="defn:standard2:we-denote-mathfrakfu">175</a>, and <span
class="math inline">\(\mathfrak{C}(\dotsb)\)</span> as in §<a
href="#sec:spec-group-sett" data-reference-type="ref"
data-reference="sec:spec-group-sett">1.4</a>. We set <span
class="math inline">\(\tau := \tau(\pi,\psi,T)\)</span> as in Definition
<a href="#defn:parameter-tau-pi-T" data-reference-type="ref"
data-reference="defn:parameter-tau-pi-T">142</a>. Then, as noted in
Lemma <a href="#lem:standard2:no-conductor-drop-vs-tau"
data-reference-type="ref"
data-reference="lem:standard2:no-conductor-drop-vs-tau">7.9</a>,
<span class="math inline">\(\tau\)</span> lies in a fixed compact subset
of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>.</p>
<h4 id="sec:estim-resc-local">§11.2. Estimates for rescaled local zeta
integrals</h4>
<p>Let <span class="math inline">\(f \in \mathcal{S}(U_H \backslash
H)\)</span>. For <span class="math inline">\(s \in
\mathfrak{a}_{H,\mathbb{C}}^*\)</span>, we define the Mellin components
<span class="math inline">\(f[s] \in \mathcal{I}(s)\)</span> as in §<a
href="#sec:mellin-paley-affine-quotients" data-reference-type="ref"
data-reference="sec:mellin-paley-affine-quotients">2.8.3</a>, following
the “unramified character” notation (i.e., <span
class="math inline">\(f[s] = f[|.|^s]\)</span>, <span
class="math inline">\(\mathcal{I}(s) = \mathcal{I}(|.|^s)\)</span>). In
particular, <span class="math inline">\(\mathcal{I}(0)\)</span> denotes
the induction of the trivial character, and <span
class="math inline">\(f[0]\)</span> the corresponding component of <span
class="math inline">\(f\)</span>; these are the only components relevant
for the following discussion. (By contrast, in the statement of
Proposition <a href="#prop:there-exists-gamma" data-reference-type="ref"
data-reference="prop:there-exists-gamma">197</a>, we referred to the
trivial character as <span class="math inline">\(\mathbf{1}\)</span>.
This minor adjustment of notation should introduce no confusion.)</p>
<p>Let <span class="math inline">\(W \in
\mathcal{W}(\pi,\psi_T)\)</span>. As in §<a href="#sec:zeta-integrals"
data-reference-type="ref"
data-reference="sec:zeta-integrals">2.14.4</a>, we may define, for <span
class="math inline">\(s \in \mathfrak{a}_{H,\mathbb{C}}^*\)</span>, the
local zeta integral <span class="math display">\[Z_T(W,f[s])
  :=
  \int _{h \in N_H \backslash H}
  W(h) \cdot W[f[s], \psi_T^{-1}](h) \, d h.\]</span> The subscripted
<span class="math inline">\(T\)</span> reflects that we are working with
<span class="math inline">\(\psi_T\)</span>-Whittaker models rather than
<span class="math inline">\(\psi\)</span>-Whittaker models, as in §<a
href="#sec:zeta-integrals" data-reference-type="ref"
data-reference="sec:zeta-integrals">2.14.4</a>. Normally, this
definition requires some interpretation via meromorphic continuation.
However, if the restriction of <span class="math inline">\(W\)</span> to
<span class="math inline">\(Q_H\)</span> is compactly-supported, then
the above formula converges absolutely for all <span
class="math inline">\(s\)</span>. Indeed, it is then the integral of a
continuous function over a compact set. In such cases, there is no need
to appeal to meromorphic continuation: the same formula works for all
<span class="math inline">\(s\)</span>, and the zeta integral is entire
in <span class="math inline">\(s\)</span>. This happens if <span
class="math inline">\(W\)</span> is of the form <span
class="math inline">\(\pi(\gamma) \Theta_{\pi,T}\)</span> for some <span
class="math inline">\(\gamma \in \mathcal{M}_c(H)\)</span>, e.g., if
<span class="math inline">\(W \in
\mathfrak{W}(\pi,\psi,T,\delta)\)</span>, and is the only case we need
to consider here.</p>
<p>In the definition of <span class="math inline">\(Z_T\)</span>, we can
replace the integral over <span class="math inline">\(N_H \backslash
H\)</span> with one over <span class="math inline">\(Q_H\)</span> with
respect to a right Haar measure.</p>
<p>We begin with the main calculation:</p>
<div id="item:lemma-there-exists-gamma-W-7" class="lemma">
<p><strong>Lemma 198</strong>. <span id="lem:there-exists-begin"
label="lem:there-exists-begin"></span> There exist <span
class="math display">\[\gamma \in \mathfrak{C}(H, -\theta_H(\psi^{-1}),
T, \tfrac{1}{2}),
    \quad
    W \in \mathcal{W}(\pi,\psi_T),
    \quad
    \omega_0 \in C_c^\infty(G)\]</span> with the following properties.
Let <span class="math inline">\(\beta \in
\mathfrak{B}(A_H)^{W_H}\)</span> with <span
class="math inline">\(\int_{A_H} \beta  = 1\)</span>. Define <span
class="math display">\[f := \mathcal{J}_T[\psi^{-1},\beta,\gamma] \in
\mathfrak{F}(U_H \backslash H, T, \psi^{-1}) \subseteq \mathcal{S}(U_H
\backslash H).\]</span> Define <span
class="math inline">\(\omega\)</span> and <span
class="math inline">\(\omega ^\sharp\)</span> as in the statement of
Theorem <a href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>.
Then:</p>
<ol type="i">
<li><p><span id="item:lemma-there-exists-gamma-W-1"
label="item:lemma-there-exists-gamma-W-1"></span> <span
class="math inline">\(\int_{N_H \backslash H} |W|^2 \ll T^{\dim(Q_H) / 2
+ o(1)}\)</span>.</p></li>
<li><p><span id="itm:lemma-exists-omega-2"
label="itm:lemma-exists-omega-2"></span> <span
class="math inline">\(\omega(g) \neq 0\)</span> only if <span
class="math inline">\(g = 1 + o(1)\)</span> and <span
class="math inline">\({\mathop{\mathrm{Ad}}}^*(g) \tau = \tau +
o(T^{-1/2})\)</span>.</p></li>
<li><p><span id="itm:lemma-exists-omega-3"
label="itm:lemma-exists-omega-3"></span> <span
class="math inline">\(\|\omega^\sharp\|_{\infty} \ll
T^{\dim(N)+o(1)}\)</span></p></li>
<li><p><span class="math inline">\(\int_H |\omega^\sharp| \ll
T^{\mathop{\mathrm{rank}}(H)/2 + o(1)}\)</span>.</p></li>
<li><p><span id="item:lemma-there-exists-gamma-W-5"
label="item:lemma-there-exists-gamma-W-5"></span> For each fixed <span
class="math inline">\(x \in \mathfrak{U}(G)\)</span>, we have <span
class="math inline">\(\|\pi(x) (\pi(\omega)W - W)\| \ll
T^{-\infty}\)</span>.</p></li>
<li><p><span id="item:lemma-there-exists-gamma-W-6"
label="item:lemma-there-exists-gamma-W-6"></span> <span
class="math inline">\(Z_T(W,f[0]) \gg
T^{-\dim(N_H)/2}\)</span>.</p></li>
<li><p>For all <span class="math inline">\(s \in
\mathfrak{a}_{H,\mathbb{C}}^*\)</span> with <span
class="math inline">\(\Re(s) \ll 1\)</span>, we have <span
class="math display">\[Z_T(W,f[s]) \ll T^{\langle \rho_{U_H}^\vee, s
\rangle - \dim(N_H)/2 + o(1)} \langle s
\rangle^{-\infty}.\]</span></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> The proof begins with a few technical arguments that
consolidate earlier results and perform some “<span
class="math inline">\(\varepsilon\)</span> clean-up.” Our main task is
then to estimate the local zeta integrals <span
class="math inline">\(Z_T(W,f[s])\)</span>.</p>
<p>We let <span class="math inline">\(\gamma\)</span> be as given by
Proposition <a href="#prop:there-exists-gamma" data-reference-type="ref"
data-reference="prop:there-exists-gamma">197</a>, and let <span
class="math inline">\(\beta\)</span> and <span
class="math inline">\(f\)</span> be as in the statement above. The
conclusion of that proposition provides a fixed <span
class="math inline">\(C_0 &gt; 0\)</span> so that for each fixed <span
class="math inline">\(\varepsilon_0 &gt; 0\)</span>, <span id="eq:rewf0-psi_tg-gg" class="math display">\[\label{eq:rewf0-psi_tg-gg}\tag{11.1}
    g \in Q_H, \quad |g - 1| \leqslant T^{-1/2-\varepsilon_0}
    \quad
    \implies
    \quad
    \Re(W[f[0], \psi_T^{-1}](g)) \geqslant C_0
T^{-\dim(N_H)/2}.\]</span> By overspill, we deduce that there exists
<span class="math inline">\(\varepsilon_0 &gt; 0\)</span> with <span
class="math inline">\(\varepsilon_0 \lll 1\)</span> for which the
implication <a href="#eq:rewf0-psi_tg-gg" data-reference-type="eqref"
data-reference="eq:rewf0-psi_tg-gg">\((11.1)\)</a> remains
valid. We henceforth work with such a value of <span
class="math inline">\(\varepsilon_0\)</span>.</p>
<p>Fix a basis <span class="math inline">\(\mathcal{B}\)</span> of <span
class="math inline">\(\mathfrak{g}\)</span>. We observe the following
consequence of Lemma <a href="#lem:there-exists-w-big-group-big"
data-reference-type="ref"
data-reference="lem:there-exists-w-big-group-big">150</a> and Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>: for
each fixed <span class="math inline">\(\varepsilon&gt; 0\)</span>, there
is a fixed <span class="math inline">\(\delta \in (0,1/2)\)</span> and
elements <span class="math inline">\(W \in
\mathfrak{W}(\pi,\psi,T,\delta)\)</span> and <span
class="math inline">\(\omega \in C_c^\infty(G)\)</span> so that <span id="eq:int_n_h-backslash-h-1" class="math display">\[\label{eq:int_n_h-backslash-h-1}\tag{11.2}
    \int_{N_H \backslash H} |W|^2 \leqslant T^{\dim(Q_H)/2 +
\varepsilon},\]</span> <span id="eq:w_q_h-geq-0" class="math display">\[\label{eq:w_q_h-geq-0}\tag{11.3}
    W|_{Q_H} \geqslant 0, \quad \int_{Q_H} W =  1,\]</span> <span id="eq:g-in-q_h" class="math display">\[\label{eq:g-in-q_h}\tag{11.4}
    g \in Q_H, W(g) \neq 0 \implies |g - 1| \leqslant\varepsilon
T^{-1/2-\varepsilon_0},\]</span> <span id="eq:g-in-g" class="math display">\[\label{eq:g-in-g}\tag{11.5}
    g \in G, \omega(g) \neq 0 \implies |g - 1| \leqslant\varepsilon,
|{\mathop{\mathrm{Ad}}}^*(g) \tau - \tau| \leqslant\varepsilon
T^{-1/2},\]</span> <span id="eq:omeg-leq-tnn+12" class="math display">\[\label{eq:omeg-leq-tnn+12}\tag{11.6}
    \|\omega^{\sharp}\|_{\infty} \leqslant T^{\dim(N) + \varepsilon},
\quad
    \int_H \lvert \omega^\sharp \rvert \leqslant
T^{\mathop{\mathrm{rank}}(H)/2+\varepsilon},\]</span> and, for all <span
class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span> with <span
class="math inline">\(m \leqslant 1/\varepsilon\)</span> and all <span
class="math inline">\(x_1,\dotsc,x_m \in \mathcal{B}\)</span>, <span id="eq:pix_1-dotsb-x_m" class="math display">\[\label{eq:pix_1-dotsb-x_m}\tag{11.7}
    \|\pi(x_1 \dotsb x_m) (\pi(\omega) W - W)\| \leqslant
T^{-1/\varepsilon}.\]</span> Indeed, given such an <span
class="math inline">\(\varepsilon\)</span>, we fix <span
class="math inline">\(\delta \in (0,1/2)\)</span>, with <span
class="math inline">\(1/2 - \delta\)</span> small enough in terms of
<span class="math inline">\(\varepsilon\)</span>, and choose <span
class="math inline">\(W_1 \in \mathfrak{W}(\pi,\psi,T,\delta)\)</span>
according to Lemma <a href="#lem:there-exists-w-big-group-big"
data-reference-type="ref"
data-reference="lem:there-exists-w-big-group-big">150</a>. By Lemma <a
href="#lem:fix-delta-in" data-reference-type="ref"
data-reference="lem:fix-delta-in">147</a> and the definition of <span
class="math inline">\(\mathfrak{C}(Q_H,0,T,\delta)\)</span>, we have
<span class="math display">\[W|_{Q_H}(g) \neq 0 \implies |g - 1| \ll
T^{-1+\delta_+}\]</span> for some fixed <span
class="math inline">\(\delta_+ \in (\delta,1/2)\)</span>. Since <span
class="math inline">\(\varepsilon_0 \lll 1\)</span> and <span
class="math inline">\(T \ggg 1\)</span>, we have <span
class="math inline">\(T^{-1+\delta_+} \lll
T^{-1/2-\varepsilon_0}\)</span>, so the support condition <a
href="#eq:g-in-q_h" data-reference-type="eqref"
data-reference="eq:g-in-q_h">\((11.4)\)</a> holds. The <span
class="math inline">\(L^2\)</span>-estimate <a
href="#eq:int_n_h-backslash-h-1" data-reference-type="eqref"
data-reference="eq:int_n_h-backslash-h-1">\((11.2)\)</a>
follows from Lemma <a href="#lem:let-w-in-square-integral"
data-reference-type="ref"
data-reference="lem:let-w-in-square-integral">149</a>, while the
assertions in <a href="#eq:w_q_h-geq-0" data-reference-type="eqref"
data-reference="eq:w_q_h-geq-0">\((11.3)\)</a> are the content of
the conclusion of Lemma <a href="#lem:there-exists-w-big-group-big"
data-reference-type="ref"
data-reference="lem:there-exists-w-big-group-big">150</a>. We then take
<span class="math inline">\(\omega\)</span> as in Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>
(applied with <span class="math inline">\(\varepsilon/2\)</span> in
place of <span class="math inline">\(\varepsilon\)</span>, so that we
may absorb any implied constants <span class="math inline">\(\ll
1\)</span> into the factors <span
class="math inline">\(T^{\varepsilon/2} \ggg 1\)</span>). The remaining
assertions <a href="#eq:g-in-g" data-reference-type="eqref"
data-reference="eq:g-in-g">\((11.5)\)</a>, <a
href="#eq:omeg-leq-tnn+12" data-reference-type="eqref"
data-reference="eq:omeg-leq-tnn+12">\((11.6)\)</a> and <a
href="#eq:pix_1-dotsb-x_m" data-reference-type="eqref"
data-reference="eq:pix_1-dotsb-x_m">\((11.7)\)</a> are then
the content of the conclusion of Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>.</p>
<p>By overspill, we may find <span class="math inline">\(\varepsilon&gt;
\varepsilon_0\)</span> with <span class="math inline">\(\varepsilon\lll
1\)</span> for which there exist <span class="math inline">\(W \in
\mathcal{W}(\pi,\psi_T)\)</span> and <span
class="math inline">\(\omega_0 \in C_c^\infty(G)\)</span> satisfying the
stated assertions <a href="#eq:int_n_h-backslash-h-1"
data-reference-type="eqref"
data-reference="eq:int_n_h-backslash-h-1">\((11.2)\)</a>–<a
href="#eq:pix_1-dotsb-x_m" data-reference-type="eqref"
data-reference="eq:pix_1-dotsb-x_m">\((11.7)\)</a> . We
henceforth work such values of <span class="math inline">\(\varepsilon,
W\)</span> and <span class="math inline">\(\omega_0\)</span>. Assertions
<a href="#item:lemma-there-exists-gamma-W-1" data-reference-type="eqref"
data-reference="item:lemma-there-exists-gamma-W-1">\((i)\)</a>–<a
href="#item:lemma-there-exists-gamma-W-5" data-reference-type="eqref"
data-reference="item:lemma-there-exists-gamma-W-5">\((v)\)</a>
then follow from <a href="#eq:int_n_h-backslash-h-1"
data-reference-type="eqref"
data-reference="eq:int_n_h-backslash-h-1">\((11.2)\)</a>,
<a href="#eq:g-in-g" data-reference-type="eqref"
data-reference="eq:g-in-g">\((11.5)\)</a>, <a
href="#eq:omeg-leq-tnn+12" data-reference-type="eqref"
data-reference="eq:omeg-leq-tnn+12">\((11.6)\)</a> and <a
href="#eq:pix_1-dotsb-x_m" data-reference-type="eqref"
data-reference="eq:pix_1-dotsb-x_m">\((11.7)\)</a>. It remains
to verify the stated bounds <a href="#item:lemma-there-exists-gamma-W-6"
data-reference-type="eqref"
data-reference="item:lemma-there-exists-gamma-W-6">\((vi)\)</a>
and <a href="#item:lemma-there-exists-gamma-W-7"
data-reference-type="eqref"
data-reference="item:lemma-there-exists-gamma-W-7">\((vii)\)</a>
for <span class="math inline">\(Z_T\)</span>.</p>
<p>We observe by the support condition <a href="#eq:g-in-q_h"
data-reference-type="eqref"
data-reference="eq:g-in-q_h">\((11.4)\)</a> for <span
class="math inline">\(W|_{Q_H}\)</span>, together with the conclusion of
Proposition <a href="#prop:there-exists-gamma" data-reference-type="ref"
data-reference="prop:there-exists-gamma">197</a>, that the lower bound
<a href="#eq:rewf0-psi_tg-gg" data-reference-type="eqref"
data-reference="eq:rewf0-psi_tg-gg">\((11.1)\)</a> for the
real part of <span class="math inline">\(W[f[0],\psi_T^{-1}]\)</span>
holds on the support of <span class="math inline">\(W|_{Q_H}\)</span>.
By <a href="#eq:w_q_h-geq-0" data-reference-type="eqref"
data-reference="eq:w_q_h-geq-0">\((11.3)\)</a>, it follows that
<span class="math display">\[\Re(Z_T(W,f[0]))
    =
    \int _{Q_H}
    W \cdot \Re(W[f[0],\psi_T^{-1}])
    \geqslant C_0 T^{-\dim(N_H) / 2}.\]</span> Thus assertion <a
href="#item:lemma-there-exists-gamma-W-6" data-reference-type="eqref"
data-reference="item:lemma-there-exists-gamma-W-6">\((vi)\)</a>
holds.</p>
<p>Let <span class="math inline">\(g \in
\mathop{\mathrm{supp}}(W|_{Q_H})\)</span>. By <a href="#eq:g-in-q_h"
data-reference-type="eqref"
data-reference="eq:g-in-q_h">\((11.4)\)</a>, we have <span
class="math inline">\(g = 1 + o(T^{-1/2})\)</span>. In that case,
Proposition <a href="#lem:all-f-in" data-reference-type="ref"
data-reference="lem:all-f-in">193</a> gives that for <span
class="math inline">\(\Re(s) \ll 1\)</span>, <span
class="math display">\[W[f[s], \psi_T^{-1}](g) \ll T ^{\langle
\rho_{U_H}^\vee, s \rangle - \dim(N_H)/2 + o(1)} \langle s \rangle
^{-\infty }.\]</span> Assertion <a
href="#item:lemma-there-exists-gamma-W-7" data-reference-type="eqref"
data-reference="item:lemma-there-exists-gamma-W-7">\((vii)\)</a>
then follows by integrating over <span
class="math inline">\(Q_H\)</span> against <span
class="math inline">\(W\)</span>. ◻</p>
</div>
<h4 id="transversality">Transversality</h4>
<p>In this section, we verify that the <span
class="math inline">\(\omega_0 \in C_c^\infty(G)\)</span> furnished by
Lemma <a href="#lem:there-exists-begin" data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a>
satisfies the “transversality” or “bilinear forms” assertion <a
href="#itm:sub-gln:3" data-reference-type="eqref"
data-reference="itm:sub-gln:3">\((vii)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a> for
a wide class of <span class="math inline">\(\phi_{Z_H} \in
C_c^\infty(Z_H)\)</span>.</p>
<p>We continue to write <span class="math inline">\(\bar{G} = G /
Z\)</span>, where <span class="math inline">\(Z &lt; G\)</span> and
<span class="math inline">\(Z_H \leqslant H\)</span> denote the centers.
Recall from §<a href="#sec:dist-funct-d_h" data-reference-type="ref"
data-reference="sec:dist-funct-d_h">2.19</a> the definition of <span
class="math inline">\(d_H : \bar{G} \rightarrow [0,1]\)</span>.</p>
<div id="thm:bilinear-forms-cited" class="theorem">
<p><strong>Theorem 199</strong>. <em>Let <span
class="math inline">\(\mathfrak{S}\)</span> be a compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>.
There are bounded symmetric open neighborhoods <span
class="math inline">\(\mathcal{Z} \subseteq Z_H\)</span> and <span
class="math inline">\(\mathcal{G} \subseteq \bar{G}\)</span> of the
respective identity elements, which may be chosen arbitrarily small, for
which the following assertions hold. Let <span
class="math inline">\(\Omega\)</span> be a compact subset of <span
class="math inline">\(H\)</span>. There exists <span
class="math inline">\(C \geqslant 0\)</span> with the following
property. Let <span class="math inline">\(u_1 ^0 , u_2 ^0 : H
\rightarrow \mathbb{R}_{\geqslant 0}\)</span> be nonnegative measurable
functions. Define the convolutions <span class="math display">\[u_i(x)
:= \int _{z \in \mathcal{Z} } u_i ^0 (x z^{-1}) \, d z.\]</span> Let
<span class="math inline">\(r \geqslant 0\)</span> and <span
class="math inline">\(\gamma \in \bar{G} - H\)</span>. Assume that <span
class="math inline">\(\tau \in \mathfrak{S}\)</span>. Define <span
class="math display">\[\mathcal{C}_\tau(r) = \left\{ g \in \bar{G} :
D_\tau(g) \leqslant r \right\},
    \quad
    D_\tau(g) := \max \paren{ \abs{\mathop{\mathrm{Ad}}\paren{g}
\tau-\tau}, \abs{\mathop{\mathrm{Ad}}\paren{g^{-1}} \tau, \tau}
}.\]</span> Then the integral <span class="math display">\[I := \int
_{x, y \in \Omega } u_1(x) u_2(y) 1_{\mathcal{G} \cap
\mathcal{C}_\tau(r)}  (x ^{-1} \gamma y) \,d x \, d y\]</span> satisfies
the estimate <span id="eq:i-leq-c" class="math display">\[\label{eq:i-leq-c}\tag{11.9}
    I \leqslant C r^{\dim_F(H)} \min \left( 1, \frac{r}{ d_H(\gamma)}
\right) \|u_1^0 \|_{L^2(\Omega \mathcal{Z} )} \|u_2^0 \|_{L^2(\Omega
\mathcal{Z})}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Theorem
15.1)</a>, specialized here to <span
class="math inline">\(({\mathop{\mathrm{GL}}}_{n+1}(\mathbb{R}),
{\mathop{\mathrm{GL}}}_n(\mathbb{R}))\)</span>. ◻</p>
</div>
<div id="thm:bilinear-forms-reformulated" class="theorem">
<p><strong>Theorem 200</strong> (Reformulation of Theorem <a
href="#thm:bilinear-forms-cited" data-reference-type="ref"
data-reference="thm:bilinear-forms-cited">199</a>). <em>Assume that
<span class="math inline">\(\tau\)</span> belongs to a fixed compact
subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>.
There are fixed bounded symmetric open neighborhoods <span
class="math inline">\(\mathcal{Z} \subseteq Z_H\)</span> and <span
class="math inline">\(\mathcal{G} \subseteq \bar{G}\)</span> of the
respective identity elements, which may be chosen arbitrarily small, for
which the following assertions hold. Let <span
class="math inline">\(\Omega\)</span> be a fixed compact subset of <span
class="math inline">\(H\)</span>. Let <span class="math inline">\(u_1 ^0
, u_2 ^0 : H \rightarrow \mathbb{R}_{\geqslant 0}\)</span> be
nonnegative measurable functions. Let <span class="math inline">\(r
\geqslant 0\)</span> and <span class="math inline">\(\gamma \in \bar{G}
- H\)</span>. Then <span id="eq:i-ll-rdim_fh" class="math display">\[\label{eq:i-ll-rdim_fh}\tag{11.10}
    I \ll r^{\dim(H)} \min \left( 1, \frac{r}{ d_H(\gamma)} \right)
\|u_1^0 \|_{L^2(\Omega \mathcal{Z} )} \|u_2^0 \|_{L^2(\Omega
\mathcal{Z})}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is an exercise in applying the axioms of IST
(§<a href="#sec:axioms-ist" data-reference-type="ref"
data-reference="sec:axioms-ist">2.1.2</a>). By transfer, Theorem <a
href="#thm:bilinear-forms-cited" data-reference-type="ref"
data-reference="thm:bilinear-forms-cited">199</a> holds upon restricting
quantification over the quantities <span
class="math inline">\(\mathfrak{S}\)</span> through <span
class="math inline">\(C\)</span> to be fixed. By idealization, we can
then commute quantification over <span class="math inline">\(C\)</span>
with the remaining quantifiers. We arrive in this way at the stated
reformulation. ◻</p>
</div>
<div id="prop:standard2:let-tau-belong" class="proposition">
<p><strong>Proposition 201</strong>. <em>Retain the setting of §<a
href="#sec:constr-test-vec-setup" data-reference-type="ref"
data-reference="sec:constr-test-vec-setup">6.1</a> – in particular,
<span class="math inline">\(\pi\)</span>, <span
class="math inline">\(T\)</span> and <span class="math inline">\(\tau =
\tau(\pi,\psi,T)\)</span> are defined. Let <span
class="math inline">\(\omega_0\)</span> be as furnished by Lemma <a
href="#lem:there-exists-begin" data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a>.
Suppose that <span class="math inline">\(\tau\)</span> belongs to a
fixed compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>.
There is a fixed bounded neighborhood <span
class="math inline">\(\mathcal{Z}\)</span> of the identity in <span
class="math inline">\(Z_H\)</span> with the following property. Let
<span class="math inline">\(\phi_{Z_H} \in
C_c^\infty(\mathcal{Z})\)</span> with <span
class="math inline">\(\|\phi_{Z_H}\|_{L^\infty} \ll 1\)</span>. For each
fixed compact <span class="math inline">\(\Omega \subseteq H\)</span>,
there is a fixed compact <span class="math inline">\(\Omega &#39;
\subseteq H\)</span> with the following property. Let <span
class="math inline">\(\Psi_1, \Psi_2 : H \rightarrow \mathbb{C}\)</span>
be continuous functions. Then for each <span
class="math inline">\(\gamma \in \bar{G} - H\)</span>, the integral
<span class="math display">\[I := \int _{x, y \in \Omega }
    \left\lvert
      (\Psi_1 \ast \phi_{Z_H})(x)
      (\Psi_2 \ast \phi_{Z_H})(y)
      \omega^\sharp(x^{-1} \gamma y)
    \right\rvert
    \, d x \, d y\]</span> satisfies the estimate <span
class="math display">\[I \ll
  T^{\mathop{\mathrm{rank}}(H)/2 + o(1)}
  \min\left( 1,
    \frac{T^{-1/2}}{ d_H(\gamma)}
  \right)
    \|\Psi_1\|_{L^2(\Omega&#39;)}
    \|\Psi_2\|_{L^2(\Omega&#39;)}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> We apply Theorem <a
href="#thm:bilinear-forms-reformulated" data-reference-type="ref"
data-reference="thm:bilinear-forms-reformulated">200</a> to any fixed
compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>
that contains <span class="math inline">\(\tau\)</span>. This
application yields <span class="math inline">\(\mathcal{Z}\)</span> and
<span class="math inline">\(\mathcal{G}\)</span>. Let <span
class="math inline">\(\phi_{Z_H}\)</span> and <span
class="math inline">\(\Omega\)</span> as in our hypotheses. Take for
<span class="math inline">\(\Omega &#39;\)</span> any fixed compact set
that contains <span class="math inline">\(\Omega \mathcal{Z}\)</span>.
Let <span class="math inline">\(\Psi_1, \Psi_2\)</span> and <span
class="math inline">\(\gamma\)</span> be as in our hypotheses. We will
verify that the stated estimate holds.</p>
<p>To that end, we first observe that for all <span
class="math inline">\(g \in \bar{G}\)</span> <span
class="math display">\[\omega^\sharp(g) \ll
    1_{\mathcal{G} \cap \mathcal{C}_\tau(T^{-1/2})}     T^{\dim(N) +
o(1)}.\]</span> This follows from parts of Lemma <a
href="#lem:there-exists-begin" data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a>.
Indeed, part <a href="#itm:lemma-exists-omega-2"
data-reference-type="eqref"
data-reference="itm:lemma-exists-omega-2">\((ii)\)</a>
implies that <span class="math inline">\(\omega ^\sharp(g)\)</span>
vanishes unless <span class="math inline">\(g = 1 + o(1)\)</span> and
<span class="math inline">\({\mathop{\mathrm{Ad}}}^*(g) \tau = \tau +
o(T^{-1/2})\)</span>, in which case <span class="math inline">\(g \in
\mathcal{G}\)</span> and <span class="math inline">\(D_\tau(g) \lll
T^{-1/2}\)</span>, hence <span class="math inline">\(g \in
\mathcal{C}_\tau\paren{T^{-1/2}}\)</span>, while part <a
href="#itm:lemma-exists-omega-3" data-reference-type="eqref"
data-reference="itm:lemma-exists-omega-3">\((iii)\)</a>
says that <span class="math inline">\(\|\omega^\sharp\|_{\infty} \ll
T^{\dim(N)+o(1)}\)</span>.</p>
<p>We now set <span class="math inline">\(u_j^0 := \Psi_j\)</span> and
define <span class="math inline">\(u_j\)</span> as in Theorem <a
href="#thm:bilinear-forms-reformulated" data-reference-type="ref"
data-reference="thm:bilinear-forms-reformulated">200</a>. Since <span
class="math inline">\(\lVert \phi_{Z_H} \rVert_{L^\infty} \ll
1\)</span>, we then have <span class="math inline">\(\abs{ \paren{\Psi_j
\ast \phi_{Z_H}}(x) } \ll u_j(x)\)</span>. Moreover, <span
class="math display">\[\lVert u_j^0 \rVert_{L^2(\Omega \mathcal{Z})}
\leqslant\lVert \Psi_j \rVert_{L^2(\Omega &#39;)}.\]</span> We conclude
via <a href="#eq:i-ll-rdim_fh" data-reference-type="eqref"
data-reference="eq:i-ll-rdim_fh">\((11.10)\)</a> and the identity
<span class="math inline">\(\dim(N) - \dim(H)/2 =
\mathop{\mathrm{rank}}(H)/2\)</span>. (For example, if <span
class="math inline">\((G,H) = ({\mathop{\mathrm{GL}}}_{n+1}(\mathbb{R}),
{\mathop{\mathrm{GL}}}_n(\mathbb{R}))\)</span>, then this reads <span
class="math inline">\(n(n+1)/2 - n^2/2 = n/2\)</span>.) ◻</p>
</div>
<h4 id="sec:book-keeping">§11.4. Book-keeping</h4>
<p>Here we complete the proof of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>.
Our main task is to collect and normalize estimates given
previously.</p>
<p>We retain the setup of §<a href="#sec:constr-test-vec-setup"
data-reference-type="ref"
data-reference="sec:constr-test-vec-setup">6.1</a>.</p>
<p>Let <span class="math display">\[W_T \in
\mathfrak{W}(\pi,\psi,T,\delta) \subseteq
\mathcal{W}(\pi,\psi_T),\]</span> <span class="math display">\[\gamma
\in \mathfrak{C}(H,-\theta_H(\psi^{-1}),T,\tfrac{1}{2})  \text{ and
}  \omega_0 \in C_c^\infty(G)\]</span> be as furnished by Lemma <a
href="#lem:there-exists-begin" data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a>.</p>
<p>Let <span class="math inline">\(\tau := \tau(\pi,T,\psi)\)</span> as
in §<a href="#sec:parameter-tau" data-reference-type="ref"
data-reference="sec:parameter-tau">2.3.3</a>. Let <span
class="math inline">\(\mathcal{Z} \subseteq Z_H\)</span> be the fixed
bounded subset of the identity furnished by Proposition <a
href="#prop:standard2:let-tau-belong" data-reference-type="ref"
data-reference="prop:standard2:let-tau-belong">201</a>. We fix <span
class="math inline">\(\phi_{Z_H} \in C_c^\infty(\mathcal{Z}) \subseteq
C_c^\infty(Z_H)\)</span> with <span class="math inline">\(\int_{Z_H}
\phi_{Z_H} = 1\)</span> with respect to the our fixed Haar measure on
<span class="math inline">\(Z_H\)</span>. We fix <span
class="math inline">\(\beta_0 \in \mathfrak{B}(A_H)^{W_H}\)</span> (§<a
href="#sec:class-mathfrakba" data-reference-type="ref"
data-reference="sec:class-mathfrakba">5.2</a>) with <span
class="math inline">\(\int_{A_H} \beta_0 = 1\)</span>. We define <span
class="math inline">\(\beta\)</span> to be the convolution <span id="eq:hx-:=-int" class="math display">\[\label{eq:hx-:=-int}\tag{11.11}
  \beta (x) := \int _{z \in Z_H} \beta_0(x z^{-1}) \phi_{Z_H}(z) \, d
z.\]</span> Then <span class="math inline">\(\beta\)</span> likewise
lies in <span class="math inline">\(\mathfrak{B}(A_H)^{W_H}\)</span> and
satisfies <span class="math inline">\(\int_{A_H} \beta = 1\)</span>.</p>
<p>We set <span class="math display">\[c_2 := T^{\dim(N_H)/4}\]</span>
and <span class="math display">\[f := c_2
\mathcal{J}_T[\psi^{-1},\beta_0,\gamma],
  \quad
  f_{\ast} := c_2 \mathcal{J}_T[\psi^{-1},\beta,\gamma].\]</span></p>
<p>We define <span class="math inline">\(a_T \in A \leqslant G\)</span>
by the formula <span id="eq:a_t-=-trho_n_hvee" class="math display">\[\label{eq:a_t-=-trho_n_hvee}\tag{11.12}
  a_T := T^{\rho_{N_H}^\vee} z_H(T^{\mathop{\mathrm{rank}}(G)/2}),
  \quad
  z_H(t) := \mathop{\mathrm{diag}}(t,t,\dotsc,t,1).\]</span> Explicitly,
if <span class="math inline">\((G,H) =
({\mathop{\mathrm{GL}}}_{n+1}(\mathbb{R}),
{\mathop{\mathrm{GL}}}_n(\mathbb{R}))\)</span>, then <span
class="math inline">\(a_T = \mathop{\mathrm{diag}}(T^{n}, T^{n-1},
\dotsc, T, 1)\)</span>; the equivalence of this formula with <a
href="#eq:a_t-=-trho_n_hvee" data-reference-type="eqref"
data-reference="eq:a_t-=-trho_n_hvee">\((11.12)\)</a> follows
from the identity of <span class="math inline">\((n+1)\)</span>-tuples
<span class="math display">\[\begin{align}
  &amp;\left( \frac{n-1}{2},
    \frac{n-3}{2},
    \dotsc,
    \frac{1-n}{2}, 0
  \right) \\
  &amp;\quad +
  \left( \frac{n + 1}{2}, \frac{n + 1}{2}, \dotsc,
    \frac{n + 1}{2}, 0\right)
    \\
  &amp;\quad =
  \left( n, n - 1, \dotsc, 1, 0 \right).
\end{align}\]</span></p>
<p>Set <span class="math display">\[W_1(g) := W_T(a_T^{-1} g).\]</span>
Then <span class="math inline">\(W_1 \in \mathcal{W}(\pi,\psi)\)</span>.
Set <span class="math display">\[e(H) := \langle \rho_{N_H},
\rho_{N_H}^\vee  \rangle.\]</span> Then <span
class="math inline">\(\delta_{N_H}(T^{\rho_N^\vee}) = T^{e(H)}\)</span>,
so the change of variables <span class="math inline">\(h \mapsto a_T
h\)</span> on <span class="math inline">\(N_H \backslash H\)</span> has
Jacobian <span class="math inline">\(T^{-e(H)}\)</span>, giving <span id="eq:int-_n_h-backslash" class="math display">\[\label{eq:int-_n_h-backslash}\tag{11.13}
  \int _{N_H \backslash H} |W_1|^2
  =
  T^{-e(H)}
  \int _{N_H \backslash H} |W_T|^2.\]</span> By <a
href="#eq:int-_n_h-backslash" data-reference-type="eqref"
data-reference="eq:int-_n_h-backslash">\((11.13)\)</a> and
assertion <a href="#item:lemma-there-exists-gamma-W-1"
data-reference-type="eqref"
data-reference="item:lemma-there-exists-gamma-W-1">\((i)\)</a>
of Lemma <a href="#lem:there-exists-begin" data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a>,
there exists <span class="math display">\[c_1 \asymp  T^{e(H)/2 -
\dim(Q_H)/4}.\]</span> so that <span class="math inline">\((\int_{N_H
\backslash H} |W_1|^2)^{1/2} \leqslant c_1^{-1}\)</span>. Thus <span
class="math display">\[W := c_1 W_1 \in \mathcal{W}(\pi,\psi)\]</span>
satisfies <span class="math inline">\(\int_{N_H \backslash H} |W|^2
\leqslant 1\)</span>.</p>
<p>We claim that the datum <span class="math inline">\((f, f_{\ast},
\phi_{Z_H}, W, \omega_0)\)</span> that we have constructed has the
required properties.</p>
<p>We verify first that each element lies in the required space.</p>
<ul>
<li><p>That <span class="math inline">\(f, f_{\ast}\)</span> lie in
<span class="math inline">\(\mathcal{S}^e(U_H \backslash
H)^{W_H}\)</span> is a consequence of Proposition <a
href="#lem:sub-gln:each-psi-beta" data-reference-type="ref"
data-reference="lem:sub-gln:each-psi-beta">155</a> and Lemma <a
href="#lem:each-f-in" data-reference-type="ref"
data-reference="lem:each-f-in">180</a>.</p></li>
<li><p>It is clear by construction that <span
class="math inline">\(W\)</span> is a smooth vector of norm <span
class="math inline">\(\leqslant 1\)</span>.</p></li>
<li><p>It is clear from <a href="#eq:g-in-g" data-reference-type="eqref"
data-reference="eq:g-in-g">\((11.5)\)</a> that <span
class="math inline">\(\omega_0\)</span> is supported in any fixed
neighborhood of the identity in <span
class="math inline">\(G\)</span>.</p></li>
</ul>
<p>We now check each numbered assertion from Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a> in
turn:</p>
<ol type="i">
<li><p>The identity <span class="math inline">\(f_{\ast}(g) = \int _{z
\in Z_H} f(g z^{-1}) \phi_{Z_H}(z) \, d z\)</span> is immediate from the
construction, using the equivariance property <a
href="#eq:lx-mathcald_psi-beta" data-reference-type="eqref"
data-reference="eq:lx-mathcald_psi-beta">\((9.5)\)</a>.</p></li>
<li><p>The arguments below apply just as well to <span
class="math inline">\(f\)</span> and to <span
class="math inline">\(f_{\ast}\)</span>.</p></li>
<li><p>We must check that for each fixed compact subset <span
class="math inline">\(\mathcal{D}\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span> and fixed <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, we
have the seminorm bound <span
class="math inline">\(\nu_{\mathcal{D},\ell,T}(f) \ll T^{o(1)}\)</span>.
Recalling from §<a href="#sec:local-sobolev-norms-prelims"
data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a> the definitions
of such seminorms, the required bound is a consequence of Lemma <a
href="#lem:scratch-research:let-f-in" data-reference-type="ref"
data-reference="lem:scratch-research:let-f-in">191</a>, which gives, for
fixed <span class="math inline">\(x_1,\dotsc,x_m \in
\mathop{\mathrm{Lie}}(H)\)</span>, <span
class="math display">\[\begin{align}
  \|R(x_1 \dotsb x_m) f[s]\|
  &amp;\asymp c_2 \left(\int_K \left\lvert R(x_1 \dotsb x_m)
\mathcal{J}_T[\psi^{-1},\beta,\gamma][s] \right\rvert^2\right)^{1/2} \\
  &amp;\ll c_2 T ^{\langle \rho_U^\vee, \Re(s) \rangle - \dim(N)/4 + m
+  o(1)} \langle s \rangle^{-\infty} \\
  &amp;= T ^{\langle \rho_U^\vee, \Re(s) \rangle + m + o(1)} \langle s
\rangle^{-\infty}.
\end{align}\]</span></p></li>
<li><p>We must now verify the claimed upper and lower bounds for local
zeta integrals. It it straightforward but tedious to deduce those bounds
from Lemma <a href="#lem:there-exists-begin" data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a>, as
follows. The change of variables <span class="math inline">\(g \mapsto
a_T g\)</span> on <span class="math inline">\(N_H \backslash H\)</span>,
with Jacobian <span class="math inline">\(T^{-e(H)}\)</span>, gives
<span class="math display">\[Z(W_1, f[s]) = T^{-e(H)} \int _{g \in N_H
\backslash H} W_1(a_T g) W[f[s], \psi^{-1}](a_T g) \, d g.\]</span> We
aim now to compare <span class="math inline">\(W[f[s], \psi^{-1}](a_T
g)\)</span> with <span class="math inline">\(W[f[s],
\psi_T^{-1}](g)\)</span>. Since <span class="math inline">\(f[s] : H
\rightarrow \mathbb{C}\)</span> has central character given by <span
class="math inline">\(\mathop{\mathrm{trace}}(s)\)</span>, we have <span
class="math display">\[W[f[s], \psi^{-1}](a_T g) = T
^{\mathop{\mathrm{rank}}(G) \mathop{\mathrm{trace}}(s)/2} W[f[s],
\psi^{-1}](T^{\rho_{N_H}^\vee} g).\]</span> By the identity <span
class="math inline">\(\rho_{N_H}^\vee = - \rho_{U_H}^\vee\)</span> and
Lemma <a href="#lem:phi-in-mathcalis" data-reference-type="ref"
data-reference="lem:phi-in-mathcalis">174</a>, we have <span
class="math display">\[W[f[s], \psi^{-1}](T^{\rho_{N_H}^\vee} g) =
T^{e(H)/2 - \rho_{U_H}^\vee(s)} W[f[s], \psi_T^{-1}](g).\]</span> We
obtain the desired comparison <span id="eq:z_1w_1-f-s" class="math display">\[\label{eq:z_1w_1-f-s}\tag{11.14}
  Z(W_1,f[s]) =
  T ^{\mathop{\mathrm{rank}}(G) \mathop{\mathrm{trace}}(s)/2 - e(H)/2 -
\rho_{Q_H}^\vee(s)}
  Z_T(W_T, f[s]).\]</span> By Lemma <a href="#lem:there-exists-begin"
data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a> and
<a href="#eq:z_1w_1-f-s" data-reference-type="eqref"
data-reference="eq:z_1w_1-f-s">\((11.14)\)</a>, we obtain <span id="eq:z_1w-f-0" class="math display">\[\label{eq:z_1w-f-0}\tag{11.15}
  Z(W,f[0]) \gg Z(c_1 W_1, f, 0) \gg c_1 c_2 T^{-e(H)/2
-\dim(N_H)/2}\]</span> and, for <span class="math inline">\(\Re(s) \ll
1\)</span>, <span id="eq:z_1w-f-s" class="math display">\[\label{eq:z_1w-f-s}\tag{11.16}
  Z(W,f[s]) \ll c_1 c_2 T^{-e(H)/2  - \dim(N_H)/2 +
\mathop{\mathrm{rank}}(G) \mathop{\mathrm{trace}}(s)/2 + o(1)} \langle s
\rangle^{-\infty}.\]</span> We calculate <span
class="math display">\[c_1 c_2 T^{-e(H)/2 - \dim(N_H)/2}
  \asymp
  T^{ - \dim(Q_H)/4 - \dim(N_H)/4}
  =
  T^{-\dim(H)/4}.\]</span> With this calculation, assertion <a
href="#itm:sub-gln:8" data-reference-type="eqref"
data-reference="itm:sub-gln:8">\((iv)\)</a> of Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>,
namely that <span class="math display">\[Z(W,f[0]) \gg T^{-
\dim(H)/4},\]</span> <span class="math display">\[\Re(s) \ll 1 \implies
Z(W,f[s]) \ll  T ^{\mathop{\mathrm{rank}}(G)
\mathop{\mathrm{trace}}(s)/2 - \dim(H)/4 + o(1) }
    (1 + |s|)^{-\infty },\]</span> follows from <a href="#eq:z_1w-f-0"
data-reference-type="eqref"
data-reference="eq:z_1w-f-0">\((11.15)\)</a> and <a
href="#eq:z_1w-f-s" data-reference-type="eqref"
data-reference="eq:z_1w-f-s">\((11.16)\)</a>.</p></li>
<li><p>The required estimate <span class="math inline">\(\|\pi(u) (
\pi(\omega_0) W - W)\| \ll T^{-\infty}\)</span> for fixed <span
class="math inline">\(u \in \mathfrak{U}(G)\)</span> is immediate from
the corresponding assertion of Lemma <a href="#lem:there-exists-begin"
data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a>.</p></li>
<li><p>The required estimate <span class="math inline">\(\int_{H}
|\omega^\sharp| \leqslant T^{\mathop{\mathrm{rank}}(H)/2 +
o(1)}\)</span> is likewise immediate from Lemma <a
href="#lem:there-exists-begin" data-reference-type="ref"
data-reference="lem:there-exists-begin">11.1</a>.</p></li>
<li><p>We must check that for each compact subset <span
class="math inline">\(\Omega_H\)</span> of <span
class="math inline">\(H\)</span>, there is a fixed compact subset <span
class="math inline">\(\Omega_H&#39;\)</span> of <span
class="math inline">\(H\)</span> with a certain property. We appeal to
Proposition <a href="#prop:standard2:let-tau-belong"
data-reference-type="ref"
data-reference="prop:standard2:let-tau-belong">201</a>. To see that the
latter is applicable, we observe that</p>
<ul>
<li><p><span class="math inline">\(\tau\)</span> belongs to a fixed
compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>,
in view of Lemma <a href="#lem:standard2:no-conductor-drop-vs-tau"
data-reference-type="ref"
data-reference="lem:standard2:no-conductor-drop-vs-tau">7.9</a>
and our assumption that the archimedean <span
class="math inline">\(L\)</span>-function parameters of <span
class="math inline">\(\pi\)</span> have magnitude <span
class="math inline">\(\asymp T\)</span>, and</p></li>
<li><p><span class="math inline">\(\phi_{Z_H} \in
C_c^\infty(Z_H)\)</span> is fixed, hence in particular <span
class="math inline">\(\|\phi_{Z_H}\|_{L^\infty} \ll 1\)</span>.</p></li>
</ul>
<p>Taking <span class="math inline">\(\Omega_H&#39;\)</span> as in the
conclusion of Proposition <a href="#prop:standard2:let-tau-belong"
data-reference-type="ref"
data-reference="prop:standard2:let-tau-belong">201</a>, the required
estimate is then precisely the content of that proposition.</p></li>
</ol>
<p>The proof of Theorem <a href="#thm:main-local-results"
data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a> is
now complete modulo the proof of Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>, which
is the subject of Part <a href="#part:asympt-analys-kirill"
data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>.</p>
<h1 id="part:asympt-analys-kirill">§3. Asymptotics of the Kirillov
model</h1>
<p>The purpose of this part is to supply the proof of Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>. The
proof is given at the end, in §<a href="#sec:proof-theor-refthm:b"
data-reference-type="ref"
data-reference="sec:proof-theor-refthm:b">6.11</a>, following several
preliminaries.</p>
<h3 id="sec:overview-asymp-kirillov">§12. Overview</h3>
<p>Here we summarize the main points of Part <a
href="#part:asympt-analys-kirill" data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>, without technicalities.
We retain the notation of §<a href="#sec:asympt-analys-local"
data-reference-type="ref"
data-reference="sec:asympt-analys-local">3</a>. In particular, <span
class="math inline">\(G = {\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>,
and <span class="math inline">\(P \leqslant G\)</span> denotes the
mirabolic subgroup. We are given a Whittaker function <span
class="math inline">\(W\)</span> that is compactly-supported in the
Kirillov model and transforms nicely under <span
class="math inline">\(P\)</span> (e.g., is a bump function with given
support); we would like to understand how <span
class="math inline">\(G\)</span> acts on <span
class="math inline">\(W\)</span>. Jacquet’s results, recalled in §<a
href="#sec:kirillov-model" data-reference-type="ref"
data-reference="sec:kirillov-model">3.1</a>, tell us that <span
class="math inline">\(W\)</span> is smooth under <span
class="math inline">\(G\)</span>. We would like to understand this
smoothness quantitively.</p>
<p>For example, if we differentiate <span
class="math inline">\(W\)</span> some finite number <span
class="math inline">\(m\)</span> times with respect to basis elements of
<span class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>, to what
extent does this increase the norm of <span
class="math inline">\(W\)</span>? It turns out that for the <span
class="math inline">\(W\)</span> of interest to us (elements of the
class <span
class="math inline">\(\mathfrak{W}(\pi,\psi,T,\delta)\)</span>), the
norm goes up by roughly a factor of <span
class="math inline">\(T^m\)</span>. A direct quantification of Jacquet’s
arguments (§<a href="#sec:empha-priori-bounds" data-reference-type="ref"
data-reference="sec:empha-priori-bounds">6.4</a>) gives instead an upper
bound of the form <span class="math inline">\(T^{C_m}\)</span> for some
<span class="math inline">\(C_m \geqslant 0\)</span>. For different
classes of <span class="math inline">\(W\)</span> than those considered
here (e.g., those relevant for “analytic newvector theory” <a href="#ref-JN19a 2020arXiv200109640J"
class="citation" data-cites="JN19a 2020arXiv200109640J">(Jana and Nelson
2019; Jana 2020)</a>), it is necessary to take <span
class="math inline">\(C_m\)</span> much larger than <span
class="math inline">\(m\)</span> (e.g., <span class="math inline">\(C_m
= T^{n m}\)</span> in the newvector setting), so the conclusion is not
completely formal. The <span class="math inline">\(p\)</span>-adic
analogue of this phenomenon is that the depth of a generic irreducible
representation can be (and often is) significantly smaller than the
conductor.</p>
<p>We will see, in fact, that the <span class="math inline">\(W\)</span>
of interest to us behave like approximate eigenfunctions under <span
class="math inline">\(\mathfrak{U}(G)\)</span>, with eigenvalue
described by the rescaling <span class="math inline">\(T \tau\)</span>
of the element <span class="math inline">\(\tau = \tau(\pi,\psi,T) \in
\mathfrak{g}^\wedge\)</span> as in Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>. This
feature is ultimately responsible for our proof that the function <span
class="math inline">\(\omega_0 \in C_c^\infty(G)\)</span> that we
construct approximately preserves <span class="math inline">\(W\)</span>
in the required sense.</p>
<p>The general theme of understanding <span
class="math inline">\(G\)</span>-behavior from <span
class="math inline">\(P\)</span>-behavior is a recurring one in the
theory of Whittaker functions for <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span>, fundamental to
the theory of newvectors and that of the Kirillov model itself, see for
instance <a href="#ref-MR620708 MR3138844 MR3001803" class="citation"
data-cites="MR620708 MR3138844 MR3001803">(H. Jacquet,
Piatetski-Shapiro, and Shalika 1981; Matringe 2013; Hervé Jacquet
2012)</a> and <a href="#ref-MR0425030 MR0579172 MR748505 MR1999922" class="citation"
data-cites="MR0425030 MR0579172 MR748505 MR1999922">(Bernšteı̆n and
Zelevinskiı̆ 1976; I. N. Bernstein and Zelevinsky 1977; J. N. Bernstein
1984; Baruch 2003a)</a>.</p>
<p>The basic idea underlying our approach to the study of <span
class="math inline">\(W\)</span> is as in Jacquet’s work. Let <span
class="math inline">\(E_{i j}\)</span> (<span class="math inline">\(1
\leqslant i, j \leqslant n\)</span>) denote the standard basis elements
of <span class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>,
regarded as degree one elements of <span
class="math inline">\(\mathfrak{U}(G)\)</span>. The elements indexed by
<span class="math inline">\(i &lt; n\)</span> lie in the Lie algebra of
the mirabolic subgroup <span class="math inline">\(P\)</span>, so their
action is very explicit; the problem is to understand how the “bottom
row” acts. On the other hand, we know that <span
class="math inline">\(\mathfrak{Z}(G)\)</span> acts via scalars,
described by the infinitesimal character <span
class="math inline">\(\lambda_\pi\)</span>. We can try to combine what
we know about the actions of <span
class="math inline">\(\mathop{\mathrm{Lie}}(P)\)</span> and <span
class="math inline">\(\mathfrak{Z}(G)\)</span> to say something about
that of <span
class="math inline">\(\mathop{\mathrm{Lie}}(G)\)</span>.</p>
<p>The <span class="math inline">\(n=2\)</span> case is particularly
simple, and has appeared in some form in the subconvexity literature
(see <a href="#ref-venkatesh-2005" class="citation" data-cites="venkatesh-2005">(Venkatesh 2010,
Lemma 8.4)</a>, <a href="#ref-michel-2009" class="citation"
data-cites="michel-2009">(Philippe Michel and Venkatesh 2010, sec.
3.2.5)</a>). We recall that case in detail, since it motivates what
we do below. The action of the central element <span
class="math inline">\(E_{1 1} + E_{2 2}\)</span> is described by the
central character of <span class="math inline">\(\pi\)</span>, so we
focus on the action of <span
class="math inline">\(\mathop{\mathrm{Lie}}({\mathop{\mathrm{SL}}}_2(\mathbb{R}))\)</span>.
The main point is then to understand the action of <span
class="math inline">\(E_{2 1}\)</span> in terms of that of <span
class="math inline">\(E_{12}\)</span> and <span class="math inline">\(h
:= E_{1 1} - E_{2 2}\)</span>. The Casimir element is given (up to
normalization) by <span id="eq:u-=-tfrac12" class="math display">\[\label{eq:u-=-tfrac12}\tag{12.1}
  u = \tfrac{1}{2} h^2 + E_{12} E_{21} + E_{2 1} E_{1 2}
  =\tfrac{1}{2}  h^2 - h + 2 E_{12} E_{21}.\]</span> In this case, we
can identify <span class="math inline">\(N_H \backslash H = H\)</span>
with <span
class="math inline">\({\mathop{\mathrm{GL}}}_1(\mathbb{R})\)</span> via
the map <span class="math inline">\(y \mapsto \begin{pmatrix}
  y &amp; 0 \\
  0 &amp; 1
\end{pmatrix}\)</span>. The Kirillov model of <span
class="math inline">\(\pi\)</span> is thus an embedding <span
class="math inline">\(\pi \hookrightarrow
L^2({\mathop{\mathrm{GL}}}_1(\mathbb{R}))\)</span>. Suppose that we have
defined this model using the character <span
class="math inline">\(\begin{pmatrix}
  1 &amp; x \\
  0 &amp; 1
\end{pmatrix} \mapsto e^{i x}\)</span>. Then the action of <span
class="math inline">\(\mathop{\mathrm{Lie}}(P)\)</span> in the Kirillov
model is given by <span class="math display">\[\pi(E_{12}) W(y) = i y
W(y),
  \quad
  \pi(h) W(y) = 2 y \partial_y W(y).\]</span> Suppose that the Casimir
element <span class="math inline">\(u\)</span> acts on <span
class="math inline">\(\pi\)</span> via the eigenvalue <span
class="math inline">\(\lambda\)</span>. Then, using <a
href="#eq:u-=-tfrac12" data-reference-type="eqref"
data-reference="eq:u-=-tfrac12">\((12.1)\)</a>, we obtain an
explicit formula for the action of <span class="math inline">\(E_{2
1}\)</span>, <span id="eq:pie_2-1-wy" class="math display">\[\label{eq:pie_2-1-wy}\tag{12.2}
  \pi(E_{2 1}) W(y) =
  \frac{1}{ 2 i y} \left(
    \lambda - \frac{1}{2} (2 y \partial_y)^2 + 2 y \partial_y
  \right) W(y),\]</span> which we can use to study <span
class="math inline">\(W\)</span> further. We remark that in this case,
the <span class="math inline">\(W\)</span> of interest to us are
essentially bump functions on <span class="math inline">\(y = T +
\operatorname{O}(T^{1/2})\)</span>, in representations with Casimir
eigenvalue <span class="math inline">\(\lambda\)</span> of size roughly
<span class="math inline">\(T^2\)</span>. We see from <a
href="#eq:pie_2-1-wy" data-reference-type="eqref"
data-reference="eq:pie_2-1-wy">\((12.2)\)</a> that applying <span
class="math inline">\(\pi(E_{21 })\)</span> to such an element <span
class="math inline">\(W\)</span> increases its norm by roughly a factor
of <span class="math inline">\(T\)</span>.</p>
<p>The simplifying feature of the <span
class="math inline">\(n=2\)</span> case is that the operator <span
class="math inline">\(\pi(E_{12})\)</span> is explicitly invertible. For
<span class="math inline">\(n \geqslant 3\)</span>, it seems unlikely to
us that the operators <span class="math inline">\(\pi(E_{n j})\)</span>
may be described quite as explicitly as in <a href="#eq:pie_2-1-wy"
data-reference-type="eqref"
data-reference="eq:pie_2-1-wy">\((12.2)\)</a>, e.g., as
differential operators with rational coefficients. Instead, we will
approximate the <span class="math inline">\(\pi(E_{n j})\)</span>, or
more precisely their action on the class of Whittaker functions of
interest, by convolution operators on <span
class="math inline">\(P\)</span> attached to well-behaved symbols on
<span class="math inline">\(\mathop{\mathrm{Lie}}(P)^\wedge\)</span>.
This is the content of Theorem <a href="#thm:g-via-p"
data-reference-type="ref" data-reference="thm:g-via-p">257</a> below. By
a “quantum analogue” of the proof of the uniqueness of <span
class="math inline">\(\tau = \tau(\pi, \psi, T)\)</span> (Lemma <a
href="#lem:construction-tau-from-theta" data-reference-type="ref"
data-reference="lem:construction-tau-from-theta">141</a>), we will
eventually deduce the required <span
class="math inline">\(G\)</span>-behavior of <span
class="math inline">\(W\)</span> from the known <span
class="math inline">\(P\)</span>-behavior. Jacquet’s results play an
important role in getting this argument started: they tell us that the
<span class="math inline">\(G\)</span>-behavior of <span
class="math inline">\(W\)</span> is “polynomial in <span
class="math inline">\(T\)</span>” §<a href="#sec:empha-priori-bounds"
data-reference-type="ref"
data-reference="sec:empha-priori-bounds">6.4</a>.</p>
<p>After understanding the behavior of <span
class="math inline">\(W\)</span> under <span
class="math inline">\(\mathfrak{U}(G)\)</span>, we will want to
construct the approximate idempotent <span
class="math inline">\(\omega_0 \in C_c^\infty(G)\)</span> for <span
class="math inline">\(W\)</span> required by Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>. We do
this using convolution operators on <span
class="math inline">\(G\)</span> attached to carefully-chosen symbols on
<span class="math inline">\(\mathop{\mathrm{Lie}}(G)^\wedge\)</span>. We
show first, using the approximate eigenvector property of <span
class="math inline">\(W\)</span> under <span
class="math inline">\(\mathfrak{U}(G)\)</span>, that for any symbol
taking the value <span class="math inline">\(1\)</span> on <span
class="math inline">\(T \tau + \operatorname{O}(T^{1/2})\)</span>, the
corresponding convolution operator nearly preserves <span
class="math inline">\(W\)</span>. We show next, using the action of the
center of the universal enveloping algebra, that such a symbol may be
truncated with negligible effect to within roughly <span
class="math inline">\(\operatorname{O}(1)\)</span> of the locus of the
infinitesimal character <span
class="math inline">\(\lambda_\pi\)</span>; this is the point of §<a
href="#sec:local-refin-symb" data-reference-type="ref"
data-reference="sec:local-refin-symb">4</a>. (This locus plays the role
of the coadjoint orbit in our setup – recall that <span
class="math inline">\(\pi\)</span> is not assumed tempered.) The
resulting truncation then yields the desired <span
class="math inline">\(\omega_0\)</span>.</p>
<h3 id="microlocal-analysis-on-lie-group-representations">Microlocal
analysis on Lie group representations</h3>
<p>Here we recall some of the results of <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, pt. 1
and 2)</a> and <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, secs.
8–§10)</a>. This review is non-exhaustive; we focus on what is needed
for the applications of this paper, adding a couple minor new points
along the way. In particular, we do not recall any results related to
the Kirillov character formula or trace norm estimates, as those do not
play a role in this paper.</p>
<h4 id="preliminaries-2">Preliminaries</h4>
<p>Fix a Lie group <span class="math inline">\(G\)</span>. We retain the
general notation of §<a href="#sec:parameters-stability"
data-reference-type="ref"
data-reference="sec:parameters-stability">2</a>. In particular, <span
class="math inline">\(\mathfrak{g}\)</span> denotes the Lie algebra and
<span class="math inline">\(\mathfrak{g}^\wedge = i \mathfrak{g}^* =
\mathop{\mathrm{Hom}}(\mathfrak{g},i \mathbb{R})\)</span> its Pontryagin
(equivalently, imaginary) dual. We denote typical elements of <span
class="math inline">\(\mathfrak{g}\)</span> (resp. <span
class="math inline">\(\mathfrak{g}^\wedge\)</span>) by <span
class="math inline">\(x,y,z\)</span> (resp. <span
class="math inline">\(\xi,\eta,\zeta,\tau\)</span>). We write <span
class="math inline">\(\langle x, \xi \rangle \in i \mathbb{R}\)</span>
for the result of the canonical pairing. In this section, we often
abbreviate <span class="math display">\[x \xi := \langle x, \xi
\rangle,\]</span> so that the <span
class="math inline">\(\mathop{\mathrm{U}}(1)\)</span>-valued pairing
between <span class="math inline">\(\mathfrak{g}\)</span> and <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> is given by <span
class="math inline">\((x,\xi) \mapsto e^{ x \xi}\)</span>.</p>
<p>The group <span class="math inline">\(G\)</span> acts on <span
class="math inline">\(\mathfrak{g}\)</span> via the adjoint
representation <span class="math inline">\(x \mapsto
\mathop{\mathrm{Ad}}(g) x\)</span> and on <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> via the coadjoint
representation <span class="math inline">\(\xi \mapsto
{\mathop{\mathrm{Ad}}}^*(g) \xi\)</span>. We often abbreviate <span
class="math inline">\(g \xi = {\mathop{\mathrm{Ad}}}^*(g) \xi\)</span>.
The Lie algebra <span class="math inline">\(\mathfrak{g}\)</span> acts
on <span class="math inline">\(\mathfrak{g}\)</span> via the adjoint
representation <span class="math inline">\({\mathop{\mathrm{ad}}}_x y =
[x,y]\)</span> and on <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> via the coadjoint
representation <span class="math inline">\({\mathop{\mathrm{ad}}}_x^*
\xi\)</span>. We often abbreviate the latter by <span
class="math inline">\([x,\xi]\)</span>.</p>
<p>For a Lie subgroup <span class="math inline">\(H\)</span> of <span
class="math inline">\(G\)</span>, we obtain a natural inclusion <span
class="math inline">\(\mathfrak{h} \leqslant\mathfrak{g}\)</span> and
restriction map <span class="math inline">\(\mathfrak{g}^\wedge
\twoheadrightarrow \mathfrak{h}^\wedge\)</span>. For <span
class="math inline">\(\xi \in \mathfrak{g}^\wedge\)</span>, we write
<span class="math inline">\(\xi_H \in \mathfrak{h}^\wedge\)</span> for
its restriction.</p>
<p>We fix Haar measures <span class="math inline">\(d x\)</span> on
<span class="math inline">\(\mathfrak{g}\)</span> and <span
class="math inline">\(d \xi\)</span> on <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> that are Fourier dual
in the sense that for Schwartz functions <span
class="math inline">\(a\)</span> on <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> and <span
class="math inline">\(\phi\)</span> on <span
class="math inline">\(\mathfrak{g}\)</span>, the Fourier transforms
given by <span class="math display">\[a^\vee(x) := \int _{\xi \in
\mathfrak{g} ^\wedge }
  a(\xi) e^{- x \xi} \, d \xi,
  \quad
  \phi^\wedge(\xi)
  = \int _{x \in \mathfrak{g} }
  \phi(x)
  e^{x \xi} \, d x\]</span> define mutually inverse transforms.</p>
<h4 id="wavelength-parameters">Wavelength parameters</h4>
<p>Let <span class="math inline">\(\mathop{\mathrm{h}}\in
(0,1]\)</span>. We regard <span
class="math inline">\(\mathop{\mathrm{h}}\)</span> as a “wavelength
parameter.” For any function <span class="math inline">\(a\)</span> on
<span class="math inline">\(\mathfrak{g}^\wedge\)</span>, we define its
rescaling <span class="math inline">\(a_{\mathop{\mathrm{h}}}(\xi) :=
a(\mathop{\mathrm{h}}\xi)\)</span>.</p>
<h4 id="symbol-classes">Symbol classes</h4>
<p>The following definitions come from <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 9)</a>. We
simply recall the definitions here, referring to the cited reference for
further discussion, intuition and motivation.</p>
<p>In what follows, we repeatedly use the notation <span
class="math display">\[\langle \xi \rangle := (1 +
|\xi|^2)^{1/2}.\]</span></p>
<h5 id="underlying-spaces">Underlying spaces</h5>
<p>For each integer <span class="math inline">\(m \in
\mathbb{Z}\)</span> and multi-index <span class="math inline">\(\alpha
\in \mathbb{Z}_{\geqslant 0}^{\dim(\mathfrak{g})}\)</span> (§<a
href="#sec:multi-index-notation" data-reference-type="ref"
data-reference="sec:multi-index-notation">1.1.3</a>), we define a
seminorm <span class="math inline">\(\nu_{m,\alpha}\)</span> on <span
class="math inline">\(C^\infty(\mathfrak{g}^\wedge)\)</span> by <span
class="math display">\[\nu_{m,\alpha}(a) := \sup_{\xi \in
\mathfrak{g}^\wedge}
  \langle \xi \rangle^{|\alpha| - m} \left\lvert \partial^\alpha a(\xi)
\right\rvert,\]</span> where</p>
<ul>
<li><p><span class="math inline">\(|\alpha| := \sum \alpha_j\)</span>
denotes the order of <span class="math inline">\(\alpha\)</span>,
and</p></li>
<li><p><span class="math inline">\(\partial^\alpha\)</span> denotes the
differential operator defined using some fixed basis of <span
class="math inline">\(\mathfrak{g}^\wedge\)</span>.</p></li>
</ul>
<p>We denote by <span class="math inline">\(\underline{S}^m \subseteq
C^\infty(\mathfrak{g}^\wedge)\)</span> the subspace on which <span
class="math inline">\(\nu_{m,\alpha}\)</span> is finite-valued for all
<span class="math inline">\(\alpha\)</span>. We extend this definition
to <span class="math inline">\(m = \pm \infty\)</span> by taking the
union or intersection over all integers <span
class="math inline">\(m\)</span>. Then <span
class="math inline">\(\underline{S}^m\)</span> is naturally a Frechet
space for <span class="math inline">\(m &lt; \infty\)</span> and an
inductive limit of such spaces for <span class="math inline">\(m =
\infty\)</span>. We note that <span
class="math inline">\(\underline{S}^{-\infty}\)</span> is the Schwartz
space.</p>
<h5 id="basic-classes">Basic classes</h5>
<p>For fixed <span class="math inline">\(m \in \mathbb{Z}\)</span>, we
denote by <span class="math inline">\(S^m_\delta \subseteq
\underline{S}^{\infty}\)</span> the subclass consisting of <span
class="math inline">\(a \in \underline{S}^\infty\)</span> for which
<span class="math display">\[\nu_{m,\alpha}(a) \ll
{\mathop{\mathrm{h}}}^{-\delta |\alpha|}\]</span> for each fixed <span
class="math inline">\(\alpha\)</span>. We write more verbosely <span
class="math inline">\(S_\delta^m(\mathfrak{g}^\wedge)\)</span> or <span
class="math inline">\(S_\delta^m[\mathop{\mathrm{h}}]\)</span> or <span
class="math inline">\(S_\delta^m(\mathfrak{g}^\wedge)[\mathop{\mathrm{h}}]\)</span>
when we wish to indicate the group and/or wavelength parameter under
consideration.</p>
<p>We write <span class="math inline">\(S_{\delta}^{-\infty}\)</span>
for the intersection of the classes <span
class="math inline">\(S^m_\delta\)</span> taken over all fixed <span
class="math inline">\(m\)</span>.</p>
<p>For a scalar <span class="math inline">\(c\)</span>, we write <span
class="math inline">\(c S_\delta^m\)</span> for the class <span
class="math inline">\(\{c v : v \in S_\delta^m\}\)</span>. We write
<span class="math inline">\({\mathop{\mathrm{h}}}^\infty
S_\delta^m\)</span> for the intersection over all fixed <span
class="math inline">\(N\)</span> of the classes <span
class="math inline">\({\mathop{\mathrm{h}}}^N S_\delta^m\)</span>.</p>
<h5 id="the-negligible-class">The negligible class</h5>
<p>The class <span class="math inline">\({\mathop{\mathrm{h}}}^\infty
S_\delta^{-\infty}\)</span> is independent of <span
class="math inline">\(\delta\)</span>; it consists of <span
class="math inline">\(a \in \underline{S}^\infty\)</span> satisfying
<span class="math inline">\(\partial^\alpha a(\xi) \ll
{\mathop{\mathrm{h}}}^N \langle \xi  \rangle^{-N}\)</span> for all fixed
<span class="math inline">\(\alpha\)</span> and <span
class="math inline">\(N\)</span>. We denote this class simply by <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty
S^{-\infty}\)</span>.</p>
<h5 id="sec:refined-classes">§13.3.4. Refined classes</h5>
<p>Suppose now that <span class="math inline">\(G\)</span> is connected
reductive, so that the notation <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>
from §<a href="#sec:regular-elements" data-reference-type="ref"
data-reference="sec:regular-elements">2.1.1</a> applies. Assume also
that <span class="math inline">\(\mathop{\mathrm{h}}\lll 1\)</span>.</p>
<p>Let <span class="math inline">\(\tau \in
\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>. We denote by <span
class="math inline">\(\mathfrak{g}_{\tau} \subseteq
\mathfrak{g}\)</span> the <span
class="math inline">\(\mathfrak{g}\)</span>-centralizer of <span
class="math inline">\(\tau\)</span>. We denote by <span
class="math inline">\(\mathfrak{g}_\tau^{\perp} \subseteq
\mathfrak{g}^\wedge\)</span> the complement of <span
class="math inline">\(\mathfrak{g}_\tau\)</span> with respect to the
canonical bilinear pairing between <span
class="math inline">\(\mathfrak{g}\)</span> and <span
class="math inline">\(\mathfrak{g}^\wedge\)</span>. We fix an inner
product on <span class="math inline">\(\mathfrak{g}^\wedge\)</span>,
hence a dual inner product on <span
class="math inline">\(\mathfrak{g}\)</span>. This choice defines
orthogonal complements <span
class="math inline">\(\mathfrak{g}_{\tau}^{\flat}\)</span> (resp. <span
class="math inline">\(\mathfrak{g}_\tau^{\perp \flat}\)</span>) to <span
class="math inline">\(\mathfrak{g}_\tau\)</span> (resp. <span
class="math inline">\(\mathfrak{g}_\tau^{\perp}\)</span>), hence
orthogonal direct sum decompositions <span id="eq:mathfr-=-mathfr" class="math display">\[\label{eq:mathfr-=-mathfr}\tag{13.1}
  \mathfrak{g}^\wedge = \mathfrak{g}_\tau^\perp \oplus
\mathfrak{g}_\tau^{\perp \flat},
  \quad
  \mathfrak{g} = \mathfrak{g}_\tau^{\flat} \oplus
\mathfrak{g}_\tau.\]</span> Given <span class="math inline">\(\xi \in
\mathfrak{g}^\wedge\)</span> (resp. <span class="math inline">\(x \in
\mathfrak{g}^\wedge\)</span>), we write <span
class="math display">\[(\xi &#39;, \xi &#39;&#39; ) \in
\mathfrak{g}_\tau^{\perp} \times \mathfrak{g}_{\tau}^{\perp \flat}
  \quad
  \text{
    (resp.
    $(x &#39;, x &#39;&#39; ) \in \mathfrak{g}_\tau^{\flat}
\times  \mathfrak{g}_\tau$)
  }\]</span> for the coordinates with respect to <a
href="#eq:mathfr-=-mathfr" data-reference-type="eqref"
data-reference="eq:mathfr-=-mathfr">\((13.1)\)</a>. We call
these the <em><span class="math inline">\(\tau\)</span>-coordinates</em>
of <span class="math inline">\(\xi\)</span> (resp. <span
class="math inline">\(x\)</span>).</p>
<p>The inner products on <span
class="math inline">\(\mathfrak{g}\)</span> and <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> induce inner products
on each of the subspaces in <a href="#eq:mathfr-=-mathfr"
data-reference-type="eqref"
data-reference="eq:mathfr-=-mathfr">\((13.1)\)</a>. We choose
orthonormal bases for each of these subspaces, hence Euclidean
coordinates with respect to which we employ multi-index notation (§<a
href="#sec:multi-index-notation" data-reference-type="ref"
data-reference="sec:multi-index-notation">1.1.3</a>) in what
follows.</p>
<p>Let <span class="math inline">\(\delta &#39;, \delta
&#39;&#39;\)</span> be fixed quantities with <span
class="math inline">\(0 &lt; \delta &#39; &lt; \delta &#39;&#39; &lt; 2
\delta &#39; &lt; 1\)</span>, and let <span
class="math inline">\(\tau\)</span> be an element of <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> that belongs to some
fixed compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>.
We define <span class="math inline">\(S^{\tau}_{\delta &#39;, \delta
&#39;&#39;} \subseteq \underline{S}^{-\infty}\)</span> (more verbosely,
<span class="math inline">\(S_{\delta &#39;, \delta
&#39;&#39;}^{\tau}(\mathfrak{g}^\wedge)\)</span>, etc.) to be the
subclass consisting of elements that are</p>
<ul>
<li><p>supported on <span class="math inline">\(\tau +
\operatorname{O}({\mathop{\mathrm{h}}}^{ \delta &#39;&#39; - \delta
&#39;})\)</span>, and</p></li>
<li><p>satisfy, in <span
class="math inline">\(\tau\)</span>-coordinates, the derivative bounds
<span id="eq:partial_xi--alpha" class="math display">\[\label{eq:partial_xi--alpha}\tag{13.2}
    \partial_{\xi &#39;} ^{\alpha } \partial _{\xi &#39;&#39;} ^{\beta }
a (\xi) \ll {\mathop{\mathrm{h}}}^{- \delta &#39; |\alpha| - \delta
&#39;&#39; |\beta|}\]</span> for all fixed multi-indices <span
class="math inline">\((\alpha,\beta) \in \mathbb{Z}_{\geqslant
0}^{\dim(\mathfrak{g}) - \mathop{\mathrm{rank}}(\mathfrak{g})} \times
\mathbb{Z}_{\geqslant
0}^{\mathop{\mathrm{rank}}(\mathfrak{g})}\)</span>.</p></li>
</ul>
<p>A convenient criterion for checking membership in the classes <span
class="math inline">\(S^\tau_{\delta &#39;, \delta &#39;&#39;}\)</span>
is given as follows.</p>
<div id="lem:basepoint-insensitivity" class="lemma">
<p><strong>Lemma 202</strong>. With notation as above, let <span
class="math inline">\(\tau_1, \tau_2\)</span> be elements of <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> that belong to some
fixed compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{reg}\)</span>. If <span id="eq:tau_1-=-tau_2" class="math display">\[\label{eq:tau_1-=-tau_2}\tag{13.3}
    \tau_1 = \tau_2 + \operatorname{O}({\mathop{\mathrm{h}}}^{\delta
&#39;&#39; - \delta &#39;}),\]</span> then <span
class="math inline">\(S_{\delta &#39;, \delta &#39;&#39;}^{\tau_1} =
S_{\delta &#39;, \delta &#39;&#39;}^{\tau_2}\)</span>; otherwise, <span
class="math inline">\(S^{\tau_1}_{\delta&#39;, , \delta &#39;&#39;} \cap
S^{\tau_2}_{\delta&#39;, , \delta &#39;&#39;} = \{0\}\)</span>. More
precisely, if <a href="#eq:tau_1-=-tau_2" data-reference-type="eqref"
data-reference="eq:tau_1-=-tau_2">\((13.3)\)</a> holds, then for
each smooth function <span class="math inline">\(a : \mathfrak{g}^\wedge
\rightarrow \mathbb{C}\)</span> and each <span class="math inline">\(\xi
= \tau_j + \operatorname{O}({\mathop{\mathrm{h}}}^{\delta &#39;&#39; -
\delta &#39;})\)</span>, the estimate <a href="#eq:partial_xi--alpha"
data-reference-type="eqref"
data-reference="eq:partial_xi--alpha">\((13.2)\)</a> holds
with respect to <span class="math inline">\(\tau_1\)</span>-coordinates
if and only if it holds with respect to <span
class="math inline">\(\tau_2\)</span>-coordinates.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This is <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Lemma
9.9)</a>. ◻</p>
</div>
<h4 id="cutoffs">Cutoffs</h4>
<h5 id="basic-definition-1">Basic definition</h5>
<p>We fix a small enough symmetric neighborhood <span
class="math inline">\(\mathcal{G}_0\)</span> of the origin <span
class="math inline">\(\mathfrak{g}\)</span>. We assume in particular
that <span class="math display">\[x \ast y := \log(\exp(x)
\exp(y))\]</span> is defined and analytic for <span
class="math inline">\((x,y) \in \mathcal{G}_0 \times
\mathcal{G}_0\)</span>. By a <em>cutoff</em>, we mean a smooth function
<span class="math inline">\(\chi : \mathfrak{g} \rightarrow
[0,1]\)</span> that is supported on <span
class="math inline">\(\mathcal{G}_0\)</span>, satisfies <span
class="math inline">\(\chi(x) = \chi(-x)\)</span>, and is identically
<span class="math inline">\(1\)</span> in some (not necessarily fixed)
neighborhood of the origin.</p>
<p>It will always be possible, and often convenient, to choose the
cutoff supported arbitrarily close to the origin. In practice, we will
work with cutoffs supported on elements of size <span
class="math inline">\(o(1)\)</span>, or much smaller.</p>
<p>Fix a slightly smaller fixed symmetric bounded neighborhood <span
class="math inline">\(\mathcal{G}_1\)</span> with the property that the
closure of <span class="math inline">\(\mathcal{G}_1
\mathcal{G}_1\)</span> is contained in <span
class="math inline">\(\mathcal{G}_0\)</span>. Similarly construct <span
class="math inline">\(\mathcal{G}_2, \mathcal{G}_3, \dotsc\)</span>,
with each bearing the same relationship to the previous as <span
class="math inline">\(\mathcal{G}_1\)</span> does to <span
class="math inline">\(\mathcal{G}_0\)</span>. Then for any cutoffs <span
class="math inline">\(\chi_1, \chi_2\)</span> supported in <span
class="math inline">\(\mathcal{G}_{n+1}\)</span>, we may find a cutoff
<span class="math inline">\(\chi &#39;\)</span> supported on <span
class="math inline">\(\mathcal{G}_n\)</span> with the property that
<span class="math inline">\(\chi &#39; (x \ast y) = 1\)</span> whenever
<span class="math inline">\(\chi_1(x) \chi_2(y) \neq 0\)</span>.</p>
<h5 id="basic-quantitative-variant">Basic quantitative variant</h5>
<p>For fixed <span class="math inline">\(\delta \in (0, 1]\)</span>, we
denote by <span class="math inline">\(\mathcal{X}_{\delta}\)</span>, or
<span class="math inline">\(\mathcal{X}_\delta(\mathfrak{g})\)</span>
when we wish to explicate the group under consideration, the class of
cutoffs <span class="math inline">\(\chi\)</span> on <span
class="math inline">\(\mathfrak{g}\)</span> for which</p>
<ul>
<li><p><span class="math inline">\(\chi(x) = 1\)</span> for <span
class="math inline">\(x = o({\mathop{\mathrm{h}}}^{1 - \delta})\)</span>,
and</p></li>
<li><p><span class="math inline">\(\partial^{\alpha} \chi(x) \ll
{\mathop{\mathrm{h}}}^{-\operatorname{O}(1)}\)</span> for each fixed <span
class="math inline">\(\alpha\)</span>.</p></li>
</ul>
<p>The first condition may be reformulated as follows: there is a fixed
<span class="math inline">\(r &gt; 0\)</span> so that <span
class="math inline">\(\chi(x) = 1\)</span> for <span
class="math inline">\(|x| \leqslant r {\mathop{\mathrm{h}}}^{1 -
\delta}\)</span>. It is easy to see that for each <span
class="math inline">\(\chi_1, \chi_2 \in \mathcal{X}_{\delta}\)</span>
supported in <span class="math inline">\(\mathcal{G}_{n+1}\)</span> for
some fixed <span class="math inline">\(n\)</span>, there exists <span
class="math inline">\(\chi &#39; \in \mathcal{X}_{\delta}\)</span>
supported in <span class="math inline">\(\mathcal{G}_n\)</span> so that
<span class="math inline">\(\chi &#39;(x \ast y) = 1\)</span> whenever
<span class="math inline">\(\chi_1(x) \chi_2(y) \neq 0\)</span>.</p>
<p>For fixed <span class="math inline">\(\delta \in [0,1)\)</span>, we
say that a cutoff <span class="math inline">\(\chi\)</span> is <em><span
class="math inline">\(\delta\)</span>-admissible</em> if it lies in
<span class="math inline">\(\mathcal{X}_{\delta_+}\)</span> for some
fixed <span class="math inline">\(\delta_+ &gt; \delta\)</span>. For
example, any fixed cutoff is <span
class="math inline">\(\delta\)</span>-admissible. The point of this
definition is that it captures the essential support properties of the
Fourier transforms of symbols in <span
class="math inline">\(S_\delta^\infty\)</span>.</p>
<div id="lem:fix-0-leq" class="lemma">
<p><strong>Lemma 203</strong>. Fix <span class="math inline">\(0
\leqslant\delta &lt; 1\)</span>. Let <span class="math inline">\(a \in
S_\delta^{\infty}\)</span>. Let <span
class="math inline">\(\chi\)</span> be a <span
class="math inline">\(\delta\)</span>-admissible cutoff. Define <span id="eq:a-:=-chi" class="math display">\[\label{eq:a-:=-chi}\tag{13.4}
    a&#39; := (\chi a_{\mathop{\mathrm{h}}}^\vee)^\wedge.\]</span> Then
<span id="eq:a-equiv-pmodhinfty" class="math display">\[\label{eq:a-equiv-pmodhinfty}\tag{13.5}
    a&#39; \equiv a \mod{{\mathop{\mathrm{h}}}^\infty S^{-\infty} \cap
\underline{S}^{-\infty}}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> As noted in <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
8.2)</a>, one sees by repeated partial integration that the symbol
<span class="math inline">\(a\)</span> admits a distributional Fourier
transform, smooth away from the origin, that decays rapidly, together
with all derivatives, outside the support of <span
class="math inline">\(\chi\)</span>. More precisely, <span
class="math display">\[\partial^{\alpha} ((\chi - 1)
a_{\mathop{\mathrm{h}}}^\vee) (x) \ll {\mathop{\mathrm{h}}}^N \left\langle
x \right\rangle^{-N}\]</span> for each fixed <span
class="math inline">\(\alpha\)</span> and <span
class="math inline">\(N\)</span>. The required bound then follows by
repeated integration by parts in the definition of the Fourier
integral. ◻</p>
</div>
<h5 id="refined-quantitative-variant">Refined quantitative variant</h5>
<p>An analogous discussion applies to the refined symbol classes. Let
<span class="math inline">\(\tau\)</span> belong to some fixed compact
subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>,
and let <span class="math inline">\(0 &lt; \delta &#39; &lt; \delta
&#39;&#39; &lt; 2 \delta &#39;&#39; &lt; 1\)</span> be fixed. Using
<span class="math inline">\(\tau\)</span>-coordinates on <span
class="math inline">\(\mathfrak{g}\)</span> (§<a
href="#sec:refined-classes" data-reference-type="ref"
data-reference="sec:refined-classes">2.3.4</a>), we define for <span
class="math inline">\(r &gt; 0\)</span> the set <span
class="math display">\[\mathcal{D} (r) := \left\{ x \in \mathfrak{g} :
|x&#39;| \leqslant r {\mathop{\mathrm{h}}}^{1 - \delta &#39;},
|x&#39;&#39;| \leqslant r {\mathop{\mathrm{h}}}^{1 - \delta &#39;&#39;}
\right\}.\]</span> We denote by <span
class="math inline">\(\mathcal{X}_{\tau,\delta &#39;, \delta
&#39;&#39;}\)</span> (more verbosely, <span
class="math inline">\(\mathcal{X}_{\tau, \delta &#39;, \delta
&#39;&#39;}(\mathfrak{g})\)</span>) the class of cutoffs <span
class="math inline">\(\chi\)</span> on <span
class="math inline">\(\mathfrak{g}\)</span> such that</p>
<ul>
<li><p>there is a fixed <span class="math inline">\(r &gt; 0\)</span> so
that <span class="math inline">\(\chi(x) = 1\)</span> for <span
class="math inline">\(x \in \mathcal{D}(r)\)</span>, and</p></li>
<li><p><span class="math inline">\(\partial^{\alpha} \chi(x) \ll
{\mathop{\mathrm{h}}}^{-\operatorname{O}(1)}\)</span> for each fixed <span
class="math inline">\(\alpha\)</span>.</p></li>
</ul>
<p>We say that a cutoff <span class="math inline">\(\chi\)</span> is
<em><span class="math inline">\((\tau, \delta &#39;, \delta
&#39;&#39;)\)</span>-admissible</em> if it lies in <span
class="math inline">\(\mathcal{X}_{\tau, \delta &#39;_+, \delta
&#39;&#39;_+}\)</span> for some fixed <span
class="math inline">\(\delta&#39;_+ &gt; \delta &#39;\)</span> and <span
class="math inline">\(\delta &#39;&#39;_+ &gt; \delta
&#39;&#39;\)</span>. We have the following analogue of Lemma <a
href="#lem:fix-0-leq" data-reference-type="ref"
data-reference="lem:fix-0-leq">203</a>, which follows again by partial
integration (compare with <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
(14.6))</a>).</p>
<div id="lem:let-tau-belong" class="lemma">
<p><strong>Lemma 204</strong>. Let <span
class="math inline">\(\tau\)</span> belong to a fixed compact subset of
<span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>,
and let <span class="math inline">\(0 &lt; \delta &#39; &lt; \delta
&#39;&#39; &lt; 2 \delta &#39; &lt; 1\)</span> be fixed. Let <span
class="math inline">\(a \in S^\tau_{\delta &#39;, \delta
&#39;&#39;}\)</span>. Let <span class="math inline">\(\chi\)</span> be a
<span class="math inline">\((\chi,\delta &#39;, \delta
&#39;&#39;)\)</span>-admissible cutoff. Define <span
class="math inline">\(a&#39;\)</span> as in <a href="#eq:a-:=-chi"
data-reference-type="eqref"
data-reference="eq:a-:=-chi">\((13.4)\)</a>. Then <a
href="#eq:a-equiv-pmodhinfty" data-reference-type="eqref"
data-reference="eq:a-equiv-pmodhinfty">\((13.5)\)</a>
holds.</p>
</div>
<h4 id="sec:star-product">§13.5. Star product</h4>
<h5 id="sec:four-transf-basic">§13.5.1. Fourier transform and basic
definition</h5>
<p>Recall that for any function <span class="math inline">\(a : G
\rightarrow \mathbb{C}\)</span>, we define its rescaling <span
class="math inline">\(a_{\mathop{\mathrm{h}}}\)</span> by the formula
<span class="math inline">\(a_{\mathop{\mathrm{h}}}(\xi) :=
a(\mathop{\mathrm{h}}\xi)\)</span>. If <span
class="math inline">\(a\)</span> is integrable, then its rescaled
inverse Fourier transform <span
class="math inline">\(a_{\mathop{\mathrm{h}}}^\vee :=
(a_{\mathop{\mathrm{h}}})^\vee\)</span> is given explicitly by <span
class="math inline">\(a_{\mathop{\mathrm{h}}}^\vee(x) =
{\mathop{\mathrm{h}}}^{-\dim(\mathfrak{g})}
a^\vee(x/\mathop{\mathrm{h}})\)</span>. Multiplying the latter by a
cutoff <span class="math inline">\(\chi\)</span> defines a
compactly-supported function <span class="math inline">\(\chi
a_{\mathop{\mathrm{h}}}^\vee\)</span> on <span
class="math inline">\(\mathfrak{g}\)</span>. More canonically, we obtain
a compactly-supported measure <span class="math inline">\(\chi
a_{\mathop{\mathrm{h}}}^\vee \, d x\)</span> on <span
class="math inline">\(\mathfrak{g}\)</span>. We denote by <span
class="math display">\[\widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\]</span>
the compactly-supported measure on <span
class="math inline">\(G\)</span> obtained via pushforward under the
exponential map of <span class="math inline">\(\chi
a_{\mathop{\mathrm{h}}}^\vee \, d x\)</span>. This measure assigns to
any test function <span class="math inline">\(\phi\)</span> on <span
class="math inline">\(G\)</span> the integral <span
class="math display">\[\int _{x \in \mathfrak{g} } \chi(x)
a_{\mathop{\mathrm{h}}}^\vee(x) \phi(\exp(x)) \, d x.\]</span> When
<span class="math inline">\(G\)</span> is unimodular, we will often
identify <span
class="math inline">\(\widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span>
with the function on <span class="math inline">\(G\)</span> obtained by
dividing by some fixed Haar measure <span class="math inline">\(d
g\)</span> on <span class="math inline">\(G\)</span>. The choice of
wavelength parameter <span
class="math inline">\(\mathop{\mathrm{h}}\)</span> and cutoff <span
class="math inline">\(\chi\)</span> is often clear by context; in such
cases, we abbreviate <span
class="math inline">\(\widetilde{\mathop{\mathrm{Op}}}(a) :=
\widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span>.</p>
<p>The convolution of such measures is described by a certain billinear
operator <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span>, called the
(rescaled) <em>star product</em>, for which <span id="eq:widet-ast-widet" class="math display">\[\label{eq:widet-ast-widet}\tag{13.6}
  \widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_1) \ast
  \widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(b:\chi_2)
  =
  \widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a
\star_{\mathop{\mathrm{h}}} b:\chi&#39;)\]</span> if <span
class="math inline">\(\chi_1, \chi_2, \chi &#39;\)</span> are cutoffs
for which <span class="math inline">\(\chi &#39; (x \ast y) = 1\)</span>
when <span class="math inline">\(\chi_1(x) \chi_2(y) \neq 0\)</span>.
Explicitly, <span class="math display">\[a \star_{\mathop{\mathrm{h}}} b
= \chi_1 a_{\mathop{\mathrm{h}}}^\vee \star \chi_2
b_{\mathop{\mathrm{h}}}^\vee,\]</span> where on the RHS, <span
class="math inline">\(\star\)</span> denotes the result of taking the
measures <span class="math inline">\(\chi_{1}
a_{\mathop{\mathrm{h}}}^\vee \, d x\)</span> and <span
class="math inline">\(\chi_{2} b_{\mathop{\mathrm{h}}}^\vee \, d
y\)</span> on <span class="math inline">\(\mathfrak{g}\)</span>, pushing
them forward to <span class="math inline">\(G\)</span>, convolving them,
and then pulling the result back to <span
class="math inline">\(\mathfrak{g}\)</span> (see <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 8.7)</a> or
<a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P. D. Nelson and
Venkatesh 2021, sec. 2.5)</a> for details). It is clear that <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span> defines a
continuous bilinear operation on the Schwartz space <span
class="math inline">\(\mathcal{S}(\mathfrak{g}^\wedge)\)</span>. It
depends upon <span class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span>; we suppress this dependence from
our notation because it is mild (e.g., in the senses quantified by
Lemmas <a href="#lem:fix-0-leq" data-reference-type="ref"
data-reference="lem:fix-0-leq">203</a>, <a href="#lem:let-tau-belong"
data-reference-type="ref" data-reference="lem:let-tau-belong">204</a>,
<a href="#lem:fix-delta-in-1" data-reference-type="ref"
data-reference="lem:fix-delta-in-1">218</a>, <a
href="#lem:fix-delta-in-2" data-reference-type="ref"
data-reference="lem:fix-delta-in-2">219</a>).</p>
<h5 id="sec:formal-expansion">§13.5.2. Formal expansion</h5>
<p>The star product admits a formal asymptotic expansion <span
class="math display">\[a \star_{\mathop{\mathrm{h}}} b \sim \sum_{j
\geqslant 0} {\mathop{\mathrm{h}}}^j a \star^j b,\]</span> discussed in
detail in <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P. D.
Nelson and Venkatesh 2021, sec. 4.2, §4.6)</a> and <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
sec. 9.2)</a>. We recall parts of that discussion. For <span
class="math inline">\((x,y,\zeta) \in \mathfrak{g} \times \mathfrak{g}
\times \mathfrak{g}^\wedge\)</span> with <span
class="math inline">\(x,y\)</span> sufficiently small, we set <span
class="math inline">\(\{x,y\} := \log(\exp(x) \exp(y)) - x - y\)</span>.
Then the function <span class="math inline">\((x,y,\zeta) \mapsto \exp
(\langle \{x, y\}, \zeta  \rangle)\)</span> is analytic near the origin,
hence admits a Taylor expansion, which we denote in multi-index notation
by <span class="math display">\[\exp (\langle \{x, y\}, \zeta  \rangle)
  = \sum _{\alpha, \beta , \gamma } c _{\alpha \beta \gamma } x ^\alpha
y ^\beta \zeta ^\gamma.\]</span> The <span
class="math inline">\(\star^j\)</span> are then the finite
bidifferential operators, with polynomial coefficients, given by <span
class="math display">\[a \star^j b(\zeta) = \sum  _{|\alpha| + |\beta| -
|\gamma| = j} c_{\alpha \beta \gamma} \zeta^\gamma \partial^\alpha
a(\zeta) \partial^\beta b(\zeta).\]</span> The coefficients <span
class="math inline">\(c_{\alpha \beta \gamma}\)</span> satisfy the basic
support condition <span class="math inline">\(|\gamma|
\leqslant\min(|\alpha|,|\beta|)\)</span> (see <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, (9.3))</a>). A
finer support condition may be described by writing <span
class="math inline">\(\exp (\langle \{x, y\}, \tau  \rangle)\)</span> in
<span class="math inline">\(\tau\)</span>-coordinates as <span
class="math display">\[\sum _{\alpha &#39;, \alpha &#39;&#39;, \beta
&#39;, \beta &#39;&#39; , \gamma }
  c _{\alpha &#39; \alpha &#39;&#39; \beta &#39; \beta &#39;&#39; \gamma
}
  (x &#39; ) ^{\alpha &#39; }
  (x &#39;&#39;) ^{\alpha &#39;&#39;}
  (y &#39;) ^{\beta &#39;}
  (y &#39;&#39; ) ^{\beta &#39;&#39;}
  \tau ^\gamma.\]</span> The coefficients in this expansion are then
nonvanishing only if (see <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Lemma 9.13)</a>)
<span class="math display">\[|\alpha &#39;| + |\beta &#39;| \geqslant 2
|\gamma|.\]</span> Setting <span class="math inline">\(j = |\alpha&#39;|
+ |\alpha &#39;&#39;| + |\beta &#39;| + |\beta &#39;&#39;| -
|\gamma|\)</span>, this last inequality may be rewritten <span id="eq:alpha-refined-support-condition" class="math display">\[\label{eq:alpha-refined-support-condition}\tag{13.7}
  |\alpha &#39;| + |\beta &#39; | + 2 | \alpha &#39;&#39; | + 2 |\beta
&#39;&#39;| \leqslant 2 j.\]</span></p>
<h5 id="extended-star-product">Extended star product</h5>
<div id="thm:extended-star-product" class="theorem">
<p><strong>Theorem 205</strong>. <em>Let <span
class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span> be cutoffs. Then the star product,
defined initially for Schwartz functions using <span
class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span>, extends uniquely to a compatible
family of continuous bilinear maps <span
class="math display">\[\star_{\mathop{\mathrm{h}}} : \underline{S}^{m_1}
\times \underline{S}^{m_2} \rightarrow \underline{S}^{m_1 +
m_2},\]</span> with the convention that <span
class="math inline">\(\infty + (-\infty) := -\infty\)</span>. For each
<span class="math inline">\((a,b) \in \underline{S}^{m_1} \times
\underline{S}^{m_2}\)</span> and <span class="math inline">\(J \in
\mathbb{Z}_{\geqslant 0}\)</span>, we have <span
class="math display">\[a \star_{\mathop{\mathrm{h}}} b \equiv \sum _{0
\leqslant j &lt; J} {\mathop{\mathrm{h}}}^j a \star ^j b \mod{
\underline{S} ^{m _1 + m _2 - J} },\]</span> where the remainder term
defines a continuous map <span class="math inline">\(\underline{S} ^{m
_1 } \times \underline{S} ^{m _2 } \rightarrow \underline{S} ^{m _1 + m
_2 - J}\)</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, Thm
1)</a>. ◻</p>
</div>
<h5 id="sec:star-prod-asymptotics">§13.5.4. Asymptotics</h5>
<div id="thm:basic-star-prod" class="theorem">
<p><strong>Theorem 206</strong>. <em>Fix <span
class="math inline">\(\delta \in [0,1/2)\)</span> and <span
class="math inline">\(m_1, m_2 \in \mathbb{Z} \cup \{\pm \infty
\}\)</span>. Let <span class="math inline">\(\chi_{1}\)</span> and <span
class="math inline">\(\chi_2\)</span> be fixed cutoffs. Let <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span> denote the
star product, as defined using <span
class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span>. Then the extended rescaled star
product <span class="math inline">\(\star_{\mathop{\mathrm{h}}} :
\underline{S}^\infty \times \underline{S}^\infty \rightarrow
\underline{S}^\infty\)</span> induces class maps <span
class="math display">\[\star_{\mathop{\mathrm{h}}} : S_{\delta}^{m_1}
\times S_{\delta}^{m_2} \rightarrow S_{\delta}^{m_1 + m_2}.\]</span> For
<span class="math inline">\((a,b) \in S_{\delta}^{m_1} \times
S_{\delta}^{m_2}\)</span> and fixed <span class="math inline">\(j \in
\mathbb{Z}_{\geqslant 0}\)</span>, we have <span
class="math display">\[a \star^j b \in {\mathop{\mathrm{h}}}^{-2 \delta j}
S_\delta^{m_1 + m_2 - j}.\]</span> Moreover, for fixed <span
class="math inline">\(J \in \mathbb{Z}_{\geqslant 0}\)</span>, <span
class="math display">\[a \star_{\mathop{\mathrm{h}}} b \equiv \sum _{0
\leqslant j &lt; J} {\mathop{\mathrm{h}}}^j a \star^j b \mod{
    {\mathop{\mathrm{h}}}^{(1 - 2 \delta) J} S_\delta  ^{m _1 + m _2 - J}.
  }\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> The required conclusion for infinite values of <span
class="math inline">\(m\)</span> follows formally from the case of
finite values of <span class="math inline">\(m\)</span>. In that case,
the claimed result is given by <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Thm
9.5)</a>. ◻</p>
</div>
<div id="lem:concl-theor-refthm:b" class="lemma">
<p><strong>Lemma 207</strong>. The conclusion of Theorem <a
href="#thm:basic-star-prod" data-reference-type="ref"
data-reference="thm:basic-star-prod">206</a> remains valid if we let
<span class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span> be <span
class="math inline">\(\delta\)</span>-admissible cutoffs supported in
<span class="math inline">\(\mathcal{G}_1\)</span>, not necessarily
fixed.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline">\(\chi_1&#39;,
\chi_2&#39;\)</span> be fixed cutoffs supported in <span
class="math inline">\(\mathcal{G}_1\)</span>; write <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}&#39;\)</span> for the
star product defined using them, to which Theorem <a
href="#thm:basic-star-prod" data-reference-type="ref"
data-reference="thm:basic-star-prod">206</a> applies. Write <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span> for that
defined using <span class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span>. Assume first that <span
class="math inline">\(\chi_2 = \chi_2&#39;\)</span>. By definition,
<span class="math display">\[(a \star_{\mathop{\mathrm{h}}} b - a
\star_{\mathop{\mathrm{h}}} &#39; b)_{\mathop{\mathrm{h}}}^\vee
    = (\chi_1 - \chi_1 &#39;) a_{\mathop{\mathrm{h}}}^\vee \star \chi_2
&#39; b_{\mathop{\mathrm{h}}}^\vee.\]</span> Define <span
class="math inline">\(a&#39;&#39; \in \underline{S}^\infty\)</span> by
requiring that <span
class="math inline">\((a_{\mathop{\mathrm{h}}}&#39;&#39;)^\vee  :=
(\chi_1 - \chi_1 &#39;) a_{\mathop{\mathrm{h}}}^\vee\)</span>. By Lemma
<a href="#lem:fix-0-leq" data-reference-type="ref"
data-reference="lem:fix-0-leq">203</a>, we have <span
class="math inline">\(a&#39; \in {\mathop{\mathrm{h}}}^\infty S^{-\infty}
\cap \underline{S}^{-\infty}\)</span>. We may choose a fixed cutoff
<span class="math inline">\(\chi_1 &#39;&#39;\)</span>, supported in
<span class="math inline">\(\mathcal{G}_0\)</span>, with <span
class="math inline">\(\chi_1&#39;&#39; \equiv 1\)</span> on the supports
of <span class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_1 &#39;\)</span>. Then <span
class="math inline">\(\chi_1 &#39;&#39;
(a_{\mathop{\mathrm{h}}}&#39;)^\vee  =
(a_{\mathop{\mathrm{h}}}&#39;)^\vee\)</span>. Define <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}&#39;&#39;\)</span>
using the fixed cutoffs <span
class="math inline">\(\chi_1&#39;&#39;\)</span> and <span
class="math inline">\(\chi_2\)</span>. Then <span
class="math display">\[a \star_{\mathop{\mathrm{h}}} b - a
\star_{\mathop{\mathrm{h}}}&#39; b = a&#39;&#39;
\star_{\mathop{\mathrm{h}}}&#39;&#39; b,\]</span> which, by Theorems <a
href="#thm:extended-star-product" data-reference-type="ref"
data-reference="thm:extended-star-product">205</a> and <a
href="#thm:basic-star-prod" data-reference-type="ref"
data-reference="thm:basic-star-prod">206</a>, lies in <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty S^{-\infty} \cap
\underline{S}^{-\infty}\)</span>.</p>
<p>We argue similarly if <span class="math inline">\(\chi_1 =
\chi_1&#39;\)</span>, and then conclude via bilinearity. ◻</p>
</div>
<div id="item:star-prod-4" class="theorem">
<p><strong>Theorem 208</strong>. <em><span id="thm:refined-star-prod"
label="thm:refined-star-prod"></span> Assume that <span
class="math inline">\(\mathop{\mathrm{h}}\lll 1\)</span>. Fix <span
class="math inline">\(\delta &#39;, \delta &#39;&#39;\)</span>
satisfying <span class="math inline">\(0 &lt; \delta &#39; &lt; \delta
&#39;&#39; &lt; 2 \delta &#39; &lt; 1\)</span>. Let <span
class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span> be fixed cutoffs; define <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span> using these.
Write <span class="math inline">\(j, J\)</span> for fixed elements of
<span class="math inline">\(\mathbb{Z}_{\geqslant 0}\)</span> and <span
class="math inline">\(\tau, \tau_1, \tau_2\)</span> for elements of some
fixed compact subset of <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>.</em></p>
<ol type="i">
<li><p><em><span id="item:star-prod-1" label="item:star-prod-1"></span>
<span class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span> enjoys
the mapping property <span id="eqn:star-h-new-mapping-property-super-localized" class="math display">\[\label{eqn:star-h-new-mapping-property-super-localized}\tag{13.8}
      \star_{\mathop{\mathrm{h}}} :
      S^{\tau_1}_{\delta&#39;, \delta&#39;&#39;}
      \times
      S^{\tau_2}_{\delta&#39;, \delta&#39;&#39;}
      \rightarrow
      S^{\tau_1}_{\delta&#39;, \delta &#39;&#39;}
      \cap S^{\tau_2}_{\delta&#39;, \delta &#39;&#39;}
      + {\mathop{\mathrm{h}}}^{\infty} S^{-\infty}.\]</span></em></p></li>
<li><p><em><span id="item:star-prod-2" label="item:star-prod-2"></span>
If <span class="math inline">\(\tau_1 - \tau_2 \ggg
{\mathop{\mathrm{h}}}^{\delta &#39;&#39; - \delta &#39;}\)</span>, then
<span class="math inline">\(a \star^j b = 0\)</span> for all <span
class="math inline">\(a \in
S^{\tau_1}_{\delta&#39;,\delta&#39;&#39;}\)</span>, <span
class="math inline">\(b \in S^{\tau_2}_{\delta &#39;, \delta
&#39;&#39;}\)</span>.</em></p></li>
<li><p><em><span id="item:star-prod-3" label="item:star-prod-3"></span>
<span class="math inline">\(\star^j\)</span> enjoys the mapping property
<span id="eqn:star-j-new-mapping-property" class="math display">\[\label{eqn:star-j-new-mapping-property}\tag{13.9}
      \star^j :
      S_{\delta &#39;, \delta &#39;&#39;}^{\tau }
      \times
      S_{\delta &#39;, \delta &#39;&#39;}^{\tau }
      \rightarrow {\mathop{\mathrm{h}}}^{- 2 \delta&#39; j}
      S^{\tau}_{\delta&#39;, \delta &#39;&#39;}.\]</span> For any <span
class="math inline">\(a,b \in S_{\delta &#39;, \delta
&#39;&#39;}^\tau\)</span>, we have the asymptotic expansion <span id="eqn:star-j-asymp-expn-new" class="math display">\[\label{eqn:star-j-asymp-expn-new}\tag{13.10}
      a \star_{\mathop{\mathrm{h}}} b
      \equiv  \sum _{0 \leqslant j &lt; J}
      {\mathop{\mathrm{h}}}^j a \star^j b
      \mod{
        {\mathop{\mathrm{h}}}^{(1- 2 \delta&#39;) J}
S^{\tau}_{\delta&#39;, \delta&#39;&#39;}
        +
        {\mathop{\mathrm{h}}}^{\infty}
        S^{-\infty}}.\]</span></em></p></li>
<li><p><em>Fix <span class="math inline">\(\delta \in
[0,\delta&#39;]\)</span>. We have the mapping properties <span
class="math display">\[\star_{\mathop{\mathrm{h}}} : S^{\infty}_{\delta}
\times S^{\tau}_{ \delta
        &#39;, \delta &#39;&#39;}
      \rightarrow S^{\tau}_{ \delta &#39;, \delta &#39;&#39;}
      + {\mathop{\mathrm{h}}}^\infty S^{-\infty},\]</span> <span
class="math display">\[\star^j : S^{\infty}_{\delta} \times S^{\tau}_{
\delta
        &#39;, \delta &#39;&#39;}      \rightarrow
{\mathop{\mathrm{h}}}^{-(\delta +  \delta &#39;)
        j}
      S^{\tau}_{ \delta &#39;, \delta &#39;&#39;}\]</span> and, for
<span class="math inline">\((a,b) \in S^{\infty}_{\delta} \times
S^{\tau}_{ \delta &#39;, \delta &#39;&#39;}\)</span>, the asymptotic
expansion <span class="math display">\[a \star_{\mathop{\mathrm{h}}} b
      \equiv  \sum _{0 \leqslant j &lt; J}
      {\mathop{\mathrm{h}}}^j a \star^j b
      \mod{
        {\mathop{\mathrm{h}}}^{(1- \delta - \delta&#39;) J}  S^{\tau}_{
\delta &#39;, \delta &#39;&#39;}
        +
        {\mathop{\mathrm{h}}}^{\infty} S^{-\infty}}.\]</span> Analogous
results hold with <span class="math inline">\(S^{\infty}_{\delta} \times
S^{\tau}_{ \delta &#39;, \delta &#39;&#39;}\)</span> replaced by <span
class="math inline">\(S^{\tau}_{ \delta &#39;, \delta &#39;&#39;} \times
S^{\infty}_{\delta}\)</span>.</em></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> This is <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Thm
9.12)</a>. ◻</p>
</div>
<p>The analogue of Lemma <a href="#lem:concl-theor-refthm:b"
data-reference-type="ref"
data-reference="lem:concl-theor-refthm:b">207</a> holds, with the same
proof: for each assertion involving <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span> applied to an
element <span class="math inline">\(a\)</span> of the class <span
class="math inline">\(S_\delta^\infty\)</span> (resp. <span
class="math inline">\(S_{\delta &#39;, \delta
&#39;&#39;}^{\tau}\)</span>), we can take the cutoff <span
class="math inline">\(\chi\)</span> assigned to <span
class="math inline">\(a\)</span> to be any <span
class="math inline">\(\delta\)</span>-admissible (resp. <span
class="math inline">\((\tau, \delta &#39;, \delta
&#39;&#39;)\)</span>-admissible) cutoff.</p>
<p>From now on, we do not write explicitly which cutoffs are used to
define <span class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span>,
which should be clear by context in each case.</p>
<h4 id="operator-assignment">Operator assignment</h4>
<p>Let <span class="math inline">\(\pi\)</span> be a unitary
representation <span class="math inline">\(G\)</span>.</p>
<h5 id="sec:basic-definition">§13.6.1. Basic definition</h5>
<p>We denote as in §<a href="#sec:kirillov-model"
data-reference-type="ref" data-reference="sec:kirillov-model">3.1</a> by
<span class="math display">\[\pi^\infty \subseteq \pi^0 \subseteq
\pi^{-\infty}\]</span> the spaces of smooth, norm-bounded and
distributional vectors. By an <em>operator</em> on <span
class="math inline">\(\pi\)</span>, we mean a linear map <span
class="math inline">\(\pi^{-\infty} \rightarrow \pi^{-\infty}\)</span>.
(The operators of interest to us will have more specific mapping
properties than this.)</p>
<p>Let <span class="math inline">\(a \in
\mathcal{S}(\mathfrak{g}^\wedge)\)</span>. Let <span
class="math inline">\(\chi\)</span> be a nice cutoff. Recall, from §<a
href="#sec:four-transf-basic" data-reference-type="ref"
data-reference="sec:four-transf-basic">2.5.1</a>, the definition of the
smooth compactly-supported measure <span
class="math inline">\(\widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span>
on <span class="math inline">\(G\)</span>. We obtain an operator <span
class="math inline">\({\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\pi,\chi)\)</span>
on <span class="math inline">\(\pi\)</span> by integrating: <span
class="math display">\[{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\pi,\chi)
:= \int _{g \in G}
\widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi) \pi(g)
  =
  \int _{x \in \mathfrak{g} } \chi(x) a_{\mathop{\mathrm{h}}}^\vee(x)
\pi(\exp(x)) \, d x.\]</span> The convolution formula <a
href="#eq:widet-ast-widet" data-reference-type="eqref"
data-reference="eq:widet-ast-widet">\((13.6)\)</a> translates
to the composition formula <span id="eq:composition-formula-most-basic" class="math display">\[\label{eq:composition-formula-most-basic}\tag{13.11}
  {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\pi,\chi_1) \ast
  {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(b:\pi,\chi_2)
  =
  {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a
\star_{\mathop{\mathrm{h}}} b:\pi,\chi&#39;)\]</span></p>
<p>In what follows, the representation <span
class="math inline">\(\pi\)</span> will always be clear from context, so
we often abbreviate <span
class="math display">\[{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)
:= {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\pi,\chi).\]</span></p>
<h5 id="sec:negligible-operators">§13.6.2. Some operator classes</h5>
<p>The discussion here is highly non-exhaustive, since we require far
less precision in our discussion of operators than in <a href="#ref-nelson-venkatesh-1 2020arXiv201202187N"
class="citation" data-cites="nelson-venkatesh-1 2020arXiv201202187N">(P.
D. Nelson and Venkatesh 2021; P. D. Nelson 2023)</a>.</p>
<div class="definition">
<p><strong>Definition 209</strong>. Let <span
class="math inline">\(\underline{\Psi }^{-\infty}\)</span> denote the
space of operators <span class="math inline">\(T\)</span> on <span
class="math inline">\(\pi\)</span> such that for all <span
class="math inline">\(x,y \in \mathfrak{U}(G)\)</span>, the operator
<span class="math inline">\(\pi(x) T \pi(y)\)</span> induces a bounded
operator on <span class="math inline">\(\pi\)</span>.</p>
</div>
<div class="definition">
<p><strong>Definition 210</strong>. Let <span
class="math inline">\(\underline{\Psi }^{\infty}\)</span> denote the
space of operators <span class="math inline">\(T\)</span> on <span
class="math inline">\(\pi\)</span> such that there exists <span
class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span> so that
for all <span class="math inline">\(k \in \mathbb{Z}_{\geqslant
0}\)</span> and <span class="math inline">\(x_1,\dotsc,x_k \in
\mathfrak{g}\)</span>, there exists <span class="math inline">\(C_0
\geqslant 0\)</span> so that for all <span class="math inline">\(v \in
\pi^\infty\)</span>, we have <span class="math display">\[\|[\pi(x_1),
\dotsc, [\pi(x_k), T] ] v\| \leqslant C_0 \sum_{y_1,\dotsc,y_m \in
\mathcal{B}(G) \cup \{1\}} \|\pi(y_1 \dotsb y_m) v\|.\]</span></p>
</div>
<div class="example">
<p><strong>Example 211</strong>. For <span class="math inline">\(f \in
C_c^\infty(G)\)</span>, the integral operator <span
class="math inline">\(\pi(f)\)</span> lies in <span
class="math inline">\(\underline{\Psi }^{-\infty}\)</span>. For <span
class="math inline">\(x \in \mathfrak{U}(G)\)</span>, the differential
operator <span class="math inline">\(\pi(x)\)</span> lies in <span
class="math inline">\(\underline{\Psi }^{\infty}\)</span>.</p>
</div>
<div class="remark">
<p><strong>Remark 212</strong>. By <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, (3.1),
Lem 3.5, Prop 8.2)</a>, the abbreviated definitions of <span
class="math inline">\(\underline{\Psi }^{\pm \infty}\)</span> given here
coincide with the those in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec.
10)</a>.</p>
</div>
<div id="lem:foll-incl-hold" class="lemma">
<p><strong>Lemma 213</strong>. The following inclusions hold, where
juxtaposition denotes either composition of operators or application of
operators to vectors.</p>
<ol type="i">
<li><p><span class="math inline">\(\underline{\Psi}^{-\infty} \subseteq
\underline{\Psi}^{\infty}\)</span>.</p></li>
<li><p><span class="math inline">\(\underline{\Psi}^{\infty}
\underline{\Psi}^{-\infty}, \underline{\Psi}^{-\infty}
\underline{\Psi}^{\infty} \subseteq
\underline{\Psi}^{\infty}\)</span>.</p></li>
<li><p><span class="math inline">\(\underline{\Psi }^{\infty} \pi^\infty
\subseteq \pi^\infty\)</span>.</p></li>
<li><p><span class="math inline">\(\underline{\Psi }^{-\infty}
\pi^{-\infty} \subseteq \pi^\infty\)</span>.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> These are all essentially immediate from the
definitions. We refer to <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
3)</a> for further discussion. ◻</p>
</div>
<div class="definition">
<p><strong>Definition 214</strong>. Let <span
class="math inline">\(\Psi^{-\infty}\)</span> denote the class of all
<span class="math inline">\(T \in \underline{\Psi }^\infty\)</span> such
that for all fixed <span class="math inline">\(x,y \in
\mathfrak{U}(G)\)</span>, the operator <span
class="math inline">\(\pi(x) T \pi(y)\)</span> induces a bounded
operator on <span class="math inline">\(\pi\)</span> with operator norm
<span class="math inline">\(\operatorname{O}(1)\)</span>.</p>
<p>We may define the class <span class="math inline">\(c
\Psi^{-\infty}\)</span> for any scalar <span
class="math inline">\(c\)</span>. We denote by <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty \Psi^{-\infty}\)</span>
the intersection of the classes <span
class="math inline">\({\mathop{\mathrm{h}}}^N \Psi^{-\infty}\)</span> over
all fixed <span class="math inline">\(N\)</span>.</p>
</div>
<div class="lemma">
<p><strong>Lemma 215</strong>. If <span
class="math inline">\(T_1\)</span> and <span
class="math inline">\(T_2\)</span> lie in <span
class="math inline">\(\Psi^{-\infty}\)</span>, then so does their
composition <span class="math inline">\(T_1 T_2\)</span>.</p>
</div>
<h5 id="qualitative-theory">Qualitative theory</h5>
<div id="thm:qualitative-extended-operator-assignment" class="theorem">
<p><strong>Theorem 216</strong>. <em>Let <span
class="math inline">\(\chi\)</span> be a nice cutoff. The assignment
<span class="math display">\[\mathcal{S}(\mathfrak{g}^\wedge) \ni a
\mapsto {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi) =:
\mathop{\mathrm{Op}}(a)\]</span> extends to a linear map <span
class="math display">\[\mathop{\mathrm{Op}}: \underline{S}^{-\infty}
\rightarrow
    \{\text{operators on } \pi\}\]</span> with the following
properties.</em></p>
<ol type="i">
<li><p><em><span
class="math inline">\(\mathop{\mathrm{Op}}(\underline{S}^\infty)
\subseteq \underline{\Psi}^{\infty}\)</span>.</em></p></li>
<li><p><em><span
class="math inline">\(\mathop{\mathrm{Op}}(\underline{S}^{-\infty})
\subseteq \underline{\Psi}^{-\infty}\)</span>.</em></p></li>
<li><p><em><span
class="math inline">\(\mathop{\mathrm{Op}}(\underline{S}^{\infty})
\pi^\infty \subseteq \pi^\infty\)</span>.</em></p></li>
<li><p><em><span
class="math inline">\(\mathop{\mathrm{Op}}(\underline{S}^{-\infty})
\pi^{-\infty} \subseteq \pi^\infty\)</span>.</em></p></li>
<li><p><em><span
class="math inline">\(\mathop{\mathrm{Op}}(\underline{S}^0) \pi
\subseteq \pi\)</span>.</em></p></li>
<li><p><em>The composition formula <a
href="#eq:composition-formula-most-basic" data-reference-type="eqref"
data-reference="eq:composition-formula-most-basic">\((13.11)\)</a>
remains valid, i.e., for <span class="math inline">\(\chi_1, \chi_2,
\chi &#39;\)</span> as before and <span class="math inline">\(a, b \in
\underline{S}^{\infty}\)</span>, <span id="eq:qualitative-composition-formula" class="math display">\[\label{eq:qualitative-composition-formula}\tag{13.12}
      {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_1)
      {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(b:\chi_2)
      =
      {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a
\star_{\mathop{\mathrm{h}}} b:\chi&#39;).\]</span></em></p></li>
<li><p><em>For any polynomial <span class="math inline">\(p \in
\underline{S}^\infty\)</span> (i.e., <span class="math inline">\(p \in
\mathop{\mathrm{Sym}}(\mathfrak{g}_{\mathbb{C}})\)</span>), we have
<span id="eq:oppp-=-pisymp_h" class="math display">\[\label{eq:oppp-=-pisymp_h}\tag{13.13}
      \mathop{\mathrm{Op}}(p) =
\pi(\mathop{\mathrm{sym}}(p_{\mathop{\mathrm{h}}})),\]</span> where
<span class="math inline">\(p_{\mathop{\mathrm{h}}}\)</span> denotes the
rescaling <span class="math inline">\(p_{\mathop{\mathrm{h}}}(\xi) :=
p(\mathop{\mathrm{h}}\xi)\)</span> and <span
class="math inline">\(\mathop{\mathrm{sym}}:
\mathop{\mathrm{Sym}}(\mathfrak{g}_\mathbb{C}) \rightarrow
\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span> denotes the
symmetrization map, i.e., the linear isomorphism sending each monomial
to the average of its permutations.</em></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> The extension, inclusions and composition formula are
special cases of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Thm 10.6)</a>.
The final assertion is given by <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
5.2, §8.1)</a>. ◻</p>
</div>
<div id="lem:let-chi-be" class="lemma">
<p><strong>Lemma 217</strong>. Let <span
class="math inline">\(\chi\)</span> be any <span
class="math inline">\(0\)</span>-admissible cutoff. Abbreviate <span
class="math inline">\(\mathop{\mathrm{Op}}(a) :=
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span>. Then <span
class="math display">\[\mathop{\mathrm{Op}}({\mathop{\mathrm{h}}}^\infty
S^{-\infty}) \subseteq {\mathop{\mathrm{h}}}^\infty
\Psi^{-\infty}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This follows in much sharper forms from the results
of <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson
2023, sec. 10)</a>. ◻</p>
</div>
<h5 id="irrelevance-of-cutoffs">Irrelevance of cutoffs</h5>
<div id="lem:fix-delta-in-1" class="lemma">
<p><strong>Lemma 218</strong>. Fix <span class="math inline">\(\delta
\in [0,1)\)</span>. Let <span class="math inline">\(a \in
S_\delta^\infty\)</span>. Let <span
class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span> be <span
class="math inline">\(\delta\)</span>-admissible cutoffs, supported in
<span class="math inline">\(\mathcal{G}_1\)</span>. Then <span id="eq:opp_h-opp_h-in" class="math display">\[\label{eq:opp_h-opp_h-in}\tag{13.14}
    {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_1) -
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_2) \in
{\mathop{\mathrm{h}}}^\infty \Psi^{-\infty} \cap \underline{\Psi
}^{-\infty}.\]</span> More precisely, if <span
class="math inline">\(\chi &#39;\)</span> is a <span
class="math inline">\(\delta\)</span>-admissible cutoff satisfying <span
class="math inline">\(\chi &#39; (x \ast y) = 1\)</span> whenever <span
class="math inline">\(\chi_1(x) \chi_2(y) \neq 0\)</span>, then <span id="eq:opp_h-opp_h-=" class="math display">\[\label{eq:opp_h-opp_h-=}\tag{13.15}
    {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_1) -
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_2) =
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a&#39; : \chi &#39;) \quad
\text{for some $a&#39; \in {\mathop{\mathrm{h}}}^\infty S^{-\infty} \cap
\underline{S}^{-\infty}$.}\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemma <a href="#lem:fix-0-leq"
data-reference-type="ref" data-reference="lem:fix-0-leq">203</a>,
Theorem <a href="#thm:qualitative-extended-operator-assignment"
data-reference-type="ref"
data-reference="thm:qualitative-extended-operator-assignment">216</a>
and Lemma <a href="#lem:let-chi-be" data-reference-type="ref"
data-reference="lem:let-chi-be">217</a>, we have <span
class="math display">\[{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_1)
- {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_2) \in
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}({\mathop{\mathrm{h}}}^\infty
S^{-\infty} \cap \underline{S}^{-\infty})
    \subseteq {\mathop{\mathrm{h}}}^\infty \Psi^{-\infty} \cap
\underline{\Psi}^{-\infty}.\]</span> The same argument gives the more
precise assertion. (Compare with <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Lemma 10.7)</a>
and <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(P. D. Nelson
and Venkatesh 2021, sec. 5.4)</a>.) ◻</p>
</div>
<div id="lem:fix-delta-in-2" class="lemma">
<p><strong>Lemma 219</strong>. Let <span
class="math inline">\(\tau\)</span> belong to a fixed compact subset of
<span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>.
Fix <span class="math inline">\(0 &lt; \delta &#39; &lt; \delta
&#39;&#39; &lt; 2 \delta &#39; &lt; 1\)</span>. Let <span
class="math inline">\(a \in S_{\delta&#39;, \delta
&#39;&#39;}^{\tau}\)</span>. Let <span
class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span> be <span
class="math inline">\((\tau, \delta &#39;, \delta
&#39;&#39;)\)</span>-admissible cutoffs. Then <a
href="#eq:opp_h-opp_h-in" data-reference-type="eqref"
data-reference="eq:opp_h-opp_h-in">\((13.14)\)</a> holds. More
precisely, if <span class="math inline">\(\chi &#39;\)</span> is any
<span class="math inline">\((\tau, \delta &#39;, \delta
&#39;&#39;)\)</span>-admissible cutoff with <span
class="math inline">\(\chi &#39; (x \ast y) = 1\)</span> whenever <span
class="math inline">\(\chi_1(x) \chi_2(y) \neq 0\)</span>, then <a
href="#eq:opp_h-opp_h-=" data-reference-type="eqref"
data-reference="eq:opp_h-opp_h-=">\((13.15)\)</a> holds.</p>
</div>
<div class="proof">
<p><em>Proof.</em> The proof is similar to that of Lemma <a
href="#lem:fix-delta-in-1" data-reference-type="ref"
data-reference="lem:fix-delta-in-1">218</a>, using Lemma <a
href="#lem:let-tau-belong" data-reference-type="ref"
data-reference="lem:let-tau-belong">204</a> instead of Lemma <a
href="#lem:fix-0-leq" data-reference-type="ref"
data-reference="lem:fix-0-leq">203</a>. ◻</p>
</div>
<h5 id="composition">Composition</h5>
<div id="thm:composition-formula-quantitative" class="theorem">
<p><strong>Theorem 220</strong>. <em>Fix <span
class="math inline">\(\delta \in [0,1/2)\)</span>. Set <span
class="math inline">\(\mathop{\mathrm{Op}}(a) :=
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span> for some
<span class="math inline">\(\delta\)</span>-admissible cutoff <span
class="math inline">\(\chi\)</span>, supported in <span
class="math inline">\(\mathcal{G}_2\)</span>. Then for <span
class="math inline">\(a,b \in S_\delta^\infty\)</span>, we have <span id="eq:oppa-oppb-equiv" class="math display">\[\label{eq:oppa-oppb-equiv}\tag{13.16}
    \mathop{\mathrm{Op}}(a) \mathop{\mathrm{Op}}(b) \equiv
\mathop{\mathrm{Op}}(a \star_{\mathop{\mathrm{h}}} b) \mod{
{\mathop{\mathrm{h}}}^\infty \Psi^{-\infty} \cap \underline{\Psi
}^{-\infty}}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> By <a href="#eq:qualitative-composition-formula"
data-reference-type="eqref"
data-reference="eq:qualitative-composition-formula">\((13.12)\)</a>
and Lemma <a href="#lem:fix-delta-in-1" data-reference-type="ref"
data-reference="lem:fix-delta-in-1">218</a>. (Compare with <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(P. D. Nelson 2023,
Thm 10.8, (10.8))</a>.) ◻</p>
</div>
<p>Similarly:</p>
<div class="theorem">
<p><strong>Theorem 221</strong>. <em>Suppose <span
class="math inline">\(G\)</span> is connected reductive and <span
class="math inline">\(\mathop{\mathrm{h}}\lll 1\)</span>. Fix <span
class="math inline">\(0 &lt; \delta  &#39; &lt; \delta &#39;&#39; &lt; 2
\delta &#39; &lt; 1\)</span>, and let <span
class="math inline">\(\tau\)</span> belong to a fixed compact subset of
<span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>.
Set <span class="math inline">\(\mathop{\mathrm{Op}}(a) :=
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span> for some
<span class="math inline">\(\delta&#39;&#39;\)</span>-admissible cutoff
<span class="math inline">\(\chi\)</span>, supported in <span
class="math inline">\(\mathcal{G}_2\)</span>. Then the composition
formula <a href="#eq:oppa-oppb-equiv" data-reference-type="eqref"
data-reference="eq:oppa-oppb-equiv">\((13.16)\)</a> remains
valid for <span class="math inline">\(a,b \in S_{\delta &#39;}^{\infty}
\cup S^{\tau}_{\delta &#39;, \delta &#39;&#39;}\)</span>.</em></p>
</div>
<p>Many variants on these results are possible, and we do not state them
exhaustively. The point is just that for all practical purposes, when
working with a symbol <span class="math inline">\(a \in
S^\infty_\delta\)</span> (resp. <span class="math inline">\(a \in
S^\tau_{\delta &#39;, \delta &#39;&#39;}\)</span>), we can define <span
class="math inline">\({\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span>
using a <span class="math inline">\(\delta\)</span>-admissible (resp.
<span class="math inline">\((\tau, \delta &#39;, \delta
&#39;&#39;)\)</span>-admissible) cutoff <span
class="math inline">\(\chi\)</span> supported on <span
class="math inline">\(o(1)\)</span>. We can then compose such operators
using <a href="#eq:oppa-oppb-equiv" data-reference-type="eqref"
data-reference="eq:oppa-oppb-equiv">\((13.16)\)</a>. The
ambiguity arising from the choice of cutoff always lies in the
negligible class <span class="math inline">\({\mathop{\mathrm{h}}}^\infty
\Psi^{-\infty} \cap \underline{\Psi }^{-\infty}\)</span>.</p>
<h4 id="borel-summation">Borel summation</h4>
<div id="lem:borel-summation" class="lemma">
<p><strong>Lemma 222</strong>. Fix <span class="math inline">\(0
\leqslant\delta &lt; 1\)</span>. Suppose given for each <span
class="math inline">\(j \in \mathbb{Z}_{\geqslant 0}\)</span> a smooth
function <span class="math inline">\(a_j\)</span> on <span
class="math inline">\(\mathfrak{g}^\wedge\)</span>, a real number <span
class="math inline">\(e_j\)</span> and an integer <span
class="math inline">\(m_j\)</span> so that</p>
<ul>
<li><p>for each fixed <span class="math inline">\(j\)</span>, the
quantities <span class="math inline">\(e_j\)</span> and <span
class="math inline">\(m_j\)</span> are fixed, and we have <span
class="math inline">\(a_j \in {\mathop{\mathrm{h}}}^{e_j}
S^{m_j}_\delta\)</span>, and</p></li>
<li><p><span class="math inline">\(e_j \rightarrow \infty\)</span> and
<span class="math inline">\(m_j \rightarrow -\infty\)</span> as <span
class="math inline">\(j \rightarrow \infty\)</span>.</p></li>
</ul>
<p>Then for each <span class="math inline">\(L_0 \ggg 1\)</span>, there
exists <span class="math inline">\(L \in \mathbb{Z}_{\geqslant
0}\)</span> with <span class="math inline">\(1 \lll L  \leqslant
L_0\)</span> so that the sum <span id="eq::=-sum-_0" class="math display">\[\label{eq::=-sum-_0}\tag{13.17}
    a := \sum _{0 \leqslant j &lt; L} a_j\]</span> belongs to <span
class="math inline">\(S^{\infty}_{\delta}\)</span> and satisfies, for
fixed <span class="math inline">\(N \in \mathbb{Z}_{\geqslant
0}\)</span> and large enough fixed <span class="math inline">\(J \in
\mathbb{Z}_{\geqslant 0}\)</span>, the asymptotic expansion <span
class="math display">\[a \equiv \sum_{0 \leqslant j &lt; J} a_j
\mod{{\mathop{\mathrm{h}}}^N S^{-N}_\delta}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a simple overspill exercise, essentially
identical to the standard argument for establishing Borel summation in
the pseudodifferential calculus. Define <span
class="math inline">\(J_0(N)\)</span> to be the smallest <span
class="math inline">\(J\)</span> for which <span class="math inline">\(j
\geqslant J \implies a_j \in {\mathop{\mathrm{h}}}^N
S_\delta^{-N}\)</span>. Temporarily suppose <span
class="math inline">\(L\)</span> is fixed. Then for all <span
class="math inline">\(N \leqslant L\)</span> and all <span
class="math inline">\(J\)</span> with <span class="math inline">\(J_0(N)
\leqslant J \leqslant L\)</span>, the sum <span class="math inline">\(b
:= \sum _{J \leqslant j &lt; L} a_j\)</span> lies in the symbol class
<span class="math inline">\({\mathop{\mathrm{h}}}^{N}
S_\delta^{-N}\)</span>. This last membership means that <span
class="math inline">\(b\)</span> lies in the space of symbols <span
class="math inline">\(\underline{S}^{\infty}\)</span> and satisfies
<span class="math inline">\(\nu_{-N,\alpha}(b) \ll
{\mathop{\mathrm{h}}}^{N - \delta |\alpha|}\)</span> for each fixed
multi-index <span class="math inline">\(\alpha\)</span>. In particular,
since <span class="math inline">\(\mathop{\mathrm{h}}\lll 1\)</span>, we
have <span class="math inline">\(\nu_{-N,\alpha}(b)
\leqslant{\mathop{\mathrm{h}}}^{N - 1 - \delta |\alpha|}\)</span> for all
multi-indices <span class="math inline">\(\alpha\)</span> with <span
class="math inline">\(|\alpha| \leqslant L\)</span>. Thus the set <span
class="math display">\[\left\{
      L \in \mathbb{Z}_{\geqslant 0} :
      \begin{gathered}
        b \in \underline{S}_{\delta}^{-N} \text{ and }
      \nu_{-N,\alpha}(b) \leqslant{\mathop{\mathrm{h}}}^{N - 1 - \delta
|\alpha|} \\
      \text{ for all } N \leqslant L, \, J_0(N) \leqslant J \leqslant L,
\,  |\alpha| \leqslant L
    \end{gathered}
  \right\},\]</span> with <span class="math inline">\(b\)</span> defined
as above, contains all fixed <span class="math inline">\(L\)</span>. By
overspill, it contains some <span class="math inline">\(L \ggg
1\)</span> with <span class="math inline">\(L \leqslant L_0\)</span>.
For this <span class="math inline">\(L\)</span>, we have <span
class="math inline">\(N \leqslant L\)</span> all fixed <span
class="math inline">\(N\)</span>. Thus for each fixed <span
class="math inline">\(N\)</span> and all fixed <span
class="math inline">\(J \geqslant J_0(N)\)</span>, we have <span
class="math display">\[\sum _{J \leqslant j &lt; L } a_j \in
{\mathop{\mathrm{h}}}^{N-1} S_{\delta}^{-N}.\]</span> The required
memberships follow readily from this. ◻</p>
</div>
<div class="lemma">
<p><strong>Lemma 223</strong>. Let <span class="math inline">\(\tau \in
\mathfrak{g}^\wedge\)</span> belong to a fixed compact collection of
regular elements. Fix <span class="math inline">\(0 &lt; \delta &#39;
&lt; \delta &#39;&#39; &lt; 2 \delta &#39; &lt; 1\)</span>. Suppose
given for each <span class="math inline">\(j \in \mathbb{Z}_{\geqslant
0}\)</span> a smooth function <span class="math inline">\(a_j\)</span>
on <span class="math inline">\(\mathfrak{g}^\wedge\)</span> and a real
number <span class="math inline">\(e_j\)</span> so that</p>
<ul>
<li><p>for each fixed <span class="math inline">\(j\)</span>, the
quantities <span class="math inline">\(e_j\)</span> and <span
class="math inline">\(m_j\)</span> are fixed, and we have <span
class="math inline">\(a_j \in {\mathop{\mathrm{h}}}^{e_j}
S^{\tau}_{\delta&#39;, \delta &#39;&#39;}\)</span>, and</p></li>
<li><p><span class="math inline">\(e_j \rightarrow \infty\)</span> as
<span class="math inline">\(j \rightarrow \infty\)</span>.</p></li>
</ul>
<p>Assume moreover that there is a fixed <span class="math inline">\(R
&gt; 0\)</span> so that each <span class="math inline">\(a_j\)</span> is
supported on <span class="math inline">\(\{\xi : |\xi - \tau| \leqslant
R {\mathop{\mathrm{h}}}^{\delta &#39;&#39; - \delta &#39;}\}\)</span>.
Then for each <span class="math inline">\(L_0 \ggg 1\)</span>, there
exists <span class="math inline">\(L \in \mathbb{Z}_{\geqslant
0}\)</span> with <span class="math inline">\(1 \lll L \leqslant
L_0\)</span> so that the sum <span class="math inline">\(a := \sum _{0
\leqslant j &lt; L} a_j\)</span> belongs to <span
class="math inline">\(S^{\tau}_{\delta&#39;, \delta &#39;&#39;}\)</span>
and satisfies, for fixed <span class="math inline">\(N \in
\mathbb{Z}_{\geqslant 0}\)</span> and large enough fixed <span
class="math inline">\(J \in \mathbb{Z}_{\geqslant 0}\)</span>, the
asymptotic expansion <span class="math display">\[a \equiv \sum_{0
\leqslant j &lt; J} a_j \mod{{\mathop{\mathrm{h}}}^N S^{\tau
}_{\delta&#39;, \delta &#39;&#39;}}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> The proof is very similar to that of Lemma <a
href="#lem:borel-summation" data-reference-type="ref"
data-reference="lem:borel-summation">222</a>: in place of <span
class="math inline">\(\nu_{-N,\alpha}\)</span>, we use the seminorms
relevant for the definition of <span
class="math inline">\(S^\tau_{\delta &#39;, \delta &#39;&#39;}\)</span>.
The important point is that since we have fixed <span
class="math inline">\(R\)</span>, the support condition in the
definition of <span class="math inline">\(S_{\delta &#39;, \delta
&#39;&#39;}^{\tau}\)</span> holds automatically for the partial sum
<span class="math inline">\(a\)</span>. ◻</p>
</div>
<h3 id="sec:abstr-study-local">§14. Abstract study of localized vectors</h3>
<p>In this section, we work over any fixed Lie group <span
class="math inline">\(G\)</span>. We assume given a wavelength parameter
<span class="math inline">\(\mathop{\mathrm{h}}\in (0,1]\)</span> and a
fixed element <span class="math inline">\(0 \leqslant\delta &lt;
1/2\)</span>, so that we may define the symbol class <span
class="math inline">\(S_\delta^\infty =
S_\delta^\infty(\mathfrak{g}^\wedge)\)</span>. Many definitions in this
section, like that of the symbol class, depend upon the parameter <span
class="math inline">\(\mathop{\mathrm{h}}\)</span>, but this dependence
is suppressed to simplify the notation.</p>
<p>Our aim is to develop some formal consequences of the symbol calculus
in a general setting, where the necessary inputs to our arguments can be
presented most clearly. Example <a href="#exa:cal-W-delta-mirabolic"
data-reference-type="ref"
data-reference="exa:cal-W-delta-mirabolic">233</a>, below, suggests our
primary motivation doing so.</p>
<h4 id="operatornameo1-modules"><span
class="math inline">\(\operatorname{O}(1)\)</span>-modules</h4>
<p>Recall from §<a href="#sec:classes" data-reference-type="ref"
data-reference="sec:classes">2.1.4</a> our convention on “class.” We
introduce one further specialized piece of terminology.</p>
<div class="definition">
<p><strong>Definition 224</strong>. An <em><span
class="math inline">\(\operatorname{O}(1)\)</span>-module</em> is a
subclass <span class="math inline">\(M\)</span> of a complex vector
space for which <span class="math display">\[m_1, m_2 \in M \implies m_1
+ m_2 \in M\]</span> and <span class="math display">\[c \in \mathbb{C},
\quad c \ll 1, \quad m \in M \implies c m \in M.\]</span></p>
</div>
<p>The conditions defining an <span
class="math inline">\(\operatorname{O}(1)\)</span>-module <span
class="math inline">\(M\)</span> may be rephrased as follows: for all
fixed <span class="math inline">\(n \in \mathbb{Z}_{\geqslant
0}\)</span> and all scalars (i.e., complex numbers) <span
class="math inline">\(c_1, \dotsc,c_n = \operatorname{O}(1)\)</span>, we
have <span class="math display">\[m_1,\dotsc,m_n \in M \implies c_1 m_1
+ \dotsb + c_n m_n \in M.\]</span></p>
<p>We note that if <span class="math inline">\(M\)</span> is an <span
class="math inline">\(\operatorname{O}(1)\)</span>-module, then so is
<span class="math inline">\(c M\)</span> for any scalar <span
class="math inline">\(c\)</span>. For an <span
class="math inline">\(\operatorname{O}(1)\)</span>-module <span
class="math inline">\(M\)</span>, we write <span
class="math display">\[{\mathop{\mathrm{h}}}^\infty M\]</span> for the
intersection of <span class="math inline">\({\mathop{\mathrm{h}}}^N
M\)</span> taken over fixed integers <span
class="math inline">\(N\)</span>; it is an <span
class="math inline">\(\operatorname{O}(1)\)</span>-module.</p>
<h4 id="sec:local-vect-defin">§14.2. Localized vectors: definition</h4>
<p>First, some general notation. For <span class="math inline">\(\tau
\in \mathfrak{g}^\wedge\)</span> with <span class="math inline">\(\tau
\ll 1\)</span> and fixed <span class="math inline">\(r \in
\mathbb{Z}_{\geqslant 0}\)</span>, we write <span
class="math display">\[I_{0,\tau}^r \subseteq S_0^\infty\]</span> for
the subclass consisting of symbols that vanish to order at least <span
class="math inline">\(r\)</span> at <span
class="math inline">\(\tau\)</span>. The polynomial elements of <span
class="math inline">\(I_{0,\tau}^r\)</span> are then precisely those
polynomials of degree <span
class="math inline">\(\operatorname{O}(1)\)</span> and coefficients of
size <span class="math inline">\(\operatorname{O}(1)\)</span> that
vanish to order at least <span class="math inline">\(r\)</span> at <span
class="math inline">\(\tau\)</span>.</p>
<p>For any polynomial function <span class="math inline">\(p :
\mathfrak{g}^\wedge \rightarrow \mathbb{C}\)</span>, we define <span
class="math inline">\(\mathop{\mathrm{Op}}(p) \in
\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span> by <span id="eq:oppp-:=-symp_h" class="math display">\[\label{eq:oppp-:=-symp_h}\tag{14.1}
  \mathop{\mathrm{Op}}(p) :=
\mathop{\mathrm{sym}}(p_{\mathop{\mathrm{h}}}),\]</span> where, as in
Theorem <a href="#thm:qualitative-extended-operator-assignment"
data-reference-type="ref"
data-reference="thm:qualitative-extended-operator-assignment">216</a>,
we denote by <span class="math inline">\(\mathop{\mathrm{sym}}:
\mathop{\mathrm{Sym}}(\mathfrak{g}_\mathbb{C}) \rightarrow
\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span> the symmetrization map
and <span class="math inline">\(p_{\mathop{\mathrm{h}}}(\xi) :=
p(\mathop{\mathrm{h}}\xi)\)</span> the <span
class="math inline">\(\mathop{\mathrm{h}}\)</span>-rescaling of <span
class="math inline">\(p\)</span>. As noted in the statement of that
theorem, the formula <a href="#eq:oppp-:=-symp_h"
data-reference-type="eqref"
data-reference="eq:oppp-:=-symp_h">\((14.1)\)</a> is satisfied
by our “usual” operator assignment.</p>
<div id="defn:localized-vectors" class="definition">
<p><strong>Definition 225</strong>. Let <span
class="math inline">\(M\)</span> be an <span
class="math inline">\(\operatorname{O}(1)\)</span>-submodule of a <span
class="math inline">\(\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span>-module.
Fix <span class="math inline">\(\nu \in (0,1/2]\)</span>. Let <span
class="math inline">\(\tau \in \mathfrak{g}^\wedge\)</span> with <span
class="math inline">\(\tau \ll 1\)</span>. We say that <span
class="math inline">\(v \in M\)</span> is <em><span
class="math inline">\((\mathfrak{g},\nu)\)</span>-localized at <span
class="math inline">\(\tau\)</span> inside <span
class="math inline">\(M\)</span></em> if for each fixed <span
class="math inline">\(r \in \mathbb{Z}_{\geqslant 0}\)</span> and each
polynomial <span class="math inline">\(p \in I_{0,\tau}^r\)</span>, we
have <span class="math display">\[\mathop{\mathrm{Op}}(p) v \in
{\mathop{\mathrm{h}}}^{r \nu} M.\]</span> When <span
class="math inline">\(M\)</span> is clear from context, we omit “inside
<span class="math inline">\(M\)</span>.” We say that <span
class="math inline">\(M\)</span> is <span
class="math inline">\((\mathfrak{g},\nu)\)</span>-localized at <span
class="math inline">\(\tau\)</span> if every <span
class="math inline">\(v \in M\)</span> has this property. When <span
class="math inline">\(\mathfrak{g}\)</span> is clear from context, we
write simply “<span class="math inline">\(\nu\)</span>-localized.”</p>
</div>
<div class="remark">
<p><strong>Remark 226</strong>. Definition <a
href="#defn:localized-vectors" data-reference-type="ref"
data-reference="defn:localized-vectors">225</a> depends upon the <span
class="math inline">\(\operatorname{O}(1)\)</span>-module <span
class="math inline">\(M\)</span> to which we regard <span
class="math inline">\(v\)</span> as belonging.</p>
</div>
<div id="rmk:r-=-0" class="remark">
<p><strong>Remark 227</strong>. The <span class="math inline">\(r =
0\)</span> case of the condition in Definition <a
href="#defn:localized-vectors" data-reference-type="ref"
data-reference="defn:localized-vectors">225</a> is equivalent to the
following: for fixed <span class="math inline">\(m \in
\mathbb{Z}_{\geqslant 0}\)</span> and fixed <span
class="math inline">\(x_1,\dotsc,x_m \in \mathfrak{g}\)</span>, we have
<span class="math display">\[\pi(x_1 \dotsb x_m) v \in
{\mathop{\mathrm{h}}}^{-m} M.\]</span></p>
</div>
<p>We record a simple criterion.</p>
<div id="lem:localization-criterion-degree-1" class="lemma">
<p><strong>Lemma 228</strong>. Let <span
class="math inline">\(M\)</span> be an <span
class="math inline">\(O(1)\)</span>-submodule of a <span
class="math inline">\(\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span>-module.
Suppose that for each <span class="math inline">\(v \in M\)</span> and
each fixed <span class="math inline">\(x \in \mathfrak{g}\)</span>, we
have <span class="math inline">\(\mathop{\mathrm{Op}}(x) v \equiv
x(\tau) v \mod{{\mathop{\mathrm{h}}}^\nu M}\)</span>. Then <span
class="math inline">\(M\)</span> is <span
class="math inline">\(\nu\)</span>-localized at <span
class="math inline">\(\tau\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We must show that for each fixed <span
class="math inline">\(r \in \mathbb{Z}_{\geqslant 0}\)</span> and each
polynomial <span class="math inline">\(p \in I^r_{0,\tau}\)</span>, we
have <span id="eqn:Opp-p-M-h-r-nu-M" class="math display">\[\label{eqn:Opp-p-M-h-r-nu-M}\tag{14.2}
    \mathop{\mathrm{Op}}(p) M \subseteq  {\mathop{\mathrm{h}}}^{r \nu}
M.\]</span> By linearity, we may assume that <span
class="math inline">\(p\)</span> is homogeneous and vanishes at <span
class="math inline">\(\tau\)</span> to order exactly <span
class="math inline">\(r\)</span>, and then further that <span
class="math inline">\(p(\xi) = \prod_{j=1}^r (x_j(\xi) -
x_j(\tau))\)</span> for some fixed <span
class="math inline">\(x_1,\dotsc,x_r \in \mathfrak{g}\)</span>. By
hypothesis, <span class="math inline">\(\mathop{\mathrm{Op}}(x_j -
x_j(\tau)) M \subseteq {\mathop{\mathrm{h}}}^{\nu} M\)</span>. Iterating
this hypothesis yields the required containment <a
href="#eqn:Opp-p-M-h-r-nu-M" data-reference-type="eqref"
data-reference="eqn:Opp-p-M-h-r-nu-M">\((14.2)\)</a>. ◻</p>
</div>
<h4 id="sec:sinfty_delta-modules">§14.3. <span
class="math inline">\(S^\infty_\delta\)</span>-modules</h4>
<div id="item:Sinfdelmod-3" class="definition">
<p><strong>Definition 229</strong>. <span
id="defn:s-infinity-delta-module"
label="defn:s-infinity-delta-module"></span> By an <em><span
class="math inline">\(S_\delta^\infty\)</span>-module</em>, we mean a
triple <span class="math inline">\((\underline{M}, M,
\mathop{\mathrm{Op}})\)</span>, where</p>
<ul>
<li><p><span class="math inline">\(\underline{M}\)</span> is a <span
class="math inline">\(\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span>-module,</p></li>
<li><p><span class="math inline">\(M \subseteq \underline{M}\)</span> is
an <span class="math inline">\(\operatorname{O}(1)\)</span>-submodule,
and</p></li>
<li><p><span class="math inline">\(\mathop{\mathrm{Op}}\)</span> is a
linear map <span class="math inline">\(\mathop{\mathrm{Op}}:
\underline{S}^\infty \rightarrow
\mathop{\mathrm{End}}(\underline{M})\)</span></p></li>
</ul>
<p>satisfying the following conditions.</p>
<ol type="i">
<li><p><span id="item:Sinfdelmod-1" label="item:Sinfdelmod-1"></span>
For each <span class="math inline">\(p \in
\mathop{\mathrm{Sym}}(\mathfrak{g})\)</span> and <span
class="math inline">\(v \in \underline{M}\)</span>, we have <span
class="math inline">\(\mathop{\mathrm{Op}}(p) v =
\mathop{\mathrm{sym}}(p_{\mathop{\mathrm{h}}}) v\)</span>.</p></li>
<li><p><span id="item:Sinfdelmod-2" label="item:Sinfdelmod-2"></span>
For each <span class="math inline">\(a \in S_\delta^\infty\)</span> and
<span class="math inline">\(v \in M\)</span>, we have <span
class="math inline">\(\mathop{\mathrm{Op}}(a) v \in M\)</span>. Thus
<span class="math inline">\(\mathop{\mathrm{Op}}(a)\)</span> defines a
class map <span class="math inline">\(M \rightarrow M\)</span>.</p></li>
<li><p>For each <span class="math inline">\(a,b \in
S^\infty_\delta\)</span> and <span class="math inline">\(v \in
M\)</span>, we have <span class="math inline">\(\mathop{\mathrm{Op}}(a)
\mathop{\mathrm{Op}}(b) v \equiv \mathop{\mathrm{Op}}(a
\star_{\mathop{\mathrm{h}}} b) v \pmod{{\mathop{\mathrm{h}}}^\infty
M}\)</span>.</p></li>
</ol>
<p>When we wish to emphasize which group is being considered, we write
more verbosely “<span
class="math inline">\(S^\infty_\delta(\mathfrak{g}^\wedge)\)</span>-module.”</p>
</div>
<p>We often abbreviate the tuple <span
class="math inline">\((\underline{M}, M, \mathop{\mathrm{Op}})\)</span>
by simply <span class="math inline">\(M\)</span>, and write, e.g., “Let
<span class="math inline">\(M\)</span> be an <span
class="math inline">\(S_\delta^\infty\)</span>-module.” We then refer to
<span class="math inline">\(\underline{M}\)</span> as the underlying
<span
class="math inline">\(\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span>-module
for <span class="math inline">\(M\)</span>.</p>
<div class="example">
<p><strong>Example 230</strong>. For any unitary representation <span
class="math inline">\(\pi\)</span> of <span
class="math inline">\(G\)</span>, the space <span
class="math inline">\(M := \pi^\infty\)</span> of smooth vectors is
naturally an <span
class="math inline">\(S_\delta^\infty\)</span>-module, but not a very
interesting one. The issue is that <span class="math inline">\(c M =
M\)</span> for <em>all</em> nonzero scalars <span
class="math inline">\(c\)</span>. In particular, <span
class="math inline">\({\mathop{\mathrm{h}}}^\ell M = M\)</span> for all
<span class="math inline">\(\ell\)</span>. The more interesting examples
noted below are obtained by restricting to proper subclasses of <span
class="math inline">\(\pi^{\infty}\)</span> consisting of vectors that
are “controlled” in a suitable sense.</p>
</div>
<div id="example:class-V-wavelength-h" class="example">
<p><strong>Example 231</strong>. Let <span
class="math inline">\(\pi\)</span> be a unitary representation of <span
class="math inline">\(G\)</span>. Let <span
class="math inline">\(\mathcal{V}\)</span> denote the class consisting
of all smooth vectors <span class="math inline">\(v \in \pi\)</span>
such that for (all fixed <span class="math inline">\(m \in
\mathbb{Z}_{\geqslant 0}\)</span> and) all fixed <span
class="math inline">\(x_1,\dotsc,x_m \in \mathfrak{g}\)</span>, we have
<span class="math display">\[\|\pi(x_1 \dotsb x_m) v\| \ll
{\mathop{\mathrm{h}}}^{-m}.\]</span> Then <span
class="math inline">\(\mathcal{V}\)</span> is naturally an <span
class="math inline">\(S^\infty_\delta\)</span>-module for each fixed
<span class="math inline">\(\delta \in [0,1/2)\)</span>. Explicitly, we
may take as the underlying <span
class="math inline">\(\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span>-module
the space of all smooth vectors in <span
class="math inline">\(\pi\)</span>, and define <span
class="math inline">\(\mathop{\mathrm{Op}}(a) v :=
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi) v\)</span> for some
<span class="math inline">\(\chi \in \mathcal{X}_{\delta_+}\)</span>,
with <span class="math inline">\(\delta_+ \in (\delta, 1/2)\)</span>
fixed.</p>
<p>Informally, <span class="math inline">\(\mathcal{V}\)</span> consists
of vectors having norm <span class="math inline">\(\ll 1\)</span> and
wavelength <span class="math inline">\(\gg
\mathop{\mathrm{h}}\)</span>.</p>
</div>
<div class="example">
<p><strong>Example 232</strong>. If <span
class="math inline">\(M\)</span> is an <span
class="math inline">\(S_\delta^\infty\)</span>-module, then so is <span
class="math inline">\(c M\)</span> for any scalar <span
class="math inline">\(c\)</span>. If <span class="math inline">\(c \ll
1\)</span>, then <span class="math inline">\(c M\)</span> is a <span
class="math inline">\(S_\delta^\infty\)</span>-submodule of <span
class="math inline">\(M\)</span>.</p>
</div>
<div id="exa:cal-W-delta-mirabolic" class="example">
<p><strong>Example 233</strong>. Take <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>, with mirabolic subgroup
<span class="math inline">\(P\)</span>. With <span
class="math inline">\(T := 1/\mathop{\mathrm{h}}\)</span>, the class
<span class="math inline">\(\mathcal{W}_\delta =
\mathfrak{W}(\pi,\psi,T,\delta)\)</span> (Definition <a
href="#defn:we-denote-mathfr-frakW" data-reference-type="ref"
data-reference="defn:we-denote-mathfr-frakW">148</a> and §<a
href="#sec:quant-prel" data-reference-type="ref"
data-reference="sec:quant-prel">5.2</a>), consisting of Whittaker
functions <span class="math inline">\(W \in
\mathcal{W}(\pi,\psi_T)\)</span> having certain smoothness and support
properties, is naturally an <span
class="math inline">\(S_\delta^\infty(\mathfrak{p}^\wedge)\)</span>-module
(Lemma <a href="#lem:class-map-defined-cal-W-delta-module"
data-reference-type="ref"
data-reference="lem:class-map-defined-cal-W-delta-module">254</a>). It
is not hard to see (Proposition <a href="#prop:local-with-resp-p"
data-reference-type="ref"
data-reference="prop:local-with-resp-p">255</a>) that, regarding <span
class="math inline">\(\mathcal{W}_\delta\)</span> as an <span
class="math inline">\(\operatorname{O}(1)\)</span>-submodule of a <span
class="math inline">\(\mathfrak{U}(\mathfrak{p}_\mathbb{C})\)</span>-module,
it is <span
class="math inline">\((\mathfrak{p},\delta)\)</span>-localized at <span
class="math inline">\(\theta = \theta_P(\psi)\)</span>. We will show
eventually (Theorem <a href="#thm:cal-W-delta-g-acts-localized"
data-reference-type="ref"
data-reference="thm:cal-W-delta-g-acts-localized">256</a>) that,
regarding <span class="math inline">\(\mathcal{W}_\delta\)</span> as an
<span class="math inline">\(\operatorname{O}(1)\)</span>-submodule of a
<span
class="math inline">\(\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span>-module,
it is <span
class="math inline">\((\mathfrak{g},\delta)\)</span>-localized at <span
class="math inline">\(\tau = \tau(\pi,\psi,T)\)</span>. This passage
from <span class="math inline">\(\mathfrak{p}\)</span> to <span
class="math inline">\(\mathfrak{g}\)</span> is the main step in the
proof of the main result (Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>) of
Part <a href="#part:asympt-analys-kirill" data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>. The main point of §<a
href="#sec:abstr-study-local" data-reference-type="ref"
data-reference="sec:abstr-study-local">3</a> is to encapsulate some of
the technical arguments required to justify that passage.</p>
</div>
<div id="example:delta-to-zero-module" class="example">
<p><strong>Example 234</strong>. If <span class="math inline">\(\delta_0
&lt; \delta\)</span>, then any <span
class="math inline">\(S^\infty_\delta\)</span>-module is naturally an
<span class="math inline">\(S^\infty_{\delta_0}\)</span>-module, hence
in particular an <span
class="math inline">\(S^\infty_0\)</span>-module.</p>
</div>
<p>The following result describes some basic properties of localized
vectors:</p>
<ol type="i">
<li><p>they are approximately annihilated by symbols that vanish in a
large enough neighborhood of the point at which they localize,
and</p></li>
<li><p>the condition of Definition <a href="#defn:localized-vectors"
data-reference-type="ref"
data-reference="defn:localized-vectors">225</a>, formulated using
polynomials, extends to more general symbols.</p></li>
</ol>
<div id="item:2-thm:S-infinity-modules-localized-stuff" class="theorem">
<p><strong>Theorem 235</strong>. <em><span
id="thm:S-infinity-modules-localized-stuff"
label="thm:S-infinity-modules-localized-stuff"></span> Fix <span
class="math inline">\(\delta \in [0,1/2)\)</span> and <span
class="math inline">\(\nu \in (0,1/2]\)</span>. Let <span
class="math inline">\(M\)</span> be an <span
class="math inline">\(S^\infty_\delta\)</span>-module. Let <span
class="math inline">\(v \in M\)</span> be <span
class="math inline">\(\nu\)</span>-localized at <span
class="math inline">\(\tau\)</span>.</em></p>
<ol type="i">
<li><p><em><span id="item:1-thm:S-infinity-modules-localized-stuff"
label="item:1-thm:S-infinity-modules-localized-stuff"></span> If <span
class="math inline">\(\nu &gt; \delta\)</span>, then <span
class="math inline">\(\mathop{\mathrm{Op}}(a) v \in
{\mathop{\mathrm{h}}}^\infty M\)</span> for each <span
class="math inline">\(a \in S^\infty_\delta\)</span> that vanishes on
<span class="math inline">\(\tau +
o({\mathop{\mathrm{h}}}^\delta)\)</span>.</em></p></li>
<li><p><em>If <span class="math inline">\(\delta &gt; 0\)</span>, then
<span class="math inline">\(\mathop{\mathrm{Op}}(a) v \in
{\mathop{\mathrm{h}}}^{r \nu} M\)</span> for each <span
class="math inline">\(a \in I_{0,\tau}^r\)</span> (not necessarily
polynomial).</em></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof of part (i).</em> We define <span class="math inline">\(d
\in S^2_0\)</span> by <span class="math inline">\(d(\xi) = |\xi -
\tau|^2\)</span>. Then <span class="math inline">\(d^r \in S^{2
r}_0\)</span> is a polynomial symbol that vanishes to order <span
class="math inline">\(2 r\)</span> at <span
class="math inline">\(\tau\)</span>, i.e., <span
class="math inline">\(d^r \in I_{0,\tau}^{2 r}\)</span>, so by
hypothesis, <span id="eq:oppdr-v-in" class="math display">\[\label{eq:oppdr-v-in}\tag{14.3}
    \mathop{\mathrm{Op}}(d^r) v \in {\mathop{\mathrm{h}}}^{2 r \nu }
M.\]</span></p>
<p>The proof consists of a few steps.</p>
<p><em>Step 1: discarding large frequencies.</em> First, we fix a radius
<span class="math inline">\(R &gt; 0\)</span> with <span
class="math inline">\(R \asymp 1\)</span>, taken large enough that <span
class="math inline">\(|\tau| \leqslant R/2\)</span>. We will verify that
<span class="math inline">\(\mathop{\mathrm{Op}}(a) v \in
{\mathop{\mathrm{h}}}^\infty M\)</span> for any <span
class="math inline">\(a \in S^0_0\)</span> for which <span
class="math inline">\(a(\xi) = 0\)</span> whenever <span
class="math inline">\(|\xi| \leqslant R\)</span>. To that end, we
construct for fixed <span class="math inline">\(\ell \geqslant
0\)</span> a symbol <span class="math inline">\(q \in S^{-2
\ell}_0\)</span> so that <span class="math display">\[q
\star_{\mathop{\mathrm{h}}} d^{\ell} \equiv a\pmod{
{\mathop{\mathrm{h}}}^\infty S^{-\infty} }.\]</span> We do this by setting
<span id="eqn:divide-star-prod-by-d-N" class="math display">\[\label{eqn:divide-star-prod-by-d-N}\tag{14.4}
    q_0 :=
    \frac{
      a
    }{
      d^\ell
    },
    \quad
    q_1 := \frac{- q_0 \star^1 d^\ell }{d^\ell},
    \quad
    q_2 :=
    \frac{- q_0 \star^2 d^\ell
      + q_1 \star^1 d^\ell
    }{
      d^\ell
    },\]</span> and so on, so that, formally, <span
class="math display">\[(\sum_{k \geqslant 0} {\mathop{\mathrm{h}}}^k q_k)
\star_{\mathop{\mathrm{h}}} d^\ell \sim a.\]</span> The point is that
division by <span class="math inline">\(d^\ell\)</span> is defined
because all symbols occurring in the numerators of <a
href="#eqn:divide-star-prod-by-d-N" data-reference-type="eqref"
data-reference="eqn:divide-star-prod-by-d-N">\((14.4)\)</a>
vanish near the origin. By iterated application of the quotient rule for
derivatives and the mapping properties <a
href="#eqn:star-j-new-mapping-property" data-reference-type="eqref"
data-reference="eqn:star-j-new-mapping-property">\((13.9)\)</a>
for <span class="math inline">\(\star^j\)</span>, we see that <span
class="math display">\[q_j \in S^{-2 \ell-j}_0.\]</span> Setting <span
class="math inline">\(q := \sum_{j \leqslant J} {\mathop{\mathrm{h}}}^j
q_k\)</span> for some small enough <span class="math inline">\(J \ggg
1\)</span> (in the sense afforded by Lemma <a
href="#lem:borel-summation" data-reference-type="ref"
data-reference="lem:borel-summation">222</a>), we have <span
class="math inline">\(q \in S^{-2 \ell}_0\)</span> and <span id="eqn:q-star-d-N-equiv-1-minus-a" class="math display">\[\label{eqn:q-star-d-N-equiv-1-minus-a}\tag{14.5}
    q \star_{\mathop{\mathrm{h}}} d^\ell \equiv a
\pmod{{\mathop{\mathrm{h}}}^\infty S^{-\infty}}.\]</span> By the
composition formula axiom <a href="#item:Sinfdelmod-3"
data-reference-type="eqref"
data-reference="item:Sinfdelmod-3">\((iii)\)</a> of Definition
<a href="#defn:s-infinity-delta-module" data-reference-type="ref"
data-reference="defn:s-infinity-delta-module">14.6</a>,
we deduce that <span id="eqn:composition-formula-appl-to-v-minus-opp-a-v" class="math display">\[\label{eqn:composition-formula-appl-to-v-minus-opp-a-v}\tag{14.6}
    \mathop{\mathrm{Op}}(a) v
    \equiv
    \mathop{\mathrm{Op}}(q) \mathop{\mathrm{Op}}(d^\ell) v
\mod{{\mathop{\mathrm{h}}}^\infty M}.\]</span> By axiom <a
href="#item:Sinfdelmod-2" data-reference-type="eqref"
data-reference="item:Sinfdelmod-2">\((ii)\)</a>, we have
<span class="math inline">\(\mathop{\mathrm{Op}}(q) M \subseteq
M\)</span>. By <a href="#eq:oppdr-v-in" data-reference-type="eqref"
data-reference="eq:oppdr-v-in">\((14.3)\)</a>, we have <span
class="math inline">\(\mathop{\mathrm{Op}}(d^\ell) v \in
{\mathop{\mathrm{h}}}^{2 \ell \nu} M\)</span>. Therefore <span
class="math inline">\(\mathop{\mathrm{Op}}(a) v \in
{\mathop{\mathrm{h}}}^{2 \ell \nu} M\)</span>. Since <span
class="math inline">\(\ell\)</span> was arbitrary, we conclude as
required that <span class="math inline">\(\mathop{\mathrm{Op}}(a) v \in
{\mathop{\mathrm{h}}}^\infty M\)</span>.</p>
<p><em>Step 2: reduction to symbols with support <span
class="math inline">\(\operatorname{O}(1)\)</span>.</em> Assuming now
that the lemma holds in the special case that <span
class="math inline">\(a\)</span> is supported on <span
class="math inline">\(\operatorname{O}(1)\)</span>, we deduce the
general case. To that end, we fix <span class="math inline">\(R &gt;
0\)</span> large enough, as in Step 1, and choose a symbol <span
class="math inline">\(c \in S^{-\infty}_0\)</span> taking the value
<span class="math inline">\(1\)</span> on <span
class="math inline">\(\{\xi : |\xi| \leqslant R\}\)</span> and vanishing
outside <span class="math inline">\(\{\xi : |\xi| &lt; 2 R\}\)</span>.
Here and henceforth, let <span class="math inline">\(\equiv\)</span>
denote equivalence modulo <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty M\)</span>. The symbol
<span class="math inline">\(c-1 \in S^0_0\)</span> vanishes on <span
class="math inline">\(\{ \xi : |\xi| \leqslant R \}\)</span>, so by Step
1, we have <span class="math inline">\(v \equiv \mathop{\mathrm{Op}}(c)
v\)</span>. It follows that for any <span class="math inline">\(a \in
S_\delta^\infty\)</span>, we have <span
class="math display">\[\mathop{\mathrm{Op}}(a) v \equiv
\mathop{\mathrm{Op}}(a) \mathop{\mathrm{Op}}(c) v \equiv
\mathop{\mathrm{Op}}(a \star_{\mathop{\mathrm{h}}} c) v.\]</span> (In
the first step, we used that <span
class="math inline">\(\mathop{\mathrm{Op}}(a) {\mathop{\mathrm{h}}}^\infty
M \subseteq {\mathop{\mathrm{h}}}^\infty M\)</span>, which is a
consequence of the more precise containment <span
class="math inline">\(\mathop{\mathrm{Op}}(a) M \subseteq M\)</span>
following from axiom <a href="#item:Sinfdelmod-2"
data-reference-type="eqref"
data-reference="item:Sinfdelmod-2">\((ii)\)</a>. In the
second step, we used axiom <a href="#item:Sinfdelmod-3"
data-reference-type="eqref"
data-reference="item:Sinfdelmod-3">\((iii)\)</a>.) Setting
<span class="math inline">\(b := \sum_{j \leqslant J}
{\mathop{\mathrm{h}}}^j a \star^j c\)</span> for any small enough <span
class="math inline">\(J \ggg 1\)</span> (Lemma <a
href="#lem:borel-summation" data-reference-type="ref"
data-reference="lem:borel-summation">222</a>), we have <span
class="math inline">\(b \in S^{-\infty}_\delta\)</span> and <span
class="math inline">\(\mathop{\mathrm{Op}}(a) v \equiv
\mathop{\mathrm{Op}}(b) v\)</span>. Suppose now that <span
class="math inline">\(a\)</span> vanishes on <span
class="math inline">\(\tau + o({\mathop{\mathrm{h}}}^\delta)\)</span>.
Since <span class="math inline">\(\mathop{\mathrm{supp}}(b) \subseteq
\mathop{\mathrm{supp}}(a) \cap \mathop{\mathrm{supp}}(c)\)</span>, we
see that <span class="math inline">\(b\)</span> vanishes on <span
class="math inline">\(\tau + o({\mathop{\mathrm{h}}}^\delta)\)</span> and
is supported on <span
class="math inline">\(\operatorname{O}(1)\)</span>. By our hypothesis
that the conclusion holds for symbols of support <span
class="math inline">\(\operatorname{O}(1)\)</span> (such as <span
class="math inline">\(b\)</span>), we have <span
class="math inline">\(\mathop{\mathrm{Op}}(b) v \in
{\mathop{\mathrm{h}}}^\infty M\)</span>. The required conclusion <span
class="math inline">\(\mathop{\mathrm{Op}}(a) v \in
{\mathop{\mathrm{h}}}^\infty M\)</span> then follows. This completes the
proof of the claimed reduction.</p>
<p><em>Step 3: completion of the proof.</em> We suppose now that <span
class="math inline">\(a \in S^{\infty}_\delta\)</span> is supported on
<span class="math inline">\(\operatorname{O}(1)\)</span> (hence lies in
<span class="math inline">\(S^{-\infty}_\delta\)</span>) and vanishes on
<span class="math inline">\(\tau +
o({\mathop{\mathrm{h}}}^\delta)\)</span>. By overspill, we may find a
fixed <span class="math inline">\(r_0 &gt; 0\)</span> so that <span
class="math inline">\(a\)</span> vanishes on <span
class="math inline">\(\{\tau + \xi : |\xi| \leqslant r_0
{\mathop{\mathrm{h}}}^{\delta}\}\)</span>. We repeat the division argument
described in Step 1 to obtain a symbol <span class="math inline">\(q \in
{\mathop{\mathrm{h}}}^{-2 \ell \delta} S^{-\infty}_\delta\)</span> for
which <a href="#eqn:q-star-d-N-equiv-1-minus-a"
data-reference-type="eqref"
data-reference="eqn:q-star-d-N-equiv-1-minus-a">\((14.5)\)</a>
holds. As before, <span class="math inline">\(\mathop{\mathrm{Op}}(a) v
\equiv \mathop{\mathrm{Op}}(q) \mathop{\mathrm{Op}}(d^\ell ) v \mod
{{\mathop{\mathrm{h}}}^\infty M}\)</span>. By hypothesis, <span
class="math inline">\(\mathop{\mathrm{Op}}(d^\ell) v \in
{\mathop{\mathrm{h}}}^{2 \ell \nu} M\)</span> and <span
class="math inline">\(\mathop{\mathrm{Op}}(q) M \subseteq
{\mathop{\mathrm{h}}}^{-2 \ell \delta} M\)</span>, hence <span
class="math inline">\(\mathop{\mathrm{Op}}(a) v \in
{\mathop{\mathrm{h}}}^{2 \ell (\nu - \delta)} M\)</span>. Since <span
class="math inline">\(\nu &gt; \delta\)</span>, we may conclude by
taking <span class="math inline">\(\ell\)</span> sufficiently
large. ◻</p>
</div>
<div class="proof">
<p><em>Proof of part (ii).</em> We may assume – after shrinking <span
class="math inline">\(\delta\)</span> as necessary (cf. Example <a
href="#example:delta-to-zero-module" data-reference-type="ref"
data-reference="example:delta-to-zero-module">234</a>) – that <span
class="math inline">\(0 &lt; \delta &lt; \nu\)</span>. In particular,
the conclusion of part (i) applies. Let <span class="math inline">\(a
\in I_{0,\tau}^r\)</span>. Fix <span class="math inline">\(\ell
\geqslant r\)</span>, and let <span class="math inline">\(p\)</span>
denote the Taylor polynomial approximation of degree <span
class="math inline">\(\ell\)</span> for <span
class="math inline">\(a\)</span> at <span
class="math inline">\(\tau\)</span>. Then <span class="math inline">\(p
\in S^\ell_0 \cap I_{\tau,0}^r\)</span>, so by hypothesis, <span
class="math inline">\(\mathop{\mathrm{Op}}(p) v \in
{\mathop{\mathrm{h}}}^{r \nu} M\)</span>. Set <span
class="math inline">\(q := a - p\)</span>. Then <span
class="math inline">\(q \in S^\infty_0\)</span>. Moreover, for <span
class="math inline">\(\xi \ll 1\)</span> and each fixed multi-index
<span class="math inline">\(\alpha\)</span>, we have by Taylor’s theorem
<span class="math display">\[\partial^\alpha q(\tau + \xi) \ll \min(1,
|\xi|^{\ell-|\alpha|}).\]</span> To estimate <span
class="math inline">\(\mathop{\mathrm{Op}}(q) v\)</span>, we choose an
“envelope” <span class="math inline">\(c \in S^{-\infty}_\delta\)</span>
for which <span class="math display">\[c(\xi) = \begin{cases}
      1 &amp; \text{ if } \xi = \tau + o({\mathop{\mathrm{h}}}^\delta), \\
      0 &amp;  \text{ if } \xi \neq \tau +
\operatorname{O}({\mathop{\mathrm{h}}}^\delta).
    \end{cases}\]</span> Then <span class="math inline">\(c-1\)</span>
vanishes on <span class="math inline">\(\tau +
o({\mathop{\mathrm{h}}}^\delta)\)</span>, so part (i) gives <span
class="math inline">\(v \equiv \mathop{\mathrm{Op}}(c) v
\mod{{\mathop{\mathrm{h}}}^\infty M}\)</span>. On the other hand, the
noted derivative bounds for <span class="math inline">\(q\)</span>,
together with the support condition on <span
class="math inline">\(c\)</span>, imply that <span
class="math inline">\(q \star_{\mathop{\mathrm{h}}} c \in
{\mathop{\mathrm{h}}}^{\ell \delta} S_\delta^{-\infty}\)</span>. Thus
<span class="math display">\[\mathop{\mathrm{Op}}(q) v \equiv
\mathop{\mathrm{Op}}(q) \mathop{\mathrm{Op}}(c) v \equiv
\mathop{\mathrm{Op}}(q \star_{\mathop{\mathrm{h}}} c) v \in
{\mathop{\mathrm{h}}}^{\ell \delta } M,\]</span> and so <span
class="math display">\[\mathop{\mathrm{Op}}(a) v =
\mathop{\mathrm{Op}}(p) v + \mathop{\mathrm{Op}}(q) v \in
{\mathop{\mathrm{h}}}^{r \nu} M + {\mathop{\mathrm{h}}}^{\ell \delta}
M.\]</span> Since <span class="math inline">\(\delta &gt; 0\)</span>, we
may choose <span class="math inline">\(\ell\)</span> large enough that
<span class="math inline">\(\ell \delta &gt; r \nu\)</span>. The proof
is then complete. ◻</p>
</div>
<h3 id="sec:local-refin-symb">§15. Localizing refined symbols near an
infinitesimal character </h3>
<p>In this section we record an estimate (Theorem <a
href="#thm:local-refin-symb" data-reference-type="ref"
data-reference="thm:local-refin-symb">236</a>) to be applied below in
§<a href="#sec:appr-idemp" data-reference-type="ref"
data-reference="sec:appr-idemp">6.10</a>. While we do not apply that
estimate further in this paper, it may be more broadly useful, so we
develop it here a bit more generally than required.</p>
<p>Throughout §<a href="#sec:local-refin-symb" data-reference-type="ref"
data-reference="sec:local-refin-symb">4</a>, we adopt the following
setting. Fix a connected reductive group <span
class="math inline">\(G\)</span> over the reals. Let <span
class="math inline">\(\mathop{\mathrm{h}}&gt; 0\)</span> with <span
class="math inline">\(\mathop{\mathrm{h}}\lll 1\)</span>. Let <span
class="math inline">\(\tau\)</span> belong to a fixed compact subset of
<span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>.
Fix <span class="math inline">\(0 &lt; \delta &#39; &lt; \delta
&#39;&#39; &lt; 2 \delta &#39; &lt; 1\)</span>. We may then define the
symbol class <span class="math inline">\(S^\tau_{\delta &#39;, \delta
&#39;&#39;}\)</span>.</p>
<h4 id="statement-of-result">Statement of result</h4>
<div id="thm:local-refin-symb" class="theorem">
<p><strong>Theorem 236</strong>. <em>Let <span
class="math inline">\(\pi\)</span> be an irreducible unitary
representation of <span class="math inline">\(G\)</span>. Let <span
class="math inline">\(a \in S^\tau_{\delta&#39;, \delta
&#39;&#39;}\)</span>. Suppose that <span class="math inline">\([\tau] =
\mathop{\mathrm{h}}\lambda_\pi\)</span> and that, in <span
class="math inline">\(\tau\)</span>-coordinates, <span id="eqn:xi-delta-primez-tau" class="math display">\[\label{eqn:xi-delta-primez-tau}\tag{15.1}
    \mathop{\mathrm{supp}}(a) \subseteq
    \left\{\xi : \xi&#39; - \tau &#39; \ll {\mathop{\mathrm{h}}}^{\delta
&#39;},
      \xi &#39;&#39; - \tau &#39;&#39; \gg {\mathop{\mathrm{h}}}^{\delta
&#39;&#39;}
    \right\}\]</span> Let <span class="math inline">\(\chi\)</span> be
any <span class="math inline">\((\tau, \delta &#39;, \delta
&#39;&#39;)\)</span>-admissible cutoff. Then <span
class="math inline">\(\mathop{\mathrm{Op}}(a) :=
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\pi, \chi )\)</span>
belongs to the operator class <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty
\Psi^{-\infty}\)</span>.</em></p>
</div>
<p>The proof is given in §<a href="#sec:completion-proof"
data-reference-type="ref" data-reference="sec:completion-proof">4.5</a>
after some preliminaries. The informal content is that if <span
class="math inline">\(a\)</span> is sufficiently separated from the
locus described by the infinitesimal character of <span
class="math inline">\(\pi\)</span>, then <span
class="math inline">\(\mathop{\mathrm{Op}}(a)\)</span> is negligibly
small. The result is “sharp up to epsilons” for reasons explained in the
final paragraph of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 2.4)</a>
.</p>
<p>We note that the special case of Theorem <a
href="#thm:local-refin-symb" data-reference-type="ref"
data-reference="thm:local-refin-symb">236</a> in which <span
class="math inline">\(\pi\)</span> is <em>tempered</em> follows from the
proof of <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P. D.
Nelson 2023, Lemma 14.3)</a>, which invoked the Kirillov character
formula. The main point of this section is to give a more general
argument that applies also in the non-tempered case. As a substitute for
the Kirillov formula, we integrate by parts with respect to the center
of the universal enveloping algebra.</p>
<h4 id="sec:">§15.2. Using invariant polynomials to separate a symbol from a
coadjoint orbit</h4>
<div id="lem:produce-inv-polynomials-large-on-symbol-support"
class="proposition">
<p><strong>Proposition 237</strong>. <em>Let <span
class="math inline">\(a \in S^\tau_{\delta &#39;, \delta
&#39;&#39;}\)</span> satisfy the support condition <a
href="#eqn:xi-delta-primez-tau" data-reference-type="eqref"
data-reference="eqn:xi-delta-primez-tau">\((15.1)\)</a>.
Set <span class="math inline">\(n :=
\mathop{\mathrm{rank}}(\mathfrak{g})\)</span>. There exist <span
class="math inline">\(a_1,\dotsc,a_n \in S^\tau_{\delta &#39;,
\delta&#39;&#39;}\)</span> and <span
class="math inline">\(G\)</span>-invariant polynomial symbols <span
class="math inline">\(f_1,\dotsc,f_n \in S^\infty_0\)</span> with the
following properties.</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(a = a_1 + \dotsb +
a_n\)</span>.</em></p></li>
<li><p><em><span class="math inline">\(f_1(\tau) = \dotsb = f_n(\tau) =
0\)</span>.</em></p></li>
<li><p><em><span class="math inline">\(f_j(\xi) \gg
{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span> for all <span
class="math inline">\(\xi \in
\mathop{\mathrm{supp}}(a_j)\)</span>.</em></p></li>
</ol>
</div>
<p>The proof is given below after a few preliminaries.</p>
<p>As noted in <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
9.2)</a>, the ring <span
class="math inline">\(\mathop{\mathrm{Sym}}(i \mathfrak{g})^G\)</span>
of real-valued <span class="math inline">\(G\)</span>-invariant
polynomials <span class="math inline">\(\mathfrak{g}^\wedge \rightarrow
\mathbb{R}\)</span> admits a finite set of algebraically independent
homogeneous generators <span
class="math inline">\(p_1,\dotsc,p_n\)</span>. Fixing such generators
yields an identification of <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span> with the Euclidean
space <span class="math inline">\(\mathbb{R}^n\)</span>. We may speak in
particular of the Euclidean distance, denoted <span
class="math inline">\(\mathop{\mathrm{dist}}(\lambda,\mu)\)</span>,
between elements of <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span>. Recall that we
have equipped the summands in the decomposition <span id="eqn:g-wedge-tau-decmop-std" class="math display">\[\label{eqn:g-wedge-tau-decmop-std}\tag{15.2}
  \mathfrak{g}^\wedge = \mathfrak{g}_\tau^\perp \oplus
\mathfrak{g}_{\tau}^{\perp \flat}\]</span> with Euclidean coordinates
defined using orthonormal bases.</p>
<p>We consider the map <span class="math display">\[\gamma :
\mathfrak{g}^\wedge \rightarrow \mathfrak{g}_\tau^\perp \times
[\mathfrak{g}^\wedge]\]</span> <span class="math display">\[\gamma(\xi)
:= (\xi &#39;, [\xi]).\]</span> This map yields a coordinate chart near
<span class="math inline">\(\tau\)</span>. Indeed, since the derivative
at <span class="math inline">\(\tau\)</span> of <span
class="math inline">\(\mathfrak{g}^\wedge \rightarrow
[\mathfrak{g}^\wedge]\)</span> is surjective and has kernel <span
class="math inline">\(\mathfrak{g}_\tau^\perp\)</span>, we see that the
derivative <span class="math inline">\((d \gamma)_\tau\)</span> at <span
class="math inline">\(\tau\)</span> of <span
class="math inline">\(\gamma\)</span> is given with respect to the
decomposition <a href="#eqn:g-wedge-tau-decmop-std"
data-reference-type="eqref"
data-reference="eqn:g-wedge-tau-decmop-std">\((15.2)\)</a>
by a block diagonal matrix <span class="math inline">\(\left(
  \begin{smallmatrix}
    1&amp;0\\
    0 &amp;M_\tau
  \end{smallmatrix}
\right)\)</span> consisting of the identity transformation <span
class="math inline">\(1\)</span> of <span
class="math inline">\(\mathfrak{g}_\tau^\perp\)</span> and an
isomorphism <span class="math display">\[M_\tau :
\mathfrak{g}_\tau^{\perp \flat} \rightarrow
T_{[\tau]}([\mathfrak{g}^\wedge]) \cong \mathbb{R}^n.\]</span></p>
<p>The operator norms of <span class="math inline">\(M_\tau\)</span> and
<span class="math inline">\(M_\tau^{-1}\)</span> are <span
class="math inline">\(\operatorname{O}(1)\)</span> for <span
class="math inline">\(\tau\)</span> as indicated. For <span
class="math inline">\(\xi = \tau + o(1)\)</span>, we have the operator
norm estimate <span id="eqn:estimate-d-gamma-xi-near-tau" class="math display">\[\label{eqn:estimate-d-gamma-xi-near-tau}\tag{15.3}
  (d \gamma)_{\xi}
  = \left(
    \begin{smallmatrix}
      1&amp;\\
      &amp;M_\tau
    \end{smallmatrix}
  \right) + \operatorname{O}(|\xi - \tau|).\]</span> In particular,
<span class="math inline">\((d \gamma)_{\xi}\)</span> and its inverse
have operator norms <span
class="math inline">\(\operatorname{O}(1)\)</span>. Since the second
partial derivatives of <span class="math inline">\(\gamma\)</span> on
arguments <span class="math inline">\(\xi = \tau + o(1)\)</span> are of
size <span class="math inline">\(\operatorname{O}(1)\)</span>, we deduce
that for <span class="math inline">\(r \lll 1\)</span>, the restriction
of <span class="math inline">\(\gamma\)</span> to the ball <span
class="math inline">\(\{\xi : |\xi - \tau| &lt; r\}\)</span> defines a
diffeomorphism onto its image that approximately preserves distances in
the sense that <span class="math inline">\(|\xi-\eta| \asymp
\mathop{\mathrm{dist}}(\gamma(\xi), \gamma(\eta))\)</span>.
(Alternatively, we could have appealed here to Lemma <a
href="#lem:controlled-uniform-continuity-origin"
data-reference-type="ref"
data-reference="lem:controlled-uniform-continuity-origin">99</a>.)</p>
<p>For any smooth function <span class="math inline">\(a :
\mathfrak{g}^\wedge \rightarrow \mathbb{C}\)</span> supported on <span
class="math inline">\(\tau + o(1)\)</span>, we obtain a smooth function
<span class="math display">\[\tilde{a} : \mathfrak{g}_\tau^\perp \times
[\mathfrak{g}^\wedge] \rightarrow \mathbb{C},\]</span> supported on
<span class="math inline">\(\gamma(\tau) + o(1)\)</span> and given there
by <span id="eq:tild-:=-axi" class="math display">\[\label{eq:tild-:=-axi}\tag{15.4}
  \tilde{a}(\gamma(\xi)) := a(\xi).\]</span></p>
<p>Let <span class="math inline">\(\tilde{S}^{\tau}_{\delta &#39;,
\delta &#39;&#39;}\)</span> denote the class consisting of smooth
functions <span class="math inline">\(\tilde{a}\)</span> as above that
are supported on <span class="math inline">\(\gamma(\tau) +
\operatorname{O}({\mathop{\mathrm{h}}}^{ \delta &#39;&#39; -
\delta&#39;})\)</span> and satisfy the derivative bounds <span id="eqn:tilde-a-deriv-bounds" class="math display">\[\label{eqn:tilde-a-deriv-bounds}\tag{15.5}
  \partial_{\xi &#39;}^{\alpha&#39;}
  \partial_{\lambda}^{\alpha &#39;&#39;}
  \tilde{a}(\xi &#39;, \lambda )
  \ll
  {\mathop{\mathrm{h}}}^{- \delta &#39; |\alpha &#39;|
    - \delta &#39;&#39;| \alpha &#39;&#39;|}.\]</span></p>
<div class="lemma">
<p><strong>Lemma 238</strong>. Let <span class="math inline">\(a :
\mathfrak{g}^\wedge \rightarrow \mathbb{C}\)</span> and <span
class="math inline">\(\tilde{a} : \mathfrak{g}_\tau^{\perp} \times
[\mathfrak{g}^\wedge] \rightarrow \mathbb{C}\)</span> be smooth
functions, supported respectively on <span class="math inline">\(\tau +
o(1)\)</span> and <span class="math inline">\(\gamma(\tau) +
o(1)\)</span>, and related as in <a href="#eq:tild-:=-axi"
data-reference-type="eqref"
data-reference="eq:tild-:=-axi">\((15.4)\)</a>. The following
conditions are equivalent.</p>
<ol type="i">
<li><p><span class="math inline">\(a \in S_{\delta &#39;, \delta
&#39;&#39;}^{\tau}\)</span>.</p></li>
<li><p><span class="math inline">\(\tilde{a} \in
\tilde{S}^{\tau}_{\delta &#39;, \delta &#39;&#39;}\)</span>.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> We follow the proof of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, Lemma 9.9)</a>
line-by-line. The crucial estimate is <a
href="#eqn:estimate-d-gamma-xi-near-tau" data-reference-type="eqref"
data-reference="eqn:estimate-d-gamma-xi-near-tau">\((15.3)\)</a>. ◻</p>
</div>
<p>We note also that a smooth function <span class="math inline">\(f :
\mathfrak{g}^\wedge \rightarrow \mathbb{C}\)</span> is a <span
class="math inline">\(G\)</span>-invariant polynomial if and only if the
corresponding function <span class="math inline">\(\tilde{f}\)</span>,
defined via <a href="#eq:tild-:=-axi" data-reference-type="eqref"
data-reference="eq:tild-:=-axi">\((15.4)\)</a>, is given by a
polynomial function of the second coordinate.</p>
<p>With these preliminaries settled, we now proceed:</p>
<div class="proof">
<p><em>Proof of Proposition <a
href="#lem:produce-inv-polynomials-large-on-symbol-support"
data-reference-type="ref"
data-reference="lem:produce-inv-polynomials-large-on-symbol-support">237</a>.</em>
Let <span class="math inline">\(\xi\)</span> be an element of the
support of <span class="math inline">\(a\)</span>. We consider the
second order Taylor expansion of <span
class="math inline">\([\xi]\)</span> based at <span
class="math inline">\(\tau\)</span>: <span class="math display">\[[\xi]
= [\tau] + M_\tau (\xi &#39;&#39; - \tau &#39;&#39;) +
\operatorname{O}(|\xi - \tau |^2).\]</span> Since <span
class="math inline">\(|\xi - \tau |^2 \ll {\mathop{\mathrm{h}}}^{2 \delta
&#39;} \lll {\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span> and <span
class="math inline">\(|\xi &#39;&#39; - \tau &#39;&#39;| \gg
{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span>, we deduce from the
noted operator norm bound <span class="math inline">\(M_\tau ^{-1} =
\operatorname{O}(1)\)</span> that <span class="math display">\[|[\xi] -
[\tau]| \asymp |\xi &#39;&#39; - \tau &#39;&#39;| \gg
{\mathop{\mathrm{h}}}^{ \delta &#39;&#39;}.\]</span> Moreover, since <span
class="math inline">\(\xi = \tau +
\operatorname{O}({\mathop{\mathrm{h}}}^{\delta &#39;})\)</span>, we have
<span class="math display">\[\gamma(\xi) = \gamma(\tau) +
\operatorname{O}({\mathop{\mathrm{h}}}^{\delta &#39;}).\]</span></p>
<p>Define <span class="math inline">\(\tilde{a} \in
\tilde{S}^{\tau}_{\delta &#39;, \delta &#39;&#39;}\)</span> as above.
Then <span class="math inline">\(\tilde{a}(\xi &#39;, \lambda)\)</span>
is supported on <span class="math inline">\(\lambda - [\tau] \gg
{\mathop{\mathrm{h}}}^{ \delta &#39;&#39;}\)</span>. Writing <span
class="math inline">\(\lambda = (\lambda_1,\dotsc,\lambda_n)\)</span>
and <span class="math inline">\([\tau] =
([\tau]_1,\dotsc,[\tau]_n)\)</span> with respect to the identification
of <span class="math inline">\([\mathfrak{g}^\wedge]\)</span> with <span
class="math inline">\(\mathbb{R}^n\)</span>, we may smoothly decompose
<span class="math display">\[\tilde{a} = \tilde{a}_1 + \dotsb +
\tilde{a}_n,\]</span> where <span class="math inline">\(\tilde{a}_j \in
\tilde{S}^{\tau}_{\delta &#39;, \delta &#39;&#39;}\)</span> is supported
on <span class="math inline">\(\lambda_j - [\tau]_j \gg
{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span>. The required
conclusion holds with <span
class="math inline">\(a_1,\dotsc,a_n\)</span> the corresponding elements
of <span class="math inline">\(S^{\tau}_{\delta &#39;, \delta
&#39;&#39;}\)</span> and <span class="math inline">\(f_j(\xi) := [\xi]_j
- [\tau]_j\)</span>. ◻</p>
</div>
<h4 id="sec:harish-chandra-vs">§15.3. Harish–Chandra vs. symmetrization</h4>
<p>Consider the composition <span id="eqn:HACH-sym" class="math display">\[\label{eqn:HACH-sym}\tag{15.6}
  \mathop{\mathrm{Sym}}(\mathfrak{g}_\mathbb{C})^G
  \xrightarrow{\mathop{\mathrm{sym}}}
\mathfrak{Z}(\mathfrak{g}_\mathbb{C})
  \xrightarrow{\mathop{\mathrm{HC}}}
  \mathop{\mathrm{Sym}}(\mathfrak{g}_\mathbb{C})^G.\]</span> Recall that
<span class="math inline">\(\mathop{\mathrm{sym}}\)</span> is a vector
space isomorphism and <span
class="math inline">\(\mathop{\mathrm{HC}}\)</span> is an algebra
isomorphism.</p>
<p>This composition is typically not the identity map, but converges to
the identity in the “classical limit,” e.g., in the sense of the lemma
recorded below.</p>
<p>Let <span class="math inline">\(f \in S^\infty_0\)</span> be a
polynomial symbol. Let <span class="math inline">\(f&#39;\)</span>
denote the polynomial for which <span
class="math inline">\(f_{\mathop{\mathrm{h}}}&#39; := [\xi \mapsto
f&#39;(\mathop{\mathrm{h}}\xi)]\)</span> is the inverse image of <span
class="math inline">\(f_{\mathop{\mathrm{h}}} := [\xi \mapsto
f(\mathop{\mathrm{h}}\xi)]\)</span> under the above composition. Thus
<span
class="math inline">\(\mathop{\mathrm{HC}}(\mathop{\mathrm{sym}}(f_{\mathop{\mathrm{h}}}&#39;))
= f_{\mathop{\mathrm{h}}}\)</span>. By <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
5.2)</a>, we have <span
class="math display">\[\mathop{\mathrm{Op}}(f&#39;) =
f(\mathop{\mathrm{h}}\lambda_\pi),\]</span> i.e., <span
class="math inline">\(\mathop{\mathrm{Op}}(f&#39;)\)</span> is the
scalar operator on <span class="math inline">\(\pi\)</span> given by
multiplication by <span
class="math inline">\(f(\mathop{\mathrm{h}}\lambda_\pi)\)</span>.</p>
<div class="lemma">
<p><strong>Lemma 239</strong>. We have <span
class="math inline">\(f&#39; \in S^\infty_0\)</span> and <span
class="math inline">\(f &#39; - f
\in  \mathop{\mathrm{h}}S^\infty_0\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> As noted in <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
9.9)</a>, the composition <a href="#eqn:HACH-sym"
data-reference-type="eqref"
data-reference="eqn:HACH-sym">\((15.6)\)</a> has the property that
if <span class="math inline">\(p \in
\mathop{\mathrm{Sym}}(\mathfrak{g}_\mathbb{C})^G\)</span> has order
<span class="math inline">\(\leqslant n\)</span>, then <span
class="math inline">\(\mathop{\mathrm{HC}}(\mathop{\mathrm{sym}}(p)) -
p\)</span> has order <span class="math inline">\(\leqslant n-1\)</span>.
The conclusion follows readily from this (see <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
10.3)</a> for further details). ◻</p>
</div>
<h4 id="division-by-an-invariant-symbol">Division by an invariant
symbol</h4>
<p>The technique of approximately dividing one symbol by another is
pervasive in microlocal analysis. Some applications of that technique
were recorded in <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(P. D. Nelson and Venkatesh 2021, sec.
10)</a>. We record here a further application.</p>
<div id="prop:divide-by-G-inv-symb" class="proposition">
<p><strong>Proposition 240</strong>. <em>Let <span
class="math inline">\(a \in S_{\delta &#39;, \delta
&#39;&#39;}^{\tau}\)</span>. Let <span class="math inline">\(f \in
S^\infty_0\)</span> be <span class="math inline">\(G\)</span>-invariant.
Suppose that <span class="math inline">\(f(\xi) \gg
{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span> for all <span
class="math inline">\(\xi \in \mathop{\mathrm{supp}}(a)\)</span>. Then
there exist <span class="math inline">\(b, b&#39; \in
{\mathop{\mathrm{h}}}^{-\delta &#39;&#39;} S^\tau_{\delta&#39;, \delta
&#39;&#39;}\)</span> so that <span class="math display">\[a \equiv f
\star_{\mathop{\mathrm{h}}} b \mod{{\mathop{\mathrm{h}}}^\infty
S^{-\infty}},\]</span> <span class="math display">\[a \equiv b&#39;
\star_{\mathop{\mathrm{h}}} f \mod{{\mathop{\mathrm{h}}}^\infty
S^{-\infty}}.\]</span></em></p>
</div>
<p>The proof requires a few preliminaries.</p>
<p>Working in <span class="math inline">\(\tau\)</span>-coordinates
<span class="math inline">\(\xi = (\xi &#39;, \xi &#39;&#39;)\)</span>,
we write <span class="math inline">\(\partial_1^{\alpha &#39;}
\partial_2^{\alpha &#39;&#39;}\)</span> for the differential operator
given by <span class="math inline">\(\alpha &#39;\)</span> and <span
class="math inline">\(\alpha &#39;&#39;\)</span> partial derivatives in
the <span class="math inline">\(\xi&#39;\)</span> and <span
class="math inline">\(\xi &#39;&#39;\)</span> variables,
respectively.</p>
<div id="lem:derivatives-along-orbits-inv-fn" class="lemma">
<p><strong>Lemma 241</strong>. Let <span class="math inline">\(\tau \in
\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span>. Let <span
class="math inline">\(f \in C^\infty(\mathfrak{g}^\wedge)\)</span> be
<span class="math inline">\(G\)</span>-invariant. Then in <span
class="math inline">\(\tau\)</span>-coordinates, we have <span
class="math display">\[|\alpha &#39;| =1 \quad \implies \quad
\partial_{1}^{\alpha &#39;} f(\tau) = 0.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This follows from the fact that <span
class="math inline">\(\mathfrak{g}_\tau^\perp\)</span> is the tangent
plane at <span class="math inline">\(\tau\)</span> to the coadjoint
orbit containing <span class="math inline">\(\tau\)</span> and that
<span class="math inline">\(f\)</span> is constant on each such
orbit. ◻</p>
</div>
<div id="lem:star-j-against-invariant-function" class="lemma">
<p><strong>Lemma 242</strong>. Let <span class="math inline">\(f \in
S_0^\infty\)</span> be <span class="math inline">\(G\)</span>-invariant.
Let <span class="math inline">\(a \in S^\tau_{\delta &#39;, \delta
&#39;&#39;}\)</span>.</p>
<ol type="i">
<li><p>We have <span class="math inline">\(f \star^1 a =
0\)</span>.</p></li>
<li><p>For fixed <span class="math inline">\(j \in \mathbb{Z}_{\geqslant
2}\)</span>, we have <span class="math inline">\(f \star^j a \in
{\mathop{\mathrm{h}}}^{\delta &#39;&#39; - 2 j \delta &#39;} S_{\delta
&#39;, \delta &#39;&#39;}^\tau\)</span>.</p></li>
</ol>
<p>Analogous results hold for <span class="math inline">\(a \star^j
f\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> (i): The restriction of <span class="math inline">\(f
\star^1 a\)</span> to a coadjoint orbit is a multiple of the Poisson
bracket of the restrictions of <span class="math inline">\(f\)</span>
and <span class="math inline">\(a\)</span> (cf. <a href="#ref-gutt1983explicit" class="citation"
data-cites="gutt1983explicit">(Gutt 1983)</a>). Since <span
class="math inline">\(f\)</span> is <span
class="math inline">\(G\)</span>-invariant, its restriction to each such
orbit is constant, and so the Poisson bracket in question vanishes. This
completes the proof.</p>
<p>As motivation for the proof of (ii), we pause to reprove (i) using
“bare hands.” It suffices to verify that the quantity <span
class="math inline">\(f \star^1 a(\tau)\)</span> vanishes. By the
support condition <a href="#eq:alpha-refined-support-condition"
data-reference-type="eqref"
data-reference="eq:alpha-refined-support-condition">\((13.7)\)</a>
for the coefficients defining the star product, we may write this
quantity as a finite linear combination of terms <span
class="math display">\[\left( \partial_1^{\alpha &#39;} f(\tau) \right)
\left( \partial_1^{\beta &#39;} a(\tau) \right) \left( \tau^\gamma
\right), \quad |\alpha &#39;| = |\beta &#39;| = |\gamma| = 1,\]</span>
where the differential operators are defined using <span
class="math inline">\(\tau\)</span>-coordinates. By lemma <a
href="#lem:derivatives-along-orbits-inv-fn" data-reference-type="ref"
data-reference="lem:derivatives-along-orbits-inv-fn">241</a>, each of
these terms vanish.</p>
<p>(ii): By lemma <a href="#lem:basepoint-insensitivity"
data-reference-type="ref"
data-reference="lem:basepoint-insensitivity">202</a>, it suffices to
verify that <span class="math inline">\(f \star^j a\)</span>, for fixed
<span class="math inline">\(j \geqslant 2\)</span>, satisfies the
required derivative bounds at <span class="math inline">\(\tau\)</span>.
By the support condition <a href="#eq:alpha-refined-support-condition"
data-reference-type="eqref"
data-reference="eq:alpha-refined-support-condition">\((13.7)\)</a>
for the coefficients defining the star product and the product rule for
differentiation, we may write <span
class="math inline">\(\partial_1^{\kappa &#39;} \partial_2^{\kappa
&#39;&#39;} (f \star^j a)(\tau)\)</span> as a finite linear combination
of terms <span class="math display">\[\left( \partial_{1}^{\alpha &#39;
+ \mu &#39;} \partial_2^{\alpha &#39;&#39; + \mu &#39;&#39;} f(\tau)
\right) \left( \partial_{1}^{\beta &#39; + \nu &#39;} \partial_2^{\beta
&#39;&#39; + \nu &#39;&#39;} a(\tau) \right) \left( \partial_1^{\kappa
&#39;} \partial_2^{\kappa &#39;&#39;} \tau^{\gamma} \right)\]</span>
where <span class="math display">\[\lambda &#39; + \mu &#39; + \nu &#39;
= \kappa &#39;, \quad \lambda &#39;&#39; + \mu &#39;&#39; + \nu
&#39;&#39; = \kappa &#39;&#39;\]</span> and <span id="eqn:key-alpha-beta-ineqs" class="math display">\[\label{eqn:key-alpha-beta-ineqs}\tag{15.7}
    |\alpha &#39;| + |\beta &#39;|
    +
    2 |\alpha &#39;&#39;| + 2 |\beta &#39;&#39;|
    \leqslant 2 j,
    \quad
    |\alpha &#39;| + |\alpha &#39;&#39;| \geqslant 1,
    \quad
    |\beta &#39;| + |\beta &#39;&#39;| \geqslant 1.\]</span> We must
check that any such term is <span class="math display">\[\ll
{\mathop{\mathrm{h}}}^{- \delta &#39; |\kappa &#39;| - \delta &#39;&#39; |
\kappa &#39;&#39;| + \delta &#39;&#39; - 2 j \delta &#39;}.\]</span>
Since <span class="math inline">\(a \in S^\tau_{\delta &#39;, \delta
&#39;&#39;}\)</span>, we have <span id="eqn:estimates-for-a-for-f-star-a" class="math display">\[\label{eqn:estimates-for-a-for-f-star-a}\tag{15.8}
    \partial_{1}^{\beta &#39; + \nu &#39;} \partial_2^{\beta &#39;&#39;
+ \nu &#39;&#39;} a(\tau)
    \ll
    {\mathop{\mathrm{h}}}^{- \delta &#39;( |\beta &#39;| +  |\nu &#39;|) -
\delta &#39;&#39;(|\beta &#39;&#39;| + |\nu &#39;&#39;|)},\]</span> so
it is enough to check that <span id="eqn:f-star-a-desiderata-f" class="math display">\[\label{eqn:f-star-a-desiderata-f}\tag{15.9}
    \partial_{1}^{\alpha &#39; + \mu &#39;} \partial_2^{\alpha
&#39;&#39; + \mu &#39;&#39;} f(\tau)
    {\mathop{\mathrm{h}}}^{ - \delta &#39; |\beta &#39;|-  \delta
&#39;&#39;|\beta &#39;&#39;|}
    \ll
    {\mathop{\mathrm{h}}}^{- \delta &#39; |\mu &#39;| - \delta &#39;&#39;
| \mu &#39;&#39;| + \delta &#39;&#39; - 2 j \delta &#39;}.\]</span></p>
<p>The function <span class="math inline">\(f\)</span> enjoys the
estimates <span id="eqn:f-has-mild-alpha-mu-derivs" class="math display">\[\label{eqn:f-has-mild-alpha-mu-derivs}\tag{15.10}
    \partial_{1}^{\alpha &#39; + \mu &#39;} \partial_2^{\alpha
&#39;&#39; + \mu &#39;&#39;} f(\tau)
    \ll 1\]</span> and, by lemma <a
href="#lem:derivatives-along-orbits-inv-fn" data-reference-type="ref"
data-reference="lem:derivatives-along-orbits-inv-fn">241</a>, <span id="eqn:f-star-a-f-vanishing-condition" class="math display">\[\label{eqn:f-star-a-f-vanishing-condition}\tag{15.11}
    \partial_{1}^{\alpha &#39; + \mu &#39;} \partial_2^{\alpha
&#39;&#39; + \mu &#39;&#39;} f(\tau)
    = 0 \text{ if } |\alpha &#39; + \mu &#39;| = 1, \, |\alpha
&#39;&#39; + \mu &#39;&#39;| = 0.\]</span> In particular, the analogue
of <a href="#eqn:estimates-for-a-for-f-star-a"
data-reference-type="eqref"
data-reference="eqn:estimates-for-a-for-f-star-a">\((15.8)\)</a>
for <span class="math inline">\(f\)</span> <span id="eqn:estimates-for-a-for-f-star-f" class="math display">\[\label{eqn:estimates-for-a-for-f-star-f}\tag{15.12}
    \partial_{1}^{\alpha &#39; + \mu &#39;} \partial_2^{\alpha
&#39;&#39; + \mu &#39;&#39;} f(\tau)
    \ll
    {\mathop{\mathrm{h}}}^{- \delta &#39;( |\alpha &#39;| +  |\mu &#39;|)
- \delta &#39;&#39;(|\alpha &#39;&#39;| + |\mu &#39;&#39;|)}\]</span> is
valid, but typically much weaker than reality. It is nevertheless
instructive to note that this last estimate quite nearly yields <a
href="#eqn:f-star-a-desiderata-f" data-reference-type="eqref"
data-reference="eqn:f-star-a-desiderata-f">\((15.9)\)</a>:
it gives that the LHS of <a href="#eqn:f-star-a-desiderata-f"
data-reference-type="eqref"
data-reference="eqn:f-star-a-desiderata-f">\((15.9)\)</a>
is <span class="math display">\[{\mathop{\mathrm{h}}}^{- \delta &#39; |\mu
&#39;| - \delta &#39;&#39; | \mu &#39;&#39;| - \delta &#39; |\alpha
&#39;| - \delta &#39; |\beta &#39;| - \delta &#39;&#39; | \alpha
&#39;&#39; | - \delta &#39;&#39; |\beta &#39;&#39;| },\]</span> which,
thanks to <a href="#eqn:key-alpha-beta-ineqs"
data-reference-type="eqref"
data-reference="eqn:key-alpha-beta-ineqs">\((15.7)\)</a>,
is merely a factor <span
class="math inline">\({\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span>
shy of the required estimate <a href="#eqn:f-star-a-desiderata-f"
data-reference-type="eqref"
data-reference="eqn:f-star-a-desiderata-f">\((15.9)\)</a>.
It will thus suffice to improve the estimate <a
href="#eqn:estimates-for-a-for-f-star-f" data-reference-type="eqref"
data-reference="eqn:estimates-for-a-for-f-star-f">\((15.12)\)</a>
by at least a factor of <span
class="math inline">\({\mathop{\mathrm{h}}}^{\delta
&#39;&#39;}\)</span>.</p>
<p>If <span class="math inline">\(|\alpha &#39;&#39; + \mu &#39;&#39;|
\geqslant 1\)</span>, then the required improvement is immediate from <a
href="#eqn:f-has-mild-alpha-mu-derivs" data-reference-type="eqref"
data-reference="eqn:f-has-mild-alpha-mu-derivs">\((15.10)\)</a>,
so we may suppose that <span class="math inline">\(\alpha &#39;&#39; =
\mu &#39;&#39; = 0\)</span>. If <span class="math inline">\(|\alpha
&#39; + \mu &#39;| \geqslant 2\)</span>, then we may again apply <a
href="#eqn:f-has-mild-alpha-mu-derivs" data-reference-type="eqref"
data-reference="eqn:f-has-mild-alpha-mu-derivs">\((15.10)\)</a>
to improve <a href="#eqn:estimates-for-a-for-f-star-f"
data-reference-type="eqref"
data-reference="eqn:estimates-for-a-for-f-star-f">\((15.12)\)</a>
by a factor <span class="math inline">\({\mathop{\mathrm{h}}}^{2 \delta
&#39;} \leqslant{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span>. If
<span class="math inline">\(|\alpha &#39; + \mu &#39;| = 1\)</span>,
then the LHS of <a href="#eqn:estimates-for-a-for-f-star-f"
data-reference-type="eqref"
data-reference="eqn:estimates-for-a-for-f-star-f">\((15.12)\)</a>
vanishes in view of <a href="#eqn:f-star-a-f-vanishing-condition"
data-reference-type="eqref"
data-reference="eqn:f-star-a-f-vanishing-condition">\((15.11)\)</a>.
The remaining case <span class="math inline">\(\alpha &#39; = \mu &#39;
= 0\)</span> does not arise due to the inequality <span
class="math inline">\(|\alpha &#39;| + |\alpha &#39;&#39;| \geqslant
1\)</span> noted in <a href="#eqn:key-alpha-beta-ineqs"
data-reference-type="eqref"
data-reference="eqn:key-alpha-beta-ineqs">\((15.7)\)</a>.
The proof is now complete. ◻</p>
</div>
<div id="lem:b0-in-h-neg-delta-dubprime" class="lemma">
<p><strong>Lemma 243</strong>. Under the hypotheses of Proposition <a
href="#prop:divide-by-G-inv-symb" data-reference-type="ref"
data-reference="prop:divide-by-G-inv-symb">240</a>, we have <span
class="math inline">\(a/f \in {\mathop{\mathrm{h}}}^{- \delta &#39;&#39;}
S_{\delta&#39;, \delta &#39;&#39;}^{\tau}\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> The support condition is clear. We must check the
derivative bounds. By lemma <a href="#lem:basepoint-insensitivity"
data-reference-type="ref"
data-reference="lem:basepoint-insensitivity">202</a>, it will suffice to
check those bounds at the point <span
class="math inline">\(\tau\)</span>. We may assume that <span
class="math inline">\(\tau \in \mathop{\mathrm{supp}}(a)\)</span>, so
that, by hypothesis, <span class="math inline">\(f(\tau) \gg
{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span>. Since <span
class="math inline">\(a \in S^\tau_{\delta &#39;, \delta
&#39;&#39;}\)</span>, we may reduce via the product rule for derivatives
to verifying that <span class="math inline">\(1/f\)</span> satisfies, at
the point <span class="math inline">\(\tau\)</span>, the derivative
bounds <span id="eqn:required-partials-for-1-over-f" class="math display">\[\label{eqn:required-partials-for-1-over-f}\tag{15.13}
    \partial_{1}^{\alpha &#39;}
    \partial_{2}^{\alpha &#39;&#39;} \frac{1}{f}(\tau) \ll
    {\mathop{\mathrm{h}}}^{- \delta &#39;&#39; - \delta &#39;
|\alpha&#39;| - \delta &#39;&#39; |\alpha &#39;&#39;|}.\]</span></p>
<p>To that end, observe first for a smooth function <span
class="math inline">\(\phi\)</span> of one variable, the <span
class="math inline">\(n\)</span>th derivative <span
class="math inline">\((1/\phi)^{(n)}\)</span> of <span
class="math inline">\(1/\phi\)</span> may be written using the quotient
rule for derivatives as a linear combination of terms <span
class="math display">\[\frac{1}{\phi } \left( \frac{\phi^{(1)} }{\phi }
\right)^{e_1} \left( \frac{\phi^{(2)} }{\phi } \right)^{e_2} \dotsb
\left( \frac{\phi^{(n)} }{\phi } \right)^{e_n}\]</span> where the
exponents <span class="math inline">\(e_1,\dotsc,e_n\)</span> are
nonnegative integers satisfying <span class="math inline">\(\sum j e_j =
n\)</span>. Note in particular that if at some point the first
derivative <span class="math inline">\(\phi^{(1)}\)</span> vanishes but
<span class="math inline">\(\phi\)</span> does not vanish, then the
above expression vanishes unless <span class="math inline">\(e_1 =
0\)</span>, in which case <span class="math inline">\(\sum e_j \leqslant
n/2\)</span>, and so the total number of denominator factors <span
class="math inline">\(\phi\)</span> is at most <span
class="math inline">\(1 + n/2\)</span> .</p>
<p>Similar observations apply to partial derivatives in higher
dimensions. Writing <span class="math inline">\(m := |\alpha
&#39;|\)</span> and <span class="math inline">\(n := |\alpha
&#39;&#39;|\)</span>, we may express the LHS of <a
href="#eqn:required-partials-for-1-over-f" data-reference-type="eqref"
data-reference="eqn:required-partials-for-1-over-f">\((15.13)\)</a>
as a linear combination of terms <span id="eqn:terms-for-partial-derivs-of-f" class="math display">\[\label{eqn:terms-for-partial-derivs-of-f}\tag{15.14}
    \frac{1}{f}
    \prod_{i=0}^{m}
    \prod_{j=0}^{n}
    \frac{
      (\partial_1^i \partial_2^j f)^{a_{i j}}
    }{f^{a_{i j}}}
    (\tau),\]</span> with notation as follows.</p>
<ul>
<li><p><span class="math inline">\(\partial_i^j\)</span> is shorthand
for an operator of the form <span
class="math inline">\(\partial_i^{\beta}\)</span> with <span
class="math inline">\(|\beta| = j\)</span>, not necessarily with the
same <span class="math inline">\(\beta\)</span> in each occurrence. For
instance, if <span class="math inline">\(a_{ij } = 3\)</span>, then
<span class="math inline">\((\partial_1^i \partial_2^j f)^{a_{i
j}}\)</span> denotes some product of the form <span
class="math inline">\((\partial_1^{\beta} \partial_2^{\gamma } f)
(\partial_1^{\beta&#39;} \partial_2^{\gamma&#39;} f)
(\partial_1^{\beta&#39;&#39;} \partial_2^{\gamma&#39;&#39; } f)\)</span>
with <span class="math inline">\(|\beta| = |\beta &#39;| = |\beta
&#39;&#39;| = i\)</span> and <span class="math inline">\(|\gamma| =
|\gamma &#39;| = |\gamma &#39;&#39;| = j\)</span>.</p></li>
<li><p>The <span class="math inline">\(a_{i j}\)</span> are nonnegative
integers satisfying <span class="math display">\[\sum_{i} \sum_j i a_{i
j} = m, \quad \sum_{i} \sum_j j a_{i j} = n.\]</span></p></li>
</ul>
<p>We may and shall assume that <span class="math inline">\(a_{0 0} =
0\)</span>, since the corresponding factor is <span
class="math inline">\(1\)</span>. By lemma <a
href="#lem:derivatives-along-orbits-inv-fn" data-reference-type="ref"
data-reference="lem:derivatives-along-orbits-inv-fn">241</a>, we have
<span class="math inline">\(\partial_1^1 \partial_2^0 f (\tau) =
0\)</span>, so we may assume moreover that <span
class="math inline">\(a_{1 0} = 0\)</span>. We then rewrite <a
href="#eqn:terms-for-partial-derivs-of-f" data-reference-type="eqref"
data-reference="eqn:terms-for-partial-derivs-of-f">\((15.14)\)</a>
as <span class="math inline">\(\frac{1}{f}(\tau) P Q\)</span>, where
<span class="math inline">\(P\)</span> and <span
class="math inline">\(Q\)</span> denote the respective contributions
from <span class="math inline">\(j = 0\)</span> and from <span
class="math inline">\(j \geqslant 1\)</span>. Since <span
class="math inline">\(f(\tau) \gg {\mathop{\mathrm{h}}}^{\delta
&#39;&#39;}\)</span>, our goal bound <a
href="#eqn:required-partials-for-1-over-f" data-reference-type="eqref"
data-reference="eqn:required-partials-for-1-over-f">\((15.13)\)</a>
will follow if we can show that <span class="math display">\[P \ll
{\mathop{\mathrm{h}}}^{- \delta &#39; m}, \quad Q \ll
{\mathop{\mathrm{h}}}^{ - \delta &#39;&#39; n}.\]</span> Using the
estimates <span class="math inline">\(\partial^\beta f(\tau) \ll
1\)</span> and <span class="math inline">\(f(\tau) \gg
{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span>, we see that <span
class="math display">\[P \ll {\mathop{\mathrm{h}}}^{- \sum_i a_{i 0}
\delta &#39;&#39;}, \quad Q \ll {\mathop{\mathrm{h}}}^{- \sum_i \sum_{j
\geqslant 1} a_{i j} \delta &#39;&#39;}.\]</span> By the stated
vanishing conditions on the <span class="math inline">\(a_{i
j}\)</span>, we have <span class="math display">\[\sum_i a_{i 0}
\leqslant\frac{1}{2} \sum_i i a_{i 0} \leqslant\frac{m}{2}, \quad \sum_i
\sum_{j \geqslant 1} a_{i j} \leqslant\sum_i \sum_j j a_{i j} =
n.\]</span> Our goal bound follows upon recalling that <span
class="math inline">\(\delta &#39;&#39;/2 \leqslant\delta
&#39;\)</span>. ◻</p>
</div>
<p>We turn finally to the proof of Proposition <a
href="#prop:divide-by-G-inv-symb" data-reference-type="ref"
data-reference="prop:divide-by-G-inv-symb">240</a>. Retain its
hypotheses. We will construct <span class="math inline">\(b\)</span>;
the construction of <span class="math inline">\(b&#39;\)</span> is
similar. We define <span class="math inline">\(b_j\)</span> (<span
class="math inline">\(j \in \mathbb{Z}_{\geqslant 0}\)</span>)
inductively by requiring that <span class="math inline">\(f
\star_{\mathop{\mathrm{h}}} \sum_{j \geqslant 0} {\mathop{\mathrm{h}}}^j
b_j \sim a\)</span> in a formal sense. Thus <span
class="math display">\[b_0 := \frac{a}{f}, \quad b_1 := \frac{- f
\star^1 b_0}{f}, \quad b_2 := \frac{- f \star^2 b_0 + f \star^1
b_1}{f},\]</span> and so on.</p>
<div class="lemma">
<p><strong>Lemma 244</strong>. For fixed <span
class="math inline">\(j\)</span>, we have <span
class="math inline">\(b_j \in {\mathop{\mathrm{h}}}^{-\delta &#39;&#39; -
2 j \delta &#39;} S^\tau_{\delta &#39;, \delta &#39;&#39;}\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We induct on <span class="math inline">\(j\)</span>.
The case <span class="math inline">\(j=0\)</span> is the content of
lemma <a href="#lem:b0-in-h-neg-delta-dubprime"
data-reference-type="ref"
data-reference="lem:b0-in-h-neg-delta-dubprime">243</a>, so suppose
<span class="math inline">\(j \geqslant 1\)</span>. By our inductive
hypothesis and lemma <a href="#lem:star-j-against-invariant-function"
data-reference-type="ref"
data-reference="lem:star-j-against-invariant-function">242</a>, we see
that for <span class="math inline">\(\ell \in \{1, \dotsc, j\}\)</span>,
we have <span class="math inline">\(f \star^{\ell} b_{j - \ell} \in
{\mathop{\mathrm{h}}}^{- 2 j \delta &#39; } S^\tau_{\delta &#39;,
\delta&#39;&#39;}\)</span>. By lemma <a
href="#lem:b0-in-h-neg-delta-dubprime" data-reference-type="ref"
data-reference="lem:b0-in-h-neg-delta-dubprime">243</a> (applied with
<span class="math inline">\(a\)</span> replaced by <span
class="math inline">\({\mathop{\mathrm{h}}}^{2 j \delta &#39;} f
\star^{\ell} b_{j - \ell}\)</span>, which satisfies the required
hypotheses), we deduce that <span class="math display">\[\frac{f
\star^{\ell} b_{j - \ell}}{f} \in {\mathop{\mathrm{h}}}^{- \delta
&#39;&#39; - 2 j \delta &#39;} S^\tau_{\delta &#39;, \delta
&#39;&#39;}.\]</span> By construction, <span
class="math inline">\(b_j\)</span> is an alternating sum of such terms.
The proof is complete. ◻</p>
</div>
<p>We define <span class="math display">\[b := \sum_{0 \leqslant j &lt;
L} {\mathop{\mathrm{h}}}^j b_j\]</span> for some <span
class="math inline">\(L \ggg 1\)</span> as in the conclusion of Lemma <a
href="#lem:borel-summation" data-reference-type="ref"
data-reference="lem:borel-summation">222</a>. Then <span
class="math inline">\(b \in {\mathop{\mathrm{h}}}^{- \delta &#39;&#39;}
S^\tau_{\delta &#39;, \delta &#39;&#39;}\)</span>, and the required
approximation <span class="math inline">\(a \equiv f
\star_{\mathop{\mathrm{h}}} b \mod{{\mathop{\mathrm{h}}}^\infty
S^{-\infty}}\)</span> holds. The proof of Proposition <a
href="#prop:divide-by-G-inv-symb" data-reference-type="ref"
data-reference="prop:divide-by-G-inv-symb">240</a> is now complete.</p>
<h4 id="sec:completion-proof">§15.5. Completion of the proof</h4>
<p>We finally prove Theorem <a href="#thm:local-refin-symb"
data-reference-type="ref" data-reference="thm:local-refin-symb">236</a>.
We retain its setting. We decompose <span class="math inline">\(a = a_1
+ \dotsb + a_n\)</span> and construct <span
class="math inline">\(f_1,\dotsc,f_n\)</span> according to Proposition
<a href="#lem:produce-inv-polynomials-large-on-symbol-support"
data-reference-type="ref"
data-reference="lem:produce-inv-polynomials-large-on-symbol-support">237</a>.
Let <span class="math inline">\(f_j&#39;\in S^\infty_0\)</span> be
attached to <span class="math inline">\(f_j\)</span> as in §<a
href="#sec:harish-chandra-vs" data-reference-type="ref"
data-reference="sec:harish-chandra-vs">4.3</a>. Then <span
class="math inline">\(f_j&#39; - f_j \in
\mathop{\mathrm{h}}S^\infty_0\)</span>, so for <span
class="math inline">\(\xi \in \mathop{\mathrm{supp}}(a_j)\)</span>, we
have <span class="math inline">\(f_j&#39;(\xi) = f_j(\xi) +
\operatorname{O}(\mathop{\mathrm{h}})\)</span>. In particular, since
<span class="math inline">\(\delta &#39;&#39; &lt; 1\)</span>, the lower
bound <span class="math inline">\(f_j&#39;(\xi) \gg
{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}\)</span> persists for <span
class="math inline">\(f_j&#39;\)</span>. Using Proposition <a
href="#prop:divide-by-G-inv-symb" data-reference-type="ref"
data-reference="prop:divide-by-G-inv-symb">240</a>, we may thus produce
<span class="math inline">\(b_1,\dotsc,b_n \in {\mathop{\mathrm{h}}}^{-
\delta &#39;&#39;} S^\tau_{\delta &#39;, \delta &#39;&#39;}\)</span> so
that <span class="math inline">\(a_j \equiv f_j&#39;
\star_{\mathop{\mathrm{h}}} b_j \mod{{\mathop{\mathrm{h}}}^\infty
S^{-\infty}}\)</span>. By Lemma <a href="#lem:let-chi-be"
data-reference-type="ref" data-reference="lem:let-chi-be">217</a> and
the composition formula (Theorem <a
href="#thm:composition-formula-quantitative" data-reference-type="ref"
data-reference="thm:composition-formula-quantitative">220</a>), we have
<span class="math display">\[\mathop{\mathrm{Op}}(a_j) \equiv
\mathop{\mathrm{Op}}(f_j) \mathop{\mathrm{Op}}(b_j)
\mod{{\mathop{\mathrm{h}}}^\infty \Psi^{-\infty}}.\]</span> Since <span
class="math inline">\([\tau] = \mathop{\mathrm{h}}\lambda_\pi\)</span>,
we have <span class="math display">\[\mathop{\mathrm{Op}}(f_j&#39;) =
f_j(\mathop{\mathrm{h}}\lambda_\pi) = f_j(\tau) = 0.\]</span> Thus each
<span class="math inline">\(\mathop{\mathrm{Op}}(a_j)\)</span> and hence
also <span class="math inline">\(\mathop{\mathrm{Op}}(a)\)</span>
belongs to <span class="math inline">\({\mathop{\mathrm{h}}}^\infty
\Psi^{-\infty}\)</span>, as required.</p>
<h3 id="localization-with-respect-to-p">Localization with respect to
<span class="math inline">\(P\)</span></h3>
<p>For the remainder of Part <a href="#part:asympt-analys-kirill"
data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>, we specialize to <span
class="math display">\[G := {\mathop{\mathrm{GL}}}_n(\mathbb{R}),\]</span>
with accompanying notation <span class="math inline">\(H, N, N_H, P,
A\)</span> as in §<a href="#sec:asympt-analys-local"
data-reference-type="ref"
data-reference="sec:asympt-analys-local">3</a>.</p>
<h4 id="sec:qual-prel">§16.1. Qualitative preliminaries</h4>
<p>Let <span class="math inline">\(\psi\)</span> be a nondegenerate
unitary character of <span class="math inline">\(N\)</span>; as usual,
denote also by <span class="math inline">\(\psi\)</span> its restriction
to <span class="math inline">\(N_H\)</span>. Let <span
class="math inline">\(\pi\)</span> be a generic irreducible unitary
representation of <span class="math inline">\(G\)</span>. We identify
<span class="math inline">\(\pi\)</span> with its Whittaker model: <span
class="math display">\[\pi = \mathcal{W}(\pi,\psi).\]</span> Recall from
§<a href="#sec:basic-definition" data-reference-type="ref"
data-reference="sec:basic-definition">2.6.1</a> that we denote by <span
class="math inline">\(\pi^\infty \subseteq \pi^0 \subseteq
\pi^{-\infty}\)</span> the respective spaces of smooth, norm-bounded and
distributional vectors for <span class="math inline">\(\pi\)</span>. We
realize <span class="math inline">\(\pi\)</span> in its Kirillov model,
thereby identifying its underlying Hilbert space <span
class="math inline">\(\pi^0\)</span> with <span
class="math inline">\(L^2(N_H \backslash H, \psi)\)</span>. We recall
that <span class="math inline">\(\Theta_{\pi,\psi} \in
\pi^{-\infty}\)</span> denotes the distributional vector with the
property that for all <span class="math inline">\(W \in
\mathcal{W}(\pi,\psi)\)</span>, we have <span
class="math inline">\(\langle W, \Theta_{\pi,\psi} \rangle =
W(1)\)</span>.</p>
<p>The smooth and distributional parts of the restrictions of <span
class="math inline">\(\pi\)</span> to the subgroups <span
class="math inline">\(P\)</span> and <span
class="math inline">\(H\)</span> are related via natural inclusions
<span class="math display">\[\pi^\infty \subseteq \pi|_P^\infty
\subseteq \pi|_H^\infty \subseteq \pi ^0  \subseteq \pi|_H^{-\infty}
  \subseteq \pi|_P^{-\infty} \subseteq \pi^{-\infty}.\]</span></p>
<div class="lemma">
<p><strong>Lemma 245</strong>. We have <span
class="math inline">\(\Theta_{\pi,\psi} \in
\pi|_H^{-\infty}\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> The Sobolev lemma for <span
class="math inline">\((N_H \backslash H,\psi)\)</span> implies that we
may find <span class="math inline">\(d \in \mathbb{Z}_{\geqslant
0}\)</span> and <span class="math inline">\(C_0 \geqslant 0\)</span> so
that for all <span class="math inline">\(f \in C^\infty(N_H \backslash
H, \psi)\)</span>, we have <span class="math display">\[|f(1)| \leqslant
C_0 \sum _{x_1, \dotsc, x_d \in \mathcal{B}(H) \cup \{1\}} \|R(x_1
\dotsb x_d) f\|_{L^2(N_H \backslash H)}.\]</span> In particular, for
<span class="math inline">\(W \in \pi\)</span>, <span
class="math display">\[|\langle W, \Theta_{\pi,\psi} \rangle| \leqslant
C_0  \sum _{x_1, \dotsc, x_d \in \mathcal{B}(H) \cup \{1\}} \|\pi(x_1
\dotsb x_d) W\|.\]</span> This implies that <span
class="math inline">\(\Theta_{\pi,\psi}\)</span> lies in <span
class="math inline">\(\pi|_H^{-\infty}\)</span> (or more specifically,
in the negative index Sobolev space <span
class="math inline">\(\pi|_H^{-d}\)</span> as defined in <a href="#ref-nelson-venkatesh-1"
class="citation" data-cites="nelson-venkatesh-1">(P. D. Nelson and
Venkatesh 2021, sec. 3.2)</a>). ◻</p>
</div>
<p>Recall that <span class="math inline">\(\mathop{\mathrm{h}}\in
(0,1]\)</span> denotes a “wavelength parameter.”</p>
<div class="lemma">
<p><strong>Lemma 246</strong>. For each nice cutoff <span
class="math inline">\(\chi\)</span> and <span class="math inline">\(a
\in \underline{S}^{-\infty}(\mathfrak{p}^\wedge)\)</span>, we have <span
class="math display">\[{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)
\Theta_{\pi,\psi} \in \pi^\infty.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> By definition, <span
class="math inline">\({\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)
= \pi(\omega)\)</span> with <span class="math inline">\(\omega =
\widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span>
a smooth compactly-supported measure on <span
class="math inline">\(P\)</span>, or, after dividing by our fixed Haar
measure, a smooth compactly-supported function. The conclusion is thus a
special case of Jacquet’s results (Lemma <a
href="#thm:jacquet-on-kirillov-model-P" data-reference-type="ref"
data-reference="thm:jacquet-on-kirillov-model-P">146</a>), which give
<span class="math inline">\(\pi(\omega) \Theta_{\pi,\psi} \in
\pi^\infty\)</span> for all <span class="math inline">\(\omega \in
C_c^\infty(P)\)</span>. ◻</p>
</div>
<div id="lem:action-opp-on-cal-W-delta" class="lemma">
<p><strong>Lemma 247</strong>. Suppose that <span
class="math inline">\(\chi_1, \chi_2, \chi &#39;\)</span> are nice
cutoffs with <span class="math inline">\(\chi &#39;(x \ast y) =
1\)</span> whenever <span class="math inline">\(\chi_1(x) \chi_2(y) \neq
0\)</span>. Then for all <span class="math display">\[(a,b) \in
\underline{S} ^\infty (\mathfrak{p}^\wedge ) \times \underline{S}
^{\infty } (\mathfrak{p} ^\wedge ),\]</span> we have <span
class="math display">\[{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_1)
    {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(b:\chi_2)  \Theta_{\pi,\psi}
    =
    {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a
\star_{\mathop{\mathrm{h}}} b:\chi &#39;) \Theta_{\pi,\psi},\]</span>
with the star product <span
class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span> defined
relative to <span class="math inline">\(\chi_1\)</span> and <span
class="math inline">\(\chi_2\)</span> as in §<a href="#sec:star-product"
data-reference-type="ref" data-reference="sec:star-product">2.5</a>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We evaluate the general composition formula (Theorem
<a href="#thm:qualitative-extended-operator-assignment"
data-reference-type="ref"
data-reference="thm:qualitative-extended-operator-assignment">216</a>)
on <span class="math inline">\(\Theta_{\pi,\psi}\)</span>. ◻</p>
</div>
<h4 id="sec:quant-prel">§16.2. Quantitative preliminaries</h4>
<h5 id="scaling-parameters">Scaling parameters</h5>
<p>We now set <span class="math display">\[T :=
1/\mathop{\mathrm{h}}\]</span> and normalize the wavelength parameter
<span class="math inline">\(\mathop{\mathrm{h}}\lll 1\)</span> by
requiring that the rescaled infinitesimal character <span
class="math inline">\(\mathop{\mathrm{h}}\lambda_\pi = T^{-1}
\lambda_\pi\)</span> belongs to a fixed compact set (as we may, in the
setting of Theorem <a href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>).</p>
<h5 id="characters-1">Characters</h5>
<p>We take <span class="math inline">\(\psi\)</span> fixed, and define
the rescaled character <span class="math inline">\(\psi_T\)</span> as in
§<a href="#sec:class-bump-functions" data-reference-type="ref"
data-reference="sec:class-bump-functions">3.2</a>. The discussion of §<a
href="#sec:qual-prel" data-reference-type="ref"
data-reference="sec:qual-prel">5.1</a> then applies, with <span
class="math inline">\(\psi_T\)</span> playing the role of “<span
class="math inline">\(\psi\)</span>.”</p>
<p>For the remainder of Part <a href="#part:asympt-analys-kirill"
data-reference-type="ref"
data-reference="part:asympt-analys-kirill"></a>, we identity <span
class="math inline">\(\pi\)</span> with its <span
class="math inline">\(\psi_T\)</span>-Whittaker model: <span
class="math display">\[\pi = \mathcal{W}(\pi, \psi_T).\]</span></p>
<h5 id="a-class-of-localized-whittaker-functions">A class of localized
Whittaker functions</h5>
<p>Recall (Definition <a href="#defn:we-denote-mathfr-frakW"
data-reference-type="ref"
data-reference="defn:we-denote-mathfr-frakW">148</a>) the classes <span
class="math inline">\(\mathfrak{W}(\pi,\psi,T,\delta) \subseteq
\mathcal{W}(\pi,\psi_T)\)</span>. We abbreviate <span
class="math display">\[\mathcal{W}_\delta := \mathfrak{W}(\pi, \psi, T,
\delta).\]</span> Informally, <span
class="math inline">\(\mathcal{W}_\delta\)</span> consists of vectors
given in the <span class="math inline">\(\psi_T\)</span>-Kirillov model
by smooth bumps on <span class="math inline">\(1 +
\operatorname{O}({\mathop{\mathrm{h}}}^{1-\delta})\)</span>.</p>
<h5 id="the-parameter-theta">The parameter <span
class="math inline">\(\theta\)</span></h5>
<p>In what follows, we abbreviate simply by <span
class="math inline">\(\theta\)</span> the quantities <span
class="math inline">\(\theta_P(\psi)\)</span> or <span
class="math inline">\(\theta_H(\psi)\)</span>, defined as in §<a
href="#sec:class-bump-functions" data-reference-type="ref"
data-reference="sec:class-bump-functions">3.2</a>; it should be clear
from context to which element we are referring.</p>
<h5 id="a-class-of-theta-localized-symbols">A class of <span
class="math inline">\(\theta\)</span>-localized symbols</h5>
<p>We abbreviate, with notation as in Definition <a
href="#defn:let-mathfrakav-theta" data-reference-type="ref"
data-reference="defn:let-mathfrakav-theta">127</a>, <span
class="math display">\[\mathcal{A}_\delta(\mathfrak{p}^\wedge) :=
\mathfrak{A}(\mathfrak{p}^\wedge, -\theta, T, \delta),\]</span>
Expanding that definition, <span
class="math inline">\(\mathcal{A}_\delta(\mathfrak{p}^\wedge)\)</span>
is the subclass of <span
class="math inline">\(\underline{S}^{-\infty}(\mathfrak{p}^\wedge)\)</span>
consisting of symbols <span class="math inline">\(a\)</span> satisfying
<span id="eq:partialalpha-axi-ll" class="math display">\[\label{eq:partialalpha-axi-ll}\tag{16.1}
  \partial^\alpha a(\theta + \xi) \ll {\mathop{\mathrm{h}}}^{-\delta
|\alpha|} \langle {\mathop{\mathrm{h}}}^{-\delta} \xi
\rangle^{-m}\]</span> for all fixed <span
class="math inline">\(\alpha,m\)</span>, where <span
class="math inline">\(\langle \xi \rangle := (1 +
|\xi|^2)^{1/2}\)</span>. Informally, such symbols are concentrated on
the ball <span class="math inline">\(\theta +
\operatorname{O}({\mathop{\mathrm{h}}}^\delta)\)</span> and vary mildly
there. Clearly <span
class="math display">\[\mathcal{A}_{\delta}(\mathfrak{p}^\wedge)
\subseteq S_{\delta}^{-\infty}(\mathfrak{p}^\wedge) \cap
\underline{S}^{-\infty}(\mathfrak{p}^\wedge).\]</span></p>
<div id="lem:star-product-asymptotics-applied-to-cal-A-delta"
class="lemma">
<p><strong>Lemma 248</strong>. Fix <span class="math inline">\(r \in
\mathbb{Z}_{\geqslant 0}\)</span>. Let <span class="math inline">\(a \in
\mathcal{A}_\delta(\mathfrak{p}^\wedge)\)</span>. Suppose that <span
class="math inline">\(b \in S^\infty_0(\mathfrak{p}^\wedge)\)</span>
satisfies <span class="math inline">\(b(\theta + \xi) \ll
|\xi|^r\)</span> for all <span class="math inline">\(\xi\)</span>.
Define <span class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span>
with respect to any pair of <span
class="math inline">\(\delta\)</span>-admissible nice cutoffs <span
class="math inline">\(\chi_1, \chi_2\)</span>. Then <span
class="math display">\[a \star_{\mathop{\mathrm{h}}} b, \, \, b
\star_{\mathop{\mathrm{h}}} a \in {\mathop{\mathrm{h}}}^{r \delta}
\mathcal{A}_\delta(\mathfrak{p}^\wedge).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Since <span class="math inline">\(a \in
\underline{S}^{-\infty}(\mathfrak{p}^\wedge)\)</span> and <span
class="math inline">\(b \in
\underline{S}^\infty(\mathfrak{p}^\wedge)\)</span>, we know by Theorem
<a href="#thm:extended-star-product" data-reference-type="ref"
data-reference="thm:extended-star-product">205</a> that <span
class="math inline">\(a \star_{\mathop{\mathrm{h}}} b \in
\underline{S}^{-\infty}(\mathfrak{p}^\wedge)\)</span>. It remains to
verify the analogue of <a href="#eq:partialalpha-axi-ll"
data-reference-type="eqref"
data-reference="eq:partialalpha-axi-ll">\((16.1)\)</a>,
i.e., that for fixed <span class="math inline">\(\alpha\)</span> and
<span class="math inline">\(m\)</span>, the rescaled star product <span
class="math inline">\(a \star_{\mathop{\mathrm{h}}} b\)</span> (say)
satisfies the estimate (with <span class="math inline">\(c = a
\star_{\mathop{\mathrm{h}}} b\)</span>) <span id="eq:partial-c-theta-xi-lemma" class="math display">\[\label{eq:partial-c-theta-xi-lemma}\tag{16.2}
    \partial^\alpha c(\theta + \xi) \ll {\mathop{\mathrm{h}}}^{\delta (r -
|\alpha|)} \langle {\mathop{\mathrm{h}}}^{-\delta} \xi
\rangle^{-m}.\]</span> It is clear that if <span
class="math inline">\(\ell\)</span> is fixed large enough in terms of
<span class="math inline">\(\alpha\)</span> and <span
class="math inline">\(m\)</span>, then any element of <span
class="math inline">\({\mathop{\mathrm{h}}}^\ell
S_{\delta}^{-\ell}\)</span> satisfies <a
href="#eq:partial-c-theta-xi-lemma" data-reference-type="eqref"
data-reference="eq:partial-c-theta-xi-lemma">\((16.2)\)</a>.
By the star product asymptotics (Theorem <a href="#thm:basic-star-prod"
data-reference-type="ref" data-reference="thm:basic-star-prod">206</a>),
we thereby reduce to verifying that for each fixed <span
class="math inline">\(j \in \mathbb{Z}_{\geqslant 0}\)</span>, the
homogeneous star product component <span
class="math inline">\({\mathop{\mathrm{h}}}^j a \star^j b\)</span>
satisfies <a href="#eq:partial-c-theta-xi-lemma"
data-reference-type="eqref"
data-reference="eq:partial-c-theta-xi-lemma">\((16.2)\)</a>.</p>
<p>We consider first the case <span class="math inline">\(j =
0\)</span>, in which <span class="math inline">\({\mathop{\mathrm{h}}}^j a
\star^j b = a b\)</span>. Fix <span class="math inline">\(\ell \in
\mathbb{Z}_{\geqslant 0}\)</span> so that <span class="math inline">\(b
\in S^\ell_{0}(\mathfrak{p}^\wedge)\)</span>. By Taylor’s theorem and
the definition of <span
class="math inline">\(S^\infty_0(\mathfrak{p}^\wedge)\)</span>, we have
for each fixed <span class="math inline">\(\alpha\)</span> the estimate
<span class="math display">\[\partial^\alpha b(\theta + \xi ) \ll
|\xi|^{\max(0, r - |\alpha|)} \langle \xi  \rangle^{\ell -
|\alpha|}.\]</span> (Note that <span class="math inline">\(\langle \xi
\rangle \asymp \langle \theta + \xi \rangle\)</span>, since <span
class="math inline">\(\theta \ll 1\)</span>.) By the product rule for
differentiation, we deduce that for each fixed <span
class="math inline">\(k \geqslant 0\)</span>, <span
class="math display">\[\partial^\alpha (a b)(\theta + \xi) \ll
    \max_{
      \substack{
        d_1, d_2 \geqslant 0:   \\
        d_1 + d_2 = |\alpha|
      }
    }
    |\xi|^{\max(0,r - d_1)}
    {\mathop{\mathrm{h}}}^{- \delta d_2}
    \langle \xi  \rangle ^{\ell - d_1}
    \langle {\mathop{\mathrm{h}}}^{-\delta} \xi  \rangle^{-k}.\]</span> To
derive from this estimate that <span class="math inline">\(a b\)</span>
satisfies <a href="#eq:partial-c-theta-xi-lemma"
data-reference-type="eqref"
data-reference="eq:partial-c-theta-xi-lemma">\((16.2)\)</a>,
we need to verify that for all <span class="math inline">\(d_1\)</span>
and <span class="math inline">\(d_2\)</span> as above, there is a fixed
<span class="math inline">\(k \geqslant 0\)</span> so that <span id="eq:ximax0-r-d_1" class="math display">\[\label{eq:ximax0-r-d_1}\tag{16.3}
    |\xi|^{\max(0,r - d_1)}
    \langle \xi  \rangle ^{\ell - d_1}
    \ll
    {\mathop{\mathrm{h}}}^{\delta (r - d_1)}
    \langle {\mathop{\mathrm{h}}}^{- \delta} \xi  \rangle^k.\]</span> This
follows easily, for any <span class="math inline">\(k \geqslant r +
\ell\)</span>, by some case analysis:</p>
<ul>
<li><p>Suppose <span class="math inline">\(|\xi|
\leqslant{\mathop{\mathrm{h}}}^\delta\)</span>. Then <span
class="math inline">\(\langle \xi \rangle \asymp 1\)</span> and <span
class="math inline">\(\langle {\mathop{\mathrm{h}}}^{-\delta} \xi \rangle
\asymp 1\)</span>. If <span class="math inline">\(r \geqslant
d_1\)</span>, then <span class="math inline">\(|\xi|^{\max(0,r - d_1)}
\leqslant{\mathop{\mathrm{h}}}^{\delta (r - d_1)}\)</span>, while if <span
class="math inline">\(r &lt; d_1\)</span>, then <span
class="math inline">\(|\xi|^{\max(0, r - d_1)} \leqslant 1
\leqslant{\mathop{\mathrm{h}}}^{\delta(r-d_1)}\)</span>.</p></li>
<li><p>Suppose <span class="math inline">\(|\xi| &gt;
{\mathop{\mathrm{h}}}^\delta\)</span> and <span
class="math inline">\(|\xi| \ll 1\)</span>. Then <span
class="math inline">\(\langle \xi \rangle \asymp 1\)</span> and <span
class="math inline">\(\langle {\mathop{\mathrm{h}}}^{-\delta} \xi \rangle
\asymp {\mathop{\mathrm{h}}}^{-\delta}\)</span>. The LHS of <a
href="#eq:ximax0-r-d_1" data-reference-type="eqref"
data-reference="eq:ximax0-r-d_1">\((16.3)\)</a> is <span
class="math inline">\(\ll 1\)</span>, while the RHS is <span
class="math inline">\(\gg 1\)</span> provided that <span
class="math inline">\(k \geqslant r\)</span>.</p></li>
<li><p>Suppose <span class="math inline">\(|\xi| \ggg 1\)</span>. Then
the LHS is <span class="math display">\[\ll |\xi|^{r + \ell - 2 d_1}
\leqslant|\xi|^{r + \ell},\]</span> while the RHS is <span
class="math display">\[\gg {\mathop{\mathrm{h}}}^{\delta (r - d_1) -
\delta k} |\xi|^k
      \geqslant|\xi|^{r+\ell}\]</span> provided that <span
class="math inline">\(k \geqslant r + \ell\)</span>.</p></li>
</ul>
<p>The case <span class="math inline">\(j \geqslant 1\)</span> may be
reduced to the case <span class="math inline">\(j=0\)</span>. To see
this, we recall from §<a href="#sec:formal-expansion"
data-reference-type="ref"
data-reference="sec:formal-expansion">2.5.2</a> that <span
class="math inline">\({\mathop{\mathrm{h}}}^j a \star^j b(\zeta)\)</span>
is given by a linear combination of expressions <span
class="math display">\[{\mathop{\mathrm{h}}}^j \zeta^\gamma
\partial^\alpha a(\zeta) \partial^\beta b(\zeta)\]</span> indexed by
multi-indices <span class="math inline">\(\alpha, \beta, \gamma\)</span>
satisfying the conditions <span class="math display">\[|\alpha| +
|\beta| - |\gamma| = j,
    \quad
    |\gamma| \leqslant\min(|\alpha|,|\beta|),\]</span> which imply that
<span class="math inline">\(\max(|\alpha|,|\beta|) \leqslant j\)</span>.
It follows from the definitions that <span
class="math display">\[\partial^\alpha a \in {\mathop{\mathrm{h}}}^{-
\delta |\alpha|} \mathcal{A}_{\delta}(\mathfrak{p}^\wedge), \quad
  \partial^{\beta} b \in
S_0^{\ell-|\beta|}(\mathfrak{p}^\wedge).\]</span> Moreover, <span
class="math inline">\(\partial^{\beta}\)</span> vanishes to order <span
class="math inline">\(\geqslant\max(0,r - |\beta|)\)</span> at <span
class="math inline">\(\theta\)</span>. The <span class="math inline">\(j
= 0\)</span> analysis gives <span
class="math display">\[{\mathop{\mathrm{h}}}^j \partial^\alpha a \cdot
\partial^\beta b
    \in
    {\mathop{\mathrm{h}}}^{j - \delta |\alpha| + \delta ( r - |\beta|)}
\mathcal{A}_{\delta}(\mathfrak{p}^\wedge).\]</span> Since <span
class="math inline">\(\max(|\alpha|,|\beta|) \leqslant j\)</span> and
<span class="math inline">\(\delta \leqslant 1/2\)</span>, we have <span
class="math display">\[j - \delta |\alpha| + \delta ( r - |\beta|)
    \geqslant\delta r.\]</span> Therefore <span
class="math inline">\({\mathop{\mathrm{h}}}^j \partial^\alpha a \cdot
\partial^\beta b \in {\mathop{\mathrm{h}}}^{r \delta }
\mathcal{A}_\delta(\mathfrak{p}^\wedge)\)</span>. It is clear that <span
class="math inline">\(\mathcal{A}_{\delta}(\mathfrak{p}^\wedge)\)</span>
is preserved under multiplication by the fixed polynomial <span
class="math inline">\(\zeta \mapsto \zeta^\gamma\)</span>, so we
conclude that <span class="math inline">\({\mathop{\mathrm{h}}}^j a
\star^j b \in {\mathop{\mathrm{h}}}^{r \delta}
\mathcal{A}_{\delta}(\mathfrak{p}^\wedge)\)</span>, as required. ◻</p>
</div>
<div id="lem:star-product-asymptotics-applied-to-cal-A-delta-2"
class="lemma">
<p><strong>Lemma 249</strong>. For <span class="math inline">\(a,b \in
\mathcal{A}_\delta(\mathfrak{p}^\wedge)\)</span>, we have <span
class="math display">\[a \star_{\mathop{\mathrm{h}}} b \in
\mathcal{A}_\delta(\mathfrak{p}^\wedge),\]</span> where the star product
is defined with respect to any pair of <span
class="math inline">\(\delta\)</span>-admissible nice cutoffs.</p>
</div>
<div class="proof">
<p><em>Proof.</em> The proof is similar to, but much simpler than, that
of Lemma <a href="#lem:star-product-asymptotics-applied-to-cal-A-delta"
data-reference-type="ref"
data-reference="lem:star-product-asymptotics-applied-to-cal-A-delta">248</a>,
hence left to the reader. (Alternatively, we could appeal to Lemma <a
href="#lem:let-c-frakC-vs-frakA" data-reference-type="ref"
data-reference="lem:let-c-frakC-vs-frakA">6.51</a>
and Proposition <a href="#lem:standard:subcl-mathfr-theta"
data-reference-type="ref"
data-reference="lem:standard:subcl-mathfr-theta">135</a>.) ◻</p>
</div>
<h5 id="lifts-of-the-class-of-localized-whittaker-functions">Lifts of
the class of localized Whittaker functions</h5>
<p>We next define <span
class="math display">\[\tilde{\mathcal{W}}_\delta(\mathfrak{p}) :=
\mathfrak{C}(P, - \theta, T, \delta),\]</span> <span
class="math display">\[\tilde{\mathcal{W}}_\delta(\mathfrak{h}) :=
\mathfrak{C}(H, - \theta, T, \delta).\]</span></p>
<div id="lem:W-delta-via-Fourier" class="lemma">
<p><strong>Lemma 250</strong>. For each <span class="math inline">\(a
\in \mathcal{A}_\delta(\mathfrak{p}^\wedge)\)</span>, each fixed <span
class="math inline">\(\delta_+ \in (\delta,1/2)\)</span> and each <span
class="math inline">\(\chi \in
\mathcal{X}_{\delta_+}(\mathfrak{p})\)</span>, the truncated rescaled
inverse Fourier transform <span class="math inline">\(\chi
a_{\mathop{\mathrm{h}}}^\vee\)</span> belongs to <span
class="math inline">\(\tilde{\mathcal{W}}_{\delta}(\mathfrak{p})\)</span>.
Conversely, every element of <span
class="math inline">\(\tilde{\mathcal{W}}_{\delta}(\mathfrak{p})\)</span>
arises in this way.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This follows from part <a
href="#itm:standard:fourier-description-of-bumps-arch"
data-reference-type="eqref"
data-reference="itm:standard:fourier-description-of-bumps-arch">\((iii)\)</a>
of Lemma <a href="#lem:let-c-frakC-vs-frakA" data-reference-type="ref"
data-reference="lem:let-c-frakC-vs-frakA">6.51</a>.
As noted there, the proof consists of elementary Fourier analysis, i.e.,
repeated integration by parts in the definition of the Fourier integral.
The informal content here is that a symbol <span class="math inline">\(a
\in \mathcal{A}_\delta(\mathfrak{p}^\wedge)\)</span> is a smooth bump on
<span class="math inline">\(\theta +
\operatorname{O}({\mathop{\mathrm{h}}}^\delta)\)</span> if and only if the
rescaled inverse Fourier transform <span
class="math inline">\(a_{\mathop{\mathrm{h}}}^\vee\)</span> is
concentrated on <span
class="math inline">\(\operatorname{O}({\mathop{\mathrm{h}}}^{1-\delta})\)</span>
and oscillates like <span
class="math inline">\(e^{-\theta/\mathop{\mathrm{h}}}\)</span>. ◻</p>
</div>
<div id="lem:map-c_cinftyp-ni-tilde-W-delta-W" class="lemma">
<p><strong>Lemma 251</strong>. The maps <span class="math inline">\(\phi
\mapsto \pi(\phi) \Theta_{\pi,\psi_T}\)</span>, defined on <span
class="math inline">\(C_c^\infty(P)\)</span> and on <span
class="math inline">\(C_c^\infty(H)\)</span>, induce surjective class
maps <span
class="math display">\[\tilde{\mathcal{W}}_\delta(\mathfrak{p})
\twoheadrightarrow \mathcal{W}_\delta,\]</span> <span
class="math display">\[\tilde{\mathcal{W}}_\delta(\mathfrak{h})
\twoheadrightarrow \mathcal{W}_\delta.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a translation of Lemma <a
href="#lem:fix-delta-in" data-reference-type="ref"
data-reference="lem:fix-delta-in">147</a>. ◻</p>
</div>
<h5 id="localized-whittaker-functions-via-localized-symbols">Localized
Whittaker functions via localized symbols</h5>
<div id="lem:every-elem-mathc" class="lemma">
<p><strong>Lemma 252</strong>. For fixed <span
class="math inline">\(\delta_+ \in (\delta,1/2)\)</span> and <span
class="math inline">\((a,\chi) \in
\mathcal{A}_\delta(\mathfrak{p}^\wedge) \times
\mathcal{X}_{\delta_+}(\mathfrak{p})\)</span>, we have <span
class="math display">\[{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)
\Theta_{\pi,\psi} \in \mathcal{W}_\delta.\]</span> Conversely, every
element of <span class="math inline">\(\mathcal{W}_\delta\)</span> may
be expressed in this way.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemmas <a href="#lem:W-delta-via-Fourier"
data-reference-type="ref"
data-reference="lem:W-delta-via-Fourier">250</a> and <a
href="#lem:map-c_cinftyp-ni-tilde-W-delta-W" data-reference-type="ref"
data-reference="lem:map-c_cinftyp-ni-tilde-W-delta-W">251</a>. ◻</p>
</div>
<h4 id="sec:local-with-resp-P">§16.3. Localization with respect to <span
class="math inline">\(\mathfrak{p}\)</span></h4>
<p>In this section, we describe the asymptotic behavior of the class
<span class="math inline">\(\mathcal{W}_\delta\)</span> under the
mirabolic subgroup <span class="math inline">\(P\)</span>, using the
explicit description of the action of that subgroup on the Kirillov
model. The results of this section are essentially formal, but provide a
convenient base for the more complicated arguments to follow.</p>
<p>More precisely, our first objective is to define on <span
class="math inline">\(\mathcal{W}_\delta\)</span> the structure of an
<span
class="math inline">\(S^\infty_\delta(\mathfrak{p}^\wedge)\)</span>-module
(Definition <a href="#defn:s-infinity-delta-module"
data-reference-type="ref"
data-reference="defn:s-infinity-delta-module">14.6</a>).
We then verify that the latter is <span
class="math inline">\((\mathfrak{p},\delta)\)</span>-localized at <span
class="math inline">\(\theta\)</span> (Definition <a
href="#defn:localized-vectors" data-reference-type="ref"
data-reference="defn:localized-vectors">225</a>).</p>
<p>As the underlying <span
class="math inline">\(\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span>-module
for <span class="math inline">\(\mathcal{W}_\delta\)</span>, we take the
space <span class="math inline">\(\pi^\infty\)</span> of all smooth
vectors. For the operator assignment, we fix <span
class="math inline">\(\delta_{+,0} \in (\delta,1/2)\)</span>, choose a
nice cutoff <span class="math inline">\(\chi_0 \in
\mathcal{X}_{\delta_{+,0}}(\mathfrak{p})\)</span>, and take <span
class="math display">\[\mathop{\mathrm{Op}}(a) :=
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi_0).\]</span> We must
check that <span class="math display">\[\mathop{\mathrm{Op}}(
S^\infty_\delta(\mathfrak{p}^\wedge)) \mathcal{W}_\delta \subseteq
\mathcal{W}_\delta\]</span> For <span class="math inline">\(v \in
\mathcal{W}_\delta\)</span> and <span class="math inline">\(a \in
S^\infty_\delta(\mathfrak{p}^\wedge)\)</span>, we know from Theorem <a
href="#thm:qualitative-extended-operator-assignment"
data-reference-type="ref"
data-reference="thm:qualitative-extended-operator-assignment">216</a>
that <span class="math inline">\(\mathop{\mathrm{Op}}(a) v\)</span> lies
in <span class="math inline">\(\pi|_P^\infty\)</span>, but it is not
immediately obvious that it lies in <span
class="math inline">\(\mathcal{W}_\delta\)</span>. Let us verify that
this is the case:</p>
<div id="lem:each-a-v" class="lemma">
<p><strong>Lemma 253</strong>. For each fixed <span
class="math inline">\(\delta_+ \in (\delta, 1/2)\)</span> and all <span
class="math inline">\((\chi,a,v) \in
\mathcal{X}_{\delta_+}(\mathfrak{p}) \times
S_\delta^\infty(\mathfrak{p}^\wedge) \times \mathcal{W}_\delta\)</span>,
we have <span
class="math inline">\({\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)
v \in \mathcal{W}_\delta\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemma <a href="#lem:every-elem-mathc"
data-reference-type="ref" data-reference="lem:every-elem-mathc">252</a>,
we may write <span id="eq:v-=-opp_hb:chi" class="math display">\[\label{eq:v-=-opp_hb:chi}\tag{16.4}
    v = {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(b:\chi&#39;)
\Theta_{\pi,\psi}\]</span> for some fixed <span
class="math inline">\(\delta_+&#39; \in (\delta_{+},1/2)\)</span> and
some <span class="math inline">\((b,\chi&#39;) \in
\mathcal{A}_\delta(\mathfrak{p}^\wedge) \times
\mathcal{X}_{\delta_+&#39;}(\mathfrak{p})\)</span>. Applying the
definition of <span
class="math inline">\({\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span>
followed by the composition formula (Lemma <a
href="#lem:action-opp-on-cal-W-delta" data-reference-type="ref"
data-reference="lem:action-opp-on-cal-W-delta">247</a>), we see that
<span id="eq:oppa-v-Theta-stuff" class="math display">\[\label{eq:oppa-v-Theta-stuff}\tag{16.5}
    {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi) v
    = {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(b:\chi&#39;)
\Theta_{\pi,\psi}
    = {\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a
\star_{\mathop{\mathrm{h}}} b:\chi&#39;&#39;)
\Theta_{\pi,\psi},\]</span> for some <span
class="math inline">\(\chi&#39;&#39; \in
\mathcal{X}_{\delta_+&#39;}(\mathfrak{p})\)</span>. By Lemma <a
href="#lem:star-product-asymptotics-applied-to-cal-A-delta-2"
data-reference-type="ref"
data-reference="lem:star-product-asymptotics-applied-to-cal-A-delta-2">249</a>,
we have <span class="math inline">\(a \star_{\mathop{\mathrm{h}}} b \in
\mathcal{A}_\delta(\mathfrak{p}^\wedge)\)</span>. By Lemma <a
href="#lem:every-elem-mathc" data-reference-type="ref"
data-reference="lem:every-elem-mathc">252</a>, it follows that <span
class="math inline">\({\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a
\star_{\mathop{\mathrm{h}}} b:\chi&#39;&#39;) \Theta_{\pi,\psi} \in
\mathcal{W}_\delta\)</span>, hence <span
class="math inline">\({\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)
v \in \mathcal{W}_\delta\)</span>, as required. ◻</p>
</div>
<div id="lem:class-map-defined-cal-W-delta-module" class="lemma">
<p><strong>Lemma 254</strong>. The class map defined above equips <span
class="math inline">\(\mathcal{W}_\delta\)</span> with the structure of
an <span
class="math inline">\(S_\delta^\infty(\mathfrak{p}^\wedge)\)</span>-module.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We check the desiderata of Definition <a
href="#defn:s-infinity-delta-module" data-reference-type="ref"
data-reference="defn:s-infinity-delta-module">14.6</a>
one by one. It is clear that <span
class="math inline">\(\mathcal{W}_\delta\)</span> is an <span
class="math inline">\(\operatorname{O}(1)\)</span>-submodule of <span
class="math inline">\(\pi^\infty\)</span>. The identity <span
class="math inline">\(\mathop{\mathrm{Op}}(p) v =
\mathop{\mathrm{sym}}(p_{\mathop{\mathrm{h}}}) v\)</span> for <span
class="math inline">\(p \in \mathop{\mathrm{Sym}}(\mathfrak{g})\)</span>
is given by <a href="#eq:oppp-=-pisymp_h" data-reference-type="eqref"
data-reference="eq:oppp-=-pisymp_h">\((13.13)\)</a>. In view of
Lemma <a href="#lem:each-a-v" data-reference-type="ref"
data-reference="lem:each-a-v">253</a>, it remains to verify that for all
<span class="math inline">\(a,b \in
S^\infty_\delta(\mathfrak{p}^\wedge)\)</span> and <span
class="math inline">\(v \in \mathcal{W}_\delta\)</span>, we have <span
class="math display">\[\mathop{\mathrm{Op}}(a) \mathop{\mathrm{Op}}(b) v
\equiv \mathop{\mathrm{Op}}(a \star_{\mathop{\mathrm{h}}} b) v
\pmod{{\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta}.\]</span> Choose
cutoffs <span class="math inline">\(\chi_1, \chi_2 \in
\mathcal{X}_{\delta_+}(\mathfrak{p})\)</span>, with the support of <span
class="math inline">\(\chi_1\)</span> (resp. <span
class="math inline">\(\chi_2\)</span>) taken large in terms of that of
<span class="math inline">\(\chi_0\)</span> (resp. <span
class="math inline">\(\chi_1\)</span>). Then by <a
href="#eq:qualitative-composition-formula" data-reference-type="eqref"
data-reference="eq:qualitative-composition-formula">\((13.12)\)</a>
and Lemma <a href="#lem:fix-0-leq" data-reference-type="ref"
data-reference="lem:fix-0-leq">203</a>, we have <span
class="math display">\[\mathop{\mathrm{Op}}(a) \mathop{\mathrm{Op}}(b) =
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a \star_{\mathop{\mathrm{h}}}
b: \chi_1) = \mathop{\mathrm{Op}}(a \star_{\mathop{\mathrm{h}}} b) +
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(\mathcal{E}:\chi_2),\]</span>
where <span class="math inline">\(\mathcal{E} \in
{\mathop{\mathrm{h}}}^\infty S^{-\infty}\)</span>. By Lemma <a
href="#lem:each-a-v" data-reference-type="ref"
data-reference="lem:each-a-v">253</a>, we have <span
class="math inline">\({\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(\mathcal{E}:\chi_2)
v \in {\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta\)</span>, whence the
required conclusion. ◻</p>
</div>
<div id="prop:local-with-resp-p" class="proposition">
<p><strong>Proposition 255</strong>. <em>The <span
class="math inline">\(S^\infty_\delta(\mathfrak{p}^\wedge)\)</span>-module
<span class="math inline">\(\mathcal{W}_\delta\)</span> is <span
class="math inline">\((\mathfrak{p},\delta)\)</span>-localized at <span
class="math inline">\(\theta\)</span> (Definition <a
href="#defn:localized-vectors" data-reference-type="ref"
data-reference="defn:localized-vectors">225</a>).</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Fix <span class="math inline">\(r \in
\mathbb{Z}_{\geqslant 0}\)</span>. Let <span class="math inline">\(a \in
S^\infty_0(\mathfrak{p}^\wedge)\)</span> be a polynomial symbol that
vanishes to order <span class="math inline">\(r\)</span> at <span
class="math inline">\(\theta\)</span>. Let <span class="math inline">\(v
\in \mathcal{W}_\delta\)</span>. We must verify that <span id="eq:oppa-v-in" class="math display">\[\label{eq:oppa-v-in}\tag{16.6}
    \mathop{\mathrm{Op}}(a) v \in {\mathop{\mathrm{h}}}^{r \delta}
\mathcal{W}_\delta.\]</span></p>
<p>To that end, choose <span class="math inline">\(b \in
\mathcal{A}_\delta(\mathfrak{p}^\wedge)\)</span> as in the proof of
Lemma <a href="#lem:each-a-v" data-reference-type="ref"
data-reference="lem:each-a-v">253</a>, so that <a
href="#eq:v-=-opp_hb:chi" data-reference-type="eqref"
data-reference="eq:v-=-opp_hb:chi">\((16.4)\)</a> and <a
href="#eq:oppa-v-Theta-stuff" data-reference-type="eqref"
data-reference="eq:oppa-v-Theta-stuff">\((16.5)\)</a> hold.
By Lemma <a href="#lem:star-product-asymptotics-applied-to-cal-A-delta"
data-reference-type="ref"
data-reference="lem:star-product-asymptotics-applied-to-cal-A-delta">248</a>,
we see that <span class="math display">\[a \star_{\mathop{\mathrm{h}}} b
\in {\mathop{\mathrm{h}}}^{r \delta}
\mathcal{A}_\delta(\mathfrak{p}^\wedge).\]</span> The required
membership <a href="#eq:oppa-v-in" data-reference-type="eqref"
data-reference="eq:oppa-v-in">\((16.6)\)</a> then follows from Lemma
<a href="#lem:every-elem-mathc" data-reference-type="ref"
data-reference="lem:every-elem-mathc">252</a>. ◻</p>
</div>
<h3 id="sec:local-with-resp">§17. Localization with respect to <span
class="math inline">\(G\)</span></h3>
<p>Here we refine the results of §<a href="#sec:local-with-resp-P"
data-reference-type="ref" data-reference="sec:local-with-resp-P">5.3</a>
to describe the asymptotic behavior of <span
class="math inline">\(\mathcal{W}_\delta\)</span> under the action of
the full group <span class="math inline">\(G\)</span>.</p>
<h4 id="statement-of-main-result">Statement of main result</h4>
<div id="thm:cal-W-delta-g-acts-localized" class="theorem">
<p><strong>Theorem 256</strong>. <em><span
class="math inline">\(\mathcal{W}_{\delta}\)</span> is <span
class="math inline">\((\mathfrak{g},\delta)\)</span>-localized at <span
class="math inline">\(\tau\)</span>.</em></p>
</div>
<p>In particular, for fixed <span class="math inline">\(x \in
\mathfrak{g}\)</span>, we have <span
class="math inline">\(\mathop{\mathrm{h}}\pi(x) \mathcal{W}_\delta
\subseteq \mathcal{W}_\delta\)</span>. This fact does not seem <em>a
priori</em> obvious (compare with §<a href="#sec:empha-priori-bounds"
data-reference-type="ref"
data-reference="sec:empha-priori-bounds">6.4</a>).</p>
<p>In §<a href="#sec:control-over-norms" data-reference-type="ref"
data-reference="sec:control-over-norms">6.9</a>–<a
href="#sec:proof-theor-refthm:b" data-reference-type="ref"
data-reference="sec:proof-theor-refthm:b">6.11</a>, we apply Theorem <a
href="#thm:cal-W-delta-g-acts-localized" data-reference-type="ref"
data-reference="thm:cal-W-delta-g-acts-localized">256</a> to prove
Theorem <a href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>.</p>
<h4 id="reduction-to-factoring-mathfrakg-through-mathfrakp">Reduction to
factoring <span class="math inline">\(\mathfrak{g}\)</span> through
<span class="math inline">\(\mathfrak{p}\)</span></h4>
<p>We explain here how the proof of Theorem <a
href="#thm:cal-W-delta-g-acts-localized" data-reference-type="ref"
data-reference="thm:cal-W-delta-g-acts-localized">256</a> reduces to
that of the following result, which describes the action on <span
class="math inline">\(\mathcal{W}_\delta\)</span> of <span
class="math inline">\(\mathfrak{g}\)</span> in terms of that of <span
class="math inline">\(S^\infty_0(\mathfrak{p}^\wedge)\)</span>.</p>
<p>In what follows, we define <span
class="math inline">\(\mathop{\mathrm{Op}}(a)\)</span>, for a polynomial
<span class="math inline">\(a\)</span> on <span
class="math inline">\(\mathfrak{g}^\wedge\)</span>, to be the <span
class="math inline">\(\mathop{\mathrm{h}}\)</span>-rescaling of the
symmetrization map, as in <a href="#eq:oppp-:=-symp_h"
data-reference-type="eqref"
data-reference="eq:oppp-:=-symp_h">\((14.1)\)</a>;
equivalently, <span class="math inline">\(\mathop{\mathrm{Op}}(a) :=
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span> for any nice
cutoff <span class="math inline">\(\chi\)</span> on <span
class="math inline">\(\mathfrak{g}\)</span>.</p>
<div id="thm:g-via-p" class="theorem">
<p><strong>Theorem 257</strong>. <em>For each fixed <span
class="math inline">\(x \in \mathfrak{g}\)</span>, there is a symbol
<span class="math display">\[x^{\mathfrak{p}} \in
S_0^\infty(\mathfrak{p}^\wedge)\]</span> with the following
properties.</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(\mathop{\mathrm{Op}}(x) v \equiv
\mathop{\mathrm{Op}}(x^\mathfrak{p}) v \mod{{\mathop{\mathrm{h}}}^\infty
\mathcal{W}_\delta}\)</span> for each <span class="math inline">\(v \in
\mathcal{W}_\delta\)</span>.</em></p></li>
<li><p><em><span class="math inline">\(x^\mathfrak{p}(\theta) = x(\tau)
+ \operatorname{O}(\mathop{\mathrm{h}})\)</span>.</em></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof of Theorem <a href="#thm:cal-W-delta-g-acts-localized"
data-reference-type="ref"
data-reference="thm:cal-W-delta-g-acts-localized">256</a>, assuming
Theorem <a href="#thm:g-via-p" data-reference-type="ref"
data-reference="thm:g-via-p">257</a>.</em> We must check that <span
class="math inline">\(\mathcal{W}_\delta\)</span> is <span
class="math inline">\((\mathfrak{g},\delta)\)</span>-localized at <span
class="math inline">\(\tau\)</span>. By Lemma <a
href="#lem:localization-criterion-degree-1" data-reference-type="ref"
data-reference="lem:localization-criterion-degree-1">228</a>, it is
enough to show that for each <span class="math inline">\(v \in
\mathcal{W}_\delta\)</span> and each fixed <span class="math inline">\(x
\in \mathfrak{g}\)</span>, we have <span
class="math inline">\(\mathop{\mathrm{Op}}(x) v \equiv x(\tau) v
\mod{{\mathop{\mathrm{h}}}^\delta \mathcal{W}_\delta}\)</span>. Taking
<span class="math inline">\(x^\mathfrak{p}\)</span> as in Theorem <a
href="#thm:g-via-p" data-reference-type="ref"
data-reference="thm:g-via-p">257</a>, it is enough to show that <span id="eqn:required-estimate-reduce-to-going-x-to-x-p" class="math display">\[\label{eqn:required-estimate-reduce-to-going-x-to-x-p}\tag{17.1}
    \mathop{\mathrm{Op}}(x^\mathfrak{p}) v
    \equiv x^\mathfrak{p}(\theta) v
    \pmod{{\mathop{\mathrm{h}}}^\delta \mathcal{W}_\delta}.\]</span> We
have seen in Proposition <a href="#prop:local-with-resp-p"
data-reference-type="ref"
data-reference="prop:local-with-resp-p">255</a> that <span
class="math inline">\(\mathcal{W}_\delta\)</span> is an <span
class="math inline">\(S^\infty_\delta(\mathfrak{p}^\wedge)\)</span>-module
that is <span
class="math inline">\((\mathfrak{p},\delta)\)</span>-localized at <span
class="math inline">\(\tau\)</span>. The symbol <span
class="math inline">\(x^\mathfrak{p} - x^\mathfrak{p}(\theta) \in
S^\infty_0(\mathfrak{p}^\wedge)\)</span> vanishes to order <span
class="math inline">\(\geqslant 1\)</span> at <span
class="math inline">\(\theta\)</span>, so the required conclusion <a
href="#eqn:required-estimate-reduce-to-going-x-to-x-p"
data-reference-type="eqref"
data-reference="eqn:required-estimate-reduce-to-going-x-to-x-p">\((17.1)\)</a>
follows from part <a
href="#item:2-thm:S-infinity-modules-localized-stuff"
data-reference-type="eqref"
data-reference="item:2-thm:S-infinity-modules-localized-stuff">\((ii)\)</a>
of Theorem <a href="#thm:S-infinity-modules-localized-stuff"
data-reference-type="ref"
data-reference="thm:S-infinity-modules-localized-stuff">14.12</a>. ◻</p>
</div>
<h4 id="preliminary-reductions">Preliminary reductions</h4>
<p>Here we reduce the proof of Theorem <a href="#thm:g-via-p"
data-reference-type="ref" data-reference="thm:g-via-p">257</a> to the
crucial cases.</p>
<p>By linearity, we may assume that <span
class="math inline">\(x\)</span> lies in some fixed spanning set for
<span class="math inline">\(\mathfrak{g}\)</span>.</p>
<p>If <span class="math inline">\(x \in \mathfrak{p}\)</span>, then we
may take <span class="math inline">\(x^\mathfrak{p} = x \in
S^1_0(\mathfrak{p}^\wedge)\)</span>.</p>
<p>Suppose that <span class="math inline">\(x \in \mathfrak{z}\)</span>.
Then <span class="math inline">\(x\)</span> is (up to standard
identifications) its own image under the Harish–Chandra isomorphism, and
defines a regular function on <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span>. The operator <span
class="math inline">\(\mathop{\mathrm{Op}}(x)\)</span> acts by the
scalar <span class="math inline">\(x(\mathop{\mathrm{h}}\lambda_\pi) \ll
1\)</span>, so we can take for <span
class="math inline">\(x^\mathfrak{p}\)</span> the constant element of
<span class="math inline">\(S^0_0(\mathfrak{p}^\wedge)\)</span> given by
<span class="math inline">\(x^\mathfrak{p}(\xi) :=
x(\mathop{\mathrm{h}}\lambda_\pi)\)</span>. Note that the condition
<span class="math inline">\([\tau] =
\mathop{\mathrm{h}}\lambda_\pi\)</span> implies that the restriction of
<span class="math inline">\(\tau\)</span> to <span
class="math inline">\(\mathfrak{z}\)</span> identifies with the linear
form on <span class="math inline">\(\mathfrak{z} \hookrightarrow
\mathfrak{Z}(\mathfrak{g})\)</span> given by evaluation at <span
class="math inline">\(\mathop{\mathrm{h}}\lambda_\pi\)</span>, so that
<span class="math inline">\(x(\mathop{\mathrm{h}}\lambda_\pi) =
x(\tau)\)</span>.</p>
<p>The standard basis element <span class="math inline">\(e_{n
n}\)</span> of <span class="math inline">\(\mathfrak{g}\)</span> lies in
<span class="math inline">\(\mathfrak{p} + \mathfrak{z}\)</span>: it is
the difference <span class="math inline">\(z - x\)</span>, where <span
class="math inline">\(z = e_{1 1} + \dotsb + e_{n n} \in
\mathfrak{z}\)</span> and <span class="math inline">\(x = e_{1 1} +
\dotsb + e_{n-1,n-1} \in \mathfrak{h} \subseteq \mathfrak{p}\)</span>.
We may thus take <span class="math display">\[e_{n n}^{\mathfrak{p}} :=
(e_{1 1} + \dotsb + e_{n n})(\mathop{\mathrm{h}}\lambda_\pi) - (e_{1 1}
+ \dotsb + e_{n-1,n-1}) \in S^1_0(\mathfrak{p}^\wedge).\]</span></p>
<p>To complete the proof of Theorem <a href="#thm:g-via-p"
data-reference-type="ref" data-reference="thm:g-via-p">257</a>, it
remains to consider <span class="math inline">\(x\)</span> of the form
<span class="math inline">\(e_{n j}\)</span> for some <span
class="math inline">\(j \in \{1,\dotsc, n-1\}\)</span>.</p>
<h4 id="sec:empha-priori-bounds">§17.4. A priori bounds</h4>
<div id="prop:standard2:each-fixed-x" class="proposition">
<p><strong>Proposition 258</strong>. <em>For each fixed <span
class="math inline">\(x \in \mathfrak{U}(\mathfrak{g})\)</span>, we have
<span class="math inline">\(\pi(x) {\mathop{\mathrm{h}}}^\infty
\mathcal{W}_\delta \subseteq {\mathop{\mathrm{h}}}^\infty
\mathcal{W}_\delta\)</span>.</em></p>
</div>
<div class="remark">
<p><strong>Remark 259</strong>. Since the notation is a bit concise, we
pause to explicate the conclusion. <em>Let <span class="math inline">\(W
\in \mathcal{W}(\pi,\psi_T)\)</span>. Suppose that for each fixed <span
class="math inline">\(m \geqslant 0\)</span>, we have <span
class="math inline">\(W \in {\mathop{\mathrm{h}}}^m
\mathcal{W}_\delta\)</span>. Then for each fixed <span
class="math inline">\(x \in \mathfrak{U}(\mathfrak{g})\)</span> and
fixed <span class="math inline">\(m \geqslant 0\)</span>, we have <span
class="math inline">\(\pi(x) W \in {\mathop{\mathrm{h}}}^m
\mathcal{W}_\delta\)</span>.</em> Informally, the proposition says that
the “negligible” subclass <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty
\mathcal{W}_\delta\)</span> of <span
class="math inline">\(\mathcal{W}_\delta\)</span> “remains negligible”
after taking <span class="math inline">\(G\)</span>-derivatives. In
contrast to the corresponding assertion for <span
class="math inline">\(P\)</span>-derivatives, this is not obvious, and
would be false without our running assumption that <span
class="math inline">\(\mathop{\mathrm{h}}\lambda_\pi =
\operatorname{O}(1)\)</span>. Of course, once we have proved Theorem <a
href="#thm:g-via-p" data-reference-type="ref"
data-reference="thm:g-via-p">257</a>, we will know the much sharper
assertion that <span class="math inline">\(\pi(x) \mathcal{W}_\delta
\subseteq {\mathop{\mathrm{h}}}^{-1} \mathcal{W}_\delta\)</span>. That
sharpening will be derived via a “bootstrapping” argument towards which
Proposition <a href="#prop:standard2:each-fixed-x"
data-reference-type="ref"
data-reference="prop:standard2:each-fixed-x">258</a> provides the first
step.</p>
<p>We note that the statement of Proposition <a
href="#prop:standard2:each-fixed-x" data-reference-type="ref"
data-reference="prop:standard2:each-fixed-x">258</a> is weaker than the
following statement: <em>for each <span class="math inline">\(W \in
\mathcal{W}_\delta\)</span> and fixed <span class="math inline">\(x \in
\mathfrak{U}(\mathfrak{g})\)</span>, we have <span
class="math inline">\(\pi(x) W \in {\mathop{\mathrm{h}}}^{-m}
\mathcal{W}_\delta\)</span> for some fixed <span
class="math inline">\(m\)</span></em>. We do not prove that stronger
statement here, although it will eventually fall out as a byproduct of
Theorem <a href="#thm:g-via-p" data-reference-type="ref"
data-reference="thm:g-via-p">257</a>.</p>
</div>
<p>As we will explain, the proof of Proposition <a
href="#prop:standard2:each-fixed-x" data-reference-type="ref"
data-reference="prop:standard2:each-fixed-x">258</a> is a direct
quantification of Jacquet’s proof of Theorem <a
href="#thm:jacquet-on-kirillov-model" data-reference-type="ref"
data-reference="thm:jacquet-on-kirillov-model">145</a>. We begin by
recalling the crucial statement proved by Jacquet.</p>
<div class="lemma">
<p><strong>Lemma 260</strong>. Let <span
class="math inline">\(\psi\)</span> be a nondegenerate unitary character
of <span class="math inline">\(N\)</span>. There is a linear map <span
class="math display">\[\ell_{\psi} : \mathfrak{U}(\mathfrak{g})
\rightarrow \mathfrak{U}(\mathfrak{h}) \otimes
\mathfrak{Z}(\mathfrak{g})\]</span> with the following property. Let
<span class="math inline">\(\pi\)</span> be a generic irreducible
unitary representation of <span class="math inline">\(G\)</span>, with
central character <span class="math inline">\(\lambda_\pi\)</span>. Let
<span class="math display">\[\ell_\pi : \mathfrak{U}(\mathfrak{h})
\otimes \mathfrak{Z}(\mathfrak{g}) \rightarrow
\mathfrak{U}(\mathfrak{g})\]</span> denote the linear, <span
class="math inline">\(\mathop{\mathrm{Ad}}(G)\)</span>-equivariant map
given on pure tensors by <span class="math display">\[y \otimes z
\mapsto \lambda_\pi(z) y.\]</span> Then for each <span
class="math inline">\(x \in \mathfrak{U}(\mathfrak{g})\)</span>, <span id="eq:pix-theta_pi-psi" class="math display">\[\label{eq:pix-theta_pi-psi}\tag{17.2}
  \pi(x) \Theta_{\pi,\psi} = \pi(\ell_{\pi}(\ell_\psi(x)))
\Theta_{\pi,\psi}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Besides notation, this is <a href="#ref-MR2733072" class="citation"
data-cites="MR2733072">(Hervé Jacquet 2010, Lemma 3)</a>. Indeed, the
third inclusion of <em>loc. cit.</em> asserts the following.</p>
<ul>
<li><p>Let <span class="math inline">\(V\)</span> be a <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span>-module, and
let <span class="math inline">\(\lambda \in V\)</span> be an element on
which <span class="math inline">\(\mathop{\mathrm{Lie}}(N)\)</span> acts
via the differential of <span class="math inline">\(\psi\)</span>. Then
<span class="math inline">\(\mathfrak{U}(\mathfrak{g}) \lambda \subseteq
\mathfrak{U}(\mathfrak{h}) \mathfrak{Z}(\mathfrak{g})
\lambda\)</span>.</p></li>
</ul>
<p>Choose a basis <span class="math inline">\(x_i\)</span> of <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span>. For each
basis element <span class="math inline">\(x_i\)</span>, choose <span
class="math inline">\(y_{i j} \in \mathfrak{U}(\mathfrak{h})\)</span>
and <span class="math inline">\(z_{i j} \in
\mathfrak{Z}(\mathfrak{g})\)</span>, where <span
class="math inline">\(j\)</span> runs over some finite index set, so
that <span class="math inline">\(x_i \lambda = \sum_j y_{i j} z_{i j}
\lambda\)</span>. The required conclusion then holds with <span
class="math inline">\(\ell_\psi(\sum_i c_i x_i) := \sum_{i,j} c_i y_{i
j} \otimes z_{i j}\)</span>. ◻</p>
</div>
<p>We record a characterization of <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty
\tilde{\mathcal{W}}_\delta(\mathfrak{h}) = T^{-\infty} \mathfrak{C}(H,
-\theta_H(\psi), T, \delta)\)</span>, following from Lemma <a
href="#lem:standard2:let-v-p" data-reference-type="ref"
data-reference="lem:standard2:let-v-p">125</a>:</p>
<div id="lem:scratch-research:hinfty-tild-cons" class="lemma">
<p><strong>Lemma 261</strong>. The class <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty
\tilde{\mathcal{W}}_{\delta}(\mathfrak{h})\)</span> consists of all
<span class="math inline">\(f \in C_c^\infty(H)\)</span> that are
supported on <span class="math inline">\(1 +
\operatorname{O}({\mathop{\mathrm{h}}}^{1 - \delta_+})\)</span> for some
fixed <span class="math inline">\(\delta_+ \in (\delta,1/2)\)</span> and
that satisfy, for all fixed <span class="math inline">\(x,y \in
\mathfrak{U}(\mathfrak{g})\)</span>, the derivative bound <span id="eq:x-ast-f" class="math display">\[\label{eq:x-ast-f}\tag{17.3}
    \|x \ast f \ast y\|_{\infty} \ll
{\mathop{\mathrm{h}}}^\infty\]</span></p>
</div>
<p>We now apply arguments analogous to those of <a href="#ref-MR2733072" class="citation"
data-cites="MR2733072">(Hervé Jacquet 2010, Proof of Lemma 5)</a>.
Recall that <span class="math inline">\(T =
1/\mathop{\mathrm{h}}\)</span>. Set <span class="math inline">\(a_T :=
\mathop{\mathrm{diag}}(T^{n-1}, T^{n-2}, \dotsc, T, 1) \in G\)</span>.
Then <span class="math inline">\(\pi(a_T) \Theta_{\pi,\psi}\)</span> is
a multiple of <span class="math inline">\(\Theta_{\pi,\psi_T}\)</span>,
so by applying <a href="#eq:pix-theta_pi-psi"
data-reference-type="eqref"
data-reference="eq:pix-theta_pi-psi">\((17.2)\)</a> to <span
class="math inline">\(\mathop{\mathrm{Ad}}(a_T)^{-1} x\)</span>, we see
that <span class="math display">\[\pi(x) \Theta_{\pi,\psi_T} = \pi
(\ell_\pi(\mathop{\mathrm{Ad}}(a_T)
\ell_\psi(\mathop{\mathrm{Ad}}(a_T)^{-1} x)))
\Theta_{\pi,\psi_T}.\]</span> Let <span class="math inline">\(x \in
\mathfrak{U}(\mathfrak{g})\)</span>. Then <span
class="math display">\[\begin{align}
  \pi(x) \pi(f) \Theta_{\pi,\psi_T} &amp;= \int_{g \in H} f(g) \pi(x)
\pi(g) \Theta_{\pi,\psi_T} \, d g \\
  &amp;= \int_{g \in H} f(g) \pi(g) \pi(\mathop{\mathrm{Ad}}(g)^{-1}  x)
\Theta_{\pi,\psi_T} \, d g.
\end{align}\]</span> Fix a monomial basis <span
class="math inline">\(\{x_i\}\)</span> for <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})\)</span> and write
<span class="math inline">\(\mathop{\mathrm{Ad}}(g)^{-1} x = \sum_i
c_i(g) x_i\)</span>, with each <span class="math inline">\(c_i \in
C^\infty(H)\)</span>. Then, abbreviating <span
class="math display">\[y_{i,\pi,T}
:=  \ell_\pi(\mathop{\mathrm{Ad}}(a_T)
\ell_\psi(\mathop{\mathrm{Ad}}(a_T)^{-1} x_i)) \in
\mathfrak{U}(\mathfrak{g}),\]</span> we have <span
class="math display">\[\begin{align}
  \pi(\mathop{\mathrm{Ad}}(g)^{-1}  x) \Theta_{\pi,\psi_T}
  &amp;=
  \sum_i c_i(g) \pi(x_i) \Theta_{\pi,\psi_T} \\
  &amp;=
  \sum_i
  c_i(g) \pi (y_{i,\pi,T}) \Theta_{\pi,\psi_T}.
\end{align}\]</span> Setting <span class="math display">\[f_i(g) :=
c_i(g) f(g), \quad
  f_i&#39; := f_i \ast y_{i,\pi,T},
  \quad
  f&#39; := \sum_i f_i&#39;,\]</span> we obtain <span id="eq:pix-pif-theta_pi" class="math display">\[\label{eq:pix-pif-theta_pi}\tag{17.4}
  \pi(x) \pi(f) \Theta_{\pi,\psi_T} = \pi(f&#39;)
\Theta_{\pi,\psi_T}.\]</span></p>
<p>Jacquet observes, in the “<span class="math inline">\(T=1\)</span>”
setting, that the map <span class="math inline">\(f \mapsto
f&#39;\)</span> on <span class="math inline">\(C_c^\infty(H)\)</span> is
continuous. In the present setting, the continuity is polynomially
effective, in the following sense, with respect to <span
class="math inline">\(T = 1/\mathop{\mathrm{h}}\)</span>:</p>
<div id="lem:scratch-research:fix-x-in" class="lemma">
<p><strong>Lemma 262</strong>. Fix <span class="math inline">\(x \in
\mathfrak{U}(\mathfrak{g})\)</span>. Let <span class="math inline">\(f
\in {\mathop{\mathrm{h}}}^\infty
\tilde{\mathcal{W}}_\delta(\mathfrak{h})\)</span>. Define <span
class="math inline">\(f&#39; \in C_c^\infty(H)\)</span> as above. Then
<span class="math display">\[f&#39; \in {\mathop{\mathrm{h}}}^\infty
\tilde{\mathcal{W}}_\delta(\mathfrak{h}).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We appeal to the characterization of <span
class="math inline">\(\tilde{\mathcal{W}}_\delta(\mathfrak{h})\)</span>
given by Lemma <a href="#lem:scratch-research:hinfty-tild-cons"
data-reference-type="ref"
data-reference="lem:scratch-research:hinfty-tild-cons">261</a>. Since
<span class="math inline">\(\mathop{\mathrm{supp}}(f&#39;) \subseteq
\mathop{\mathrm{supp}}(f)\)</span>, the required support condition for
<span class="math inline">\(f&#39;\)</span> is satisfied. Since <span
class="math inline">\(x\)</span> is fixed, the functions <span
class="math inline">\(c_i \in C^\infty(H)\)</span> vanish for <span
class="math inline">\(i\)</span> outside some fixed finite set, and each
function <span class="math inline">\(c_i\)</span> is fixed. Therefore
each <span class="math inline">\(f_i\)</span> likewise lies in <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty
\tilde{\mathcal{W}}_\delta\)</span>. Next, since <span
class="math inline">\(\mathop{\mathrm{h}}\lambda_\pi =
\operatorname{O}(1)\)</span>, we know that for fixed <span
class="math inline">\(i\)</span>, the element <span
class="math inline">\(y_{i,\pi,T}\)</span> has degree <span
class="math inline">\(\operatorname{O}(1)\)</span> and coefficients
<span class="math inline">\(\ll T^{\operatorname{O}(1)}\)</span>. We may
thus absorb the <span class="math inline">\(y_{i,\pi,T}\)</span> into
the quantities <span class="math inline">\(x\)</span> and <span
class="math inline">\(y\)</span> appearing in the estimate <a
href="#eq:x-ast-f" data-reference-type="eqref"
data-reference="eq:x-ast-f">\((17.3)\)</a> without affecting that
estimate. We conclude that each <span
class="math inline">\(f_i&#39;\)</span> and hence <span
class="math inline">\(f&#39;\)</span> itself lies in <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty
\tilde{\mathcal{W}}_\delta\)</span>. ◻</p>
</div>
<div class="proof">
<p><em>Proof of Proposition <a href="#prop:standard2:each-fixed-x"
data-reference-type="ref"
data-reference="prop:standard2:each-fixed-x">258</a>.</em> Let <span
class="math inline">\(v \in {\mathop{\mathrm{h}}}^\infty
\mathcal{W}_\delta\)</span>. By Lemma <a
href="#lem:standard2:overspill-frak-C-M" data-reference-type="ref"
data-reference="lem:standard2:overspill-frak-C-M">126</a>, we may find
<span class="math inline">\(\ell \geqslant 0\)</span> with <span
class="math inline">\(\ell \ggg 1\)</span> so that <span
class="math inline">\({\mathop{\mathrm{h}}}^{-\ell} v \in
{\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta \subseteq
\mathcal{W}_\delta\)</span>. We may thus write <span
class="math display">\[{\mathop{\mathrm{h}}}^{-\ell} v = \pi(f_0)
\Theta_{\pi,\psi_T}\]</span> for some <span class="math inline">\(f_0
\in \tilde{\mathcal{W}}_\delta\)</span>. Then <span
class="math inline">\(f := {\mathop{\mathrm{h}}}^{\ell} f_0 \in
{\mathop{\mathrm{h}}}^\infty \tilde{\mathcal{W}}_{\delta}\)</span>. Fix
<span class="math inline">\(x \in \mathfrak{U}(\mathfrak{g})\)</span>.
Define <span class="math inline">\(f&#39;\)</span> as above, so that <a
href="#eq:pix-pif-theta_pi" data-reference-type="eqref"
data-reference="eq:pix-pif-theta_pi">\((17.4)\)</a> holds,
whence <span class="math display">\[\pi(x) v = \pi(f&#39;)
\Theta_{\pi,\psi_T}.\]</span> By Lemma <a
href="#lem:scratch-research:fix-x-in" data-reference-type="ref"
data-reference="lem:scratch-research:fix-x-in">262</a>, we have <span
class="math inline">\(f&#39; \in {\mathop{\mathrm{h}}}^\infty
\tilde{\mathcal{W}}_\delta\)</span>. By Lemma <a
href="#lem:standard2:overspill-frak-C-M" data-reference-type="ref"
data-reference="lem:standard2:overspill-frak-C-M">126</a>, we may find
<span class="math inline">\(\ell &#39; \geqslant 0\)</span> with <span
class="math inline">\(\ell &#39; \ggg 1\)</span> so that <span
class="math inline">\(f &#39; \in {\mathop{\mathrm{h}}}^{\ell}
\tilde{\mathcal{W}}_\delta\)</span>. By Lemma <a
href="#lem:map-c_cinftyp-ni-tilde-W-delta-W" data-reference-type="ref"
data-reference="lem:map-c_cinftyp-ni-tilde-W-delta-W">251</a>, it
follows that <span class="math display">\[\pi(f&#39;)
\Theta_{\pi,\psi_T} \in {\mathop{\mathrm{h}}}^{\ell} \mathcal{W}_\delta
\subseteq {\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta.\]</span> We
conclude, as required, that <span class="math inline">\(\pi(x) v \in
{\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta\)</span>. ◻</p>
</div>
<h4 id="capelli-identities">Capelli identities</h4>
<p>Recall from §<a href="#sec:gener-line-groups"
data-reference-type="ref" data-reference="sec:gener-line-groups">2.2</a>
that <span class="math display">\[e = (e_{ij }) :
{\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R}) \rightarrow
\mathfrak{g} \hookrightarrow
\mathop{\mathrm{Sym}}(\mathfrak{g})\]</span> denotes the “identity map”
tailored to the symmetric algebra. We denote by <span
class="math inline">\(E = (E_{i j})\)</span> the corresponding “identity
map” <span class="math display">\[E = (E_{i j}) :
{\mathop{\mathrm{\mathfrak{g}\mathfrak{l}}}}_n(\mathbb{R}) \rightarrow
\mathfrak{g} \hookrightarrow \mathfrak{U}(\mathfrak{g})\]</span> but
tailored now to the universal enveloping algebra. Thus <span
class="math inline">\(E_{i j} \in \mathfrak{g} \hookrightarrow
\mathfrak{U}(\mathfrak{g})\)</span> is the standard basis element. We
note that <span class="math inline">\(E_{i j}\)</span> is the image of
<span class="math inline">\(e_{i j}\)</span> under the symmetrization
map <span class="math inline">\(\mathop{\mathrm{sym}}:
\mathop{\mathrm{Sym}}(\mathfrak{g}) \rightarrow
\mathfrak{U}(\mathfrak{g})\)</span>.</p>
<p>We define the “characteristic polynomial” <span
class="math inline">\(\det(X+E) \in
\mathfrak{U}(\mathfrak{g})[X]\)</span>, as follows. We identify <span
class="math inline">\(X\)</span> with the scalar matrix <span
class="math inline">\(\mathop{\mathrm{diag}}(X,\dotsc,X)\)</span> and
set <span class="math display">\[\rho := \mathop{\mathrm{diag}}\left(
\tfrac{n-1}{2}, \tfrac{n-3}{2}, \dotsc , \tfrac{1-n}{2}
\right),\]</span> so that the sum <span class="math display">\[X + \rho
+ E\]</span> defines an <span class="math inline">\(n \times n\)</span>
matrix with entries in the ring <span
class="math inline">\(\mathfrak{U}(\mathfrak{g})[X]\)</span>.</p>
<p>For an <span class="math inline">\(n \times n\)</span> matrix <span
class="math inline">\(A = (A_{i j})\)</span> with entries in a
not-necessarily-commutative ring, we define the determinant via the
following convention: <span class="math display">\[\det(A) := \sum
_{\sigma \in S(n)} (-1)^\sigma A_{n,\sigma(n)} A_{n-1,\sigma(n-1)}
\dotsb A_{2,\sigma(2)} A_{1,\sigma(1)}.\]</span></p>
<div class="lemma">
<p><strong>Lemma 263</strong> (Capelli, Howe–Umeda). We have <span
class="math inline">\(\det(X + \rho + E) \in
\mathfrak{Z}(\mathfrak{g})[X]\)</span>. Moreover, writing <span
class="math display">\[\gamma : \mathfrak{Z}(\mathfrak{g}_\mathbb{C})[X]
\xrightarrow{\cong }
\mathop{\mathrm{Sym}}(\mathfrak{g}_\mathbb{C})[X]\]</span> for the
coefficient-wise application of the Harish–Chandra isomorphism, we have
<span class="math display">\[\gamma(\det(X + \rho + E)) = \det(X +
e),\]</span> where <span class="math inline">\(\det(X + e)\)</span> is
as defined in §<a href="#sec:char-polyn" data-reference-type="ref"
data-reference="sec:char-polyn">2.2.1</a>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> Up to cosmetic differences, this is contained in
<a href="#ref-MR1116239" class="citation" data-cites="MR1116239">(Howe and Umeda
1991)</a>. See for instance <a href="#ref-MR2035111" class="citation"
data-cites="MR2035111">(Molev 2003, sec. 4.1)</a> for a formulation
much like ours. We note that the main point is that the coefficients of
<span class="math inline">\(\det(X + \rho + E)\)</span> are <span
class="math inline">\(G\)</span>-invariant. Taking this for granted, it
is easy to compute the image under <span
class="math inline">\(\gamma\)</span>: Taking for <span
class="math inline">\(\mathfrak{t}_\mathbb{C}\)</span> the diagonal
subalgebra and <span
class="math inline">\(\mathfrak{n}_{\mathbb{C}}^{-}\)</span> the
lower-triangular subspace, we see that the contribution of each
non-identity permutation lies in <span
class="math inline">\(\mathfrak{n}_\mathbb{C}^-
\mathfrak{U}(\mathfrak{g}_\mathbb{C})\)</span>, while the identity
permutation maps to the product over <span class="math inline">\(j \in
\{1, \dotsc, n\}\)</span> of <span class="math display">\[\gamma (X +
E_{j j} + \tfrac{n +1 - 2 j}{2}) = X + e_{j j}.\]</span> We conclude by
noting that the restriction of that product to <span
class="math inline">\(\mathfrak{t}_\mathbb{C}^*\)</span> coincides with
the restriction of <span class="math inline">\(\det(X+e)\)</span>. ◻</p>
</div>
<h4 id="sec:comm-cofact-expans">§17.6. Commutative cofactor expansion</h4>
<p>Recall Lemma <a href="#lem:construction-tau-from-theta"
data-reference-type="ref"
data-reference="lem:construction-tau-from-theta">141</a> concerning the
existence and uniquness of <span class="math inline">\(\tau =
\tau(\psi,\lambda)\)</span>. Both as an excuse to introduce notation and
for motivational purposes, we reformulate here the uniqueness part of
the proof of that lemma a bit more verbosely. The problem is to show
that the entries <span class="math inline">\(\tau_{j n}\)</span> are
determined by the conditions <span class="math inline">\([\tau] =
\lambda\)</span> and <span class="math inline">\(\tau_P =
\theta\)</span>. Starting with the definition <a href="#eq:detx-+-e"
data-reference-type="eqref"
data-reference="eq:detx-+-e">\((7.3)\)</a> of <span
class="math inline">\(\det(X + e)\)</span>, we group the permutations
<span class="math inline">\(\sigma \in S(n)\)</span> according to <span
class="math inline">\(j = \sigma(n)\)</span> to obtain the cofactor
expansion <span id="eq:detx-+-e-1" class="math display">\[\label{eq:detx-+-e-1}\tag{17.5}
  \det(X + e) = \sum _{j = 1}^n ( 1_{n=j} X + e_{n j} )
\mathfrak{d}_j(X),\]</span> where <span
class="math inline">\(\mathfrak{d}_j(X)\)</span> denotes the <span
class="math inline">\((n,j)\)</span> minor, obtained by restricting the
sum and product in the definition <a href="#eq:detx-+-e"
data-reference-type="eqref"
data-reference="eq:detx-+-e">\((7.3)\)</a> of <span
class="math inline">\(\det(X+e)\)</span> to <span
class="math inline">\(\sigma(n) = j\)</span> and <span
class="math inline">\(i \leqslant n-1\)</span>. The coefficients of
<span class="math inline">\(\mathfrak{d}_j(X)\)</span>, viewing the
latter as a one-variable polynomial, lie in <span
class="math inline">\(\mathop{\mathrm{Sym}}(\mathfrak{p})\)</span>,
hence <span class="math inline">\(\mathfrak{d}_j(X)\)</span> itself lies
in <span
class="math inline">\(\mathop{\mathrm{Sym}}(\mathfrak{p})[X]\)</span>.</p>
<p>We evaluate the expansion <a href="#eq:detx-+-e-1"
data-reference-type="eqref"
data-reference="eq:detx-+-e-1">\((17.5)\)</a> on <span
class="math inline">\(\tau\)</span>. Since <span
class="math inline">\([\tau] = \lambda\)</span>, we have <span
class="math inline">\(\det(X + e)(\tau) =
\mathcal{P}_\lambda(X)\)</span>. Since <span
class="math inline">\(\tau_P = \theta\)</span>, we have <span
class="math inline">\(\mathfrak{d}_j(X)(\tau) =
\mathfrak{d}_j(X)(\theta)\)</span>. Since we have defined the duality
between <span class="math inline">\(\mathfrak{g}\)</span> and <span
class="math inline">\(\mathfrak{g}^\wedge\)</span> using the trace
pairing, we have <span class="math inline">\(e_{n j}(\tau) = \tau_{j
n}\)</span>. Since <span
class="math inline">\(\mathop{\mathrm{trace}}(\theta) = 0\)</span>, we
deduce in particular that <span class="math inline">\(\tau_{n n} =
\mathfrak{c}_1(\lambda)\)</span>. We may thus write our cofactor
expansion in the form <span class="math display">\[\sum _{j=1}^{n-1}
\tau_{j n} \mathfrak{d}_j(X)(\theta) = \mathcal{P}_\lambda(X) - (X +
\mathfrak{c}_1(\lambda)) X^{n-1}.\]</span></p>
<p>To see that this expansion determines <span
class="math inline">\(\tau\)</span>, we specialize the variable <span
class="math inline">\(X\)</span> to the elements of any finite
collection <span class="math inline">\(\{x_1,\dotsc,x_{n-1}\}\)</span>
of distinct real numbers. This gives a system of <span
class="math inline">\(n-1\)</span> linear equations in the same number
of unknowns. With identifications as in §<a href="#sec:parameter-theta"
data-reference-type="ref"
data-reference="sec:parameter-theta">2.3.2</a>, we have, e.g., for <span
class="math inline">\(n=4\)</span>, <span class="math display">\[X +
\theta
  \leftrightarrow
    \begin{pmatrix}
      X &amp; 0 &amp; 0 &amp; ? \\
    \eta_1  &amp; X  &amp; 0 &amp; ? \\
    0 &amp; \eta_2  &amp; X &amp; ? \\
    0 &amp; 0 &amp; \eta_3  &amp; ?
  \end{pmatrix},\]</span> from which it follows that <span id="eqn:frak-d-j-X-tau" class="math display">\[\label{eqn:frak-d-j-X-tau}\tag{17.6}
  \mathfrak{d}_j(X)(\theta)
  =
  \pm
  X^{j-1}
  \eta_j \eta_{j+1} \dotsb \eta_{n-1}.\]</span> By the nonvanishing of
the <span class="math inline">\(\eta_j\)</span> and the invertibility of
the Vandermonde determinant, the system characterizes <span
class="math inline">\(\tau\)</span>, as required.</p>
<p>The proof of Theorem <a href="#thm:g-via-p" data-reference-type="ref"
data-reference="thm:g-via-p">257</a>, given below, amounts to a “quantum
analogue” of the above calculations.</p>
<h4 id="non-commutative-cofactor-expansion">Non-commutative cofactor
expansion</h4>
<p>We may similarly write <span id="eqn:non-comm-cofactor" class="math display">\[\label{eqn:non-comm-cofactor}\tag{17.7}
  \det(X + \rho + E)
  =
  \sum_{j=1}^n
  \left(1_{n=j}
    \left(X
      - \tfrac{n-1}{2} \right)
    +
    E_{n j} \right)
  \mathfrak{D}_j(X)\]</span> for some “non-commutative minors” <span
class="math inline">\(\mathfrak{D}_j(X) \in
\mathfrak{U}(\mathfrak{p})[X]\)</span>, defined in the evident way.</p>
<p>In what follows, we write <span
class="math inline">\(\mathfrak{U}^{\leqslant k}(\dotsb)\)</span> for
the <span class="math inline">\(k\)</span>th graded part of a universal
enveloping algebra, spanned by monomials of degree at most <span
class="math inline">\(k\)</span>.</p>
<p>By evaluating the commutative and non-commutator minors at a scalar
<span class="math inline">\(x\)</span>, we obtain elements <span
class="math display">\[\mathfrak{d}_i(x) \in
{\mathop{\mathrm{Sym}}}^{n-1}(\mathfrak{p}), \quad \mathfrak{D}_i(x) \in
\mathfrak{U}^{\leqslant n-1}(\mathfrak{p}).\]</span> In fact, if <span
class="math inline">\(x \ll 1\)</span>, then the polynomial <span
class="math inline">\(\mathfrak{d}_i(x)\)</span> defines an element of
the symbol class <span
class="math inline">\(S^{n-1}_0(\mathfrak{p}^\wedge)\)</span>. We may
view <span class="math inline">\(\mathfrak{d}_i(x)\)</span> as the
“classical limit” of <span
class="math inline">\(\mathfrak{D}_j(x)\)</span> in many ways, the
following of which suffices for our purposes.</p>
<div id="lem:non-comm-cofact" class="lemma">
<p><strong>Lemma 264</strong>. For each <span class="math inline">\(i
\in \{1, \dotsc, n\}\)</span> and scalar <span class="math inline">\(x
\ll 1\)</span> there is a symbol <span class="math display">\[d_i(x) \in
S_0^{n-1}(\mathfrak{p}^\wedge)\]</span> with the following
properties.</p>
<ol type="i">
<li><p><span class="math inline">\(\mathop{\mathrm{Op}}(d_i(x)) =
{\mathop{\mathrm{h}}}^{n-1} \mathfrak{D}_i({\mathop{\mathrm{h}}}^{-1}
x)\)</span>.</p></li>
<li><p><span class="math inline">\(d_i(x) - \mathfrak{d}_i(x) \in
\mathop{\mathrm{h}}S_0^{n-2}(\mathfrak{p}^\wedge)\)</span>.</p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> Write <span
class="math inline">\(\mathop{\mathrm{sym}}:
\mathop{\mathrm{Sym}}(\mathfrak{g})[X] \rightarrow
\mathfrak{U}(\mathfrak{g})[X]\)</span> for the map of polynomial rings
induced by the symmetrization map on coefficients. Temporarily set <span
class="math inline">\(\mathfrak{S}^k :=
{\mathop{\mathrm{Sym}}}^k(\mathfrak{p})\)</span> and <span
class="math inline">\(\mathfrak{U}^{\leqslant k} :=
\mathfrak{U}^{\leqslant k}(\mathfrak{p})\)</span>. Observe that <span
class="math display">\[\mathfrak{d}_i(X) \in \oplus_{k=0}^{n-1}
\mathfrak{S}^k X^{n-1-k},\]</span> <span
class="math display">\[\mathfrak{D}_i(X) \in \oplus_{k=0}^{n-1}
\mathfrak{U}^{\leqslant k} X^{n-1-k}.\]</span> By comparing the
definitions of <span class="math inline">\(\mathfrak{d}_i\)</span> and
<span class="math inline">\(\mathfrak{D}_i\)</span>, we see that the
coefficient of <span class="math inline">\(X^{n-1-k}\)</span> in <span
class="math inline">\(\mathcal{D}_i(X)\)</span> has image in <span
class="math inline">\(\mathfrak{U}^{\leqslant k} /
\mathfrak{U}^{\leqslant k-1} \cong \mathfrak{S}^k\)</span> given by the
corresponding coefficient of <span
class="math inline">\(\mathfrak{d}_i(X)\)</span>. Thus <span
class="math display">\[\mathop{\mathrm{sym}}(\mathfrak{d}_i(X)) -
\mathfrak{D}_i(X) \in \oplus _{k = 1}^{n-1} \mathfrak{U}^{\leqslant k-1}
X^{n-1-k}.\]</span></p>
<p>We iteratively construct polynomials <span
class="math inline">\(\mathfrak{d}_i^{(\ell)}(X)\)</span> for <span
class="math inline">\(\ell \in \{0,\dotsc,n-1\}\)</span> by setting
<span class="math inline">\(\mathfrak{d}_i^{(0)}(X) :=
\mathfrak{d}_i(X)\)</span> and requiring that <span
class="math display">\[\mathfrak{d}_i^{(\ell)}(X) \in
\oplus_{k=\ell}^{n-1} \mathfrak{S}^{j-\ell} X^{n-1-k}\]</span> and <span
class="math display">\[\mathfrak{D}_i(X) = \sum _{\ell=0}^{n-1}
\mathop{\mathrm{sym}}(\mathfrak{d}_i^{(\ell)}(X)).\]</span> For <span
class="math inline">\(p \in
\mathop{\mathrm{Sym}}(\mathfrak{p})\)</span>, write <span
class="math inline">\({\mathop{\mathrm{sym}}}_{\mathop{\mathrm{h}}}(p) :=
\mathop{\mathrm{sym}}(p_{\mathop{\mathrm{h}}})\)</span>, where <span
class="math inline">\(p \mapsto p_{\mathop{\mathrm{h}}}\)</span>
multiplies the summand <span
class="math inline">\(\mathfrak{S}^k\)</span> by <span
class="math inline">\({\mathop{\mathrm{h}}}^k\)</span>. Since the rescaled
polynomial <span
class="math inline">\({\mathop{\mathrm{h}}}^{n-1}\mathfrak{D}_i({\mathop{\mathrm{h}}}^{-1}
X)\)</span> is obtained from <span
class="math inline">\(\mathcal{D}_i(X)\)</span> by multiplying the
coefficient of <span class="math inline">\(X^{n-1-k}\)</span> by <span
class="math inline">\({\mathop{\mathrm{h}}}^k\)</span>, we have <span
class="math display">\[{\mathop{\mathrm{h}}}^{n-1}
\mathfrak{D}_i({\mathop{\mathrm{h}}}^{-1} X) =
{\mathop{\mathrm{sym}}}_{\mathop{\mathrm{h}}}(d_i(X)),\]</span> where
<span class="math display">\[d_i(X) := \sum _{\ell =0 }^{n-1}
{\mathop{\mathrm{h}}}^{\ell} \mathfrak{d}_i^{(\ell)}(X).\]</span> By
construction, <span class="math display">\[d_i(X) \in \oplus_{k=0}^{n-1}
S_0^k(\mathfrak{p}^\wedge) X^{n-1-k},\]</span> <span
class="math display">\[d_i(X) - \mathfrak{d}_i(X) \in \oplus_{k=1}^{n-1}
\mathop{\mathrm{h}}S_0^{k-1}(\mathfrak{p}^\wedge) X^{n-1-k}.\]</span>
The required conclusions follow by specializing to a scalar argument
<span class="math inline">\(x \ll 1\)</span>. ◻</p>
</div>
<h4 id="sec:completion-proof-2">§17.8. Completion of the proof</h4>
<p>We now prove Theorem <a href="#thm:g-via-p" data-reference-type="ref"
data-reference="thm:g-via-p">257</a>. As noted following its statement,
the crucial case is that of the Lie algebra elements <span
class="math inline">\(e_{n j}\)</span> for <span class="math inline">\(j
\in \{1,\dotsc,n-1\}\)</span>.</p>
<p>Our point of departure is the following identity of polynomials in
<span class="math inline">\(X\)</span>, with coefficients in <span
class="math inline">\(\mathop{\mathrm{End}}(\pi)\)</span>: <span
class="math display">\[\pi(\det(X + \rho + E)) = \det(X+e)(\lambda_\pi)
= \mathcal{P}_{\lambda_\pi}(X).\]</span> By rescaling, we obtain <span
class="math display">\[{\mathop{\mathrm{h}}}^{n}
\pi(\det({\mathop{\mathrm{h}}}^{-1} X + \rho + E)) =
\mathcal{P}_{\mathop{\mathrm{h}}\lambda_\pi}(X).\]</span> We choose real
numbers <span class="math inline">\(x_1,\dotsc,x_{n-1}\)</span> with
<span class="math inline">\(x_i \ll 1\)</span> and <span
class="math inline">\(x_i - x_j \gg 1\)</span> for <span
class="math inline">\(i \neq j\)</span>. For instance, the choice <span
class="math inline">\(x_j := j\)</span> would do. With <span
class="math inline">\(d_i\)</span> as in lemma <a
href="#lem:non-comm-cofact" data-reference-type="ref"
data-reference="lem:non-comm-cofact">264</a>, we set <span id="eq:aijdixj" class="math display">\[\label{eq:aijdixj}\tag{17.8}
  a_{i j} := d_i(x_j) \in S^{n-1}_0(\mathfrak{p}^\wedge),\]</span> so
that <span class="math inline">\(\mathop{\mathrm{Op}}(a_{i j}) =
{\mathop{\mathrm{h}}}^{n-1}\pi( \mathfrak{D}_i({\mathop{\mathrm{h}}}^{-1}
x_j))\)</span>. We obtain from the cofactor expansion <a
href="#eqn:non-comm-cofactor" data-reference-type="eqref"
data-reference="eqn:non-comm-cofactor">\((17.7)\)</a> the
following identity of operators on <span
class="math inline">\(\pi\)</span>: <span id="eqn:specialized-non-commutative-cofactor" class="math display">\[\label{eqn:specialized-non-commutative-cofactor}\tag{17.9}
  \sum_{i=1}^{n-1}
  \mathop{\mathrm{Op}}(e_{n i})
  \mathop{\mathrm{Op}}(a_{i j})
  =
  \mathop{\mathrm{Op}}(f_j),\]</span> where <span
class="math display">\[f_j := (\mathop{\mathrm{h}}\tfrac{n-1}{2} - x_j -
e_{n n}^{\mathfrak{p}}) \star_{\mathop{\mathrm{h}}} a_{n j} +
\mathcal{P}_{\mathop{\mathrm{h}}\lambda_\pi}(x_j) \in
S^n_0(\mathfrak{p}^\wedge).\]</span> We note that because all involved
symbols are polynomials, the composition formula for the star product in
the definition of <span class="math inline">\(f_j\)</span> holds without
any remainder term.</p>
<p>We aim now to study <span
class="math inline">\(\mathop{\mathrm{Op}}(e_{n i})\)</span> by
approximately inverting the relations <a
href="#eqn:specialized-non-commutative-cofactor"
data-reference-type="eqref"
data-reference="eqn:specialized-non-commutative-cofactor">\((17.9)\)</a>.</p>
<p>By lemma <a href="#lem:non-comm-cofact" data-reference-type="ref"
data-reference="lem:non-comm-cofact">264</a>, we have <span
class="math inline">\(a_{i j}(\theta) = \mathfrak{d}_i(x_j)(\theta) +
\operatorname{O}(\mathop{\mathrm{h}})\)</span>. Since the first
derivatives of <span class="math inline">\(a_{i j}\)</span> are <span
class="math inline">\(\operatorname{O}(1)\)</span> on <span
class="math inline">\(\theta + \operatorname{O}(1)\)</span>, we see in
particular that <span class="math display">\[\xi = \theta + o(1)
\implies a_{i j}(\xi) = \mathfrak{d}_i(x_j)(\theta) + o(1).\]</span> For
<span class="math inline">\(r &gt; 0\)</span>, set <span
class="math inline">\(B_\theta(r) := \{\xi : |\xi - \theta| &lt;
r\}\)</span>. By our evaluation <a href="#eqn:frak-d-j-X-tau"
data-reference-type="eqref"
data-reference="eqn:frak-d-j-X-tau">\((17.6)\)</a> and the
invertibility of the Vandermonde matrix, we may find a fixed <span
class="math inline">\(r &gt; 0\)</span> so that <span id="eq:det-a_i-jxi_i" class="math display">\[\label{eq:det-a_i-jxi_i}\tag{17.10}
\det( (a_{i j}(\xi))_{i,j}) \gg 1\]</span> for <span
class="math inline">\(\xi \in B_\theta(3 r)\)</span>. We choose a symbol
<span class="math inline">\(c \in
S^{-\infty}_0(\mathfrak{p}^\wedge)\)</span> supported on <span
class="math inline">\(B_\theta(2 r)\)</span> and taking the value <span
class="math inline">\(1\)</span> on <span
class="math inline">\(B_\theta(r)\)</span>.</p>
<p>Let <span class="math inline">\(v \in \mathcal{W}_\delta\)</span>.
Since <span class="math inline">\(v\)</span> is <span
class="math inline">\((\mathfrak{p},\delta)\)</span>-localized at <span
class="math inline">\(\theta\)</span> and <span
class="math inline">\(c-1\)</span> vanishes on <span
class="math inline">\(\theta + o(1)\)</span>, we see from Theorem <a
href="#thm:S-infinity-modules-localized-stuff" data-reference-type="ref"
data-reference="thm:S-infinity-modules-localized-stuff">14.12</a>
(part <a href="#item:1-thm:S-infinity-modules-localized-stuff"
data-reference-type="eqref"
data-reference="item:1-thm:S-infinity-modules-localized-stuff">\((i)\)</a>)
that <span id="eqn:c-nearly-preserves-v" class="math display">\[%\label{eqn:c-nearly-preserves-v}\tag{}
  \mathop{\mathrm{Op}}(c) v \equiv v \mod{{\mathop{\mathrm{h}}}^\infty
    \mathcal{W}_\delta}.\]</span></p>
<p>We let <span class="math inline">\(b_{j k}^{(0)} \in
S^{-\infty}_0(\mathfrak{p}^\wedge)\)</span> (<span
class="math inline">\(1 \leqslant j,k \leqslant n-1\)</span>) denote the
symbols characterized by the following properties:</p>
<ul>
<li><p><span class="math inline">\(\mathop{\mathrm{supp}}(b_{j k}^{(0)})
\subseteq \mathop{\mathrm{supp}}(c)\)</span></p></li>
<li><p><span class="math inline">\(\sum_j a_{i j}(\xi) b_{j
k}^{(0)}(\xi) = 1_{i=k} c(\xi)\)</span>.</p></li>
</ul>
<p>Such symbols exist in view of the noted lower bound for the
determinant of <span class="math inline">\(a_{i j}\)</span> on the
support of <span class="math inline">\(c\)</span>. We inductively
construct <span class="math inline">\(b_{jk}^{(\ell)}\)</span> (<span
class="math inline">\(\ell \geqslant 1\)</span>) so that we have the
formal star product expansion <span id="eqn:formal-star-prod-matrix" class="math display">\[\label{eqn:formal-star-prod-matrix}\tag{17.11}
  \sum_j a_{i j} \star_{\mathop{\mathrm{h}}} \sum_{\ell \geqslant 0}
{\mathop{\mathrm{h}}}^{\ell} b_{j k}^{(\ell)} \sim  1_{i=k} c,\]</span>
where the notation <span class="math inline">\(\sim\)</span> signifies
that the indicated expansion holds as a formal series in the variable
<span class="math inline">\(\mathop{\mathrm{h}}\)</span> upon expanding
<span class="math inline">\(\star_{\mathop{\mathrm{h}}}\)</span>
formally into its homogeneous components. In more detail, let us write
<span class="math inline">\(A\)</span> and <span
class="math inline">\(B^{(0)}\)</span> and <span
class="math inline">\(C\)</span> for the matrix-valued symbols <span
class="math inline">\(\mathfrak{p}^\wedge \rightarrow
M_{n-1}(\mathbb{C})\)</span> with respective entries <span
class="math inline">\(a_{i j}\)</span> and <span
class="math inline">\(b_{i j}^{(0)}\)</span> and <span
class="math inline">\(1_{i =j} c\)</span>. By definition, <span
class="math display">\[B^{(0)} = A^{-1} C,\]</span> where the
juxtaposition <span class="math inline">\(A^{-1} C\)</span> denotes
pointwise matrix multiplication, i.e., for each <span
class="math inline">\(\xi\)</span>, <span
class="math inline">\(B^{(0)}(\xi)\)</span> is the product of the
matrices <span class="math inline">\(A(\xi)^{-1}\)</span> and <span
class="math inline">\(C(\xi)\)</span>. We now set <span
class="math display">\[B^{(1)} := - A^{-1} (A \star^1 B^{(0)}),\]</span>
<span class="math display">\[B^{(2)} := -A^{-1} ( A \star^2 B^{(0)} + A
\star^1 B^{(1)}),\]</span> where, e.g., <span class="math inline">\(A
\star^1 B^{(0)}\)</span> is the matrix-valued symbol with <span
class="math inline">\((i,k)\)</span>th entry <span
class="math inline">\(\sum_j a_{i j} \star^1 b_{j k}^{(0)}\)</span>. By
<a href="#eq:aijdixj" data-reference-type="eqref"
data-reference="eq:aijdixj">\((17.8)\)</a> and <a
href="#eq:det-a_i-jxi_i" data-reference-type="eqref"
data-reference="eq:det-a_i-jxi_i">\((17.10)\)</a>, we have <span
class="math inline">\(b_{j k}^{(\ell)} \in
S^{-\infty}_0(\mathfrak{p}^\wedge)\)</span> for each fixed <span
class="math inline">\(\ell\)</span>.</p>
<p>We choose <span class="math inline">\(b_{jk} := \sum_{\ell \leqslant
L} {\mathop{\mathrm{h}}}^{\ell} b_{j k}^{(\ell)}\)</span> for some small
enough <span class="math inline">\(L \ggg 1\)</span>. By lemma <a
href="#lem:borel-summation" data-reference-type="ref"
data-reference="lem:borel-summation">222</a>, we then have <span
class="math inline">\(b_{j k} \in
S^{-\infty}_0(\mathfrak{p}^\wedge)\)</span> and <span
class="math display">\[\sum_j a_{i j} \star_{\mathop{\mathrm{h}}} b_{j
k}
  \equiv c \mod{{\mathop{\mathrm{h}}}^\infty
S^{-\infty}(\mathfrak{p}^\wedge)},\]</span> hence for each <span
class="math inline">\(v \in \mathcal{W}_\delta\)</span>, <span id="eqn:approx-invert-operators-aij-bjk" class="math display">\[\label{eqn:approx-invert-operators-aij-bjk}\tag{17.12}
  \sum_j \mathop{\mathrm{Op}}(a_{i j})
  \mathop{\mathrm{Op}}(b_{j k})
  v
  \equiv
  \mathop{\mathrm{Op}}(c) v
  \equiv v
  \mod{{\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta}.\]</span></p>
<p>Let <span class="math inline">\(v \in \mathcal{W}_\delta\)</span> and
<span class="math inline">\(k \in \{1, \dotsc, n-1\}\)</span>. To
understand <span class="math inline">\(\mathop{\mathrm{Op}}(e_{n k})
v\)</span>, we evaluate in two ways the double sum <span
class="math display">\[\Sigma :=
  \sum_{i}
  \sum_{j}
  \mathop{\mathrm{Op}}(e_{n i})
  \mathop{\mathrm{Op}}(a_{i j})
  \mathop{\mathrm{Op}}(b_{j k})
  v,\]</span> where here and henceforth indices run over <span
class="math inline">\(\{1, \dotsc, n-1\}\)</span>. By summing first over
<span class="math inline">\(i\)</span> and appealing to <a
href="#eqn:specialized-non-commutative-cofactor"
data-reference-type="eqref"
data-reference="eqn:specialized-non-commutative-cofactor">\((17.9)\)</a>,
we see that <span class="math display">\[\Sigma = \sum_j
\mathop{\mathrm{Op}}(f_j) \mathop{\mathrm{Op}}(b_{j k}) v,\]</span>
hence <span class="math inline">\(\Sigma \in
\mathcal{W}_\delta\)</span>. On the other hand, summing first over <span
class="math inline">\(j\)</span> and applying <a
href="#eqn:approx-invert-operators-aij-bjk" data-reference-type="eqref"
data-reference="eqn:approx-invert-operators-aij-bjk">\((17.12)\)</a>
yields <span class="math display">\[\Sigma -
  \mathop{\mathrm{Op}}(e_{n k})
  v
  \in
  \sum_{i} \mathop{\mathrm{Op}}(e_{n i})
  {\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta
  \subseteq {\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta,\]</span>
where in the final step we applied the <em>a priori</em> estimates given
by Proposition <a href="#prop:standard2:each-fixed-x"
data-reference-type="ref"
data-reference="prop:standard2:each-fixed-x">258</a>. Comparing these
two evaluations of <span class="math inline">\(\Sigma\)</span>, we
deduce that <span class="math inline">\(\mathop{\mathrm{Op}}(e_{n k}) v
\in \mathcal{W}_\delta\)</span>, and more precisely that <span
class="math display">\[\mathop{\mathrm{Op}}(e_{n k}) v \equiv \sum_{j}
\mathop{\mathrm{Op}}(f_j) \mathop{\mathrm{Op}}(b_{j k}) v
\mod{{\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta}.\]</span> Setting
<span class="math display">\[e_{n k}^{\mathfrak{p}} := \sum_{0 \leqslant
s &lt; S} {\mathop{\mathrm{h}}}^s \sum_j f_j \star^s b_{j k}\]</span> for
some small enough natural number <span class="math inline">\(S \ggg
1\)</span>, we deduce via Borel summation (Lemma <a
href="#lem:borel-summation" data-reference-type="ref"
data-reference="lem:borel-summation">222</a>) that <span
class="math inline">\(e_{n k} ^{\mathfrak{p}} \in
S^{-\infty}_0(\mathfrak{p}^\wedge)\)</span> and <span
class="math display">\[\mathop{\mathrm{Op}}(e_{n k}) v \equiv
\mathop{\mathrm{Op}}(e_{n k}^{\mathfrak{p}}) v
\pmod{{\mathop{\mathrm{h}}}^\infty \mathcal{W}_\delta},\]</span> as
desired.</p>
<p>By comparing with the corresponding “classical” calculation of §<a
href="#sec:comm-cofact-expans" data-reference-type="ref"
data-reference="sec:comm-cofact-expans">6.6</a>, we see that <span
class="math inline">\(e_{n i}^{\mathfrak{p}}(\theta) = e_{n i}(\tau) +
\operatorname{O}(\mathop{\mathrm{h}})\)</span>. Indeed, tracing through
the construction and working modulo <span
class="math inline">\(\operatorname{O}(h)\)</span>, we see that for
<span class="math inline">\(x \in \{x_1,\dotsc,x_{n-1}\}\)</span>, <span
class="math display">\[\sum _{i=1}^{n-1} e_{n i }^{\mathfrak{p}}(\theta)
\mathfrak{d}_i(x) = \mathcal{P}_{\mathop{\mathrm{h}}\lambda_\pi}(x) - (x
+ e_{n n}(\tau)) \mathfrak{d}_n(x) +
\operatorname{O}(\mathop{\mathrm{h}}).\]</span> The <span
class="math inline">\(e_{n i}(\tau)\)</span> satisfy the same linear
relation, so we conclude as in §<a href="#sec:comm-cofact-expans"
data-reference-type="ref"
data-reference="sec:comm-cofact-expans">6.6</a> by the invertibility of
the Vandermonde matrix.</p>
<p>The proof of Theorem <a href="#thm:g-via-p" data-reference-type="ref"
data-reference="thm:g-via-p">257</a>, hence that of Theorem <a
href="#thm:cal-W-delta-g-acts-localized" data-reference-type="ref"
data-reference="thm:cal-W-delta-g-acts-localized">256</a>, is now
complete.</p>
<h4 id="sec:control-over-norms">§17.9. Control over norms</h4>
<p>Let <span class="math inline">\(\mathcal{V} \subseteq
\pi^\infty\)</span>, as in Example <a
href="#example:class-V-wavelength-h" data-reference-type="ref"
data-reference="example:class-V-wavelength-h">231</a>, denote the class
consisting of all vectors <span class="math inline">\(v\)</span> for
which <span class="math inline">\(\|\pi(x_1 \dotsb x_m) v\| \ll
{\mathop{\mathrm{h}}}^{-m}\)</span> for all fixed <span
class="math inline">\(x_1,\dotsc,x_m \in \mathfrak{g}\)</span>.</p>
<div id="thm:control-over-norms" class="theorem">
<p><strong>Theorem 265</strong>. <em>We have <span
class="math display">\[\mathcal{W}_\delta \subseteq
{\mathop{\mathrm{h}}}^{-(1-\delta)\dim(B_H)/2}
\mathcal{V}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline">\(W \in
\mathcal{W}_\delta\)</span>. By Lemma <a
href="#lem:let-w-in-square-integral" data-reference-type="ref"
data-reference="lem:let-w-in-square-integral">149</a>, we have <span id="eq:int-_n_h-backslash-1" class="math display">\[\label{eq:int-_n_h-backslash-1}\tag{17.13}
    \int _{N_H \backslash H} |W|^2 \ll {\mathop{\mathrm{h}}}^{-(1-\delta)
\dim(B_H)}.\]</span> By Theorem <a
href="#thm:cal-W-delta-g-acts-localized" data-reference-type="ref"
data-reference="thm:cal-W-delta-g-acts-localized">256</a>, the required
bounds persist for derivatives. Indeed, our task is to check that for
fixed <span class="math inline">\(x_1,\dotsc,x_m \in
\mathfrak{g}\)</span>, we have <span id="eq:int-_n_h-backslash-2" class="math display">\[\label{eq:int-_n_h-backslash-2}\tag{17.14}
    \int  _{N_H \backslash H} \lvert
    \pi(x_1 \dotsb x_m) W
    \rvert^2
    \ll {\mathop{\mathrm{h}}}^{-2 m - (1 - \delta) \dim(B_H)}.\]</span>
Theorem <a href="#thm:cal-W-delta-g-acts-localized"
data-reference-type="ref"
data-reference="thm:cal-W-delta-g-acts-localized">256</a> implies in
particular (cf. Remark <a href="#rmk:r-=-0" data-reference-type="ref"
data-reference="rmk:r-=-0">227</a>) that the element <span
class="math inline">\({\mathop{\mathrm{h}}}^m \pi(x_1 \dotsb x_m)
W\)</span> lies in <span
class="math inline">\(\mathcal{W}_\delta\)</span>. Applying <a
href="#eq:int-_n_h-backslash-1" data-reference-type="eqref"
data-reference="eq:int-_n_h-backslash-1">\((17.13)\)</a>
to this element gives the required estimate <a
href="#eq:int-_n_h-backslash-2" data-reference-type="eqref"
data-reference="eq:int-_n_h-backslash-2">\((17.14)\)</a>. ◻</p>
</div>
<div id="cor:g-localization-inside-cal-V" class="corollary">
<p><strong>Corollary 266</strong>. <em>Let <span class="math inline">\(v
\in \mathcal{W}_\delta\)</span>. Then <span
class="math inline">\({\mathop{\mathrm{h}}}^{(1 - \delta) \dim(B_H)/2} v
\in \mathcal{V}\)</span> is <span
class="math inline">\((\mathfrak{g},\delta)\)</span>-localized at <span
class="math inline">\(\tau\)</span> inside <span
class="math inline">\(\mathcal{V}\)</span>.</em></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline">\(p \in
S^\infty_0(\mathfrak{g})\)</span> be a polynomial that vanishes to some
fixed order <span class="math inline">\(\geqslant r\)</span> at <span
class="math inline">\(\tau\)</span>. We know by Theorem <a
href="#thm:cal-W-delta-g-acts-localized" data-reference-type="ref"
data-reference="thm:cal-W-delta-g-acts-localized">256</a> that <span
class="math inline">\(v\)</span> is <span
class="math inline">\((\mathfrak{g},\delta)\)</span>-localized at <span
class="math inline">\(\tau\)</span> inside <span
class="math inline">\(\mathcal{W}_\delta\)</span>, hence <span
class="math inline">\(\mathop{\mathrm{Op}}(p) v \in
{\mathop{\mathrm{h}}}^{r \delta} \mathcal{W}_\delta\)</span>. By Theorem
<a href="#thm:control-over-norms" data-reference-type="ref"
data-reference="thm:control-over-norms">265</a>, we deduce that <span
class="math display">\[\mathop{\mathrm{Op}}(p)
{\mathop{\mathrm{h}}}^{(1-\delta) \dim(B_H)/2} v \in
{\mathop{\mathrm{h}}}^{r \delta} \mathcal{V},\]</span> as required. ◻</p>
</div>
<h4 id="sec:appr-idemp">§17.10. Approximate idempotents</h4>
<p>For convenience, we recap below some of the running assumptions from
before.</p>
<div id="thm:appr-idemp" class="theorem">
<p><strong>Theorem 267</strong>. <em>Let <span
class="math inline">\(\pi\)</span> be a generic irreducible unitary
representation of the fixed general linear group <span
class="math inline">\(G = {\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>.
Let <span class="math inline">\(\mathop{\mathrm{h}}\lll 1\)</span> be a
wavelength parameter with <span
class="math inline">\(\mathop{\mathrm{h}}\lambda_\pi \ll 1\)</span>. Let
<span class="math inline">\(\tau := \tau(\pi,\psi,T) \in
\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span> be as given by
Definition <a href="#defn:parameter-tau-pi-T" data-reference-type="ref"
data-reference="defn:parameter-tau-pi-T">142</a>. Fix <span
class="math inline">\(\delta, \delta &#39;, \delta &#39;&#39;\)</span>
with <span class="math inline">\(0 &lt; \delta &#39; &lt; \delta &lt;
1/2\)</span> and <span class="math inline">\(\delta &#39; &lt; \delta
&#39;&#39; &lt; 2 \delta &#39;\)</span>. Recall the subclasses <span
class="math inline">\(\mathcal{W}_\delta\)</span> and <span
class="math inline">\(\mathcal{V}\)</span> of <span
class="math inline">\(\pi^\infty\)</span> defined in §<a
href="#sec:quant-prel" data-reference-type="ref"
data-reference="sec:quant-prel">5.2</a> and §<a
href="#sec:control-over-norms" data-reference-type="ref"
data-reference="sec:control-over-norms">6.9</a>.</em></p>
<p><em>There exists <span class="math inline">\(a \in S^\tau_{\delta
&#39;, \delta &#39;&#39;}\)</span> with the following
properties.</em></p>
<ol type="i">
<li><p><em>Let <span class="math inline">\(\chi\)</span> be any <span
class="math inline">\((\tau,\delta &#39;,\delta
&#39;&#39;)\)</span>-admissible cutoff. Set <span
class="math inline">\(\mathop{\mathrm{Op}}(a) :=
{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi)\)</span>. Then, for
each <span class="math inline">\(v \in \mathcal{W}_\delta\)</span>, we
have <span id="eq:oppa-v-equiv" class="math display">\[\label{eq:oppa-v-equiv}\tag{17.15}
    \mathop{\mathrm{Op}}(a) v \equiv v \mod{{\mathop{\mathrm{h}}}^\infty
\mathcal{V}}.\]</span></em></p></li>
<li><p><em>With respect to <span
class="math inline">\(\tau\)</span>-coordinates as in §<a
href="#sec:refined-classes" data-reference-type="ref"
data-reference="sec:refined-classes">2.3.4</a>, we have <span id="eqn:a-desired-support-condition" class="math display">\[\label{eqn:a-desired-support-condition}\tag{17.16}
      \mathop{\mathrm{supp}}(a)
      \subseteq
      \left\{ \xi :
        |\xi &#39; - \tau &#39;| \ll {\mathop{\mathrm{h}}}^{\delta &#39;},
        |\xi &#39;&#39; - \tau &#39;&#39;| \ll
{\mathop{\mathrm{h}}}^{\delta &#39;&#39;}
      \right\}.\]</span></em></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> Choose <span class="math inline">\(c \in
S^{-\infty}_{\delta &#39;}(\mathfrak{g}^\wedge)\)</span> with <span
class="math inline">\(c(\xi) = 1\)</span> for <span
class="math inline">\(\xi = \tau +
o({\mathop{\mathrm{h}}}^{\delta&#39;})\)</span> and <span
class="math inline">\(c(\xi) \neq 0\)</span> only for <span
class="math inline">\(\xi = \tau +
\operatorname{O}({\mathop{\mathrm{h}}}^{\delta&#39;})\)</span>. By
Corollary <a href="#cor:g-localization-inside-cal-V"
data-reference-type="ref"
data-reference="cor:g-localization-inside-cal-V">266</a>, the vector
<span class="math inline">\({\mathop{\mathrm{h}}}^{(1 - \delta)
\dim(B_H)/2} v\)</span> is <span
class="math inline">\((\mathfrak{g},\delta)\)</span>-localized at <span
class="math inline">\(\tau\)</span> inside <span
class="math inline">\(\mathcal{V}\)</span>. By Theorem <a
href="#thm:S-infinity-modules-localized-stuff" data-reference-type="ref"
data-reference="thm:S-infinity-modules-localized-stuff">14.12</a>
(part <a href="#item:1-thm:S-infinity-modules-localized-stuff"
data-reference-type="eqref"
data-reference="item:1-thm:S-infinity-modules-localized-stuff">\((i)\)</a>)
applied to <span class="math inline">\(c-1\)</span>, we deduce that
<span class="math display">\[\mathop{\mathrm{Op}}(c) v \equiv v
\mod{{\mathop{\mathrm{h}}}^\infty \mathcal{V}}.\]</span> This is nearly
the desired conclusion, except that the support of <span
class="math inline">\(c\)</span> is not as required.</p>
<p>We observe that <span class="math inline">\(c\)</span> belongs to
<span class="math inline">\(S^{\tau}_{\delta &#39;, \delta
&#39;&#39;}\)</span>, since it is supported on elements <span
class="math inline">\(\xi\)</span> with <span class="math inline">\(\xi
- \tau \ll {\mathop{\mathrm{h}}}^{\delta &#39;} \lll
{\mathop{\mathrm{h}}}^{\delta &#39;&#39; - \delta &#39;}\)</span> and
satisfies stronger-than-required derivative bounds. Using <span
class="math inline">\(\tau\)</span>-coordinates <span
class="math inline">\(\xi = (\xi &#39;, \xi &#39;&#39;)\)</span>, we now
smoothly decompose <span class="math inline">\(c = a + b\)</span>, where
<span class="math inline">\(a,b \in S^{\tau}_{\delta &#39;, \delta
&#39;&#39;}\)</span> satisfy the support conditions <a
href="#eqn:a-desired-support-condition" data-reference-type="eqref"
data-reference="eqn:a-desired-support-condition">\((17.16)\)</a>
and <span class="math display">\[\mathop{\mathrm{supp}}(b) \subseteq
\left\{\xi : |\xi &#39; - \tau &#39;| \ll {\mathop{\mathrm{h}}}^{\delta
&#39;&#39;}, |\xi &#39;&#39; - \tau &#39;&#39;| \gg
{\mathop{\mathrm{h}}}^{ \delta &#39;&#39;} \right\}.\]</span> By Theorem
<a href="#thm:local-refin-symb" data-reference-type="ref"
data-reference="thm:local-refin-symb">236</a>, we then have <span
class="math display">\[\mathop{\mathrm{Op}}(b) \in
{\mathop{\mathrm{h}}}^\infty \Psi^{-\infty}.\]</span> By the easy
inclusion <span id="eq:hinfty-psi-infty" class="math display">\[\label{eq:hinfty-psi-infty}\tag{17.17}
    {\mathop{\mathrm{h}}}^\infty \Psi^{-\infty} \mathcal{V} \subseteq
{\mathop{\mathrm{h}}}^\infty \mathcal{V},\]</span> verified below for
completeness, we conclude as required that <a href="#eq:oppa-v-equiv"
data-reference-type="eqref"
data-reference="eq:oppa-v-equiv">\((17.15)\)</a> holds. ◻</p>
</div>
<div class="proof">
<p><em>Verification of <a href="#eq:hinfty-psi-infty"
data-reference-type="eqref"
data-reference="eq:hinfty-psi-infty">\((17.17)\)</a>.</em> Let
<span class="math inline">\(T \in {\mathop{\mathrm{h}}}^\infty
\Psi^{-\infty}\)</span> and <span class="math inline">\(v \in
\mathcal{V}\)</span>. We must check that <span class="math inline">\(T v
\in {\mathop{\mathrm{h}}}^\infty \mathcal{V}\)</span>, i.e., that</p>
<ul>
<li><p><span class="math inline">\(T v\)</span> lies in the space <span
class="math inline">\(\pi^\infty\)</span> of smooth vectors,
and</p></li>
<li><p>for each fixed <span class="math inline">\(N\)</span> and <span
class="math inline">\(x_1,\dotsc,x_m \in \mathfrak{g}\)</span>, we have
<span id="eq:pix_1-dotsb-x_m-1" class="math display">\[\label{eq:pix_1-dotsb-x_m-1}\tag{17.18}
    \|\pi(x_1 \dotsb x_m) T v \| \ll
{\mathop{\mathrm{h}}}^N.\]</span></p></li>
</ul>
<p>By the definition of <span
class="math inline">\({\mathop{\mathrm{h}}}^\infty \Psi^{-\infty}\)</span>
(§<a href="#sec:negligible-operators" data-reference-type="ref"
data-reference="sec:negligible-operators">2.6.2</a>), we have <span
class="math inline">\(T \in \underline{\Psi }^{\infty}\)</span> and
<span class="math inline">\(T \in {\mathop{\mathrm{h}}}^N
\Psi^{-\infty}\)</span>. Recalling from Lemma <a
href="#lem:foll-incl-hold" data-reference-type="ref"
data-reference="lem:foll-incl-hold">213</a> that <span
class="math inline">\(\underline{\Psi }^{\infty} \pi^\infty \subseteq
\pi^\infty\)</span>, we deduce that <span class="math inline">\(T v \in
\pi^\infty\)</span>. By the definition of <span
class="math inline">\(\Psi^{-\infty}\)</span>, the operator norm of
<span class="math inline">\(\pi(x_1 \dotsb x_m) T\)</span> is then <span
class="math inline">\(\operatorname{O}({\mathop{\mathrm{h}}}^N)\)</span>.
Since <span class="math inline">\(v \in \mathcal{V}\)</span>, we have in
particular <span class="math inline">\(\|v\| \ll 1\)</span>. The
required estimate <a href="#eq:pix_1-dotsb-x_m-1"
data-reference-type="eqref"
data-reference="eq:pix_1-dotsb-x_m-1">\((17.18)\)</a>
follows. ◻</p>
</div>
<h4 id="sec:proof-theor-refthm:b">§17.11. Proof of Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a></h4>
<p>Suppose given <span class="math inline">\(T\)</span>, <span
class="math inline">\(\pi\)</span>, <span
class="math inline">\(\varepsilon\)</span> and <span
class="math inline">\(\delta\)</span> as in the hypotheses of that
theorem. Then <span class="math inline">\(\mathop{\mathrm{h}}:= 1/T \lll
1\)</span> and <span
class="math inline">\(\mathop{\mathrm{h}}\lambda_\pi =
\operatorname{O}(1)\)</span>. Let <span class="math inline">\(\tau :=
\tau(\pi,\psi,T) \in
\mathfrak{g}^\wedge_{\mathop{\mathrm{reg}}}\)</span> as in Definition <a
href="#defn:parameter-tau-pi-T" data-reference-type="ref"
data-reference="defn:parameter-tau-pi-T">142</a>, as usual.</p>
<p>Fix <span class="math inline">\(\delta &#39;, \delta
&#39;&#39;\)</span> as in the hypotheses of Theorem <a
href="#thm:appr-idemp" data-reference-type="ref"
data-reference="thm:appr-idemp">267</a>, with <span
class="math inline">\((\delta &#39;, \delta &#39;&#39;)\)</span>
sufficiently close to <span class="math inline">\((\delta , 2
\delta)\)</span>; recalling that <span
class="math inline">\(\delta\)</span> is chosen sufficiently close to
<span class="math inline">\(1/2\)</span> relative to <span
class="math inline">\(\varepsilon\)</span>, it follows that <span
class="math inline">\((\delta &#39;, \delta &#39;&#39;)\)</span> is
close to <span class="math inline">\((1/2,1)\)</span> relative to <span
class="math inline">\(\varepsilon\)</span>. Let <span
class="math inline">\(a \in S^{\tau}_{\delta &#39;, \delta
&#39;&#39;}\)</span> be as furnished by the conclusion of that theorem.
Fix <span class="math inline">\(\delta_+&#39; \in (\delta &#39;,
1/2)\)</span> and <span class="math inline">\(\delta_+&#39;&#39; \in
(\delta &#39;&#39;, 1)\)</span>. Let <span class="math inline">\(\chi
\in \mathcal{X}_{\tau, \delta _+&#39;,
\delta_+&#39;&#39;}(\mathfrak{g})\)</span>. Define <span
class="math display">\[\omega_0 :=
\widetilde{\mathop{\mathrm{Op}}}_{\mathop{\mathrm{h}}}(a:\chi),\]</span>
a smooth compactly-supported measure on <span
class="math inline">\(G\)</span>; we identify it with a smooth
compactly-supported function on <span class="math inline">\(G\)</span>
by dividing by our fixed Haar measure.</p>
<p>Recalling the statement of Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>, we
must verify the following assertions concerning <span
class="math inline">\(\omega = \omega_0 \ast \omega_0^*\)</span> and
<span class="math inline">\(\omega ^\sharp = \int _{z \in Z} \pi|_Z (z)
\omega(z g) \, d z\)</span>:</p>
<ol type="i">
<li><p><span id="item:kirillov-final-verify-1"
label="item:kirillov-final-verify-1"></span> <span
class="math inline">\(\omega(g) \neq 0\)</span> only if <span
class="math inline">\(g = 1 + o(1)\)</span> and <span
class="math inline">\({\mathop{\mathrm{Ad}}}^*(g) \tau = \tau +
o(T^{-1/2})\)</span>.</p></li>
<li><p><span id="item:kirillov-final-verify-2"
label="item:kirillov-final-verify-2"></span> <span
class="math inline">\(\|\omega^\sharp\|_{\infty} \ll
T^{n(n+1)/2+\varepsilon}\)</span>.</p></li>
<li><p><span id="item:kirillov-final-verify-3"
label="item:kirillov-final-verify-3"></span> If <span
class="math inline">\(\tau\)</span> lies in some fixed compact subset of
<span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}\)</span>,
then <span class="math inline">\(\int_H |\omega^\sharp| \ll T^{n/2 +
\varepsilon}\)</span>.</p></li>
<li><p><span id="item:kirillov-final-verify-4"
label="item:kirillov-final-verify-4"></span> For each <span
class="math inline">\(W \in \mathcal{W}_\delta =
\mathfrak{W}(\pi,\psi,T,\delta)\)</span> and fixed <span
class="math inline">\(x \in \mathfrak{U}(\mathfrak{g})\)</span>, we have
<span class="math inline">\(\|\pi(x) (\pi(\omega_0)W - W)\| \ll
T^{-\infty}\)</span>.</p></li>
</ol>
<p>We have <span class="math inline">\(\mathop{\mathrm{Op}}(a) =
\pi(\omega_0)\)</span>, so assertion <a
href="#item:kirillov-final-verify-4" data-reference-type="eqref"
data-reference="item:kirillov-final-verify-4">\((iv)\)</a>
is immediate from the conclusion <span
class="math inline">\(\mathop{\mathrm{Op}}(a) W \equiv W
\pmod{{\mathop{\mathrm{h}}}^\infty \mathcal{V}}\)</span> of Theorem <a
href="#thm:appr-idemp" data-reference-type="ref"
data-reference="thm:appr-idemp">267</a> and the definition of the class
<span class="math inline">\(\mathcal{V}\)</span>. The remaining
assertions may be verified exactly as in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 14.9)</a>
(noting that our <span class="math inline">\(\chi \in \mathcal{X}_{\tau,
\delta _+&#39;, \delta_+&#39;&#39;}(\mathfrak{g})\)</span> plays the
role of the modified cutoff “<span
class="math inline">\(\tilde{\chi}\)</span>” in the cited
reference):</p>
<ul>
<li><p>Assertion <a href="#item:kirillov-final-verify-1"
data-reference-type="eqref"
data-reference="item:kirillov-final-verify-1">\((i)\)</a>
is given by <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P.
D. Nelson 2023, (14.13))</a>.</p></li>
<li><p>Assertion <a href="#item:kirillov-final-verify-2"
data-reference-type="eqref"
data-reference="item:kirillov-final-verify-2">\((ii)\)</a>
is given by <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(P.
D. Nelson 2023, (14.14))</a>.</p></li>
<li><p>Assertion <a href="#item:kirillov-final-verify-3"
data-reference-type="eqref"
data-reference="item:kirillov-final-verify-3">\((iii)\)</a>
is established in the final paragraph of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(P. D. Nelson 2023, sec. 14.9)</a>,
using that the natural map <span
class="math inline">\(\mathfrak{g}^\wedge_{\mathop{\mathrm{stab}}}
\rightarrow [\mathfrak{g}^\wedge] \times [\mathfrak{h}^\wedge]\)</span>
defines a principal <span class="math inline">\(H\)</span>-bundle over
its image.</p></li>
</ul>
<h1 id="part:local-l2-growth">§4. Growth bounds for Eisenstein series</h1>
<p>The aim of Part <a href="#part:local-l2-growth"
data-reference-type="ref" data-reference="part:local-l2-growth"></a> is
to prove Theorem <a href="#thm:growth-eisenstein-nonstandard"
data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>. Throughout
this section, <span class="math inline">\(G\)</span> denotes a general
linear group over either <span
class="math inline">\(\mathbb{Z}\)</span>, <span
class="math inline">\(\mathbb{R}\)</span>, or a non-archimedean local
field. Recall from §<a href="#sec:gener-prel" data-reference-type="ref"
data-reference="sec:gener-prel">2.3</a> the standard accompanying
notation: <span class="math inline">\(B = A N\)</span> denotes the
standard upper-triangular Borel subgroup of <span
class="math inline">\(G\)</span>, while <span class="math inline">\(Q =
A U\)</span> denotes another Borel subgroup that contains the diagonal
subgroup <span class="math inline">\(A\)</span>, but is otherwise free
for us to choose according to computational convenience. For the
purposes of this section, it is most convenient to take <span
class="math inline">\(U := N\)</span>, so that <span
class="math inline">\(Q = B\)</span>. We accordingly write simply <span
class="math inline">\(\Delta\)</span>, <span
class="math inline">\(\rho\)</span> and <span
class="math inline">\(\rho^\vee\)</span> for <span
class="math inline">\(\Delta_N, \rho_N\)</span> and <span
class="math inline">\(\rho_N^\vee\)</span>. The meaning of “dominant” is
likewise unambiguous now. Recall also that <span
class="math inline">\(W\)</span> (or <span
class="math inline">\(W_G\)</span>, to emphasize <span
class="math inline">\(G\)</span>) denotes the Weyl group for <span
class="math inline">\((G,A)\)</span>. Also, in the local case, <span
class="math inline">\(K\)</span> denotes the standard maximal compact
subgroup of <span class="math inline">\(G\)</span>, while in the global
case, <span class="math inline">\(K = \prod_\mathfrak{p}
K_\mathfrak{p}\)</span> is the standard maximal compact subgroup of
<span class="math inline">\(G(\mathbb{A})\)</span>.</p>
<p>We employ the abbreviation <span class="math display">\[\left\langle
s \right\rangle := 1 + |s|\]</span> for <span class="math inline">\(s
\in \mathfrak{a}_{\mathbb{C}}^*\)</span>.</p>
<p>The organization is as follows.</p>
<ul>
<li><p>Recall that Theorem <a href="#thm:growth-eisenstein-nonstandard"
data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a> provides
nontrivial estimates for the local <span
class="math inline">\(L^2\)</span>-norms of Eisenstein series on <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span>. There are two
sources of complication here: that we are working in higher rank, and
that we are working with Eisenstein series. In §<a
href="#sec:simpler-variants" data-reference-type="ref"
data-reference="sec:simpler-variants">1</a>, we illustrate the proof
scheme by applying it to simpler examples – cusp forms on <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span>, Eisenstein series
on <span class="math inline">\({\mathop{\mathrm{GL}}}_2\)</span> –
obtained by “turning off” either of these difficulties. The general
proof is not quite a combination of the proofs of these special cases,
but the latter do illustrate several key features of the
former.</p></li>
<li><p>In §<a href="#sec:rank-selb-unfold" data-reference-type="ref"
data-reference="sec:rank-selb-unfold">2</a>, we unfold the integrals
<span class="math inline">\(\int_{[{\mathop{\mathrm{GL}}}_n]} |\varphi|^2
\theta\)</span>, where <span class="math inline">\(\varphi\)</span>
(resp. <span class="math inline">\(\theta\)</span>) is a pseudo
Eisenstein series attached to a minimal parabolic (resp. mirabolic)
subgroup.</p></li>
<li><p>In §<a href="#sec:reduction-proof" data-reference-type="ref"
data-reference="sec:reduction-proof">3</a>, we develop the crucial
global arguments that reduce the proof of Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a> to some
technical problems. These arguments include the construction of a
mirabolic pseudo Eisenstein series <span
class="math inline">\(\theta\)</span> taking large values in a given
region in <span class="math inline">\([{\mathop{\mathrm{GL}}}_n]\)</span>,
a crucial “duality trick,” and several alternative series
representations of our minimal pseudo Eisenstein series carefully
tailored to its estimation. The resulting technical problems are then
treated in §<a href="#sec:local-estimates" data-reference-type="ref"
data-reference="sec:local-estimates">4</a> (local) and §<a
href="#sec:completion-proof-1" data-reference-type="ref"
data-reference="sec:completion-proof-1">5</a> (global).</p></li>
</ul>
<h3 id="sec:simpler-variants">§18. Simpler variants</h3>
<p>As noted above, the purpose of this section is to illustrate the
basic proof scheme of Part <a href="#part:local-l2-growth"
data-reference-type="ref" data-reference="part:local-l2-growth"></a> by
application to some simpler variants of the main problem. This section
is not necessary for the logical purposes of the paper, but may serve as
a useful guide to the arguments that follow.</p>
<h4 id="sec:simpler-cusp-forms-gl_n">§18.1. Cusp forms on <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span></h4>
<p>We refer here to <a href="#ref-MR3468028" class="citation"
data-cites="MR3468028">(Goldfeld 2015)</a> for general background.
Let <span class="math inline">\(\Psi \in
L^2({\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R}))\)</span> be a Hecke–Maass cusp form,
i.e., a spherical vector in an everywhere-unramified cuspidal
automorphic representation of <span
class="math inline">\({\mathop{\mathrm{PGL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Q}\)</span>, viewed classically. Its
Fourier expansion has the shape <span class="math display">\[\Psi(g) =
\sum _{m}
  \frac{\lambda (m)}{\delta_{N_n}^{1/2}(m)}
  \sum _{\gamma \in N_n(\mathbb{Z}) \backslash P_n(\mathbb{Z})}
  W(m \gamma g),\]</span> where <span class="math inline">\(P_n
\leqslant{\mathop{\mathrm{GL}}}_n\)</span> denotes the mirabolic subgroup
consisting of matrices with representatives having bottom row of the
form <span class="math inline">\((0,\dotsc,0,1)\)</span>, <span
class="math inline">\(N_n \leqslant P_n\)</span> denotes the subgroup of
upper-triangular unipotent matrices, <span
class="math inline">\(m\)</span> runs over diagonal matrices of the form
<span class="math display">\[m =
  \begin{pmatrix}
    m_1 \dotsb m_{n-1} &amp; 0 &amp; 0 &amp; 0 \\
    0 &amp; m_2 \dotsb m_{n-1} &amp; 0 &amp; 0 \\
    0 &amp; 0 &amp; \ddots &amp; 0 \\
    0 &amp; 0 &amp; 0 &amp; 1
  \end{pmatrix},
  \quad
  m_1, \dotsc, m_{n-1} \in \mathbb{Z}_{\geqslant 1},\]</span> <span
class="math inline">\(\delta_{N_n}\)</span> is the modulus character for
the upper-triangular Borel, and <span
class="math inline">\(\lambda\)</span> denotes the normalized Hecke
eigenvalue. Set <span class="math display">\[\|\Psi \|^2 := \int
_{{\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})} |\Psi|^2,
  \quad
  \|W\|^2 := \int _{N_{n-1}(\mathbb{R}) \backslash
{\mathop{\mathrm{GL}}}_{n-1}(\mathbb{R})} |W|^2.\]</span> Let us assume
that each archimedean parameter of <span
class="math inline">\(\pi\)</span> has size <span
class="math inline">\(\ll T\)</span>. We say that <span
class="math inline">\(\Psi\)</span> is <em>Whittaker <span
class="math inline">\(L^2\)</span>-normalized</em> if <span
class="math inline">\(\|W\|^2 = 1\)</span>. In that case, we know (Lemma
<a href="#lem:nonstandard-norm-whittaker" data-reference-type="ref"
data-reference="lem:nonstandard-norm-whittaker">39</a>) that <span id="eq:psi-2-ll" class="math display">\[\label{eq:psi-2-ll}\tag{18.1}
\|\Psi \|^2 \ll T^{o(1)}.\]</span></p>
<p>Let <span class="math inline">\(\Omega\)</span> be a fixed compact
subset of <span
class="math inline">\({\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span>. Let
<span class="math inline">\(A_n
\leqslant{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> denote the subgroup
of diagonal matrices, and let <span class="math inline">\(t =
\mathop{\mathrm{diag}}(t_1,\dotsc,t_n)\)</span> be a dominant element of
<span class="math inline">\(A_n \cap
{\mathop{\mathrm{SL}}}_n(\mathbb{R})\)</span> with positive entries, i.e.,
<span class="math display">\[t_1 \geqslant\dotsb \geqslant t_n &gt;
0.\]</span> We set <span class="math display">\[\|\Psi \|_t^2 := \int
_{g \in \Omega } |\Psi|^2(t g) \, d g.\]</span> By a simple argument
with Siegel domains (Proposition <a href="#prop:siegel-lower"
data-reference-type="ref" data-reference="prop:siegel-lower">35</a>), we
obtain the “trivial” bound <span id="eq:psi-_r2-ll-2" class="math display">\[\label{eq:psi-_r2-ll-2}\tag{18.2}
  \|\Psi \|_t^2 \ll \delta_{N_n}(t) \|\Psi \|^2.\]</span> We improve
upon this in the following cuspidal analogue of Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>.</p>
<div id="thm:sub-gln:let-psi-be" class="theorem">
<p><strong>Theorem 268</strong>. <em>Let <span
class="math inline">\(\Psi\)</span> be as above and Whittaker <span
class="math inline">\(L^2\)</span>-normalized. Let <span
class="math inline">\(t\)</span> be as above. Then <span id="eq:psi-_r2-ll-1" class="math display">\[\label{eq:psi-_r2-ll-1}\tag{18.3}
    \|\Psi \|_t^2 \ll \min(t_1^{-1}, t_n)^n \delta_{N_n}(t)
T^{o(1)}.\]</span></em></p>
</div>
<div class="remark">
<p><strong>Remark 269</strong>. We note that, since <span
class="math inline">\(t_1 \geqslant\dotsb \geqslant t_n\)</span>, we
have <span class="math inline">\(\min(t_1^{-1}, t_n) \leqslant
1\)</span>, and so <a href="#eq:psi-_r2-ll-1"
data-reference-type="eqref"
data-reference="eq:psi-_r2-ll-1">\((18.3)\)</a> actually does
improve upon the “trivial” bound of <span class="math inline">\(\ll
\delta_{N_n}(t) T^{o(1)}\)</span> provided that <span
class="math inline">\(t\)</span> is not too close to the identity.</p>
</div>
<div class="remark">
<p><strong>Remark 270</strong>. We have referred to the above as a
cuspidal analogue of Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>, but the
results are not quite analogous: Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a> concerns high
frequency wave packets concentrated on representations of essentially
bounded parameter, while in Theorem <a href="#thm:sub-gln:let-psi-be"
data-reference-type="ref"
data-reference="thm:sub-gln:let-psi-be">268</a>, the parameters of the
representations vary considerably. However, our arguments are
insensitive to such differences. We work here with a spherical vector to
keep the presentation familiar and simple.</p>
</div>
<p>Let us warm-up by considering the simplest case:</p>
<div id="example:growth-bound-sl2-cusp" class="example">
<p><strong>Example 271</strong>. Suppose for the moment that <span
class="math inline">\(n = 2\)</span>, so that <span
class="math inline">\(\Psi\)</span> corresponds to a classical Maass
form on the modular surface <span
class="math inline">\({\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
\mathbb{H}\)</span>. Writing <span class="math inline">\(t =
\mathop{\mathrm{diag}}(t_1, t_1^{-1})\)</span>, we have <span
class="math inline">\(\delta_{N_n}(t) = t_1^2\)</span>, so the content
of the estimate is that, for <span class="math inline">\(t_1 \geqslant
1\)</span>, <span id="eq:int-_x-in" class="math display">\[\label{eq:int-_x-in}\tag{18.4}
    \int _{x \in \mathbb{R} / \mathbb{Z} }
    \int _{y = t_1/2}^{2 t_1}
    |\Psi(x + i y)|^2 \, \frac{d x \, d y}{y}
    \ll T^{o(1)}.\]</span> This improves upon the “trivial bound” of
<span class="math inline">\(\ll t_1 T^{o(1)}\)</span> for the same
integral that follows from the <span
class="math inline">\(L^2\)</span>-normalization, i.e., <span
class="math display">\[\int _{x \in \mathbb{R} / \mathbb{Z} }
    \int _{y \geqslant 1/2}
    |\Psi(x + i y)|^2 \, \frac{d x \, d y}{y^2}
    \ll T^{o(1)}.\]</span> The proof of <a href="#eq:int-_x-in"
data-reference-type="eqref"
data-reference="eq:int-_x-in">\((18.4)\)</a> is an easy exercise, as
we now explain. For simplicity, let us redefine <span
class="math inline">\(\|\Psi \|_t^2\)</span> to be the LHS of <a
href="#eq:int-_x-in" data-reference-type="eqref"
data-reference="eq:int-_x-in">\((18.4)\)</a>. Inserting the Fourier
expansion and applying the Parseval relation gives <span
class="math display">\[\|\Psi \|_t^2
     =
    \sum _{0 \neq m \in \mathbb{Z} }
    \frac{|\lambda(m)|^2}{|m|}
    \int _{y = t_1/2}^{2 t_1} |W(m y)|^2 \, d^\times y.\]</span> Let
<span class="math inline">\(S \geqslant 2\)</span> be a parameter. By
applying the trivial estimate <span
class="math display">\[\int_{y=t_1/2}^{2 t_1} |W(m y)|^2 \, d^\times y
\leqslant\int_{\mathbb{R}^\times} |W|^2 = 1\]</span> when <span
class="math inline">\(|m| \leqslant S\)</span>, we obtain the
majorization <span class="math inline">\(\|\Psi \|_t^2 \leqslant\Sigma_1
+ \Sigma_2\)</span>, where <span class="math display">\[\Sigma_1
:=  \sum _{0 \neq |m| \leqslant S}
  \frac{|\lambda(m)|^2}{|m|},
  \quad
  \Sigma_2 :=
    \sum _{|m| &gt; S}
  \frac{|\lambda(m)|^2}{|m|}
  \int _{y = r}^{2 r} |W(m y)|^2 \, d^\times y.\]</span> Rankin–Selberg
theory (and the estimates of Iwaniec <a href="#ref-MR1067982" class="citation"
data-cites="MR1067982">(Iwaniec 1990)</a>) gives <span
class="math inline">\(\Sigma_1 \ll T^{o(1)} \log(S)\)</span>. This
estimate remains acceptable even if we take, say, <span
class="math inline">\(S = T^{1000}\)</span>. In that case, the rapid
decay of the Whittaker function <span class="math inline">\(W\)</span>
at arguments larger than <span
class="math inline">\(T^{1+\varepsilon}\)</span> implies that <span
class="math inline">\(\Sigma_2 \ll T^{-100}\)</span>, say. The required
estimate follows.</p>
</div>
<p>We now turn to the general case:</p>
<div class="proof">
<p><em>Proof of Theorem <a href="#thm:sub-gln:let-psi-be"
data-reference-type="ref"
data-reference="thm:sub-gln:let-psi-be">268</a>.</em> We begin with a
key observation: it suffices to prove the apparently weaker bound <span id="eq:psi-_r2-ll-3" class="math display">\[\label{eq:psi-_r2-ll-3}\tag{18.5}
    \|\Psi \|_t^2 \ll t_n^n \delta_{N_n}(t) T^{o(1)}.\]</span> To obtain
this reduction, we observe that the dual form <span
class="math display">\[\tilde{\Psi}(g) := \Psi(g^{-%
  {\mathpalette\@transpose{}}%
}),\]</span> obtained from <span class="math inline">\(\Psi\)</span> by
applying the outer automorphism of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> defined by taking
the inverse transpose, satisfies the same hypotheses as <span
class="math inline">\(\Psi\)</span>. On the other hand, writing <span
class="math inline">\(w \in {\mathop{\mathrm{SL}}}_n(\mathbb{Z})\)</span>
for a long Weyl element, we have <span class="math display">\[w t^{-%
  {\mathpalette\@transpose{}}%
} w = \mathop{\mathrm{diag}}(t_n^{-1}, \dotsc, t_1^{-1}).\]</span> By
enlarging <span class="math inline">\(\Omega\)</span> suitably, we may
and shall assume that it is invariant under left multiplication by <span
class="math inline">\(w\)</span> and also under <span
class="math inline">\(g \mapsto g^{-%
  {\mathpalette\@transpose{}}%
}\)</span>. Then <span class="math display">\[\|{\tilde{\Psi}}\|_{w
t^{-%
  {\mathpalette\@transpose{}}%
} w}^2
    =
    \int _{g \in \Omega }
    |{\tilde{\Psi}}|^2(w t^{-%
  {\mathpalette\@transpose{}}%
} w g)
    \, d g
    =
    \int _{g \in \Omega }
    |{\Psi}|^2(t (w g)^{-%
  {\mathpalette\@transpose{}}%
})
    \, d g
    =
    \|{\Psi}\|_{t}^2,\]</span> so if <a href="#eq:psi-_r2-ll-3"
data-reference-type="eqref"
data-reference="eq:psi-_r2-ll-3">\((18.5)\)</a> holds for <span
class="math inline">\(\tilde{\Psi}\)</span>, then <span
class="math display">\[\|\Psi \|_t^2 \ll
    ( w t^{-%
  {\mathpalette\@transpose{}}%
} w)_n^n \delta_{N_n}(w t^{-%
  {\mathpalette\@transpose{}}%
} w) T^{o(1)}
    =
    t_1^{-n} \delta_{N_n}(t) T^{o(1)}.\]</span> Thus if we can prove
that <a href="#eq:psi-_r2-ll-3" data-reference-type="eqref"
data-reference="eq:psi-_r2-ll-3">\((18.5)\)</a> holds for both
<span class="math inline">\(\Psi\)</span> and <span
class="math inline">\(\tilde{\Psi}\)</span>, then <a
href="#eq:psi-_r2-ll-1" data-reference-type="eqref"
data-reference="eq:psi-_r2-ll-1">\((18.3)\)</a> will follow.</p>
<p>In verifying <a href="#eq:psi-_r2-ll-3" data-reference-type="eqref"
data-reference="eq:psi-_r2-ll-3">\((18.5)\)</a>, we may and shall
assume that <span class="math inline">\(t_n=
T^{\operatorname{O}(1)}\)</span>, as otherwise the required estimates
follow (in stronger form) from standard Sobolev-type bounds as in <a href="#ref-michel-2009"
class="citation" data-cites="michel-2009">(Philippe Michel and Venkatesh
2010, sec. 2)</a>.</p>
<p>Our strategy is to construct a mirabolic pseudo Eisenstein series
which</p>
<ul>
<li><p>takes a reasonably large value in a neighborhood of <span
class="math inline">\(t\)</span>, and yet</p></li>
<li><p>whose integral against <span
class="math inline">\(|\Psi|^2\)</span> is not too large.</p></li>
</ul>
<p>To that end, we fix <span class="math inline">\(C_0 \geqslant
2\)</span> large enough in terms of <span
class="math inline">\(\Omega\)</span> and construct an even Schwartz
function <span class="math inline">\(\phi\)</span> on <span
class="math inline">\(\mathbb{R}^n\)</span> with the following
properties:</p>
<ol type="i">
<li><p><span class="math inline">\(\phi\)</span> is spherical, i.e.,
<span class="math inline">\(\phi(v)\)</span> depends only upon the
Euclidean norm <span class="math inline">\(\|v\|\)</span>.</p></li>
<li><p><span class="math inline">\(0 \leqslant\phi \leqslant
1\)</span>.</p></li>
<li><p><span class="math inline">\(\phi(v) = 1\)</span> if <span
class="math inline">\(\|v\| / t_n \in (1/C_0, C_0)\)</span>.</p></li>
<li><p><span class="math inline">\(\phi(v) = 0\)</span> if <span
class="math inline">\(\|v\| / t_n \notin (1/2 C_0, 2
C_0)\)</span>.</p></li>
</ol>
<p>In particular, writing <span class="math inline">\(e_n =
(0,\dotsc,0,1)\)</span> for the standard basis vector, <span
class="math display">\[\phi(t_n e_n) = 1.\]</span> We define <span
class="math display">\[\theta_\phi(g) = \sum_{\gamma \in P_n(\mathbb{Z})
\backslash {\mathop{\mathrm{GL}}}_n(\mathbb{Z})} \phi(e_n \gamma g)
  =
  \sum_{\gamma \in P_n(\mathbb{Z}) \cap
{\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{Z})} \phi(e_n \gamma g).\]</span>
Equivalently, <span class="math display">\[\theta_\phi(g) =
\sideset{}{^*}\sum _{v \in \mathbb{Z}^n}\phi(v g),\]</span> where <span
class="math inline">\(\sum^*\)</span> indicates that the sum is
restricted to primitive vectors. Clearly <span
class="math display">\[\theta_\phi(t) \geqslant\phi(e_n t) = \phi(t_n
e_n) = 1.\]</span> Since <span class="math inline">\(C_0\)</span> was
chosen large enough in terms of <span
class="math inline">\(\Omega\)</span>, we have in fact <span
class="math inline">\(\theta_\phi(t g) \geqslant 1\)</span> for all
<span class="math inline">\(g \in \Omega\)</span>. Taking into account
the formula for Haar measure on a Siegel domain (Proposition <a
href="#prop:siegel-lower" data-reference-type="ref"
data-reference="prop:siegel-lower">35</a>), we deduce that <span
class="math display">\[\frac{\|\Psi \|_t^2 }{\delta_{N_n}(t)} \ll
  \int _{{\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})} \theta_\phi |\Psi|^2.\]</span> Our
task thereby reduces to verifying that <span id="eq:int_sl_nm-backsl-sl" class="math display">\[\label{eq:int_sl_nm-backsl-sl}\tag{18.7}
  \int_{{\mathop{\mathrm{SL}}}_n(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})} \theta_\phi |\Psi|^2 \ll t_n^n
T^{o(1)}.\]</span> A standard unfolding calculation shows that the LHS
of <a href="#eq:int_sl_nm-backsl-sl" data-reference-type="eqref"
data-reference="eq:int_sl_nm-backsl-sl">\((18.7)\)</a> is
a constant multiple of <span id="eq:sum-_m-fracl" class="math display">\[\label{eq:sum-_m-fracl}\tag{18.8}
    \sum _{m}
    \frac{|\lambda(m)|^2}{\delta_{N_n}(m)}
    \int _{g \in N_n(\mathbb{R}) \backslash
{\mathop{\mathrm{SL}}}_n(\mathbb{R})} \phi(e_n g)
    |W|^2(m  g) \, d g.\]</span> We may explicate this last integral
using the Iwasawa decomposition: writing <span
class="math inline">\(A_{n-1}\)</span> for the diagonal subgroup of
<span
class="math inline">\({\mathop{\mathrm{GL}}}_{n-1}(\mathbb{R})\)</span>
(included in <span
class="math inline">\({\mathop{\mathrm{GL}}}_{n}(\mathbb{R})\)</span> as
the upper-left <span class="math inline">\((n-1) \times (n-1)\)</span>
block), and with suitable measure normalization, we obtain <span
class="math display">\[\int _{a \in A_{n-1}}
  \phi(e_n \det(a)^{-1})
  |W|^2(m a) \, \frac{d a }{ \delta_{N_n}(a)}.\]</span> Using the
identity <span class="math display">\[|\det a|^{-n} \delta_{N_n}(a) =
\delta_{N_{n-1}}(a),\]</span> we may rewrite this last integral as <span
class="math display">\[\int _{a \in A_{n-1}}
  |\det a|^{-n}
  \phi(e_n \det(a)^{-1})
  |W|^2(m a) \, \frac{d a }{ \delta_{N_{n-1}}(a)}.\]</span> On the
support of <span class="math inline">\(\phi (e_n \det(a)^{-1})\)</span>,
we have <span class="math inline">\(\det(a) \asymp t_n^{-1}\)</span>,
and so the above integral is majorized by <span
class="math display">\[t_n^{n} \int _{a \in A_{n-1}} |W|^2(m a) \,
\frac{d a }{ \delta_{N_{n-1}}(a) }.\]</span> We now substitute <span
class="math inline">\(a \mapsto m^{-1} a\)</span>, which introduces the
factor <span class="math inline">\(\delta_{N_{n-1}}(m)\)</span>. We have
<span class="math display">\[\frac{\delta_{N_{n-1}}(m)}{\delta_{N_n}(m)}
  = \frac{1}{\det m}.\]</span> The remaining integral <span
class="math display">\[\int _{a \in A_{n-1}} |W|^2(a) \, \frac{d
a}{\delta_{N_{n-1}}(a)}\]</span> is <span class="math inline">\(\asymp
1\)</span> thanks to the Whittaker <span
class="math inline">\(L^2\)</span>-normalization of <span
class="math inline">\(\Psi\)</span>. We thereby obtain the bound <span
class="math display">\[\int  _{{\mathop{\mathrm{SL}}}_n(\mathbb{Z})
\backslash {\mathop{\mathrm{SL}}}_n(\mathbb{R})}
  \theta_\phi |\Psi|^2
  \ll
  t_n^{n}
  \sum _{m}
  \frac{|\lambda(m)|^2}{ \det m }.\]</span> Since <span
class="math inline">\(\det m = m_1 m_2^2 m_3^3 \dotsb\)</span> and <span
class="math inline">\(\sum_{m_1 \in \mathbb{Z}_{\geqslant 1}} 1/m_1 =
\infty\)</span>, the RHS of this estimate diverges, but only
logarithmically; by truncating the <span
class="math inline">\(m\)</span>-sum as in Lemma <a
href="#example:growth-bound-sl2-cusp" data-reference-type="ref"
data-reference="example:growth-bound-sl2-cusp">271</a> and using <a href="#ref-MR4093914"
class="citation" data-cites="MR4093914">(Blomer, Harcos, and Maga 2020,
Thm 2)</a> to estimate the Whittaker functions, we obtain an
acceptable estimate. ◻</p>
</div>
<h4 id="eisenstein-series-on-mathopmathrmgl_2">Eisenstein series on
<span class="math inline">\({\mathop{\mathrm{GL}}}_2\)</span></h4>
<p>One can apply the arguments of §<a
href="#sec:simpler-cusp-forms-gl_n" data-reference-type="ref"
data-reference="sec:simpler-cusp-forms-gl_n">1.1</a> to a pseudo
Eisenstein series <span class="math inline">\(\Psi\)</span>. The
reduction to <a href="#eq:int_sl_nm-backsl-sl"
data-reference-type="eqref"
data-reference="eq:int_sl_nm-backsl-sl">\((18.7)\)</a>
proceeds exactly as in the cuspidal case. The subsequent unfolding
procedure produces a “Whittaker” term, like <a href="#eq:sum-_m-fracl"
data-reference-type="eqref"
data-reference="eq:sum-_m-fracl">\((18.8)\)</a>, together with
<span class="math inline">\(n-1\)</span> additional “degenerate” terms,
indexed by the standard maximal parabolic subgroups of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span>. The estimation of
the degenerate terms is a bit more involved. In the simplest case <span
class="math inline">\(n=2\)</span>, there is a single degenerate term,
coming from the constant term of the Eisenstein series. The estimation
is painless in that case, and serves as a poor guide to the general
case, but nevertheless provides an opportunity to illustrate a few key
features.</p>
<p>For clarity of presentation, we eschew the general notation and setup
of Theorem <a href="#thm:growth-eisenstein-nonstandard"
data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a> (concerning
seminorms <span class="math inline">\(\nu_{\mathcal{D},\ell,T}\)</span>,
completed pseudo Eisenstein series <span
class="math inline">\(\Phi[f_\infty]\)</span>, etc.), and restate the
basic content of the “<span
class="math inline">\({\mathop{\mathrm{SL}}}_2\)</span> variant” of that
estimate explicitly.</p>
<div id="itm:sketch-sl2-assump-3" class="theorem">
<p><strong>Theorem 272</strong>. <em><span id="thm:sub-gln:let-f-be"
label="thm:sub-gln:let-f-be"></span> Let <span
class="math inline">\(T\)</span> be a positive parameter with <span
class="math inline">\(T \ggg 1\)</span>. Let <span
class="math inline">\(f\)</span> be an even Schwartz function on <span
class="math inline">\(\mathbb{R}^2\)</span> that, together with all
derivatives, decays rapidly near the origin. Regard <span
class="math inline">\(\mathbb{R}^2\)</span> as a space of row vectors,
equipped with the usual right action of <span
class="math inline">\({\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>.
Define <span class="math inline">\(\Psi :
{\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_2(\mathbb{R}) \rightarrow \mathbb{C}\)</span> by
the formula <span class="math display">\[\Psi(g) :=
    \sum _{v \in \mathbb{Z}^2} f(v g)
    =
    \sum _{0 \neq v \in \mathbb{Z}^2} f(v g).\]</span> Assume the
following conditions on <span class="math inline">\(f\)</span>:</em></p>
<ol type="i">
<li><p><em><span id="itm:sketch-sl2-assump-1"
label="itm:sketch-sl2-assump-1"></span> <span
class="math inline">\(f\)</span> is equal to its symplectic Fourier
transform, i.e., <span class="math inline">\(\mathcal{F} f = f\)</span>,
where <span class="math display">\[\mathcal{F} f(x,y) := \int _{u, v \in
\mathbb{R} } f(u,v ) e(x v - y u) \, d u \, d v, \quad  e(x) := e^{2 \pi
i x}.\]</span></em></p></li>
<li><p><em><span id="itm:sketch-sl2-assump-2"
label="itm:sketch-sl2-assump-2"></span> <span
class="math inline">\(f\)</span> has vanishing integral along each line
through the origin, i.e., for all <span class="math inline">\(0 \neq v
\in \mathbb{R}^2\)</span>, <span id="eq:int-_t-in-1" class="math display">\[\label{eq:int-_t-in-1}\tag{18.9}
      \int _{t \in \mathbb{R} } f( t v) \, d t =
0.\]</span></em></p></li>
<li><p><em><span class="math inline">\(f\)</span> has</em></p>
<div class="center">
<p><em>“<span class="math inline">\(L^2\)</span>-norm <span
class="math inline">\(\operatorname{O}(1)\)</span>, radial support <span
class="math inline">\(\asymp T\)</span>, radial frequency <span
class="math inline">\(\operatorname{O}(1)\)</span> and angular frequency
<span class="math inline">\(\operatorname{O}(T)\)</span>”</em></p>
</div>
<p><em>in the following sense. For elements <span
class="math inline">\(t\)</span> of the universal enveloping algebra
<span
class="math inline">\(\mathfrak{U}({\mathop{\mathrm{SL}}}_2(\mathbb{R}))\)</span>,
let <span class="math inline">\(R(t)\)</span> denote the associated
differential operator on <span
class="math inline">\(C^\infty(\mathbb{R}^2)\)</span>. Then for all
fixed <span class="math inline">\(m, \alpha \in \mathbb{Z}_{\geqslant
0}\)</span>, fixed <span class="math inline">\(t \in
\mathfrak{U}({\mathop{\mathrm{SL}}}_2(\mathbb{R}))\)</span> of degree at
most <span class="math inline">\(m\)</span>, and all <span
class="math inline">\(r &gt; 0\)</span>, we have <span id="eq:int-_v-in-7" class="math display">\[\label{eq:int-_v-in-7}\tag{18.10}
      \int _{\theta \in \mathbb{R} / 2 \pi \mathbb{Z} }
      \left\lvert
        \frac{d^\alpha }{d z^\alpha } R(t) f(e^{z} r \cos \theta, e^z r
\sin \theta )|_{z=0}
      \right\rvert^2 \, d \theta  \ll r^{-2} T^{2 m + o(1)} \max \left(
\frac{r}{T}, \frac{T}{r} \right)^{-\infty}.\]</span></em></p></li>
</ol>
<p><em>Let <span class="math inline">\(\Omega\)</span> be a fixed
compact subset of <span
class="math inline">\({\mathop{\mathrm{SL}}}_2(\mathbb{R})\)</span>. Let
<span class="math inline">\(t \geqslant 1\)</span> with <span
class="math inline">\(t = T^{\operatorname{O}(1)}\)</span>. Then <span id="eq:int-_g-in-1" class="math display">\[\label{eq:int-_g-in-1}\tag{18.11}
    \int _{g \in \Omega } |\Psi|^2 (\mathop{\mathrm{diag}}(t, 1/t) g) \,
d g
    \ll
    T^{o(1)}.\]</span></em></p>
</div>
<div class="remark">
<p><strong>Remark 273</strong>. Using only the general <span
class="math inline">\(L^2\)</span>-theory of Eisenstein series for <span
class="math inline">\({\mathop{\mathrm{SL}}}_2(\mathbb{Z})\)</span> and
our assumptions <a href="#itm:sketch-sl2-assump-1"
data-reference-type="eqref"
data-reference="itm:sketch-sl2-assump-1">\((i)\)</a>,
<a href="#itm:sketch-sl2-assump-2" data-reference-type="eqref"
data-reference="itm:sketch-sl2-assump-2">\((ii)\)</a>
and <a href="#itm:sketch-sl2-assump-3" data-reference-type="eqref"
data-reference="itm:sketch-sl2-assump-3">\((iii)\)</a>,
we may verify that <span class="math inline">\(\int
_{{\mathop{\mathrm{SL}}}_2(\mathbb{Z}) \backslash
{\mathop{\mathrm{SL}}}_2(\mathbb{R}) } |\Psi|^2 \ll T^{o(1)}\)</span>,
which is essentially sharp. This bound is essentially optimal (i.e., for
some <span class="math inline">\(f\)</span> as above, it is sharp).
Arguing as in Example <a href="#example:growth-bound-sl2-cusp"
data-reference-type="ref"
data-reference="example:growth-bound-sl2-cusp">271</a>, we obtain the
“trivial bound” <span id="eq:int-_g-in-4" class="math display">\[\label{eq:int-_g-in-4}\tag{18.12}
    \int _{g \in \Omega } |\Psi|^2 (\mathop{\mathrm{diag}}(t, 1/t) g) \,
d g
    \ll
    t^2 T^{o(1)},\]</span> which the target bound <a
href="#eq:int-_g-in-1" data-reference-type="eqref"
data-reference="eq:int-_g-in-1">\((18.11)\)</a> improves upon by
the factor <span class="math inline">\(t^2\)</span>.</p>
</div>
<div class="remark">
<p><strong>Remark 274</strong>. The invariance condition <span
class="math inline">\(\mathcal{F} f = f\)</span> under the symplectic
Fourier transform, together with the assumed rapid decay of <span
class="math inline">\(f\)</span> at <span
class="math inline">\(0\)</span>, implies that the Eisenstein series
<span class="math inline">\(\Psi\)</span> is orthogonal to residual
spectra, i.e., the constant function. This feature is necessary: without
such an assumption, the estimate <a href="#eq:int-_g-in-1"
data-reference-type="eqref"
data-reference="eq:int-_g-in-1">\((18.11)\)</a> can fail and the
“trivial bound” <a href="#eq:int-_g-in-4" data-reference-type="eqref"
data-reference="eq:int-_g-in-4">\((18.12)\)</a> can be sharp. The
failure becomes even worse in higher rank.</p>
</div>
<div class="remark">
<p><strong>Remark 275</strong>. As mentioned earlier in Remark <a
href="#rmk:we-discuss-informal-cal-F-U-G-T" data-reference-type="ref"
data-reference="rmk:we-discuss-informal-cal-F-U-G-T">176</a>, the
function <span class="math inline">\(f\)</span> relevant to our
application (furnished by Theorem <a href="#thm:main-local-results"
data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>,
constructed in §<a href="#sec:constr-test-vect-proofs"
data-reference-type="ref"
data-reference="sec:constr-test-vect-proofs">6</a> has the rough shape
<span class="math display">\[f(x,y) \approx T^{1/4} 1_{x \asymp T^{1/2}}
1_{y \ll 1} e(T y / x),\]</span> or equivalently, <span
class="math display">\[f(r \cos \theta, r \sin \theta) \approx
    T^{-1/2} 1_{r \asymp T^{1/2}}
    1 _{\theta \ll T^{-1/2}} e(T \theta),\]</span> and is easily seen to
satisfy all hypotheses of Theorem <a href="#thm:sub-gln:let-f-be"
data-reference-type="ref"
data-reference="thm:sub-gln:let-f-be">18.5</a> except
condition <a href="#itm:sketch-sl2-assump-2" data-reference-type="eqref"
data-reference="itm:sketch-sl2-assump-2">\((ii)\)</a>,
concerning vanishing of line integrals. The latter assumption is
satisfied by the modified function obtained by applying <span
class="math inline">\(\mathcal{P}_G(s)\)</span> as a Mellin multiplier,
which is the relevant function for defining <span
class="math inline">\(\Psi\)</span> as a series (see Example <a
href="#exa:example-sl2-completed-eisenstein-series"
data-reference-type="ref"
data-reference="exa:example-sl2-completed-eisenstein-series">28</a> for
details).</p>
</div>
<div class="remark">
<p><strong>Remark 276</strong>. Many of the assumptions in Theorem <a
href="#thm:sub-gln:let-f-be" data-reference-type="ref"
data-reference="thm:sub-gln:let-f-be">18.5</a> could
be relaxed. For instance, instead of assuming that <span
class="math inline">\(\mathcal{F} f = f\)</span>, it would suffice to
assume that <span class="math inline">\(\mathcal{F} f\)</span> vanishes
at the origin, and less radial uniformity than <a href="#eq:int-_v-in-7"
data-reference-type="eqref"
data-reference="eq:int-_v-in-7">\((18.10)\)</a> is required. Since
the stronger assumptions are valid in the setting of Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a> and streamline
our discussion, we keep them here.</p>
</div>
<p>The proof of Theorem <a href="#thm:sub-gln:let-f-be"
data-reference-type="ref"
data-reference="thm:sub-gln:let-f-be">18.5</a>
involves the the Fourier expansion of <span
class="math inline">\(\Psi\)</span>. Set <span
class="math display">\[n(x) := \begin{pmatrix}
    1 &amp; x \\
    0 &amp; 1
  \end{pmatrix}.\]</span> The constant term in that Fourier expansion is
given by <span class="math display">\[\Psi_N(g) = \int _{x \in
\mathbb{R} / \mathbb{Z} } \Psi(n(x) g) \, d x.\]</span> By some
elementary calculations and the Poisson summation formula, we verify
that <span class="math display">\[\Psi_N(g) = \sum _{t \in \mathbb{Z} }
(f + \mathcal{F} f ) ((0,t) g).\]</span> Since <span
class="math inline">\(\mathcal{F}f = f\)</span>, we may simplify <span
class="math inline">\(f + \mathcal{F} f\)</span> to <span
class="math inline">\(2 f\)</span>.</p>
<p>The non-constant terms are indexed by nonzero integers <span
class="math inline">\(\ell\)</span>: <span
class="math display">\[W(\ell,g) := \int _{x \in \mathbb{R} / \mathbb{Z}
} \Psi(n(x) g) e(-\ell x) \, d x.\]</span> Their evaluation is a simple
calculation that we leave to the reader: <span id="eq:well-g-=" class="math display">\[\label{eq:well-g-=}\tag{18.13}
  W(\ell, g)
  = \sum _{c | \ell} \int _{x \in \mathbb{R} } f((c, x) g) e( \tfrac{-
\ell}{c} x) \, d x.\]</span> Set <span class="math inline">\(R :=
\mathop{\mathrm{diag}}(t,1/t)\)</span>. After enlarging <span
class="math inline">\(\Omega\)</span> if necessary, it is enough to
bound <span class="math display">\[\int _{x \in  \mathbb{R} / \mathbb{Z}
}
  \int _{g \in \Omega }
  |\Psi|^2(n(x) R g) \, d g \, d x.\]</span> By Parseval and the Fourier
calculations given above, we may expand this double integral as a sum of
two terms: <span class="math display">\[I_0 := 4 \int _{g \in \Omega }
\left\lvert \sum _{t \in \mathbb{Z} } f((0,t) R g) \right\rvert^2 \, d
g.\]</span> and <span class="math display">\[I_1 := \sum _{0 \neq \ell
\in \mathbb{Z}}
  \int _{g \in \Omega }
  |W(\ell, R g)|^2 \, d g.\]</span></p>
<p>The term <span class="math inline">\(I_1\)</span> may be treated much
like in the cuspidal case, following a spectral expansion of <span
class="math inline">\(f\)</span>. We focus here on the treatment of
<span class="math inline">\(I_0\)</span>. Define <span
class="math inline">\(f^\sharp : \mathbb{R}^2 \rightarrow
\mathbb{C}\)</span> by the formula <span
class="math display">\[f^\sharp(v)  := \sum _{t \in \mathbb{Z} } f(t
v).\]</span> Recall that <span class="math inline">\(f(0) = 0\)</span>,
so that <span class="math inline">\(f ^\sharp (0)\)</span> makes sense
and vanishes. Then <span class="math display">\[I_0 = 4 \int _{g \in
\Omega } | f^\sharp(e_2 R g)|^2 \, d g.\]</span></p>
<p>From the bounds <a href="#eq:int-_v-in-7" data-reference-type="eqref"
data-reference="eq:int-_v-in-7">\((18.10)\)</a>, the vanishing
condition <a href="#eq:int-_t-in-1" data-reference-type="eqref"
data-reference="eq:int-_t-in-1">\((18.9)\)</a> and some Mellin
analysis, one can check that, e.g., for all fixed <span
class="math inline">\(t \in
\mathfrak{U}({\mathop{\mathrm{SL}}}_2(\mathbb{R}))\)</span> of degree at
most <span class="math inline">\(m\)</span>, <span id="eq:int-_theta-in" class="math display">\[\label{eq:int-_theta-in}\tag{18.14}
  \int _{\theta \in \mathbb{R} / 2 \pi \mathbb{Z} }
  \left\lvert R(t) f ^\sharp  (r \cos \theta, r \sin \theta )
\right\rvert^2
  \, d \theta
  \ll
  \ll r^{-2} T^{2 m + o(1)} \max \left( \frac{r}{T}, \frac{T}{r}
\right)^{-\infty}.\]</span> Indeed, focusing on the case <span
class="math inline">\(t=1\)</span> for notational simplicity, to obtain
<a href="#eq:int-_theta-in" data-reference-type="eqref"
data-reference="eq:int-_theta-in">\((18.14)\)</a>, it suffices by
basic Paley–Wiener theory to verify that the Mellin transform <span
class="math display">\[\int _{r =0}^{\infty}
  f ^\sharp (r \cos \theta, r \sin \theta )
  r^s \, \frac{d r}{|r|}\]</span> is majorized, in an <span
class="math inline">\(L^2\)</span>-sense with respect to <span
class="math inline">\(\theta\)</span>, by <span
class="math inline">\(r^{-2} T^{s} (1 + |s|)^{-\infty}\)</span> whenever
<span class="math inline">\(\Re(s) \ll 1\)</span>. In view of the
definition of <span class="math inline">\(f ^\sharp\)</span>, that
Mellin transform evaluates to <span class="math display">\[\zeta(s)
  \int _{r =0}^{\infty}
  f  (r \cos \theta, r \sin \theta )
  r^s \, \frac{d r}{|r|}.\]</span> The vanishing line integral condition
on <span class="math inline">\(f\)</span> implies that the above remains
holomorphic at the unique pole of <span
class="math inline">\(\zeta\)</span>. Since <span
class="math inline">\(\zeta\)</span> grows at most polynomially, we
obtain the required bounds for <span class="math inline">\(f
^\sharp\)</span> from the assumed bounds for <span
class="math inline">\(f\)</span>.</p>
<p>Using the Sobolev lemma for <span class="math inline">\(K\)</span>,
we may deduce from <a href="#eq:int-_theta-in"
data-reference-type="eqref"
data-reference="eq:int-_theta-in">\((18.14)\)</a> that <span
class="math display">\[\sup _{\theta \in \mathbb{R} / 2 \pi \mathbb{Z} }
  \left\lvert f ^\sharp  (r \cos \theta, r \sin \theta ) \right\rvert
  \ll
  \ll T^{m + C_0} \max \left( \frac{r}{T}, \frac{T}{r}
\right)^{-\infty}\]</span> for some fixed <span
class="math inline">\(C_0\)</span>. From this, we see that the integral
<span class="math inline">\(I_0\)</span> is always negligibly small.
Indeed, the element <span class="math inline">\(e_2 R = t^{-1}
e_2\)</span> is close to the origin for <span class="math inline">\(t
\gg 1\)</span>, whereas <span class="math inline">\(f ^\sharp\)</span>
is concentrated on elements of size <span class="math inline">\(\asymp
T\)</span>.</p>
<p>The above analysis of <span class="math inline">\(I_0\)</span> was
perhaps a bit underwhelming, but it illustrates a couple points that
will recur in the general case.</p>
<ol type="i">
<li><p>The first is that it matters where <span
class="math inline">\(f\)</span> is concentrated. In this example, the
concentration condition implies that <span
class="math inline">\(I_0\)</span> is negligible. What typically happens
(for the various “degenerate” terms intermediary between the constant
term contribution and the “Whittaker term”) is that the concentration
properties of <span class="math inline">\(f\)</span> yield a
satisfactory estimate in certain cases (depending upon <span
class="math inline">\(t\)</span>, <span class="math inline">\(T\)</span>
and other variables), while in other cases, other methods
succeed.</p></li>
<li><p>The second is the passage from <span
class="math inline">\(f\)</span> to <span class="math inline">\(f
^\sharp\)</span>. While it turns out to be simpler to estimate the
Whittaker contribution using the series representation of <span
class="math inline">\(\Psi\)</span> involving <span
class="math inline">\(f\)</span> (the formula <a href="#eq:well-g-="
data-reference-type="eqref"
data-reference="eq:well-g-=">\((18.13)\)</a> being much nicer than the
expression for <span class="math inline">\(W\)</span> in terms of <span
class="math inline">\(f ^\sharp\)</span>), we could have simplified our
treatment of the constant term contribution by working with the series
representation <span class="math display">\[\Psi(g) =
    \sideset{}{^*}\sum _{v \in \mathbb{Z}^2} f ^\sharp (v g),\]</span>
where <span class="math inline">\(\sum^\ast\)</span> denotes a sum over
primitive elements. In general, for each of the degenerate terms that we
encounter, there is a specific series representation of <span
class="math inline">\(\Psi\)</span> best suited for its estimation (§<a
href="#sec:seri-repr-via" data-reference-type="ref"
data-reference="sec:seri-repr-via">3.8</a>).</p></li>
</ol>
<h3 id="sec:rank-selb-unfold">§19. Rankin–Selberg unfolding</h3>
<h4 id="sec:notation-rs-unfolding">§19.1. Notation</h4>
<p>For each natural number <span class="math inline">\(n\)</span>, let
<span class="math inline">\(V_n\)</span> denote the punctured affine
<span class="math inline">\(n\)</span>-plane, omitting the origin. For a
ring <span class="math inline">\(R\)</span>, <span
class="math inline">\(V_n(R)\)</span> consists of all elements of the
free module <span class="math inline">\(R^n\)</span> that generate a
direct summand. For a field or local ring <span
class="math inline">\(R\)</span>, we have <span
class="math inline">\(V_n(R) = \{(x_1,\dotsc,x_n) \in R^n : x_j \in
R^\times \text{ for some } j \in \{1,\dotsc,n\}\}\)</span>. We regard
points of <span class="math inline">\(V_n\)</span> as row vectors, with
<span class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> acting on
the right by matrix multiplication. Let <span
class="math inline">\(e_1,\dotsc,e_n \in V_n(\mathbb{Z})\)</span> denote
the standard basis for <span
class="math inline">\(\mathbb{Z}^n\)</span>, e.g., <span
class="math inline">\(e_n = (0,\dotsc,0,1)\)</span>. We denote by <span
class="math inline">\(P_n \leqslant{\mathop{\mathrm{GL}}}_n\)</span> the
stabilizer of <span class="math inline">\(e_n\)</span>, i.e., the
“mirabolic” subgroup consisting of all matrices with bottom row <span
class="math inline">\((0,\dotsc,0,1)\)</span>. The map <span
class="math inline">\(g \mapsto e_n g\)</span> identifies <span
class="math inline">\(V_n\)</span> with <span class="math inline">\(P_n
\backslash {\mathop{\mathrm{GL}}}_n\)</span>. We let <span
class="math inline">\(U_n \leqslant P_n\)</span> denote the unipotent
radical and <span class="math inline">\({\mathop{\mathrm{GL}}}_{n-1}
\leqslant P_n\)</span> the standard upper-left <span
class="math inline">\((n-1) \times (n-1)\)</span> Levi subgroup, so that
<span class="math inline">\(P_n = {\mathop{\mathrm{GL}}}_{n-1} \rtimes
U_n\)</span>. We denote by <span class="math inline">\(N_n
\leqslant{\mathop{\mathrm{GL}}}_n\)</span> the standard upper-triangular
maximal unipotent subgroup. Then <span class="math inline">\(N_n =
N_{n-1} \rtimes U_n \leqslant P_n\)</span>.</p>
<p>We henceforth fix one such <span class="math inline">\(n\)</span>.
For each <span class="math inline">\(m &lt; n\)</span>, we regard <span
class="math inline">\({\mathop{\mathrm{GL}}}_m\)</span>, hence also each
of its subgroups defined above, as included in <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> in the usual way,
as the upper-left <span class="math inline">\(m \times m\)</span>
block.</p>
<p>Let <span class="math inline">\(F\)</span> be a number field with
adele ring <span class="math inline">\(\mathbb{A}\)</span>. Let <span
class="math inline">\(\psi : \mathbb{A}/F \rightarrow
\mathop{\mathrm{U}}(1)\)</span> be a nontrivial unitary character. We
denote also simply by <span class="math inline">\(\psi\)</span> the
corresponding standard nondegenerate character of <span
class="math inline">\(N_n(\mathbb{A})\)</span>, given by <span
class="math inline">\(\psi(u) = \psi(\sum_{j=1}^{n-1}
u_{j,j+1})\)</span>. It induces a nontrivial character of the abelian
group <span class="math inline">\([U_m]\)</span> for each <span
class="math inline">\(m \leqslant n\)</span>.</p>
<h4 id="mirabolic-eisenstein-series">Mirabolic Eisenstein series</h4>
<p>For each <span class="math inline">\(\phi \in
C_c^\infty(V_n(\mathbb{A}))\)</span>, we define <span
class="math inline">\(\theta_\phi : [{\mathop{\mathrm{GL}}}_n] \rightarrow
\mathbb{C}\)</span> by the formula <span
class="math display">\[\theta_\phi(g) := \sum _{0 \neq v \in V_n(F)}
\phi(v g).\]</span></p>
<div class="example">
<p><strong>Example 277</strong>. Suppose that <span
class="math inline">\(F = \mathbb{Q}\)</span> and that <span
class="math inline">\(\phi = \otimes \phi_\mathfrak{p}\)</span>, where
<span class="math inline">\(\phi_p\)</span> is the characteristic
function of <span class="math inline">\(V_n(\mathbb{Z}_p)\)</span> and
<span class="math inline">\(\phi_\infty \in
C_c^\infty(V_n(\mathbb{R}))\)</span>. Then for <span
class="math inline">\(g \in {\mathop{\mathrm{GL}}}_n(\mathbb{Z})
\backslash {\mathop{\mathrm{GL}}}_n(\mathbb{R}) \hookrightarrow
[{\mathop{\mathrm{GL}}}_n]\)</span>, we have <span
class="math display">\[\theta_\phi(g) =
    \sum _{
      \substack{
        v = (v_1,\dotsc,v_n) \in \mathbb{Z}^n :  
        \\
         \gcd(v_1,\dotsc,v_n) = 1
      }
    } \phi_\infty(v g).\]</span> This special case is in fact the only
case relevant for the applications of this paper, but it seemed clearer
to us to develop the preliminaries in their natural generality.</p>
</div>
<p>It is easy to see, by elementary lattice point counting arguments,
that any such function <span class="math inline">\(\theta_\phi\)</span>
lies in the space <span class="math inline">\(\mathcal{T}([G])\)</span>
of automorphic functions of uniform moderate growth.</p>
<h4 id="sec:stand-rank-selb">§19.3. Standard Rankin–Selberg unfolding</h4>
<p>Let <span class="math inline">\(\varphi \in
\mathcal{S}([{\mathop{\mathrm{GL}}}_n])\)</span>. We aim to study, for
<span class="math inline">\(\phi \in
C_c^\infty(V_n(\mathbb{A}))\)</span>, the integrals <span
class="math display">\[\int _{[{\mathop{\mathrm{GL}}}_n]} |\varphi|^2
\theta_\phi.\]</span> Note that since <span
class="math inline">\(\varphi\)</span> is of rapid decay and <span
class="math inline">\(\theta_\phi\)</span> of moderate growth, such
integrals converge absolutely.</p>
<p>Suppose for the moment that <span
class="math inline">\(\varphi\)</span> is cuspidal. Then <span
class="math inline">\(\varphi\)</span> admits a rapidly-convergent
Whittaker expansion <a href="#ref-MR348047" class="citation"
data-cites="MR348047">(Shalika 1974, Thm 5.9)</a> <span id="eq:varphig-=-sum" class="math display">\[\label{eq:varphig-=-sum}\tag{19.1}
  \varphi(g) = \sum _{\gamma \in N_n(F) \backslash P_n(F) }
W_{\varphi}(\gamma g),
  \quad
  W_{\varphi}(g) := \int _{[N_n]}
  \varphi(u g) \psi^{-1}(u) \, d u.\]</span> Since <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(F)\)</span> acts
transitively on <span class="math inline">\(V_n(F) - \{0\}\)</span> with
stabilizer <span class="math inline">\(P_n(F)\)</span>, we have <span
class="math inline">\(\theta_\phi(g) = \sum _{\gamma \in P_n(F)
\backslash {\mathop{\mathrm{GL}}}_n(F)} \phi(e_n \gamma g)\)</span>. We
obtain the following unfolding: <span
class="math display">\[\begin{align}
  \int _{[{\mathop{\mathrm{GL}}}_n]} |\varphi|^2 \theta_\phi  &amp;=
  \int _{P_n(F) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})}|\varphi|^2(g) \phi(e_n g) \, d g \\
  &amp;=
  \int _{N_n(F) \backslash {\mathop{\mathrm{GL}}}_n(\mathbb{A})}
W_{\varphi}(g) \overline{\varphi(g)} \phi(e_n g) \, d g \\
  &amp;=
    \int _{g \in N_n(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})}
    \int _{u \in N_n(F) \backslash N_n(\mathbb{A})}
    W_{\varphi}(u g) \overline{\varphi(u g)} \phi(e_n u g) \, d g \\
  &amp;=
  \int _{N_n(\mathbb{A}) \backslash {\mathop{\mathrm{GL}}}_n(\mathbb{A})}
|W_{\varphi}|^2(g) \phi(e_n g) \, d g.
\end{align}\]</span> Calculations like this are the basis of the
Rankin–Selberg method on <span
class="math inline">\({\mathop{\mathrm{GL}}}_n \times
{\mathop{\mathrm{GL}}}_n\)</span> <a href="#ref-MR701565 MR618323" class="citation"
data-cites="MR701565 MR618323">(H. Jacquet, Piatetskii-Shapiro, and
Shalika 1983; H. Jacquet and Shalika 1981)</a>.</p>
<p>Our first aim in this section (Proposition <a
href="#prop:sub-gln:let-varphi-in-preilm-unfold"
data-reference-type="ref"
data-reference="prop:sub-gln:let-varphi-in-preilm-unfold">278</a>) is to
carry out similar calculations, but without the cuspidality assumption
on <span class="math inline">\(\varphi\)</span>. The resulting formula
is similar to the above, but with some “correction” terms coming from
other parts of the Fourier–Whittaker expansion of <span
class="math inline">\(\varphi\)</span>. The calculation is a matter of
book-keeping, but we could not quickly locate a suitable reference.
Similar calculations, including a more general form of <a
href="#eq:varphig-=-sum" data-reference-type="eqref"
data-reference="eq:varphig-=-sum">\((19.1)\)</a>, may be found
in <a href="#ref-MR3334892" class="citation" data-cites="MR3334892">(Ichino and Yamana
2015, Prop 4.2)</a>.</p>
<p>We then apply the resulting formula to the case that <span
class="math inline">\(\varphi\)</span> is an incomplete Eisenstein
series defined with respect to a minimal parabolic. Doing so involves
several applications of standard formulas for constant terms and inner
products of Eisenstein series.</p>
<h4 id="sec:part-whitt-transf">§19.4. Partial Whittaker transforms</h4>
<p>We require some further notation.</p>
<p>Let <span class="math inline">\(j \in \{0, \dotsc,
n-1\}\)</span>.</p>
<p>We define the subgroups <span class="math inline">\(P_n^{(j)}
\leqslant{\mathop{\mathrm{GL}}}_n\)</span> by <span
class="math inline">\(P_n^{(j)} := P_{n-j} N_n\)</span>. We denote by
<span class="math inline">\(U_n^{(j)}\)</span> the unipotent radical of
<span class="math inline">\(P_n^{(j)}\)</span>. Then <span
class="math inline">\(P_n^{(j)} = {\mathop{\mathrm{GL}}}_{n-1-j} \rtimes
U_n^{(j)}\)</span> and <span class="math inline">\(U_n^{(j)} = U_{n-j}
\dotsb U_{n-1} U_n\)</span>. For example, <span
class="math inline">\(P_n^{(0)} = P_n\)</span> and <span
class="math inline">\(U_n^{(0)} = U_n\)</span>, while <span
class="math inline">\(P_n^{(n-1)} = U_n^{(n-1)} = U_n^{(n-2)} =
N_n\)</span>.</p>
<p>Generalizing the conventions of §<a href="#sec:haar-measures"
data-reference-type="ref" data-reference="sec:haar-measures">2.3.5</a>,
we equip the adelic points of any unipotent group <span
class="math inline">\(U\)</span> with the Haar measure for which <span
class="math inline">\([U] = U(F) \backslash U(\mathbb{A})\)</span> has
volume one.</p>
<p>We write <span class="math inline">\(W^{(j)}_\varphi(g)\)</span> for
the “<span class="math inline">\(j\)</span>th partial Whittaker
function,” defined inductively as follows: <span
class="math inline">\(W_\varphi^{(0)} := \varphi\)</span> and <span
class="math display">\[W_{\varphi}^{(j+1)}(g) := \int _{u \in [U_{n-j}]}
W_\varphi^{(j)}(u g) \psi^{-1}(u) \, d u.\]</span> Thus, for instance,
<span class="math inline">\(W_\varphi^{(n-1)} = W_\varphi\)</span>. We
note that <span class="math inline">\(W_\varphi^{(j)}\)</span> defines a
function on the quotient <span class="math inline">\(P_n^{(j)}(F)
U_n^{(j)}(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})\)</span>.</p>
<p>We denote by <span
class="math inline">\(W^{(j)}_{\varphi,U_{n-j}}\)</span> the constant
term of <span class="math inline">\(W^{(j)}_{\varphi}\)</span> with
respect to <span class="math inline">\(U_{n-j}\)</span>: <span
class="math display">\[W^{(j)}_{\varphi,U_{n-j}}(g) :=
  \int _{u \in [U_{n-j}]} W_\varphi^{(j)}(u g) \, d u.\]</span> For
example, when <span class="math inline">\(j = n-1\)</span>, the group
<span class="math inline">\(U_{n-j}\)</span> is trivial and we have
<span class="math inline">\(W_{\varphi,U_{n-j}}^{(j)} =
W_{\varphi}\)</span>, whereas for <span
class="math inline">\(j=0\)</span>, we have <span
class="math inline">\(W_{\varphi,U_{n}}^{(0)}(g) = \int _{u \in [U_n]}
\varphi(u g) \, d u\)</span> (which we later denote by <span
class="math inline">\(\varphi_{U_n}(g)\)</span>).</p>
<p>We note that the restriction of <span
class="math inline">\(W_{\varphi,U_{n-j}}^{(j)}\)</span> to <span
class="math inline">\({\mathop{\mathrm{GL}}}_{n-j-1}(\mathbb{A})\)</span>
is left <span
class="math inline">\({\mathop{\mathrm{GL}}}_{n-j-1}(F)\)</span>-invariant,
hence defines a function on <span
class="math inline">\([{\mathop{\mathrm{GL}}}_{n-j-1}]\)</span>.</p>
<p>Recall that we have chosen a Haar measure on each <span
class="math inline">\({\mathop{\mathrm{GL}}}_m(\mathbb{A})\)</span>. We
obtain a left Haar measure on each <span
class="math inline">\(P_n^{(j)}(\mathbb{A}) =
{\mathop{\mathrm{GL}}}_{n-1-j}(\mathbb{A}) \rtimes
U_n^{(j)}(\mathbb{A})\)</span>. We note that the modulus character of
<span class="math inline">\(P_n^{(j)}(\mathbb{A})\)</span> is given by
<span class="math inline">\(|\det|^{j+1}\)</span>. Temporarily denote by
<span class="math inline">\(\mathcal{I}\)</span> the space of smooth
compactly-supported functions <span class="math inline">\(f :
P_n^{(j)}(\mathbb{A}) \backslash {\mathop{\mathrm{GL}}}_n(\mathbb{A})
\rightarrow \mathbb{C}\)</span> satisfying <span
class="math inline">\(f(h g) = |\det h|^{j+1} f(g)\)</span> for all
<span class="math inline">\(h \in P_n^{(j)}(\mathbb{A})\)</span>. There
is a natural surjective map <span
class="math inline">\(C_c^\infty({\mathop{\mathrm{GL}}}_n(\mathbb{A}))
\rightarrow \mathcal{I}\)</span> given by <span
class="math inline">\(\phi \mapsto [g \mapsto \int_{h \in
P_{n}^{(j)}(\mathbb{A})} \phi(h g) \, \frac{d h}{|\det
h|^{j}}]\)</span>, where <span class="math inline">\(d h\)</span>
denotes the left Haar described above. This map is equivariant for the
actions of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{A})\)</span> by
right translation. There is a unique <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{A})\)</span>-invariant
functional <span class="math inline">\(\mathcal{I} \rightarrow
\mathbb{C}\)</span> for which the composition <span
class="math inline">\(C_c^\infty({\mathop{\mathrm{GL}}}_n(\mathbb{A}))
\rightarrow \mathcal{I} \rightarrow \mathbb{C}\)</span> is the given
Haar measure. We denote this functional by <span class="math inline">\(f
\mapsto \int _{P_n^{(j)}(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})} f(g) \, d g\)</span>.</p>
<h4 id="preliminary-unfolding">Preliminary unfolding</h4>
<div id="prop:sub-gln:let-varphi-in-preilm-unfold" class="proposition">
<p><strong>Proposition 278</strong>. <em>Let <span
class="math inline">\(\varphi \in
\mathcal{S}([{\mathop{\mathrm{GL}}}_n])\)</span> and <span
class="math inline">\(\phi \in C_c^\infty(V_n(\mathbb{A}))\)</span>. We
have <span id="eq:int-_gl_n-varphi2" class="math display">\[\label{eq:int-_gl_n-varphi2}\tag{19.2}
    \int _{[{\mathop{\mathrm{GL}}}_n]} |\varphi|^2 \theta_\phi  =
    \sum_{j=0}^{n-1} I_j,\]</span> where <span
class="math display">\[I_j := \int _{P_n^{(j)}(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})} \phi(e_n g)
      \int _{h \in [{\mathop{\mathrm{GL}}}_{n-j-1}]}
      \left\lvert
      W_{\varphi,U_{n-j}}^{(j)} (h g)
    \right\rvert^2
    \, \frac{d h}{|\det h|^{j+1}}
    \, d g.\]</span> Each of the above integrals converges
absolutely.</em></p>
</div>
<div class="remark">
<p><strong>Remark 279</strong>. It is not hard to see that if <span
class="math inline">\(\varphi\)</span> is cuspidal, then for each <span
class="math inline">\(j \neq n-1\)</span>, we have <span
class="math inline">\(W_{\varphi,U_{n-j}}^{(j)} = 0\)</span>, hence
<span class="math inline">\(I_j = 0\)</span>. On the other hand, <span
class="math display">\[I_{n-1} = \int _{N_n(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})} |W_{\varphi}|^2(g) \phi(e_n g) \, d
g,\]</span> as in §<a href="#sec:stand-rank-selb"
data-reference-type="ref"
data-reference="sec:stand-rank-selb">2.3</a>.</p>
</div>
<p>The proof requires a preliminary lemma. For each continuous function
<span class="math inline">\(\varphi\)</span> on <span
class="math inline">\([{\mathop{\mathrm{GL}}}_n]\)</span>, we denote by
<span class="math inline">\(\varphi_{U_n}\)</span> its constant term
with respect to <span class="math inline">\(U_n\)</span>, i.e., <span
class="math inline">\(\varphi_{U_n}(g) := \int _{u \in [U_n]} \varphi(u
g) \, d u\)</span>.</p>
<div id="lem:sub-gln:let-varphi-be-parseval-U-n" class="lemma">
<p><strong>Lemma 280</strong>. Let <span
class="math inline">\(\varphi\)</span> be a continuous function on <span
class="math inline">\([{\mathop{\mathrm{GL}}}_n]\)</span>. Then <span
class="math display">\[\int _{u \in [U_n]} |\varphi|^2( u g) \, d u
    =
    |\varphi_{U_n}|^2(g)
    +
    \sum _{\gamma \in P_{n-1}(F) \backslash
{\mathop{\mathrm{GL}}}_{n-1}(F)}
    \left\lvert
      W_{\varphi}^{(1)}(\gamma g)
    \right\rvert^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This computation is essentially contained in the
proof of <a href="#eq:varphig-=-sum" data-reference-type="eqref"
data-reference="eq:varphig-=-sum">\((19.1)\)</a>. We sketch it
for the sake of convenience. The quotient <span
class="math inline">\([U_n]\)</span> is a compact abelian group. By
considering the first <span class="math inline">\(n-1\)</span> rows of
its final column, we may identify it with the space of column vectors
<span class="math inline">\(u = (u_1,\dotsc,u_{n-1})^%
  {\mathpalette\@transpose{}}%\)</span> with each <span
class="math inline">\(u_j \in \mathbb{A}/F\)</span>. The Pontryagin dual
<span class="math inline">\([U_n]^\wedge\)</span> identifies with the
space of row vectors <span class="math inline">\(\xi =
(\xi_1,\dotsc,\xi_{n-1})\)</span>, with the corresponding character
<span class="math inline">\(\psi_\xi\)</span> of <span
class="math inline">\([U_n]\)</span> given by <span
class="math inline">\(\psi_\xi(u) = \psi(\xi u) := \psi(\sum_{j=1}^{n-1}
\xi_j u_j)\)</span>. In any event, Parseval’s relation gives <span
class="math display">\[\int _{u \in [U_n]} |\varphi|^2(u g)
    = \sum _{\xi \in [U_n]^\wedge }
    |\varphi_\xi(g)|^2,
    \quad
    \varphi_\xi(g)
    :=
    \int _{u \in [U_n]}
    \varphi(u g) \psi_\xi^{-1}(u) \, d u.\]</span> The group <span
class="math inline">\({\mathop{\mathrm{GL}}}_{n-1}(F)\)</span> acts via
conjugation on <span class="math inline">\([U_n]\)</span>, hence by
duality on <span class="math inline">\([U_n]^\wedge\)</span>. For <span
class="math inline">\(\gamma \in {\mathop{\mathrm{GL}}}_{n-1}(F)\)</span>,
we have <span class="math display">\[\varphi_{\xi}(\gamma g) =
\varphi_{\xi \gamma ^{-1}}(g).\]</span> There are two orbits for the
latter action: <span class="math inline">\(\{0\}\)</span> and <span
class="math inline">\([U_n]^\wedge - \{0\}\)</span>. The contribution
from <span class="math inline">\(\xi = 0\)</span> is <span
class="math inline">\(\varphi_0 = \varphi_{U_n}\)</span>. The
representative <span class="math inline">\(\xi = e_{n-1}^%
  {\mathpalette\@transpose{}}%\)</span> for <span
class="math inline">\([U_n]^\wedge - \{0\}\)</span> has stabilizer <span
class="math inline">\(P_{n-1}(F)\)</span>, and we have <span
class="math inline">\(\varphi_{e_{n-1}^%
  {\mathpalette\@transpose{}}%
} = W_{\varphi}^{(1)}\)</span>. The required formula folllows. ◻</p>
</div>
<div class="proof">
<p><em>Proof of Proposition <a
href="#prop:sub-gln:let-varphi-in-preilm-unfold"
data-reference-type="ref"
data-reference="prop:sub-gln:let-varphi-in-preilm-unfold">278</a>.</em>
We first address the issue of convergence. The proof given below shows
that the identity <a href="#eq:int-_gl_n-varphi2"
data-reference-type="eqref"
data-reference="eq:int-_gl_n-varphi2">\((19.2)\)</a> holds
when <span class="math inline">\(\phi\)</span> is a nonnegative-valued
continuous function of rapid decay. For such <span
class="math inline">\(\phi\)</span>, the incomplete Eisenstein series
<span class="math inline">\(\theta_\phi\)</span> remains of moderate
growth, so the integral on the LHS of <a href="#eq:int-_gl_n-varphi2"
data-reference-type="eqref"
data-reference="eq:int-_gl_n-varphi2">\((19.2)\)</a>
converges. Since each integrand on the RHS is nonnegative, it follows
that each integral on the RHS converges. We can apply the argument just
indicated to the absolute value <span
class="math inline">\(|\phi|\)</span> of <span
class="math inline">\(\phi\)</span>, giving the required absolute
convergence in the stated generality of the proposition and also in each
step of the proof that follows.</p>
<p>We now begin the proof of the identity. We unfold, as follows: <span
class="math display">\[\begin{align}
    \int _{[{\mathop{\mathrm{GL}}}_n]} |\varphi|^2 \theta_\phi
    &amp;=
      \int _{g \in P_n(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})}
      \phi(e_n g)
      \int _{p \in [P_n]} |\varphi|^2(p g) \, d p \, d g \\
    &amp;=
      \int _{g \in P_n(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})}
      \phi(e_n g)
      J(g) \, d g,
  
\end{align}\]</span> where <span
class="math display">\[\begin{align}
    J(g) &amp;:=
           \int _{p \in [P_n]}
           |\varphi|^2( p g) \, d p \\
         &amp;=
           \int _{h \in [{\mathop{\mathrm{GL}}}_{n-1}]}
           \int _{u \in [U_n]} |\varphi|^2(u h g) \, d u \, \frac{d
h}{|\det h|}.
  
\end{align}\]</span> We compute the inner integral by applying Lemma
<a href="#lem:sub-gln:let-varphi-be-parseval-U-n"
data-reference-type="ref"
data-reference="lem:sub-gln:let-varphi-be-parseval-U-n">280</a>. This
gives <span class="math inline">\(J = J_{0} + J_{1+}\)</span>, where
<span class="math display">\[J_0(g) =
    \int _{h \in [{\mathop{\mathrm{GL}}}_{n-1}]} | \varphi_{U_n}(h g) |^2
\, \frac{d h}{|\det h|},\]</span> <span class="math display">\[J_{1+}(g)
=
    \int _{h \in [{\mathop{\mathrm{GL}}}_{n-1}]}
    \sum _{\gamma \in P_{n-1}(F) \backslash
{\mathop{\mathrm{GL}}}_{n-1}(F)}
    |W_\varphi^{(1)}(\gamma h g)|^2 \, \frac{d h}{|\det h|}\]</span> We
have <span class="math inline">\(\varphi_{U_n} =
W_{\varphi,U_n}^{(0)}\)</span> and <span class="math inline">\(P_n =
P_n^{(0)}\)</span>, so the contribution of <span
class="math inline">\(J_0\)</span> to <span class="math inline">\(\int
|\varphi|^2 \theta_\phi\)</span> is the expected term <span
class="math inline">\(I_{0}\)</span>.</p>
<p>It remains to evaluate the contribution of <span
class="math inline">\(J_{1+}\)</span>. By unfolding, <span
class="math display">\[J_{1+}(g) = \int _{g&#39; \in P_{n-1}(\mathbb{A})
\backslash {\mathop{\mathrm{GL}}}_{n-1}(\mathbb{A})}
    \int _{p \in [P_{n-1}]} |W_{\varphi}^{(1)}(p g&#39; g)|^2 \, \frac{d
p}{|\det p|} \, d g&#39;.\]</span> We have <span
class="math inline">\(P_{n-1} \backslash
{\mathop{\mathrm{GL}}}_{n-1}  \cong P_{n}^{(1)} \backslash P_n\)</span>,
hence the further unfolding <span id="eq:int-_g-in-rs" class="math display">\[\label{eq:int-_g-in-rs}\tag{19.3}
    \int _{g \in P_n(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A}) } \phi(e_n g) J_{1+}(g) \, d g
    =
    \int _{g \in P_{n}^{(1)}(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})}
    \phi(e_n g)
    J_{1+}&#39;(g) \, d g,\]</span> where <span
class="math display">\[J_{1+}&#39;(g) := \int _{p \in [P_{n-1}]}
|W_\varphi^{(1)}(p g)|^2 \, \frac{d p}{|\det p|}.\]</span></p>
<p>Suppose for the moment that <span class="math inline">\(n =
2\)</span>. The <span class="math inline">\(P_{n}^{(1)} = N_n\)</span>,
<span class="math inline">\(P_{n-1}\)</span> is trivial, and <span
class="math inline">\(W_{\varphi}^{(1)} = W_\varphi\)</span>, so <a
href="#eq:int-_g-in-rs" data-reference-type="eqref"
data-reference="eq:int-_g-in-rs">\((19.3)\)</a> evaluates to the
expected term <span class="math inline">\(I_0\)</span>.</p>
<p>It remains to consider the case <span class="math inline">\(n
\geqslant 3\)</span>. By the same calculation as in the above evaluation
of <span class="math inline">\(J\)</span>, we may write <span
class="math inline">\(J_{1+}&#39; = J_1 + J_{2+}\)</span>, where <span
class="math display">\[J_1(g) := \int _{h \in
[{\mathop{\mathrm{GL}}}_{n-2}]} |W_{\varphi,U_{n-1}}^{(1)}(h g)|^2 \,
\frac{d h}{|\det h|^2},\]</span> <span class="math display">\[J_{2+}(g)
=
    \int _{h \in [{\mathop{\mathrm{GL}}}_{n-2}]}
    \sum _{\gamma \in P_{n-2}(F) \backslash
{\mathop{\mathrm{GL}}}_{n-2}(F)}
    |W_\varphi^{(2)}(\gamma h g)|^2 \, \frac{d h}{|\det h|^2}.\]</span>
The contribution of <span class="math inline">\(J_1\)</span> to <a
href="#eq:int-_g-in-rs" data-reference-type="eqref"
data-reference="eq:int-_g-in-rs">\((19.3)\)</a> is the expected
term <span class="math inline">\(I_1\)</span>, so it remains to
understand the contribution of <span
class="math inline">\(J_{2+}\)</span>. For this we proceed exactly as in
the analysis of <span class="math inline">\(J_{1+}\)</span>. We first
use that <span class="math inline">\(P_{n-2} \backslash
{\mathop{\mathrm{GL}}}_{n-2} \cong P_{n}^{(2)} \backslash
P_n^{(1)}\)</span> to unfold <span id="eq:int-_g-in-2-b" class="math display">\[\label{eq:int-_g-in-2-b}\tag{19.4}
    \int _{g \in P_n{(1)}(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A}) } \phi(e_n g) J_{2+}(g) \, d g
    =
    \int _{g \in P_{n}^{(2)}(\mathbb{A}) \backslash
{\mathop{\mathrm{GL}}}_n(\mathbb{A})}
    \phi(e_n g)
    J_{2+}&#39;(g) \, d g,\]</span> where <span
class="math display">\[J_{2+}&#39;(g) := \int _{p \in [P_{n-2}]}
\left\lvert W_\varphi^{(2)}(p g) \right\rvert^2 \, \frac{d p}{|\det
p|^2}.\]</span> If <span class="math inline">\(n = 3\)</span>, then
<span class="math inline">\(P_{n}^{(2)} = N_n\)</span>, <span
class="math inline">\(P_{n-2}\)</span> is trivial, and <span
class="math inline">\(W_{\varphi}^{(2)} = W_\varphi\)</span>, so <a
href="#eq:int-_g-in-2-b" data-reference-type="eqref"
data-reference="eq:int-_g-in-2-b">\((19.4)\)</a> evaluates to
the expected term <span class="math inline">\(I_2\)</span>. In the
remaining case <span class="math inline">\(n &gt; 3\)</span>, we iterate
as above. ◻</p>
</div>
<h4 id="sec:reform-terms-const-1">§19.6. Reformulation in terms of constant
terms</h4>
<p>The definitions of §<a href="#sec:part-whitt-transf"
data-reference-type="ref" data-reference="sec:part-whitt-transf">2.4</a>
were convenient for writing the proof of Proposition <a
href="#prop:sub-gln:let-varphi-in-preilm-unfold"
data-reference-type="ref"
data-reference="prop:sub-gln:let-varphi-in-preilm-unfold">278</a>, but
in our applications, a different description of the quantities <span
class="math inline">\(W_{\varphi,U_{n-j-1}}^{(j)}\)</span> is
convenient.</p>
<p>Set <span class="math inline">\(G := {\mathop{\mathrm{GL}}}_n\)</span>.
We return to our standard practice of denoting by <span
class="math inline">\(B = N A\)</span> the standard upper-triangular
Borel subgroup, with Levi <span class="math inline">\(A\)</span> given
by the diagonal subgroup. Thus <span class="math inline">\(N =
N_n\)</span> in the notation above.</p>
<p>For each <span class="math inline">\(m \in \{1, \dotsc,
n-1\}\)</span>, let <span class="math inline">\(P_{(m,n-m)}\)</span>
denote the standard upper-triangular parabolic subgroup of <span
class="math inline">\(G\)</span> with Levi component <span
class="math inline">\(M_{(m,n-m)}\)</span> given by the block-diagonal
product <span class="math inline">\({\mathop{\mathrm{GL}}}_m \times
{\mathop{\mathrm{GL}}}_{n-m}\)</span>. Let <span
class="math inline">\(U_{(m,n-m)}\)</span> denote its unipotent radical.
By a <em>standard maximal parabolic subgroup</em> <span
class="math inline">\(P = M U_P\)</span> of <span
class="math inline">\(G := {\mathop{\mathrm{GL}}}_n\)</span>, we mean that
<span class="math inline">\((P,M,U_P) = (P_{(m,n-m)}, M_{(m,n-m)},
U_{(m,n-m)})\)</span> for some <span class="math inline">\(m\)</span>.
In that case, we may factor <span class="math inline">\(M = M&#39;
\times M&#39;&#39;\)</span>, where <span class="math inline">\(M&#39; =
{\mathop{\mathrm{GL}}}_m\)</span> and <span
class="math inline">\(M&#39;&#39; \cong
{\mathop{\mathrm{GL}}}_{n-m}\)</span>, with the latter included now as the
lower-right block. Set <span class="math inline">\(N&#39;&#39; := N_n
\cap M&#39;&#39;\)</span>, and define <span
class="math inline">\(j\)</span> by writing <span
class="math inline">\(m = n -j - 1\)</span>. Then <span
class="math display">\[W_{\varphi,U_{n-j}}^{(j)}(g)
  = \int _{u \in [N&#39;&#39;]}
  \varphi_{P}(u g) \psi^{-1}(u) \, d u,\]</span> where <span
class="math inline">\(\varphi_P\)</span> denotes the constant term <span
class="math inline">\(\varphi_{P}(g) := \int _{u \in [U_P]} \varphi(u g)
\, d u\)</span> as defined in §<a href="#sec:constant-terms"
data-reference-type="ref"
data-reference="sec:constant-terms">2.15.5</a>. Proposition <a
href="#prop:sub-gln:let-varphi-in-preilm-unfold"
data-reference-type="ref"
data-reference="prop:sub-gln:let-varphi-in-preilm-unfold">278</a> thus
admits the following reformulation: the difference <span
class="math inline">\(\int _{[{\mathop{\mathrm{GL}}}_n]} |\varphi|^2
\theta_\phi - \int _{N(\mathbb{A}) \backslash G(\mathbb{A})} \phi
|W_\varphi|^2\)</span> coincides with the following sum, taken over all
standard maximal parabolic subgroups <span
class="math inline">\(P\)</span> of <span
class="math inline">\(G\)</span>: <span id="eq:sum_-p-=" class="math display">\[\label{eq:sum_-p-=}\tag{19.5}
\sum_{
    P = M U_P
  }
  \int _{g \in (M&#39; N&#39;&#39; U_P \backslash G)(\mathbb{A})}
  \phi (g)
  \int _{h \in [M&#39;]}
  \left\lvert
    \int _{u \in [N&#39;&#39;]}
    \varphi_P(h u g) \psi^{-1}(u) \, d u
\right\rvert^2 \, \frac{d h}{\delta_{U_P}(h)} \, d g.\]</span></p>
<h4 id="partial-whittaker-functions-of-pseudo-eisenstein-series">Partial
Whittaker functions of pseudo Eisenstein series</h4>
<p>We specialize henceforth to <span class="math inline">\(G =
{\mathop{\mathrm{GL}}}_n\)</span>, with accompanying notation as in §<a
href="#sec:reform-terms-const-1" data-reference-type="ref"
data-reference="sec:reform-terms-const-1">2.6</a>. Let <span
class="math inline">\(W\)</span> denote the Weyl group for <span
class="math inline">\((G,A)\)</span>.</p>
<div id="lem:sub-gln:let-phi-in-eval-W-eis" class="lemma">
<p><strong>Lemma 281</strong>. Let <span class="math inline">\(\Phi \in
\mathcal{S}([G]_B)\)</span>, <span class="math inline">\(\varphi :=
{\mathop{\mathrm{Eis}}}_B^G(\Phi)\)</span>. Then <span
class="math inline">\(W_{\varphi} = W_{\Phi}\)</span>, where, with <span
class="math inline">\(w_G \in W \hookrightarrow G(F)\)</span> the long
Weyl element, <span class="math display">\[W_\Phi(g) := \int _{u \in
N(\mathbb{A})} \Phi(w_G^{-1} u g) \psi^{-1}(u) \, d u.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a case of the standard unfolding calculation
recalled earlier in §<a href="#sec:whittaker-functions"
data-reference-type="ref"
data-reference="sec:whittaker-functions">2.15.3</a>. ◻</p>
</div>
<div id="lem:sub-gln:let-p-=" class="lemma">
<p><strong>Lemma 282</strong>. Let <span class="math inline">\(P = M
{U_P}\)</span> be a standard maximal parabolic subgroup of <span
class="math inline">\(G\)</span>, with accompanying notation as above.
Let <span class="math inline">\(\Phi \in
\mathcal{S}([M]_{B_M})\)</span>, <span class="math inline">\(\varphi :=
{\mathop{\mathrm{Eis}}}_{B_M}^{M}(\Phi)\)</span>. Assume that for each
<span class="math inline">\(w&#39; \in W_{M&#39;}\)</span>, we have
<span class="math inline">\(M_{w&#39;} \Phi \in
\mathcal{S}([M]_{B_M})\)</span>. Then, writing <span
class="math inline">\(w_{M&#39;&#39;} \in W_{M&#39;&#39;}
\hookrightarrow M&#39;&#39;(F)\)</span> for the long Weyl element, <span
class="math display">\[\begin{align}
    &amp;\int _{h \in [M&#39;]}
    \left\lvert \int _{u \in [N&#39;&#39;]}
      \varphi(h u) \psi^{-1}(u) \, d u
    \right\rvert^2
    \, d h \\
    &amp;\quad =
    \frac{1}{|W_{M&#39;}|}
    \int _{h \in [M&#39;]_{B_{M&#39;}}}
      \left\lvert
      \sum _{w \in W_{M&#39;}}
      \int _{u \in N&#39;&#39;(\mathbb{A})}
      M_w \Phi (h w_{M&#39;&#39;}^{-1} u)
      \psi^{-1}(u) \, d u
    \right\rvert^2
     \, d h.
  
\end{align}\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> For <span class="math inline">\(w \in
W_{M&#39;}\)</span>, we may define (§<a
href="#sec:basic-definition-intertwining-ops" data-reference-type="ref"
data-reference="sec:basic-definition-intertwining-ops">2.13.1</a>) an
intertwining operator <span class="math inline">\(M_w\)</span> on both
<span class="math inline">\(\mathcal{S}([M&#39;]_{B_{M&#39;}})\)</span>
and – via the inclusion <span class="math inline">\(W_{M&#39;}
\hookrightarrow W_M\)</span> – on <span
class="math inline">\(\mathcal{S}([M]_{B_{M}})\)</span>. These operators
are compatible in the sense that the diagram <span
class="math display">\[\begin{CD}         
    \mathcal{S}([M]_{B_{M}}) @&gt;M_w&gt;&gt;\mathcal{T}([M]_{B_M})\\
    @V\text{restriction}VV  @VV\text{restriction}V \\
    \mathcal{S}([M&#39;]_{B_{M&#39;}} @&gt;&gt;M_w&gt;
\mathcal{T}([M&#39;]_{B_{M&#39;}})\\
  \end{CD}\]</span> commutes.</p>
<p>Turning to the proof of the proposition, consider first the case of a
pure tensor <span class="math inline">\(\Phi = \Phi &#39; \otimes \Phi
&#39;&#39;\)</span>, i.e., <span class="math inline">\(\Phi(m&#39;
m&#39;&#39;) = \Phi &#39; (m&#39;) \Phi &#39;&#39;(m&#39;&#39;)\)</span>
for <span class="math inline">\((m&#39;, m&#39;&#39;) \in
M&#39;(\mathbb{A}) \times M&#39;&#39;(\mathbb{A})\)</span>, where</p>
<ul>
<li><p><span class="math inline">\(\Phi &#39; \in
\mathcal{S}([M&#39;]_{B_{M&#39;}})\)</span> satisfies <span
class="math inline">\(M_{w&#39;} \Phi &#39; \in
\mathcal{S}([M&#39;]_{B_{M&#39;}})\)</span> for all <span
class="math inline">\(w&#39; \in W_{M&#39;}\)</span>, and</p></li>
<li><p><span class="math inline">\(\Phi &#39;&#39; \in
\mathcal{S}([M&#39;&#39;]_{B_{M&#39;&#39;}})\)</span>.</p></li>
</ul>
<p>Then <span class="math inline">\(\varphi = \varphi &#39; \otimes
\varphi &#39;&#39;\)</span> with <span class="math inline">\(\varphi
&#39; = {\mathop{\mathrm{Eis}}}_{B_{M&#39;}}^{M&#39;}(\Phi
&#39;)\)</span>, <span class="math inline">\(\varphi &#39;&#39; =
{\mathop{\mathrm{Eis}}}_{B_{M&#39;&#39;}}^{M&#39;&#39;}(\Phi
&#39;&#39;)\)</span>, so the claimed identity reads <span
class="math display">\[\begin{align}
  &amp;\int _{[M&#39;] } |\varphi &#39;|^2
    \cdot \left\lvert \int _{u \in [N&#39;&#39;]} \varphi &#39;&#39;(u)
\psi^{-1}(u) \, d u  \right\rvert^2 \\
  &amp;\quad
    =
    \frac{1}{|W_{M&#39;}|}
    \int _{[M&#39;]_{B_{M&#39;}}} \left\lvert \sum_{w \in W_{M&#39;}}
M_w \Phi &#39; \right\rvert^2
    \cdot
    \left\lvert \int _{u \in N&#39;&#39;(\mathbb{A} )}
    \Phi &#39;&#39;(w_{M&#39;&#39;}^{-1} u) \psi^{-1}(u) \, d u
    \right\rvert^2
\end{align}\]</span> and follows from Proposition <a
href="#lem:let-f_1-f_2" data-reference-type="ref"
data-reference="lem:let-f_1-f_2">25</a> (resp. Lemma <a
href="#lem:sub-gln:let-phi-in-eval-W-eis" data-reference-type="ref"
data-reference="lem:sub-gln:let-phi-in-eval-W-eis">281</a>) applied to
<span class="math inline">\(M&#39;\)</span> (resp. <span
class="math inline">\(M&#39;&#39;\)</span>).</p>
<p>The general case may be deduced in a couple ways.</p>
<ul>
<li><p>We may reduce, as follows, to the case of pure tensors: both
sides depend continuously upon <span
class="math inline">\(\Phi\)</span>, and as explained in <a href="#ref-2020arXiv200705601B"
class="citation" data-cites="2020arXiv200705601B">(Raphaël
Beuzart-Plessis, Chaudouard, and Zydor 2020, sec. 2.5.9)</a>, for
each pair of compact open subgroups <span class="math inline">\(J&#39;
&lt; M&#39;(\mathbb{A}^\infty)\)</span> and <span
class="math inline">\(J&#39;&#39; &lt;
M&#39;&#39;(\mathbb{A}^\infty)\)</span> with product <span
class="math inline">\(J := J&#39; \times J&#39;&#39; &lt;
M(\mathbb{A}^\infty)\)</span>, we may identify <span
class="math inline">\(\mathcal{S}([M]_{B_M})^J\)</span> with the
completed tensor product of nuclear Fr<span>é</span>chet spaces <span
class="math inline">\(\mathcal{S}([M&#39;]_{B_{M&#39;}})^{J&#39;}
\hat{\otimes}
\mathcal{S}([M&#39;&#39;]_{B_{M&#39;&#39;}})^{J&#39;&#39;}\)</span>.</p></li>
<li><p>We can apply the proof given in the pure tensor case to the
general case. Indeed, by Lemma <a
href="#lem:sub-gln:let-phi-in-eval-W-eis" data-reference-type="ref"
data-reference="lem:sub-gln:let-phi-in-eval-W-eis">281</a>, we have
<span id="eq:int-_u-in-1" class="math display">\[\label{eq:int-_u-in-1}\tag{19.6}
    \int _{u \in [N&#39;&#39;]} \varphi(h u) \psi^{-1}(u) \, d u
    =
    \sum _{\gamma \in B_{M&#39;}(F) \backslash M&#39;(F)}
    \int _{u \in N&#39;&#39;(\mathbb{A})}
    \Phi(\gamma h u)
    \psi^{-1}(u) \,  d u,\]</span> where the RHS converges absolutely.
For <span class="math inline">\(u_1, u_2 \in [N&#39;&#39;]\)</span>,
define <span class="math inline">\(\Phi_1, \Phi_2 \in
\mathcal{S}([M&#39;]_{B_{M&#39;}})\)</span> by <span
class="math inline">\(\Phi_j(m&#39;) := \Phi(u_j m&#39;) = \Phi(m&#39;
u_j)\)</span>. Then for <span class="math inline">\(j =1,2\)</span> and
<span class="math inline">\(w \in W_{M&#39;}\)</span>, our assumption on
<span class="math inline">\(\Phi_j\)</span> (and the noted compatibility
of the definitions of <span class="math inline">\(M_w\)</span>) implies
that <span class="math inline">\(M_w \Phi_j \in
\mathcal{S}([M&#39;]_{B_{M&#39;}})\)</span>. By Proposition <a
href="#lem:let-f_1-f_2" data-reference-type="ref"
data-reference="lem:let-f_1-f_2">25</a>, it follows that <span
class="math display">\[\begin{align}
    &amp;\int _{h \in [M&#39;]}
    \sum _{\gamma_1, \gamma_2 \in B_{M&#39;}(F) \backslash M&#39;(F)}
    \Phi_1(\gamma_1 h u_1)
    \overline{\Phi_2}(\gamma_2 h u_2) \, d h \\
    &amp;\quad =
    \frac{1}{|W_{M&#39;}|}
    \sum _{w_1, w_2 \in W_{M&#39;}}
    \int _{h \in [M&#39;]_{B_{M&#39;}}}
    M_{w_1} \Phi_1(h)
    \overline{M_{w_2} \Phi_2(h)} \, d h.
  
\end{align}\]</span> We conclude by inserting the definitions of <span
class="math inline">\(\Phi_1, \Phi_2\)</span> and integrating over <span
class="math inline">\(u_1, u_2 \in N&#39;&#39;(\mathbb{A})\)</span> as
in <a href="#eq:int-_u-in-1" data-reference-type="eqref"
data-reference="eq:int-_u-in-1">\((19.6)\)</a>. We emphasize that
at each stage of the proof, every iterated sum/integral converges
absolutely, thanks in each case to the locally uniform convergence of
pseudo Eisenstein series on <span
class="math inline">\(M\)</span>.</p></li>
</ul>
<p> ◻</p>
</div>
<p>We note that Lemma <a href="#lem:sub-gln:let-p-="
data-reference-type="ref" data-reference="lem:sub-gln:let-p-=">282</a>
applies also to the apparently more general integrals obtained by
multiplying the integrand by a positive-valued character evaluated at
<span class="math inline">\(h\)</span>, e.g., <span
class="math display">\[\int _{h \in [M&#39;]}
  \left\lvert \int _{u \in [N&#39;&#39;]} \varphi(h u) \psi^{-1}(u) \,d
u  \right\rvert^2
  \, \frac{d h}{\delta_{U_P}(h)}.\]</span> To obtain a formula for such
integrals, we apply Lemma <a href="#lem:sub-gln:let-p-="
data-reference-type="ref" data-reference="lem:sub-gln:let-p-=">282</a>
with <span class="math inline">\(\Phi\)</span> replaced by <span
class="math inline">\(\Phi \delta_{U_P}^{-1/2}\)</span>, noting that
multiplication by <span
class="math inline">\(\delta_{U_P^{-1/2}}\)</span> commutes with the
intertwining operators <span class="math inline">\(M_w\)</span>.</p>
<h4 id="sec:summary-unification">§19.8. Summary</h4>
<p>To unify the presentation, we extend the notation introduced in §<a
href="#sec:reform-terms-const-1" data-reference-type="ref"
data-reference="sec:reform-terms-const-1">2.6</a> from the case that
<span class="math inline">\(P\)</span> is a standard maximal parabolic
subgroup to the case <span class="math inline">\(P = G\)</span>. In that
case, we set <span class="math display">\[M&#39; := \{1\}, \quad
M&#39;&#39; := G, \quad
  {U_P} = \{1\},\]</span> and take <span
class="math inline">\(N&#39;\)</span> and <span
class="math inline">\(N&#39;&#39;\)</span> as before.</p>
<p>For <span class="math inline">\(P\)</span> maximal parabolic or <span
class="math inline">\(P = G\)</span> and <span
class="math inline">\(\Phi \in \mathcal{S}([G]_B)\)</span>, we define
<span class="math inline">\(W^P[\Phi] \in
C^\infty(G(\mathbb{A}))\)</span> by the formula <span
class="math display">\[W^P[\Phi](g) := \int _{u \in
N&#39;&#39;(\mathbb{A}) } \Phi(w_{M&#39;&#39;}^{-1} u g) \psi^{-1}(u) \,
d u.\]</span> For example, <span class="math inline">\(W^G[\Phi] :=
W_{\Phi}\)</span> as defined in Lemma <a
href="#lem:sub-gln:let-phi-in-eval-W-eis" data-reference-type="ref"
data-reference="lem:sub-gln:let-phi-in-eval-W-eis">281</a>.</p>
<p>We recall the set <span class="math inline">\(W(A,M)\)</span>,
defined following <a href="#eq:eis_bgf_p-=-sum"
data-reference-type="eqref"
data-reference="eq:eis_bgf_p-=-sum">\((2.46)\)</a> in our
preliminary discussion of constant terms of Eisenstein series.</p>
<div id="prop:sub-gln:let-phi-in-summary" class="proposition">
<p><strong>Proposition 283</strong>. <em>Let <span
class="math inline">\(\phi \in C_c^\infty(V_n(\mathbb{A}))\)</span> and
<span class="math inline">\(\Phi \in \mathcal{S}([G]_B)\)</span>. Assume
that <span class="math inline">\(M_w \Phi \in
\mathcal{S}([G]_B)\)</span> for each <span class="math inline">\(w \in
W\)</span>. Then <span id="prop:=-sum_p-=" class="math display">\[\begin{align}
     \int _{[G]} \theta_\phi
|\mathop{\mathrm{Eis}}(\Phi)|^2  \label{prop:=-sum_p-=}\tag{19.7}
    &amp;=
     \sum_{P = M {U_P}}
      \int _{g \in (M&#39; N&#39;&#39; {U_P} \backslash G)(\mathbb{A}) }
\phi(e_n g) \\ \nonumber
    &amp;\quad
      \frac{1}{|W_{M&#39;}|}
     \int _{h \in [M&#39;]_{B_{M&#39;}}}
     \left\lvert
       \sum _{w&#39; \in W_{M&#39;}}
     \sum _{w \in W(A,M)}
       W^P[M_{w&#39; w} \Phi](h g)
     \right\rvert^2
     \, \frac{d h}{\delta_{U_P}(h)}
     \, d g,
  
\end{align}\]</span> where <span class="math inline">\(P\)</span> runs
over <span class="math display">\[\{\text{standard maximal parabolic
subgroups $P$ of $G$}\} \cup \{G\}.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> We first apply Proposition <a
href="#prop:sub-gln:let-varphi-in-preilm-unfold"
data-reference-type="ref"
data-reference="prop:sub-gln:let-varphi-in-preilm-unfold">278</a>, as
reformulated in §<a href="#sec:reform-terms-const-1"
data-reference-type="ref"
data-reference="sec:reform-terms-const-1">2.6</a>, to evaluate the LHS
of <a href="#prop:=-sum_p-=" data-reference-type="eqref"
data-reference="prop:=-sum_p-=">\((19.7)\)</a>. The integral <span
class="math inline">\(\int _{N(\mathbb{A}) \backslash G(A)} \phi
|W_\varphi|^2\)</span> matches up with the <span class="math inline">\(P
= G\)</span> contribution to the RHS of <a href="#prop:=-sum_p-="
data-reference-type="eqref"
data-reference="prop:=-sum_p-=">\((19.7)\)</a>, since in that case
<span class="math inline">\(M&#39;\)</span>, <span
class="math inline">\(U_P\)</span> and the set <span
class="math inline">\(W(A,M)\)</span> are all trivial. Following <a
href="#eq:sum_-p-=" data-reference-type="eqref"
data-reference="eq:sum_-p-=">\((19.5)\)</a>, it remains to check that
for <span class="math inline">\(P \neq G\)</span> and all <span
class="math inline">\(g \in G(\mathbb{A})\)</span>, <span
class="math display">\[\begin{align}
  &amp;\int _{h \in [M&#39;]}
    \left\lvert
    \int _{u \in [N&#39;&#39;]}
    \mathop{\mathrm{Eis}}(\Phi)_P(h u g) \psi^{-1}(u) \, d u
    \right\rvert^2 \, \frac{d h}{\delta_{U_P}(h)} \\
  &amp;\quad =
    \frac{1}{|W_{M&#39;}|}
    \int _{h \in [M&#39;]_{B_{M&#39;}}}
    \left\lvert
    \sum _{
    \substack{
    w&#39; \in W_{M&#39;}  \\
  w \in W(A,M)
  }
  }
  W^P[M_{w&#39; w} \Phi](h g)
  \right\rvert^2
  \, \frac{d h}{\delta_{U_P}(h)}.
\end{align}\]</span> To that end, we first apply the constant term
formula <a href="#eq:eis_bgf_p-=-sum" data-reference-type="eqref"
data-reference="eq:eis_bgf_p-=-sum">\((2.46)\)</a> to evaluate
<span class="math display">\[\mathop{\mathrm{Eis}}(\Phi)_P(h u g)
  = \sum _{w \in W(A,M)} {\mathop{\mathrm{Eis}}}_{B_M}^M(M_w f)(h u
g).\]</span> We next apply the bilinearization of Lemma <a
href="#lem:sub-gln:let-p-=" data-reference-type="ref"
data-reference="lem:sub-gln:let-p-=">282</a> to the elements <span
class="math inline">\(\Phi_1, \Phi_2 \in \mathcal{S}([M]_{B_M})\)</span>
defined, for <span class="math inline">\(w_1, w_2 \in W(A,M)\)</span>,
by <span class="math display">\[\Phi_1(m) :=  M_{w_1} f(m g), \quad
  \Phi_2(m) :=  M_{w_2} f(m g).\]</span> Summing up the result of that
application, we obtain <span class="math display">\[\begin{align}
  &amp;\int _{h \in [M&#39;]}
    \left\lvert
    \int _{u \in [N&#39;&#39;]}
    \mathop{\mathrm{Eis}}(\Phi)_P(h u g) \psi^{-1}(u) \, d u
    \right\rvert^2 \, \frac{d h}{\delta_{U_P}(h)} \\
  &amp;\quad =
    \frac{1}{|W_{M&#39;}|}
    \int _{h \in [M&#39;]_{B_{M&#39;}}}
    \left\lvert
    \sum _{
    \substack{
    w&#39; \in W_{M&#39;}  \\
   w \in W(A,M)
  }
  }
  \int _{u \in N&#39;&#39;(\mathbb{A})}
  M_{w&#39; w} \Phi (h w_{M&#39;&#39;}^{-1} u g)
  \psi^{-1}(u) \, d u
  \right\rvert^2
  \, \frac{d h}{\delta_{U_P}(h)}.
\end{align}\]</span> Since <span
class="math inline">\(M&#39;(\mathbb{A})\)</span> and <span
class="math inline">\(M&#39;&#39;(\mathbb{A})\)</span> commute, we have
<span class="math display">\[\begin{align}
  \int _{u \in N&#39;&#39;(\mathbb{A})}
  M_{w&#39; w} \Phi (h w_{M&#39;&#39;}^{-1} u g)
  \psi^{-1}(u) \, d u
  &amp;=
  \int _{u \in N&#39;&#39;(\mathbb{A})}
  M_{w&#39; w} \Phi (w_{M&#39;&#39;}^{-1} u h g)
    \psi^{-1}(u) \, d u \\
  &amp;= W^P[M_{w&#39; w} \Phi](h g).  
\end{align}\]</span> The required identity follows. ◻</p>
</div>
<h3 id="sec:reduction-proof">§20. Reduction of the proof</h3>
<p>Throughout this section we consider fixed general linear groups over
<span class="math inline">\(\mathbb{R}\)</span> or <span
class="math inline">\(\mathbb{Z}\)</span>. We denote by <span
class="math inline">\(\psi\)</span> the standard nondegenerate unitary
character of <span class="math inline">\(N\)</span> (when working over
<span class="math inline">\(\mathbb{R}\)</span>) or of <span
class="math inline">\(N(\mathbb{A})\)</span> (when working over <span
class="math inline">\(\mathbb{Z}\)</span>), as described in §<a
href="#sec:stand-nond-char" data-reference-type="ref"
data-reference="sec:stand-nond-char">2.11</a>. In particular, when
applying the results of §<a href="#sec:rank-selb-unfold"
data-reference-type="ref" data-reference="sec:rank-selb-unfold">2</a>,
we employ this choice of <span class="math inline">\(\psi\)</span>.</p>
<h4 id="a-class-of-local-vectors">A class of local vectors</h4>
<p>Let <span class="math inline">\(T\)</span> be a positive parameter
with <span class="math inline">\(T \ggg 1\)</span>. Let <span
class="math inline">\(G\)</span> be a fixed general linear group over
<span class="math inline">\(\mathbb{R}\)</span>.</p>
<h5 id="basic-definition-2">Basic definition</h5>
<div class="definition">
<p><strong>Definition 284</strong>. Let <span
class="math inline">\(\mathfrak{E}(N \backslash G, T)\)</span> denote
the class of all <span class="math inline">\(f \in \mathcal{S}^e(N
\backslash G)\)</span> such that for each fixed compact subset <span
class="math inline">\(\mathcal{D}\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span> and fixed <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, we
have, with notation as in §<a href="#sec:local-sobolev-norms-prelims"
data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a>, <span
class="math display">\[\nu_{\mathcal{D},\ell,T}(f) \ll
T^{o(1)}.\]</span> We set <span class="math display">\[\mathfrak{E}(N
\backslash G, T)^W := \mathfrak{E}(N \backslash G, T) \cap
\mathcal{S}^e(N \backslash G)^W,\]</span> with notation as in §<a
href="#sec:fourier-transforms" data-reference-type="ref"
data-reference="sec:fourier-transforms">2.13.2</a> (recalling the
general convention <span class="math inline">\(U = N\)</span> of Part <a
href="#part:local-l2-growth" data-reference-type="ref"
data-reference="part:local-l2-growth"></a>, and recall Remark <a
href="#rmk:we-note-that-dependence-psi-w" data-reference-type="ref"
data-reference="rmk:we-note-that-dependence-psi-w">16</a> concerning
<span class="math inline">\(\mathcal{S}^e(N \backslash
G)^W\)</span>).</p>
</div>
<p>The informal content of this definition is that an element <span
class="math inline">\(f \in \mathcal{S}^e(N \backslash G)\)</span>
belongs to <span class="math inline">\(\mathfrak{E}(N \backslash G,
T)\)</span> if it is “concentrated near <span
class="math inline">\(T^{-\rho^\vee} K\)</span>, with <span
class="math inline">\(A\)</span>-frequency <span
class="math inline">\(\operatorname{O}(1)\)</span> and <span
class="math inline">\(G\)</span>-frequency <span
class="math inline">\(\operatorname{O}(T)\)</span>, and essentially
<span class="math inline">\(L^2\)</span>-normalized.” This informal
description is made precise by the following lemmas.</p>
<div id="itm:lemma-class-frak-E-basic:3" class="lemma">
<p><strong>Lemma 285</strong>. <span
id="lem:standard:frakE-equivalences"
label="lem:standard:frakE-equivalences"></span> For <span
class="math inline">\(f \in \mathcal{S}^e(N \backslash G)\)</span>, the
following are equivalent.</p>
<ol type="i">
<li><p><span id="itm:lemma-class-frak-E-basic:1"
label="itm:lemma-class-frak-E-basic:1"></span> <span
class="math inline">\(f \in \mathfrak{E}(N \backslash G,
T)\)</span>.</p></li>
<li><p><span id="itm:lemma-class-frak-E-basic:2"
label="itm:lemma-class-frak-E-basic:2"></span> For all <span
class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span> with
<span class="math inline">\(\Re(s) \ll 1\)</span>, fixed <span
class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span> and fixed
<span class="math inline">\(y_1,\dotsc,y_m \in
\mathop{\mathrm{Lie}}(G)\)</span>, we have <span id="eq:x_1-dotsb-x_m" class="math display">\[\label{eq:x_1-dotsb-x_m}\tag{20.1}
    \|R(y_1 \dotsb y_m) f[s]\| \ll T^{\rho^\vee(s) + m + o(1)} \langle s
\rangle^{-\infty}.\]</span></p></li>
<li><p>For all fixed <span class="math inline">\(x \in
\mathfrak{U}(A)\)</span>, fixed <span class="math inline">\(m \in
\mathbb{Z}_{\geqslant 0}\)</span> and fixed <span
class="math inline">\(y_1,\dotsc,y_m \in
\mathop{\mathrm{Lie}}(G)\)</span>, we have for all <span
class="math inline">\((a,k) \in A \times K\)</span> the estimate <span id="eq:int-_k-in" class="math display">\[\label{eq:int-_k-in}\tag{20.2}
    \int _{k \in K}
    \left\lvert
      L(x) R(y_1 \dotsb y_m) f(a k)
    \right\rvert^2 \, d k
    \ll
    \delta_N(a)
    \|T^{\rho^\vee} a\|^{-\infty}
    T^{2 m + o(1)}.\]</span></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> The equivalence between <a
href="#itm:lemma-class-frak-E-basic:1" data-reference-type="eqref"
data-reference="itm:lemma-class-frak-E-basic:1">\((i)\)</a>
and <a href="#itm:lemma-class-frak-E-basic:2"
data-reference-type="eqref"
data-reference="itm:lemma-class-frak-E-basic:2">\((ii)\)</a>
is immediate from the definitions (specifically, that <span
class="math inline">\(\Re(s)\)</span> lies in a fixed compact set if and
only if <span class="math inline">\(\Re(s) \ll 1\)</span>).</p>
<p>We now verify the equivalence between <a
href="#itm:lemma-class-frak-E-basic:2" data-reference-type="eqref"
data-reference="itm:lemma-class-frak-E-basic:2">\((ii)\)</a>
and <a href="#itm:lemma-class-frak-E-basic:3"
data-reference-type="eqref"
data-reference="itm:lemma-class-frak-E-basic:3">\((iii)\)</a>
(which may be understood as a form of Paley–Wiener theory for certain
vector-valued functions on <span class="math inline">\(A\)</span>). For
each <span class="math inline">\(\sigma \in \mathfrak{a}^*\)</span>, we
have the Mellin expansion <span class="math display">\[\begin{align}
    f(a k)
    &amp;= \int _{\Re(s) = \sigma } |a|^{s + \rho} f[s](k) \, d \mu_A(s)
\\
    &amp;= \int _{\Re(s) = \sigma } |a|^{\rho^\vee} \left\lvert a T
^{\rho ^\vee } \right\rvert^{s} \frac{f[s](k)}{T^{\rho^\vee(s)}} \, d
\mu_A(s),
    
\end{align}\]</span> and also its variant for derivatives: for <span
class="math inline">\((x,y) \in \mathfrak{U}(A) \times
\mathfrak{U}(G)\)</span>, <span class="math display">\[L(x) R(y) f(a k)
=
      \int _{\Re(s) = \sigma }
    \langle x, s \rangle
    |a|^{\rho^\vee} \left\lvert a T ^{\rho ^\vee } \right\rvert^{s}
\frac{R(y) f[s](k)}{T^{\rho^\vee(s)}} \, d \mu_A(s).\]</span> Here <span
class="math inline">\(x \mapsto \langle x, s \rangle\)</span> denotes
the algebra functional attached to <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span>. Abbreviate <span
class="math inline">\(\left\langle s \right\rangle := 1 + |s|\)</span>.
Fix <span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant
0}\)</span> so that <span class="math inline">\(\int _{\Re(s) = \sigma}
\left\langle s \right\rangle^{-\ell} &lt; \infty\)</span>. Then by
Cauchy–Schwarz, <span id="eq:lx-ry-fa" class="math display">\[\label{eq:lx-ry-fa}\tag{20.3}
    |L(x) R(y) f(a k)|^2 \leqslant
    \delta_N(a)
    \left\lvert a T ^{\rho ^\vee } \right\rvert^{2 \sigma }
    \int _{\Re(s) = \sigma }
    \left\langle s \right\rangle^{-\ell}
    \left\lvert \langle x, s \rangle \right\rvert^2
    \left\lvert \frac{R(y) f[s](k)}{T^{\rho^\vee(s)}} \right\rvert^2
     \, d \mu_A(s).\]</span> Integrating this inequality over <span
class="math inline">\(k \in K\)</span> and taking <span
class="math inline">\(\sigma \in \mathfrak{a}^*\)</span> fixed but
arbitrary, we see that condition <a
href="#itm:lemma-class-frak-E-basic:2" data-reference-type="eqref"
data-reference="itm:lemma-class-frak-E-basic:2">\((ii)\)</a>
implies condition <a href="#itm:lemma-class-frak-E-basic:3"
data-reference-type="eqref"
data-reference="itm:lemma-class-frak-E-basic:3">\((iii)\)</a>.
A similar argument, using the Mellin identity <span
class="math display">\[\langle x,  s \rangle
    \frac{R(y) f[s](k)}{T^{\rho^\vee(s)}}
    =
    \int _{a \in A}
    \left\lvert a T^{\rho^\vee} \right\rvert^{-s}
    |a|^{-\rho^\vee} L(x) R(y) f(a k) \, d a\]</span> and
Cauchy–Schwarz, gives the converse implication. ◻</p>
</div>
<div id="lem:f-in-mathfraken-square-integral-frakE" class="lemma">
<p><strong>Lemma 286</strong>. For <span class="math inline">\(f \in
\mathfrak{E}(N \backslash G, T)\)</span>, we have for each fixed <span
class="math inline">\(\ell,m \in \mathbb{Z}_{\geqslant 0}\)</span>,
<span class="math inline">\(x \in \mathfrak{U}(A)\)</span> and <span
class="math inline">\(y_1,\dotsc,y_m \in
\mathop{\mathrm{Lie}}(G)\)</span> the estimate <span
class="math display">\[\int _{g \in N \backslash G } \|T^{\rho^\vee}
g\|_{N \backslash G}^{\ell}
    \left\lvert L(x) R(y_1 \dotsb y_m) f \right\rvert^2(g) \, d g
    \ll
    T^{2 m + o(1)}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> The LHS of the above is <span
class="math display">\[\asymp
    \int _{a \in A}
    \|T^{\rho^\vee} a\|^{\ell}
    \int _{k \in K}
    \left\lvert L(x) R(y_1 \dotsb y_m) f \right\rvert^2(a k)
    \, d k
    \, \frac{d a}{ \delta_N(a)}.\]</span> For large enough fixed <span
class="math inline">\(d \geqslant 0\)</span>, we have <span
class="math display">\[\int _{a \in A} \|T^{\rho^\vee} a\|^{-d} \, d a
    =
    \int _{a \in A} \|a\|^{-d} \, d a
    \ll 1.\]</span> Thus the required estimate follows from <a
href="#eq:int-_k-in" data-reference-type="eqref"
data-reference="eq:int-_k-in">\((20.2)\)</a>. ◻</p>
</div>
<h5 id="sec:duality">§20.1.2. Duality</h5>
<div class="definition">
<p><strong>Definition 287</strong>. Let <span class="math inline">\(w_G
\in W\)</span> denote the long Weyl element. For a function <span
class="math inline">\(f : N \backslash G \rightarrow
\mathbb{C}\)</span>, define the dual function <span
class="math inline">\(\tilde{f} : N \backslash G \rightarrow
\mathbb{C}\)</span> by the formula <span
class="math display">\[\tilde{f}(g) := f(w_G g^{-%
  {\mathpalette\@transpose{}}%
}).\]</span></p>
</div>
<div id="lem:standard:let-f-in" class="lemma">
<p><strong>Lemma 288</strong>. We have <span
class="math display">\[\begin{align}
    f \in \mathfrak{E}(N \backslash G, T) &amp;\implies \tilde{f} \in
\mathfrak{E}(N \backslash G, T), \\
    f \in \mathfrak{E}(N \backslash G, T)^W &amp;\implies \tilde{f} \in
\mathfrak{E}(N \backslash G, T)^W.
  
\end{align}\]</span></p>
</div>
<div class="remark">
<p><strong>Remark 289</strong>. We have noted that, informally, <span
class="math inline">\(\mathfrak{E}(N \backslash G,T)\)</span> consists
of functions concentrated near <span
class="math inline">\(T^{-\rho^\vee} K\)</span>, with <span
class="math inline">\(A\)</span>-frequency <span
class="math inline">\(\ll 1\)</span> and <span
class="math inline">\(G\)</span>-frequency <span
class="math inline">\(\ll T\)</span>. We have <span
class="math display">\[w_G (T^{-\rho^\vee})^{-%
  {\mathpalette\@transpose{}}%
} = T^{-\rho^\vee} w_G,
    \quad
    w_G (T^{-\rho^\vee} K)^{-%
  {\mathpalette\@transpose{}}%
} = T^{-\rho^\vee} K,\]</span> so the duality assignment <span
class="math inline">\(f \mapsto \tilde{f}\)</span> preserves the
concentration condition. It is also twisted-equivariant, hence preserves
the frequency conditions. Finally, since it comes from an automorphism
of the group, it should come as no surprise that <span
class="math inline">\(f \mapsto \tilde{f}\)</span> preserves the <span
class="math inline">\(W\)</span>-invariance condition.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By direct computation, we see that <span
class="math inline">\(\tilde{f}\)</span> defines an element of <span
class="math inline">\(\mathcal{S}^e(N \backslash G)\)</span>, with
Mellin components given by <span class="math display">\[\tilde{f}[s](g)
= f[- w_G s](w_G g^{-%
  {\mathpalette\@transpose{}}%
}).\]</span> Recalling the definitions of <span
class="math inline">\(\mathcal{F}_w\)</span> (§<a
href="#sec:fourier-transforms" data-reference-type="ref"
data-reference="sec:fourier-transforms">2.13.2</a>) and <span
class="math inline">\(\nu_{\mathcal{D},\ell,T}\)</span> (§<a
href="#sec:local-sobolev-norms-prelims" data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a>), our task is
check the following:</p>
<ol type="a">
<li><p><span id="itm:local-standard:1b"
label="itm:local-standard:1b"></span> If <span class="math inline">\(f[w
s] = \mathcal{F}_w f[s]\)</span> for all <span class="math inline">\(w
\in W\)</span>, then <span class="math inline">\(\tilde{f}[w s] =
\mathcal{F}_{w} \tilde{f}[s]\)</span> for all <span
class="math inline">\(w \in W\)</span>.</p></li>
<li><p><span id="itm:local-standard:2b"
label="itm:local-standard:2b"></span> For <span
class="math inline">\(\Re(s) \ll 1\)</span>, fixed <span
class="math inline">\(m \in \mathbb{Z}_{\geqslant 0}\)</span>, and fixed
<span class="math inline">\(x_1,\dotsc,x_m \in
\mathop{\mathrm{Lie}}(G)\)</span>, we have <span
class="math display">\[\|R(x_1 \dotsb x_m) \tilde{f}[s]\| \ll
T^{\rho^\vee(s) + m + o(1)} \langle s
\rangle^{-\infty}.\]</span></p></li>
</ol>
<p>Assertion <a href="#itm:local-standard:1b"
data-reference-type="eqref"
data-reference="itm:local-standard:1b">\((a)\)</a>
reduces to the following identity: for <span class="math inline">\(v \in
\mathcal{I}(s)\)</span>, with dual <span class="math inline">\(\tilde{v}
\in \mathcal{I}(- w_G s)\)</span> given by <span
class="math inline">\(\tilde{v}(g) := v(w_G g^{-%
  {\mathpalette\@transpose{}}%
})\)</span>, we have <span class="math display">\[W[\tilde{v},\psi](g)
=W[v, \psi^{-1}](w_G g^{-%
  {\mathpalette\@transpose{}}%
}).\]</span> To see this, we use that the involution <span
class="math inline">\(g \mapsto w_G g^{-%
  {\mathpalette\@transpose{}}%
} w_G\)</span> of <span class="math inline">\(G\)</span> preserves <span
class="math inline">\(N\)</span> and inverts <span
class="math inline">\(\psi\)</span>. Assertion <a
href="#itm:local-standard:2b" data-reference-type="eqref"
data-reference="itm:local-standard:2b">\((b)\)</a>
follows from <a href="#eq:x_1-dotsb-x_m" data-reference-type="eqref"
data-reference="eq:x_1-dotsb-x_m">\((20.1)\)</a> and the fact
that <span class="math inline">\(\langle -w_G s \rangle \asymp \langle s
\rangle\)</span> and <span class="math inline">\(\rho^\vee(-w_G s) =
\rho^\vee(s)\)</span>. ◻</p>
</div>
<h4 id="construction-of-theta-functions">Construction of theta
functions</h4>
<p>We fix a natural number <span class="math inline">\(n\)</span> and
let <span class="math inline">\(G := {\mathop{\mathrm{GL}}}_n, B, N, A,
V_n\)</span> be as in §<a href="#sec:notation-rs-unfolding"
data-reference-type="ref"
data-reference="sec:notation-rs-unfolding">2.1</a> and the beginning of
Part <a href="#part:local-l2-growth" data-reference-type="ref"
data-reference="part:local-l2-growth"></a>.</p>
<p>Let <span class="math inline">\(t \in A(\mathbb{R})^0_{\geqslant
1}\)</span>, thus <span class="math inline">\(t =
\mathop{\mathrm{diag}}(t_1,\dotsc,t_n)\)</span> with <span
class="math inline">\(t_1 \geqslant\dotsb \geqslant t_n &gt; 0\)</span>.
For each prime number <span class="math inline">\(p\)</span>, let <span
class="math inline">\(\phi_p \in C_c^\infty(V_n(\mathbb{Q}_p))\)</span>
denote the characteristic function of <span
class="math inline">\(V_n(\mathbb{Z}_p)\)</span>. We fix a compact
subset <span class="math inline">\(\Omega\)</span> of <span
class="math inline">\(G(\mathbb{R})\)</span>, and define the seminorm
<span class="math inline">\(\|.\|_{t,\Omega}\)</span> on <span
class="math inline">\(\mathcal{S}([G])\)</span> by <a
href="#eq:varphi-2_r-:=" data-reference-type="eqref"
data-reference="eq:varphi-2_r-:=">\((4.1)\)</a>.</p>
<div id="lem:sub-gln:let-r-be" class="lemma">
<p><strong>Lemma 290</strong>. There exists <span
class="math inline">\(\phi_\infty \in
C_c^\infty(V_n(\mathbb{R}))\)</span> with the following properties:</p>
<ol type="i">
<li><p><span class="math inline">\(0 \leqslant\phi_\infty \leqslant
1\)</span>. In particular, setting <span class="math inline">\(\phi :=
\otimes_{\mathfrak{p}} \phi_\mathfrak{p} \in
C_c^\infty(V_n(\mathbb{A}))\)</span>, we have <span
class="math inline">\(\theta_{\phi} \geqslant 0\)</span>.</p></li>
<li><p><span class="math inline">\(\phi_\infty\)</span> is <span
class="math inline">\(K_\infty\)</span>-invariant, hence <span
class="math inline">\(\phi\)</span> is invariant by <span
class="math inline">\(K = \prod_\mathfrak{p}
K_\mathfrak{p}\)</span>.</p></li>
<li><p>For each <span class="math inline">\(v \in
V_n(\mathbb{R})\)</span>, we have <span
class="math inline">\(\phi_\infty(v) \neq 0\)</span> only if <span
class="math inline">\(\|v\| \asymp t_n\)</span>.</p></li>
<li><p>For each <span class="math inline">\(u \in N(\mathbb{R})\)</span>
and <span class="math inline">\(g \in \Omega\)</span>, we have <span id="eq:theta_phiu-r-g" class="math display">\[\label{eq:theta_phiu-r-g}\tag{20.4}
      \theta_\phi(u t g) \geqslant 1.\]</span></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> We fix a <span
class="math inline">\([0,1]\)</span>-valued function <span
class="math inline">\(f \in C_c^\infty(\mathbb{R}^\times_+)\)</span>
taking the value <span class="math inline">\(1\)</span> on the interval
<span class="math inline">\([1/c,c]\)</span>, where <span
class="math inline">\(c &gt; 2\)</span> is fixed sufficiently large in
terms of <span class="math inline">\(\Omega\)</span>, and take <span
class="math inline">\(\phi_\infty(v) := f(t_n^{-1} \|v\|)\)</span>. The
first three properties are then clear by construction. By our choice of
the finite components <span class="math inline">\(\phi_p\)</span>, we
have <span class="math display">\[\theta_\phi(u t g) = \sum _{0 \neq v
\in V_n(\mathbb{Z})}
    \phi_\infty(v u t g).\]</span> We consider the contribution of the
basis vector <span class="math inline">\(e_n \in
V_n(\mathbb{Z})\)</span>. We have <span class="math inline">\(e_n u t g
= t_n e_n g\)</span>, thus <span class="math display">\[\theta_\phi(u t
g) \geqslant\phi_\infty(e_n u t g)
    = f(\|e_n g\|).\]</span> By our construction of <span
class="math inline">\(c\)</span> and the fact that <span
class="math inline">\(g \in \Omega\)</span>, we have <span
class="math inline">\(\|e_n g\| \in [1/c,c]\)</span>, hence <span
class="math inline">\(f( \|e_n g\|) = 1\)</span>. The required
inequality follows. ◻</p>
</div>
<div id="cor:sub-gln:let-psi-in" class="corollary">
<p><strong>Corollary 291</strong>. <em>Let <span
class="math inline">\(\Psi \in \mathcal{S}([G])\)</span> be
right-invariant under <span
class="math inline">\(G(\mathbb{Z}_p)\)</span> for each prime <span
class="math inline">\(p\)</span>, so that <span
class="math inline">\(\Psi\)</span> identifies with an element of <span
class="math inline">\(\mathcal{S}(G(\mathbb{Z}) \backslash
G(\mathbb{R}))\)</span>. Let <span
class="math inline">\(\phi_\infty\)</span> and <span
class="math inline">\(\phi\)</span> be as in Lemma <a
href="#lem:sub-gln:let-r-be" data-reference-type="ref"
data-reference="lem:sub-gln:let-r-be">290</a>. Then <span
class="math display">\[\|\Psi \|_{t,\Omega}^2
    \ll
    \delta_N(t)
    \int _{[{\mathop{\mathrm{GL}}}_n]} \theta_\phi
|\Psi|^2.\]</span></em></p>
</div>
<div class="proof">
<p><em>Proof.</em> We recall from Proposition <a
href="#prop:siegel-lower" data-reference-type="ref"
data-reference="prop:siegel-lower">35</a> that for each nonnegative
integrable function <span class="math inline">\(\phi\)</span> on <span
class="math inline">\([G]\)</span>, <span class="math display">\[\int
_{\Omega \times \prod_p K_p} \varphi(t g) \, d g \ll \delta_N(t) \int
_{[G]} \varphi.\]</span> Taking <span class="math inline">\(\varphi :=
\theta_\phi |\Psi|^2\)</span>, we have by <a href="#eq:theta_phiu-r-g"
data-reference-type="eqref"
data-reference="eq:theta_phiu-r-g">\((20.4)\)</a> that <span
class="math inline">\(|\Psi|^2(t g) \leqslant\varphi(t g)\)</span> for
all <span class="math inline">\(g \in \Omega\)</span>. The required
conclusion is then immediate from the definition of <span
class="math inline">\(\|.\|_{t,\Omega}\)</span>. ◻</p>
</div>
<h4 id="recap">Recap</h4>
<p>We recall the setting of Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>:</p>
<div id="assumptions-part-5" class="assumptions">
<p><strong>Assumptions 292</strong>. Suppose given the following.</p>
<ul>
<li><p><span class="math inline">\(n\)</span>: a fixed natural number,
<span class="math inline">\(G := {\mathop{\mathrm{GL}}}_n\)</span> over
<span class="math inline">\(\mathbb{Z}\)</span>.</p></li>
<li><p><span class="math inline">\(\Omega\)</span>: a fixed compact
subset of <span class="math inline">\(G(\mathbb{R})\)</span>.</p></li>
<li><p><span class="math inline">\(T \geqslant 1\)</span>.</p></li>
<li><p><span class="math inline">\(Y \in A(\mathbb{R})^0\)</span> with
<span class="math inline">\(T^{-\kappa} \leqslant|Y_j| \leqslant
T^{\kappa}\)</span> for some fixed <span class="math inline">\(\kappa
\in (0,1/2)\)</span>.</p></li>
<li><p><span class="math inline">\(t \in A(\mathbb{R})^0_{\geqslant
1}\)</span>.</p></li>
</ul>
</div>
<p>For <span class="math inline">\(f \in \mathcal{S}(N(\mathbb{R})
\backslash G(\mathbb{R}))\)</span>, define the pseudo Eisenstein series
<span class="math display">\[\Psi[f,Y] :=
\mathop{\mathrm{Eis}}[\Phi[L(Y) f]].\]</span> In view of the homogeneity
of the desired estimate with respect to <span
class="math inline">\(f\)</span>, it is enough to show the
following:</p>
<div class="theorem">
<p><strong>Theorem 293</strong> (Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>,
reformulated). <em>Retain Assumptions <a href="#assumptions-part-5"
data-reference-type="ref" data-reference="assumptions-part-5">292</a>.
For <span class="math inline">\(f \in \mathfrak{E}(N(\mathbb{R})
\backslash G(\mathbb{R}), T)^W\)</span>, we have <span id="eq:psiy_r2-ll-dety" class="math display">\[\label{eq:psiy_r2-ll-dety}\tag{20.5}
    \|\Psi[f,Y]\|_{t,\Omega}^2 \ll \min ( \det(Y)^{-1} t_1^{-n}, \det(Y)
t_n^n ) \delta_N(t) T^{o(1)}.\]</span></em></p>
</div>
<p>We now make some preliminary reductions. It suffices to consider the
case <span class="math inline">\(T \ggg 1\)</span>, since if <span
class="math inline">\(T \ll 1\)</span>, then the required estimate
follows readily from the continuity of the maps <span
class="math inline">\(\Phi : \mathcal{S}(N(\mathbb{R}) \backslash
G(\mathbb{R})) \rightarrow \mathcal{S}([G]_B)\)</span> and <span
class="math inline">\(\mathop{\mathrm{Eis}}: \mathcal{S}([G]_B)
\rightarrow \mathcal{S}([G])\)</span>. For the same reason, we may
reduce to the case that each component <span
class="math inline">\(t_j\)</span> is of the form <span
class="math inline">\(T^{\operatorname{O}(1)}\)</span> (compare with the
proof of Lemma <a href="#lem:standard2:each-fixed-c"
data-reference-type="ref"
data-reference="lem:standard2:each-fixed-c">73</a>). Finally, exactly as
in §<a href="#sec:appl-crude-bounds" data-reference-type="ref"
data-reference="sec:appl-crude-bounds">3.10.5</a>, we may reduce to the
case that <span class="math inline">\(\det(t Y) = T^{o(1)}\)</span>,
noting that Lemmas <a href="#lem:each-fixed-c_0-Psi-crude"
data-reference-type="ref"
data-reference="lem:each-fixed-c_0-Psi-crude">71</a> and <a
href="#lem:standard2:each-fixed-c_0" data-reference-type="ref"
data-reference="lem:standard2:each-fixed-c_0">72</a> remain valid in our
setting, with the same proofs. It will thus suffice to show the
following:</p>
<div id="thm:sub-gln:let-r-as" class="theorem">
<p><strong>Theorem 294</strong>. <em>Retain Assumptions <a
href="#assumptions-part-5" data-reference-type="ref"
data-reference="assumptions-part-5">292</a>. Assume moreover that <span
class="math inline">\(\det(t Y) = T^{o(1)}\)</span> and <span
class="math inline">\(t_j = T^{\operatorname{O}(1)}\)</span> for all
<span class="math inline">\(j \in \{1, \dotsc, n\}\)</span>. Then <a
href="#eq:psiy_r2-ll-dety" data-reference-type="eqref"
data-reference="eq:psiy_r2-ll-dety">\((20.5)\)</a>
holds.</em></p>
</div>
<div class="remark">
<p><strong>Remark 295</strong>. For the purpose of proving our main
result, it was unnecessary to carry out the above reductions; it
suffices to note that such assumptions are in force in the one place
where we apply Theorem <a href="#thm:growth-eisenstein-nonstandard"
data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>, in §<a
href="#sec:appl-growth-bounds" data-reference-type="ref"
data-reference="sec:appl-growth-bounds">3.10.7</a>. We have repeated
them here to simplify the statement of Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a> by keeping it
free of unnecessary hypotheses.</p>
</div>
<h4 id="application-of-duality">Application of duality</h4>
<p>Retaining the setting of Theorem <a href="#thm:sub-gln:let-r-as"
data-reference-type="ref" data-reference="thm:sub-gln:let-r-as">294</a>,
we record the preliminary reduction that it suffices to verify the
apparently weaker estimate: for all <span class="math inline">\(f
\in  \mathfrak{E}(N(\mathbb{R}) \backslash G(\mathbb{R}), T)^W\)</span>,
<span id="eq:psiy_r2-ll-dety-1" class="math display">\[\label{eq:psiy_r2-ll-dety-1}\tag{20.6}
  \|\Psi[f,Y]\|_{t,\Omega}^2 \ll
  \det(Y)
  t_n^n \delta_N(t) T^{o(1)}.\]</span></p>
<p>To obtain this reduction, we first define, for any function <span
class="math inline">\(\varphi : [G] \rightarrow \mathbb{C}\)</span>, the
dual function <span class="math inline">\(\tilde{\varphi} : [G]
\rightarrow \mathbb{C}\)</span> by <span
class="math display">\[\tilde{\varphi}(g) := \varphi(g^{-%
  {\mathpalette\@transpose{}}%
}),\]</span> where, as in §<a href="#sec:duality"
data-reference-type="ref" data-reference="sec:duality">3.1.2</a>, <span
class="math inline">\(g \mapsto g^{-%
  {\mathpalette\@transpose{}}%
}\)</span> denotes the outer automorphism given by taking the inverse
transpose. Temporarily denote by <span class="math inline">\(w_0 :=
w_G\)</span> the standard representative for the long Weyl element,
which satisfies <span class="math inline">\(w_0 = w_0^{-1} = w_0^%
  {\mathpalette\@transpose{}}%\)</span>. Set <span
class="math inline">\(Y^{-w_0} := w_0^{-1} Y^{-1} w_0 \in
A(\mathbb{R})^0\)</span> and <span class="math inline">\(\tilde{\Phi}(g)
:= \Phi(w_0 g^{-%
  {\mathpalette\@transpose{}}%
})\)</span>. Then a simple calculation gives <span
class="math display">\[\widetilde{\Psi[f,Y]} = \Psi[\tilde{f},
Y^{-w_0}],\]</span> where <span class="math inline">\(\tilde{f}\)</span>
is as defined in §<a href="#sec:duality" data-reference-type="ref"
data-reference="sec:duality">3.1.2</a>. In deriving this, we use that
<span class="math display">\[\mathcal{P}_G(-w_0 s) = \mathcal{P}_G(s),
  \quad
  \zeta(N,-w_0 s) = \zeta(N,s)\]</span> and that, for finite primes
<span class="math inline">\(p\)</span>, <span
class="math display">\[f_p[-w_0 s](w_0 g^{-%
  {\mathpalette\@transpose{}}%
}) = f_p[s](g),\]</span> which follows from the fact that both sides
defines normalized spherical elements of the same induced
representation.</p>
<p>We now explain the deduction of Theorem <a
href="#thm:sub-gln:let-r-as" data-reference-type="ref"
data-reference="thm:sub-gln:let-r-as">294</a> from <a
href="#eq:psiy_r2-ll-dety-1" data-reference-type="eqref"
data-reference="eq:psiy_r2-ll-dety-1">\((20.6)\)</a>. By
enlarging <span class="math inline">\(\Omega\)</span> if necessary, we
may assume that it is invariant under <span class="math inline">\(g
\mapsto g^{-%
  {\mathpalette\@transpose{}}%
}\)</span> and also under left and right translation by <span
class="math inline">\(w_0\)</span>. Then <span
class="math display">\[\tilde{t} := w_0 t^{-%
  {\mathpalette\@transpose{}}%
} w_0 = \mathop{\mathrm{diag}}(t_n^{-1}, \dotsc, t_1^{-1}),
  \quad
  \delta_N(\tilde{t}) = \delta_N(t)\]</span> and <span
class="math display">\[\|\Psi[f,Y]\|_{t,\Omega} = \|\Psi[\tilde{f},
Y^{-w_0}]\|_{\tilde{t},\Omega}.\]</span> We have <span
class="math inline">\(\det(Y^{-w_0}) = \det(Y)^{-1}\)</span>. By Lemma
<a href="#lem:standard:let-f-in" data-reference-type="ref"
data-reference="lem:standard:let-f-in">288</a>, we have <span
class="math inline">\(\tilde{f} \in \mathfrak{E}(N(\mathbb{R})
\backslash G(\mathbb{R}), T)^W\)</span>. By <a
href="#eq:psiy_r2-ll-dety-1" data-reference-type="eqref"
data-reference="eq:psiy_r2-ll-dety-1">\((20.6)\)</a> applied
to <span class="math inline">\(\tilde{f}\)</span> and <span
class="math inline">\(Y^{-w_0}\)</span>, it follows that <span id="eq:psiy_r2-ll-dety-2" class="math display">\[\label{eq:psiy_r2-ll-dety-2}\tag{20.7}
  \|\Psi[f,Y]\|_{t,\Omega}^2 \ll
  \det(Y)^{-1} t_1^{-n} \delta_N(t) T^{o(1)}.\]</span> Taking the
minimum of the two estimates <a href="#eq:psiy_r2-ll-dety-1"
data-reference-type="eqref"
data-reference="eq:psiy_r2-ll-dety-1">\((20.6)\)</a> and <a
href="#eq:psiy_r2-ll-dety-2" data-reference-type="eqref"
data-reference="eq:psiy_r2-ll-dety-2">\((20.7)\)</a> yields
the required estimate <a href="#eq:psiy_r2-ll-dety"
data-reference-type="eqref"
data-reference="eq:psiy_r2-ll-dety">\((20.5)\)</a>.</p>
<h4 id="reduction-to-bounds-for-rankinselberg-integrals">Reduction to
bounds for Rankin–Selberg integrals</h4>
<p>We recall the assignment <span class="math display">\[\Phi :
\mathcal{S}^e(N(\mathbb{R}) \backslash G(\mathbb{R})) \rightarrow
\mathcal{S}^e([G]_B)\]</span> <span class="math display">\[f \mapsto
\Phi[f]\]</span> characterized, as in §<a href="#sec:compl-eisenst-seri"
data-reference-type="ref"
data-reference="sec:compl-eisenst-seri">2.16</a>, by the Mellin
component identity <span id="eq:phif_-=-mathc" class="math display">\[\label{eq:phif_-=-mathc}\tag{20.8}
  \Phi[f][s] = \mathcal{P}_G(s) \zeta(N,s) \otimes_{\mathfrak{p}}
f_\mathfrak{p}[s]\]</span> where <span class="math inline">\(f_\infty[s]
:= f[s]\)</span>, while <span class="math inline">\(f_p[s]\)</span> is
normalized spherical for all finite primes <span
class="math inline">\(p\)</span>.</p>
<p>Our aim is to prove Theorem <a href="#thm:sub-gln:let-r-as"
data-reference-type="ref" data-reference="thm:sub-gln:let-r-as">294</a>
via the criterion <a href="#eq:psiy_r2-ll-dety-1"
data-reference-type="eqref"
data-reference="eq:psiy_r2-ll-dety-1">\((20.6)\)</a>. In
view of Corollary <a href="#cor:sub-gln:let-psi-in"
data-reference-type="ref"
data-reference="cor:sub-gln:let-psi-in">291</a>, it is enough to show
that, with <span class="math inline">\(\phi\)</span> as in the statement
of the latter and <span class="math inline">\(f \in \mathfrak{E}(N
\backslash G, T)^W\)</span>, <span id="eq:int_g-thet-psiy2" class="math display">\[\label{eq:int_g-thet-psiy2}\tag{20.9}
  \int_{[G]}
  \theta_\phi \left\lvert \Psi[f,Y] \right\rvert^2 \ll
  \det(Y)
  t_n^n  T^{o(1)},\]</span> where <span class="math inline">\(\Psi[f,Y]
= \mathop{\mathrm{Eis}}[L(Y) \Phi[f]]\)</span>.</p>
<p>By Proposition <a href="#prop:sub-gln:let-phi-in-summary"
data-reference-type="ref"
data-reference="prop:sub-gln:let-phi-in-summary">283</a>, we reduce
further to verifying the same bound for each of the following integrals,
defined for <span class="math inline">\(P = MU\)</span> either a
standard maximal parabolic subgroup or <span class="math inline">\(P =
G\)</span> itself: <span class="math display">\[\begin{align}
  &amp;\int _{g \in (M&#39; N&#39;&#39; {U_P} \backslash G)(\mathbb{A})
} \phi(e_n g)
    \int _{h \in [M&#39;]_{B_{M&#39;}}} \\
  &amp;\quad  \quad
  \left\lvert
    \sum _{w&#39; \in W_{M&#39;}}
  \sum _{w \in W(A,M)}
    W^P[M_{w&#39; w} L(Y) \Phi[f]](h g)
  \right\rvert^2
  \, \frac{d h}{\delta_{U_P}(h)}
  \, d g.
\end{align}\]</span> Since <span class="math inline">\(\phi\)</span>
is nonnegative, we can estimate the above expression by bounding the
<span class="math inline">\(h\)</span>-integral in magnitude and
integrating the resulting bound. In particular, using the triangle
inequality, the sums over Weyl group elements may be taken outside of
the absolute value. By Lemma <a href="#lem:standard2:let-f_infty-in"
data-reference-type="ref"
data-reference="lem:standard2:let-f_infty-in">29</a> and our assumption
that <span class="math inline">\(f\)</span> is <span
class="math inline">\(W\)</span>-invariant, we have <span
class="math display">\[M_{w} L(Y) \Phi[f] = L({}^w Y) \Phi[f]\]</span>
for all <span class="math inline">\(w \in W_G\)</span>. Since <span
class="math inline">\(\det(Y) = \det({}^w Y)\)</span>, and since <span
class="math inline">\({}^w Y\)</span> satisfies the hypotheses of
Theorem <a href="#thm:sub-gln:let-r-as" data-reference-type="ref"
data-reference="thm:sub-gln:let-r-as">294</a> if and only if <span
class="math inline">\(Y\)</span> does, we reduce to estimating the
simpler integrals <span class="math inline">\(\mathcal{Q}_P(\phi, L(Y)
f)\)</span>, where for <span class="math inline">\(f \in
\mathcal{S}^e(N(\mathbb{R}) \backslash G(\mathbb{R}))\)</span>, we set
<span id="eq:mathcalq_pphi-f-:=" class="math display">\[\label{eq:mathcalq_pphi-f-:=}\tag{20.10}
  \mathcal{Q}_P(\phi, f)
  :=
  \int _{g \in (M&#39; N&#39;&#39; {U_P} \backslash G)(\mathbb{A}) }
\phi(e_n g)
    \int _{h \in [M&#39;]_{B_{M&#39;}}} \\
  \left\lvert
    W^P[\Phi[f]](h g)
  \right\rvert^2
  \, \frac{d h}{\delta_{U_P}(h)}
  \, d g.\]</span></p>
<p>We note that when <span class="math inline">\(P = G\)</span>, the
integrals <span class="math inline">\(\mathcal{Q}_G(\phi,f)\)</span> are
what one might call “pseudo local Rankin–Selberg integrals for <span
class="math inline">\({\mathop{\mathrm{GL}}}_n \times
{\mathop{\mathrm{GL}}}_n\)</span>:” a spectral expansion of <span
class="math inline">\(\phi\)</span> and <span
class="math inline">\(f\)</span> would lead to an expression for <span
class="math inline">\(\mathcal{Q}_G(\phi,f)\)</span> as an integral of
ordinary local Rankin–Selberg integrals. For <span
class="math inline">\(P \neq G\)</span>, they might be understood as
degenerate variants of such integrals.</p>
<h4 id="sec:summary-thus-far">§20.6. Summary thus far</h4>
<p>The proof of Theorem <a href="#thm:sub-gln:let-r-as"
data-reference-type="ref" data-reference="thm:sub-gln:let-r-as">294</a>
thereby reduces to that of the following proposition. We summarize the
running assumptions:</p>
<div id="assumptions:furth-reduct-proof" class="assumptions">
<p><strong>Assumptions 296</strong>. Suppose given</p>
<ul>
<li><p>a positive parameter <span class="math inline">\(T \ggg
1\)</span>,</p></li>
<li><p>an element <span class="math inline">\(f \in
\mathfrak{E}(N(\mathbb{R}) \backslash G(\mathbb{R}),
T)\)</span>,</p></li>
<li><p>an element <span class="math inline">\(r &gt; 0\)</span> with
<span class="math inline">\(r =T^{\operatorname{O}(1)}\)</span> (playing
the role of <span class="math inline">\(t_n\)</span>), and</p></li>
<li><p>an element <span class="math inline">\(Y \in
A(\mathbb{R})^0\)</span> with <span class="math inline">\(T^{-\kappa}
\leqslant|Y_j| \leqslant T^{\kappa}\)</span> for some fixed <span
class="math inline">\(\kappa &lt; 1/2\)</span> and all <span
class="math inline">\(j\)</span>.</p></li>
</ul>
<p>Let <span class="math inline">\(V := V_n\)</span> denote the
punctured affine <span class="math inline">\(n\)</span>-plane, as in §<a
href="#sec:notation-rs-unfolding" data-reference-type="ref"
data-reference="sec:notation-rs-unfolding">2.1</a>. Let <span
class="math inline">\(\phi_p \in C_c^\infty(V(\mathbb{Q}_p))\)</span> be
the characteristic function of <span
class="math inline">\(V(\mathbb{Z}_p)\)</span>. Let <span
class="math inline">\(\phi_\infty \in C_c^\infty(V(\mathbb{R}))\)</span>
be the element attached, as in Lemma <a href="#lem:sub-gln:let-r-be"
data-reference-type="ref" data-reference="lem:sub-gln:let-r-be">290</a>,
to the quantity <span class="math inline">\(r &gt; 0\)</span>, and let
<span class="math inline">\(\phi = \otimes_{\mathfrak{p}}
\phi_\mathfrak{p}\)</span>.</p>
</div>
<p>We have reduced the proof of Theorem <a href="#thm:sub-gln:let-r-as"
data-reference-type="ref" data-reference="thm:sub-gln:let-r-as">294</a>
to that of the following.</p>
<div id="prop:bound-after-theta-degenerate-case-2" class="proposition">
<p><strong>Proposition 297</strong>. <em>Retain Assumptions <a
href="#assumptions:furth-reduct-proof" data-reference-type="ref"
data-reference="assumptions:furth-reduct-proof">296</a>. Let <span
class="math inline">\(P\)</span> be either <span
class="math inline">\(G\)</span> itself or a standard maximal parabolic
subgroup of <span class="math inline">\(G\)</span>. Then <span
class="math display">\[\mathcal{Q}_P(\phi,L(Y) f)
    \ll
    \det(Y) r^{n} T^{o(1)}.\]</span></em></p>
</div>
<h4 id="sec:interl-basic-vect">§20.7. Interlude on basic vectors</h4>
<p>We suspend the general setting of §<a href="#sec:reduction-proof"
data-reference-type="ref" data-reference="sec:reduction-proof">3</a> and
pause to record some preliminaries, to be applied below, concerning
“basic vectors” following Braverman–Kazhdan <a href="#ref-MR1694894" class="citation"
data-cites="MR1694894">(Braverman and Kazhdan 1999, sec.
3.12)</a>.</p>
<h5 id="sec:basic-vectors-local">§20.7.1. Local</h5>
<p>Let <span class="math inline">\(F\)</span> be a non-archimedean local
field, with ring of integers <span
class="math inline">\(\mathfrak{o}\)</span>, maximal ideal <span
class="math inline">\(\mathfrak{p}\)</span> and <span
class="math inline">\(q = \# \mathfrak{o} / \mathfrak{p}\)</span>, as
usual. Let <span class="math inline">\(G\)</span> be a split reductive
group over <span class="math inline">\(\mathfrak{o}\)</span>, with
maximal torus <span class="math inline">\(A\)</span> and Borel subgroup
<span class="math inline">\(B = N A\)</span>.</p>
<p>As in §<a href="#sec:local-zeta-functions" data-reference-type="ref"
data-reference="sec:local-zeta-functions">2.10</a>, we define the
meromorphic function <span
class="math inline">\(\zeta_F(N,\cdot)\)</span> on <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^*\)</span> by <span
class="math display">\[\zeta_F(N,s) := \prod_{\alpha &gt; 0} \zeta_F(1 +
\alpha^\vee(s)),\]</span> where the product is over all positive (with
respect to <span class="math inline">\(N\)</span>) roots. (We have
switched notation from “<span class="math inline">\(U\)</span>” there to
“<span class="math inline">\(N\)</span>” here, following the general
convention “<span class="math inline">\(U = N\)</span>” of Part <a
href="#part:local-l2-growth" data-reference-type="ref"
data-reference="part:local-l2-growth"></a>.)</p>
<p>The meromorphic function <span
class="math inline">\(\zeta_F(N,s)\)</span> depends only upon the
unramified character <span class="math inline">\(|.|^s\)</span> of <span
class="math inline">\(A(F)\)</span>. It is holomorphic in the domain
where, for each <span class="math inline">\(\alpha &gt; 0\)</span>, we
have <span class="math inline">\(\Re(\alpha^\vee(s)) &gt; -1\)</span>;
in particular, it is holomorphic where <span
class="math inline">\(\Re(s)\)</span> is dominant. Thus for any dominant
<span class="math inline">\(\sigma \in \mathfrak{a}^*\)</span>, we may
define a smooth function <span class="math inline">\(\Theta : A(F) /
A(\mathfrak{o}) \rightarrow \mathbb{C}\)</span> by the contour integral
<span class="math display">\[\Theta(a) = \int _{(\sigma)} |a|^{\rho + s}
\zeta_F(N,s) \, d \mu_{A}(s),\]</span> defined as in <a
href="#eq:int-_sigma-fs" data-reference-type="eqref"
data-reference="eq:int-_sigma-fs">\((2.6)\)</a>. Here <span
class="math inline">\(d \mu_{A}(s)\)</span> denotes the
<em>probability</em> Haar measure on <span class="math inline">\(\{|.|^s
\in \mathfrak{X}^e(A) : \Re(s)  = \sigma \}\)</span>, dual to the Haar
measure on <span class="math inline">\(A(F)\)</span> assigning volume
one to <span class="math inline">\(A(\mathfrak{o})\)</span>.</p>
<p>If <span class="math inline">\(G\)</span> is a torus, then <span
class="math inline">\(\Theta|_{A(F)}\)</span> is the characteristic
function of <span class="math inline">\(A(\mathfrak{o})\)</span>.
Otherwise, <span class="math inline">\(\zeta_F(N,s)\)</span> is
nontrivial, hence has poles, and so the integral depends upon the choice
of <span class="math inline">\(\sigma\)</span>. From another
perspective, <span class="math inline">\(\Theta\)</span> is not
compactly supported, but instead has some asymptotics at <span
class="math inline">\(\infty\)</span> along the “negative cone.”</p>
<p>By the Iwasawa decomposition, the function <span
class="math inline">\(\Theta\)</span> extends uniquely to a function on
<span class="math inline">\(N(F) \backslash G(F) /
G(\mathfrak{o})\)</span>, right-invariant under <span
class="math inline">\(G(\mathfrak{o})\)</span>. We write <span
class="math inline">\(\Theta = \Theta^G\)</span> when we wish to
indicate which group <span class="math inline">\(G\)</span> is under
consideration.</p>
<p>As in <a href="#ref-MR1694894" class="citation" data-cites="MR1694894">(Braverman and
Kazhdan 1999, sec. 3.12)</a>, let <span
class="math inline">\(\Gamma^+ \subseteq \mathfrak{a}^*\)</span> denote
the set of all nonnegative integral combinations of coroots <span
class="math inline">\(\alpha^\vee\)</span>, and let <span
class="math inline">\(\mathcal{K} : \Gamma^+ \rightarrow
\mathbb{R}_{\geqslant 0}\)</span> denote the function given by <span
class="math display">\[\mathcal{K}(\gamma) = \sum _{P \in
\mathcal{P}_\gamma } q^{-|P|},\]</span> where <span
class="math inline">\(\mathcal{P}_\gamma\)</span> denotes the set of
representations of <span class="math inline">\(\gamma\)</span> as a sum
of positive coroots and <span class="math inline">\(|P|\)</span> denotes
the number of summands in a given representation <span
class="math inline">\(P \in \mathcal{P}_\gamma\)</span>. The series
representation <span class="math inline">\(\zeta_F(s) = (1 -
q^{-s})^{-1} = \sum_{n \geqslant 0} q^{-n s}\)</span> yields <span
class="math display">\[\zeta_F(N,s)
  =
  \sum _{\gamma \in \Gamma^+ }
  \mathcal{K}(\gamma)
  q^{- \gamma(s) },\]</span> valid, e.g., for <span
class="math inline">\(s\)</span> of dominant real part. We may identify
<span class="math inline">\(\Gamma^+\)</span> with a subset of <span
class="math inline">\(A(F) / A(\mathfrak{o})\)</span> by associating to
<span class="math inline">\(\gamma \in \Gamma^+\)</span> the unique
element <span class="math inline">\(a_\gamma \in A(F) /
A(\mathfrak{o})\)</span> for which <span
class="math inline">\(|a_\gamma|^s = q^{\gamma(s)}\)</span> for all
<span class="math inline">\(s \in \mathfrak{a}_{\mathbb{C}}^*\)</span>.
Then by Mellin inversion, we see that <span
class="math inline">\(\Theta\)</span> is supported on the image of <span
class="math inline">\(\Gamma^+\)</span> and given there by <span
class="math display">\[\Theta(a_\gamma) = q^{ \langle \rho,
\gamma  \rangle} \mathcal{K}(\gamma).\]</span> In particular, for every
rational character <span class="math inline">\(\chi : G(F) \rightarrow
F^\times\)</span>, we have <span class="math inline">\(\chi(g) \in
\mathfrak{o}^\times\)</span> for all <span
class="math inline">\(g\)</span> in the support of <span
class="math inline">\(\Theta\)</span>. For instance, when <span
class="math inline">\(G = {\mathop{\mathrm{GL}}}_n\)</span>, every element
of the support of <span class="math inline">\(\Theta\)</span> has unit
determinant.</p>
<div class="example">
<p><strong>Example 298</strong>. If <span class="math inline">\(G =
{\mathop{\mathrm{SL}}}_2\)</span> and <span class="math inline">\(a_\gamma
= \mathop{\mathrm{diag}}(\varpi^{-r}, \varpi^r)\)</span>, then <span
class="math inline">\(\mathcal{K}(\gamma) = 1_{r \geqslant 0}
q^{-r}\)</span> and <span class="math inline">\(\langle \rho,
\gamma  \rangle = r\)</span>, so <span
class="math inline">\(\Theta(a_\gamma) = 1_{r \geqslant 0}\)</span>.
Under the “bottom row” map <span class="math inline">\(N(F) \backslash
G(F) \cong F^2 - \{0\}\)</span>, <span
class="math inline">\(\Theta\)</span> identifies with the characteristic
function of <span class="math inline">\(1_{\mathfrak{o}^2 -
\{0\}}\)</span> (cf. Example <a
href="#exa:example-sl2-completed-eisenstein-series"
data-reference-type="ref"
data-reference="exa:example-sl2-completed-eisenstein-series">28</a>). In
most other examples, <span class="math inline">\(\Theta\)</span> is more
complicated, e.g., non-constant on its support.</p>
</div>
<h5 id="global">Global</h5>
<p>Now let <span class="math inline">\(G\)</span> be a split reductive
group over <span class="math inline">\(\mathbb{Z}\)</span>, with maximal
torus <span class="math inline">\(A\)</span> and Borel <span
class="math inline">\(B = N A\)</span>. (The present discussion is the
specialization to <span class="math inline">\((\mathbb{Q}, \{\infty
\}\)</span>) of a more general one concerning any pair consisting of
number field and a large enough finite set of places.) For each prime
number <span class="math inline">\(p\)</span>, the discussion of §<a
href="#sec:basic-vectors-local" data-reference-type="ref"
data-reference="sec:basic-vectors-local">3.7.1</a> provides us with an
element <span class="math display">\[\Theta^G_p  : N(\mathbb{Q}_p)
\backslash G(\mathbb{Q}_p) / G(\mathbb{Z}_p) \rightarrow
\mathbb{C}.\]</span></p>
<div id="lem:sub-gln:let-m-in" class="lemma">
<p><strong>Lemma 299</strong>. Let <span
class="math inline">\(\varepsilon&gt; 0\)</span>. Define <span
class="math inline">\(f_\infty : N(\mathbb{R}) \backslash G(\mathbb{R})
\rightarrow \mathbb{C}\)</span> in Iwasawa coordinates <span
class="math inline">\((a,k) \in A(\mathbb{R}) \times K_\infty\)</span>
by the formula <span class="math display">\[f_\infty(a k) := |a|^{2
\rho} \|a\|^{-\varepsilon}.\]</span> Set <span class="math inline">\(f_p
:= \Theta_p^G\)</span>. Define <span class="math inline">\(f :
N(\mathbb{A}) \backslash G(\mathbb{A}) \rightarrow \mathbb{R}_{\geqslant
0}\)</span> by <span class="math inline">\(f(g) := \prod_\mathfrak{p}
f_\mathfrak{p}(g_\mathfrak{p})\)</span>. Then the series <span
class="math inline">\(\sum _{\gamma \in N(\mathbb{Q}) \backslash
G(\mathbb{Q})} f(\gamma)\)</span> converges.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This seems well-known (see, e.g., <a href="#ref-MR1694894"
class="citation" data-cites="MR1694894">(Braverman and Kazhdan 1999,
sec. 7.6)</a>). Since we could not quickly locate a written proof, we
record the necessary arguments for the sake of completeness.</p>
<p>We may and shall assume that all quantities in our hypotheses are
fixed, so that we may employ asymptotic notation effectively.</p>
<p>We define the intermediate function <span class="math inline">\(\Phi
: [G]_B \rightarrow \mathbb{R}_{\geqslant 0}\)</span> by the series
<span class="math display">\[\Phi(g) := \sum _{c \in A(\mathbb{Q})} f(c
g).\]</span> Then <span class="math display">\[\sum_{N(\mathbb{Q})
\backslash G(\mathbb{Q})} f(\gamma) = \sum _{B(\mathbb{Q}) \backslash
G(\mathbb{Q})} \Phi(\gamma).\]</span> By the convergence of “ordinary”
Eisenstein series (§<a href="#sec:eisenstein-series"
data-reference-type="ref"
data-reference="sec:eisenstein-series">2.15</a>), it will suffice to
verify for some fixed strictly dominant element <span
class="math inline">\(\sigma \in \mathfrak{a}^*\)</span> that for all
<span class="math inline">\((a,k) \in [A] \times K\)</span>, <span id="eq:phia-k-ll" class="math display">\[\label{eq:phia-k-ll}\tag{20.11}
    \Phi(a k) \ll |a|^{2 \rho + \sigma}.\]</span> Since <span
class="math inline">\(f\)</span> is right-invariant under <span
class="math inline">\(K\)</span>, so is <span
class="math inline">\(\Phi\)</span>, and we may thus reduce to the case
<span class="math inline">\(k = 1\)</span>. We fix a small enough
neighborhood <span class="math inline">\(\Omega_\infty\)</span> of the
identity element in <span
class="math inline">\(A(\mathbb{R})^0\)</span>, and set <span
class="math inline">\(\Omega := \Omega_\infty \prod_p A(\mathbb{Z}_p)
\subseteq A(\mathbb{A})\)</span>. Then the cosets <span
class="math inline">\(c \Omega\)</span>, with <span
class="math inline">\(c \in A(\mathbb{Q})\)</span>, are disjoint from
one another. Moreover, for <span class="math inline">\(u \in
A(\mathbb{A})\)</span> and <span class="math inline">\(t \in
\Omega\)</span>, we have <span class="math inline">\(f(u t) \asymp
f(u)\)</span>, hence <span class="math inline">\(f(u) \asymp \int _{t
\in \Omega } f(u t) \, d t\)</span>, where <span class="math inline">\(d
t\)</span> denotes our Haar measure on <span
class="math inline">\(A(\mathbb{A})\)</span>. We obtain</p>
<p><span class="math display">\[\Phi(a) = \sum _{c \in A(\mathbb{Q})}
f(c a) \asymp  \int _{t \in A(\mathbb{A})}  1_{A(\mathbb{Q}) \Omega}(t)
f(t a) \, d t.\]</span> For <span class="math inline">\(t \in
A(\mathbb{Q}) \Omega\)</span>, the product rule implies that <span
class="math inline">\(|t|^{2 \rho + \sigma} \asymp 1\)</span>. Thus
<span class="math display">\[\begin{align}
    |a|^{-2 \rho-\sigma} \Phi(a)
    &amp;\ll \int _{t \in A(\mathbb{A})} 1_{A(\mathbb{Q}) \Omega}(t) |t
a|^{-2 \rho - \sigma} f(t a) \, d t \\
    &amp;\leqslant\int _{t \in A(\mathbb{A})} |t|^{-2 \rho - \sigma}
f(t) \, d t \\
    &amp;= \prod_\mathfrak{p} \int _{t \in A(\mathbb{Q}_\mathfrak{p})}
|t|^{-2 \rho - \sigma} f_\mathfrak{p}(t) \, d t.
  
\end{align}\]</span> The <span class="math inline">\(p\)</span>-adic
integrals evaluate to <span class="math inline">\(\zeta_p(N,\rho +
\sigma)\)</span>, whose product converges (comfortably) in view of the
strict dominance of <span class="math inline">\(\rho + \sigma\)</span>.
The archimedean integral <span class="math display">\[\int _{t \in
A(\mathbb{R})} |t|^{- 2 \rho - \sigma} f_\infty(t) \, d t
    =
    \int _{t \in A(\mathbb{R})} |t|^{- \sigma} \|t\|^{-\varepsilon} \, d
t\]</span> converges provided that <span
class="math inline">\(\sigma\)</span> is fixed sufficiently small in
terms of <span class="math inline">\(\varepsilon\)</span>. Thus <span
class="math inline">\(|a|^{- 2 \rho - \sigma} \Phi(a) \ll 1\)</span>, as
required. ◻</p>
</div>
<h4 id="sec:seri-repr-via">§20.8. Series representations via partial Schwartz
spaces</h4>
<p>We now resume the setting of §<a href="#sec:summary-thus-far"
data-reference-type="ref" data-reference="sec:summary-thus-far">3.6</a>
and derive alternative series representations for <span
class="math inline">\(\Phi[f]\)</span> that will be very convenient for
certain calculations (see the final paragraphs of §<a
href="#sec:strong-approximation" data-reference-type="ref"
data-reference="sec:strong-approximation">3.9</a>).</p>
<p>Let <span class="math inline">\(P = M {U_P}\)</span>, <span
class="math inline">\(M = M&#39; \times M&#39;&#39;\)</span> be either
<span class="math inline">\(G\)</span> or a standard maximal parabolic,
with accompanying notation as in §<a href="#sec:reform-terms-const-1"
data-reference-type="ref"
data-reference="sec:reform-terms-const-1">2.6</a> and §<a
href="#sec:summary-unification" data-reference-type="ref"
data-reference="sec:summary-unification">2.8</a>. We introduce the
additional notation <span class="math display">\[A&#39; \leqslant
M&#39;, \quad A&#39;&#39; \leqslant M&#39;&#39;\]</span> for the
diagonal tori in the general linear groups <span
class="math inline">\(M&#39;\)</span> and <span
class="math inline">\(M&#39;&#39;\)</span>.</p>
<p>Recall from §<a href="#eq:zeta-U-s-global-over-Z"
data-reference-type="ref"
data-reference="eq:zeta-U-s-global-over-Z">2.48</a>
that we have defined a meromorphic function <span
class="math display">\[\zeta(N,s) = \prod_{\alpha &gt; 0} \zeta(1 +
\alpha^\vee(s))\]</span> of <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span>. We now introduce the analogous
definition <span class="math display">\[\zeta(N&#39;&#39;,s) := \prod_{
    \substack{
      \alpha &gt; 0 :  \\
       \mathop{\mathrm{Lie}}(G)_\alpha \subseteq
\mathop{\mathrm{Lie}}(N&#39;&#39;)
    }
  }
  \zeta(1 + \alpha^\vee(s)),\]</span> obtained by restricting the
product to those <span class="math inline">\(\alpha\)</span> coming from
<span class="math inline">\(N&#39;&#39;\)</span>. Equivalently, <span
class="math inline">\(\zeta(N&#39;&#39;,s)\)</span> is obtained via
pullback under the map <span
class="math inline">\(\mathfrak{a}_{\mathbb{C}}^* \twoheadrightarrow
(\mathfrak{a}_{\mathbb{C} }&#39;&#39;)^*\)</span>, dual to the inclusion
<span class="math inline">\(A&#39;&#39; \hookrightarrow A\)</span>, of
the analogous meromorphic function attached to <span
class="math inline">\(N&#39;&#39; \subseteq M&#39;&#39;\)</span>. The
ratio <span class="math inline">\(\zeta(N,s) / \zeta(N&#39;&#39;,
s)\)</span> is then likewise a product of zeta functions: <span
class="math display">\[\frac{\zeta (N, s)}{ \zeta (N&#39;&#39;, s)}
  = \prod _{
    \substack{
      \beta &gt; 0:   \\
      \mathop{\mathrm{Lie}}(G)_\beta \not\subseteq
\mathop{\mathrm{Lie}}(N&#39;&#39;)
    }
  }
  \zeta(1 + \beta^\vee(s)).\]</span></p>
<p>For each finite prime <span class="math inline">\(p\)</span>, we
denote by <span class="math inline">\(f_p[s] \in
\mathcal{I}_\mathfrak{p}(s)\)</span> the spherical elements satisfying
<span class="math inline">\(f_p[s](1) = 1\)</span>, and define <span
class="math inline">\(\Theta^P_p \in C^\infty(N(\mathbb{Q}_p) \backslash
G(\mathbb{Q}_p))\)</span> by the Mellin integral <span id="eq:thetap_p-:=-int" class="math display">\[\label{eq:thetap_p-:=-int}\tag{20.12}
  \Theta^P_p :=
  \int _{(\sigma)}
  \zeta_p(N&#39;&#39;, s) f_p[s]
  \, d \mu_{A(\mathbb{Q}_p)}(s)\]</span> for any dominant <span
class="math inline">\(\sigma \in \mathfrak{a}^*\)</span>. For <span
class="math inline">\(s\)</span> with dominant real part, the Mellin
component <span class="math inline">\(\Theta_p^P[s]\)</span> is given by
<span class="math display">\[\Theta_p^P[s] = \zeta_P(N&#39;&#39;,s)
f_p[s].\]</span> The function <span
class="math inline">\(\Theta_p^P\)</span> descends to the quotient <span
class="math inline">\(N(\mathbb{Q}_p) \backslash G(\mathbb{Q}_p) /
K_p\)</span>, hence is determined by its restriction to <span
class="math inline">\(A(\mathbb{Q}_p)/A(\mathbb{Z}_p)\)</span>. In the
special case <span class="math inline">\(P = G\)</span> (i.e., <span
class="math inline">\(M&#39;&#39; = G\)</span>), the function <span
class="math inline">\(\Theta_p^P = \Theta_p^G\)</span> is as described
in §<a href="#sec:basic-vectors-local" data-reference-type="ref"
data-reference="sec:basic-vectors-local">3.7.1</a>. At the other
extreme, if <span class="math inline">\(\dim(M&#39;&#39;) = 1\)</span>,
then <span class="math inline">\(\zeta(N&#39;&#39;,s) = 1\)</span>, so
<span class="math inline">\(\Theta^P_p\)</span> is the characteristic
function of <span class="math inline">\(K_p\)</span>. The general case
is a mixture of these two:</p>
<div id="lem:Theta-P-p" class="lemma">
<p><strong>Lemma 300</strong>. Let <span class="math inline">\(a \in
A(\mathbb{Q}_p)\)</span>. Write <span class="math inline">\(a = a&#39;
a&#39;&#39;\)</span>, with <span
class="math inline">\((a&#39;,a&#39;&#39;) \in A&#39;(\mathbb{Q}_p)
\times A&#39;&#39;(\mathbb{Q}_p)\)</span>. Then</p>
<p><span id="eq:thet-=-1_am" class="math display">\[\label{eq:thet-=-1_am}\tag{20.13}
    \Theta_p^P(a) = 1_{A&#39;(\mathbb{Z}_p)}(a&#39;)
    \Theta^{M&#39;&#39;}_p(a&#39;&#39;),\]</span> where <span
class="math inline">\(\Theta^{M&#39;&#39;}_p\)</span> denotes the
function defined like <span class="math inline">\(\Theta^G_p\)</span>,
but relative to the (typically smaller) general linear group <span
class="math inline">\(M&#39;&#39;\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> By definition, <span class="math inline">\(f_p[s](a)
= |a|^{\rho + s} = |a&#39;|^{\rho + s} |a&#39;&#39;|^{\rho +
s}\)</span>. Writing <span class="math inline">\(\sigma = \sigma &#39; +
\sigma &#39;&#39;\)</span>, the integral <a href="#eq:thetap_p-:=-int"
data-reference-type="eqref"
data-reference="eq:thetap_p-:=-int">\((20.12)\)</a> factors as
the product of the two integrals <span class="math display">\[\int
_{(\sigma&#39;)}
    |a&#39;|^{\rho + s}
    \, d \mu_{A&#39;(\mathbb{Q}_p)}(s),
    \quad
    \int _{(\sigma &#39;&#39;)}
    |a&#39;&#39;|^{\rho + s}
    \zeta_p(N&#39;&#39;,s) \, d
\mu_{A&#39;&#39;(\mathbb{Q}_p)}(s).\]</span> The first integral
evaluates to <span
class="math inline">\(1_{A&#39;(\mathbb{Z}_p)}(a&#39;)\)</span>. By
definition, <span
class="math display">\[\Theta_p^{M&#39;&#39;}(a&#39;&#39;) = \int
_{(\sigma &#39;&#39;)} |a&#39;&#39;|^{\rho &#39;&#39; + s}
\zeta_p(N&#39;&#39;,s) \, d \mu_{A&#39;&#39;(\mathbb{Q}_p)}(s),\]</span>
where <span class="math inline">\(\rho &#39;&#39;\)</span> denotes the
half-sum of positive roots for <span
class="math inline">\(N&#39;&#39;\)</span>. We have <span
class="math inline">\(|a&#39;&#39;|^{\rho} = |a&#39;&#39;|^{\rho
&#39;&#39;} |\det a&#39;&#39;|^{-n&#39;}\)</span>. The required identity
follows by noting, as in §<a href="#sec:basic-vectors-local"
data-reference-type="ref"
data-reference="sec:basic-vectors-local">3.7.1</a>, that <span
class="math inline">\(|\det a&#39;&#39;| = 1\)</span> for <span
class="math inline">\(a&#39;&#39;\)</span> in the support of <span
class="math inline">\(\Theta_p^{M&#39;&#39;}\)</span>. ◻</p>
</div>
<p>We now use the functions <span
class="math inline">\(\Theta^P_p\)</span> to define, as follows, a
linear map <span class="math display">\[\Theta^P :
\mathcal{S}^e(N(\mathbb{R}) \backslash G(\mathbb{R})) \rightarrow
C^\infty(N(\mathbb{A}) \backslash G(\mathbb{A}))\]</span> <span
class="math display">\[f \mapsto \Theta^P[f].\]</span> We first define
<span class="math inline">\(\Theta^P[f]_\infty \in
\mathcal{S}^e(N(\mathbb{R}) \backslash G(\mathbb{R}))\)</span> by
requiring that the Mellin component <span
class="math inline">\(\Theta^P[f]_\infty [s] \in
\mathcal{I}_\infty(s)\)</span> be given by <span
class="math display">\[\Theta^P[f]_\infty [s] = \mathcal{P}_G(s)
\frac{\zeta(N,s)}{\zeta(N&#39;&#39;, s)} f[s].\]</span> We emphasize
that this product of <span class="math inline">\(\zeta\)</span> values,
formed by Euler products over the finite primes, is being employed as a
Mellin multiplier at the archimedean place. Doing so turns out to have
the effect of detecting cancellation from an otherwise large global sum
(cf. the final paragraphs of §<a href="#sec:strong-approximation"
data-reference-type="ref"
data-reference="sec:strong-approximation">3.9</a>). We then define <span
class="math inline">\(\Theta^P[f] : N(\mathbb{A}) \backslash
G(\mathbb{A}) \rightarrow \mathbb{C}\)</span> by <span
class="math display">\[\Theta^P[f](g) := \Theta^P[f]_{\infty}(g_\infty)
\prod_p \Theta^P_p (g _{p}),\]</span> noting that for given <span
class="math inline">\(g\)</span>, all but finitely many factors in this
product are equal to <span class="math inline">\(1\)</span>. For
notational convenience in what follows, we write <span
class="math display">\[\Theta^P[f]_p := \Theta_p^P.\]</span></p>
<div id="lem:sub-gln:each-g-in" class="lemma">
<p><strong>Lemma 301</strong>. Let <span class="math inline">\(f \in
\mathcal{S}(N(\mathbb{R}) \backslash G(\mathbb{R}))\)</span>. For each
<span class="math inline">\(g \in G(\mathbb{A})\)</span> and <span
class="math inline">\(P\)</span> as above, the series <span
class="math inline">\(\sum _{c \in A(\mathbb{Q}) } \Theta^P[f](c^{-1}
g)\)</span> converges absolutely, locally uniformly in <span
class="math inline">\(g\)</span>, and we have <span id="eq:sum-_c-in-1" class="math display">\[\label{eq:sum-_c-in-1}\tag{20.14}
    \sum _{c \in A(\mathbb{Q}) } \Theta^P[f](c^{-1} g) =
\Phi[f](g).\]</span> We have <span id="eq:wpphif_inftyg-=-sum" class="math display">\[\label{eq:wpphif_inftyg-=-sum}\tag{20.15}
    W^P[\Phi[f]](g) = \sum _{c \in A(\mathbb{Q})}
    \int _{u \in N&#39;&#39;(\mathbb{A})}
    \Theta^P[f]
    (
    c^{-1} w_{M&#39;&#39;}^{-1} u g
    )
    \psi^{-1}(u) \, d u,\]</span> where the RHS converges
absolutely.</p>
</div>
<div class="proof">
<p><em>Proof.</em> To verify the first convergence assertion, it
suffices to show more precisely that the double sum <span id="eq:sum-_gamma-in-1" class="math display">\[\label{eq:sum-_gamma-in-1}\tag{20.16}
    \sum _{\gamma \in {B}_{M&#39;&#39;}(\mathbb{Q}) \backslash
M&#39;&#39;(\mathbb{Q})}
    \sum _{c \in A(\mathbb{Q})} \Theta^P[f](c^{-1} \gamma g)\]</span>
converges absolutely. (In the special case <span class="math inline">\(P
= G\)</span>, we will see eventually that this double sum coincides with
<span class="math inline">\(\mathop{\mathrm{Eis}}[\Phi[f]]\)</span>;
otherwise, it is an Eisenstein series on the smaller group <span
class="math inline">\(M&#39;&#39;\)</span> attached to the restriction
of some translate of <span class="math inline">\(\Phi[f]\)</span>.) To
that end, write <span class="math inline">\(g = a k\)</span> with <span
class="math inline">\(a \in A(\mathbb{A})\)</span>, <span
class="math inline">\(k \in K\)</span>. The required convergence depends
only upon the coset of <span class="math inline">\(a\)</span> modulo
<span class="math inline">\(A(\mathbb{Q})\)</span>. Since <span
class="math inline">\(A\)</span> is a split torus and <span
class="math inline">\(\mathbb{Q}\)</span> has class number one, we have
<span class="math inline">\(A(\mathbb{A}) = A(\mathbb{Q}) A(\mathbb{R})
\prod_p A(\mathbb{Z}_p)\)</span>. Since <span
class="math inline">\(\Theta^P[f]\)</span> is left-invariant under <span
class="math inline">\(\prod_p A(\mathbb{Z}_p)\)</span> and
right-invariant under <span class="math inline">\(K_p\)</span>, we may
thus reduce to verifying the convergence and the identity in the special
case that <span class="math inline">\(a_p = 1\)</span> and <span
class="math inline">\(k_p = 1\)</span> for all <span
class="math inline">\(p\)</span>. By translating <span
class="math inline">\(f\)</span> on the right, we may reduce further to
verifying convergence when <span class="math inline">\(g_\infty =
1\)</span>, provided that we bound the series by a <span
class="math inline">\(G(\mathbb{R})\)</span>-continuous seminorm in
<span class="math inline">\(f\)</span> so as to obtain the required
local uniformity. Our task is then to verify the convergence of <span
class="math display">\[\sum _{\gamma \in {B}_{M&#39;&#39;}(\mathbb{Q})
\backslash M&#39;&#39;(\mathbb{Q})}
    \sum _{c \in A(\mathbb{Q})}
    \Theta^P[f](c^{-1} \gamma).\]</span> Writing <span
class="math inline">\(c = c&#39; c&#39;&#39;\)</span> with <span
class="math inline">\((c&#39;,c&#39;&#39;) \in A&#39;(\mathbb{Q}) \times
A&#39;&#39;(\mathbb{Q})\)</span>, we can replace the sum over <span
class="math inline">\(c\)</span> with a double sum over <span
class="math inline">\(c&#39;\)</span> and <span
class="math inline">\(c&#39;&#39;\)</span>. For <span
class="math inline">\(\gamma \in M&#39;&#39;(\mathbb{Q})\)</span>, we
see from Lemma <a href="#lem:Theta-P-p" data-reference-type="ref"
data-reference="lem:Theta-P-p">300</a> that <span
class="math inline">\(\Theta^P_p(c^{-1} \gamma) \neq 0\)</span> only if
each entry of <span class="math inline">\(c&#39;\)</span> is a <span
class="math inline">\(p\)</span>-adic unit. For this to happen for all
<span class="math inline">\(p\)</span>, the element <span
class="math inline">\(c&#39;\)</span> must lie in <span
class="math inline">\(A(\mathbb{Z})\)</span>, which is a finite group
(of order <span class="math inline">\(2^n\)</span>). For the purpose of
verifying convergence, we may thus drop the <span
class="math inline">\(c&#39;\)</span> sum. We are left to verify the
convergence of the remaining sum over <span class="math inline">\(\gamma
\in {B}_{M&#39;&#39;}(\mathbb{Q}) \backslash
M&#39;&#39;(\mathbb{Q})\)</span> and <span
class="math inline">\(c&#39;&#39; \in A&#39;&#39;(\mathbb{Q})\)</span>,
which may be unfolded as <span class="math display">\[\sum _{\gamma \in
N&#39;&#39;(\mathbb{Q}) \backslash M&#39;&#39;(\mathbb{Q})}
    \Theta^P[f](\gamma)
    =
    \sum _{\gamma \in N&#39;&#39;(\mathbb{Q}) \backslash
M&#39;&#39;(\mathbb{Q})}
    \Theta^P[f]_\infty (\gamma)
    \prod _p
    \Theta^P_p(\gamma).\]</span> By Lemma <a href="#lem:Theta-P-p"
data-reference-type="ref" data-reference="lem:Theta-P-p">300</a>, we
have <span class="math inline">\(\Theta_p^P(\gamma) =
\Theta_p^{M&#39;&#39;}(\gamma)\)</span>. The restriction of <span
class="math inline">\(\Theta^P[f]_\infty\)</span> to <span
class="math inline">\(M&#39;&#39;(\mathbb{R})\)</span> is an element of
<span class="math inline">\(\mathcal{S}(N&#39;&#39;(\mathbb{R})
\backslash M&#39;&#39;(\mathbb{R}))\)</span>, hence decays rapidly with
respect to the Iwasawa <span
class="math inline">\(A&#39;&#39;(\mathbb{R})\)</span>-component. The
required convergence now follows from Lemma <a
href="#lem:sub-gln:let-m-in" data-reference-type="ref"
data-reference="lem:sub-gln:let-m-in">299</a>, applied with <span
class="math inline">\(G\)</span> replaced by <span
class="math inline">\(M&#39;&#39;\)</span>.</p>
<p>Let us now abbreviate <span class="math inline">\(\Phi :=
\Phi[f]\)</span>. We have seen that the series <span
class="math display">\[\Phi ^P(g) := \sum _{c \in A(\mathbb{Q})}
\Theta^P[f](c ^{-1} g)\]</span> converges absolutely. We verify now that
<span class="math inline">\(\Phi^P = \Phi\)</span>. Let <span
class="math inline">\(\sigma \in \mathfrak{a}^*\)</span> be strictly
dominant. Both <span class="math inline">\(\Phi\)</span> and <span
class="math inline">\(\Phi ^P\)</span> are left-invariant under <span
class="math inline">\(\prod_p A(\mathbb{Z}_p)\)</span> and <span
class="math inline">\(\{a \in A(\mathbb{R}) : |a|^s = 1 \text{ for all }
s \}\)</span>. For all <span class="math inline">\(s\)</span>, the
integral <span class="math display">\[\int _{a \in [A]} |a|^{\rho + s}
\Phi(a^{-1} g) \, d a\]</span> converges absolutely and evaluates to
<span class="math inline">\(\Phi[s]\)</span>. Thus by Mellin inversion
for integrable functions, it will suffice to check that the integrals
<span id="eq:int-_a-in" class="math display">\[\label{eq:int-_a-in}\tag{20.17}
    \int _{a \in [A]} |a|^{\rho + s} \Phi ^P (a ^{-1} g) \, d a\]</span>
converge absolutely and evaluate to <span
class="math inline">\(\Phi[s]\)</span>.</p>
<p>To that end, we note the stronger assertion that <span id="eq:int-_a-in-1" class="math display">\[\label{eq:int-_a-in-1}\tag{20.18}
    \int _{a \in [A]} |a|^{\rho + \sigma} \sum_{c \in A(\mathbb{Q})}
    \left\lvert
      \Theta^P[f](c^{-1} a^{-1} g)
    \right\rvert
    \, d a &lt; \infty.\]</span> In establishing <a
href="#eq:int-_a-in-1" data-reference-type="eqref"
data-reference="eq:int-_a-in-1">\((20.18)\)</a>, it suffices by
strong approximation to consider the case <span class="math inline">\(g
\in G(\mathbb{R})\)</span>. The above integral unfolds and then factors
as a product of the archimedean integral <span
class="math display">\[\int _{a \in A(\mathbb{R})} |a|^{\rho + \sigma}
    \left\lvert
      \Theta^P[f](a^{-1} g)
    \right\rvert
    \, d a,\]</span> which converges because <span
class="math inline">\(\Theta^P[f] \in \mathcal{S}(U(\mathbb{R})
\backslash G(\mathbb{R}))\)</span>, and the <span
class="math inline">\(p\)</span>-adic integrals <span
class="math display">\[\int _{a \in A(\mathbb{Q}_p)} |a|^{\rho + \sigma}
    \Theta_p^P(a^{-1})
    \, d a,\]</span> which evaluate to the local zeta factor <span
class="math inline">\(\zeta_p(N,\sigma)\)</span>. Since <span
class="math inline">\(\sigma\)</span> is strictly dominant, the product
of these factors converges, whence <a href="#eq:int-_a-in-1"
data-reference-type="eqref"
data-reference="eq:int-_a-in-1">\((20.18)\)</a>.</p>
<p>In particular, the integrals <a href="#eq:int-_a-in"
data-reference-type="eqref"
data-reference="eq:int-_a-in">\((20.17)\)</a> converge absolutely. By
interchanging summation with integration, we obtain <span
class="math display">\[\int _{a \in [A]} |a|^{\rho + s}
    \Phi ^P (a^{-1} g) \, d a
    =
    \int _{a \in A(\mathbb{A})}
    |a|^{\rho + s}
    \Theta^P[f] (a ^{-1} g) \, d a.\]</span> This last integral factors
as a convergent product of local integrals and evaluates to the
convergent Euler product <span
class="math inline">\(\prod_{\mathfrak{p}}
\Theta^P[f]_\mathfrak{p}[s](g_\mathfrak{p}) = \Phi[s](g)\)</span>, as
required.</p>
<p>It remains only to verify the identity of (partial) Whittaker
functions <a href="#eq:wpphif_inftyg-=-sum" data-reference-type="eqref"
data-reference="eq:wpphif_inftyg-=-sum">\((20.15)\)</a>.
The absolute convergence of the double sum <a href="#eq:sum-_gamma-in-1"
data-reference-type="eqref"
data-reference="eq:sum-_gamma-in-1">\((20.16)\)</a> implies, in
particular, the absolute convergence of the contribution of the open
Bruhat cell in <span class="math inline">\({B}_{M&#39;&#39;}(\mathbb{Q})
\backslash M&#39;&#39;(\mathbb{Q})\)</span>, i.e., that of <span
class="math display">\[\sum _{b \in N&#39;&#39;(\mathbb{Q})}
    \sum _{c \in A(\mathbb{Q})}
    \Theta^P[f]
    (
    c^{-1} w_{M&#39;&#39;}^{-1} b g
    ),\]</span> locally uniformly in <span
class="math inline">\(g\)</span>, hence also the absolute convergence of
the triple sum/integral <span class="math display">\[I(g)
    :=
    \int _{u \in [N&#39;&#39;]}
    \sum _{b \in N&#39;&#39;(\mathbb{Q})}
    \sum _{c \in A(\mathbb{Q})}
    \Theta^P[f]
    (
    c^{-1} w_{M&#39;&#39;}^{-1} b u g
    ) \psi^{-1}(u) \, d u\]</span> upon recalling that <span
class="math inline">\([N&#39;&#39;]\)</span> is compact. By evaluating
the sum over <span class="math inline">\(c\)</span> using the identity
<a href="#eq:sum-_c-in-1" data-reference-type="eqref"
data-reference="eq:sum-_c-in-1">\((20.14)\)</a> established above
and unfolding the integral/sum over <span
class="math inline">\(u\)</span> and <span
class="math inline">\(b\)</span>, we see that <span
class="math inline">\(I(g) = W^P[\Phi[f]](g)\)</span>. If we instead
rearrange <span class="math inline">\(I(g)\)</span> as <span
class="math inline">\(\sum_{A(\mathbb{Q}) } \int_{[N&#39;&#39;]}
\sum_{N&#39;&#39;(\mathbb{Q})}\)</span> and unfold, we obtain the RHS of
<a href="#eq:wpphif_inftyg-=-sum" data-reference-type="eqref"
data-reference="eq:wpphif_inftyg-=-sum">\((20.15)\)</a>.
The required identity <a href="#eq:wpphif_inftyg-=-sum"
data-reference-type="eqref"
data-reference="eq:wpphif_inftyg-=-sum">\((20.15)\)</a>
follows. ◻</p>
</div>
<h4 id="sec:strong-approximation">§20.9. Strong approximation</h4>
<p>We now use the series expressions derived in §<a
href="#sec:seri-repr-via" data-reference-type="ref"
data-reference="sec:seri-repr-via">3.8</a> to partially evaluate the
integrals appearing in Proposition <a
href="#prop:bound-after-theta-degenerate-case-2"
data-reference-type="ref"
data-reference="prop:bound-after-theta-degenerate-case-2">297</a>. We
denote in what follows by <span class="math display">\[K&#39;  =
\prod_\mathfrak{p} K_\mathfrak{p} &#39; \leqslant M&#39;(\mathbb{A}),
\quad K&#39;&#39; = \prod_\mathfrak{p} K_\mathfrak{p} &#39;&#39;
\leqslant M&#39;&#39;\]</span> the standard maximal compact subgroups,
defined like <span class="math inline">\(K =\prod_\mathfrak{p}
K_\mathfrak{p} \leqslant G(\mathbb{A})\)</span>.</p>
<div id="lem:sub-gln:let-phi-in" class="lemma">
<p><strong>Lemma 302</strong>. Let <span class="math inline">\(\phi \in
C_c^\infty(V(\mathbb{A}))\)</span> be nonnegative-valued and <span
class="math inline">\(K\)</span>-invariant. Let <span
class="math inline">\(f \in \mathcal{S}(N(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span>. For <span class="math inline">\((c,g) \in
A(\mathbb{Q}) \times G(\mathbb{A})\)</span>, we introduce the temporary
notation <span class="math display">\[W(c,g) := \int _{u \in
N&#39;&#39;(\mathbb{A})} \Theta^P[f](c^{-1} w_{M&#39;&#39;}^{-1} u g)
\psi^{-1} (u) \, d u.\]</span> We have <span id="eq:mathc-f_infty-leq" class="math display">\[\label{eq:mathc-f_infty-leq}\tag{20.19}
  \mathcal{Q}_P(\phi,f)
    \leqslant
    2^{n&#39;}
  \int _{
    \substack{
      g \in N(\mathbb{R}) \backslash G(\mathbb{R}) \\
      a&#39;&#39; \in A&#39;&#39;(\mathbb{A}^\infty)
    }
  }
  \phi(e_n g a&#39;&#39;)
  \left\lvert
    \sum _{c \in A&#39;&#39;(\mathbb{Q})}
    W(c,g a&#39;&#39;)
  \right\rvert^2
  \, d g \frac{d a&#39;&#39;}{\delta_N(a&#39;&#39;)}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Abbreviate <span class="math inline">\(\mathcal{W} :=
W^P[\Phi[f]]\)</span>, thus <span class="math inline">\(\mathcal{W} :
G(\mathbb{A}) \rightarrow \mathbb{C}\)</span>. Note that <span
class="math inline">\(\phi(e_n g)\)</span> depends only upon the bottom
row of <span class="math inline">\(g\)</span>. Using the Iwasawa
decompositions for <span class="math inline">\(G\)</span> and <span
class="math inline">\(M&#39;\)</span> and a careful computation of Haar
measures, we may write the integral <span class="math inline">\(I :=
\mathcal{Q}_P(\phi,f)\)</span> to be estimated as <span
class="math display">\[I = \int _{a&#39;&#39; \in
A&#39;&#39;(\mathbb{A})}
  \phi(e_n a&#39;&#39;)
  \int _{k \in K}
  \int _{a&#39; \in [A&#39;]}
  \int _{k&#39; \in K&#39;}
  |\mathcal{W}(a&#39; k&#39; a&#39;&#39; k)|^2
  \, d k&#39; \, \frac{d a&#39;}{\delta_N(a&#39;)}
  \, d k \, \frac{d a&#39;&#39;}{\delta_N(a&#39;&#39;)}.\]</span> The
integrand is invariant in the <span
class="math inline">\(a&#39;\)</span>-variable under <span
class="math inline">\(\prod_p A&#39;(\mathbb{Z}_p)\)</span>. By strong
approximation and the fact that <span
class="math inline">\(\mathbb{Q}\)</span> has class number one, we can
replace the integral over <span class="math inline">\([A&#39;]\)</span>
with one over <span class="math inline">\(A&#39;(\mathbb{Z}) \backslash
A&#39;(\mathbb{R})\)</span>. Next, we observe that the integrand is
invariant is the <span class="math inline">\(k&#39;\)</span>-variable
under <span class="math inline">\(\prod_p K_p&#39;\)</span> and in the
<span class="math inline">\(k\)</span>-variable under <span
class="math inline">\(\prod_p K_p\)</span>. We may thus restrict the
<span class="math inline">\(k&#39;\)</span> and <span
class="math inline">\(k\)</span> integrals to <span
class="math inline">\(K&#39;_\infty\)</span> and <span
class="math inline">\(K_\infty\)</span>, respectively. Having restricted
the integration in this way, we now open the series expression for <span
class="math inline">\(\mathcal{W}\)</span> given by Lemma <a
href="#lem:sub-gln:each-g-in" data-reference-type="ref"
data-reference="lem:sub-gln:each-g-in">301</a>, which reads <span
class="math display">\[\mathcal{W}(g) = \sum _{c \in A(\mathbb{Q})}
W(c,g).\]</span> Specializing to <span class="math inline">\(g = a&#39;
k&#39; a&#39;&#39; k\)</span> with <span
class="math inline">\((a&#39;,k&#39;,a&#39;&#39;,k) \in
A&#39;(\mathbb{Z}) \backslash A&#39;(\mathbb{R}) \times K&#39;_\infty
\times A&#39;&#39;(\mathbb{A}) \times K_\infty\)</span> gives <span
class="math display">\[\Theta^P[f](c^{-1} w_{M&#39;&#39;}^{-1} u g)
  =
  \Theta^P[f]_\infty(c^{-1} w_{M&#39;&#39;}^{-1} u_\infty a&#39; k&#39;
a&#39;&#39;_\infty k)
  \prod_{p}
  \Theta^P_p(c^{-1} w_{M&#39;&#39;}^{-1} u_p a&#39;&#39;_p).\]</span> We
further factor <span class="math inline">\(c = c&#39;
c&#39;&#39;\)</span>, with <span class="math inline">\((c&#39;,
c&#39;&#39;) \in A&#39;(\mathbb{Q}) \times
A&#39;&#39;(\mathbb{Q})\)</span>. For orientation, we note that the
arguments of <span class="math inline">\(\Theta^P[f]_\infty\)</span> and
<span class="math inline">\(\Theta_p^P\)</span> may be visualized as the
block-diagonal matrices <span class="math display">\[c^{-1}
w_{M&#39;&#39;}^{-1} u_\infty a&#39; k&#39; a&#39;&#39;_\infty k
  =
  \begin{pmatrix}
    (c&#39;)^{-1} a&#39; k&#39; &amp; 0 \\
    0 &amp; (c&#39;&#39;)^{-1} w_{M&#39;&#39;}^{-1} u_\infty
a&#39;&#39;_\infty
  \end{pmatrix} k\]</span> and <span class="math display">\[c^{-1}
w_{M&#39;&#39;}^{-1} u_p a_p&#39;&#39;
  =
  \begin{pmatrix}
    (c&#39;)^{-1} &amp; 0 \\
    0 &amp; (c&#39;&#39;)^{-1} w_{M&#39;&#39;}^{-1} u_p a_p&#39;&#39;
  \end{pmatrix}.\]</span> From this and <a href="#eq:thet-=-1_am"
data-reference-type="eqref"
data-reference="eq:thet-=-1_am">\((20.13)\)</a>, we see that the
product <span class="math inline">\(\prod_p \Theta_p^P(c^{-1}
w_{M&#39;&#39;}^{-1} u_p a_p&#39;&#39;)\)</span> is nonzero only if
<span class="math inline">\(c&#39; \in A&#39;(\mathbb{Z})\)</span>, in
which case that product is independent of the precise value of <span
class="math inline">\(c&#39;\)</span>. The set <span
class="math inline">\(A&#39;(\mathbb{Z})\)</span> has <span
class="math inline">\(2^{n&#39;} = \operatorname{O}(1)\)</span>
elements. By our assumption that the function <span
class="math inline">\(\phi\)</span> is nonnegative and Cauchy–Schwarz,
we obtain <span class="math display">\[I \leqslant
  2^{n&#39;}
  \int _{
    \substack{
      a&#39;&#39; \in A&#39;&#39;(\mathbb{A})  \\
      k \in K_\infty  \\
      a&#39; \in A&#39;(\mathbb{Z}) \backslash A&#39;(\mathbb{R}) \\
      k&#39; \in K&#39;_\infty
    }
  }
  \phi(e_n a&#39;&#39;)
  \sum _{c&#39; \in A&#39;(\mathbb{Z})}
  \left\lvert
    \sum _{c&#39;&#39; \in A&#39;&#39;(\mathbb{Q})}
    W(c&#39; c&#39;&#39;, a&#39; k&#39; a&#39;&#39; k)
  \right\rvert^2
  \, d k&#39; \, d k \, \frac{d a&#39; \, d a&#39;&#39;}{\delta_N(a&#39;
a&#39;&#39;)}.\]</span> We may further unfold the integral over <span
class="math inline">\(a&#39;\)</span> with the sum over <span
class="math inline">\(c&#39;\)</span>, giving <span
class="math display">\[I
  \leqslant
    2^{n&#39;}
  \int _{
    \substack{
    a&#39;&#39; \in A&#39;&#39;(\mathbb{A})  \\
      k \in K_\infty  \\
      a&#39; \in A&#39;(\mathbb{R}) \\
      k&#39; \in K&#39;_\infty
    }
  }
  \phi(e_n a&#39;&#39;)
  \left\lvert
  \sum _{c \in A&#39;&#39;(\mathbb{Q})}
  W(c,a&#39; k&#39; a&#39;&#39; k)
  \right\rvert^2
  \, d k&#39; \, d k \, \frac{d a&#39; \, d a&#39;&#39;}{\delta_N(a&#39;
a&#39;&#39;)}.\]</span> Finally, we factor <span
class="math inline">\(A&#39;&#39;(\mathbb{A}) = A&#39;&#39;(\mathbb{R})
\times A&#39;&#39;(\mathbb{A}^\infty)\)</span> and recombine the
archimedean integrals, giving the required estimate. ◻</p>
</div>
<p>With Lemma <a href="#lem:sub-gln:let-phi-in"
data-reference-type="ref"
data-reference="lem:sub-gln:let-phi-in">302</a>, the stage is now set
for the final steps of the proof. The integral <span
class="math inline">\(W(c,g)\)</span> appearing in that lemma is
Eulerian, so opening the square on the RHS of <a
href="#eq:mathc-f_infty-leq" data-reference-type="eqref"
data-reference="eq:mathc-f_infty-leq">\((20.19)\)</a> yields
a sum, indexed by (say) <span class="math inline">\(b,c \in
A&#39;&#39;(\mathbb{Q})\)</span>, of Eulerian integrals: <span
class="math display">\[\int _{
    \substack{
      g \in N(\mathbb{R}) \backslash G(\mathbb{R}) \\
      a&#39;&#39; \in A&#39;&#39;(\mathbb{A}^\infty)
    }
  }
  \phi(e_n a&#39;&#39;)
  W(b, g a&#39;&#39;)
  \overline{W(c, g a&#39;&#39;)}
  \, d g \frac{d a&#39;&#39;}{\delta_N(a&#39;&#39;)}.\]</span> The
estimation of such integrals is a local problem, which we address below
in §<a href="#sec:local-estimates" data-reference-type="ref"
data-reference="sec:local-estimates">4</a>.</p>
<p>The non-archimedean local integrals will turn out to detect the
diagonal condition <span class="math inline">\(b = c\)</span>, up to
essentially bounded multiplicity, and we will not need to detect
cancellation coming from the global sum over <span
class="math inline">\(b\)</span> and <span
class="math inline">\(c\)</span>. This pleasant feature is the
motivation for why, for the analysis of <span
class="math inline">\(\mathcal{Q}_P(\phi, f)\)</span>, we represented
<span class="math inline">\(\Phi[f]\)</span> by the series <a
href="#eq:sum-_c-in-1" data-reference-type="eqref"
data-reference="eq:sum-_c-in-1">\((20.14)\)</a> involving <span
class="math inline">\(\Theta^P[f]\)</span>, whose definition was
carefully tailored to <span class="math inline">\(P\)</span>. For
instance, had we instead used the series involving <span
class="math inline">\(\Theta^G[f]\)</span> in the study of <span
class="math inline">\(\mathcal{Q}_P(\phi,f)\)</span> for some <span
class="math inline">\(P \neq G\)</span>, we would be facing additional
sums over <span class="math inline">\(A&#39;(\mathbb{Q})\)</span> from
which it would be necessary to extract cancellation. It would still be
possible to do so by further careful analysis, but in effect, that
cancellation is “baked in” to our argument through the careful choice of
series representation for <span
class="math inline">\(\Phi[f]\)</span>.</p>
<p>By Cauchy–Schwarz and the positivity of <span
class="math inline">\(\phi\)</span>, we may thus reduce to estimating
the archimedean integrals in the case <span
class="math inline">\(b=c\)</span>. That estimation is the most delicate
part of the argument, requiring three different approaches depending
upon the relative sizes of <span class="math inline">\(T\)</span>, <span
class="math inline">\(r\)</span> and <span
class="math inline">\(c\)</span>.</p>
<p>After completing the local analysis, we resume the global thread in
§<a href="#sec:completion-proof-1" data-reference-type="ref"
data-reference="sec:completion-proof-1">5</a> and complete the proof of
Proposition <a href="#prop:bound-after-theta-degenerate-case-2"
data-reference-type="ref"
data-reference="prop:bound-after-theta-degenerate-case-2">297</a>, hence
of our main results.</p>
<h3 id="sec:local-estimates">§21. Local estimates</h3>
<h4 id="sec:whitt-funct-attach">§21.1. Whittaker functions attached to Schwartz
functions</h4>
<p>Let <span class="math inline">\(F\)</span> be a local field. Set
<span class="math inline">\(G := {\mathop{\mathrm{GL}}}_n(F)\)</span>,
with <span class="math inline">\(n\)</span> fixed. As usual, let <span
class="math inline">\(A\)</span> denote the diagonal subgroup, <span
class="math inline">\(N\)</span> the subgroup of upper-triangular
unipotent matrices, <span class="math inline">\(K\)</span> the standard
maximal compact subgroup, and <span class="math inline">\(Z\)</span> the
center. We take for <span class="math inline">\(\psi\)</span> either the
standard nondegenerate unitary character of <span
class="math inline">\(N\)</span> or its inverse (§<a
href="#eq:psin-=-psi_f" data-reference-type="ref"
data-reference="eq:psin-=-psi_f">2.23</a>).</p>
<p>For <span class="math inline">\(f \in C^\infty(N \backslash
G)\)</span> and <span class="math inline">\((c,g) \in A \times
G\)</span>, we define <span class="math display">\[W(f,c,g) :=
\delta_N^{1/2}(c) \int _{u \in N} f(c^{-1} w^{-1}_G u g) \psi^{-1}(u) \,
d u,\]</span> provided that it converges absolutely. (We recall that
<span class="math inline">\(w_G^{-1} = w_G\)</span>, so the reader can
ignore the inverses if desired.)</p>
<div id="lem:standard2:let-f-in" class="lemma">
<p><strong>Lemma 303</strong>. Let <span class="math inline">\(f \in
C^\infty(N \backslash G)\)</span>. Suppose that for some strictly
dominant element <span class="math inline">\(\omega \in
\mathfrak{a}^*\)</span>, there exists <span class="math inline">\(C
\geqslant 0\)</span> so that for all <span class="math inline">\((a,k)
\in A \times K\)</span>, <span id="eq:fa-k-leq" class="math display">\[\label{eq:fa-k-leq}\tag{21.1}
    |f(a k)| \leqslant C |a|^{\rho + \omega}.\]</span> Then the integral
defining <span class="math inline">\(W(f,c,g)\)</span> converges
absolutely for all <span class="math inline">\((c,g)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> This reduces to fact that, if <span
class="math inline">\(f(a k) = |a|^{\rho + \omega}\)</span> for some
such <span class="math inline">\(\omega\)</span>, then <span
class="math display">\[\int_{N} f(w^{-1}_G n) \, d n&lt; \infty\]</span>
(see <a href="#ref-MR1170566" class="citation" data-cites="MR1170566">(Wallach 1992, vol.
132, sec. 10.1.2)</a>). ◻</p>
</div>
<p>We will primarily apply the above definition to elements <span
class="math inline">\(f\)</span> of the Schwartz space <span
class="math inline">\(\mathcal{S}(N \backslash G)\)</span>, for which
the hypotheses of Lemma <a href="#lem:standard2:let-f-in"
data-reference-type="ref"
data-reference="lem:standard2:let-f-in">303</a> are valid (in stronger
form, without the restriction to strictly dominant elements).</p>
<h4 id="bounds-at-finite-places">Bounds at finite places</h4>
<p>We retain the notation of §<a href="#sec:whitt-funct-attach"
data-reference-type="ref"
data-reference="sec:whitt-funct-attach">4.1</a>, but assume here that
<span class="math inline">\(F\)</span> is a non-archimedean local
field.</p>
<p>We pause to introduce some notation. Let <span
class="math inline">\(\mu, \lambda \in \mathbb{Z}^n\)</span>. We may
identify these with weights for the diagonal torus in the complex
algebraic group <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{C})\)</span>.
Assume that <span class="math inline">\(\lambda\)</span> is
<em>dominant</em> in the sense that <span
class="math inline">\(\lambda_1 \geqslant\dotsb
\geqslant\lambda_n\)</span>. It corresponds then to an irreducible
algebraic representation <span class="math inline">\(V_\lambda\)</span>,
of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathbb{C})\)</span>, of
highest weight <span class="math inline">\(\lambda\)</span>. We denote
by <span class="math inline">\(\mathfrak{M}_{\lambda}(\mu)\)</span> the
multiplicity of the weight <span class="math inline">\(\mu\)</span> in
the representation <span class="math inline">\(V_\lambda\)</span>. For
example, <span class="math inline">\(\mathfrak{M}_{\lambda}(\lambda) =
1\)</span>, and more generally <span
class="math inline">\(\mathfrak{M}_{\lambda}(w \lambda) = 1\)</span> for
all permutations <span class="math inline">\(w \in S(n)\)</span>. We
extend this definition to all pairs <span
class="math inline">\((\mu,\lambda)\)</span> by adopting the convention
that <span class="math inline">\(\mathfrak{M}_{\lambda}(\mu) :=
0\)</span> if <span class="math inline">\(\lambda\)</span> is not
dominant. We require the following standard properties.</p>
<ol type="i">
<li><p>Suppose <span class="math inline">\(\mathfrak{M}_{\lambda}(\mu)
\neq 0\)</span>. Then <span class="math inline">\(\mu\)</span> lies in
the convex hull of the set of permutations of <span
class="math inline">\(\lambda\)</span>. In particular, <span id="eq:mu_1-+-dotsb" class="math display">\[\label{eq:mu_1-+-dotsb}\tag{21.2}
    \mu_1 + \dotsb + \mu_n = \lambda_1 + \dotsb + \lambda_n,\]</span>
and if <span class="math inline">\(\lambda_n \geqslant 0\)</span>, then
<span id="eq:0-leq-mu_1" class="math display">\[\label{eq:0-leq-mu_1}\tag{21.3}
    0 \leqslant\mu_1,\dotsc,\mu_n \leqslant\lambda_1 + \dotsb +
\lambda_n.\]</span></p></li>
<li><p>We have <span id="eq:mathfr-ll-1" class="math display">\[\label{eq:mathfr-ll-1}\tag{21.4}
\mathfrak{M}_{\lambda}(\mu) \ll (1 +
|\lambda|)^{\operatorname{O}(1)},\]</span> where <span
class="math inline">\(|\lambda|\)</span> denotes the Euclidean norm and
the implied constant depends at most upon <span
class="math inline">\(n\)</span>. Such an estimate is classical, and can
be deduced (in sharper forms) from, e.g., the Kostant partition formula
<a href="#ref-MR1410059" class="citation" data-cites="MR1410059">(Bröcker and Dieck 1995,
98:p258, Theorem IV.3.2)</a>.</p></li>
</ol>
<p>Let <span class="math inline">\(\mathop{\mathrm{ord}}: A \rightarrow
\mathbb{Z}^n\)</span> denote the map assigning to a diagonal matrix
<span class="math display">\[a =
\mathop{\mathrm{diag}}(a_1,\dotsc,a_n)\]</span> the corresponding <span
class="math inline">\(n\)</span>-tuple <span
class="math display">\[\mathop{\mathrm{ord}}(a) =
(\mathop{\mathrm{ord}}(a_1),\dotsc,\mathop{\mathrm{ord}}(a_n)),\]</span>
where for <span class="math inline">\(y = \varpi^k u \in
F^\times\)</span> (<span class="math inline">\(k \in \mathbb{Z}, u \in
\mathfrak{o}^\times\)</span>), we write <span
class="math inline">\(\mathop{\mathrm{ord}}(y) := k\)</span>.</p>
<p>Let <span class="math inline">\(\Theta \in C^\infty(N \backslash
G)\)</span> denote the basic vector, as in §<a
href="#sec:basic-vectors-local" data-reference-type="ref"
data-reference="sec:basic-vectors-local">3.7.1</a>. It is easy to see
from definition of <span class="math inline">\(\Theta\)</span> via a
Mellin integral that it satisfies the estimate <a href="#eq:fa-k-leq"
data-reference-type="eqref"
data-reference="eq:fa-k-leq">\((21.1)\)</a>, so that <span
class="math inline">\(W(\Theta,c,g)\)</span> is defined for <span
class="math inline">\((c,g) \in A \times G\)</span>.</p>
<div id="lem:sub-gln:we-have-begin" class="lemma">
<p><strong>Lemma 304</strong>. For <span class="math inline">\(c, m \in
A\)</span>, we have <span class="math display">\[W(\Theta,c,m) =
\delta_N^{1/2}(m)
\mathfrak{M}_{\mathop{\mathrm{ord}}(m)}(\mathop{\mathrm{ord}}(c)).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline">\(\sigma \in
\mathfrak{a}^*\)</span> be strictly dominant. We then have the
convergent Mellin expansion <span class="math inline">\(\Theta =
\int_{\Re(s) = \sigma} \Theta[s] \, d \mu_A(s)\)</span>, where the
Mellin components <span class="math inline">\(\Theta[s] \in
\mathcal{I}(s)\)</span> are the spherical vectors taking the value <span
class="math inline">\(\zeta_F(N,s)\)</span> at the identity. In
particular, those components satisfy the transformation property <span id="eq:f0sc-1-w_g" class="math display">\[\label{eq:f0sc-1-w_g}\tag{21.5}
    \Theta[s](c^{-1} w^{-1}_G u m)
    =
    \delta_N^{-1/2}(c) |c|^{- s} \Theta[s](w^{-1}_G u m).\]</span> By
the standard convergence lemma for Jacquet integrals <a href="#ref-MR1170566"
class="citation" data-cites="MR1170566">(Wallach 1992, vol. 132, sec.
10.1.2)</a> and the compactness of <span
class="math inline">\(\mathfrak{X}^e(A)\)</span>, the double integral
<span class="math display">\[W(\Theta, c, m) = \delta_N^{1/2}(c) \int
_{u \in N} \int _{\Re(s) = \sigma } \Theta[s](c^{-1} w^{-1}_G u m) \, d
\mu_A(s) \, d u\]</span> converges absolutely, hence rearranges to the
identity <span class="math display">\[W(\Theta,c,m) =
    \int _{\Re(s) = \sigma }
    |c|^{-s}
    W_s^0(m)
    \, d s,\]</span> where we set <span class="math display">\[W_s^0(m)
:= \int _{u \in N} \Theta[s](w^{-1}_G u m) \psi^{-1}(u) \, d u.\]</span>
Using the Casselman–Shalika formula <a
href="#eq:wf0chi-psi1-casselman-shalika" data-reference-type="eqref"
data-reference="eq:wf0chi-psi1-casselman-shalika">\((2.24)\)</a>
and the definition of the basic vector, we see that <span
class="math inline">\(W_s^0\)</span> satisfies the normalization <span
class="math inline">\(W_s^0(1) = 1\)</span>. Thus <span
class="math inline">\(W_s^0\)</span> is the normalized spherical
Whittaker function for the parameter <span
class="math inline">\(s\)</span>. The Shintani formula <a href="#ref-MR407208"
class="citation" data-cites="MR407208">(Shintani 1976)</a> for <span
class="math inline">\(W_s^0(m)\)</span> then reads <span
class="math display">\[W_s^0(m) = \delta_N^{1/2}(m)
S_{\mathop{\mathrm{ord}}(m)}(q^{s_1}, \dotsc, q^{s_n}),\]</span> where
for <span class="math inline">\(\lambda \in \mathbb{Z}^n\)</span>, we
define <span class="math inline">\(S_\lambda := 0\)</span> unless <span
class="math inline">\(\lambda\)</span> is dominant, in which case <span
class="math inline">\(S_\lambda\)</span> is the corresponding Schur
polynomial, given for <span class="math inline">\(z = (z_1,\dotsc,z_n)
\in (\mathbb{C}^\times)^n\)</span> by <span
class="math display">\[S_\lambda(z) = \sum_{\mu \in \mathbb{Z}^n}
\mathfrak{M}_{\lambda}(\mu) \prod_j z_j^{\mu_j}.\]</span> Thus <span
class="math display">\[W(\Theta,c,m) =
    \delta_N^{1/2}(m)
    \sum_{\mu \in \mathbb{Z}^n}
    \mathfrak{M}_{\mathop{\mathrm{ord}}(m)}(\mu)
    \int _{\Re(s) = \sigma } |c|^{-s} \prod_j q^{s_j \mu_j} \, d
s.\]</span> Writing <span class="math inline">\(|c|^{-s} = \prod_j
q^{-s_j \mathop{\mathrm{ord}}(c_j)}\)</span> and appealing to Mellin
inversion, we see that the inner integral detects the condition <span
class="math inline">\(\mu = \mathop{\mathrm{ord}}(c)\)</span>. The
claimed formula follows. ◻</p>
</div>
<div id="lem:sub-gln:b-c-in" class="lemma">
<p><strong>Lemma 305</strong>. For <span class="math inline">\(b, c \in
A\)</span>, define <span class="math display">\[I(b,c) :=
  \int _{g \in N(F) \backslash G(F)}
  1_{\|e_n g\| = 1}
  W  (\Theta, b, g) \overline{W }(\Theta, c, g)
   \, d g.\]</span> We have <span class="math inline">\(I(b,c) =
0\)</span> unless each entry <span
class="math inline">\(b_i,c_j\)</span> is integral and <span
class="math inline">\(\sum_i \mathop{\mathrm{ord}}(b_i) = \sum_j
\mathop{\mathrm{ord}}(c_j)\)</span>, in which case <span
class="math display">\[I(b,c) \ll (1 + \sum_j
\mathop{\mathrm{ord}}(c_j))^{\operatorname{O}(1)}\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> With suitable measure normalizations, we have <span
class="math display">\[I(b,c) =
  \int _{a \in A(\mathbb{Q}_p)}
  1_{|a_n| = 1}
  W  (\Theta, b, a) \overline{W }(\Theta, c, a)
   \, \frac{d^\times a}{\delta_N(a)}.\]</span> By Lemma <a
href="#lem:sub-gln:we-have-begin" data-reference-type="ref"
data-reference="lem:sub-gln:we-have-begin">304</a>, we have <span
class="math display">\[\begin{align}
    I(b,c) &amp;=
             \int _{a \in A(\mathbb{Q}_p)}
             1 _{|a_n| = 1}
             \mathfrak{M}_{\mathop{\mathrm{ord}}(a)}
(\mathop{\mathrm{ord}}(b)) \mathfrak{M} _{\mathop{\mathrm{ord}}(a)}
(\mathop{\mathrm{ord}}(c)) \, d a \\
    &amp;=
    \sum _{
      \substack{
        \lambda  \in \mathbb{Z}^n:  \\
         \text{dominant}, \lambda_n = 0
      }
    }
    \mathfrak{M}_{\lambda }(\mathop{\mathrm{ord}}(b))
    \mathfrak{M}_{\lambda }(\mathop{\mathrm{ord}}(c)).
  
\end{align}\]</span> The vanishing condition on <span
class="math inline">\(I(b,c)\)</span> then follows from <a
href="#eq:mu_1-+-dotsb" data-reference-type="eqref"
data-reference="eq:mu_1-+-dotsb">\((21.2)\)</a> and <a
href="#eq:0-leq-mu_1" data-reference-type="eqref"
data-reference="eq:0-leq-mu_1">\((21.3)\)</a>, while the bound
follows from <a href="#eq:mathfr-ll-1" data-reference-type="eqref"
data-reference="eq:mathfr-ll-1">\((21.4)\)</a>. ◻</p>
</div>
<h4 id="sec:bounds-at-real">§21.3. Bounds at the real place: Whittaker
functions</h4>
<p>We retain the notation of §<a href="#sec:whitt-funct-attach"
data-reference-type="ref"
data-reference="sec:whitt-funct-attach">4.1</a>, but assume here that
<span class="math inline">\(F = \mathbb{R}\)</span>.</p>
<div id="lem:integrate-by-parts-archimedean-whittaker-average-bound"
class="lemma">
<p><strong>Lemma 306</strong>. There is a fixed <span
class="math inline">\(d_1 \in \mathbb{Z}\)</span> so that for each <span
class="math inline">\(f \in \mathcal{S}^e(N \backslash G)\)</span>,
<span class="math inline">\(c \in A\)</span> and <span
class="math inline">\(g \in G\)</span>, <span
class="math display">\[\int _{h \in N_H \backslash H}
  \int _{z \in Z}|W(f,c, h z g)|^2  \, d h \, d z
\ll  \mathcal{S}_{d_1,0}(f)^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> By replacing <span class="math inline">\(f\)</span>
with <span class="math inline">\(R(g) f\)</span> and noting that <span
class="math inline">\(\mathcal{S}_{d_1,0}(R(g) f) =
\mathcal{S}_{d_1,0}(f)\)</span>, we may reduce to the case <span
class="math inline">\(g = 1\)</span>. We consider the Mellin expansion
<span class="math inline">\(f = \int_s f[s] \, d \mu_A(s)\)</span>,
where the Mellin components satisfy the same transformation property <a
href="#eq:f0sc-1-w_g" data-reference-type="eqref"
data-reference="eq:f0sc-1-w_g">\((21.5)\)</a> as in the
non-archimedean case. Then <span class="math display">\[W(f,c,g) =
  \int _{\Re(s) = \sigma}
  |c|^{-s} W_s(f,g) \, d \mu_A(s),\]</span> where <span
class="math inline">\(W_s(f,g) = \int _{u \in N} f[s](w^{-1}_G u g)
\psi^{-1}(u) \, d u\)</span>. For <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span>, write <span
class="math inline">\(\chi_s\)</span> for the corresponding character of
the symmetric algebra <span
class="math inline">\(\mathfrak{U}(A)\)</span>. For <span
class="math inline">\(x \in \mathfrak{U}(A)\)</span>, we have <span
class="math display">\[(L(x) f)_s = \chi_s(x) f_s.\]</span> Thus,
provided that <span class="math inline">\(x\)</span> is chosen so that
<span class="math inline">\(\chi_s(x) \neq 0\)</span> whenever <span
class="math inline">\(\Re(s) = \sigma\)</span>, we have <span id="eq:wf-c-g" class="math display">\[\label{eq:wf-c-g}\tag{21.6}
  W(f,c,g) =
  \int _{\Re(s) = \sigma}
  |c|^{-s} \chi_s(x)^{-1} W_s(L(x) f,g) \, d \mu_A(s).\]</span> Take
<span class="math inline">\(\sigma = 0\)</span>. By the Parseval
relation for the group <span class="math inline">\(Z\)</span>, we have
<span class="math display">\[\int _{z \in Z} |W(f, c, g z)|^2 \, d z
  =
  \int _{t \in i \mathbb{R} }
  \left\lvert
    \int _{
      \substack{
        \Re(s) = 0,  \\
        \mathop{\mathrm{trace}}(s) = t
      }
    }
    |c|^{-s} \chi_s(x)^{-1} W_s(L(x) f, g ) \, d \mu_A^0(s)
  \right\rvert^2
  \, d t,\]</span> where <span class="math inline">\(d \mu_A^0\)</span>
denotes a suitable Haar measure, regarding the integration domain as the
unramified subset of a coset of <span
class="math inline">\((A/Z)^\wedge\)</span>.</p>
<p>Fix <span class="math inline">\(m \in \mathbb{Z}_{\geqslant
0}\)</span> large enough that <span class="math display">\[\int _{
    \substack{
      \Re(s) = 0,  \\
       \mathop{\mathrm{trace}}(s) = t
    }
  }
  (1 + |s|^2)^{-2 m} \, d \mu_A^0(s) \ll 1\]</span> for all <span
class="math inline">\(t \in i \mathbb{R}\)</span>. We may fix <span
class="math inline">\(x\)</span> of degree <span class="math inline">\(2
m\)</span> so that <span class="math inline">\(\chi_s(x) = (1 +
|s|^2)^m\)</span> whenever <span class="math inline">\(\Re(s) =
0\)</span>. Then by Cauchy–Schwarz, <span class="math display">\[\int
_{z \in Z}
  |W(f,c,g z)|^2 \, d z \ll
  \int _{\Re(s) = 0}
  \left\lvert W_s(L(x) f, g)  \right\rvert^2 \, d \mu_A(s).\]</span> We
now integrate over <span class="math inline">\(h \in N_H \backslash
H\)</span>. It is known <a href="#ref-MR2930996" class="citation"
data-cites="MR2930996">(Feigon, Lapid, and Offen 2012, Appendix
A)</a> that for each <span class="math inline">\(s\)</span> with
<span class="math inline">\(\Re(s) = 0\)</span>, we have <span id="eq:int-_g-in-norm" class="math display">\[\label{eq:int-_g-in-norm}\tag{21.7}
  \int _{h \in N_H \backslash H} |W_s(L(x) f, h)|^2 \, d h
  \asymp
  \int _{K} |L(x) f_s|^2,\]</span> where the implied constants depend
only upon measure normalization. Finally, the Parseval relation on <span
class="math inline">\(A\)</span> gives <span
class="math display">\[\int_{\Re(s) = 0} \int_K |L(x) f_s|^2 \, d
\mu_A(s) \asymp \int _{N \backslash G} |L(x) f|^2
  \ll \mathcal{S}_{2 m,0}(f)^2.\]</span> We conclude by taking <span
class="math inline">\(d_1 := 2 m\)</span>. ◻</p>
</div>
<div id="lem:sub-gln:let-f-in-1" class="lemma">
<p><strong>Lemma 307</strong>. There is a fixed <span
class="math inline">\(d_1 \in \mathbb{Z}_{\geqslant 0}\)</span> with the
following property. Let <span class="math inline">\(D &gt; 0\)</span>.
Let <span class="math inline">\(f \in \mathcal{S}(N \backslash
G)\)</span> be such that <span class="math inline">\(f(g) \neq
0\)</span> only if <span class="math inline">\(|\det(g)| \asymp
D\)</span>. Let <span class="math inline">\(c \in A\)</span>. Then the
integral <span class="math display">\[I(c) :=
    \int _{g \in N \backslash G}
    \|e_n g\|^{-n}
    |W(f, c, g)|^2  \, d g\]</span> satisfies the bound <span id="eq:ic-ll-detc" class="math display">\[\label{eq:ic-ll-detc}\tag{21.8}
    I(c) \ll \frac{1}{D |\det(c)|}
\mathcal{S}_{d_1,0}(f)^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We rewrite <span class="math display">\[I(c) =
    \int _{a \in A}
    \int _{k \in K}
    |a_n|^{-n}
    |W(f, c, a k)|^2 \, d k \, \frac{d a}{\delta_N(a)}.\]</span> We
appeal to the identity <span class="math display">\[|a_n|^n \delta_N(a)
= |\det a| \delta_{N_H}(a),\]</span> corresponding to the following
identity for <span class="math inline">\(n\)</span>-tuples of exponents:
<span class="math display">\[\begin{align}
    &amp;\left( 0, \dotsc, 0, n \right) + \left( n-1, \dotsc, 3-n, 1 - n
\right) \\
    &amp;\quad =
    \left( 1, \dotsc, 1, 1 \right)
    +
    \left( n-2, \dotsc, 2-n, 0 \right).
  
\end{align}\]</span> We factor <span class="math inline">\(a = a_H
z\)</span>, where <span class="math inline">\(a_H \in A_H\)</span> and
<span class="math inline">\(z \in Z\)</span>, and then rename <span
class="math inline">\(a_H\)</span> to <span
class="math inline">\(a\)</span>. We also substitute <span
class="math inline">\(k \mapsto k_H k\)</span>, with <span
class="math inline">\(k_H \in K_H\)</span>, and integrate over <span
class="math inline">\(K_H\)</span>. Up to measure normalizations, we
obtain <span class="math display">\[I(c) =
    \int _{a \in A_H}
    \int _{k_H \in K_H}
    \int _{z \in Z}
    \int _{k \in K}
    |W(f, c, a k_H z k)|^2
    |\det(a z)|^{-1}
    \, d k \, d z \, d k \, \frac{d a}{\delta_{N_H}(a)}.\]</span> We can
rewrite this further, again up to measure normalizations, as <span
class="math display">\[I(c) =
    \int _{h \in N_H \backslash H}
    \int _{z \in Z}
    \int _{k \in K}
    |W(f, c, h z k)|^2
    |\det(h z)|^{-1}
    \, d k \, d z \, d h.\]</span> On the support of the integrand, we
have <span class="math inline">\(|\det(h z)| \asymp |\det(c)|
D\)</span>. We may write <span class="math inline">\(W(f,c,h z k) =
W(R(k) f,c,h z)\)</span>. We conclude via Lemma <a
href="#lem:integrate-by-parts-archimedean-whittaker-average-bound"
data-reference-type="ref"
data-reference="lem:integrate-by-parts-archimedean-whittaker-average-bound">306</a>,
noting that <span class="math inline">\(\mathcal{S}_{d_1,0}(f) \asymp
\mathcal{S}_{d_1,0}(R(k) f)\)</span>. ◻</p>
</div>
<p>For <span class="math inline">\(a \in A\)</span>, <span
class="math inline">\(\varepsilon&gt; 0\)</span> and <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, we
introduce the notation <span
class="math display">\[\mathcal{G}_{\varepsilon,\ell}(a) :=
\delta_N^{1/2-\varepsilon}(a)
  \min (\{1\} \cup \{|a|^{-\alpha} : \alpha \in \Delta
\})^{\ell}.\]</span></p>
<div id="lem:sub-gln:let-ell-geq" class="lemma">
<p><strong>Lemma 308</strong>. Let <span class="math inline">\(\ell
\geqslant 0\)</span>. There exists <span class="math inline">\(d_0
\geqslant 0\)</span>, depending only upon <span
class="math inline">\(\ell\)</span> and <span
class="math inline">\(n\)</span>, so that for each <span
class="math inline">\(\varepsilon&gt; 0\)</span>, there exists <span
class="math inline">\(C_0 \geqslant 0\)</span> with the following
property. Let <span class="math inline">\(\pi\)</span> be a generic
tempered irreducible unitary representation of <span
class="math inline">\(G\)</span>, realized in its Whittaker model <span
class="math inline">\(\mathcal{W}(\pi,\psi)\)</span> and with unitary
structure defined via the Kirillov model. Let <span
class="math inline">\(W \in \mathcal{W}(\pi,\psi)\)</span> be a smooth
vector. Let <span class="math inline">\((a,k) \in A \times K\)</span>.
Then <span class="math display">\[|W(a k)| \leqslant C_0
\mathcal{G}_{\varepsilon,\ell}(a) \mathcal{S}_{d_0}(W).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is <a href="#ref-JN19a" class="citation"
data-cites="JN19a">(Jana and Nelson 2019, Lemma 5.2)</a>.<a
href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> ◻</p>
</div>
<div class="remark">
<p><strong>Remark 309</strong>. Lemma <a href="#lem:sub-gln:let-ell-geq"
data-reference-type="ref"
data-reference="lem:sub-gln:let-ell-geq">308</a> is uniform in <span
class="math inline">\(\pi\)</span>, while standard references, such as
<a href="#ref-MR2533003" class="citation" data-cites="MR2533003">(Hervé Jacquet 2009, Prop
3.5)</a>, <a href="#ref-MR1170566" class="citation" data-cites="MR1170566">(Wallach
1992, vol. 132, sec. 15)</a> or <a href="#ref-MR2058615" class="citation"
data-cites="MR2058615">(Hervé Jacquet 2004, Prop 9)</a>, give
uniformity at most for <span class="math inline">\(\pi\)</span> in a
fixed compact set. However, it seems likely that a careful
quantification of the proofs of those estimates would recover the
conclusion of Lemma <a href="#lem:sub-gln:let-ell-geq"
data-reference-type="ref"
data-reference="lem:sub-gln:let-ell-geq">308</a>.</p>
</div>
<div id="lem:sub-gln:let-underlinen-bzp" class="lemma">
<p><strong>Lemma 310</strong>. Let <span
class="math inline">\(\underline{\ell} = (\ell_\alpha)_{\alpha \in
\Delta}\)</span> be a <span class="math inline">\(\Delta\)</span>-tuple
of nonnegative integers. Set <span class="math inline">\(\ell :=
\sum_{\alpha \in \Delta} \ell_\alpha\)</span> and <span
class="math inline">\(u _{\underline{\ell}} := \prod_{\alpha \in \Delta}
X_\alpha^{\ell_\alpha} \in \mathfrak{U}(N)\)</span>, where <span
class="math inline">\(X_\alpha\)</span> is a basis element for the
corresponding root subspace. There exists <span class="math inline">\(C
\geqslant 0\)</span> so that for all <span class="math inline">\(W \in
C^\infty(N \backslash G, \psi)\)</span> and <span
class="math inline">\((a,k) \in A \times K\)</span>, we have <span
class="math display">\[|W(a k)| \leqslant
    C
    |a|^{-\sum_{\alpha \in \Delta} \ell_\alpha \alpha}
    \sup_{x_1,\dotsc,x_\ell \in \mathcal{B}(G) \cup \{1\}}
    |R(x_1 \dotsb x_\ell) W(a k)|.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a step in the proof of <a href="#ref-2018arXiv181200053B" class="citation"
data-cites="2018arXiv181200053B">(Raphaël Beuzart-Plessis 2018, Lemma
2.5.1)</a>. ◻</p>
</div>
<div id="cor:sub-gln:each-ell-in" class="corollary">
<p><strong>Corollary 311</strong>. <em>For each <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span> there
exists <span class="math inline">\(C \geqslant 0\)</span> so that for
all <span class="math inline">\(W \in C^\infty(N \backslash G,
\psi)\)</span> and <span class="math inline">\((a,k) \in A \times
K\)</span>, we have <span class="math display">\[|W(a k)| \leqslant C
    \min (\{ 1 \} \cup \{ |a|^{-\alpha} : \alpha \in \Delta \})^{\ell}
    \sup_{x_1,\dotsc,x_\ell \in \mathcal{B}(G) \cup \{1\}}
    |R(x_1 \dotsb x_\ell) W(a k)|.\]</span></em></p>
</div>
<div id="lem:scratch-research:each-fixed-m" class="lemma">
<p><strong>Lemma 312</strong>. There is a fixed <span
class="math inline">\(d_0 \geqslant 0\)</span> with the following
property. Let <span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant
0}\)</span> be fixed. Let <span class="math inline">\(f \in
\mathcal{S}(N \backslash G)\)</span>. Let <span class="math inline">\(c
\in A\)</span>. Let <span class="math inline">\(k\)</span> belong to a
fixed compact subset of <span class="math inline">\(G\)</span>. Let
<span class="math inline">\(\varepsilon&gt; 0\)</span> be fixed. Then
<span class="math display">\[W(f,c,a k) \ll
\mathcal{G}_{\varepsilon,\ell}(a) \mathcal{S}_{d_0, d_0 +
\ell}(f).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We let <span class="math inline">\(x \in
\mathfrak{U}(A)\)</span> be as in the proof of Lemma <a
href="#lem:integrate-by-parts-archimedean-whittaker-average-bound"
data-reference-type="ref"
data-reference="lem:integrate-by-parts-archimedean-whittaker-average-bound">306</a>,
and appeal once again to the Mellin expansion <a href="#eq:wf-c-g"
data-reference-type="eqref" data-reference="eq:wf-c-g">\((21.6)\)</a>:
<span class="math display">\[W(f,c,a k) =
    \int _{\Re(s) = 0}
    |c|^{-s} \chi_s(x)^{-1} W_s(L(x) f,a k) \, d \mu_A^0(s).\]</span> We
let <span class="math inline">\(d_0\)</span> be as in Lemma <a
href="#lem:sub-gln:let-ell-geq" data-reference-type="ref"
data-reference="lem:sub-gln:let-ell-geq">308</a> applied with <span
class="math inline">\(\ell = 0\)</span>, so that for each fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>, <span
class="math display">\[W_s(L(x) f, a k) \ll
\mathcal{G}_{\varepsilon,0}(a) \mathcal{S}_{d_0}(W_s(L(x) f,
\cdot)).\]</span> Using the norm relation <a href="#eq:int-_g-in-norm"
data-reference-type="eqref"
data-reference="eq:int-_g-in-norm">\((21.7)\)</a>, we deduce
that <span class="math display">\[W_s(L(x) f, a k) \ll
\mathcal{G}_{\varepsilon,0}(a) \mathcal{S}_{d_0}(L(x) f_s).\]</span>
Applying Cauchy–Schwarz and appealing to the Parseval relation as in the
proof of Lemma <a
href="#lem:integrate-by-parts-archimedean-whittaker-average-bound"
data-reference-type="ref"
data-reference="lem:integrate-by-parts-archimedean-whittaker-average-bound">306</a>,
we obtain <span id="eq:mathcalg_eps-0a-1" class="math display">\[\label{eq:mathcalg_eps-0a-1}\tag{21.9}
    |\mathcal{G}_{\varepsilon,0}(a)^{-1} W(f,c,a k)|^2 \ll
    \int_{\Re(s) = 0}
    \mathcal{S}_{d_0}(L(x) f_s)^2 \, d \mu_A^0(s)
    \asymp
    \mathcal{S}_{d_0}(L(x) f)^2.\]</span> By increasing <span
class="math inline">\(d_0\)</span> as necessary, we may assume that it
exceeds the degree of <span class="math inline">\(x\)</span>, so that
<span class="math display">\[\mathcal{S}_{d_0}(L(x) f)^2 \ll
\mathcal{S}_{d_0,d_0}(f)^2.\]</span></p>
<p>To improve the estimate obtained thus far, we invoke Corollary <a
href="#cor:sub-gln:each-ell-in" data-reference-type="ref"
data-reference="cor:sub-gln:each-ell-in">311</a> and apply <a
href="#eq:mathcalg_eps-0a-1" data-reference-type="eqref"
data-reference="eq:mathcalg_eps-0a-1">\((21.9)\)</a> with
<span class="math inline">\(f\)</span> replaced by <span
class="math inline">\(R(x_1 \dotsb x_{\ell}) f\)</span> (noting that
<span class="math inline">\(f \mapsto W(f,c,\cdot)\)</span> is <span
class="math inline">\(G\)</span>-equivariant). We obtain <span
class="math display">\[|\mathcal{G}_{\varepsilon,\ell}(a)^{-1} W(f,c,a
k)|^2 \ll
    \sup_{x_1,\dotsc,x_\ell \in \mathcal{B}(G) \cup \{1\}}
    \mathcal{S}_{d_0,d_0}(R(x_1 \dotsb x_{\ell}) f)^2
    \ll
    \mathcal{S}_{d_0, d_0 + \ell}(f)^2,\]</span> as required. ◻</p>
</div>
<p>Let <span class="math inline">\(T \geqslant 1\)</span>. For <span
class="math inline">\(a \in A\)</span>, we set <span
class="math display">\[\mathcal{G}_T(a) :=
  \min (\{ 1 \} \cup \{ T |a|^{-\alpha} : \alpha \in \Delta
\}).\]</span></p>
<div id="lem:sub-gln:there-fixed-d_0" class="lemma">
<p><strong>Lemma 313</strong>. There is a fixed <span
class="math inline">\(d_0 \geqslant 0\)</span> so that for all fixed
<span class="math inline">\(\ell \geqslant 0\)</span>, we have for all
<span class="math inline">\(f \in \mathcal{S}(N \backslash G)\)</span>
and <span class="math inline">\((c,a,k) \in A \times  A \times
K\)</span> the estimate <span id="eq:wf-c-k" class="math display">\[\label{eq:wf-c-k}\tag{21.10}
  W(f,c,a k) \ll
  T^{d_0} \mathcal{G}_T(a)^{\ell} \mathcal{S}_{d_0, d_0 + \ell,
T}(f).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We apply Lemma <a
href="#lem:scratch-research:each-fixed-m" data-reference-type="ref"
data-reference="lem:scratch-research:each-fixed-m">312</a> with <span
class="math inline">\(\varepsilon= 1/2\)</span>. Let <span
class="math inline">\(d_0\)</span> be as in the conclusion of that
lemma. Let <span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant
0}\)</span> be fixed. It is immediate from the definition <a
href="#eq:mathcals_d_1-d_2-tf" data-reference-type="eqref"
data-reference="eq:mathcals_d_1-d_2-tf">\((2.21)\)</a>
that <span class="math display">\[\mathcal{S}_{d_0, d_0 + \ell}(f)
\leqslant T^{d_0 + \ell} \mathcal{S}_{d_0, d_0 + \ell, T}(f),\]</span>
so the conclusion of that lemma gives <span id="eq:wf-c-k-1" class="math display">\[\label{eq:wf-c-k-1}\tag{21.11}
    W(f,c,a k) \ll
    T^{d_0 + \ell}
    \min (\{1\} \cup \{|a|^{-\alpha} : \alpha \in \Delta \})^{\ell}
\mathcal{S}_{d_0, d_0 + \ell, T}(f).\]</span> This estimate holds in
particular with <span class="math inline">\(\ell = 0\)</span>, in which
case it specializes to <span id="eq:wf-c-k-2" class="math display">\[\label{eq:wf-c-k-2}\tag{21.12}
    W(f,c,a k) \ll
    T^{d_0}
    \mathcal{S}_{d_0,d_0,T}(f).\]</span> We now distinguish two
cases:</p>
<ul>
<li><p>If <span class="math inline">\(\mathcal{G}_T(a) = 1\)</span>,
then the desired bound <a href="#eq:wf-c-k" data-reference-type="eqref"
data-reference="eq:wf-c-k">\((21.10)\)</a> follows from <a
href="#eq:wf-c-k-2" data-reference-type="eqref"
data-reference="eq:wf-c-k-2">\((21.12)\)</a>.</p></li>
<li><p>If <span class="math inline">\(\mathcal{G}_T(a) &lt; 1\)</span>,
then <span class="math inline">\(\mathcal{G}_T(a) = T
|a|^{-\beta}\)</span> for some <span class="math inline">\(\beta \in
\Delta\)</span>. Thus <span class="math display">\[T
      \min
      (\{1\} \cup \{|a|^{-\alpha} : \alpha \in \Delta \})
      \leqslant T |a|^{-\beta} = \mathcal{G}_T(a),\]</span> and so <a
href="#eq:wf-c-k" data-reference-type="eqref"
data-reference="eq:wf-c-k">\((21.10)\)</a> follows from <a
href="#eq:wf-c-k-1" data-reference-type="eqref"
data-reference="eq:wf-c-k-1">\((21.11)\)</a>.</p></li>
</ul>
<p> ◻</p>
</div>
<p>The function <span class="math inline">\(\mathcal{G}_T\)</span> is
simplest when <span class="math inline">\(n=1\)</span>: in that case,
<span class="math inline">\(\mathcal{G}_T(a) = 1\)</span> for all <span
class="math inline">\(a\)</span>. For this reason, we restrict to <span
class="math inline">\(n \geqslant 2\)</span> in the following
results.</p>
<div id="lem:sub-gln:let-a-in" class="lemma">
<p><strong>Lemma 314</strong>. Assume <span class="math inline">\(n
\geqslant 2\)</span>. Let <span class="math inline">\(a \in A\)</span>.
Then <span class="math display">\[\mathcal{G}_T(a) \leqslant
    \min \left( 1,
      \frac{|a_n^n| T^{n(n-1)/2}}{ |\det a|}
    \right)^{ \frac{2}{n(n-1)} }.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We have <span class="math inline">\(\mathcal{G}_T(a)
= \min(1,T/X)\)</span>, where <span class="math display">\[X := \max
\{|a|^\alpha : \alpha \in \Delta \}
    = \max \left( \left\lvert \frac{a_1}{a_2} \right\rvert, \dotsc,
\left\lvert \frac{a_{n-1}}{a_{n}} \right\rvert \right).\]</span> Clearly
<span class="math inline">\(|a_i / a_{i+1}| \leqslant X\)</span> for
each <span class="math inline">\(i\)</span>. Iterating, we obtain <span
class="math display">\[|a_{n-1}| \leqslant X |a_n|,
    \quad
    |a_{n-2}| \leqslant X^2 |a_{n}|,
    \quad
    \dotsc,
    \quad
    |a_1| \leqslant X^{n-1} |a_n|.\]</span> Multiplying these
inequalities together gives <span class="math display">\[|\det a|
\leqslant X^{n(n-1)/2} |a_n^n|.\]</span> Therefore <span
class="math display">\[\mathcal{G}_T(a)^{n(n-1)/2}
    \leqslant\left( \frac{T}{X} \right)^{n(n-1)/2}
    \leqslant
    \frac{|a_n^n| T^{n(n-1)/2} }{|\det a|}.\]</span> We conclude by
taking the <span class="math inline">\(2/n(n-1)\)</span>st power of both
sides. ◻</p>
</div>
<div id="lem:sub-gln:there-fixed-d_0-1" class="lemma">
<p><strong>Lemma 315</strong>. Assume <span class="math inline">\(n
\geqslant 2\)</span>. There is a fixed <span class="math inline">\(d_0
\geqslant 0\)</span> with the following property. Let <span
class="math inline">\(\ell_1, \ell_2 \geqslant 0\)</span> be fixed. Let
<span class="math inline">\(D &gt; 0\)</span>. Suppose that <span
class="math inline">\(f \in \mathcal{S}(N \backslash G)\)</span>
satisfies the support condition that <span class="math inline">\(f(g)
\neq 0\)</span> only if <span class="math inline">\(|\det(g)| \asymp
D\)</span>. Then for all <span class="math inline">\((c,a,k) \in A
\times A \times K\)</span>, we have <span id="eq:wf-c-k-3" class="math display">\[\label{eq:wf-c-k-3}\tag{21.13}
  W(f,c,a k) \ll
  T^{d_0}
  \mathcal{G}_T(a)^{\ell_1}
  \min \left( 1,
    \frac{|a_n^n| T^{n(n-1)/2}}{D |\det c|}
  \right)^{\frac{2}{n(n-1)} \ell_2 }
  \mathcal{S}_{d_0, d_0+ \ell_1 + \ell_2, T}(f).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We apply Lemma <a href="#lem:sub-gln:there-fixed-d_0"
data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-d_0">313</a>. To estimate some
of the <span class="math inline">\(\mathcal{G}_T(a)\)</span> factors, we
apply Lemma <a href="#lem:sub-gln:let-a-in" data-reference-type="ref"
data-reference="lem:sub-gln:let-a-in">314</a>, noting that our
hypotheses on <span class="math inline">\(f\)</span> imply that <span
class="math inline">\(W(f,c,a k) \neq 0\)</span> only if <span
class="math inline">\(|\det(c^{-1} a k)| \asymp D\)</span>, i.e., <span
class="math inline">\(|\det a| \asymp D |\det c|\)</span>. ◻</p>
</div>
<h4 id="sec:rank-selb-integr">§21.4. Rankin–Selberg integrals</h4>
<p>The definitions that follow apply to any local field <span
class="math inline">\(F\)</span>, but will be applied in this paper only
when <span class="math inline">\(F = \mathbb{R}\)</span>.</p>
<p>We denote by <span class="math inline">\(V = F^{n} - \{0\}\)</span>
the punctured <span class="math inline">\(n\)</span>-plane over <span
class="math inline">\(F\)</span>. For <span class="math inline">\(\phi
\in C_c^\infty(V)\)</span>, <span class="math inline">\(f \in
\mathcal{S}(N \backslash G)\)</span> and <span class="math inline">\(c
\in A\)</span>, we define <span class="math display">\[Q(\phi,f,c) :=
\int _{g \in N \backslash G}
  \phi(e_n g) |W(f,c,g)|^2 \, d g.\]</span> As noted earlier, these may
be understood as “pseudo local Rankin–Selberg integrals:” a spectral
expansion of <span class="math inline">\(\phi\)</span> and <span
class="math inline">\(f\)</span> would yield an integral of “ordinary”
local Rankin–Selberg integrals for <span
class="math inline">\({\mathop{\mathrm{GL}}}_n \times
{\mathop{\mathrm{GL}}}_n\)</span>. We note that if <span
class="math inline">\(\phi\)</span> is <span
class="math inline">\(K\)</span>-invariant, then <span
class="math display">\[Q(\phi,f,c) =
  \int _{a \in A}
  \phi(a_n e_n)
  \int _{k \in K}
  |W(f,c,a k)|^2 \, d k \, \frac{d a}{\delta_N(a)}.\]</span></p>
<h4 id="sec:bounds-at-real-1">§21.5. Bounds for Rankin–Selberg integrals</h4>
<p>We now resume working over <span class="math inline">\(F =
\mathbb{R}\)</span>. We let <span class="math inline">\(T \geqslant
1\)</span> and <span class="math inline">\(r &gt; 0\)</span> be
parameters. For the following results, we let <span
class="math inline">\(\phi \in C_c^\infty(V)\)</span> be an element
satisfying the following conditions, motivated by the conclusion of
Lemma <a href="#lem:sub-gln:let-r-be" data-reference-type="ref"
data-reference="lem:sub-gln:let-r-be">290</a>:</p>
<div id="sec:bounds-at-real-assumptions-phi" class="assumptions">
<p><strong>Assumptions 316</strong>. We have:</p>
<ol type="i">
<li><p><span class="math inline">\(0 \leqslant\phi \leqslant
1\)</span>.</p></li>
<li><p><span class="math inline">\(\phi\)</span> is <span
class="math inline">\(K\)</span>-invariant.</p></li>
<li><p><span class="math inline">\(\phi(v) \neq 0\)</span> only if <span
class="math inline">\(\|v\| \asymp r\)</span>.</p></li>
</ol>
</div>
<p>Thus for <span class="math inline">\(g = a k\)</span> with <span
class="math inline">\((a,k) \in A \times K\)</span>, we have <span
class="math inline">\(\phi(e_n g) = \phi(a_n e_n)\)</span>, which
vanishes unless <span class="math inline">\(|a_n| \asymp r\)</span>.</p>
<p>In what follows, <span class="math inline">\(f\)</span> is an element
of <span class="math inline">\(\mathcal{S}(N \backslash G)\)</span>,
<span class="math inline">\(D\)</span> is a positive real, and <span
class="math inline">\(c\)</span> is an element of <span
class="math inline">\(A\)</span>.</p>
<div id="lem:standard:there-fixed-d_1-1" class="lemma">
<p><strong>Lemma 317</strong>. There is a fixed <span
class="math inline">\(d_1 \in \mathbb{Z}_{\geqslant 0}\)</span> so that,
if <span class="math inline">\(f(g) \neq 0 \implies |\det g| \asymp
D\)</span>, then <span class="math display">\[Q(\phi,f,c) \ll
\frac{r^n}{D |\det c|} \mathcal{S}_{d_1,0}(f)^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> This is a simple consequence of Lemma <a
href="#lem:sub-gln:let-f-in-1" data-reference-type="ref"
data-reference="lem:sub-gln:let-f-in-1">307</a>. Indeed, take <span
class="math inline">\(d_1\)</span> as in the conclusion of that lemma.
By the size and support properties of <span
class="math inline">\(\phi\)</span>, we have <span
class="math display">\[\phi(e_n g) \ll r^n \|e_n g\|^{-n}.\]</span> Thus
<span class="math inline">\(Q(\phi,f,c) \ll r^n I(c)\)</span>, where
<span class="math inline">\(I(c)\)</span> is as in Lemma <a
href="#lem:sub-gln:let-f-in-1" data-reference-type="ref"
data-reference="lem:sub-gln:let-f-in-1">307</a>. The conclusion of that
lemma gives the required estimate. ◻</p>
</div>
<div id="lem:sub-gln:there-fixed-x" class="lemma">
<p><strong>Lemma 318</strong>. There is a fixed <span
class="math inline">\(d_1 \in \mathbb{Z}_{\geqslant 0}\)</span> with the
following property. Let <span class="math inline">\(b \in
\mathbb{Z}_{\geqslant 0}\)</span> be fixed and large enough in terms of
<span class="math inline">\(n\)</span>. There is a fixed <span
class="math inline">\(d_2 \in \mathbb{Z}_{\geqslant 0}\)</span> so that
<span class="math display">\[Q(\phi,f,c)
    \ll
    \frac{r^{n b}}{|\det c|^b}
    \mathcal{S}_{d_1,d_2} ( |\det|^{-b/2} f)^2.\]</span> Here <span
class="math inline">\(|\det|^{-b/2} f\)</span> denotes the function on
<span class="math inline">\(N \backslash G\)</span> given by <span
class="math inline">\(g \mapsto |\det g|^{-b/2} f(g)\)</span>.</p>
</div>
<div class="proof">
<p><em>Proof.</em> We apply Lemma <a
href="#lem:scratch-research:each-fixed-m" data-reference-type="ref"
data-reference="lem:scratch-research:each-fixed-m">312</a> with <span
class="math inline">\(\varepsilon= 1/2\)</span>, say. This gives, for
some fixed <span class="math inline">\(d_1 \in \mathbb{Z}_{\geqslant
0}\)</span> and all fixed <span class="math inline">\(\ell \in
\mathbb{Z}_{\geqslant 0}\)</span>, the estimate <span
class="math display">\[W(f,c,a k) \ll \mathcal{G}(a)^{\ell}
\mathcal{S}_{d_1, d_1+\ell}(f)\]</span> for all <span
class="math inline">\(f \in \mathcal{S}(N \backslash G)\)</span> and
<span class="math inline">\((a,k) \in A \times K\)</span>, where <span
class="math display">\[\mathcal{G}(a) := \min(\{1\} \cup \{|a|^{-\alpha}
: \alpha \in \Delta \})
    =
    \min(1, |a_2/a_1|, \dotsc, |a_n / a_{n-1}|).\]</span> Fix <span
class="math inline">\(b \in \mathbb{Z}_{\geqslant 0}\)</span>. We can
apply the above estimate with <span class="math inline">\(f\)</span>
replaced by <span class="math inline">\(|\det|^{-b/2} f\)</span>. Since
<span class="math display">\[W(f,c, a k)
    =
    |\det c^{-1} a|^{b/2}
    W(|\det|^{-b/2} f, c, a k),\]</span> we obtain <span id="eq:wf-c-k2" class="math display">\[\label{eq:wf-c-k2}\tag{21.14}
    |W(f, c, a k)|^2 \ll
    \frac{|\det a|^{b}}{|\det c|^b}
    \mathcal{G}(a)^{2 \ell} \mathcal{S}_{d_1, d_1 + \ell} (
|\det|^{-b/2} f)^2.\]</span> Thus <span
class="math display">\[Q(\phi,f,c) \ll
    \frac{1}{|\det c|^b}
    \mathcal{S}_{d_1, d_1 + \ell} ( |\det|^{-b/2} f)^2
    J,\]</span> where <span id="eq:jc-ll-to1" class="math display">\[\label{eq:jc-ll-to1}\tag{21.15}
    J := \int _{a \in A}
    \phi(e_n a)
    |\det a|^b
    \mathcal{G}(a)^{2 \ell}
    \frac{d a}{\delta_N(a)}.\]</span> We factor <span
class="math inline">\(a = a_H z\)</span> with <span
class="math inline">\((a_H,z)  \in A_H \times Z\)</span>. The integral
in <a href="#eq:jc-ll-to1" data-reference-type="eqref"
data-reference="eq:jc-ll-to1">\((21.15)\)</a> factors as the product
of integrals <span class="math display">\[\left(
      \int _{z \in Z} \phi (e _n z) |\det z|^b  \, d z
    \right)
    \left(
      \int _{a \in A_H} |\det a|^b \mathcal{G}(a)^{\ell} \, \frac{d a}{
\delta_N(a)}
    \right).\]</span> Since <span class="math inline">\(\phi\)</span> is
supported on <span class="math inline">\(e_n z \asymp r\)</span> and of
size <span class="math inline">\(\operatorname{O}(1)\)</span>, the first
parenthetical integral is <span class="math inline">\(\asymp r^{n
b}\)</span>. We verify readily (Lemma <a href="#lem:sub-gln:let-r-in"
data-reference-type="ref" data-reference="lem:sub-gln:let-r-in">319</a>
below) that the second integral is finite, hence <span
class="math inline">\(\operatorname{O}(1)\)</span>, provided that <span
class="math inline">\(b\)</span> (resp. <span
class="math inline">\(\ell\)</span>) is taken sufficiently large in
terms of <span class="math inline">\(n\)</span> (resp. <span
class="math inline">\(b\)</span>). Thus the required conclusion holds
with <span class="math inline">\(d_2 := d_1 + \ell\)</span>. ◻</p>
</div>
<div id="lem:sub-gln:let-r-in" class="lemma">
<p><strong>Lemma 319</strong>. Let <span class="math inline">\(b \in
\mathbb{Z}_{\geqslant 0}\)</span> be large enough in terms of <span
class="math inline">\(n\)</span>, and let <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span> be
large enough in terms of <span class="math inline">\(b\)</span>. Then,
with notation as in the proof above, <span class="math display">\[\int
_{a \in A_H} |\det a|^b \mathcal{G}(a)^{\ell} \, \frac{d a}{
\delta_N(a)} &lt; \infty.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> There is nothing to check if <span
class="math inline">\(n = 1\)</span> (since then <span
class="math inline">\(A_H\)</span> is trivial), so we may and shall
assume that <span class="math inline">\(n \geqslant 2\)</span>. It
suffices to consider the same integral taken over the connected
component <span class="math inline">\(A_H^0\)</span> of <span
class="math inline">\(A_H\)</span>, on which all entries are positive.
For <span class="math inline">\(a \in A_H^0\)</span>, we define <span
class="math inline">\(y = (y_1,\dotsc,y_{n-1}) \in
(\mathbb{R}^\times_+)^n\)</span> by the formulas <span
class="math display">\[y_j := a_j / a_{j+1},\]</span> so that <span
class="math display">\[a_1 = y_1 \dotsb y_{n-1},
  \quad
  a_2 = y_2 \dotsb y_{n-1},
  \quad,
  \dotsc,
  \quad
  a_{n-1} = y_{n-1}.\]</span> Then <span class="math display">\[\det a =
y_1 y_2^2 y_3^3 \dotsb y_{n-1}^{n-1},\]</span> <span
class="math display">\[\mathcal{G}(a) =
  \min(1,y_1^{-1},\dotsc,y_{n-1}^{-1})
  \leqslant
  \prod_{j=1}^{n-1} \max(1, y_j)^{-1/(n-1)}\]</span> and <span
class="math display">\[\delta_N(a) =  \prod_{j=1}^{n-1} y_j^{b_j}, \quad
  b_j := \sum_{k=1}^{j} (n + 1 - 2 k).\]</span> The integral in question
then factors into a product of one-dimensional integrals: <span
class="math display">\[\prod_{j=1}^{n-1}
  \int _{y \in \mathbb{R}^\times_+}
  y^{b j} \max(1, y)^{-\ell/(n-1)}
  \, \frac{d^\times y}{y^{b_j}}.\]</span> We choose <span
class="math inline">\(b\)</span> large enough that <span
class="math inline">\(b j &gt; b_j\)</span> for all <span
class="math inline">\(j\)</span>, so that each integral converges near
zero, and then choose <span class="math inline">\(\ell\)</span> large
enough that <span class="math inline">\(\ell/(n-1) &gt; b j -
b_j\)</span> for all <span class="math inline">\(j\)</span>, so that
each integral converges near infinity. The proof is then complete. ◻</p>
</div>
<div id="lem:standard:there-fixed-d_1" class="lemma">
<p><strong>Lemma 320</strong>. Assume that <span class="math inline">\(n
\geqslant 2\)</span>. There is a fixed <span class="math inline">\(d_1
\in \mathbb{Z}_{\geqslant 0}\)</span> with the following property. Let
<span class="math inline">\(b \in \mathbb{Z}_{\geqslant 0}\)</span> be
fixed and large enough in terms of <span
class="math inline">\(n\)</span>. There is a fixed <span
class="math inline">\(d_2 \in \mathbb{Z}_{\geqslant 0}\)</span> so that,
if <span class="math inline">\(f(g) \neq 0 \implies |\det g| \asymp
D\)</span>, then for each fixed <span class="math inline">\(\ell \in
\mathbb{Z}_{\geqslant 0}\)</span>, we have <span
class="math display">\[Q(\phi,f,c) \ll
    \frac{T^{d_1} r^{n b}}{|\det c|^b}
    \min \left( 1,
      \frac{r^n T^{n(n-1)/2}}{D |\det c|}
    \right)^{\frac{4}{n(n-1)} \ell }
    \mathcal{S}_{d_1, d_2 + \ell, T}(|\det|^{-b/2} f)^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Take <span class="math inline">\(d_0\)</span> as in
the conclusion of Lemma <a href="#lem:sub-gln:there-fixed-d_0-1"
data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-d_0-1">315</a>. By Lemma <a
href="#lem:sub-gln:let-r-in" data-reference-type="ref"
data-reference="lem:sub-gln:let-r-in">319</a>, we may fix <span
class="math inline">\(d \in \mathbb{Z}_{\geqslant 0}\)</span> large
enough that <span class="math display">\[\int _{a \in A_H} |\det a|^b
\mathcal{G}(a)^{2 d} \, \frac{d a}{ \delta_N(a)} &lt; \infty.\]</span>
We apply Lemma <a href="#lem:sub-gln:there-fixed-d_0-1"
data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-d_0-1">315</a> with <span
class="math inline">\((\ell_1, \ell_2) = (d,\ell)\)</span> and with
<span class="math inline">\(|\det|^{-b/2} f\)</span> in place of <span
class="math inline">\(f\)</span>, giving <span
class="math display">\[\begin{align}
    &amp;|W(f,c,a k)|^2 \\
    &amp;\ll
    \frac{ T^{2 d_0} |\det a|^b}{|\det c|^b}
    \mathcal{G}_T(a)^{2 d}
  \min \left( 1,
    \frac{|a_n^n| T^{n(n-1)/2}}{D |\det c|}
  \right)^{\frac{4}{n(n-1)} \ell }
  \mathcal{S}_{d_0, d_0 + d + \ell}(|\det |^{-b/2} f)^2.
  
\end{align}\]</span> We now argue exactly as in the proof of Lemma <a
href="#lem:sub-gln:there-fixed-x" data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-x">318</a>, from <a
href="#eq:wf-c-k2" data-reference-type="eqref"
data-reference="eq:wf-c-k2">\((21.14)\)</a> onwards. We obtain the
required estimate with <span class="math inline">\(d_1 := 2 d_0
\geqslant d_0\)</span> and <span class="math inline">\(d_2 := d_0 +
d\)</span>. ◻</p>
</div>
<h4 id="sec:degenerate-integrals">§21.6. Degenerate integrals</h4>
<p>Let <span class="math inline">\(P\)</span> be <span
class="math inline">\(G\)</span> or a maximal standard parabolic.</p>
<p>For convenience, we recall (from §<a href="#sec:reform-terms-const-1"
data-reference-type="ref"
data-reference="sec:reform-terms-const-1">2.6</a>, §<a
href="#sec:summary-unification" data-reference-type="ref"
data-reference="sec:summary-unification">2.8</a> §<a
href="#sec:seri-repr-via" data-reference-type="ref"
data-reference="sec:seri-repr-via">3.8</a>, §<a
href="#sec:strong-approximation" data-reference-type="ref"
data-reference="sec:strong-approximation">3.9</a>) the notation we have
attached to such a group <span class="math inline">\(P\)</span>. We may
factor <span class="math inline">\(P = M {U_P}\)</span>, with <span
class="math inline">\(M\)</span> a standard Levi (containing the
diagonal subgroup) and <span class="math inline">\({U_P}\)</span> the
unipotent radical (consisting of upper-triangular unipotent matrices).
If <span class="math inline">\(P \neq G\)</span>, then we may factor
<span class="math inline">\(M = M&#39; \times M&#39;&#39;\)</span>,
where <span class="math inline">\(M&#39;\)</span> (resp.) denotes the
“upper-left” (resp. “lower-right”) block of <span
class="math inline">\(M\)</span>. In the case <span
class="math inline">\(P = G\)</span>, we adopt the convention that <span
class="math inline">\(M&#39; := \{1\}\)</span> and <span
class="math inline">\(M&#39;&#39; := G\)</span>. We then define <span
class="math inline">\(A&#39;, N&#39;, K&#39;\)</span> and <span
class="math inline">\(A&#39;&#39;, N&#39;&#39;, K&#39;&#39;\)</span> to
be the intersections with <span class="math inline">\(M&#39;\)</span>
and <span class="math inline">\(M&#39;&#39;\)</span>, respectively, of
the corresponding subgroups <span class="math inline">\(A,N,K\)</span>
of <span class="math inline">\(G\)</span>. Finally, we introduce the
notation <span class="math display">\[n&#39; :=
\mathop{\mathrm{rank}}(M&#39;), \quad n&#39;&#39; :=
\mathop{\mathrm{rank}}(M&#39;&#39;),\]</span> so that <span
class="math inline">\(n = n&#39; + n&#39;&#39;\)</span>. We have <span
class="math inline">\(n&#39; \in \{0,\dotsc,n-1\}\)</span> and <span
class="math inline">\(n&#39;&#39; \in \{1, \dotsc, n\}\)</span>.</p>
<p>For <span class="math inline">\(f \in \mathcal{S}(N \backslash
G)\)</span> and <span class="math inline">\((c,g) \in A&#39;&#39; \times
G\)</span>, we define the (partial) Whittaker transform <span
class="math display">\[W_P(f,c,g) = \delta_{N&#39;&#39;}^{1/2}(c) \int
_{u \in N&#39;&#39;} f(c^{-1} w^{-1}_{M&#39;&#39;} u g) \psi ^{-1} (u)
\,d u.\]</span> Such integrals converge absolutely for the same reasons
as in §<a href="#sec:whitt-funct-attach" data-reference-type="ref"
data-reference="sec:whitt-funct-attach">4.1</a>. For <span
class="math inline">\((\phi,f,c,g) \in C_c^\infty(V) \times
\mathcal{S}(N \backslash G) \times A&#39;&#39; \times G\)</span>, we
define <span class="math display">\[Q_P(\phi,f,c) := \int _{g \in N
\backslash G}
  \phi(e_n g) |W_P(f,c,g)|^2 \, d g.\]</span> For example, <span
class="math inline">\(W_G(\dotsb)\)</span> and <span
class="math inline">\(Q_G(\dotsb)\)</span> are the integrals <span
class="math inline">\(W(\dotsb)\)</span> and <span
class="math inline">\(Q(\dotsb)\)</span> as defined in §<a
href="#sec:whitt-funct-attach" data-reference-type="ref"
data-reference="sec:whitt-funct-attach">4.1</a> and §<a
href="#sec:rank-selb-integr" data-reference-type="ref"
data-reference="sec:rank-selb-integr">4.4</a>.</p>
<p>The definition of <span class="math inline">\(Q\)</span> makes sense
for any general linear group <span class="math inline">\(G\)</span>. We
write <span class="math inline">\(W^{M&#39;&#39;}\)</span> and <span
class="math inline">\(Q^{M&#39;&#39;}\)</span> for the integrals defined
like <span class="math inline">\(W\)</span> and <span
class="math inline">\(Q\)</span>, but with <span
class="math inline">\(M&#39;&#39;\)</span> playing the role of <span
class="math inline">\(G\)</span>. That is, write <span
class="math inline">\(V&#39;\)</span> (resp. <span
class="math inline">\(V&#39;&#39;\)</span>) for the punctured <span
class="math inline">\(n&#39;\)</span>-plane (resp. <span
class="math inline">\(n&#39;&#39;\)</span>-plane), included in <span
class="math inline">\(V\)</span> as a “punctured direct summand.” For
<span class="math inline">\(\phi \in C_c^\infty(V&#39;&#39;)\)</span>,
<span class="math inline">\(f \in \mathcal{S}(N&#39;&#39; \backslash
M&#39;&#39;)\)</span>, <span class="math inline">\(c \in
A&#39;&#39;\)</span> and <span class="math inline">\(g \in
M&#39;&#39;\)</span>, we set <span
class="math display">\[W^{M&#39;&#39;}(f,c,g) :=
\delta_{N&#39;&#39;}^{1/2}(c) \int _{u \in N&#39;&#39;} f(c^{-1} u g)
\psi^{-1}(u) \, d u,\]</span> <span
class="math display">\[Q^{M&#39;&#39;}(\phi,f,c) := \int _{g \in
N&#39;&#39; \backslash M&#39;&#39;} \phi (e_{n} g)
|W^{M&#39;&#39;}(f,c,g)|^2 \, d g.\]</span> (Here <span
class="math inline">\(e_n\)</span> identifies with the <span
class="math inline">\(n&#39;&#39;\)</span>th basis vector for <span
class="math inline">\(V&#39;&#39;\)</span>.)</p>
<p>Given <span class="math inline">\(\phi \in C_c^\infty(V)\)</span> and
<span class="math inline">\(f \in \mathcal{S}(N \backslash G)\)</span>,
the restrictions <span
class="math inline">\(\phi|_{V&#39;&#39;}\)</span> and <span
class="math inline">\(f|_{M&#39;&#39;}\)</span> lie in <span
class="math inline">\(C_c^\infty(V&#39;&#39;)\)</span> and <span
class="math inline">\(\mathcal{S}(N&#39;&#39; \backslash
M&#39;&#39;)\)</span>, respectively. For such <span
class="math inline">\(\phi\)</span> and <span
class="math inline">\(f\)</span>, we define <span
class="math inline">\(Q^{M&#39;&#39;}(\phi,f,c)\)</span> for <span
class="math inline">\(c \in A&#39;&#39;\)</span> by applying the above
definitions to the restrictions.</p>
<div id="lem:reduce-Q-P-to-Q" class="lemma">
<p><strong>Lemma 321</strong>. For <span class="math inline">\(\phi \in
C_c^\infty(V), f \in \mathcal{S}(N \backslash G)\)</span> and <span
class="math inline">\(c \in A&#39;&#39;\)</span>, we have <span
class="math display">\[Q_P(\phi, f, c)
  = \int _{a &#39; \in A&#39;}
  \int _{k \in K}
  Q^{M&#39;&#39;}\left(\phi, |\det|^{n&#39;/2 }R(a&#39; k) f, c\right)
\, \frac{d a &#39;}{\delta_N(a&#39;)} \, d k.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We apply Lemma <a
href="#lem:standard:rewrite-N-G-via-M" data-reference-type="ref"
data-reference="lem:standard:rewrite-N-G-via-M">322</a>, stated below,
to <span class="math inline">\(\Phi(g) := \phi(e_n g)
W_P(f,c,g)\)</span> and note that <span class="math display">\[\Phi(g
a&#39; k)
    =
    \phi(e_n g)
    W_P(R(a&#39; k) f, c, g),\]</span> hence <span
class="math display">\[\int _{g \in N&#39;&#39; \backslash M&#39;&#39;}
    |\det g|^{n&#39;}
    \Phi(g a &#39; k) \, d g
    =
    Q^{M&#39;&#39;}\left(\phi, |\det|^{n&#39;/2} R(a&#39; k) f,
c\right).\]</span> ◻</p>
</div>
<div id="lem:standard:rewrite-N-G-via-M" class="lemma">
<p><strong>Lemma 322</strong>. Let <span
class="math inline">\(\Phi\)</span> be an integrable function on <span
class="math inline">\(N \backslash G\)</span>. Then <span
class="math display">\[\int _{N \backslash G} \Phi
  =
        \int _{a &#39; \in A&#39;}
    \int _{k \in K}
    \int _{g \in N&#39;&#39; \backslash M&#39;&#39;}
    |\det g|^{n&#39;}
    \Phi (g a&#39; k)
    \, d g
     \, d k \, \frac{d a &#39;}{\delta_N(a&#39;)}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We write <span class="math inline">\(\int_{N
\backslash G}\)</span> out in Iwasawa coordinates as <span
class="math display">\[\int _{a&#39; \in A&#39;}
    \int _{k \in K}
    \int _{a&#39;&#39; \in A&#39;&#39;}
    \int _{k&#39;&#39; \in K&#39;&#39; }
    \Phi (a&#39;&#39; k&#39;&#39; a&#39; k)
    \, d k&#39;&#39;
    \, \frac{d a&#39;&#39;}{\delta_N(a&#39;&#39;)}
    \, d k
    \, \frac{d a&#39;}{\delta_N (a&#39;)}.\]</span> The identity <span
class="math inline">\(\delta_N(a&#39;&#39;) =
\delta_{N&#39;&#39;}(a&#39;&#39;) |\det a&#39;&#39;|^{-n&#39;}\)</span>
gives <span class="math display">\[\int _{a&#39; \in A&#39;}
  \int _{k \in K}
  \int _{a&#39;&#39; \in A&#39;&#39;}
  |\det a&#39;&#39;|^{n&#39;}
  \int _{k&#39;&#39; \in K&#39;&#39; }
  \Phi( a&#39;&#39; k&#39;&#39; a&#39; k)
  \, d k&#39;&#39;
  \, \frac{d a&#39;&#39;}{\delta_{N&#39;&#39;}(a&#39;&#39;)}
  \, d k
  \, \frac{d a&#39;}{\delta_N (a&#39;)}.\]</span> Recombining the <span
class="math inline">\(A&#39;&#39;\)</span> and <span
class="math inline">\(K&#39;&#39;\)</span> integrals, we arrive at <span
class="math display">\[\int _{a&#39; \in A&#39;}
  \int _{k \in K}
  \int _{g \in N&#39;&#39; \backslash M&#39;&#39;}
  |\det g|^{n&#39;}
  \Phi(g a&#39; k)
  \, d g
  \, d k
  \, \frac{d a&#39;}{\delta_N (a&#39;)},\]</span> as required. ◻</p>
</div>
<p>We write <span
class="math inline">\(\mathcal{S}_{d_1,d_2}^{N&#39;&#39; \backslash
M&#39;&#39;}\)</span> and <span
class="math inline">\(\mathcal{S}_{d_1,d_2,T}^{N&#39;&#39; \backslash
M&#39;&#39;}\)</span> for the Sobolev norms on <span
class="math inline">\(\mathcal{S}(N&#39;&#39; \backslash
M&#39;&#39;)\)</span> defined like in §<a
href="#sec:local-sobolev-norms-prelims" data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a>, but with <span
class="math inline">\(N&#39;&#39; \backslash M&#39;&#39;\)</span>
playing the role of <span class="math inline">\(N \backslash G\)</span>.
Thus <span class="math display">\[\begin{align}
  \mathcal{S}_{d_1,d_2}^{N&#39;&#39; \backslash M&#39;&#39;}(f)^2
  &amp;=
  \sum _{
    \substack{
      x_1, \dotsb, x_{d_1} \in \mathcal{B}(A&#39;&#39;) \cup \{1\}  \\
       y_1, \dotsc, y _{d _2 } \in \mathcal{B}(M&#39;&#39;) \cup \{1\}
    }
  }
  \| L(x_1 \dotsb x_{d_1}) R(y_1 \dotsb y_{d_2}) f \|^2, \\
  \mathcal{S}_{d_1,d_2,T}^{N&#39;&#39; \backslash M&#39;&#39;}(f)
  &amp;=
  \max_{0 \leqslant k \leqslant d_2}
  T^{-k}
  \mathcal{S}_{d_1,k}^{N&#39;&#39; \backslash M&#39;&#39;}(f).
\end{align}\]</span> We can apply these just as well to restrictions
of elements of <span class="math inline">\(\mathcal{S}(N \backslash
G)\)</span>.</p>
<div id="lem:induct-sobolev-norms" class="lemma">
<p><strong>Lemma 323</strong>. Let <span class="math inline">\(d_1, d_2
\in \mathbb{Z}_{\geqslant 0}\)</span> be fixed. Then for all <span
class="math inline">\(f \in \mathcal{S}(N \backslash G)\)</span>, <span
class="math display">\[\int _{a&#39; \in A&#39;}
    \int _{k \in K}
    \mathcal{S} _{d_1, d_2} ^{N&#39;&#39; \backslash M&#39;&#39;}
    \left(
      |\det|^{n&#39;/2}
      R(a&#39; k) f
    \right)^2
    \, d k
    \, \frac{d a &#39;}{\delta_N(a&#39;)}
    \ll
    \mathcal{S}_{d_1,d_2}(f)^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> The LHS is, by definition, <span
class="math display">\[\begin{align}
    &amp;\sum _{
    \substack{
      x_1, \dotsb, x_{d_1} \in \mathcal{B}(A&#39;&#39;) \cup \{1\}  \\
       y_1, \dotsc, y _{d _2 } \in \mathcal{B}(M&#39;&#39;) \cup \{1\}
    }
  }
  \int _{a&#39; \in A&#39;}
  \int _{k \in K}
  \int _{g \in N&#39;&#39; \backslash M&#39;&#39;} \\
    &amp;\quad \left\lvert    L(x_1 \dotsb x_{d_1}) R(y_1 \dotsb
y_{d_2}) |\det|^{n&#39;/2} R(a&#39; k) f
  \right\rvert^2(g)
  \, d g
      \, d k
      \, \frac{d a &#39;}{\delta_N(a&#39;)}.
  
\end{align}\]</span> Using the product rule for derivatives and the
fact that <span class="math inline">\(A&#39;\)</span> commutes with
<span class="math inline">\(M&#39;&#39;\)</span>, we see that the above
is <span class="math display">\[\begin{align}
    \ll &amp;\sum _{
    \substack{
      x_1, \dotsb, x_{d_1} \in \mathcal{B}(A&#39;&#39;) \cup \{1\}  \\
       y_1, \dotsc, y _{d _2 } \in \mathcal{B}(M&#39;&#39;) \cup \{1\}
    }
  }
  \int _{a&#39; \in A&#39;}
  \int _{k \in K}
  \int _{g \in N&#39;&#39; \backslash M&#39;&#39;} \\
    &amp;\quad \left\lvert  |\det|^{n&#39;/2} R(a&#39;)   L(x_1 \dotsb
x_{d_1}) R(y_1 \dotsb y_{d_2}) R(k) f
  \right\rvert^2(g)
  \, d g
       \, d k \, \frac{d a &#39;}{\delta_N(a&#39;)}.
  
\end{align}\]</span> We have <span class="math display">\[L(x_1 \dotsb
x_{d_1}) R(y_1 \dotsb y_{d_2}) R(k)
    =
    R(k) L(x_1 \dotsb x_{d_1}) R(\mathop{\mathrm{Ad}}(k)^{-1} y_1 \dotsb
\mathop{\mathrm{Ad}}(k)^{-1} y_{d_2}).\]</span> Since <span
class="math inline">\(K\)</span> is compact, we obtain the further
majorization <span class="math display">\[\begin{align}
    \ll &amp;\sum _{
    \substack{
      x_1, \dotsb, x_{d_1} \in \mathcal{B}(A) \cup \{1\}  \\
       y_1, \dotsc, y _{d _2 } \in \mathcal{B}(M) \cup \{1\}
    }
  }
  \int _{a&#39; \in A&#39;}
  \int _{k \in K}
  \int _{g \in N&#39;&#39; \backslash M&#39;&#39;} \\
    &amp;\quad \left\lvert  |\det|^{n&#39;/2} R(a&#39; k)   L(x_1 \dotsb
x_{d_1}) R(y_1 \dotsb y_{d_2}) f
  \right\rvert^2(g)
      \, d g
       \, d k
    \, \frac{d a &#39;}{\delta_N(a&#39;)}.
  
\end{align}\]</span> By Lemma <a
href="#lem:standard:rewrite-N-G-via-M" data-reference-type="ref"
data-reference="lem:standard:rewrite-N-G-via-M">322</a>, this last
expression is just <span
class="math inline">\(\mathcal{S}_{d_1,d_2}(f)^2\)</span>. ◻</p>
</div>
<div id="cor:standard:induct-sobolev-norms" class="corollary">
<p><strong>Corollary 324</strong>. <em>Let <span class="math inline">\(T
\geqslant 1\)</span>. Let <span class="math inline">\(d_1, d_2 \in
\mathbb{Z}_{\geqslant 0}\)</span> be fixed. Then for all <span
class="math inline">\(f \in \mathcal{S}(N \backslash G)\)</span>, <span
class="math display">\[\int _{a&#39; \in A&#39;}
    \int _{k \in K}
    \mathcal{S} _{d_1, d_2,T} ^{N&#39;&#39; \backslash M&#39;&#39;}
    \left(
      |\det|^{n&#39;/2}
      R(a&#39; k) f
    \right)^2
    \, \frac{d a &#39;}{\delta_N(a&#39;)} \, d k
    \ll
    \mathcal{S}_{d_1,d_2,T}(f)^2.\]</span></em></p>
</div>
<h4 id="sec:bounds-at-real-2">§21.7. Bounds at the real place: degenerate
integrals</h4>
<p>For the following results, we take <span class="math inline">\(\phi
\in C_c^\infty(V)\)</span> satisfying Assumptions <a
href="#sec:bounds-at-real-assumptions-phi" data-reference-type="ref"
data-reference="sec:bounds-at-real-assumptions-phi">316</a>, <span
class="math inline">\(f \in \mathcal{S}(N \backslash G)\)</span>, <span
class="math inline">\(D &gt; 0\)</span>, <span class="math inline">\(T
\geqslant 1\)</span> and <span class="math inline">\(c \in
A&#39;&#39;\)</span>. We establish estimates for the the degenerate
integrals <span class="math inline">\(Q_P\)</span> analogous to those
established in §<a href="#sec:bounds-at-real-1"
data-reference-type="ref" data-reference="sec:bounds-at-real-1">4.5</a>
for the Rankin–Selberg integrals <span class="math inline">\(Q\)</span>.
In fact, the proofs will largely consist of expressing <span
class="math inline">\(Q_P\)</span> in terms of <span
class="math inline">\(Q^{M&#39;&#39;}\)</span> using Lemma <a
href="#lem:reduce-Q-P-to-Q" data-reference-type="ref"
data-reference="lem:reduce-Q-P-to-Q">321</a> to reduce to the bounds
established in §<a href="#sec:bounds-at-real-1"
data-reference-type="ref"
data-reference="sec:bounds-at-real-1">4.5</a>.</p>
<div id="lem:sub-gln:there-fixed-x-3" class="lemma">
<p><strong>Lemma 325</strong>. There is a fixed <span
class="math inline">\(d_1 \in \mathbb{Z}_{\geqslant 0}\)</span> so that,
if <span class="math inline">\(f(a&#39; a&#39;&#39; k) \neq 0 \implies
|\det a&#39;&#39;| \asymp D\)</span>, then <span
class="math display">\[Q_P(\phi,f,c) \ll \frac{r^{n&#39;&#39;}}{D |\det
c|} \mathcal{S}_{d_1,0}(f)^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Let <span class="math inline">\((a&#39;, k) \in
A&#39; \times K\)</span>. Then the restriction to <span
class="math inline">\(M&#39;&#39;\)</span> of <span
class="math inline">\(R(a&#39; k) f\)</span> is supported on elements of
determinant <span class="math inline">\(\asymp D\)</span>. Thus by Lemma
<a href="#lem:standard:there-fixed-d_1-1" data-reference-type="ref"
data-reference="lem:standard:there-fixed-d_1-1">317</a> (applied to
<span class="math inline">\(M&#39;&#39;\)</span> in place of <span
class="math inline">\(G\)</span>), we have <span
class="math display">\[Q^{M&#39;&#39;}(\phi, |\det|^{n&#39;/2 }R(a&#39;
k) f, c)
    \ll
    \frac{r^{n&#39;&#39;}}{D |\det c|}
    \mathcal{S}_{d_1,0}^{N&#39;&#39; \backslash M&#39;&#39;}\left(|\det
|^{n&#39;/2} R(a&#39; k) f\right)^2.\]</span> By Lemma <a
href="#lem:reduce-Q-P-to-Q" data-reference-type="ref"
data-reference="lem:reduce-Q-P-to-Q">321</a>, it follows that <span
class="math display">\[Q_P(\phi, f, c) \ll \frac{r^{n&#39;&#39;}}{D
|\det c|} J,\]</span> where <span class="math display">\[J :=
    \int _{a &#39; \in A&#39;}
    \int _{k \in K}
    \mathcal{S}_{d_1,0}^{N&#39;&#39; \backslash
M&#39;&#39;}\left(|\det|^{n&#39;/2} R(a&#39; k) f\right)^2
    \, d k
    \, \frac{d a &#39;}{\delta_N(a&#39;)}.\]</span> By Lemma <a
href="#lem:induct-sobolev-norms" data-reference-type="ref"
data-reference="lem:induct-sobolev-norms">323</a>, we have <span
class="math inline">\(J \ll \mathcal{S}_{d_1,0}(f)^2\)</span>. The
required bound follows. ◻</p>
</div>
<p>For the following results, we introduce the notation <span
class="math display">\[|\det|_{M&#39;&#39;} : N \backslash G \rightarrow
\mathbb{R}_{&gt;0}\]</span> for the unique function that is
right-invariant under <span class="math inline">\(A&#39; K\)</span> and
whose restriction to <span class="math inline">\(M&#39;&#39;\)</span> is
<span class="math inline">\(|\det|\)</span>. Explicitly, each <span
class="math inline">\(g \in N \backslash G\)</span> may be represented
in the form <span class="math inline">\(g = a&#39; a&#39;&#39;
k\)</span> with <span class="math inline">\((a&#39;,a&#39;&#39;,k) \in
A&#39; \times A&#39;&#39; \times K\)</span>, in which case <span
class="math display">\[|\det|_{M&#39;&#39;}(g) := |\det
a&#39;&#39;|.\]</span></p>
<div id="lem:sub-gln:there-fixed-x-1" class="lemma">
<p><strong>Lemma 326</strong>. There is a fixed <span
class="math inline">\(d_1 \in \mathbb{Z}_{\geqslant 0}\)</span> with the
following property. Let <span class="math inline">\(b \in
\mathbb{Z}_{\geqslant 0}\)</span> be fixed and large enough in terms of
<span class="math inline">\(n\)</span>. There is a fixed <span
class="math inline">\(d_2 \in \mathbb{Z}_{\geqslant 0}\)</span> so that
<span class="math display">\[Q_P(\phi,f,c)
    \ll
    \frac{r^{n&#39;&#39; b}}{|\det c|^b}
    \mathcal{S}_{d_1, d_2}\left(|\det|_{M&#39;&#39;}^{-b/2}
f\right)^2.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemma <a href="#lem:sub-gln:there-fixed-x"
data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-x">318</a>, we have <span
class="math display">\[Q^{M&#39;&#39;}\left(\phi, |\det|^{n&#39;/2}
R(a&#39; k) f, c\right)
    \ll
    \frac{r^{n&#39;&#39; b}}{|\det c|^b}
    \mathcal{S}_{d_1, d_2}^{N&#39;&#39; \backslash
M&#39;&#39;}\left(|\det|_{M&#39;&#39;}^{n&#39;/2 - b/2} R(a&#39; k)
f\right)^2.\]</span> We have <span
class="math display">\[|\det|_{M&#39;&#39;}^{n&#39;/2 - b/2} R(a&#39; k)
f
    =
    |\det|_{M&#39;&#39;}^{n&#39;/2} R(a&#39; k)
    |\det|_{M&#39;&#39;}^{- b/2}
    f.\]</span> Applying Lemma <a href="#lem:reduce-Q-P-to-Q"
data-reference-type="ref" data-reference="lem:reduce-Q-P-to-Q">321</a>
and Lemma <a href="#lem:induct-sobolev-norms" data-reference-type="ref"
data-reference="lem:induct-sobolev-norms">323</a> as in the proof of
Lemma <a href="#lem:sub-gln:there-fixed-x-3" data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-x-3">325</a> yields the required
estimate. ◻</p>
</div>
<div id="lem:sub-gln:there-fixed-x-2" class="lemma">
<p><strong>Lemma 327</strong>. Assume that <span
class="math inline">\(n&#39;&#39; \geqslant 2\)</span>. There is a fixed
<span class="math inline">\(d_1 \in \mathbb{Z}_{\geqslant 0}\)</span>
with the following property. Let <span class="math inline">\(b \in
\mathbb{Z}_{\geqslant 0}\)</span> be fixed and large enough in terms of
<span class="math inline">\(n\)</span>. There is a fixed <span
class="math inline">\(d_2 \in \mathbb{Z}_{\geqslant 0}\)</span> so that,
if <span class="math inline">\(f(a &#39; a&#39;&#39; k) \neq 0 \implies
|\det a&#39;&#39;| \asymp D\)</span>, then for each fixed <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, we
have <span class="math display">\[\begin{align}
    &amp;Q_P(\phi,f,c)
    \\
    &amp;\ll \frac{T^{d_1} r^{n&#39;&#39; b}}{|\det c|^b}
    \min \left( 1,
      \frac{r^{n&#39;&#39;} T^{n&#39;&#39;(n&#39;&#39;-1)/2}}{D |\det
c|}
    \right)^{\frac{4}{n&#39;&#39;(n&#39;&#39;-1)} \ell }
      \mathcal{S}_{d_1, d_2 +\ell, T}\left(|\det|_{M&#39;&#39;}^{-b/2}
f\right)^2.
  
\end{align}\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We reduce to Lemma <a
href="#lem:standard:there-fixed-d_1" data-reference-type="ref"
data-reference="lem:standard:there-fixed-d_1">320</a> exactly as in the
proofs of the previous two lemmas, using Corollary <a
href="#cor:standard:induct-sobolev-norms" data-reference-type="ref"
data-reference="cor:standard:induct-sobolev-norms">324</a> to estimate
the resulting Sobolev norms. ◻</p>
</div>
<h4 id="basic-estimates-for-mathfraken-backslash-g-t">Basic estimates
for <span class="math inline">\(\mathfrak{E}(N \backslash G,
T)\)</span></h4>
<p>We now prepare to apply the above estimates to elements of the
classes <span class="math inline">\(\mathfrak{E}(N \backslash G,
T)\)</span> and their translates. Here we undertake the necessary
preparatory work by recording basic estimates for elements of such
classes. We assume here that <span class="math inline">\(T \ggg
1\)</span>.</p>
<div id="itm:standard:decomposition-support-5" class="lemma">
<p><strong>Lemma 328</strong>. <span id="lem:standard:let-f-in-2"
label="lem:standard:let-f-in-2"></span> Let <span
class="math inline">\(f \in \mathfrak{E}(N \backslash G, T)\)</span>. We
may find a subset <span class="math inline">\(\Sigma\)</span> of <span
class="math inline">\(A\)</span> and a decomposition <span id="eq:f-=-fclubsuit" class="math display">\[\label{eq:f-=-fclubsuit}\tag{21.16}
    f = f^{\clubsuit} + \sum _{\mu \in \Sigma } f^{\mu}\]</span> with
the following properties.</p>
<ol type="i">
<li><p><span class="math inline">\(f^{\clubsuit} \in \mathfrak{E}(N
\backslash G, T)\)</span> and each <span class="math inline">\(f^{\mu}
\in \mathfrak{E}(N \backslash G, T)\)</span>.</p></li>
<li><p><span id="itm:standard:clubsuit-2"
label="itm:standard:clubsuit-2"></span> For all fixed <span
class="math inline">\(x \in \mathfrak{U}(A)\)</span> and <span
class="math inline">\(y \in \mathfrak{U}(G)\)</span>, and all <span
class="math inline">\(g \in N \backslash G\)</span>, we have <span
class="math display">\[L(x) R(y) f ^{\clubsuit}(g) \ll \|g\|_{N
\backslash G}^{-\infty} T^{-\infty}.\]</span></p></li>
<li><p><span id="itm:standard:decomposition-support-3"
label="itm:standard:decomposition-support-3"></span> <span
class="math inline">\(\# \Sigma \ll (\log
T)^{\operatorname{O}(1)}\)</span>.</p></li>
<li><p><span id="itm:standard:decomposition-support-4"
label="itm:standard:decomposition-support-4"></span> For each <span
class="math inline">\(\mu \in \Sigma\)</span> and <span
class="math inline">\(j \in \{1, \dotsc, n\}\)</span>, we have <span
class="math display">\[\|\mu T^{\rho^\vee}\| = T^{o(1)},\]</span> or
equivalently, <span id="eq:mu_1-=-tfrac1" class="math display">\[\label{eq:mu_1-=-tfrac1}\tag{21.17}
      \mu_1 = T^{\frac{1-n}{2} + o(1)}, \quad
      \mu_2 = T^{\frac{3-n}{2} + o(1)},
      \quad
      \dotsc,
      \quad
      \mu_n = T^{\frac{n-1}{2} + o(1)}.\]</span> In particular, <span
class="math inline">\(|\det \mu| = T^{o(1)}\)</span>.</p></li>
<li><p>For each <span class="math inline">\(\mu \in \Sigma\)</span>,
<span class="math inline">\(a \in A\)</span> and <span
class="math inline">\(k \in K\)</span> with <span
class="math inline">\(f^{\mu}(a k) \neq 0\)</span>, we have <span
class="math display">\[a_i \asymp \mu_i\]</span> for each <span
class="math inline">\(i \in \{1, \dotsc, n\}\)</span>. In particular,
<span class="math display">\[f^{\mu}(g) \neq 0 \implies \det g \asymp
\det \mu.\]</span></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> For <span class="math inline">\(a \in A\)</span>,
define <span class="math inline">\(r(a)  = (r_1(a),\dotsc,r_n(a)) \in
\mathbb{R}^n\)</span> by writing <span class="math display">\[a
T^{\rho^\vee} = \mathop{\mathrm{diag}}(\pm T^{r_1(a)}, \dotsc, \pm
T^{r_n(a)}).\]</span> Explicitly, <span class="math display">\[r(a) =
    \left(
      \frac{\log |a_1|}{\log T} + \frac{1 - n}{2},
      \frac{\log |a_2|}{\log T} + \frac{3 - n}{2},
      \dotsc,
      \frac{\log |a_n|}{\log T} + \frac{n - 1}{2},
    \right).\]</span> Since <span class="math inline">\(r\)</span> is
invariant under <span class="math inline">\(A \cap K\)</span>, the
function on <span class="math inline">\(N \backslash G\)</span> given in
Iwasawa coordinates <span class="math inline">\((a,k) \in A \times
K\)</span> by the formula <span class="math inline">\(a k \mapsto
r(a)\)</span> is well-defined. Fix <span class="math inline">\(\phi \in
C_c^\infty(\mathbb{R}^n)\)</span> taking the value <span
class="math inline">\(1\)</span> in some neighborhood of the origin.
Then <span class="math inline">\(\phi &#39; := 1 - \phi\)</span>
vanishes in some neighborhood of the origin. For each <span
class="math inline">\(\varepsilon&gt; 0\)</span>, we define <span
class="math inline">\(\Phi_\varepsilon, \Phi_\varepsilon&#39; \in
C^\infty(N \backslash G)\)</span> in Iwasawa coordinates <span
class="math display">\[\Phi_\varepsilon(a k ) := \phi(r(a)/\varepsilon),
\quad
    \Phi_\varepsilon&#39;(a k) = \phi &#39;(r(a) /
\varepsilon),\]</span> so that <span
class="math inline">\(\Phi_\varepsilon+ \Phi_\varepsilon&#39; =
1\)</span>.</p>
<p>For each <span class="math inline">\(\varepsilon&gt; 0\)</span>,
define <span class="math inline">\(f ^{\clubsuit, \varepsilon} : N
\backslash G \rightarrow \mathbb{C}\)</span> by <span
class="math display">\[f ^{\clubsuit, \varepsilon}(g) :=
\Phi&#39;_\varepsilon(g) f(g).\]</span></p>
<p>Suppose for the moment that <span
class="math inline">\(\varepsilon&gt; 0\)</span> is fixed.</p>
<p>It is not hard to see that for fixed <span
class="math inline">\((x,y) \in \mathfrak{U}(A) \times
\mathfrak{U}(G)\)</span>, we have for all <span class="math inline">\(g
\in N \backslash G\)</span> <span id="eq:lx-ry-phi_eps" class="math display">\[\label{eq:lx-ry-phi_eps}\tag{21.18}
    L(x) R(y) \Phi_\varepsilon(g) \ll T^{\operatorname{O}(1)}, \quad
    L(x) R(y) \Phi_\varepsilon&#39;(g) \ll
T^{\operatorname{O}(1)}.\]</span></p>
<p>We now bound <span class="math inline">\(f\)</span> on the support of
<span class="math inline">\(\Phi_\varepsilon&#39;\)</span>. Let <span
class="math inline">\((a,k) \in A \times K\)</span>. Suppose <span
class="math inline">\(\Phi_{\varepsilon}&#39;(a k) \neq 0\)</span>. Then
<span class="math inline">\(r(a)\)</span> lies outside some fixed
neighborhood of the origin, hence <span
class="math inline">\(\|T^{\rho^\vee} a\| \geqslant
T^{\varepsilon&#39;}\)</span> for some fixed <span
class="math inline">\(\varepsilon&#39; &gt; 0\)</span>. By the
characterization of <span class="math inline">\(\mathfrak{E}(N
\backslash G, T)\)</span> given in part <a
href="#itm:lemma-class-frak-E-basic:3" data-reference-type="eqref"
data-reference="itm:lemma-class-frak-E-basic:3">\((iii)\)</a>
of Lemma <a href="#lem:standard:frakE-equivalences"
data-reference-type="ref"
data-reference="lem:standard:frakE-equivalences">20.2</a>,
it follows that <span class="math display">\[\int _{k \in K}
    \int _{k \in K}
    \left\lvert
      L(x) R(y) f(a k)
    \right\rvert^2 \, d k
    \ll
    \delta_N(a)
    \|T^{\rho^\vee} a\|^{-\infty}
    T^{-\infty}
    \ll \|a k\|_{N \backslash G}^{-\infty} T^{-\infty}\]</span> for all
fixed <span class="math inline">\((x,y) \in \mathfrak{U}(A) \times
\mathfrak{U}(G)\)</span>. By the Sobolev lemma for <span
class="math inline">\(K\)</span>, we deduce that for all <span
class="math inline">\(g \in N \backslash G\)</span>, <span id="eq:lx-ry-fg" class="math display">\[\label{eq:lx-ry-fg}\tag{21.19}
    L(x) R(y) f(g) \ll \|g\|_{N \backslash G}^{-\infty}
T^{-\infty}.\]</span></p>
<p>Combining <a href="#eq:lx-ry-phi_eps" data-reference-type="eqref"
data-reference="eq:lx-ry-phi_eps">\((21.18)\)</a> and <a
href="#eq:lx-ry-fg" data-reference-type="eqref"
data-reference="eq:lx-ry-fg">\((21.19)\)</a> and appealing to the
product rule for derivatives, we deduce that for all fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span> and fixed <span
class="math inline">\((x,y) \in \mathfrak{U}(A) \times
\mathfrak{U}(G)\)</span>, we have <span id="eq:rx-ly-f" class="math display">\[\label{eq:rx-ly-f}\tag{21.20}
    L(x) R(y)
    f ^{\clubsuit, \varepsilon}(g)
    \ll \|g\|_{N \backslash G}^{-\infty} T^{-\infty}.\]</span> By
overspill, we may find some <span class="math inline">\(\varepsilon&gt;
0\)</span> with <span class="math inline">\(\varepsilon\lll 1\)</span>
for which the conclusion <a href="#eq:rx-ly-f"
data-reference-type="eqref" data-reference="eq:rx-ly-f">\((21.20)\)</a>
remains valid and for which the estimate <a href="#eq:lx-ry-phi_eps"
data-reference-type="eqref"
data-reference="eq:lx-ry-phi_eps">\((21.18)\)</a> holds in the
slightly weaker form <span class="math display">\[L(x) R(y)
\Phi_\varepsilon(g) \ll T^{o(1)},\]</span> say. (Indeed, we know from <a
href="#eq:rx-ly-f" data-reference-type="eqref"
data-reference="eq:rx-ly-f">\((21.20)\)</a> that the set of <span
class="math inline">\(\varepsilon&gt; 0\)</span> for which <span
class="math display">\[\sup_{
      \substack{
        d_1,d_2 \in \mathbb{Z} _{\geqslant 0} :   d_1, d_2 \leqslant
1/\varepsilon\\
        x_1,\dotsc, x_{d_1} \in \mathcal{B}(A) \\
        y_1,\dotsc, y_{d_2} \in \mathcal{B}(G) \\
        g \in N \backslash G}
    }
    \|g\|_{N \backslash G}^{1/\varepsilon}
    \left\lvert R(x_1 \dotsb x_{d_2}) L(y_1 \dotsb y_{d_2})
f^{\clubsuit,\varepsilon}(g) \right\rvert \leqslant
T^{-1/\varepsilon}\]</span> and <span class="math display">\[\sup_{
      \substack{
        d_1,d_2 \in \mathbb{Z} _{\geqslant 0} :   d_1, d_2 \leqslant
1/\varepsilon\\
        x_1,\dotsc, x_{d_1} \in \mathcal{B}(A) \\
        y_1,\dotsc, y_{d_2} \in \mathcal{B}(G) \\
        g \in N \backslash G}
    }
    \left\lvert R(x_1 \dotsb x_{d_2}) L(y_1 \dotsb y_{d_2})
\Phi_\varepsilon(g)  \right\rvert \leqslant T^{\varepsilon}\]</span>
contains all fixed <span class="math inline">\(\varepsilon&gt;
0\)</span>, hence must contain some <span
class="math inline">\(\varepsilon\lll 1\)</span>.) We henceforth work
with such an <span class="math inline">\(\varepsilon\)</span>, and set
<span class="math inline">\(f ^{\clubsuit} := f ^{\clubsuit,
\varepsilon}\)</span>. It is clear from <a href="#eq:rx-ly-f"
data-reference-type="eqref" data-reference="eq:rx-ly-f">\((21.20)\)</a>
and Lemma <a href="#lem:standard:frakE-equivalences"
data-reference-type="ref"
data-reference="lem:standard:frakE-equivalences">20.2</a>
that <span class="math inline">\(f ^{\clubsuit}\)</span> belongs to
<span class="math inline">\(\mathfrak{E}(N \backslash G, T)\)</span> and
satisfies the required estimate <a href="#itm:standard:clubsuit-2"
data-reference-type="eqref"
data-reference="itm:standard:clubsuit-2">\((ii)\)</a>.</p>
<p>It remains to show that the function <span class="math inline">\(f -
f ^{\clubsuit}\)</span>, given by <span class="math display">\[(f - f
^{\clubsuit})(g) =  \Phi_\varepsilon(g) f(g),\]</span> admits a
decomposition <span class="math inline">\(\sum_{\mu \in \Sigma}
f^\mu\)</span> of the required form. For this, we appeal to dyadic
decomposition, as follows. Let <span
class="math inline">\(\Lambda\)</span> denote the discrete subgroup of
<span class="math inline">\(A\)</span> consisting of those elements each
of whose coordinates lie in the discrete subgroup <span
class="math inline">\(\exp(\mathbb{Z})\)</span> of <span
class="math inline">\(\mathbb{R}^\times\)</span>. We may find a fixed
test function <span class="math inline">\(\eta \in
C_c^\infty(A)\)</span>, invariant under <span class="math inline">\(A
\cap K\)</span>, so that <span class="math inline">\(\sum_{\mu \in
\Lambda} \eta(\mu^{-1} a) = 1\)</span> for all <span
class="math inline">\(a \in A\)</span>. We define <span
class="math inline">\(f^{\mu} \in C^\infty(N \backslash G)\)</span> by,
for <span class="math inline">\((a,k) \in A \times K\)</span>, <span
class="math display">\[f^{\mu}(a k) := \eta(\mu^{-1} a)
\Phi_\varepsilon(a) f(a k).\]</span> By construction, the identity <a
href="#eq:f-=-fclubsuit" data-reference-type="eqref"
data-reference="eq:f-=-fclubsuit">\((21.16)\)</a> holds. Set
<span class="math inline">\(\Sigma := \left\{ \mu \in \Lambda : f^\mu
\neq 0 \right\}\)</span>. From the support condition on <span
class="math inline">\(\Phi_\varepsilon\)</span>, we see that <span
class="math inline">\(f ^\mu \neq 0\)</span> only if <span
class="math inline">\(\|\mu T^{\rho^\vee}\| = T^{o(1)}\)</span>, whence
assertion <a href="#itm:standard:decomposition-support-4"
data-reference-type="eqref"
data-reference="itm:standard:decomposition-support-4">\((iv)\)</a>.
In particular, the cardinality bound <a
href="#itm:standard:decomposition-support-3" data-reference-type="eqref"
data-reference="itm:standard:decomposition-support-3">\((iii)\)</a>
holds. The required support condition <a
href="#itm:standard:decomposition-support-5" data-reference-type="eqref"
data-reference="itm:standard:decomposition-support-5">\((v)\)</a>
for <span class="math inline">\(f^\mu\)</span> follows from fact that
<span class="math inline">\(\eta\)</span> has fixed compact support.</p>
<p>It remains only to verify that <span class="math inline">\(f^{\mu}
\in \mathfrak{E}(N \backslash G, T)\)</span>. The function <span
class="math inline">\(N \backslash G \ni a k \mapsto \eta(\mu^{-1}
a)\)</span> and its fixed <span class="math inline">\((A \times
G)\)</span>-derivatives have magnitude <span
class="math inline">\(\operatorname{O}(1)\)</span>. By the noted <span
class="math inline">\(T^{o(1)}\)</span> bounds for the derivatives of
<span class="math inline">\(\Phi_\varepsilon\)</span> and the
characterization of <span class="math inline">\(\mathfrak{E}(N
\backslash G, T)\)</span> given in part <a
href="#itm:lemma-class-frak-E-basic:3" data-reference-type="eqref"
data-reference="itm:lemma-class-frak-E-basic:3">\((iii)\)</a>
of Lemma <a href="#lem:standard:frakE-equivalences"
data-reference-type="ref"
data-reference="lem:standard:frakE-equivalences">20.2</a>,
we see that <span class="math inline">\(f^{\mu} \in \mathfrak{E}(N
\backslash G, T)\)</span>, as required. ◻</p>
</div>
<p>Let <span class="math inline">\(\sigma \in \mathfrak{a}^*\)</span>.
It defines a positive-valued character <span class="math inline">\(A
\rightarrow \mathbb{R}^\times_+\)</span>, <span class="math inline">\(a
\mapsto |a|^{\sigma}\)</span>. We denote temporarily by <span
class="math display">\[\phi_\sigma : N \backslash G \rightarrow
\mathbb{R}^\times_+\]</span> the function given in Iwasawa coordinates
by <span class="math inline">\(\phi_\sigma(a k) := |a|^{\sigma}\)</span>
for all <span class="math inline">\((a,k) \in A \times K\)</span>. For
example, the functions <span
class="math inline">\(|\det|_{M&#39;&#39;}^{b}\)</span> with <span
class="math inline">\(b \in \mathbb{R}\)</span> are of this form.</p>
<p>Recall from §<a href="#sec:local-sobolev-norms-prelims"
data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a> the definitions
and basic properties of the Sobolev norms <span
class="math inline">\(\mathcal{S}_{d_1,d_2}\)</span> and their rescaled
variants <span
class="math inline">\(\mathcal{S}_{d_1,d_2,T}\)</span>.</p>
<div id="item:sobolev-frakE-3" class="lemma">
<p><strong>Lemma 329</strong>. <span
id="lem:lemma-Sobolev-estimates-frakE"
label="lem:lemma-Sobolev-estimates-frakE"></span> Let <span
class="math inline">\(T \ggg 1\)</span>. Let <span
class="math inline">\(f \in \mathfrak{E}(N \backslash G, T)\)</span>.
Let <span class="math inline">\(Y \in A^0\)</span> with each component
satisfying <span class="math inline">\(Y_j \in [T^{-1/2},
T^{1/2}]\)</span>. Let <span class="math inline">\(\sigma\)</span>
belong to some fixed compact subset of <span
class="math inline">\(\mathfrak{a}^*\)</span>. Then:</p>
<ol type="i">
<li><p><span id="item:sobolev-frakE-0"
label="item:sobolev-frakE-0"></span> For all fixed <span
class="math inline">\(d_1,d_2 \in \mathbb{Z}_{\geqslant 0}\)</span>,
<span id="eq:mathc-d_2-phi_s" class="math display">\[\label{eq:mathc-d_2-phi_s}\tag{21.21}
      \mathcal{S}_{d_1,d_2} \left(\phi_{\sigma} L(Y) f\right) \ll T^{-
\langle \rho^\vee , \sigma  \rangle + d_2 + o(1)}
Y^{-\sigma}.\]</span></p></li>
<li><p><span id="item:sobolev-frakE-1"
label="item:sobolev-frakE-1"></span> For all fixed <span
class="math inline">\(d_1, d_2 \in \mathbb{Z}_{\geqslant 0}\)</span>,
<span id="eq:mathc-d_2-det_m" class="math display">\[\label{eq:mathc-d_2-det_m}\tag{21.22}
      \mathcal{S}_{d_1,d_2} (\phi_\sigma  L(Y) f) \ll
T^{\operatorname{O}(1)}.\]</span></p></li>
<li><p><span id="item:sobolev-frakE-2"
label="item:sobolev-frakE-2"></span> There is a fixed <span
class="math inline">\(C_0 \geqslant 0\)</span> so that for all fixed
<span class="math inline">\(d_1, d_2 \in \mathbb{Z}_{\geqslant
0}\)</span>, <span class="math display">\[\mathcal{S}_{d_1,d_2,T}
(\phi_{\sigma} L(Y) f) \ll T^{C_0}.\]</span></p></li>
<li><p>For all fixed <span class="math inline">\(d_1 \in
\mathbb{Z}_{\geqslant 0}\)</span>, <span
class="math display">\[\mathcal{S}_{d_1,0}(L(Y) f) \ll
T^{o(1)}.\]</span></p></li>
</ol>
</div>
<div class="proof">
<p><em>Proof.</em> We recall (from §<a
href="#sec:local-sobolev-norms-prelims" data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a>) that the LHS
of <a href="#eq:mathc-d_2-det_m" data-reference-type="eqref"
data-reference="eq:mathc-d_2-det_m">\((21.22)\)</a> is the mean
square, over <span class="math inline">\(x = x_1 \dotsb x_{d_1}\)</span>
and <span class="math inline">\(y = y_1 \dotsb y_{d_2}\)</span> with
<span class="math inline">\(x_i \in \mathcal{B}(A) \cup \{1\}\)</span>
and <span class="math inline">\(y_j \in \mathcal{B}(G) \cup
\{1\}\)</span>, of the <span class="math inline">\(L^2(N \backslash
G)\)</span>-norms <span class="math display">\[\|L(x) R(y) \phi_{\sigma}
L(Y) f\|.\]</span> For any such <span class="math inline">\(x\)</span>
and <span class="math inline">\(y\)</span>, we have <span
class="math display">\[\left(
      L(x) R(y) \phi_{\sigma}
    \right)(g)
    \ll \phi_{\sigma}(g).\]</span> (Indeed, it is enough to check that
the class of functions <span class="math inline">\(\phi_{\sigma,f} : N
\backslash G \rightarrow \mathbb{C}\)</span> of the form <span
class="math inline">\(\phi_{\sigma,f}(a k) := |a|^{\sigma}
f(k)\)</span>, where <span class="math inline">\(f : (A \cap K)
\backslash K \rightarrow \mathbb{C}\)</span> has some fixed <span
class="math inline">\(K\)</span>-type and <span
class="math inline">\(L^\infty\)</span>-norm <span
class="math inline">\(\ll 1\)</span>, is preserved under <span
class="math inline">\(L(x)\)</span> and <span
class="math inline">\(R(y)\)</span> for <span class="math inline">\(x
\in \mathop{\mathrm{Lie}}(A)\)</span> and <span class="math inline">\(y
\in \mathop{\mathrm{Lie}}(G)\)</span>. The required conclusion
concerning <span class="math inline">\(L(x)\)</span> follows from the
homomorphism property of <span
class="math inline">\(|.|^{\sigma}\)</span>, that for <span
class="math inline">\(R(y)\)</span> by considering the Iwasawa
decomposition of <span class="math inline">\(\mathop{\mathrm{Ad}}(k)
y\)</span>.) By the product rule for derivatives, we deduce that <span
class="math display">\[\begin{align}
    &amp;\mathcal{S}_{d_1,d_2} (\phi _\sigma  L(Y) f)^2 \\
    &amp;\ll
    \max_{
      \substack{
        x,y:  \\
        \text{as above}
      }
    }
    \int _{g \in N \backslash G}
    \delta_N^{-1}(Y)
    \phi_\sigma(g)^2
    \left\lvert
      L(x) R(y) f
    \right\rvert^2(Y g) \, d g.
  
\end{align}\]</span> Motivated by the concentration properties of
<span class="math inline">\(f\)</span>, we now write <span
class="math display">\[\phi_\sigma(g) = T^{-\langle \rho^\vee,
\sigma  \rangle} Y^{-\sigma} \phi_\sigma(T^{\rho^\vee} Y g)\]</span> and
substitute <span class="math inline">\(g \mapsto Y^{-1} g\)</span> in
the integral, giving <span class="math display">\[(T^{-\langle
\rho^\vee, \sigma  \rangle} Y^{-\sigma})^2
    \int _{g \in N \backslash G}
    \phi_{\sigma} (T^{\rho^\vee} g)^2
    \left\lvert
      L(x) R(y) f
    \right\rvert^2(g) \, d g.\]</span> Our hypotheses on <span
class="math inline">\(\sigma\)</span> give <span
class="math inline">\(\phi_{\sigma} (T^{\rho^\vee} g) \ll
\|T^{\rho^\vee} g\|_{N \backslash G}^{\operatorname{O}(1)}\)</span>, so
by Lemma <a href="#lem:f-in-mathfraken-square-integral-frakE"
data-reference-type="ref"
data-reference="lem:f-in-mathfraken-square-integral-frakE">286</a>, we
deduce assertion <a href="#item:sobolev-frakE-0"
data-reference-type="eqref"
data-reference="item:sobolev-frakE-0">\((i)\)</a>.
Assertion <a href="#item:sobolev-frakE-1" data-reference-type="eqref"
data-reference="item:sobolev-frakE-1">\((ii)\)</a> follows
by noting that the RHS of <a href="#eq:mathc-d_2-phi_s"
data-reference-type="eqref"
data-reference="eq:mathc-d_2-phi_s">\((21.21)\)</a> is <span
class="math inline">\(T^{\operatorname{O}(1)}\)</span> under our
hypotheses on <span class="math inline">\(\sigma\)</span> and <span
class="math inline">\(Y\)</span>. Assertion <a
href="#item:sobolev-frakE-2" data-reference-type="eqref"
data-reference="item:sobolev-frakE-2">\((iii)\)</a>
similarly follows upon recalling, from <a href="#eq:mathcals_d_1-d_2-tf"
data-reference-type="eqref"
data-reference="eq:mathcals_d_1-d_2-tf">\((2.21)\)</a>,
the definition <span
class="math inline">\(\mathcal{S}_{d_1,d_2,T}(f&#39;) = \max_{0
\leqslant k \leqslant d_2} T^{-k} \mathcal{S}_{d_1,k}(f&#39;)\)</span>;
we may take any <span class="math inline">\(C_0\)</span> for which <span
class="math display">\[- \langle \rho ^\vee , \sigma  \rangle / 2 -
\mathop{\mathrm{trace}}(\sigma)/4 \leqslant C_0.\]</span> Assertion <a
href="#item:sobolev-frakE-3" data-reference-type="eqref"
data-reference="item:sobolev-frakE-3">\((iv)\)</a> follows
by specializing <a href="#eq:mathc-d_2-phi_s"
data-reference-type="eqref"
data-reference="eq:mathc-d_2-phi_s">\((21.21)\)</a> to <span
class="math inline">\((d_2,\sigma) = (0,0)\)</span>. ◻</p>
</div>
<h4 id="sec:20230514074956">§21.9. The main local estimate</h4>
<div id="prop:sub-gln:let-f-in" class="proposition">
<p><strong>Proposition 330</strong>. <em>Let <span
class="math inline">\(f \in \mathfrak{E}(N \backslash G, T)\)</span>.
Let <span class="math inline">\(Y \in A^0\)</span> with each component
<span class="math inline">\(Y_j\)</span> satisfying <span id="eq:t-kappa-leq" class="math display">\[\label{eq:t-kappa-leq}\tag{21.23}
    T^{-\kappa} \leqslant|Y_j| \leqslant T^{\kappa}\]</span> for some
fixed <span class="math inline">\(\kappa &lt; 1/2\)</span>. Let <span
class="math inline">\(r &gt; 0\)</span> with <span
class="math inline">\(r = T^{\operatorname{O}(1)}\)</span>. Retain
Assumptions <a href="#sec:bounds-at-real-assumptions-phi"
data-reference-type="ref"
data-reference="sec:bounds-at-real-assumptions-phi">316</a> concerning
<span class="math inline">\(\phi\)</span>. Let <span
class="math inline">\(c \in A&#39;&#39;\)</span> with <span
class="math inline">\(|\det c| \geqslant 1\)</span>. Then <span id="eq:qpphi-ly-f" class="math display">\[\label{eq:qpphi-ly-f}\tag{21.24}
    Q_P(\phi, L(Y) f, c)
    \ll
    \min
    \left(
      \frac{r^n T^{o(1)} \det(Y)}{|\det (c)|} ,
      \frac{T^{\operatorname{O}(1)}}{|\det c|^{10}}
    \right)
    +
    \frac{T^{-\infty }}{|\det c|^{10}}\]</span></em></p>
</div>
<p>We have abused notation slightly in our use of “<span
class="math inline">\(\min\)</span>.” The estimate <a
href="#eq:qpphi-ly-f" data-reference-type="eqref"
data-reference="eq:qpphi-ly-f">\((21.24)\)</a> means, more
precisely, that there is a fixed <span class="math inline">\(C_0
\geqslant 0\)</span> so that for each fixed <span
class="math inline">\(C_1 \geqslant 0\)</span> and <span
class="math inline">\(\varepsilon&gt; 0\)</span>, we have <span
class="math display">\[Q_P(\phi, L(Y) f, c)
  \ll
  \min
  \left(
    \frac{r^n T^{\varepsilon} \det(Y)}{|\det (c)|},
    \frac{T^{C_0}}{|\det c|^{10}}
  \right)
  +
  \frac{T^{-C_1 }}{|\det c|^{10}}.\]</span></p>
<p>On a first reading, the reader is encouraged to pretend that <span
class="math inline">\(Y = 1\)</span> (since, to deduce a qualitative
subconvex bound, it is enough to treat the case that each <span
class="math inline">\(Y_j = T^{o(1)}\)</span>). The variable <span
class="math inline">\(r\)</span>, on the other hand, should be regarded
as being potentially quite small (e.g., of size <span
class="math inline">\(T^{(1-n)/2}\)</span>).</p>
<p>The proof of Proposition <a href="#prop:sub-gln:let-f-in"
data-reference-type="ref" data-reference="prop:sub-gln:let-f-in">330</a>
requires all of the main lemmas of §<a href="#sec:bounds-at-real-2"
data-reference-type="ref" data-reference="sec:bounds-at-real-2">4.7</a>,
and proceeds in several steps. We first decompose <span id="eq:f-=-f" class="math display">\[\label{eq:f-=-f}\tag{21.25}
  f = f ^{\clubsuit} + \sum f ^\mu\]</span> according to Lemma <a
href="#lem:standard:let-f-in-2" data-reference-type="ref"
data-reference="lem:standard:let-f-in-2">21.26</a>.
Since the number of summands is <span class="math inline">\((\log
T)^{\operatorname{O}(1)} \ll T^{o(1)}\)</span>, we may reduce via the
Minkowski-type inequality <span class="math display">\[Q_P(\phi, f_1 +
\dotsb + f_k, c)
  \leqslant
  k
  \sum_{j=1}^k
  Q_P(\phi, f_j, c)\]</span> to estimating the contribution to <span
class="math inline">\(Q_P(\phi,L(Y) f,c)\)</span> of each term on the
RHS of <a href="#eq:f-=-f" data-reference-type="eqref"
data-reference="eq:f-=-f">\((21.25)\)</a>. We treat these separately in
the lemmas below.</p>
<p>We first treat the contribution of <span
class="math inline">\(f^{\clubsuit}\)</span>. The following estimate is
acceptable for the purposes of proving Proposition <a
href="#prop:sub-gln:let-f-in" data-reference-type="ref"
data-reference="prop:sub-gln:let-f-in">330</a>.</p>
<div id="lemma:20230514162239" class="lemma">
<p><strong>Lemma 331</strong>. We have <span
class="math display">\[Q_P(\phi, L(Y) f^{\clubsuit},c) \ll
    \frac{T^{-\infty}}{|\det c|^{10}}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> In view of our assumption <span
class="math inline">\(r = T^{\operatorname{O}(1)}\)</span>, it is enough
to show that for all fixed <span class="math inline">\(b \geqslant
10\)</span>, <span class="math display">\[Q_P(\phi, L(Y)
f^{\clubsuit},c) \ll
    \frac{r^{n&#39;&#39; b}}{|\det c|^{b}} T^{-\infty},\]</span> say. By
Lemma <a href="#lem:sub-gln:there-fixed-x-1" data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-x-1">326</a>, we reduce to
showing that any fixed <span class="math inline">\(d_1,d_2 \in
\mathbb{Z}_{\geqslant 0}\)</span> and <span class="math inline">\(b \in
\mathbb{R}\)</span>, <span id="eq:estimate-clubsuit-contribution-trivially" class="math display">\[\label{eq:estimate-clubsuit-contribution-trivially}\tag{21.26}
    \mathcal{S}_{d_1, d_2}(|\det|_{M&#39;&#39;}^{-b/2} L(Y)
f^{\clubsuit})
    \ll T^{-\infty},\]</span> which follows in turn from Lemma <a
href="#lem:lemma-Sobolev-estimates-frakE" data-reference-type="ref"
data-reference="lem:lemma-Sobolev-estimates-frakE">21.27</a>,
part <a href="#item:sobolev-frakE-1" data-reference-type="eqref"
data-reference="item:sobolev-frakE-1">\((ii)\)</a> in view
of the membership <span class="math inline">\(f^{\clubsuit} \in
T^{-\infty} \mathfrak{E}(N \backslash G, T)\)</span>. ◻</p>
</div>
<p>We next focus on an individual term <span
class="math inline">\(f^{\mu}\)</span> in <a href="#eq:f-=-f"
data-reference-type="eqref" data-reference="eq:f-=-f">\((21.25)\)</a>. We
will show that the contribution of <span
class="math inline">\(f^\mu\)</span> is majorized by the first term on
the RHS of <a href="#eq:qpphi-ly-f" data-reference-type="eqref"
data-reference="eq:qpphi-ly-f">\((21.24)\)</a>. To see this, we must
establish upper bounds involving each of the two alternatives in the
minimum defining that term. The required bounds are given by Lemma <a
href="#lem:standard:we-have-begin-first-alternative"
data-reference-type="ref"
data-reference="lem:standard:we-have-begin-first-alternative">332</a>
and Proposition <a
href="#prop:standard:we-have-begin-second-alternative"
data-reference-type="ref"
data-reference="prop:standard:we-have-begin-second-alternative">333</a>,
below.</p>
<p>We start with the (simpler) second alternative in the minimum.</p>
<div id="lem:standard:we-have-begin-first-alternative" class="lemma">
<p><strong>Lemma 332</strong>. We have <span
class="math display">\[Q_P(\phi, L(Y) f^\mu , c)
    \ll
    \frac{T^{\operatorname{O}(1)}}{|\det c|^{10}}.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> Using again our assumption <span
class="math inline">\(r = T^{\operatorname{O}(1)}\)</span>, it is enough
to show that for each fixed <span class="math inline">\(b \geqslant
10\)</span>, there is a fixed <span class="math inline">\(C_0 \geqslant
0\)</span> so that <span class="math display">\[Q_P(\phi, L(Y) f^\mu, c)
\ll
    \frac{r^{n&#39;&#39; b}}{|\det c|^{b}} T^{C_0}.\]</span> By Lemma <a
href="#lem:sub-gln:there-fixed-x-1" data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-x-1">326</a>, it suffices to
verify that for each fixed <span class="math inline">\(d_{1}, d_2 \in
\mathbb{Z}_{\geqslant 0}\)</span> and <span class="math inline">\(b \in
\mathbb{R}\)</span>, we have <span id="eq:mathc-d_2-left" class="math display">\[\label{eq:mathc-d_2-left}\tag{21.27}
    \mathcal{S}_{d_1,d_2} \left(
      |\det|_{M&#39;&#39;}^{-b/2} L(Y) f^\mu
    \right)^2 \ll T^{\operatorname{O}(1)}.\]</span> This estimate
follows in turn from Lemma <a href="#lem:lemma-Sobolev-estimates-frakE"
data-reference-type="ref"
data-reference="lem:lemma-Sobolev-estimates-frakE">21.27</a>,
part <a href="#item:sobolev-frakE-1" data-reference-type="eqref"
data-reference="item:sobolev-frakE-1">\((ii)\)</a>. ◻</p>
</div>
<p>It remains to address the (crucial) first alternative in the
minimum.</p>
<div id="prop:standard:we-have-begin-second-alternative"
class="proposition">
<p><strong>Proposition 333</strong>. <em>We have <span id="eq:qpphi-ly-fmu" class="math display">\[\label{eq:qpphi-ly-fmu}\tag{21.28}
  Q_P(\phi, L(Y) f^\mu , c)
  \ll
  \frac{r^n T^{o(1)} \det(Y)}{|\det (c)|}.\]</span></em></p>
</div>
<p>The proof divides into a couple steps. For both steps, it is relevant
to recall that by the construction of <span
class="math inline">\(f^\mu\)</span>, we have <span
class="math display">\[f^\mu (a&#39; a&#39;&#39; k) \neq 0 \implies
|\det a&#39;&#39;| \asymp \prod_{j=n&#39; + 1}^{n} \mu_j,\]</span> hence
<span id="eq:ly-fmua-a" class="math display">\[\label{eq:ly-fmua-a}\tag{21.29}
  L(Y) f^\mu(a&#39; a&#39;&#39; k) \neq 0 \implies  \det(Y&#39;&#39;)
|\det a&#39;&#39;| \asymp D , \quad D := \prod_{j=n&#39;+1}^{n}
\mu_j,\]</span> where we write <span class="math inline">\(Y = Y&#39;
Y&#39;&#39;\)</span> with <span class="math inline">\((Y&#39;,
Y&#39;&#39;) \in A&#39; \times A&#39;&#39;\)</span>.</p>
<div id="lemma:20230514162116" class="lemma">
<p><strong>Lemma 334</strong>. We have <span id="eq:q_pphi-f-c" class="math display">\[\label{eq:q_pphi-f-c}\tag{21.30}
  Q_P(\phi, L(Y) f^\mu,c) \ll \frac{r^{n&#39;&#39;} T^{o(1)}}{D |\det (c
Y&#39;&#39;)| }.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> For fixed <span class="math inline">\(d_1 \in
\mathbb{Z}_{\geqslant 0}\)</span> we have by <a
href="#eq:mathcals_d_1-d_2la-f" data-reference-type="eqref"
data-reference="eq:mathcals_d_1-d_2la-f">\((2.20)\)</a>,
followed by Lemma <a href="#lem:lemma-Sobolev-estimates-frakE"
data-reference-type="ref"
data-reference="lem:lemma-Sobolev-estimates-frakE">21.27</a>,
part <a href="#item:sobolev-frakE-3" data-reference-type="eqref"
data-reference="item:sobolev-frakE-3">\((iv)\)</a> that
<span class="math display">\[\mathcal{S}_{d_1,0}(L(Y) f^{\mu})
  \ll
  T^{o(1)}.\]</span> The required estimate then follows from Lemma <a
href="#lem:sub-gln:there-fixed-x-3" data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-x-3">325</a> and <a
href="#eq:ly-fmua-a" data-reference-type="eqref"
data-reference="eq:ly-fmua-a">\((21.29)\)</a>. ◻</p>
</div>
<div id="lemma:20230514162141" class="lemma">
<p><strong>Lemma 335</strong>. There is a fixed <span
class="math inline">\(C_1 \geqslant 0\)</span> so that for each fixed
<span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>,
we have <span id="eq:q_pphi-f-c-1" class="math display">\[\label{eq:q_pphi-f-c-1}\tag{21.31}
    Q_P(\phi,L(Y) f,c) \ll T^{C_1}
    \min \left( 1,
      \frac{r^{n&#39;&#39;} T^{n&#39;&#39;(n&#39;&#39;-1)/2}
\det(Y&#39;&#39;)}{D |\det (c)|}
    \right)^{\ell }.\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> We apply Lemma <a
href="#lem:lemma-Sobolev-estimates-frakE" data-reference-type="ref"
data-reference="lem:lemma-Sobolev-estimates-frakE">21.27</a>,
part <a href="#item:sobolev-frakE-2" data-reference-type="eqref"
data-reference="item:sobolev-frakE-2">\((iii)\)</a> to see
that for each fixed <span class="math inline">\(b \in
\mathbb{R}\)</span>, there is a fixed <span class="math inline">\(C_0
\geqslant 0\)</span> so that for all fixed <span
class="math inline">\(d_1,d_2 \in \mathbb{Z}_{\geqslant 0}\)</span>, we
have <span id="eq:mathc-d_2-tdet_m" class="math display">\[\label{eq:mathc-d_2-tdet_m}\tag{21.32}
    \mathcal{S}_{d_1, d_2, T}(|\det|_{M&#39;&#39;}^{-b/2} L(Y) f^{\mu})
\ll T^{C_0}.\]</span> In the case <span
class="math inline">\(n&#39;&#39; \geqslant 2\)</span>, we may apply
Lemma <a href="#lem:sub-gln:there-fixed-x-2" data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-x-2">327</a>, and the required
estimate follows from <a href="#eq:mathc-d_2-tdet_m"
data-reference-type="eqref"
data-reference="eq:mathc-d_2-tdet_m">\((21.32)\)</a> and our
hypotheses <span class="math inline">\(r =
T^{\operatorname{O}(1)}\)</span> and <span class="math inline">\(|\det
c| \geqslant 1\)</span>. For the case <span
class="math inline">\(n&#39;&#39; = 1\)</span>, we appeal instead to <a
href="#eq:mathc-d_2-tdet_m" data-reference-type="eqref"
data-reference="eq:mathc-d_2-tdet_m">\((21.32)\)</a> and Lemma
<a href="#lem:sub-gln:there-fixed-x-1" data-reference-type="ref"
data-reference="lem:sub-gln:there-fixed-x-1">326</a>, taking <span
class="math inline">\(b = 0\)</span> and <span class="math inline">\(b =
\ell\)</span> in the latter. (We remark that in the case <span
class="math inline">\(n&#39;&#39; = 1\)</span>, sharper conclusions may
be derived more directly, but the recorded argument suffices for our
purposes.) ◻</p>
</div>
<p>For the purposes of proving <a href="#eq:qpphi-ly-fmu"
data-reference-type="eqref"
data-reference="eq:qpphi-ly-fmu">\((21.28)\)</a>, the estimate <a
href="#eq:q_pphi-f-c" data-reference-type="eqref"
data-reference="eq:q_pphi-f-c">\((21.30)\)</a> is adequate provided
that <span id="eq:rn-ll-d" class="math display">\[\label{eq:rn-ll-d}\tag{21.33}
  r^{n&#39;&#39;}\det(Y&#39;&#39;) \ll D r^n T^{o(1)} \det(Y).\]</span>
In particular, in the “nondegenerate” case <span class="math inline">\(P
= G\)</span>, we have <span class="math inline">\(\det(Y&#39;&#39;) =
\det(Y)\)</span>, <span class="math inline">\(n&#39;&#39; = n\)</span>
and <span class="math inline">\(D = T^{o(1)}\)</span>, so <a
href="#eq:rn-ll-d" data-reference-type="eqref"
data-reference="eq:rn-ll-d">\((21.33)\)</a> always holds and the proof
is now complete. We may thus suppose henceforth that <span id="eq:p-neq-g" class="math display">\[\label{eq:p-neq-g}\tag{21.34}
  P \neq G,
  \quad
  n&#39; \geqslant 1,
  \quad
  r^{n&#39;&#39;} \det(Y&#39;&#39;) \ggg D r^n \det(Y).\]</span> In view
of the estimate <a href="#eq:q_pphi-f-c-1" data-reference-type="eqref"
data-reference="eq:q_pphi-f-c-1">\((21.31)\)</a>, our task reduces
to the following calculation:</p>
<div id="lem:under-stat-cond" class="lemma">
<p><strong>Lemma 336</strong>. Under the stated conditions <a
href="#eq:p-neq-g" data-reference-type="eqref"
data-reference="eq:p-neq-g">\((21.34)\)</a>, we have <span id="eq:fracrn-tnn-12d" class="math display">\[\label{eq:fracrn-tnn-12d}\tag{21.35}
    \frac{r^{n&#39;&#39;} T^{n&#39;&#39;(n&#39;&#39;-1)/2} \det
(Y&#39;&#39;)}{D}
    \ll T^{-\varepsilon}\]</span> for some fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>.</p>
</div>
<p>To explicate the sufficiency of this estimate, observe by <a
href="#eq:q_pphi-f-c-1" data-reference-type="eqref"
data-reference="eq:q_pphi-f-c-1">\((21.31)\)</a>, <a
href="#eq:fracrn-tnn-12d" data-reference-type="eqref"
data-reference="eq:fracrn-tnn-12d">\((21.35)\)</a> and the
hypothesis <span class="math inline">\(|\det c| \geqslant 1\)</span>
that <span class="math display">\[Q_P(\phi, L(Y) f,c) \ll |\det
c|^{-\ell} T^{C_1 - \ell \varepsilon+ o(1)}\]</span> for each fixed
<span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>.
Taking <span class="math inline">\(\ell \geqslant 10\)</span>
sufficiently large then gives <span class="math display">\[Q_P(\phi,L(Y)
f,c) \ll |\det c|^{-10} T^{-\infty},\]</span> which is adequate for the
purposes of proving <a href="#eq:qpphi-ly-fmu"
data-reference-type="eqref"
data-reference="eq:qpphi-ly-fmu">\((21.28)\)</a> in view of our
assumptions <span class="math inline">\(r =
T^{\operatorname{O}(1)}\)</span> and <span
class="math inline">\(\det(Y&#39;&#39;) =
T^{\operatorname{O}(1)}\)</span>.</p>
<div class="proof">
<p><em>Proof of Lemma <a href="#lem:under-stat-cond"
data-reference-type="ref"
data-reference="lem:under-stat-cond">336</a>.</em> We first employ <a
href="#eq:p-neq-g" data-reference-type="eqref"
data-reference="eq:p-neq-g">\((21.34)\)</a> to see that <span
class="math display">\[r^{n&#39;} \lll \frac{1}{D
\det(Y&#39;)}.\]</span> Our task <a href="#eq:fracrn-tnn-12d"
data-reference-type="eqref"
data-reference="eq:fracrn-tnn-12d">\((21.35)\)</a> thereby
reduces to verifying that <span id="eq:fracdetynn-tnn-12dnn" class="math display">\[\label{eq:fracdetynn-tnn-12dnn}\tag{21.36}
    \frac{T^{n&#39;&#39;(n&#39;&#39;-1)/2} \det (Y&#39;&#39;)
}{D^{n/n&#39;} \det(Y&#39;)^{n&#39;&#39;/n&#39;}  }
    \ll T^{-\varepsilon}.\]</span> From our hypothesis <a
href="#eq:t-kappa-leq" data-reference-type="eqref"
data-reference="eq:t-kappa-leq">\((21.23)\)</a> on <span
class="math inline">\(Y\)</span>, we know that <span
class="math display">\[\frac{\det(Y&#39;&#39;)}{\det(Y&#39;)^{n&#39;&#39;/n&#39;}}
\ll
    T^{\frac{1}{2} (n&#39;&#39; / n&#39; + 1) - \varepsilon}
    =
    T^{n/2 n&#39; - \varepsilon}\]</span> for some fixed <span
class="math inline">\(\varepsilon&gt; 0\)</span>. On the other hand,
from the definition <a href="#eq:ly-fmua-a" data-reference-type="eqref"
data-reference="eq:ly-fmua-a">\((21.29)\)</a> of <span
class="math inline">\(D\)</span> and the estimates <a
href="#eq:mu_1-=-tfrac1" data-reference-type="eqref"
data-reference="eq:mu_1-=-tfrac1">\((21.17)\)</a> for the <span
class="math inline">\(\mu_j\)</span>, we have <span
class="math display">\[D = T^{\sum_{j=n&#39;+1}^{n} (2 j - n -
1)/2}.\]</span> By the combinatorial identity <span
class="math display">\[\sum_{j=n&#39;+1}^{n}
    \frac{2j -n - 1}{2} =
    \frac{n &#39; n&#39;&#39;}{2},\]</span> it follows that <span
class="math display">\[D^{n / n&#39;} =
    T^{n n&#39;&#39;/2 + o(1)}.\]</span> Thus to establish <a
href="#eq:fracdetynn-tnn-12dnn" data-reference-type="eqref"
data-reference="eq:fracdetynn-tnn-12dnn">\((21.36)\)</a>,
it will suffice to verify that <span class="math display">\[\frac{n}{2
n&#39;}
    +
    \frac{n&#39;&#39; (n&#39;&#39;-1)}{2}
    \leqslant
    \frac{n n&#39;&#39;}{2}.\]</span> Writing <span
class="math inline">\(n = n&#39; + n&#39;&#39;\)</span>, we may
rearrange this last inequality as <span class="math inline">\(n&#39; +
n&#39;&#39; \leqslant n&#39; (n&#39; + 1) n&#39;&#39;\)</span>. In that
form, it follows immediately from the inequalities <span
class="math inline">\(n&#39;, n&#39;&#39; \geqslant 1\)</span>, which
follow in turn from our having reduced to the case <span
class="math inline">\(P \neq G\)</span>. ◻</p>
</div>
<h3 id="sec:completion-proof-1">§22. Completion of the proof</h3>
<p>Our aim is to complete the proof of Proposition <a
href="#prop:bound-after-theta-degenerate-case-2"
data-reference-type="ref"
data-reference="prop:bound-after-theta-degenerate-case-2">297</a>. We
retain Assumptions <a href="#assumptions:furth-reduct-proof"
data-reference-type="ref"
data-reference="assumptions:furth-reduct-proof">296</a>. We resume the
global discussion of §<a href="#sec:reduction-proof"
data-reference-type="ref" data-reference="sec:reduction-proof">3</a>,
retaining the notation of that section. In particular,</p>
<ul>
<li><p><span class="math inline">\(G\)</span> is <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Z}\)</span> (or for the present purposes,
over <span class="math inline">\(\mathbb{Q}\)</span>)</p></li>
<li><p><span class="math inline">\(P = M U_P\)</span> is either <span
class="math inline">\(G\)</span> itself or a standard maximal parabolic,
and</p></li>
<li><p><span class="math inline">\(M = M&#39; \times
M&#39;&#39;\)</span>, <span class="math inline">\(A&#39;, N&#39;
\leqslant M&#39;\)</span> and <span class="math inline">\(A&#39;&#39;,
N&#39;&#39; \leqslant M&#39;&#39;\)</span> are as before.</p></li>
</ul>
<p>We also set <span class="math inline">\((n&#39;, n&#39;&#39;) :=
(\mathop{\mathrm{rank}}(M&#39;),
\mathop{\mathrm{rank}}(M&#39;&#39;))\)</span>, as in §<a
href="#sec:degenerate-integrals" data-reference-type="ref"
data-reference="sec:degenerate-integrals">4.6</a>.</p>
<h4 id="reduction-of-global-bounds-to-archimedean-bounds">Reduction of
global bounds to archimedean bounds</h4>
<p>For <span class="math inline">\(m \in \mathbb{N} :=
\mathbb{Z}_{\geqslant 1}\)</span>, let <span
class="math inline">\(\tau(m)\)</span> denote the number of divisors of
<span class="math inline">\(m\)</span> and <span
class="math inline">\(\Sigma^P(m)\)</span> the set of <span
class="math inline">\(c \in A&#39;&#39;(\mathbb{Q})\)</span>, identified
with <span class="math inline">\(n&#39;&#39;\)</span>-tuples of nonzero
rational numbers, with the following properties:</p>
<ol type="i">
<li><p>Each entry <span class="math inline">\(c_j\)</span> is an
integer.</p></li>
<li><p><span class="math inline">\(|\det(c)| = \prod |c_j| =
m\)</span>.</p></li>
</ol>
<p>Clearly <span class="math inline">\(|\Sigma^P(m)| \ll
\tau(m)^{\operatorname{O}(1)}\)</span>.</p>
<p>We temporarily revoke our assumption that <span
class="math inline">\(f \in \mathfrak{E}(N(\mathbb{R}) \backslash
G(\mathbb{R}), T)\)</span>; the following lemma is valid for any <span
class="math inline">\(f \in \mathcal{S}(N(\mathbb{R}) \backslash
G(\mathbb{R}))\)</span>.</p>
<div id="lem:scratch-research:we-have-begin" class="lemma">
<p><strong>Lemma 337</strong>. We have <span id="eq:mathc-f_infty-ll" class="math display">\[\label{eq:mathc-f_infty-ll}\tag{22.1}
    \mathcal{Q}_P(\phi,f) \ll \sum _{m \in \mathbb{N}}
    \frac{\tau(m)^{\operatorname{O}(1)}}{m^{n&#39;}}
    \max_{c \in \Sigma^P(m)}
    Q_P(\phi_\infty, f, c).\]</span></p>
</div>
<div class="proof">
<p><em>Proof.</em> By Lemma <a href="#lem:sub-gln:let-phi-in"
data-reference-type="ref"
data-reference="lem:sub-gln:let-phi-in">302</a> and the triangle
inequality, we have <span class="math display">\[\mathcal{Q}_P(\phi,f)
  \ll
  \sum_{b,c \in A&#39;&#39;(\mathbb{Q})}
  \prod_\mathfrak{p}
  \left\lvert
    I_\mathfrak{p}(b,c)
  \right\rvert,\]</span> where, with <span
class="math inline">\(W_P(\dotsb)\)</span> as in §<a
href="#sec:degenerate-integrals" data-reference-type="ref"
data-reference="sec:degenerate-integrals">4.6</a> and <span
class="math display">\[W_\mathfrak{p}(c,g) :=
  W_P(\Theta^P[f]_\mathfrak{p}, c, g),\]</span> we set <span
class="math display">\[I_\infty(b,c) := \int _{N(\mathbb{R}) \backslash
G(\mathbb{R}) } \phi_\infty(g) W_\infty(b,g) \overline{W_\infty(c,g)} \,
d g,\]</span> <span class="math display">\[I_p(b,c) := \int _{a \in
A&#39;&#39;(\mathbb{Q}_p)}
  1_{|a_n| = 1}
  W_p(b,a)
  \overline{W_p(c,a)}
  \, \frac{d a}{\delta_{N(\mathbb{Q}_p)}(a)}.\]</span> We have <span
class="math inline">\(\delta_{N(\mathbb{Q}_p)}(a) =
\delta_{N&#39;&#39;(\mathbb{Q}_p)}(a) |\det a|_p^{-n&#39;}\)</span>.
Since <span class="math inline">\(\Theta^P_p\)</span> is supported on
elements with unit determinant, we have <span
class="math inline">\(W_p(c,a) \neq 0\)</span> only if <span
class="math inline">\(|\det(c)|_p = |\det a|_p\)</span>. We may thus
rewrite <span class="math display">\[I_p(b,c) =
  |\det c|_p^{n&#39;}
  \int _{a \in A&#39;&#39;(\mathbb{Q}_p)}
  1_{|a_n| = 1}
  W_p(b,a)
  \overline{W_p(c,a)}
  \, \frac{d a}{\delta_{N&#39;&#39;(\mathbb{Q}_p)}(a)}.\]</span> The
remaining integral is the subject of Lemma <a href="#lem:sub-gln:b-c-in"
data-reference-type="ref" data-reference="lem:sub-gln:b-c-in">305</a>,
but applied on the smaller general linear group <span
class="math inline">\(M&#39;&#39;\)</span>. The results of that lemma
give that <span class="math inline">\(\prod_p I_p(b,c) = 0\)</span>
unless <span class="math inline">\(b,c \in \Sigma^P(m)\)</span> for some
<span class="math inline">\(m \in \mathbb{N}\)</span>, in which case
<span class="math inline">\(\prod_p I_p(b,c) \ll
\tau(m)^{\operatorname{O}(1)} m^{-n&#39;}\)</span>. Thus <span
class="math display">\[\mathcal{Q}_P(\phi,f)
  \ll
  \sum _{m \in \mathbb{N} }
  \frac{\tau(m)^{\operatorname{O}(1)}}{m^{n&#39;}}
  \sum_{b,c \in \Sigma^P(m)} |I_\infty(b,c)|.\]</span> By the triangle
inequality, the Cauchy–Schwarz inequality and the assumed nonnegativity
of <span class="math inline">\(\phi_\infty\)</span>, we have <span
class="math display">\[\begin{align}
  \sum _{b,c \in \Sigma^P(m)}
  |I_\infty(b,c)|
  &amp;\leqslant
  \sum _{b, c \in \Sigma^P(m)}
    \int _{g \in N(\mathbb{R}) \backslash G(\mathbb{R})}
    \phi_\infty(e_n g)
  |W_\infty(b,g) \overline{W_\infty}(c,g)|
    \, d g
    \\
  &amp;\leqslant
    |\Sigma^P(m)|
    \sum _{ c \in \Sigma^P(m)}
    \int _{g \in N(\mathbb{R}) \backslash G(\mathbb{R})}
    \phi_\infty(e_n g)
    |W_\infty(c,g)|^2
    \, d g
\end{align}\]</span> Since <span class="math inline">\(\# \Sigma^P(m)
\ll \tau(m)^{\operatorname{O}(1)}\)</span>, the desired estimate
follows. ◻</p>
</div>
<h4
id="proof-of-proposition-propbound-after-theta-degenerate-case-2">Proof
of Proposition <a href="#prop:bound-after-theta-degenerate-case-2"
data-reference-type="ref"
data-reference="prop:bound-after-theta-degenerate-case-2">297</a></h4>
<p>Assume now once again that <span class="math inline">\(f \in
\mathfrak{E}(N(\mathbb{R}) \backslash G(\mathbb{R}), T)\)</span>. We
must show that <span class="math display">\[\mathcal{Q}_P(\phi,L(Y) f)
  \ll
  r^{n} T^{o(1)} \det(Y).\]</span> The bound <a href="#eq:qpphi-ly-f"
data-reference-type="eqref"
data-reference="eq:qpphi-ly-f">\((21.24)\)</a> for <span
class="math inline">\(Q_P(\phi_\infty, L(Y) f, c)\)</span> afforded by
Proposition <a href="#prop:sub-gln:let-f-in" data-reference-type="ref"
data-reference="prop:sub-gln:let-f-in">330</a> gives, for some fixed
<span class="math inline">\(C_0 \geqslant 0\)</span>, <span id="eq:qpphi-ly-f-1" class="math display">\[\label{eq:qpphi-ly-f-1}\tag{22.2}
  Q_P(\phi, L(Y) f, c)
  \ll
  \min
  \left(
    \frac{r^n T^{o(1)} \det(Y) }{|\det c|},
    \frac{T^{C_0}}{|\det c|^{10}}
  \right)
  +
  \frac{T^{-\infty }}{|\det c|^{10}}.\]</span> We insert this bound into
Lemma <a href="#lem:scratch-research:we-have-begin"
data-reference-type="ref"
data-reference="lem:scratch-research:we-have-begin">337</a>. The
contribution to <a href="#eq:mathc-f_infty-ll"
data-reference-type="eqref"
data-reference="eq:mathc-f_infty-ll">\((22.1)\)</a> of the
second term appearing on the RHS of <a href="#eq:qpphi-ly-f-1"
data-reference-type="eqref"
data-reference="eq:qpphi-ly-f-1">\((22.2)\)</a> is <span
class="math display">\[\ll
  T^{-\infty}
  \sum _{m \in \mathbb{N} }
  \frac{\tau(m)^{\operatorname{O}(1)}}{m^{n&#39; + 10}}
  \ll T^{-\infty}.\]</span> It remains to estimate the contribution of
the first term. To that end, we let <span class="math inline">\(S
\geqslant 2\)</span> be an arbitrary parameter, and apply the first or
second alternative in the minimum of <a href="#eq:qpphi-ly-f-1"
data-reference-type="eqref"
data-reference="eq:qpphi-ly-f-1">\((22.2)\)</a> according as
<span class="math inline">\(m \leqslant S\)</span> or <span
class="math inline">\(m &gt; S\)</span>. We obtain <span
class="math display">\[\mathcal{Q}_P(\phi, L(Y) f)
  \ll
  \frac{r^n T^{o(1)}}{\det(Y)}
  \sum _{m \leqslant S}
  \frac{\tau(m)^{\operatorname{O}(1)}}{ m^{n&#39; + 1}}
  +
  T^{C_0}
  \sum _{m &gt; S}
  \frac{\tau(m)^{\operatorname{O}(1)}}{m^{10}}
  + T^{-\infty}.\]</span> We take <span class="math inline">\(S =
T^{C_1}\)</span>, where <span class="math inline">\(C_1\)</span> is
fixed but sufficiently large in terms of <span
class="math inline">\(C_0\)</span>. Then <span
class="math display">\[\sum _{m \leqslant S}
\frac{\tau(m)^{\operatorname{O}(1)}}{ m^{n&#39; + 1}} \ll \log T \ll
T^{o(1)},\]</span> while <span class="math display">\[\sum _{m &gt; S}
\frac{\tau(m)^{\operatorname{O}(1)}}{m^{10}} \ll S^{-8} = T^{-8
C_1}.\]</span> Since <span class="math inline">\(C_1\)</span> can be
taken arbitrarily large, it follows that <span
class="math display">\[\mathcal{Q}_P(\phi, L(Y) f)
  \ll
  r^n T^{o(1)} \det(Y) + T^{-\infty}.\]</span> This estimate is adequate
in view of our assumptions that <span class="math inline">\(r\)</span>
and <span class="math inline">\(\det(Y)\)</span> are of the form <span
class="math inline">\(T^{\operatorname{O}(1)}\)</span>.</p>
<h3 id="sec:elem-form">§A. Elementary formulations</h3>
<p>Here we apply the algorithm described in <a href="#ref-MR469763" class="citation"
data-cites="MR469763">(E. Nelson 1977, sec. 2)</a>, and illustrated
earlier in §<a href="#sec:main-result:-reform" data-reference-type="ref"
data-reference="sec:main-result:-reform">2.1.3</a> and in the proof of
Lemma <a href="#lem:four-transf-begin" data-reference-type="ref"
data-reference="lem:four-transf-begin">12</a>, to reformulate some of
the key supporting results of the paper in elementary language, free
from nonstandard formalism. (We also simplify the statements a bit
using, e.g., Lemma <a href="#lem:overspill-A-vs-T-eps"
data-reference-type="ref"
data-reference="lem:overspill-A-vs-T-eps">13</a>.) We do this for
“information purposes” only, with the hope of making more accessible the
structure of our argument. This discussion is not logically necessary
for our aims, so we do not prove that we have carried out the
reformulations accurately.</p>
<div id="thm:construction-vectors-original" class="theorem">
<p><strong>Theorem 338</strong> (Theorem <a
href="#thm:main-local-results" data-reference-type="ref"
data-reference="thm:main-local-results">3.1</a>,
reformulated). <em>Suppose given</em></p>
<ul>
<li><p><em>a general linear pair <span
class="math inline">\((G,H)\)</span> over <span
class="math inline">\(\mathbb{R}\)</span>, with accompanying notation
<span class="math inline">\(A\)</span>, <span
class="math inline">\(B\)</span>, <span
class="math inline">\(N\)</span>, <span
class="math inline">\(Q\)</span>, <span
class="math inline">\(U\)</span>, <span
class="math inline">\(Z\)</span>, <span
class="math inline">\(A_H\)</span>, <span
class="math inline">\(B_H\)</span>, <span
class="math inline">\(N_H\)</span>, <span
class="math inline">\(Q_H\)</span>, <span
class="math inline">\(U_H\)</span>, <span
class="math inline">\(Z_H\)</span>,</em></p></li>
<li><p><em>a nondegenerate unitary character <span
class="math inline">\(\psi\)</span> of <span
class="math inline">\(N\)</span>, equal to either the standard character
or its inverse,</em></p></li>
<li><p><em><span class="math inline">\(C_0 &gt; c_0 &gt;
0\)</span>,</em></p></li>
<li><p><em>a compact subset <span
class="math inline">\(\Omega_H\)</span> of <span
class="math inline">\(H\)</span>,</em></p></li>
<li><p><em>an open neighborhood <span class="math inline">\(E_G
\subseteq G\)</span> of the identity element, and</em></p></li>
<li><p><em><span class="math inline">\(\varepsilon&gt;
0\)</span>.</em></p></li>
</ul>
<p><em>There exists</em></p>
<ul>
<li><p><em>a compact neighborhood <span class="math inline">\(\Omega_H
&#39;\)</span> of <span class="math inline">\(H\)</span>,</em></p></li>
<li><p><em>nonnegative reals</em></p>
<ul>
<li><p><em><span class="math inline">\(C_{\mathcal{D},\ell}\)</span>,
indexed by compact subsets <span class="math inline">\(\mathcal{D}
\subseteq \mathfrak{a}^*\)</span> and <span class="math inline">\(\ell
\in \mathbb{Z}_{\geqslant 0}\)</span>,</em></p></li>
<li><p><em><span class="math inline">\(C_{u, \ell}\)</span>, indexed by
<span class="math inline">\(u \in \mathfrak{U}(G)\)</span> and <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant
0}\)</span>,</em></p></li>
</ul></li>
<li><p><em><span class="math inline">\(c_1 &gt;
0\)</span>,</em></p></li>
<li><p><em><span class="math inline">\(T_0 \geqslant 1\)</span>,
and</em></p></li>
<li><p><em>a finite subset <span class="math inline">\(\mathcal{F}_{Z_H}
\subseteq C_c^\infty(Z_H)\)</span></em></p></li>
</ul>
<p><em>such that</em></p>
<ul>
<li><p><em>for each <span class="math inline">\(T \geqslant
T_0\)</span>,</em></p></li>
<li><p><em>for each generic irreducible unitary representation <span
class="math inline">\(\pi\)</span> of <span
class="math inline">\(G\)</span>, each of whose archimedean <span
class="math inline">\(L\)</span>-function parameters has magnitude
between <span class="math inline">\(c_0 T\)</span> and <span
class="math inline">\(C_0 T\)</span>,</em></p></li>
</ul>
<p><em>there exists</em></p>
<ul>
<li><p><em><span class="math inline">\(f, f_{\ast} \in \mathcal{S}^e(U_H
\backslash H)^{W_H}\)</span>, <span class="math inline">\(\phi_{Z_H} \in
\mathcal{F}_{Z_H}\)</span>,</em></p></li>
<li><p><em>a smooth vector <span class="math inline">\(W \in
\mathcal{W}(\pi,\psi)\)</span> of norm <span
class="math inline">\(\leqslant 1\)</span> (with respect to the norm
defined in §<a href="#sec:local-prelim-kirillov-model"
data-reference-type="ref"
data-reference="sec:local-prelim-kirillov-model">2.14.1</a>),
and</em></p></li>
<li><p><em><span class="math inline">\(\omega_0 \in
C_c^\infty(E_G)\)</span></em></p></li>
</ul>
<p><em>with the following properties. Define <span
class="math display">\[\omega(g) := (\omega_0 \ast \omega_0^*)(g) :=
\int _{h \in G} \omega(g h^{-1}) \overline{\omega(h^{-1})} \, d
h,\]</span> <span class="math display">\[\omega^\sharp (g) := \int _{z
\in Z}
  \pi|_Z (z) \omega(z g) \, d z,\]</span> where <span
class="math inline">\(\pi|_Z\)</span> denotes the central character of
<span class="math inline">\(\pi\)</span>. Then:</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(f_{\ast}(g) = \int _{z \in Z_H}
f(g z^{-1}) \phi_{Z_H}(z) \, d z\)</span>.</em></p></li>
<li><p><em>Each of the following assertions remains valid upon replacing
<span class="math inline">\(f\)</span> with <span
class="math inline">\(f_{\ast}\)</span>.</em></p></li>
<li><p><em>For each compact subset <span
class="math inline">\(\mathcal{D}\)</span> of <span
class="math inline">\(\mathfrak{a}^*\)</span> and <span
class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>, we
have, with notation as in §<a href="#sec:local-sobolev-norms-prelims"
data-reference-type="ref"
data-reference="sec:local-sobolev-norms-prelims">2.9</a>, <span
class="math display">\[\nu_{\mathcal{D},\ell,T}(f) \leqslant
C_{\mathcal{D},\ell} T^\varepsilon.\]</span></em></p></li>
<li><p><em>The local zeta integral <span
class="math inline">\(Z(W,f[s])\)</span> is entire. We have the lower
bound <span class="math display">\[|Z(W,f[0])| \geqslant c_1 T^{-
\dim(H)/4}.\]</span> For each compact subset <span
class="math inline">\(\mathcal{D} \subseteq \mathfrak{a}^*\)</span>,
<span class="math inline">\(\ell \in \mathbb{Z}_{\geqslant 0}\)</span>,
and <span class="math inline">\(s \in
\mathfrak{a}_{\mathbb{C}}^*\)</span> with <span
class="math inline">\(\Re(s) \in \mathcal{D}\)</span>, we have the upper
bound <span class="math display">\[|Z(W,f[s])| \leqslant
C_{\mathcal{D},\ell} T ^{\mathop{\mathrm{rank}}(G)
\mathop{\mathrm{trace}}(s)/2 - \frac{\dim(H)}{4} + \varepsilon}
    (1 + |s|)^{-\ell}.\]</span></em></p></li>
<li><p><em>For each <span class="math inline">\(u \in
\mathfrak{U}(G)\)</span> and <span class="math inline">\(\ell \in
\mathbb{Z}_{\geqslant 0}\)</span>, we have <span
class="math display">\[\|\pi(u) ( \pi(\omega_0) W - W)\| \leqslant
C_{u,\ell} T^{-\ell}.\]</span></em></p></li>
<li><p><em>We have <span class="math inline">\(\int_{H} |\omega^\sharp|
\leqslant T^{\mathop{\mathrm{rank}}(H)/2 +
\varepsilon}\)</span>.</em></p></li>
<li><p><em>Let <span class="math inline">\(\Psi_1, \Psi_2 : H
\rightarrow \mathbb{C}\)</span> be continuous functions. For <span
class="math inline">\(j=1,2\)</span>, define the convolutions <span
class="math display">\[(\Psi_j \ast \phi_{Z_H})(x) := \int _{z \in Z_H}
\Psi_j(x z^{-1}) \phi_{Z_H}(z) \, d z.\]</span> Let <span
class="math inline">\(\gamma \in \bar{G} - H\)</span>. Then the integral
<span class="math display">\[I := \int _{x, y \in \Omega_H }
    \left\lvert
      (\Psi_1 \ast \phi_{Z_H})(x)
      (\Psi_2 \ast \phi_{Z_H})(y)
      \omega^\sharp(x^{-1} \gamma y)
    \right\rvert
    \, d x \, d y\]</span> satisfies the estimate <span
class="math display">\[|I| \leqslant
  T^{\mathop{\mathrm{rank}}(H)/2 + \varepsilon}
  \min\left( 1,
    \frac{T^{-1/2}}{ d_H(\gamma)}
  \right)
    \|\Psi_1\|_{L^2(\Omega_H&#39;)}
    \|\Psi_2\|_{L^2(\Omega_H&#39;)}.\]</span></em></p></li>
</ol>
</div>
<div class="theorem">
<p><strong>Theorem 339</strong> (Theorem <a
href="#thm:growth-eisenstein-nonstandard" data-reference-type="ref"
data-reference="thm:growth-eisenstein-nonstandard">45</a>,
reformulated). <em>Let <span class="math inline">\(n\)</span> be a
natural number, <span class="math inline">\(G :=
{\mathop{\mathrm{GL}}}_n\)</span> over <span
class="math inline">\(\mathbb{Z}\)</span>. Let <span
class="math inline">\(\Omega \subseteq G(\mathbb{R})\)</span> be a
compact set. Let <span class="math inline">\(\kappa \in (0, 1/2),
\varepsilon&gt; 0\)</span>. There exists <span class="math inline">\(C
\geqslant 0\)</span>, <span class="math inline">\(\mathcal{D} \subseteq
\mathfrak{a}^*\)</span> compact, and <span class="math inline">\(\ell
\in \mathbb{Z}_{\geqslant 0}\)</span> with the following property. Let
<span class="math inline">\(T \geqslant 1\)</span>. Let <span
class="math inline">\(Y \in A(\mathbb{R})^0\)</span> with <span
class="math inline">\(T^{-\kappa} \leqslant|Y_j| \leqslant
T^{\kappa}\)</span> for all <span class="math inline">\(j\)</span>. Let
<span class="math inline">\(f \in \mathcal{S}^e(U(\mathbb{R}) \backslash
G(\mathbb{R}))^W\)</span>. Let <span class="math inline">\(t \in
A(\mathbb{R})^0_{\geqslant 1}\)</span>. Then <span
class="math display">\[\frac{\|\mathop{\mathrm{Eis}}[ \Phi[L(Y) f] ]
\|_{t,\Omega}^2}{\delta_N(t)}
    \leqslant C T^\varepsilon\min \left( \det(Y)^{-1} t_1^{-n}, \det(Y)
t_n^n \right) \nu_{\mathcal{D},\ell,T}(f).\]</span></em></p>
</div>
<div class="theorem">
<p><strong>Theorem 340</strong> (Theorem <a
href="#thm:big-group-whittaker-behavior-under-G"
data-reference-type="ref"
data-reference="thm:big-group-whittaker-behavior-under-G">151</a>,
reformulated). <em>Let <span class="math inline">\(n\)</span> be a
natural number. Set <span class="math inline">\(G :=
{\mathop{\mathrm{GL}}}_n(\mathbb{R})\)</span>. For each <span
class="math inline">\(\varepsilon&gt; 0\)</span>, there exists <span
class="math inline">\(\delta _0 &lt; 1/2\)</span> with the following
property. Let <span class="math inline">\(\delta \in (\delta_0,
1/2)\)</span>, <span class="math inline">\(\delta_+ \in (\delta,
1/2)\)</span> and <span class="math inline">\(\eta &gt; 0\)</span>. Let
<span class="math inline">\(\mathcal{X}\)</span> be a finite subset of
<span class="math inline">\(\mathfrak{U}(G)\)</span>. Let <span
class="math inline">\(m \geqslant 0\)</span>. Let <span
class="math inline">\(\Lambda\)</span> be a compact subset of <span
class="math inline">\([\mathfrak{g}^\wedge]\)</span>. There is a finite
subset <span class="math inline">\(\mathcal{Y}\)</span> of <span
class="math inline">\(\mathbb{Z}_{\geqslant 0}^{\dim(Q_H)}\)</span>,
<span class="math inline">\(k \geqslant 0\)</span> and <span
class="math inline">\(T_0 \geqslant 1\)</span> with the following
property. Let <span class="math inline">\(T \geqslant T_0\)</span>. Let
<span class="math inline">\(\pi\)</span> be a generic irreducible
unitary representation of <span class="math inline">\(G\)</span> whose
rescaled infinitesimal character satisfies <span
class="math inline">\(T^{-1} \lambda_\pi \in \Lambda\)</span>. There
exists <span class="math inline">\(\omega_0 \in C_c^\infty(G)\)</span>
with the following properties. Set <span class="math inline">\(\bar{G} =
G/Z\)</span>. Define <span class="math inline">\(\omega := \omega_0 \ast
\omega_0^\ast \in C_c^\infty(G)\)</span> and <span
class="math inline">\(\omega^\sharp \in C_c^\infty(\bar{G})\)</span> by
<span class="math display">\[\omega(g) := \int _{h \in G} \omega(g
h^{-1}) \overline{\omega(h^{-1})} \, d h,\]</span> <span
class="math display">\[\omega^\sharp (g) := \int _{z \in Z}
    \pi|_Z (z) \omega(z g) \, d z,\]</span> where <span
class="math inline">\(\pi|_Z\)</span> denotes the central character of
<span class="math inline">\(\pi\)</span>. Then:</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(\omega(g) \neq 0\)</span> only if
<span class="math inline">\(|g -1| \leqslant\eta\)</span> and <span
class="math inline">\(|{\mathop{\mathrm{Ad}}}^*(g) \tau - \tau|
\leqslant\eta T^{-1/2}\)</span>, where <span class="math inline">\(\tau
= \tau(\pi,\psi,T)\)</span> is given by <a
href="#eq:tau-characterize-via-pi" data-reference-type="eqref"
data-reference="eq:tau-characterize-via-pi">\((7.10)\)</a>.</em></p></li>
<li><p><em><span class="math inline">\(\|\omega^\sharp\|_{\infty}
\leqslant T^{n(n+1)/2+\varepsilon}\)</span>.</em></p></li>
<li><p><em><span class="math inline">\(\int_H |\omega^\sharp| \leqslant
T^{n/2 + \varepsilon}\)</span>.</em></p></li>
<li><p><em>Let <span class="math inline">\(W\)</span> be an element of
the <span class="math inline">\(\psi_T\)</span>-Whittaker model <span
class="math inline">\(\mathcal{W}(\pi,\psi_T)\)</span>. Suppose that
<span class="math inline">\(W|_{Q_H}\)</span> is supported near the
identity element, so that it may be described via pullback to the Lie
algebra. Let <span class="math inline">\(\phi :
\mathop{\mathrm{Lie}}(Q_H) \rightarrow \mathbb{C}\)</span> be given by
<span class="math inline">\(\phi(x) := W(\exp(x))\)</span>. Assume that
<span class="math inline">\(\phi\)</span> is supported on <span
class="math inline">\(\{x : |x| \leqslant T^{\delta_+ - 1}\}\)</span>,
where <span class="math inline">\(|.|\)</span> denotes (say) the
Euclidean norm on <span
class="math inline">\(\mathop{\mathrm{Lie}}(Q_H)\)</span> defined with
respect to the matrix entries. Assume that for each <span
class="math inline">\(\alpha \in \mathcal{Y}\)</span> and all <span
class="math inline">\(x \in \mathop{\mathrm{Lie}}(Q_H)\)</span>, we have
<span class="math display">\[\left\lvert \partial^\alpha \phi(x)
\right\rvert \leqslant T^{(1 - \delta) (\dim(Q_H) + |\alpha|)} \left( 1
+ \frac{|x|}{T^{\delta-1}} \right)^{-k}.\]</span> Then for all <span
class="math inline">\(t\in \mathcal{X}\)</span>, we have <span
class="math display">\[\|\pi(t) (\pi(\omega_0)W - W)\| \leqslant
T^{-m},\]</span> where <span class="math inline">\(\|.\|\)</span>
denotes the norm on <span
class="math inline">\(\mathcal{W}(\pi,\psi_T)\)</span> defined by
integration over <span class="math inline">\(N_H \backslash
H\)</span>.</em></p></li>
</ol>
</div>
<div id="refs" class="references csl-bib-body hanging-indent"
role="list">
<div id="ref-MR4032289" class="csl-entry" role="listitem">
Aggarwal, Keshav. 2020. <span>“Weyl Bound for <span><span
class="math inline">\(\rm GL(2)\)</span></span> in <span><span
class="math inline">\(t\)</span></span>-Aspect via a Simple Delta
Method.”</span> <em>J. Number Theory</em> 208: 72–100. <a
href="https://doi.org/10.1016/j.jnt.2019.07.018">https://doi.org/10.1016/j.jnt.2019.07.018</a>.
</div>
<div id="ref-MR4270876" class="csl-entry" role="listitem">
———. 2021. <span>“A New Subconvex Bound for <span><span
class="math inline">\(\rm GL(3)\)</span></span> <span><span
class="math inline">\(L\)</span></span>-Functions in the <span><span
class="math inline">\(t\)</span></span>-Aspect.”</span> <em>Int. J.
Number Theory</em> 17 (5): 1111–38. <a
href="https://doi.org/10.1142/S1793042121500275">https://doi.org/10.1142/S1793042121500275</a>.
</div>
<div id="ref-2022arXiv220606517A" class="csl-entry" role="listitem">
Aggarwal, Keshav, Wing Hong Leung, and Ritabrata Munshi. 2022.
<span>“<span class="nocase">Short second moment bound and Subconvexity
for GL(3) <span
class="math inline">\(L\)</span>-functions</span>.”</span> <em>arXiv
e-Prints</em>, June, arXiv:2206.06517. <a
href="https://arxiv.org/abs/2206.06517">https://arxiv.org/abs/2206.06517</a>.
</div>
<div id="ref-MR546601" class="csl-entry" role="listitem">
Arthur, James. 1979. <span>“Eisenstein Series and the Trace
Formula.”</span> In <em>Automorphic Forms, Representations and
<span><span class="math inline">\(L\)</span></span>-Functions
(<span>P</span>roc. <span>S</span>ympos. <span>P</span>ure
<span>M</span>ath., <span>O</span>regon <span>S</span>tate
<span>U</span>niv., <span>C</span>orvallis, <span>O</span>re., 1977),
<span>P</span>art 1</em>, 253–74. Proc. Sympos. Pure Math., XXXIII.
Amer. Math. Soc., Providence, R.I.
</div>
<div id="ref-MR999488" class="csl-entry" role="listitem">
———. 1989. <span>“Intertwining Operators and Residues. <span>I</span>.
<span>W</span>eighted Characters.”</span> <em>J. Funct. Anal.</em> 84
(1): 19–84. <a
href="https://doi.org/10.1016/0022-1236(89)90110-9">https://doi.org/10.1016/0022-1236(89)90110-9</a>.
</div>
<div id="ref-MR1277950" class="csl-entry" role="listitem">
Barthel, Laure, and Dinakar Ramakrishnan. 1994. <span>“A Nonvanishing
Result for Twists of <span><span
class="math inline">\(L\)</span></span>-Functions of <span><span
class="math inline">\({\rm
              GL}(n)\)</span></span>.”</span> <em>Duke Math. J.</em> 74
(3): 681–700. <a
href="https://doi.org/10.1215/S0012-7094-94-07425-5">https://doi.org/10.1215/S0012-7094-94-07425-5</a>.
</div>
<div id="ref-MR1999922" class="csl-entry" role="listitem">
Baruch, Ehud Moshe. 2003a. <span>“A Proof of <span>K</span>irillov’s
Conjecture.”</span> <em>Ann. Of Math. (2)</em> 158 (1): 207–52. <a
href="https://doi.org/10.4007/annals.2003.158.207">https://doi.org/10.4007/annals.2003.158.207</a>.
</div>
<div id="ref-MR2016587" class="csl-entry" role="listitem">
———. 2003b. <span>“Bessel Functions for <span>GL</span>(3) over a
<span><span class="math inline">\(p\)</span></span>-Adic Field.”</span>
<em>Pacific J. Math.</em> 211 (1): 1–33. <a
href="https://doi.org/10.2140/pjm.2003.211.1">https://doi.org/10.2140/pjm.2003.211.1</a>.
</div>
<div id="ref-MR2192818" class="csl-entry" role="listitem">
———. 2005. <span>“Bessel Functions for <span><span
class="math inline">\({\rm GL}(n)\)</span></span> over a <span><span
class="math inline">\(p\)</span></span>-Adic Field.”</span> In
<em>Automorphic Representations, <span><span
class="math inline">\(L\)</span></span>-Functions and Applications:
Progress and Prospects</em>, 11:1–40. Ohio State Univ. Math. Res. Inst.
Publ. de Gruyter, Berlin. <a
href="https://doi.org/10.1515/9783110892703.1">https://doi.org/10.1515/9783110892703.1</a>.
</div>
<div id="ref-MR0579172" class="csl-entry" role="listitem">
Bernstein, I. N., and A. V. Zelevinsky. 1977. <span>“Induced
Representations of Reductive <span><span
class="math inline">\({\mathfrak{p}}\)</span></span>-Adic Groups.
<span>I</span>.”</span> <em>Ann. Sci. École Norm. Sup. (4)</em> 10 (4):
441–72. <a
href="http://www.numdam.org/item?id=ASENS_1977_4_10_4_441_0">http://www.numdam.org/item?id=ASENS_1977_4_10_4_441_0</a>.
</div>
<div id="ref-MR748505" class="csl-entry" role="listitem">
Bernstein, Joseph N. 1984. <span>“<span><span
class="math inline">\(P\)</span></span>-Invariant Distributions on
<span><span class="math inline">\({\rm GL}(N)\)</span></span> and the
Classification of Unitary Representations of <span><span
class="math inline">\({\rm GL}(N)\)</span></span>
(Non-<span>A</span>rchimedean Case).”</span> In <em>Lie Group
Representations, <span>II</span> (<span>C</span>ollege
<span>P</span>ark, <span>M</span>d., 1982/1983)</em>, 1041:50–102.
Lecture Notes in Math. Springer, Berlin. <a
href="https://doi.org/10.1007/BFb0073145">https://doi.org/10.1007/BFb0073145</a>.
</div>
<div id="ref-MR3219530" class="csl-entry" role="listitem">
Bernstein, Joseph, and Bernhard Krötz. 2014. <span>“Smooth
<span>F</span>réchet Globalizations of
<span>H</span>arish-<span>C</span>handra Modules.”</span> <em>Israel J.
Math.</em> 199 (1): 45–111. <a
href="https://doi.org/10.1007/s11856-013-0056-1">https://doi.org/10.1007/s11856-013-0056-1</a>.
</div>
<div id="ref-2019arXiv191102342B" class="csl-entry" role="listitem">
Bernstein, Joseph, and Erez Lapid. 2019. <span>“<span class="nocase">On
the meromorphic continuation of Eisenstein series</span>.”</span>
<em>arXiv e-Prints</em>, November, arXiv:1911.02342. <a
href="https://arxiv.org/abs/1911.02342">https://arxiv.org/abs/1911.02342</a>.
</div>
<div id="ref-MR2726097" class="csl-entry" role="listitem">
Bernstein, Joseph, and Andre Reznikov. 2010. <span>“Subconvexity Bounds
for Triple <span><span class="math inline">\(L\)</span></span>-Functions
and Representation Theory.”</span> <em>Ann. Of Math. (2)</em> 172 (3):
1679–1718. <a
href="https://doi.org/10.4007/annals.2010.172.1679">https://doi.org/10.4007/annals.2010.172.1679</a>.
</div>
<div id="ref-MR0425030" class="csl-entry" role="listitem">
Bernšteı̆n, I. N., and A. V. Zelevinskiı̆. 1976. <span>“Representations of
the Group <span><span class="math inline">\(GL(n,F),\)</span></span>
Where <span><span class="math inline">\(F\)</span></span> Is a Local
Non-<span>A</span>rchimedean Field.”</span> <em>Uspehi Mat. Nauk</em> 31
(3(189)): 5–70.
</div>
<div id="ref-2016arXiv160206538B" class="csl-entry" role="listitem">
Beuzart-Plessis, R. 2016. <span>“<span class="nocase">Comparison of
local spherical characters and the Ichino-Ikeda conjecture for unitary
groups</span>.”</span> <em>ArXiv e-Prints</em>, February. <a
href="https://arxiv.org/abs/1602.06538">https://arxiv.org/abs/1602.06538</a>.
</div>
<div id="ref-2018arXiv181200053B" class="csl-entry" role="listitem">
Beuzart-Plessis, Raphaël. 2018. <span>“<span class="nocase">Archimedean
theory and <span class="math inline">\(\epsilon\)</span>-factors for the
Asai Rankin-Selberg integrals</span>.”</span> <em>arXiv e-Prints</em>,
November, arXiv:1812.00053. <a
href="https://arxiv.org/abs/1812.00053">https://arxiv.org/abs/1812.00053</a>.
</div>
<div id="ref-2020arXiv200705601B" class="csl-entry" role="listitem">
Beuzart-Plessis, Raphaël, Pierre-Henri Chaudouard, and Michał Zydor.
2020. <span>“<span class="nocase">The global Gan-Gross-Prasad conjecture
for unitary groups: the endoscopic case</span>.”</span> <em>arXiv
e-Prints</em>, July, arXiv:2007.05601. <a
href="https://arxiv.org/abs/2007.05601">https://arxiv.org/abs/2007.05601</a>.
</div>
<div id="ref-MR4203038" class="csl-entry" role="listitem">
Blomer, Valentin, and Jack Buttcane. 2020a. <span>“On the Subconvexity
Problem for <span><span
class="math inline">\(L\)</span></span>-Functions on <span><span
class="math inline">\(\rm
              GL(3)\)</span></span>.”</span> <em>Ann. Sci. Éc. Norm.
Supér. (4)</em> 53 (6): 1441–1500. <a
href="https://doi.org/10.24033/asens.245">https://doi.org/10.24033/asens.245</a>.
</div>
<div id="ref-MR4039487" class="csl-entry" role="listitem">
———. 2020b. <span>“Subconvexity for <span><span
class="math inline">\(L\)</span></span>-Functions of Non-Spherical Cusp
Forms on <span><span class="math inline">\({\rm
GL}(3)\)</span></span>.”</span> <em>Acta Arith.</em> 192 (1): 31–62. <a
href="https://doi.org/10.4064/aa180125-5-2">https://doi.org/10.4064/aa180125-5-2</a>.
</div>
<div id="ref-MR3694659" class="csl-entry" role="listitem">
Blomer, Valentin, Jack Buttcane, and Péter Maga. 2017.
<span>“Applications of the <span>K</span>uznetsov Formula on
<span>GL</span>(3) <span>II</span>: The Level Aspect.”</span> <em>Math.
Ann.</em> 369 (1-2): 723–59. <a
href="https://doi.org/10.1007/s00208-017-1558-7">https://doi.org/10.1007/s00208-017-1558-7</a>.
</div>
<div id="ref-MR2431250" class="csl-entry" role="listitem">
Blomer, Valentin, and Gergely Harcos. 2008. <span>“Hybrid Bounds for
Twisted <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> <em>J. Reine
Angew. Math.</em> 621: 53–79. <a
href="https://doi.org/10.1515/CRELLE.2008.058">https://doi.org/10.1515/CRELLE.2008.058</a>.
</div>
<div id="ref-MR3259045" class="csl-entry" role="listitem">
———. 2014. <span>“Addendum: <span>H</span>ybrid Bounds for Twisted
<span><span class="math inline">\(L\)</span></span>-Functions
[MR2431250].”</span> <em>J. Reine Angew. Math.</em> 694: 241–44. <a
href="https://doi.org/10.1515/crelle-2012-0091">https://doi.org/10.1515/crelle-2012-0091</a>.
</div>
<div id="ref-MR3905609" class="csl-entry" role="listitem">
Blomer, Valentin, Gergely Harcos, and Péter Maga. 2019. <span>“On the
Global Sup-Norm of <span><span class="math inline">\(\rm
GL(3)\)</span></span> Cusp Forms.”</span> <em>Israel J. Math.</em> 229
(1): 357–79. <a
href="https://doi.org/10.1007/s11856-018-1805-y">https://doi.org/10.1007/s11856-018-1805-y</a>.
</div>
<div id="ref-MR4093914" class="csl-entry" role="listitem">
———. 2020. <span>“Analytic Properties of Spherical Cusp Forms on
<span><span class="math inline">\({\rm
              GL}(n)\)</span></span>.”</span> <em>J. Anal. Math.</em>
140 (2): 483–510. <a
href="https://doi.org/10.1007/s11854-020-0094-7">https://doi.org/10.1007/s11854-020-0094-7</a>.
</div>
<div id="ref-MR2382859" class="csl-entry" role="listitem">
Blomer, Valentin, Gergely Harcos, and Philippe Michel. 2007.
<span>“Bounds for Modular <span><span
class="math inline">\(L\)</span></span>-Functions in the Level
Aspect.”</span> <em>Ann. Sci. École Norm. Sup. (4)</em> 40 (5): 697–740.
<a
href="https://doi.org/10.1016/j.ansens.2007.05.003">https://doi.org/10.1016/j.ansens.2007.05.003</a>.
</div>
<div id="ref-2021arXiv210112106B" class="csl-entry" role="listitem">
Blomer, Valentin, Subhajit Jana, and Paul D. Nelson. 2023. <span>“The
<span>W</span>eyl Bound for Triple Product
<span>L</span>-Functions.”</span> <em>Duke Math. J.</em> 172 (6):
1173–1234. <a
href="https://doi.org/10.1215/00127094-2022-0058">https://doi.org/10.1215/00127094-2022-0058</a>.
</div>
<div id="ref-MR3912807" class="csl-entry" role="listitem">
Blomer, Valentin, and Rizwanur Khan. 2019. <span>“Uniform Subconvexity
and Symmetry Breaking Reciprocity.”</span> <em>J. Funct. Anal.</em> 276
(7): 2315–58. <a
href="https://doi.org/10.1016/j.jfa.2018.11.009">https://doi.org/10.1016/j.jfa.2018.11.009</a>.
</div>
<div id="ref-2014arXiv1405.6691B" class="csl-entry" role="listitem">
Blomer, Valentin, and Péter Maga. 2016. <span>“Subconvexity for
Sup-Norms of Cusp Forms on <span><span class="math inline">\(\rm
{PGL}(n)\)</span></span>.”</span> <em>Selecta Math. (N.S.)</em> 22 (3):
1269–87. <a
href="https://doi.org/10.1007/s00029-015-0219-5">https://doi.org/10.1007/s00029-015-0219-5</a>.
</div>
<div id="ref-MR881101" class="csl-entry" role="listitem">
Bombieri, E., and H. Iwaniec. 1986. <span>“On the Order of <span><span
class="math inline">\(\zeta({1\over 2}+it)\)</span></span>.”</span>
<em>Ann. Scuola Norm. Sup. Pisa Cl. Sci. (4)</em> 13 (3): 449–72. <a
href="http://www.numdam.org/item?id=ASNSP_1986_4_13_3_449_0">http://www.numdam.org/item?id=ASNSP_1986_4_13_3_449_0</a>.
</div>
<div id="ref-MR3872849" class="csl-entry" role="listitem">
Booker, Andrew R., Micah B. Milinovich, and Nathan Ng. 2019.
<span>“Subconvexity for Modular Form <span><span
class="math inline">\(L\)</span></span>-Functions in the <span><span
class="math inline">\(t\)</span></span> Aspect.”</span> <em>Adv.
Math.</em> 341: 299–335. <a
href="https://doi.org/10.1016/j.aim.2018.10.037">https://doi.org/10.1016/j.aim.2018.10.037</a>.
</div>
<div id="ref-MR202718" class="csl-entry" role="listitem">
Borel, Armand. 1963. <span>“Some Finiteness Properties of Adele Groups
over Number Fields.”</span> <em>Inst. Hautes Études Sci. Publ.
Math.</em>, no. 16: 5–30. <a
href="http://www.numdam.org/item?id=PMIHES_1963__16__5_0">http://www.numdam.org/item?id=PMIHES_1963__16__5_0</a>.
</div>
<div id="ref-MR1102012" class="csl-entry" role="listitem">
———. 1991. <em>Linear Algebraic Groups</em>. Second. Vol. 126. Graduate
Texts in Mathematics. Springer-Verlag, New York. <a
href="https://doi.org/10.1007/978-1-4612-0941-6">https://doi.org/10.1007/978-1-4612-0941-6</a>.
</div>
<div id="ref-MR2331343" class="csl-entry" role="listitem">
———. 2007. <span>“Automorphic Forms on Reductive Groups.”</span> In
<em>Automorphic Forms and Applications</em>, 12:7–39. IAS/Park City
Math. Ser. Amer. Math. Soc., Providence, RI. <a
href="https://doi.org/10.1090/pcms/012/02">https://doi.org/10.1090/pcms/012/02</a>.
</div>
<div id="ref-MR147566" class="csl-entry" role="listitem">
Borel, Armand, and Harish-Chandra. 1962. <span>“Arithmetic Subgroups of
Algebraic Groups.”</span> <em>Ann. Of Math. (2)</em> 75: 485–535. <a
href="https://doi.org/10.2307/1970210">https://doi.org/10.2307/1970210</a>.
</div>
<div id="ref-MR3556291" class="csl-entry" role="listitem">
Bourgain, J. 2017. <span>“Decoupling, Exponential Sums and the
<span>R</span>iemann Zeta Function.”</span> <em>J. Amer. Math. Soc.</em>
30 (1): 205–24. <a
href="https://doi.org/10.1090/jams/860">https://doi.org/10.1090/jams/860</a>.
</div>
<div id="ref-MR1694894" class="csl-entry" role="listitem">
Braverman, Alexander, and David Kazhdan. 1999. <span>“On the
<span>S</span>chwartz Space of the Basic Affine Space.”</span>
<em>Selecta Math. (N.S.)</em> 5 (1): 1–28. <a
href="https://doi.org/10.1007/s000290050041">https://doi.org/10.1007/s000290050041</a>.
</div>
<div id="ref-MR1988971" class="csl-entry" role="listitem">
———. 2002. <span>“Normalized Intertwining Operators and Nilpotent
Elements in the <span>L</span>anglands Dual Group.”</span> In <em>Mosc.
Math. J.</em>, 2:533–53. 3. <a
href="https://doi.org/10.17323/1609-4514-2002-2-3-533-553">https://doi.org/10.17323/1609-4514-2002-2-3-533-553</a>.
</div>
<div id="ref-MR1410059" class="csl-entry" role="listitem">
Bröcker, Theodor, and Tammo tom Dieck. 1995. <em>Representations of
Compact <span>L</span>ie Groups</em>. Vol. 98. Graduate Texts in
Mathematics. Springer-Verlag, New York.
</div>
<div id="ref-MR4150475" class="csl-entry" role="listitem">
Brumley, Farrell, and Nicolas Templier. 2020. <span>“Large Values of
Cusp Forms on <span><span class="math inline">\({\rm
GL}_n\)</span></span>.”</span> <em>Selecta Math. (N.S.)</em> 26 (4):
Paper No. 63, 71. <a
href="https://doi.org/10.1007/s00029-020-00589-z">https://doi.org/10.1007/s00029-020-00589-z</a>.
</div>
<div id="ref-Bur57" class="csl-entry" role="listitem">
Burgess, D. A. 1957. <span>“The Distribution of Quadratic Residues and
Non-Residues.”</span> <em>Mathematika</em> 4: 106–12.
</div>
<div id="ref-MR1433344" class="csl-entry" role="listitem">
Bykovskiı̆, V. A. 1996. <span>“A Trace Formula for the Scalar Product of
<span>H</span>ecke Series and Its Applications.”</span> <em>Zap. Nauchn.
Sem. S.-Peterburg. Otdel. Mat. Inst. Steklov. (POMI)</em> 226 (Anal.
Teor. Chisel i Teor. Funktsiı̆. 13): 14–36, 235–36. <a
href="https://doi.org/10.1007/BF02358528">https://doi.org/10.1007/BF02358528</a>.
</div>
<div id="ref-MR1001613" class="csl-entry" role="listitem">
Casselman, W. 1989. <span>“Introduction to the <span>S</span>chwartz
Space of <span><span class="math inline">\(\Gamma\backslash
              G\)</span></span>.”</span> <em>Canad. J. Math.</em> 41
(2): 285–320. <a
href="https://doi.org/10.4153/CJM-1989-015-6">https://doi.org/10.4153/CJM-1989-015-6</a>.
</div>
<div id="ref-MR581582" class="csl-entry" role="listitem">
Casselman, W., and J. Shalika. 1980. <span>“The Unramified Principal
Series of <span><span class="math inline">\(p\)</span></span>-Adic
Groups. <span>II</span>. <span>T</span>he <span>W</span>hittaker
Function.”</span> <em>Compositio Math.</em> 41 (2): 207–31. <a
href="http://www.numdam.org/item?id=CM_1980__41_2_207_0">http://www.numdam.org/item?id=CM_1980__41_2_207_0</a>.
</div>
<div id="ref-MR3683106" class="csl-entry" role="listitem">
Chai, Jingsong. 2017. <span>“A Weak Kernel Formula for
<span>B</span>essel Functions.”</span> <em>Trans. Amer. Math. Soc.</em>
369 (10): 7139–67. <a
href="https://doi.org/10.1090/tran/6884">https://doi.org/10.1090/tran/6884</a>.
</div>
<div id="ref-MR3947975" class="csl-entry" role="listitem">
Chaudouard, Pierre-Henri. 2019. <span>“On Relative Trace Formulae: The
Case of <span>J</span>acquet-<span>R</span>allis.”</span> <em>Acta Math.
Vietnam.</em> 44 (2): 391–430. <a
href="https://doi.org/10.1007/s40306-018-00312-3">https://doi.org/10.1007/s40306-018-00312-3</a>.
</div>
<div id="ref-MR2508768" class="csl-entry" role="listitem">
Cogdell, J. W. 2008. <span>“Notes on <span><span
class="math inline">\(L\)</span></span>-Functions for <span><span
class="math inline">\({\rm GL}_n\)</span></span>.”</span> In <em>School
on <span>A</span>utomorphic <span>F</span>orms on <span><span
class="math inline">\({\rm GL}(n)\)</span></span></em>, 21:75–158. ICTP
Lect. Notes. Abdus Salam Int. Cent. Theoret. Phys., Trieste.
</div>
<div id="ref-MR3753910" class="csl-entry" role="listitem">
Cogdell, J. W., and I. I. Piatetski-Shapiro. 2017. <span>“Derivatives
and <span>L</span>-Functions for <span><span
class="math inline">\(GL_n\)</span></span>.”</span> In
<em>Representation Theory, Number Theory, and Invariant Theory</em>,
323:115–73. Progr. Math. Birkhäuser/Springer, Cham.
</div>
<div id="ref-MR946351" class="csl-entry" role="listitem">
Cowling, M., U. Haagerup, and R. Howe. 1988. <span>“Almost <span><span
class="math inline">\(L^2\)</span></span> Matrix Coefficients.”</span>
<em>J. Reine Angew. Math.</em> 387: 97–110.
</div>
<div id="ref-MR1923476" class="csl-entry" role="listitem">
Duke, W., J. B. Friedlander, and H. Iwaniec. 2002. <span>“The
Subconvexity Problem for <span>A</span>rtin <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> <em>Invent.
Math.</em> 149 (3): 489–577. <a
href="https://doi.org/10.1007/s002220200223">https://doi.org/10.1007/s002220200223</a>.
</div>
<div id="ref-MR2930996" class="csl-entry" role="listitem">
Feigon, Brooke, Erez Lapid, and Omer Offen. 2012. <span>“On
Representations Distinguished by Unitary Groups.”</span> <em>Publ. Math.
Inst. Hautes Études Sci.</em> 115: 185–323.
</div>
<div id="ref-MR3334236" class="csl-entry" role="listitem">
Fouvry, Étienne, Emmanuel Kowalski, and Philippe Michel. 2015.
<span>“Algebraic Twists of Modular Forms and <span>H</span>ecke
Orbits.”</span> <em>Geom. Funct. Anal.</em> 25 (2): 580–657. <a
href="https://doi.org/10.1007/s00039-015-0310-2">https://doi.org/10.1007/s00039-015-0310-2</a>.
</div>
<div id="ref-MR1403937" class="csl-entry" role="listitem">
Friedlander, John B. 1995. <span>“Bounds for <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> In
<em>Proceedings of the <span>I</span>nternational <span>C</span>ongress
of <span>M</span>athematicians, <span>V</span>ol. 1, 2
(<span>Z</span>ürich, 1994)</em>, 363–73. Birkhäuser, Basel.
</div>
<div id="ref-MR1800349" class="csl-entry" role="listitem">
Gelbart, Stephen, and Freydoon Shahidi. 2001. <span>“Boundedness of
Automorphic <span><span
class="math inline">\(L\)</span></span>-Functions in Vertical
Strips.”</span> <em>J. Amer. Math. Soc.</em> 14 (1): 79–107. <a
href="https://doi.org/10.1090/S0894-0347-00-00351-9">https://doi.org/10.1090/S0894-0347-00-00351-9</a>.
</div>
<div id="ref-MR3468638" class="csl-entry" role="listitem">
Gelfand, I. M., M. I. Graev, and I. I. Pyatetskii-Shapiro. 2016.
<em>Generalized Functions. <span>V</span>ol. 6</em>. AMS Chelsea
Publishing, Providence, RI. <a
href="https://doi.org/10.1090/chel/382">https://doi.org/10.1090/chel/382</a>.
</div>
<div id="ref-GetzHahn" class="csl-entry" role="listitem">
Getz, Jayce R., and Heekyoung Hahn. 2021. <span>“An Introduction to
Automorphic Representations with a View Towards Trace Formulae.”</span>
<a
href="https://sites.duke.edu/heekyounghahn/files/2021/06/Introduction_to_automorphic_representations-1.pdf"
class="uri">https://sites.duke.edu/heekyounghahn/files/2021/06/Introduction_to_automorphic_representations-1.pdf</a>,
June 28, 2021. <a
href="&quot;https://sites.duke.edu/heekyounghahn/files/2021/06/Introduction_to_automorphic_representations-1.pdf&quot;">"https://sites.duke.edu/heekyounghahn/files/2021/06/Introduction_to_automorphic_representations-1.pdf"</a>.
</div>
<div id="ref-2021arXiv210310261G" class="csl-entry" role="listitem">
Getz, Jayce R., Chun-Hsien Hsu, and Spencer Leslie. 2021. <span>“<span
class="nocase">Harmonic analysis on certain spherical
varieties</span>.”</span> <em>arXiv e-Prints</em>, March,
arXiv:2103.10261. <a
href="https://arxiv.org/abs/2103.10261">https://arxiv.org/abs/2103.10261</a>.
</div>
<div id="ref-MR0342495" class="csl-entry" role="listitem">
Godement, Roger, and Hervé Jacquet. 1972. <em>Zeta Functions of Simple
Algebras</em>. Lecture Notes in Mathematics, Vol. 260. Berlin:
Springer-Verlag.
</div>
<div id="ref-MR3468028" class="csl-entry" role="listitem">
Goldfeld, Dorian. 2015. <em>Automorphic Forms and
<span>L</span>-Functions for the Group <span><span
class="math inline">\({\rm
              GL}(n,\rm R)\)</span></span></em>. Vol. 99. Cambridge
Studies in Advanced Mathematics. Cambridge University Press, Cambridge.
</div>
<div id="ref-MR696884" class="csl-entry" role="listitem">
Good, Anton. 1982. <span>“The Square Mean of <span>D</span>irichlet
Series Associated with Cusp Forms.”</span> <em>Mathematika</em> 29 (2):
278–295 (1983). <a
href="https://doi.org/10.1112/S0025579300012377">https://doi.org/10.1112/S0025579300012377</a>.
</div>
<div id="ref-gutt1983explicit" class="csl-entry" role="listitem">
Gutt, Simone. 1983. <span>“An Explicit*-Product on the Cotangent Bundle
of a Lie Group.”</span> <em>Letters in Mathematical Physics</em> 7 (3):
249–58.
</div>
<div id="ref-MR4131117" class="csl-entry" role="listitem">
Harris, Benjamin, and Yoshiki Oshima. 2020. <span>“Irreducible
Characters and Semisimple Coadjoint Orbits.”</span> <em>J. Lie
Theory</em> 30 (3): 715–65.
</div>
<div id="ref-MR485727" class="csl-entry" role="listitem">
Heath-Brown, D. R. 1978. <span>“Hybrid Bounds for <span>D</span>irichlet
<span><span class="math inline">\(L\)</span></span>-Functions.”</span>
<em>Invent. Math.</em> 47 (2): 149–70. <a
href="https://doi.org/10.1007/BF01578069">https://doi.org/10.1007/BF01578069</a>.
</div>
<div id="ref-MR2680499" class="csl-entry" role="listitem">
Holowinsky, Roman, and Kannan Soundararajan. 2010. <span>“Mass
Equidistribution for <span>H</span>ecke Eigenforms.”</span> <em>Ann. Of
Math. (2)</em> 172 (2): 1517–28.
</div>
<div id="ref-MR1116239" class="csl-entry" role="listitem">
Howe, R., and T. Umeda. 1991. <span>“The <span>C</span>apelli Identity,
the Double Commutant Theorem, and Multiplicity-Free Actions.”</span>
<em>Math. Ann.</em> 290 (3): 565–619. <a
href="https://doi.org/10.1007/BF01459261">https://doi.org/10.1007/BF01459261</a>.
</div>
<div id="ref-MR546178" class="csl-entry" role="listitem">
Hrbacek, Karel. 1979. <span>“Nonstandard Set Theory.”</span> <em>Amer.
Math. Monthly</em> 86 (8): 659–77. <a
href="https://doi.org/10.2307/2321294">https://doi.org/10.2307/2321294</a>.
</div>
<div id="ref-MR3334892" class="csl-entry" role="listitem">
Ichino, Atsushi, and Shunsuke Yamana. 2015. <span>“Periods of
Automorphic Forms: The Case of <span><span
class="math inline">\((\text{GL}_{n+1}\times\text{GL}_n,\text{GL}_n)\)</span></span>.”</span>
<em>Compos. Math.</em> 151 (4): 665–712. <a
href="https://doi.org/10.1112/S0010437X14007362">https://doi.org/10.1112/S0010437X14007362</a>.
</div>
<div id="ref-MR1067982" class="csl-entry" role="listitem">
Iwaniec, Henryk. 1990. <span>“Small Eigenvalues of
<span>L</span>aplacian for <span><span
class="math inline">\(\Gamma_0(N)\)</span></span>.”</span> <em>Acta
Arith.</em> 56 (1): 65–82.
</div>
<div id="ref-MR2061214" class="csl-entry" role="listitem">
Iwaniec, Henryk, and Emmanuel Kowalski. 2004. <em>Analytic Number
Theory</em>. Vol. 53. American Mathematical Society Colloquium
Publications. Providence, RI: American Mathematical Society.
</div>
<div id="ref-MR1826269" class="csl-entry" role="listitem">
Iwaniec, Henryk, and Peter Sarnak. 2000. <span>“Perspectives on the
Analytic Theory of <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> <em>Geom.
Funct. Anal.</em>, no. Special Volume, Part II: 705–41.
</div>
<div id="ref-MR546609" class="csl-entry" role="listitem">
Jacquet, Hervé. 1979. <span>“Principal <span><span
class="math inline">\(L\)</span></span>-Functions of the Linear
Group.”</span> In <em>Automorphic Forms, Representations and <span><span
class="math inline">\(L\)</span></span>-Functions (<span>P</span>roc.
<span>S</span>ympos. <span>P</span>ure <span>M</span>ath.,
<span>O</span>regon <span>S</span>tate <span>U</span>niv.,
<span>C</span>orvallis, <span>O</span>re., 1977), <span>P</span>art
2</em>, 63–86. Proc. Sympos. Pure Math., XXXIII. Amer. Math. Soc.,
Providence, R.I.
</div>
<div id="ref-MR2058615" class="csl-entry" role="listitem">
———. 2004. <span>“Integral Representation of <span>W</span>hittaker
Functions.”</span> In <em>Contributions to Automorphic Forms, Geometry,
and Number Theory</em>, 373–419. Johns Hopkins Univ. Press, Baltimore,
MD.
</div>
<div id="ref-MR2533003" class="csl-entry" role="listitem">
———. 2009. <span>“Archimedean <span>R</span>ankin-<span>S</span>elberg
Integrals.”</span> In <em>Automorphic Forms and <span><span
class="math inline">\(L\)</span></span>-Functions <span>II</span>.
<span>L</span>ocal Aspects</em>, 489:57–172. Contemp. Math. Amer. Math.
Soc., Providence, RI. <a
href="https://doi.org/10.1090/conm/489/09547">https://doi.org/10.1090/conm/489/09547</a>.
</div>
<div id="ref-MR2733072" class="csl-entry" role="listitem">
———. 2010. <span>“Distinction by the Quasi-Split Unitary Group.”</span>
<em>Israel J. Math.</em> 178: 269–324. <a
href="https://doi.org/10.1007/s11856-010-0066-1">https://doi.org/10.1007/s11856-010-0066-1</a>.
</div>
<div id="ref-MR3001803" class="csl-entry" role="listitem">
———. 2012. <span>“A Correction to <span><em><span>C</span>onducteur Des
Représentations Du Groupe Linéaire</em></span> [MR620708].”</span>
<em>Pacific J. Math.</em> 260 (2): 515–25. <a
href="https://doi.org/10.2140/pjm.2012.260.515">https://doi.org/10.2140/pjm.2012.260.515</a>.
</div>
<div id="ref-MR519356" class="csl-entry" role="listitem">
Jacquet, Hervé, Ilja Iosifovitch Piatetski-Shapiro, and Joseph Shalika.
1979a. <span>“Automorphic Forms on <span><span
class="math inline">\({\rm GL}(3)\)</span></span>.
<span>I</span>.”</span> <em>Ann. Of Math. (2)</em> 109 (1): 169–212. <a
href="https://doi.org/10.2307/1971270">https://doi.org/10.2307/1971270</a>.
</div>
<div id="ref-MR528964" class="csl-entry" role="listitem">
———. 1979b. <span>“Automorphic Forms on <span><span
class="math inline">\({\rm GL}(3)\)</span></span>.
<span>II</span>.”</span> <em>Ann. Of Math. (2)</em> 109 (2): 213–58. <a
href="https://doi.org/10.2307/1971112">https://doi.org/10.2307/1971112</a>.
</div>
<div id="ref-MR2767518" class="csl-entry" role="listitem">
Jacquet, Hervé, and Stephen Rallis. 2011. <span>“On the
<span>G</span>ross-<span>P</span>rasad Conjecture for Unitary
Groups.”</span> In <em>On Certain <span><span
class="math inline">\(L\)</span></span>-Functions</em>, 13:205–64. Clay
Math. Proc. Amer. Math. Soc., Providence, RI.
</div>
<div id="ref-MR716292" class="csl-entry" role="listitem">
Jacquet, Hervé, and Joseph Shalika. 1983. <span>“The
<span>W</span>hittaker Models of Induced Representations.”</span>
<em>Pacific J. Math.</em> 109 (1): 107–20. <a
href="http://projecteuclid.org/euclid.pjm/1102720206">http://projecteuclid.org/euclid.pjm/1102720206</a>.
</div>
<div id="ref-MR701565" class="csl-entry" role="listitem">
Jacquet, H., I. I. Piatetskii-Shapiro, and J. A. Shalika. 1983.
<span>“Rankin-<span>S</span>elberg Convolutions.”</span> <em>Amer. J.
Math.</em> 105 (2): 367–464. <a
href="https://doi.org/10.2307/2374264">https://doi.org/10.2307/2374264</a>.
</div>
<div id="ref-MR620708" class="csl-entry" role="listitem">
Jacquet, H., I. I. Piatetski-Shapiro, and J. Shalika. 1981.
<span>“Conducteur Des Représentations Du Groupe Linéaire.”</span>
<em>Math. Ann.</em> 256 (2): 199–214. <a
href="https://doi.org/10.1007/BF01450798">https://doi.org/10.1007/BF01450798</a>.
</div>
<div id="ref-MR618323" class="csl-entry" role="listitem">
Jacquet, H., and J. A. Shalika. 1981. <span>“On <span>E</span>uler
Products and the Classification of Automorphic Representations.
<span>I</span> and <span>II</span>.”</span> <em>Amer. J. Math.</em> 103
(3): 499-558 and 777-815. <a
href="https://doi.org/10.2307/2374103">https://doi.org/10.2307/2374103</a>.
</div>
<div id="ref-2020arXiv200109640J" class="csl-entry" role="listitem">
Jana, Subhajit. 2020. <span>“<span class="nocase">Applications of
analytic newvectors for <span
class="math inline">\(\mathrm{GL}(r)\)</span></span>.”</span> <em>arXiv
e-Prints</em>, January, arXiv:2001.09640. <a
href="https://arxiv.org/abs/2001.09640">https://arxiv.org/abs/2001.09640</a>.
</div>
<div id="ref-JN19a" class="csl-entry" role="listitem">
Jana, Subhajit, and Paul D. Nelson. 2019. <span>“<span
class="nocase">Analytic newvectors for <span
class="math inline">\(\mathrm{GL}_n(\mathbb{R})\)</span></span>.”</span>
<em>arXiv e-Prints</em>, November, arXiv:1911.01880. <a
href="https://arxiv.org/abs/1911.01880">https://arxiv.org/abs/1911.01880</a>.
</div>
<div id="ref-MR2233686" class="csl-entry" role="listitem">
Jutila, Matti, and Yoichi Motohashi. 2005. <span>“Uniform Bound for
<span>H</span>ecke <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> <em>Acta
Math.</em> 195: 61–115. <a
href="https://doi.org/10.1007/BF02588051">https://doi.org/10.1007/BF02588051</a>.
</div>
<div id="ref-MR723332" class="csl-entry" role="listitem">
Kawai, Toru. 1983. <span>“Nonstandard Analysis by Axiomatic
Method.”</span> In <em>Southeast <span>A</span>sian Conference on Logic
(<span>S</span>ingapore, 1981)</em>, 111:55–76. Stud. Logic Found. Math.
North-Holland, Amsterdam. <a
href="https://doi.org/10.1016/S0049-237X(08)70955-8">https://doi.org/10.1016/S0049-237X(08)70955-8</a>.
</div>
<div id="ref-MR855239" class="csl-entry" role="listitem">
Knapp, Anthony W. 1986. <em>Representation Theory of Semisimple
Groups</em>. Vol. 36. Princeton Mathematical Series. Princeton
University Press, Princeton, NJ. <a
href="https://doi.org/10.1515/9781400883974">https://doi.org/10.1515/9781400883974</a>.
</div>
<div id="ref-MR0114875" class="csl-entry" role="listitem">
Kostant, Bertram. 1959. <span>“The Principal Three-Dimensional Subgroup
and the <span>B</span>etti Numbers of a Complex Simple <span>L</span>ie
Group.”</span> <em>Amer. J. Math.</em> 81: 973–1032. <a
href="https://doi.org/10.2307/2372999">https://doi.org/10.2307/2372999</a>.
</div>
<div id="ref-2020arXiv200607819K" class="csl-entry" role="listitem">
Kumar, Sumit, Kummari Mallesham, and Saurabh Kumar Singh. 2020.
<span>“<span class="nocase">Sub-convexity bound for <span
class="math inline">\(GL(3) \times GL(2)\)</span> <span
class="math inline">\(L\)</span>-functions: <span
class="math inline">\(GL(3)\)</span>-spectral aspect</span>.”</span>
<em>arXiv e-Prints</em>, June, arXiv:2006.07819. <a
href="https://arxiv.org/abs/2006.07819">https://arxiv.org/abs/2006.07819</a>.
</div>
<div id="ref-MR1544665" class="csl-entry" role="listitem">
Landau, Edmund. 1924. <span>“Über Die <span><span
class="math inline">\(\xi\)</span></span>-<span>F</span>unktion Und Die
<span><span
class="math inline">\(L\)</span></span>-<span>F</span>unktionen.”</span>
<em>Math. Z.</em> 20 (1): 105–25. <a
href="https://doi.org/10.1007/BF01188074">https://doi.org/10.1007/BF01188074</a>.
</div>
<div id="ref-MR0302614" class="csl-entry" role="listitem">
Langlands, R. P. 1970. <span>“Problems in the Theory of Automorphic
Forms.”</span> In <em>Lectures in Modern Analysis and Applications,
<span>III</span></em>, 18–61. Lecture Notes in Math., Vol. 170.
</div>
<div id="ref-MR0419366" class="csl-entry" role="listitem">
Langlands, Robert P. 1971. <em>Euler Products</em>. Vol. 1. Yale
Mathematical Monographs. Yale University Press, New Haven, Conn.-London.
</div>
<div id="ref-MR2402686" class="csl-entry" role="listitem">
Lapid, Erez M. 2008. <span>“A Remark on <span>E</span>isenstein
Series.”</span> In <em>Eisenstein Series and Applications</em>,
258:239–49. Progr. Math. Birkhäuser Boston, Boston, MA. <a
href="https://doi.org/10.1007/978-0-8176-4639-4\_8">https://doi.org/10.1007/978-0-8176-4639-4\_8</a>.
</div>
<div id="ref-MR3267120" class="csl-entry" role="listitem">
Lapid, Erez, and Zhengyu Mao. 2015. <span>“A Conjecture on
<span>W</span>hittaker-<span>F</span>ourier Coefficients of Cusp
Forms.”</span> <em>J. Number Theory</em> 146: 448–505. <a
href="https://doi.org/10.1016/j.jnt.2013.10.003">https://doi.org/10.1016/j.jnt.2013.10.003</a>.
</div>
<div id="ref-MR3649366" class="csl-entry" role="listitem">
———. 2017a. <span>“On an Analogue of the
<span>I</span>chino-<span>I</span>keda Conjecture for
<span>W</span>hittaker Coefficients on the Metaplectic Group.”</span>
<em>Algebra Number Theory</em> 11 (3): 713–65. <a
href="https://doi.org/10.2140/ant.2017.11.713">https://doi.org/10.2140/ant.2017.11.713</a>.
</div>
<div id="ref-MR3619910" class="csl-entry" role="listitem">
———. 2017b. <span>“Whittaker-<span>F</span>ourier Coefficients of Cusp
Forms on <span><span class="math inline">\(\widetilde{\rm
Sp}_n\)</span></span>: Reduction to a Local Statement.”</span> <em>Amer.
J. Math.</em> 139 (1): 1–55. <a
href="https://doi.org/10.1353/ajm.2017.0000">https://doi.org/10.1353/ajm.2017.0000</a>.
</div>
<div id="ref-MR2595006" class="csl-entry" role="listitem">
Li, Xiannan. 2010. <span>“Upper Bounds on <span><span
class="math inline">\(L\)</span></span>-Functions at the Edge of the
Critical Strip.”</span> <em>Int. Math. Res. Not. IMRN</em>, no. 4:
727–55. <a
href="https://doi.org/10.1093/imrn/rnp148">https://doi.org/10.1093/imrn/rnp148</a>.
</div>
<div id="ref-MR2753605" class="csl-entry" role="listitem">
Li, Xiaoqing. 2011. <span>“Bounds for <span><span
class="math inline">\({\rm GL}(3)\times {\rm GL}(2)\)</span></span>
<span><span class="math inline">\(L\)</span></span>-Functions and
<span><span class="math inline">\({\rm GL}(3)\)</span></span>
<span><span class="math inline">\(L\)</span></span>-Functions.”</span>
<em>Ann. Of Math. (2)</em> 173 (1): 301–36. <a
href="https://doi.org/10.4007/annals.2011.173.1.8">https://doi.org/10.4007/annals.2011.173.1.8</a>.
</div>
<div id="ref-2019arXiv191209473L" class="csl-entry" role="listitem">
Lin, Yongxiao, Philippe Michel, and Will Sawin. 2019. <span>“<span
class="nocase">Algebraic twists of <span
class="math inline">\(\mathrm{GL}_3\times \mathrm{GL}_2\)</span> <span
class="math inline">\(L\)</span>-functions</span>.”</span> <em>arXiv
e-Prints</em>, December, arXiv:1912.09473. <a
href="https://arxiv.org/abs/1912.09473">https://arxiv.org/abs/1912.09473</a>.
</div>
<div id="ref-MR3138844" class="csl-entry" role="listitem">
Matringe, Nadir. 2013. <span>“Essential <span>W</span>hittaker Functions
for <span><span class="math inline">\(GL(n)\)</span></span>.”</span>
<em>Doc. Math.</em> 18: 1191–1214.
</div>
<div id="ref-MR3043499" class="csl-entry" role="listitem">
McKee, Mark. 2013. <span>“<span><span
class="math inline">\(K\)</span></span>-Finite <span>W</span>hittaker
Functions Are of Finite Order One.”</span> <em>Acta Arith.</em> 158 (4):
359–401. <a
href="https://doi.org/10.4064/aa158-4-4">https://doi.org/10.4064/aa158-4-4</a>.
</div>
<div id="ref-MR1058223" class="csl-entry" role="listitem">
Meurman, Tom. 1990. <span>“On the Order of the <span>M</span>aass
<span><span class="math inline">\(L\)</span></span>-Function on the
Critical Line.”</span> In <em>Number Theory, <span>V</span>ol.
<span>I</span> (<span>B</span>udapest, 1987)</em>, 51:325–54. Colloq.
Math. Soc. János Bolyai. North-Holland, Amsterdam.
</div>
<div id="ref-Mi04" class="csl-entry" role="listitem">
Michel, P. 2004. <span>“The Subconvexity Problem for
<span>R</span>ankin-<span>S</span>elberg <span><span
class="math inline">\(L\)</span></span>-Functions and Equidistribution
of <span>H</span>eegner Points.”</span> <em>Ann. Of Math. (2)</em> 160
(1): 185–236.
</div>
<div id="ref-MR2331346" class="csl-entry" role="listitem">
Michel, Philippe. 2007. <span>“Analytic Number Theory and Families of
Automorphic <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> In
<em>Automorphic Forms and Applications</em>, 12:181–295. IAS/Park City
Math. Ser. Providence, RI: Amer. Math. Soc.
</div>
<div id="ref-MichelVenkateshICM" class="csl-entry" role="listitem">
Michel, Philippe, and Akshay Venkatesh. 2006. <span>“Equidistribution,
<span><span class="math inline">\(L\)</span></span>-Functions and
Ergodic Theory: On Some Problems of
<span>Y</span>u. <span>L</span>innik.”</span> In <em>International
<span>C</span>ongress of <span>M</span>athematicians. <span>V</span>ol.
<span>II</span></em>, 421–57. Eur. Math. Soc., Zürich.
</div>
<div id="ref-michel-2009" class="csl-entry" role="listitem">
———. 2010. <span>“The Subconvexity Problem for <span><span
class="math inline">\({\rm GL}_2\)</span></span>.”</span> <em>Publ.
Math. Inst. Hautes Études Sci.</em>, no. 111: 171–271. <a
href="https://doi.org/10.1007/s10240-010-0025-8">https://doi.org/10.1007/s10240-010-0025-8</a>.
</div>
<div id="ref-MR1361168" class="csl-entry" role="listitem">
Mœglin, C., and J.-L. Waldspurger. 1995. <em>Spectral Decomposition and
<span>E</span>isenstein Series</em>. Vol. 113. Cambridge Tracts in
Mathematics. Cambridge University Press, Cambridge. <a
href="https://doi.org/10.1017/CBO9780511470905">https://doi.org/10.1017/CBO9780511470905</a>.
</div>
<div id="ref-MR2035111" class="csl-entry" role="listitem">
Molev, A. I. 2003. <span>“Yangians and Their Applications.”</span> In
<em>Handbook of Algebra, <span>V</span>ol. 3</em>, 3:907–59. Handb.
Algebr. Elsevier/North-Holland, Amsterdam. <a
href="https://doi.org/10.1016/S1570-7954(03)80076-1">https://doi.org/10.1016/S1570-7954(03)80076-1</a>.
</div>
<div id="ref-MR1876443" class="csl-entry" role="listitem">
Molteni, Giuseppe. 2002. <span>“Upper and Lower Bounds at <span><span
class="math inline">\(s=1\)</span></span> for Certain
<span>D</span>irichlet Series with <span>E</span>uler Product.”</span>
<em>Duke Math. J.</em> 111 (1): 133–58. <a
href="https://doi.org/10.1215/S0012-7094-02-11114-4">https://doi.org/10.1215/S0012-7094-02-11114-4</a>.
</div>
<div id="ref-MooreOSU2018" class="csl-entry" role="listitem">
Moore, Daniel Ross. 2018. <em>An Intrinsic Theory of Smooth Automorphic
Representations</em>. OhioLINK Electronic Theses; Dissertations Center.
<a
href="http://rave.ohiolink.edu/etdc/view?acc_num=osu1524174589105537">http://rave.ohiolink.edu/etdc/view?acc_num=osu1524174589105537</a>.
</div>
<div id="ref-MR3369905" class="csl-entry" role="listitem">
Munshi, Ritabrata. 2015. <span>“The Circle Method and Bounds for
<span><span
class="math inline">\(L\)</span></span>-Functions—<span>III</span>:
<span><span class="math inline">\(t\)</span></span>-Aspect Subconvexity
for <span><span class="math inline">\(GL(3)\)</span></span> <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> <em>J. Amer.
Math. Soc.</em> 28 (4): 913–38. <a
href="https://doi.org/10.1090/jams/843">https://doi.org/10.1090/jams/843</a>.
</div>
<div id="ref-MR3966770" class="csl-entry" role="listitem">
———. 2018a. <span>“The Subconvexity Problem for <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> In
<em>Proceedings of the <span>I</span>nternational <span>C</span>ongress
of <span>M</span>athematicians—<span>R</span>io de <span>J</span>aneiro
2018. <span>V</span>ol. <span>II</span>. <span>I</span>nvited
Lectures</em>, 363–76. World Sci. Publ., Hackensack, NJ.
</div>
<div id="ref-2018arXiv181000539M" class="csl-entry" role="listitem">
———. 2018b. <span>“<span class="nocase">Subconvexity for <span
class="math inline">\(GL(3)\times GL(2)\)</span> <span
class="math inline">\(L\)</span>-functions in <span
class="math inline">\(t\)</span>-aspect</span>.”</span> <em>arXiv
e-Prints</em>, October, arXiv:1810.00539. <a
href="https://arxiv.org/abs/1810.00539">https://arxiv.org/abs/1810.00539</a>.
</div>
<div id="ref-MR469763" class="csl-entry" role="listitem">
Nelson, Edward. 1977. <span>“Internal Set Theory: A New Approach to
Nonstandard Analysis.”</span> <em>Bull. Amer. Math. Soc.</em> 83 (6):
1165–98. <a
href="https://doi.org/10.1090/S0002-9904-1977-14398-X">https://doi.org/10.1090/S0002-9904-1977-14398-X</a>.
</div>
<div id="ref-2020arXiv200108704N" class="csl-entry" role="listitem">
Nelson, Paul D. 2022. <span>“Quadratic <span>H</span>ecke Sums and Mass
Equidistribution.”</span> <em>Int. Math. Res. Not. IMRN</em>, no. 17:
13659–701. <a
href="https://doi.org/10.1093/imrn/rnab093">https://doi.org/10.1093/imrn/rnab093</a>.
</div>
<div id="ref-2020arXiv201202187N" class="csl-entry" role="listitem">
———. 2023. <span>“Spectral Aspect Subconvex Bounds for <span><span
class="math inline">\(U_{n+1} \times U_n\)</span></span>.”</span>
<em>Invent. Math.</em> 232 (3): 1273–1438. <a
href="https://doi.org/10.1007/s00222-023-01180-x">https://doi.org/10.1007/s00222-023-01180-x</a>.
</div>
<div id="ref-PDN-AP-AS-que" class="csl-entry" role="listitem">
Nelson, Paul D., Ameya Pitale, and Abhishek Saha. 2014. <span>“Bounds
for <span>R</span>ankin–<span>S</span>elberg Integrals and Quantum
Unique Ergodicity for Powerful Levels.”</span> <em>J. Amer. Math.
Soc.</em> 27 (1): 147–91. <a
href="https://doi.org/10.1090/S0894-0347-2013-00779-1">https://doi.org/10.1090/S0894-0347-2013-00779-1</a>.
</div>
<div id="ref-nelson-venkatesh-1" class="csl-entry" role="listitem">
Nelson, Paul D., and A. Venkatesh. 2021. <span>“<span class="nocase">The
orbit method and analysis of automorphic forms</span>.”</span> <em>Acta
Math.</em> 226 (1): 1–209.
</div>
<div id="ref-2020arXiv200201993N" class="csl-entry" role="listitem">
Nunes, Ramon M. 2020. <span>“<span class="nocase">Spectral reciprocity
via integral representations</span>.”</span> <em>arXiv e-Prints</em>,
February, arXiv:2002.01993. <a
href="https://arxiv.org/abs/2002.01993">https://arxiv.org/abs/2002.01993</a>.
</div>
<div id="ref-MR546599" class="csl-entry" role="listitem">
Piatetski-Shapiro, I. I. 1979. <span>“Multiplicity One Theorems.”</span>
In <em>Automorphic Forms, Representations and <span><span
class="math inline">\(L\)</span></span>-Functions (<span>P</span>roc.
<span>S</span>ympos. <span>P</span>ure <span>M</span>ath.,
<span>O</span>regon <span>S</span>tate <span>U</span>niv.,
<span>C</span>orvallis, <span>O</span>re., 1977), <span>P</span>art
1</em>, 209–12. Proc. Sympos. Pure Math., XXXIII. Amer. Math. Soc.,
Providence, R.I.
</div>
<div id="ref-MR2200997" class="csl-entry" role="listitem">
Ramakrishnan, Dinakar, and Jonathan Rogawski. 2005. <span>“Average
Values of Modular <span><span
class="math inline">\(L\)</span></span>-Series via the Relative Trace
Formula.”</span> <em>Pure Appl. Math. Q.</em> 1 (4, Special Issue: In
memory of Armand Borel. Part 3): 701–35. <a
href="https://doi.org/10.4310/PAMQ.2005.v1.n4.a1">https://doi.org/10.4310/PAMQ.2005.v1.n4.a1</a>.
</div>
<div id="ref-MR1395406" class="csl-entry" role="listitem">
Rudnick, Zeév, and Peter Sarnak. 1996. <span>“Zeros of Principal
<span><span class="math inline">\(L\)</span></span>-Functions and Random
Matrix Theory.”</span> <em>Duke Math. J.</em> 81 (2): 269–322. <a
href="https://doi.org/10.1215/S0012-7094-96-08115-6">https://doi.org/10.1215/S0012-7094-96-08115-6</a>.
</div>
<div id="ref-sarnak-progress-que" class="csl-entry" role="listitem">
Sarnak, Peter. 2011. <span>“Recent Progress on the Quantum Unique
Ergodicity Conjecture.”</span> <em>Bull. Amer. Math. Soc. (N.S.)</em> 48
(2): 211–28. <a
href="https://doi.org/10.1090/S0273-0979-2011-01323-4">https://doi.org/10.1090/S0273-0979-2011-01323-4</a>.
</div>
<div id="ref-2020arXiv200406791S" class="csl-entry" role="listitem">
Schumacher, Raphael. 2020. <span>“<span class="nocase">Subconvexity for
<span class="math inline">\(GL_{3}(R)\)</span> <span
class="math inline">\(L\)</span>-Functions via Integral
Representations</span>.”</span> <em>arXiv e-Prints</em>, April,
arXiv:2004.06791. <a
href="https://arxiv.org/abs/2004.06791">https://arxiv.org/abs/2004.06791</a>.
</div>
<div id="ref-MR2179691" class="csl-entry" role="listitem">
Serre, Jean-Pierre. 2006. <em>Lie Algebras and <span>L</span>ie
Groups</em>. Vol. 1500. Lecture Notes in Mathematics. Springer-Verlag,
Berlin.
</div>
<div id="ref-MR563369" class="csl-entry" role="listitem">
Shahidi, Freydoon. 1980. <span>“Whittaker Models for Real
Groups.”</span> <em>Duke Math. J.</em> 47 (1): 99–125. <a
href="http://projecteuclid.org/euclid.dmj/1077313864">http://projecteuclid.org/euclid.dmj/1077313864</a>.
</div>
<div id="ref-MR610479" class="csl-entry" role="listitem">
———. 1981. <span>“On Certain <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> <em>Amer. J.
Math.</em> 103 (2): 297–355. <a
href="https://doi.org/10.2307/2374219">https://doi.org/10.2307/2374219</a>.
</div>
<div id="ref-MR816396" class="csl-entry" role="listitem">
———. 1985. <span>“Local Coefficients as <span>A</span>rtin Factors for
Real Groups.”</span> <em>Duke Math. J.</em> 52 (4): 973–1007. <a
href="https://doi.org/10.1215/S0012-7094-85-05252-4">https://doi.org/10.1215/S0012-7094-85-05252-4</a>.
</div>
<div id="ref-MR2683009" class="csl-entry" role="listitem">
———. 2010. <em>Eisenstein Series and Automorphic <span><span
class="math inline">\(L\)</span></span>-Functions</em>. Vol. 58.
American Mathematical Society Colloquium Publications. American
Mathematical Society, Providence, RI. <a
href="https://doi.org/10.1090/coll/058">https://doi.org/10.1090/coll/058</a>.
</div>
<div id="ref-MR3969881" class="csl-entry" role="listitem">
———. 2018. <span>“On Generalized <span>F</span>ourier Transforms for
Standard <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> In
<em>Geometric Aspects of the Trace Formula</em>, 351–404. Simons Symp.
Springer, Cham.
</div>
<div id="ref-MR348047" class="csl-entry" role="listitem">
Shalika, J. A. 1974. <span>“The Multiplicity One Theorem for <span><span
class="math inline">\({\rm GL}_{n}\)</span></span>.”</span> <em>Ann. Of
Math. (2)</em> 100: 171–93. <a
href="https://doi.org/10.2307/1971071">https://doi.org/10.2307/1971071</a>.
</div>
<div id="ref-2019arXiv190609493S" class="csl-entry" role="listitem">
Sharma, Prahlad. 2019. <span>“<span class="nocase">Subconvexity for
<span class="math inline">\(GL(3)\times GL(2)\)</span> twists in level
aspect</span>.”</span> <em>arXiv e-Prints</em>, June, arXiv:1906.09493.
<a
href="https://arxiv.org/abs/1906.09493">https://arxiv.org/abs/1906.09493</a>.
</div>
<div id="ref-MR407208" class="csl-entry" role="listitem">
Shintani, Takuro. 1976. <span>“On an Explicit Formula for
Class-<span><span class="math inline">\(1\)</span></span>
<span>‘<span>W</span>hittaker Functions’</span> on <span><span
class="math inline">\(GL_{n}\)</span></span> over <span><span
class="math inline">\(P\)</span></span>-Adic Fields.”</span> <em>Proc.
Japan Acad.</em> 52 (4): 180–82. <a
href="http://projecteuclid.org/euclid.pja/1195518347">http://projecteuclid.org/euclid.pja/1195518347</a>.
</div>
<div id="ref-MR2680497" class="csl-entry" role="listitem">
Soundararajan, Kannan. 2010. <span>“Weak Subconvexity for Central Values
of <span><span
class="math inline">\(L\)</span></span>-Functions.”</span> <em>Ann. Of
Math. (2)</em> 172 (2): 1469–98.
</div>
<div id="ref-MR3953433" class="csl-entry" role="listitem">
Soundararajan, Kannan, and Jesse Thorner. 2019. <span>“Weak Subconvexity
Without a <span>R</span>amanujan Hypothesis.”</span> <em>Duke Math.
J.</em> 168 (7): 1231–68. <a
href="https://doi.org/10.1215/00127094-2018-0065">https://doi.org/10.1215/00127094-2018-0065</a>.
</div>
<div id="ref-2021arXiv210307835T" class="csl-entry" role="listitem">
Tsuzuki, Masao. 2021. <span>“<span class="nocase">Hecke-Maass cusp forms
on PGL_n of large levels with non-vanishing L-values</span>.”</span>
<em>arXiv e-Prints</em>, March, arXiv:2103.07835. <a
href="https://arxiv.org/abs/2103.07835">https://arxiv.org/abs/2103.07835</a>.
</div>
<div id="ref-MR2200849" class="csl-entry" role="listitem">
Venkatesh, Akshay. 2006. <span>“Large Sieve Inequalities for <span><span
class="math inline">\({\rm GL}(n)\)</span></span>-Forms in the Conductor
Aspect.”</span> <em>Adv. Math.</em> 200 (2): 336–56. <a
href="https://doi.org/10.1016/j.aim.2005.11.001">https://doi.org/10.1016/j.aim.2005.11.001</a>.
</div>
<div id="ref-venkatesh-2005" class="csl-entry" role="listitem">
———. 2010. <span>“Sparse Equidistribution Problems, Period Bounds and
Subconvexity.”</span> <em>Ann. Of Math. (2)</em> 172 (2): 989–1094. <a
href="https://doi.org/10.4007/annals.2010.172.989">https://doi.org/10.4007/annals.2010.172.989</a>.
</div>
<div id="ref-MR1170566" class="csl-entry" role="listitem">
Wallach, Nolan R. 1992. <em>Real Reductive Groups. <span>II</span></em>.
Vol. 132. Pure and Applied Mathematics. Academic Press, Inc., Boston,
MA.
</div>
<div id="ref-watson-2008" class="csl-entry" role="listitem">
Watson, Thomas Crawford. 2002. <em>Rankin Triple Products and Quantum
Chaos</em>. ProQuest LLC, Ann Arbor, MI. <a
href="http://gateway.proquest.com/openurl?url_ver=Z39.88-2004&amp;rft_val_fmt=info:ofi/fmt:kev:mtx:dissertation&amp;res_dat=xri:pqdiss&amp;rft_dat=xri:pqdiss:3039710">http://gateway.proquest.com/openurl?url_ver=Z39.88-2004&amp;rft_val_fmt=info:ofi/fmt:kev:mtx:dissertation&amp;res_dat=xri:pqdiss&amp;rft_dat=xri:pqdiss:3039710</a>.
</div>
<div id="ref-MR1511862" class="csl-entry" role="listitem">
Weyl, Hermann. 1916. <span>“Über Die <span>G</span>leichverteilung von
<span>Z</span>ahlen Mod. <span>E</span>ins.”</span> <em>Math. Ann.</em>
77 (3): 313–52. <a
href="https://doi.org/10.1007/BF01475864">https://doi.org/10.1007/BF01475864</a>.
</div>
<div id="ref-MR4206609" class="csl-entry" role="listitem">
Zacharias, Raphaël. 2021. <span>“Periods and Reciprocity
<span>I</span>.”</span> <em>Int. Math. Res. Not. IMRN</em>, no. 3:
2191–2209. <a
href="https://doi.org/10.1093/imrn/rnz100">https://doi.org/10.1093/imrn/rnz100</a>.
</div>
<div id="ref-MR4195660" class="csl-entry" role="listitem">
Zydor, Michał. 2020. <span>“Les Formules Des Traces Relatives de
<span>J</span>acquet-<span>R</span>allis Grossières.”</span> <em>J.
Reine Angew. Math.</em> 762: 195–259. <a
href="https://doi.org/10.1515/crelle-2018-0027">https://doi.org/10.1515/crelle-2018-0027</a>.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>The cited result imposes hypotheses that we do not
record here: that <span class="math inline">\(\eta\)</span> be small
enough, and <span class="math inline">\(N\)</span> large enough. These
hypotheses are clearly unnecessary. It also includes an additional
factor <span class="math inline">\(\prod_{i=1}^{n} (a_i +
a_i^{-1})^\varepsilon\)</span>, which can be absorbed into <span
class="math inline">\(\mathcal{G}_{\varepsilon,\ell}\)</span> at the
cost of modifying <span class="math inline">\(\varepsilon\)</span> and
<span class="math inline">\(\ell\)</span> suitably.<a href="#fnref1"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<script src="https://giscus.app/client.js"
        data-repo="Ultronozm/math"
        data-repo-id="R_kgDOJlhjqQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOJlhjqc4CWo21"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</body>
</html>

\documentclass[reqno]{amsart} \input{common.tex} \numberwithin{theorem}{section} \numberwithin{equation}{section}

\usepackage{xr-hyper}
\externaldocument{20230907T142550--generating-functions-asymptotics}
\externaldocument{20230907T143130--fourier-and-mellin-transforms}
\externaldocument{20230907T143521--complex-analysis-preliminaries}
\externaldocument{20230907T144219--bernoulli-numbers-euler-maclaurin}
\externaldocument{20230919T144827--discrete-fourier-transform}

\begin{document}
 
These are notes for an ongoing Fall 2023 course on the Riemann zeta function and its generalizations, $L$-functions, taught with Sergey Arkhipov.  These notes will be filled in as we go.

\section{References thus far}
\begin{itemize}
\item Generating functions and asymptotics: \cite[\S5.2]{MR2172781}
\item Mellin transform and asymptotics: \cite{zagier-mellin}
\item Zeros of zeta and the prime number theorem: \cite{Dav80}, \cite{MR2061214}, \href{https://terrytao.wordpress.com/2014/12/09/254a-notes-2-complex-analytic-multiplicative-number-theory/}{Tao's notes}
\end{itemize}

\section{Outlines thus far}
(Some links here refer to external files; I'll have to think of a good way to notate that.)
\begin{itemize}
\item Tuesday, 29 Aug: parts of \S\ref{sec:cj4unj5r3k}; \S\ref{sec:cj4vkkg5ah}, \S\ref{sec:cj4vkkg9es}
\item Thursday, 31 Aug: \S\ref{sec:cj4unj3scf}, \S\ref{sec:cj4unj4gyo}
\item Friday, 1 Sep: \S\ref{sec:cj4unj04kx} and \S\ref{sec:cj4unj06mw}
\item Tuesday, 5 Sep: \S\ref{sec:cj4unjziaz}
\item Thursday, 7 Sep: \S\ref{sec:cj4vkkark8}, \S\ref{sec:cj4vkfaant}
\item Tuesday, 12 Sep and Thursday, 14 Sep: Fourier transform, Pontryagin duality, Poisson summation (see \href{20230919T144827--discrete-fourier-transform.pdf}{these notes} and the book \cite{MR3289059})
\item Tuesday, 19 Sep: Euler products, relevance of zeta zeros to asymptotics \S\ref{sec:cj4020t3kt}
\item Thursday, 21 Sep: harmonic functions (external \S\ref{sec:cj41z468dg}), approximate factorizations of holomorphic functions (external \S\ref{sec:cj41z5fwla}), crude control over zeta zeros (\S\ref{sec:cj410a1fzy})
\item Tuesday, Thursday and Friday, 26--29 Sep: Sergey's lectures concerning zeroes of zeta on or near the $1$-line.  References:
  \begin{itemize}
  \item \cite[Chapter III]{MR882550}, up through 3.6,
  \item \cite[Chapter 13]{Dav80}, and
  \item part 3 of \href{these notes}{https://terrytao.wordpress.com/2014/12/09/254a-notes-2-complex-analytic-multiplicative-number-theory/}.
  \end{itemize}
\item Tuesday, 3 October: contour shifting, especially Proposition~\ref{proposition:cj541es01g}
\item Thursday, 5 October: deduction of the prime number theorem, \S\ref{sec:cj56fbu411}
\item Tuesday, 10 October: Dirichlet characters (start of \S\ref{sec:cj578xc01a})
\item Thursday, 12 October: basics on Dirichlet $L$-functions  (more of \S\ref{sec:cj578xc01a})
\end{itemize}


\section{Possible exam topics}


\begin{enumerate}
\item Beurling primes. \cite{MR2208947}.
  
\item Infinite product formula for the zeta function. \cite[\S12]{Dav80}.  Can also learn more general factorization theorem of holomorphic functions, see for instance \cite{MR1976398}.
  
\item Quantitative form of the prime number theorem.  \cite[\S18, 20--22]{Dav80}.
  
\item Asymptotics for the number of zeros in a given region.  \cite[\S15--16]{Dav80}.
  
\item Pontryagin duality and related aspects of the Fourier transform, even in the setting of groups related to $\mathbb{R}$, or discrete groups.  See for instance \cite[\S3]{MR1680912}.

  
\item Exponential sums over primes: \cite[\S24--25]{Dav80}.
  
\item Sums of three primes: \cite[\S26]{Dav80}
  
\item Bombieri--Vinogradov theorem: \cite[\S27--28]{Dav80}.
  
\item Class number formula and related topics, e.g., class number one problem of Gauss.
  
\item Function field analogues of $L$-functions.
  
\item Dedekind zeta functions and their factorizations.
  
\item More on the functional equation for zeta and $L$.  Stirling asymptotics for $\Gamma$.
  
\item The perspective of Tate's thesis and Weil's interpretation, with local and global functional equations (optionally, with adeles).
  
\item $p$-adic interpolation of $L$-functions.
\end{enumerate}



\section{Course notes that I've since split off into separate files}
\begin{itemize}
\item \href{20230907T143521--complex-analysis-preliminaries.pdf}{Complex-analytic preliminaries}
\item \href{20230907T142550--generating-functions-asymptotics.pdf}{Generating functions and asymptotics}
\item \href{20230907T143130--fourier-and-mellin-transforms.pdf}{Fourier and Mellin transforms}
\item \href{20230907T144219--bernoulli-numbers-euler-maclaurin.pdf}{Bernoulli numbers and Euler--Maclaurin summation}
\end{itemize}


\newpage


\section{Background}\label{sec:cj4unj5r3k}

\subsection{General notation}
$\mathbb{R}^+ := (0,\infty)$.

\subsection{Asymptotic notation}
We use the equivalent notations
\begin{equation*}
  A = \O(B), \qquad A \ll B,
  \qquad B \gg A
\end{equation*}
to denote that
\begin{equation*}
  \lvert A \rvert \leq C \lvert B \rvert
\end{equation*}
for some ``constant'' $C$.  The precise meaning of ``constant'' will either be specified or clear from context.


\newpage
\subsection{Definition and basic properties of $\zeta$: overview}
The Riemann zeta function is defined for a complex number $s$ by the series
\begin{equation*}
  \zeta (s) = \sum_{n \geq 1} \frac{1}{n^s }.
\end{equation*}
\begin{lemma}
  The series converges absolutely for $\Re(s) > 1$, uniformly for $\Re(s) \geq 1 + \eps$ for each $\eps > 0$.
\end{lemma}
\begin{proof}
  Using the identity
  \begin{equation*}
    \left\lvert \frac{1}{n^s} \right\rvert = \frac{1}{n^{\Re(s)}},
  \end{equation*}
  we reduce to the case that $s$ is real, in which this is a familiar consequence of the integral test.
\end{proof}

Our first main goal in the course is to explain the following basic facts.
\begin{theorem}
  The Riemann zeta function admits a meromorphic continuation to the entire complex plane.  It is holomorphic away from a simple pole at $s = 1$, where it has residue $1$.  It admits a functional equation relating $\zeta (s)$ to $\zeta (1-s)$.
\end{theorem}

One historical motivation for considering the zeta function at complex arguments comes from the prime number theorem.
\begin{theorem}[Prime number theorem]
  Let $\pi(x) := \# \left\{ \text{primes } p \leq x \right\}$ denote the prime counting function.  Then
  \begin{equation*}
    \frac{\pi(x)}{x / \log x} \rightarrow 1
    \text{ as } x \rightarrow \infty.
  \end{equation*}
\end{theorem}
This is related to the following analytic fact concerning the zeros of the zeta function.
\begin{theorem}[Prime number theorem, formulated in terms of $\zeta$]\label{theorem:cj3vp9l79t}
  We have $\zeta(s) = 0$ only if $\Re(s) < 1$.
\end{theorem}
\begin{remark}
  Even the statement of Theorem~\ref{theorem:cj3vp9l79t} is not clear without knowing the meromorphic continuation of $\zeta$.  This may offer some motivation for understanding the latter.
\end{remark}
We expect stronger nonvanishing properties:
\begin{conjecture}[Riemann Hypothesis]
  We have $\zeta(s) = 0$ only if $\Re(s) < 1/2$.
\end{conjecture}
This corresponds to a conjectural stronger form of the prime number theorem, namely that
\begin{equation*}
  \pi(x) = \int_2^x \frac{t}{\log t} \, d t
  + \O (x^{1/2} \log x).
\end{equation*}

\newpage

\newpage
\section{Basic analytic properties of $\zeta$}\label{sec:cj4unjziaz}


\subsection{Meromorphic continuation and evaluation at negative integers}
Take
\begin{equation*}
  h(y) = \frac{1}{e^y - 1}.
\end{equation*}
The function $y h(y)$ extends to a holomorphic function of $y$ on the disc $\{y \in \mathbb{C} : \lvert y \rvert < 2 \pi \}$, so $h$ is represented for small $y > 0$ by an absolutely convergent Laurent series of the following form:
\begin{equation*}
  h(y) = \frac{1}{y} + \sum_{n = 1 }^\infty \frac{B_n  }{ n !} y^{n - 1}.
\end{equation*}
Here the $B_n$ are complex coefficients, called the \emph{Bernoulli numbers} (see \href{20230907T144219--bernoulli-numbers-euler-maclaurin.pdf}{this note}).  On the other hand, $h$ decays rapidly (like $\O(y^N)$ for any fixed $N$) as $y \rightarrow \infty$.  By the analysis we've now seen many times, we deduce that the Mellin transform $H(s)$ of $h(y)$ converges absolutely for $\Re(s) > 1$, where it defines a holomorphic function, and extends to a meromorphic function on the complex plane whose only poles are simple poles at $s = 1$ (corresponding to the $1/y$ term in the asymptotic expansion as $y \rightarrow 0$) and at $s = -n$ for each $n \in \mathbb{Z}_{\geq 0}$, with residue given by $1$ in the former case and by $B_{n+1} / (n+!)!$ in the latter.

On the other hand, we can rewrite
\begin{equation*}
  h(y) = \frac{e^{- y}}{ 1 - e^{- y}}
  = e^{- y } + e^{- 2 y } + e^{- 3 y} + \dotsb,
\end{equation*}
giving
\begin{equation*}
  H(s) = \int_{\mathbb{R}^+ } y^s \sum_{n = 1 }^\infty e^{- n y } \,d^\times y.
\end{equation*}
The following calculations will show that the doubly integral/sum converges absolutely for $\Re(s) > 1$, so we may rearrange it as
\begin{equation*}
  \sum_{n = 1 }^\infty \int_{\mathbb{R}^+ } y^s e^{- n y } \,d^\times y.
\end{equation*}
The inner integral may be simplified by the substitution $y \mapsto y /n$.  This has no effect on the measure $d^\times y$, but replaces $y^s$ by $n^{-s} y^s$, giving
\begin{equation*}
  \sum_{n = 1 }^\infty n^{- s} \int_{\mathbb{R}^+ } y^s e^{- y } \,d^\times y
  = \zeta(s) \Gamma(s).
\end{equation*}
We see in this way that the $\zeta$ function admits a meromorphic continuation.  Since the $\Gamma$-function \href{https://www.proofwiki.org/wiki/Zeroes_of_Gamma_Function}{does not vanish}, we deduce that the only pole of $\zeta$ is the simple one at $s=1$, with residue $s=0$.  Also, since we have computed the residues of both $\Gamma(s)$ and $\zeta(s) \Gamma(s)$ at the nonpositive integers, we may calculate in this way the values of $\zeta(-n)$ for each $n \in \mathbb{Z}_{\geq 0}$:
\begin{equation*}
  \zeta(-n) = (-1)^n \frac{B_{n + 1}}{ n + 1}.
\end{equation*}

\subsection{Another perspective on the meromorphic continuation}\label{sec:cj4vkkark8}
(TODO: think of better section titles)

Given $f : \mathbb{R} \rightarrow \mathbb{C}$ of sufficient decay at infinity, we define $g : \mathbb{R}^+ \rightarrow \mathbb{C} $ by
\begin{equation*}
  g(y) := \sum_{n \in \mathbb{Z} } f(n y).
\end{equation*}
We assume henceforth that $f$ lies in the \href{https://en.wikipedia.org/wiki/Schwartz_space}{Schwartz space} $\mathcal{S}(\mathbb{R})$.

The asymptotics of $g(y)$ are described as follows.
\begin{lemma}\label{lemma:cj56e5j5uq}
  Let $f \in \mathcal{S}(R)$.
  \begin{enumerate}
  \item As $y \rightarrow \infty$, we have
    \begin{equation}\label{eq:cj4vkfq4ku}
      g(y) = f(0) + \O(y^{-N})
    \end{equation}
    for each fixed $N$.
  \item As $y \rightarrow 0$, we have
    \begin{equation}\label{eq:cj4vkfrkjf}
      g(y) = y^{-1} \int_{\mathbb{R} } f(x) \, d x  + \O (y^{N})
    \end{equation}
    for each fixed $N$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  The first estimate \eqref{eq:cj4vkfq4ku} is an easy exercise using the definition of the Schwartz space.  The second estimate \eqref{eq:cj4vkfrkjf} may be proved either via Euler--Maclaurin summation (see external \S\ref{sec:cj4vkfaant}) or Poisson summation (see external \S\ref{sec:cj4vkkp26q}).
\end{proof}

Assuming that $f(0)$ and $\int f$ are nonzero, it follows that the Mellin transform of $g$ does not converge absolutely at any point.  We can still define a regularized Mellin transform
\begin{equation*}
  G(s) = \int_{\mathbb{R}^+ }^{\reg} y^s g (y) \,d^\times y,
\end{equation*}
like in \S\ref{sec:cj4unj4gyo}, by splitting the integral into two pieces (e.g, the contributions of $(0,1)$ and $(1,\infty$)), meromorphically continuing each piece, and then summing the results on their domain of overlap (if any).

\begin{lemma}\label{lemma:cj56e5j3yz}
  $G(s)$ defines a meromorphic function on the complex plane whose only poles at simple ones:
  \begin{itemize}
  \item at $s = 0$, with residue $-f(0)$, and
  \item at $s = 1$, with residue $\int_{\mathbb{R}} f(x) \,d x $.
  \end{itemize}
\end{lemma}
\begin{proof}
  Let's carry this out in detail, applying the recipe of external \S\ref{sec:cj4vkf4yvq}.
  \begin{itemize}
  \item We see from \eqref{eq:cj4vkfq4ku} that the integral
    \begin{equation*}
      G_+(s) := \int_1^\infty y^s g(y) \,d^\times y
    \end{equation*}
    converges absolutely for $\Re(s) < 0$ and extends to a meromorphic function of $s$, whose only pole is a simple pole at $s = 0$ of residue $-f(0)$.  Indeed,
    \begin{equation*}
      G_+(s) = \int_1^\infty y^s \left(g (y) - f(0) \right) \,d^\times y
      + f(0)
      \underbrace
      {
        \int_1^\infty y^{s} \,d^\times y
      }_{
        -1/s
      },
    \end{equation*}
    where the first integral on the right hand side converges absolutely for all $s$.
  \item We see from \eqref{eq:cj4vkfrkjf} that the integral
    \begin{equation*}
      G_-(s) := \int_0^1 y^s g(y) \,d^\times y
    \end{equation*}
    converges absolutely for $\Re(s) > 1$ and extends to a meromorphic function of $s$, whose only pole is a simple pole at $s = 1$ of residue $I_f$, where $I_f := \int_{\mathbb{R} } f (x) \, d x$.  Indeed,
    \begin{equation*}
      G_-(s) = \int_0^1 y^s \left( g (y) - y^{-1} I_f \right) \,d^\times y + I_f \underbrace
      {
        \int_0^1 y^{s-1} \,d^\times y
      }_{
        1/(s-1)
      }.
    \end{equation*}
  \end{itemize}
\end{proof}

We denote henceforth by $\mathcal{F} f$ the (normalized) Fourier transform
\begin{equation*}
  \mathcal{F} f (\xi) := \int_{x \in \mathbb{R} } f(x) e^{- 2 \pi i x \xi } \, d x.
\end{equation*}

\begin{lemma}\label{lemma:cj4vkjxr7m}
  Write $G(s) = G_f(s)$ to indicate the dependence upon $f$.  Then we have the following functional equation:
  \begin{equation*}
    G_f(s) = G_{\mathcal{F} f}(1-s).
  \end{equation*}
\end{lemma}
\begin{proof}
  This is a consequence of the Poisson summation formula (see external \eqref{eq:cj4vkktmw8})
  \begin{equation*}
    \sum_{n \in \mathbb{Z} } f (n y) = y^{-1} \sum_{n \in \mathbb{Z} } \mathcal{F} f (n / y).
  \end{equation*}
  Writing $g_f$ to indicate the dependence of $g$ upon $f$, the above identity reads
  \begin{equation*}
    g_f(y) = y^{-1} g_{\mathcal{F} f}(1/y).
  \end{equation*}
  Taking the (regularized) Mellin transform of both sides yields
  \begin{equation*}
    G_f(s) = \int_{\mathbb{R}^+}^{\reg} y^{s-1} g_{\mathcal{F} f}(1/y) \,d^\times y.
  \end{equation*}
  To evaluate this last integral, we substitute $y \mapsto 1/y$, which leaves the measure $d^\times y$ invariant (and is unaffected by the regularization).  This gives
  \begin{equation*}
    G_f(s) = \int_{\mathbb{R}^+}^{\reg} y^{1-s} g_{\mathcal{F} f}(y) \,d^\times y = G_{\mathcal{F} f}(1-s),
  \end{equation*}
  as required.
\end{proof}


We suppose henceforth that $f$ is even.  This is without much loss of generality -- any function can be written as a sum of even and odd functions, and if $f$ is odd, then $g$ vanishes identically.

\begin{exercise}\label{exercise:cj56e5j0b7}
  Let $f \in \mathcal{S}(\mathbb{R})$ be even.  Show that the Mellin transform
  \begin{equation*}
    F(s) := \int y^s f (y) \,d^\times y
  \end{equation*}
  converges initially for $\Re(s) > 0$ and extends to a meromorphic function on the complex plane, whose only poles are simple ones at $s = - 2n$ for $n \in \mathbb{Z}_{\geq 0}$ with residue
  \begin{equation*}
    \res_{s = - 2 n} F(s) = \frac{1}{(2 n)!} f^{(2 n)}(0).
  \end{equation*}
  [Use Taylor's theorem with remainder, and note that the odd Taylor coefficients vanish in view of the evenness assumption on $f$.]
\end{exercise}
\begin{example}\label{example:cj56e5io5n}
  Take $f(x) := e^{- \pi x^2}$.  Then
  \begin{equation}\label{eq:cj4vkj6hym}
    F(s) = \pi^{- s / 2 } \Gamma (s / 2),
  \end{equation}
  as one sees by substituting $y \mapsto \sqrt{y}$ and then $y \mapsto y / \pi$ in the defining integral.  This has poles in the expected places.
\end{example}

For $f$ even, we have
\begin{equation*}
  g(y) = f(0) + 2 \sum_{n = 1 }^\infty f(n y).
\end{equation*}
Using that the constant function $1$ has vanishing regularized Mellin transform (for reasons similar to external Exercise \ref{exercise:cj4ss5ia8l}), we see that $G(s)$ admits the following absolutely convergent integral representation for $\Re(s) > 1$:
\begin{equation*}
  G(s) = 2 \int_{\mathbb{R}^+ } y^s \sum_{n = 1 }^\infty f (n y ) \,d^\times y.
\end{equation*}
By substituting $y \mapsto y / n$, we see that
\begin{equation*}
  G(s) = 2 \zeta(s) F(s), \qquad F(s) := \int y^s f(y) \,d^\times y.
\end{equation*}
This gives another proof of the meromorphic behavior of $\zeta$.  TODO: say more.

We can also deduce the functional equation:
\begin{theorem}\label{theorem:cj56e5im1s}
  We have
  \begin{equation*}
    \xi(s) := \pi^{- s / 2 } \Gamma (s/ 2 ) \zeta(s) = \xi (1 - s).
  \end{equation*}
\end{theorem}
\begin{proof}
  Take $f(x) := e^{- \pi x^2}$.  By \eqref{eq:cj4vkj6hym}, we then have $G_f(s) = \xi(s)$.  On the other hand, by the well-known \href{https://mathworld.wolfram.com/FourierTransformGaussian.html}{formula} for the Fourier transform of a Gaussian, we have $\mathcal{F} f = f$.  By Lemma \ref{lemma:cj4vkjxr7m}, it follows that $G_f (s) = G_f (1 - s)$.  The claimed formula follows.
\end{proof}

\subsection{Euler product}\label{sec:cj4020t3kt}
The link between the zeta function and the prime numbers is given by the following alternative formula:
\begin{lemma}\label{lemma:cj56e5ilni}
  For $\Re(s) > 1$, we have
  \begin{equation*}
    \zeta(s) = \prod_p \frac{1}{1 - p^{- s}},
  \end{equation*}
  where the product ranges over the primes $p$ and converges absolutely.  In particular,
  \begin{equation*}
    \zeta(s) \neq 0 \text{ for } \Re(s) > 1.
  \end{equation*}
  Quantitatively, for $\sigma > 1$, we have
  \begin{equation}\label{eq:cj41z53x7f}
    \lvert \zeta(\sigma + it) \rvert \geq \zeta(1 + \sigma)^{-1}.
  \end{equation}
\end{lemma}
Here we say that an infinite product \emph{converges absolutely} if it converges to the same nonzero value for any rearrangement of the factors.
\begin{proof}
  We first observe that for $S$ any finite set of primes, we have
  \begin{equation*}
    \prod_{p \in S}
    \frac{1}{1 - p^{- s}}
    = \prod_{p \in S}
    \sum_{k \geq 0} \frac{1}{ p^{k s}}
    =
    \sum_{n \in \mathbb{N}(S)}
    \frac{1}{n^s},
  \end{equation*}
  where $\mathbb{N}(S)$ denotes the set of natural numbers each of whose prime factors lie in $S$.  This identity follows from the fundamental theorem of arithmetic, which implies that every element of $\mathbb{N}(S)$ may be written uniquely as a product of powers of elements of $S$.  We now take the limit as $S \rightarrow \mathbb{N}$.

  To see that the product converges to a nonzero limit, we can apply the following general fact: if $\sum_p |a_p| < \infty$, then the product $\prod_{p} (1 + a_p)$ converges to a limit, and that limit is nonzero provided that each factor $1 + a_p$ is nonzero.  Applying this facts with $a_p = p^{-s}$ gives what was claimed.


  For the quantitative estimate \eqref{eq:cj41z53x7f}, we observe that
  \begin{equation*}
    \left\lvert \frac{1}{\zeta(\sigma + it)}  \right\rvert
    = \prod_p \left\lvert 1 - p^{-s} \right\rvert
    \leq \prod_p \left(  1 + p^{-\sigma} \right)
    \leq \sum_n n^{-\sigma} = \zeta(1 + \sigma).
  \end{equation*}
\end{proof}


As a basic illustration of the resulting link between the zeta function and the primes, we verify the following:
\begin{lemma}\label{lemma:cj56e5ihnv}
  Let $s > 1$ be real, tending to $1$.  Then
  \begin{equation*}
    \sum_p \frac{1}{ p^s } = \log \frac{1}{1 - s} + \O(1).
  \end{equation*}
\end{lemma}
\begin{proof}
  Using the Taylor series for the logarithm, we compute
  \begin{equation}\label{eq:cj402w3a5w}
    \log \zeta (s) = \sum_p \log \left( \frac{1}{1 - p^{- s}} \right)
    =
    \sum_p \sum_{k \geq 1} \frac{p^{- k s }}{ k}.
  \end{equation}
  We leave it to the reader to check that
  \begin{equation}
    \sum_{k \geq 2} \frac{p^{- k s}}{ k }  = \O(1)
  \end{equation}
  in the indicated range.
\end{proof}
\begin{corollary}\label{corollary:cj56e5ijg7}
  $\sum_p 1 / p = \infty$.
\end{corollary}

\subsection{Logarithmic derivatives}
While the logarithm $\log \zeta(s)$ is multi-valued, the logarithmic derivative
\begin{equation*}
  \left( \log \zeta(s) \right) '
  = \frac{\zeta '}{\zeta } (s) 
\end{equation*}
is single-valued.  It may be computed by differentiating \eqref{eq:cj402w3a5w}:
\begin{equation*}
  - \frac{\zeta '}{ \zeta } (s) = \sum _p (\log p) \sum_{k \geq 1} p^{- k s} = \sum_n \frac{\Lambda(n) }{n^s},
\end{equation*}
where the \emph{von Mangoldt function} $\Lambda(n)$ is defined by
\begin{equation*}
  \Lambda(n) :=
  \begin{cases}
    \log p & \text{ if } n = p ^k, \\
    0 & \text{ otherwise.}
  \end{cases}
\end{equation*}


The general theme of this course suggests a relationship between the asymptotics of $\Lambda(n)$ and the meromorphic behavior of $- \zeta ' / \zeta$.  The poles of the latter may be described as follows.  Suppose that $\rho \in \mathbb{C}$ is a point at which $\zeta$ has a zero of order $m \in \mathbb{Z}$, i.e., $\zeta(s) \sim c (s - \rho)^m$ for some $c \in \mathbb{C}^\times$ as $s \rightarrow \rho$.  Then
\begin{equation*}
  - \frac{\zeta'}{\zeta}(s) \sim \frac{- m }{s - \rho}.
\end{equation*}
Therefore the poles of $- \zeta ' / \zeta $ are all simple, and occur at
\begin{itemize}
\item the (unique simple) pole $\rho = 1$ of $\zeta$, with residue $1$, and
\item at the zeros $\rho$ of $\zeta$, with residue $-m$, where $m \geq 1$ denotes the order of the zero.
\end{itemize}

Suppose, for instance, that we wish to understand the asymptotics of a sum like
\begin{equation*}
  S := \sum_n \Lambda (n) f \left( \frac{n}{x} \right).
\end{equation*}
Here $f \in C_c^\infty (\mathbb{R}^+ )$ is fixed, while we think of $x > 1$ as a parameter tending off to infinity.  To do this, we expand $f$ using its Mellin transform, which gives
\begin{equation*}
  f \left( \frac{n}{x} \right) = \int_{(c)} F (s) \left( \frac{x}{n} \right)^s \, \frac{d s}{2 \pi i}.
\end{equation*}
Here $c \in \mathbb{R}$ is any real number.  The double sum/integral obtained by inserting this expansion into the definition of $S$ converges absolutely for $c > 1$, where we may rearrange it to obtain
\begin{equation}\label{eq:cj42xpi3f4}
  S = \int_{(c)} F (s) x^s \underbrace
  {
    \sum_n 
    \frac{\Lambda (n)}{ n^s } 
  }_{
    - \frac{\zeta ' }{\zeta }(s)
  }\, \frac{d s}{2 \pi i}.
\end{equation}
We would now like to shift the contour to the left.

Working formally for the moment, we pick up contributiones from the poles of $\zeta$ at $1$ and its zeros $\rho$, giving
\begin{equation*}
  S =
  F(1) x
  -
  \sum_{\rho}
  F(\rho) x^\rho
  +
  \dotsb,
\end{equation*}
where $\dotsb$ denotes the ``remainder'' term given by an integral like $S$, but with $c$ large and negative, while $\rho$ ranges over the zeros of $\zeta$ with $\Re(\rho) > c$.  To implement such an argument rigorously requires some control over the growth of zeta and its number of zeros in vertical directions, which we will address shortly.  Ignoring such details for the moment, one can see from such expansions why the zeros of $\zeta$ play such a large role in describing the asymptotics of sums over primes such as $S$.  For instance, if we know that each $\rho$ has real part strictly less than $1$, then the corresponding term $F(\rho) x^\rho$ has lesser magnitude than $x$ as $x \rightarrow \infty$.

To make arguments like the above precise, we need some control over the growth of $ \zeta ' / \zeta $ in vertical strips, and also over the number of zeros.

\subsection{Crude control over zeros}\label{sec:cj410a1fzy}
For the following, we closely follow the presentation of part 2 of \href{these notes}{https://terrytao.wordpress.com/2014/12/09/254a-notes-2-complex-analytic-multiplicative-number-theory/}.  In particular, the following results can all be sharpened a bit using the functional equation, but we won't pause to do so here.

We begin by giving a simple formula for $\zeta$ valid in the critical strip $0 < \Re(s) < 1$.
\begin{lemma}\label{lemma:cj56e5idm1}
  For $\Re(s) > 0$, we have
  \begin{equation}\label{eq:cj41j93u44}
    \zeta(s) - \frac{1}{s - 1}
    = \sum_{n = 1}^\infty \int_n^{n+1}  \left( \frac{1}{n^s }  - \frac{1}{y^s} \right)   \, d y.
  \end{equation}
  
\end{lemma}
\begin{proof}
  We have
  \begin{equation*}
    \int_1^\infty \frac{1}{y^s } \, d y = \frac{1}{s - 1},
  \end{equation*}
  thus
  \begin{align*}
    \zeta(s) - \frac{1}{s - 1}
    &=
      \sum_{n = 1}^\infty \frac{1}{n^s } - \int_1^\infty \frac{1}{y^s } \, d y \\
    &=
      \sum_{n = 1}^\infty \left( \frac{1}{n^s } - \int_n^{n+1} \frac{1}{y^s} \, d y \right) \\
    &=
      \sum_{n = 1}^\infty \int_n^{n+1}  \left( \frac{1}{n^s }  - \frac{1}{y^s} \right)   \, d y.
  \end{align*}
\end{proof}

From this, we conclude a basic but useful upper bound for $\zeta$ in the critical strip.  (Much sharper forms are available, but we won't need them immediately.)
\begin{lemma}\label{lemma:cj56e5ibho}
  For $s = \sigma + it $ with $\sigma \geq \eps > 0$ and $\lvert t \rvert \geq 2$, we have
  \begin{equation}\label{eq:cj41kdcbj7}
    \log \lvert \zeta(s) \rvert \leq \log (\lvert t \rvert) + \O_{\eps}(1).
  \end{equation}
\end{lemma}
\begin{proof}
  We use the mean value theorem to estimate the integrand in \eqref{eq:cj41j93u44}:
  \begin{equation*}
    \frac{1}{n^s }  - \frac{1}{y^s}
    = - s \int_{t = n}^y t^{-s - 1} \, d t
    \ll s n^{-s - 1}.
  \end{equation*}
  It follows that for $\Re(s) \geq \eps > 0$, we have
  \begin{equation*}
    \zeta(s) - \frac{1}{s - 1}
    \ll s \sum_{n = 1}^\infty n^{-\eps - 1}
    \ll_\eps s.
  \end{equation*}
  We conclude by taking the logarithm of this estimate.  We can discard the contribution of the pole because we have assumed that $\lvert t \rvert \geq 2$.
\end{proof}

With these results in hand, we can appeal to general properties of holomorphic functions to deduce the following pair of propositions:
\begin{proposition}\label{proposition:cj41z9de5r}
  Fix $\eps > 0$.
  \begin{enumerate}[(i)]
  \item\label{enumerate:cj41z9jrqm} For $t_0 \in \mathbb{R}$, the number of zeros of $\zeta$ in the rectangle $\{\sigma + i t: \eps \leq \sigma \leq 1, \lvert t - T \rvert \leq 1\}$ is $\O_\eps (\log (3 + \lvert t_0 \rvert))$.
  \item\label{enumerate:cj41z9j28y} For $s \in \mathbb{C}$ with $\Re(s) \geq \eps$, we have
    \begin{equation}\label{eq:cj41z82pyp}
      \frac{\zeta ' }{\zeta }(s)
      =
      \frac{1}{s - 1} - \sum_{
        \lvert \rho - s \rvert \leq \eps/2
      }
      \frac{1}{s - \rho } + \O_{\eps } \left( \log (3 + \lvert t \rvert) \right).
    \end{equation}
  \end{enumerate}
\end{proposition}
\begin{proof}
  We apply Lemma \ref{lemma:cj41z5hd4a} of \href{20230907T143521--complex-analysis-preliminaries.pdf}{these notes} to the function $f(s) := (s - 1) \zeta(s)$, the basepoint $s_0 := 2 + i t_0$, the radius $r := 2 - \eps/4$ and the disc $D = \{s : \lvert s - s_0 \rvert < r\}$, where $\eps > 0$ is sufficiently small.  The Euler product estimate \eqref{eq:cj41z53x7f} gives $\zeta(s_0) \asymp 1$. For $s$ with $\lvert s - s_0\rvert = r$, we have by \eqref{eq:cj41kdcbj7} $\lvert f(s) \rvert \leq M \lvert f(s_0) \rvert$ for some $M \ll \log(3 + \lvert t_0 \rvert)$.  This gives \eqref{enumerate:cj41z9jrqm}.

  For \eqref{enumerate:cj41z9j28y}, we argue as in \eqref{enumerate:cj41z9jrqm} with $t_0 := \Im(s)$.  We use the bound for the number of zeros to see that \eqref{eq:cj41z82pyp} doesn't change if we modify the sum by including or excluding any zeros that are at least some fixed distance away from $s$.  This leads to the claimed estimate.
\end{proof}

\begin{lemma}\label{lemma:cj42xpd5qe}
  For $C > \eps > 0$ and $T \in \mathbb{R}$, we have
  \begin{equation*}
    \int_{\sigma = \eps }^{C}
    \int_{t = T-1}^{T+1}
    \left\lvert
      \frac{\zeta ' }{\zeta }(\sigma + i t)
    \right\rvert
    \, d t
    \, d \sigma
    \ll_{\eps,C} \log (3 + \lvert T \rvert).
  \end{equation*}
\end{lemma}
\begin{proof}
  This follows upon integrating \eqref{eq:cj41z82pyp}, using that
  \begin{equation*}
    \int_{-R}^R
    \int_{-R}^R
    \frac{1}{\lvert x + i y \rvert} \, d x \, d y < \infty.
  \end{equation*}  
\end{proof}

\subsection{Contour shifting and an explicit formula}
We can now carry out the promised contour shifting arguments.  Here's a typical result that one can obtain in this way.  (Our arrangement is like Theorem 21 of \href{https://terrytao.wordpress.com/2014/12/09/254a-notes-2-complex-analytic-multiplicative-number-theory/}{these notes}, but with smooth weights, and should be compared against standard references such as \cite[Chapter 17]{Dav80} or \cite[\S5.5]{MR2061214}.  See also \cite{MR882550}.)
\begin{proposition}\label{proposition:cj541es01g}
  Let $f \in C_c^\infty(\mathbb{R})$, with Mellin transform $F(s) = \int_{\mathbb{R}^+} y^s f(y) \,d^\times y$.  Let $x \geq 1$ and $\eps > 0$.  Then
  \begin{equation*}
    \sum_n \Lambda (n) f \left( \frac{n}{x} \right)
    = F(1) x + \sum_{\rho : \Re(\rho) > \eps } F(\rho) x^{\rho}
    +
    \O_{\eps} \left( x^\eps \mathcal{E} \right),
  \end{equation*}
  where
  \begin{equation*}
    \mathcal{E} := \int_{T \in \mathbb{R} }
    E(T)
    \log (3 + |T|) \, d T,
    \qquad
    E(T) := 
    \max_{
      \substack{
        \sigma \in [\eps/2, \eps]  \\
        t \in [T-1, T+1]
      }
    }
    \left\lvert F(\sigma  + i t) \right\rvert.
  \end{equation*}
\end{proposition}
Note that since $f$ is smooth, the quantity $\mathcal{E}$ is finite (see external Lemma \ref{lemma:cj4ungtm6r} of \href{20230907T143130--fourier-and-mellin-transforms.pdf}{these notes}).

\begin{proof}
  To simplify notation, we can absorb $x$ into $f$: the function $f_1(y) := f(n/x)$ has Mellin transform $F_1(s) = x^s F(s)$, and from this we see easily that if we can establish the required conclusion for $F_1$ (with $x=1$), then we obtain the required conclusion for $F$.  Thus, let us suppose without loss of generality that $x = 1$.
  
  As in \eqref{eq:cj42xpi3f4}, we have for each $c > 1$
  \begin{equation*}
    \sum_n \Lambda (n) f \left( n \right)
    =
    \int_{(c)} F (s) D(s) \, \frac{d s}{2 \pi i},
    \quad
    D(s) := -\frac{\zeta ' }{\zeta }(s).
  \end{equation*}
  Set $I_\sigma(t) := \lvert F(\sigma + i t) D(\sigma + it) \rvert$.  By the definition of $E(T)$ and Lemma \ref{lemma:cj42xpd5qe}, we have
  \begin{align*}
    \int_{\sigma = \eps / 2}^{\eps}
    \int_{t \in \mathbb{R}}
    I_\sigma(t)
    \, d t
    \, d \sigma
    &\leq \int_{T \in \mathbb{R} } E(T)
      \int_{\sigma = \eps / 2 }^{\eps }
      \int_{t = T - 1}^{T + 1}
      \left\lvert D(\sigma+it) \right\rvert
      \, d t
      \, d \sigma \, d T \\
    &\ll_{\eps} \mathcal{E}.
  \end{align*}
  By the pigeonhole principle, we can find some $c_0 \in (\eps/2, \eps)$ so that
  \begin{equation}\label{eq:cj42xv8hdz}
    \int_{t \in \mathbb{R} } I_{c_0} (t) \ll_{\eps} \mathcal{E}.
  \end{equation}
  By the triangle inequality, it follows that
  \begin{equation*}
    \int_{(c_0)} F(s) D(s) \, \frac{d s}{2 \pi i } \ll _{\eps} \mathcal{E}.
  \end{equation*}
  We also have, by another application of Lemma \ref{lemma:cj42xpd5qe},
  \begin{align*}
    \left\lvert \sum_{\rho : c_0 < \Re(\rho) \leq \eps } F(\rho)  \right\rvert
    &\leq \int_{T \in \mathbb{R} }  E(T)
      \left(
      \sum_{
      \substack{
      \rho : c_0 < \Re(\rho) \leq \eps,  \\
    \Im(\rho) \in [T-1, T+1]
    }
    }
    1
    \right)
    \, d T \\
    &\ll_{\eps}\mathcal{E}.
  \end{align*}
  Note that \eqref{eq:cj42xv8hdz} implies in particular that $\zeta$ has no zeros with real part $c_0$.  By combining the above estimates, we reduce to establishing the following identity:
  \begin{equation*}
    \int_{(c)} F(s)  D(s) \, \frac{d s}{2 \pi i }
    =
    \int_{(c_0)} F(s)  D(s) \, \frac{d s}{2 \pi i }
    +
    F(1) 
    -
    \sum_{\rho : \Re(\rho) > c_0 } F(\rho) .
  \end{equation*}
  Note that each the integrals and sums converge absolutely, due to \eqref{eq:cj42xv8hdz}, part \eqref{enumerate:cj41z9jrqm} of Proposition \ref{proposition:cj41z9de5r}, and the rapid decay of $F$ in vertical strips.  It will thus suffice to find a sequence of positive reals $t$, tending off to infinity, along which the quantities
  \begin{equation*}
    J_t := \int_{c - i t}^{c + i t} F(s)  D(s) \, \frac{d s}{2 \pi i }
    -
    \int_{c_0 - i t}^{c_0 + i t} F(s)  D(s) \, \frac{d s}{2 \pi i }
    -
    F(1) 
    +
    \sum_{
      \substack{
        \rho : \Re(\rho) > c_0,   \\
        \lvert \Im(\rho) \rvert < t
      }
    } F(\rho) 
  \end{equation*}
  tend to zero.  To that end, we observe first that if $t$ is chosen not to coincide with the imaginary part of any zero of zeta, then Cauchy's residue theorem gives
  \begin{equation*}
    J_t =
    \int_{c - i t}^{c_0 - it}
    F(s)  D(s) \, \frac{d s}{2 \pi i }
    -
    \int_{c + i t}^{c_0 + it}
    F(s)  D(s) \, \frac{d s}{2 \pi i }.
  \end{equation*}
  We next observe, using the rapid decay of $F$ and the triangle inequality, that for each $T \in \mathbb{R}$,
  \begin{equation*}
    \int_{t = T-1}^{T + 1}\left\lvert J_t \right\rvert \, d t \ll_{f} \left(1 + |T|\right)^{-100}
    \int_{t = T - 1}^{T + 1} \int_{\sigma = c_0}^{c}  \lvert D(\sigma + i t) \rvert \, d t \, d \sigma.
  \end{equation*}
  By another application of Lemma \ref{lemma:cj42xpd5qe}, this last double integral is $\ll \log T$.  By another application of the pigeonhole principle, we can find $t \in [T-1,T+1]$ such that $J_t \ll (1 + \lvert T \rvert)^{-99}$, say.  Since $T$ can be taken arbitrarily large, we obtain the required sequence of quantities $t$ along which $J_t \rightarrow 0$.
\end{proof}

\subsection{Zero-free regions}
These results were presented in Sergey's lectures while I was travelling, following the reference \cite[\S3]{MR882550}.
\begin{theorem}\label{theorem:cj541i3g6o}
  There exists $c > 0$ so that if $\zeta(s) = 0$ for $s = \sigma + i t$, then
  \begin{equation*}
    1 - \sigma > \frac{c}{\log (2 + \lvert t \rvert)}.
  \end{equation*}
  In particular, $\zeta(s) = 0$ only if $\Re(s) < 1$.
\end{theorem}


\subsection{Prime number theorem}\label{sec:cj56fbu411}

We'll present the proof of the qualitative form, i.e., without giving an explicit error term.  First, we treat the case of a smoothly weighted sum.
\begin{theorem}\label{theorem:cj56e013t4}
  Fix $f \in C_c^\infty (\mathbb{R}^+ )$, with Mellin transform $F$, and let $x \rightarrow \infty$.  Then
  \begin{equation*}
    \sum_{n} \Lambda (n) f \left( \frac{n}{x} \right) = F(1) x + o(x).
  \end{equation*}
\end{theorem}
\begin{proof}
  We apply the explicit formula, as given in Proposition \ref{proposition:cj541es01g}, with some small $\eps > 0$.  The error quantity $E(T)$ is $\ll T^{-100}$, say, by the rapid decay of $F$, and so $\mathcal{E} \ll \int_{T \in \mathbb{R} } (1 + \lvert T \rvert)^{-100} \log(3 + |T|) \, d T \ll 1$.  Our task thereby reduces to showing that
  \begin{equation}\label{eq:cj541i9qbt}
    \sum_{\rho : \Re(\rho) > \eps } F(\rho) x^\rho = o(x).
  \end{equation}
  
  To that end, let us observe first that
  \begin{equation*}
    \sum_{\rho : \Re(\rho) > \eps } \lvert F(\rho) \rvert < \infty.
  \end{equation*}
  Indeed, by the rapid decay of $F$, we have $F(\rho) \ll \lvert \rho \rvert^{-100}$, while by Proposition \ref{proposition:cj41z9de5r}, the number of $\rho$ with $\lvert \rho \rvert \leq T$ is $\ll T \log T$ for $T \geq 3$; the claimed convergence then follows by summing over dyadic ranges $X \leq \lvert \rho \rvert \leq 2X$.

  It follows that for each $\alpha > 0$, we choose a finite multiset $\mathcal{R}$ of zeros $\rho$ as above such that the sum of $\lvert F(\rho) \rvert$ over the complement of $\mathcal{R}$ is at most $\alpha/2$.  On the other hand, for each $\rho \in \mathcal{R}$, we have by Theorem \ref{theorem:cj541i3g6o} that $\Re(\rho) < 1$, and so $\lim_{x \rightarrow \infty } F(\rho) x^{\rho-1} = 0$.  It follows that for $x > x_0(\alpha)$, the left hand side of \eqref{eq:cj541i9qbt} is bounded in magnitude by $\alpha$.  Since $\alpha > 0$ was arbitrary, we conclude that \eqref{eq:cj541i9qbt} holds, as required.
\end{proof}

Now we successively pass from this to more elementary statements.

First, we approximate sharp cutoffs by smooth ones to deduce a sharply truncated dyadic estimate.
\begin{theorem}\label{theorem:cj56e4c1fl}
  As $x \rightarrow \infty$, we have
  \begin{equation}\label{eq:cj56e0ogug}
    \sum_{x \leq n \leq 2 x} \Lambda(n) \sim x.
  \end{equation}
\end{theorem}
\begin{proof}
  For each fixed $\eps > 0$, we may find $f, f_+ \in C_c^\infty(\mathbb{R}^+)$ such that, writing $1_{A}$ for the character function of a set $A$ and $F, F_+ $ for the Mellin transforms,
  \begin{equation}\label{eq:cj56e0zjto}
    \left\lvert f(x) - 1_{[1,2]}(x) \right\rvert \leq f_+(x) \quad
    \text{and} \quad
    F_+(1) = \int  f_+ < \eps.
  \end{equation}
  (We can do this by modifying the standard proof that nonzero smooth compactly supported functions exist.)  Write $S$ for the left hand side of \eqref{eq:cj56e0ogug}, and write
  \begin{equation*}
    S_{f} := \sum_{n} \Lambda (n) f \left( \frac{n}{x} \right),
    \quad S_{f_+} := \sum_{n} \Lambda (n) f_+ \left( \frac{n}{x} \right)
  \end{equation*}
  for the analogous smoothly-weighted sums.  We then have
  \begin{equation}\label{eq:cj56e03cbi}
    \left\lvert S - S_f
    \right\rvert
    \leq S_{f_+}.
  \end{equation}
  By Theorem \ref{theorem:cj56e013t4}, we have $S_f = F(1) x + o(x)$ and $S_{f_+} = F_+(1) x + o(x)$.  By \eqref{eq:cj56e0zjto}, we have $\left\lvert F(1) - 1 \right\rvert \leq F_+(1) < \eps$.  In particular, for $x$ large enough, we deduce that $\lvert S_f - x \rvert < 2 \eps x$ and $\left\lvert S_{f_+} \right\rvert < 2 \eps x$.  By the triangle inequality, it follows that $\lvert S - x \rvert < 4 \eps x$.  Since $\eps > 0$ was arbitrary, we thereby deduce the claimed estimate \eqref{eq:cj56e0ogug}.
\end{proof}

Next, we apply dyadic summation to obtain an estimate for the sum over all $n \leq x$:
\begin{theorem}\label{theorem:cj56e5hu01}
  As $x \rightarrow \infty$, we have
  \begin{equation}\label{eq:cj56fbgld4}
    \sum_{n \leq x} \Lambda (n) \sim x.
  \end{equation}
\end{theorem}
\begin{proof}
  For $x \geq 1$, let us define $\alpha(x)$ by writing
  \begin{equation}\label{eq:cj56e4fgbu}
    \sum_{x < n \leq 2 x} \Lambda(n) = x (1 + \alpha (x)).
  \end{equation}
  By Theorem \ref{theorem:cj56e4c1fl}, we have
  \begin{equation}\label{eq:cj56e4jf1z}
    \alpha(x) \rightarrow 0
  \end{equation}
  as $x \rightarrow \infty$.  In particular, for $x$ sufficiently large, we have $\lvert \alpha(x) \rvert \leq 1$.  On the other hand, for small $x$, we see by trivial estimation that $\alpha(x)$ is uniformly bounded.  Thus there exists $C \geq 0$ so that
  \begin{equation}\label{eq:cj56e4jjez}
    \lvert \alpha(x) \rvert \leq C
  \end{equation}
  for all $x \geq 1$.

  Next, letting $x \rightarrow \infty$, we write
  \begin{equation*}
    \sum_{n \leq x} \Lambda(n) =
    \sum_{\frac{x}{2} < n \leq x}
    + \sum_{\frac{x}{4} < n \leq \frac{x}{2}}
    + \sum_{\frac{x}{8} < n \leq \frac{x}{4}} + \dotsb + \sum_{\frac{x}{2^{m+1}} < n \leq \frac{x}{2^m }},
  \end{equation*}
  where $m$ is chosen so that
  \begin{equation}\label{eq:cj56e4py7n}
    \frac{x}{2^{m + 1}} < 2 \leq \frac{x}{2^m}.
  \end{equation}
  By applying \eqref{eq:cj56e4fgbu} to each summand, we obtain
  \begin{equation*}
    \sum_{n \leq x } \Lambda (n) = x \left( 1 - \frac{1}{2^{m + 1}} \right)
    +
    x \sum_{k = 1}^{m + 1} \frac{1}{2^k} \alpha \left( \frac{x}{ 2^k } \right).    
  \end{equation*}
  Fix $\eps > 0$.  We can choose $k_1 \geq 1$ so that
  \begin{equation*}
    C \sum_{k > k_1} \frac{1}{2^k } \leq \eps.
  \end{equation*}
  By \eqref{eq:cj56e4jjez}, we then have
  \begin{equation*}
    \left\lvert x \sum_{k = k_1 + 1}^{m + 1} \frac{1}{2^k} \alpha \left( \frac{x}{ 2^k } \right) \right\rvert
    \leq \eps x.
  \end{equation*}
  On the other hand, for each $k \leq k_1$, we see by \eqref{eq:cj56e4jf1z} that
  \begin{equation*}
    x \frac{1}{2^k } \alpha \left( \frac{x}{2^k } \right) =o(x)
  \end{equation*}
  as $x \rightarrow \infty$.  By combining these estimates with \eqref{eq:cj56e4py7n}, we deduce that
  \begin{equation*}
    \left\lvert \sum_{n \leq x} \Lambda (n) - x \right\rvert \leq 3 \eps x
  \end{equation*}
  for $x$ sufficiently large.  Since $\eps > 0$ was arbitrary, we are done.
\end{proof}

We next aim to deduce from this the prime number theorem in unweighted form:
\begin{theorem}\label{theorem:cj56e5hrdh}
  As $x \rightarrow \infty$, we have
  \begin{equation*}
    \sum_{p \leq x} 1 \sim \frac{x}{\log x}.
  \end{equation*}
\end{theorem}

The proof uses the following identity.
\begin{lemma}[Abel summation]\label{lemma:cj56e5hp8x}
  Let $f$ be a continuously differentiable function on the interval $[a,b]$, where $a < b$ are real numbers, and let $c_n$ be a sequence of scalars, indexed by the integers, with $c_n = 0$ for $n$ sufficiently close to $-\infty$.  Then, writing
  \begin{equation*}
    S(t) := \sum_{n \leq t} c_n,
  \end{equation*}
  we have
  \begin{equation}\label{eq:cj56e5hnf5}
    \sum_{a < n  \leq b} f(n) c_n
    =
    f(b) S(b) - f(a) S(a)
    - \int_a^b S(t) f ' (t) \, d t.
  \end{equation}
\end{lemma}
\begin{proof}
  The left hand side of \eqref{eq:cj56e5hnf5} may be understood as the \href{https://en.wikipedia.org/wiki/Riemann%E2%80%93Stieltjes_integral}{Riemann--Stieltjes integral}
    \begin{equation*}
      \int_a^b f (t) \, d S(t).
    \end{equation*}
    The claimed formula follows by integration by parts for such integrals.

    Alternatively, we can reduce by linearity to the case that $c_m = 1$ and $c_n = 0$ for $n \neq m$.  Then $S(t) = 1_{t \geq m}$.  The claimed identity can be verified by considering separately the cases that $m \leq a$ or $a < m \leq b$ or $b < m$, in which it reads respectively
    \begin{equation*}
      0 = f(b) - f(a) - \int_a^b f'(t) \, d t,
    \end{equation*}
    \begin{equation*}
      f(m) = f(b) - \int_m^b f ' (t) \, d t,
    \end{equation*}
    \begin{equation*}
      0 = 0.
    \end{equation*}
\end{proof}
\begin{example}\label{example:cj56fa3yqw}
  If $f \equiv 1$, then \eqref{eq:cj56e5hnf5} says
  \begin{equation*}
    \sum_{a < n \leq b} c_n = S(b) - S(a),
  \end{equation*}
  which is clear.
\end{example}
\begin{example}\label{example:cj56fa31f5}
  If $f(t) = t$, then \eqref{eq:cj56e5hnf5} says
  \begin{equation*}
    \sum_{a < n \leq b} n c_n = b S(b) - a S(a) - \int_a^b S(t) \, d t.
  \end{equation*}
\end{example}
\begin{proof}[Proof of Theorem \ref{theorem:cj56e5hrdh}]
  We apply Lemma~\ref{lemma:cj56e5hp8x} with $[a,b] = [\tfrac{3}{2},x]$, $c_n = \Lambda(n)$, and $f(t) = 1 / \log t$.  Then $S(t) = \sum_{n \leq t} \Lambda(t)$.  Since $f'(t) = - 1 / (t \log^2 t)$, we obtain
  \begin{equation*}
    \sum_{n \leq x} \frac{\Lambda(n)}{\log n}
    = \frac{S(x)}{\log x} + \int_{\frac{3}{2}}^{x} \frac{S(t)}{t \log^2 t} \, d t.
  \end{equation*}
  By Theorem \eqref{eq:cj56fbgld4}, the first term on the right hand side is $\sim x / \log x$, while the second term is
  \begin{equation*}
    \ll \int_{\frac{3}{2}}^x \frac{d t}{\log ^2 t}.
  \end{equation*}
  We can estimate this last integral by splitting it into the ranges $t \leq \sqrt{x}$ and $t > \sqrt{x}$.  In the former range, we obtain $\ll \sqrt{x}$, while in the latter, we obtain $\ll x / \log ^2 x$, using that $\log \sqrt{x} \asymp \log x$.  It follows that
  \begin{equation*}
    \sum_{n \leq x}  \frac{\Lambda (n)}{\log n}
    \sim \frac{x}{\log x}.
  \end{equation*}
  Recall that, by definition, we have $\Lambda (n) / \log n = 0$ unless $n$ is of the form $p^k $ for some prime $p$ and natural number $k$, in which case $\Lambda (n) = \log p = \tfrac{1}{k} \log n$.  Since $p^k \leq x$ if and only if $p \leq x^{1/k}$, it follows that
  \begin{equation*}
    \sum_{n \leq x}  \frac{\Lambda (n)}{\log n}
    = \pi (x) + \pi (x^{1/2} ) + \pi (x^{1/3} ) + \dotsb + \pi (x^{1 / k}),
  \end{equation*}
  where $\pi(x)$ is the number of primes $p \leq x$ and $k$ is the natural number for which
  \begin{equation*}
    x^{\frac{1}{k}} \geq 2 > x^{\frac{1}{k + 1}}.
  \end{equation*}
  By trivial estimation, we have $\left\lvert \pi(x) \right\rvert \leq x$ and $k \ll \log x$, hence
  \begin{equation*}
    \pi (x^{1/2} ) + \pi (x^{1/3} ) + \dotsb + \pi (x^{1/k}) \ll x^{1/2} \log x.
  \end{equation*}
  This is much smaller than $x / \log x$, so we conclude as required that $\pi (x) \sim x / \log x$.
\end{proof}

\section{Primes in arithmetic progressions}\label{sec:cj578xc01a}
\subsection{Goal}\label{sec:cj578xc1wz}
Next goal is to establish the prime number theorem in arithmetic progressions.

Let $(a,b)$ denote the greatest common divisor of a pair of integers $a$ and $b$.  We recall that $(a,b)$ is then the nonnegative generator of the ideal generated by $a$ and $b$, hence may be written in the form $a x + b y$ for some integers $x$ and $y$.  We recall that $a$ and $b$ are called coprime if $(a,b) = 1$.

For a natural number $q$, we denote by $\mathbb{Z} / q := \mathbb{Z} / q \mathbb{Z}$ the ring of residue classes modulo $q$ and by $(\mathbb{Z} / q)^\times$ its unit group, consisting of what we call the \emph{reduced} residue classes.  Each residue class $a \in \mathbb{Z} / q$ may be identified with an arithmetic progression $a + q \mathbb{Z}$.  A residue class is reduced if and only if it consists of integers coprime to $q$.  We sometimes write simply $a \pod{q}$ and $a \pod{q}^*$ to denote respectively that $a \in \mathbb{Z} / q$ and that $a \in (\mathbb{Z} / q)^\times$.  We write
\begin{equation*}
  \phi(q) := (\mathbb{Z} / q) ^\times
\end{equation*}
for the Euler $\phi$ function, which counts the reduced residue classes modulo $q$.

If the residue class $a \pod{q}$ is not reduced, then it contains at most one prime number.  Indeed, our hypothesis implies that $a$ and $q$ have a common divisor $d > 1$.  Then any prime $p \equiv a \pod{q}$ is in particular divisible by $d$, hence $p = d$, as required.

It follows that all but finitely many prime numbers lie in one of the reduced residue classes modulo $q$.  By the prime number theorem, we thus have for fixed $q$, as $x \rightarrow \infty$, the estimate
\begin{equation*}
  \sum_{a (q)^*} \sum_{
    \substack{
      p \leq x  \\
      p \equiv  a(q)
    }
  }
  1
  \sim \frac{x}{ \log x}.
\end{equation*}
The prime number theorem says that the primes distribute evenly modulo the reduced residue classes, i.e., for each $a(q)^*$,
\begin{equation*}
  \sum_{
    \substack{
      p \leq x  \\
      p \equiv a (q)
    }
  }
  \frac{1}{\phi(q)}
  \frac{x}{\log x}.
\end{equation*}
The proof will boil down to nonvanishing properties of the Dirichlet $L$-functions $L(s,\chi)$, where $\chi$ is a Dirichlet character modulo $q$.

In particular, such estimates imply the infinitude of primes in arithmetic progressions (Dirichlet's theorem).

\subsection{Structure of the group of reduced residue classes}\label{sec:cj56v04qkg}
Let $q$ be a natural number.  Here we describe the structure of the group $(\mathbb{Z} / q)^\times$.  In particular, we write that group as a product of cyclic groups.

By the fundamental theorem of arithmetic, we may factor $q$ as a product of prime numbers, say $q = \prod_i p_i^{a_i}$.  By the Chinese remainder theorem, the natural map
\begin{equation*}
  \mathbb{Z} / q \rightarrow \prod_i \mathbb{Z} / p_i^{a_i}
\end{equation*}
is an isomorphism of rings, hence induces an isomorphism of unit groups
\begin{equation}\label{eq:cj56v11l5g}
  (\mathbb{Z} / q) ^\times \cong \prod_i (\mathbb{Z} / p_i^{a_i })^\times.
\end{equation}
We can therefore reduce our study to the case that $q$ is a prime power.

In the case that $q$ is a prime, we have the following fundamental fact from basic algebra:
\begin{lemma}\label{lemma:cj57ckf53h}
  For a prime number $p$, the group $(\mathbb{Z} / p )^\times $ is cyclic.
\end{lemma}
\begin{proof}
  We sketch the standard proof.  Since the group $(\mathbb{Z} / p)^\times$ has order $\phi(p) = p-1$, we have $x^{p-1} = 1$ for each $x \in (\mathbb{Z} / p)^\times$.  The order of $x$ is thus some divisor $d$ of $p-1$.  On the other hand, using that $\mathbb{Z} / p$ is a field and the fundamental theorem of algebra, we know that the number of elements $x$ of order $d$ is at most what it would be if the group $(\mathbb{Z} / q)^\times$ were cyclic.  By a counting argument, it follows that that number is in fact exactly what it would be if that group were cyclic.  In particular, by taking $d = p-1$, we deduce that there exists a cyclic element.
\end{proof}
A \emph{primitive root} modulo $p$ is a generator $g$ of the cyclic group $(\mathbb{Z} /p )^\times $.

How about for prime powers?  For an odd prime $p$ and an integer $k \geq 2$, the group $(\mathbb{Z} / p^k )^\times$ is likewise cyclic.  Indeed, we can lift a primitive root $g$ mod $p$ to a $(p-1)$st root of unity in $(\mathbb{Z} / p^k)^\times$.  Then the map
\begin{equation}\label{eq:cj56v1ftv0}
  \mathbb{Z} / (p-1) \times \mathbb{Z} / p^{k-1}  \rightarrow (\mathbb{Z} / p^k )^\times 
\end{equation}
\begin{equation*}
  (a,b) \mapsto g^a (1 + p)^b
\end{equation*}
is an isomorphism.  At the prime $2$, we have the slightly more complicated isomorphism
\label{sec:cj56v1kjb7}\begin{equation}
  \mathbb{Z} / 2 \times \mathbb{Z} / 2^{k - 2} \rightarrow (\mathbb{Z} / 2^k )^\times 
\end{equation}
\begin{equation*}
  (a, b) \mapsto (-1)^a 5^b.
\end{equation*}

\begin{example}\label{example:cj57ckfyti}
  What are the squares in $(\mathbb{Z} / q)^\times$?  Under the isomorphism \eqref{eq:cj56v11l5g}, they correspond to products of squares in $(\mathbb{Z} / p^k)^\times$, where $p^k$ runs over the prime power factors of $q$.  If $p$ is odd, then the squares in $(\mathbb{Z} / p^k )^\times$ are the elements of the form $g^a (1 + p)^b $ for which $a \equiv 0 \pod{2}$.  If $p^k = 2$, then everything is a square.  If $p = 2$ and $k \geq 2$, then the squares are the elements of the form $(-1)^a 5^b$ for which $a \equiv 0 \pod{2}$ and $b \equiv 0 \pod{2}$.
\end{example}


\subsection{Characters of finite abelian groups}\label{sec:cj56v04up0}
We recall some basics from \href{20230919T144827--discrete-fourier-transform.pdf}{Sergey's lecture} concerning the discrete Fourier transform.

Let $G$ be a finite abelian group.  A \emph{character} of $G$ is a homomorphism $\chi : G \rightarrow \mathbb{C}^\times$.  Since $G$ is torsion, the image of any character consists of roots of unity, and in particular lies in the subgroup $\U(1) \leq \mathbb{C}^\times$.

We write $\hat{G}$ for the set of characters of $G$.  Equipped with the operation of pointwise multiplication, this set is naturally a finite abelian group.  The identity element of $\hat{G}$ is the trivial character $1 \in \hat{G}$, which assigns the scalar $1$ to each element of $G$.

The groups $G$ and $\hat{G}$ are (non-canonically) isomorphic.  One can see this using the fact that $G$ is isomorphic to a finite product of cyclic groups, together with the following explicit isomorphism in the case of a cyclic group $G = \mathbb{Z} / n$: with $e(x) := e^{2 \pi i x}$, we have
\begin{equation*}
  \mathbb{Z} / n \xrightarrow{\cong } \widehat{\mathbb{Z} / n},
\end{equation*}
\begin{equation*}
  a \mapsto [b \mapsto e (a b / n)].
\end{equation*}

To each $f : G \rightarrow \mathbb{C}$, we associate its \emph{Fourier transform} $\hat{f} : \hat{G} \rightarrow \mathbb{C}$, defined by
\begin{equation*}
  \hat{f}(\chi) := \frac{1}{\lvert G \rvert} \sum_{a \in G} f(a) \chi^{-1}(a).
\end{equation*}
We then have the Fourier inversion formula
\begin{equation*}
  f = \sum_{\chi \in \hat{G}} \hat{f} (\chi) \chi 
\end{equation*}
and the Parseval formula
\begin{equation*}
  \frac{1}{\lvert G \rvert }
  \sum_{a \in G} f_1(a) \overline{f_2(a)}
  = \sum_{\chi \in \hat{G}}
  f_1 (\chi) \overline{f_2 (\chi) }.
\end{equation*}
These may be verified by reduction to the case of cyclic groups, where they follow by summing geometric series.

\subsection{Dirichlet characters}\label{sec:cj57ckezgl}
A \emph{Dirichlet character} $\chi$ modulo $q$ is a character $\chi$ of the group $(\mathbb{Z} / q)^\times $.

It is convenient to identify a character $\chi$ modulo $q$ with the function $\chi : \mathbb{Z} \rightarrow \mathbb{C}$ supported on the integers $a$ coprime to $q$ and given there by $\chi(a) := \chi(a \pod{q})$.

The discussion of \S\ref{sec:cj56v04qkg} and \S\ref{sec:cj56v04up0} makes the Dirichlet characters fairly explicit:
\begin{itemize}
\item Suppose $q$ factors as a product of prime powers $p_i^{a_i}$.  Then any Dirichlet character $\chi$ modulo $q$ factors as a product of Dirichlet characters $\chi_i$, where $\chi_i$ factors through a Dirichlet character modulo $p_i^{a_i}$ via the map $(\mathbb{Z} / q )^\times \rightarrow (\mathbb{Z} / p_i^{a_i })^\times$.
\item Suppose $q = p^k$ for some odd prime $p$ and $k \geq 1$.  Then, via the isomorphism \eqref{eq:cj56v1ftv0}, every Dirichlet character is uniquely of the form
  \begin{equation}\label{eq:cj56v1takk}
    \chi_{\xi, \eta } (g^a (1 + p)^b ) = e \left( \frac{\xi a}{p- 1} + \frac{ \eta b}{p^{k-1}} \right)
  \end{equation}
  for some $(\xi,\eta) \in \mathbb{Z} / (p - 1 ) \times \mathbb{Z} / p^{k - 1}$.
\item The group $(\mathbb{Z} / 2)^\times$ is trivial, so every Dirichlet character modulo $2$ is trivial.
\item Suppose $q = 2^k$ for some $k \geq 2$.  Then, via \ref{sec:cj56v1kjb7}, every Dirichlet character is given by
  \begin{equation*}
    \chi_{\xi, \eta } ((-1)^a 5^b ) = (-1)^{\xi a} e \left( \frac{\eta b}{2^{k - 2}} \right)
  \end{equation*}
  for some $(\xi, \eta ) \in \mathbb{Z} / 2 \times \mathbb{Z} / 2^{k - 2}$.
\end{itemize}

\begin{definition}\label{definition:cj57ckev22}
  We say that a Dirichlet character $\chi$ is \emph{real} or \emph{quadratic} if it takes real values, or equivalently, in view of the identity $\chi(a)^{-1} = \overline{\chi(a)}$, if it satisfies $\chi^2 = 1$.
\end{definition}
\begin{example}\label{example:cj57ckeu1v}
  Suppose $p$ is an odd prime.  The \emph{Legendre symbol} $x \mapsto (x | p)$ is the Dirichlet character modulo $p$ given by taking $\xi = (p-1)/2$ in \eqref{eq:cj56v1takk}, or equivalently, by
  \begin{equation*}
    (x|p) =
    \begin{cases}
      +1 & \text{ if } x \text{ is a square modulo } p, \\
      -1 & \text{ otherwise.}
    \end{cases}
  \end{equation*}
  It is the only nontrivial real character modulo $p$.  Here is a table of the Legendre symbols modulo $7$:
  \begin{equation*}
    \begin{array}{c|ccccccc}
      x & 1 & 2 & 3 & 4 & 5 & 6 \\
      \hline
      (x|7) & +1 & +1 & -1 & +1 & -1 & -1
    \end{array}  
  \end{equation*}
\end{example}
\begin{example}\label{example:cj57cket4w}
  There is one nontrivial character modulo $4$.  It is real, and given by
  \begin{equation}\label{eq:cj57b1cpf8}
    x \mapsto (-1)^{\frac{x-1}{2}}
    =
    \begin{cases}
      +1 & \text{ if } x \equiv 1 \pod{4}, \\
      -1 & \text{ if } x\equiv -1 \pod{4}.
    \end{cases}
  \end{equation}
\end{example}
\begin{example}\label{example:cj57ckes66}
  There are three nontrivial characters modulo $8$.  They are all real, and given either by \eqref{eq:cj57b1cpf8}, by
  \begin{equation}\label{eq:cj57b1d78t}
    x \mapsto (- 1 )^{\frac{x^2 - 1}{8}}
    =
    \begin{cases}
      +1 & \text{ if } x \equiv \pm 1 \pod{8}, \\
      -1 & \text{ if } x \equiv \pm 5 \pod{8},
    \end{cases}
  \end{equation}
  or by the product of \eqref{eq:cj57b1cpf8} and \eqref{eq:cj57b1d78t}.
\end{example}

\begin{remark}\label{remark:cj57ckerd1}
  The nontrivial real characters modulo higher prime powers all factor through some real character modulo $4$, $8$ or an odd prime.  The real characters modulo a composite number factor as products of real characters modulo its prime power factors.
\end{remark}

\subsection{Primitive characters}\label{sec:cj57ckeqfd}
For a divisor $d$ of $q$, we have a natural quotient map of rings $\mathbb{Z} / q \rightarrow \mathbb{Z} / d$, hence a map of unit groups $\pi_{q, d} :  (\mathbb{Z} / q)^\times \rightarrow (\mathbb{Z} / d)^\times $.  This map is surjective.  (In verifying this, we may assume that $q$ is a prime power.  For $d = 1$, we use that $(\mathbb{Z} / q)^\times $ is nontrivial. For $d > 1$, we use that any integer coprime to $d$ is also coprime to $q$.)  Letting $K_{q, d}$ denote its kernel, we obtain a short exact sequence of groups
\begin{equation}\label{eq:cj57cjzbqc}
1 \rightarrow K_{q, d} \rightarrow (\mathbb{Z} / q)^\times \xrightarrow{\pi_{q, d}} (\mathbb{Z} / d)^\times \rightarrow 1.
\end{equation}
We say that a character $\chi$ of $(\mathbb{Z} / q)^\times $ is \emph{induced} by a character $\chi_d$ of $(\mathbb{Z} / d )^\times $ if $\chi = \chi_d \circ \pi_{q, d}$.  Being induced by some character modulo $d$ is equivalent to having trivial restriction to $K_{q, d}$.  We say that a character is \emph{imprimitive} if it is induced from a character modulo $d$ for some proper divisor $d$ of $q$ (where ``proper'' means that $d \neq q$).  Otherwise, we say that a character is \emph{primitive}.  Thus, a character is primitive precisely when it has nontrivial restriction to $K_{q, d}$ for each proper divisor $d$ of $q$.

\begin{exercise}\label{exercise:cj57b3j9bi}
For Dirichlet character $\chi$ modulo $q$, there is a unique divisor $f$ of $q$ and a Dirichlet characters $\chi '$ modulo $f$ so that $\chi$ is induced by $\chi '$.
\end{exercise}
We refer to $f$ as in Exercise \ref{exercise:cj57b3j9bi} as the \emph{conductor} of $\chi$, and denoted it by $C(\chi) := f$.  Thus, a character $\chi$ modulo $q$ is primitive if and only if $C(\chi) = q$.


\subsection{Gauss sums}\label{sec:cj57ckemom}
Given characters $\psi : \mathbb{Z} / q \rightarrow \mathbb{C}^\times$ and $\chi : (\mathbb{Z} / q )^\times \rightarrow \mathbb{C}^\times$, the corresponding \emph{Gauss sum} is defined by
\begin{equation*}
  \tau _\psi (\chi ) := \sum_{a \in (\mathbb{Z} / q )^\times }
  \chi (a) \psi (a).
\end{equation*}
In the special case that $\psi$ is the ``standard'' character
\begin{equation}\label{eq:cj57b8om3u}
  \psi(x) := \exp (2 \pi i x / q),
\end{equation}
we abbreviate $\tau (\chi ) := \tau_\psi (\chi)$.

These sums will arise naturally in our study of the functional equation for Dirichlet $L$-functions.

\begin{remark}\label{remark:cj57ckekc3}
Gauss sums are analogous to the integrals $\Gamma(s) = \int_{\mathbb{R}^+ } y^s e^{- y } \,d^\times y$ defining the $\Gamma$-function, with $\chi$ playing the role of $\mathbb{R}^+ \ni y \mapsto y^s$ and $\psi$ that of $\mathbb{R} \ni y \mapsto e^{-y}$.  
\end{remark}

\begin{theorem}\label{theorem:cj57ckejar}
  Let $\chi$ be a primitive Dirichlet character modulo $q$.  Then
  \begin{equation*}
\lvert \tau(\chi)  \rvert = q^{1/2} 
\end{equation*}
\end{theorem}
\begin{proof}
  We consider the function $f : \mathbb{Z} / q \rightarrow \mathbb{C}$ given by the extension-by-zero of $\chi$:
  \begin{equation*}
    f(a) := 1_{(a, q) = 1} \chi(a).
  \end{equation*}
  We define its Fourier transform $\hat{f} : \mathbb{Z} / q \rightarrow \mathbb{C}$ using the standard character \eqref{eq:cj57b8om3u} to be
  \begin{equation}\label{eq:cj57cjccc4}
    \hat{f}(\xi) := \frac{1}{q} \sum_{a \in \mathbb{Z} / q} f (a) \psi (\xi a).
  \end{equation}
  We then have $q \hat{f}(1) = \tau(\chi)$, so our task is to show that
  \begin{equation*}
    \lvert \hat{f} (1)  \rvert = q^{-1/2}.
  \end{equation*}
  To that end, we will show that
  \begin{equation}\label{eq:cj57cjidbi}
    \lvert f(\xi) \rvert = \lvert f(1) \rvert \quad \text{for } \xi \in (\mathbb{Z} / q)^\times 
  \end{equation}
  and
  \begin{equation}\label{eq:cj57cjmbi7}
    \hat{f}(\xi) = 0 \quad \text{for } \xi \in \mathbb{Z} / q - (\mathbb{Z} / q )^\times .
  \end{equation}
  The claim \eqref{eq:cj57cjidbi} then follows from the Parseval formula, as follows:
  \begin{equation*}
    \frac{\phi(q)}{q}
    =
    \frac{1}{q} \sum_{a \in \mathbb{Z} / q} \lvert f (a)  \rvert^2
    = \sum_{\xi \in \mathbb{Z} / q} \lvert \hat{f} (\xi)  \rvert^2
    = \phi (q) \lvert \hat{f} (1) \rvert^2.
  \end{equation*}

  To verify \eqref{eq:cj57cjidbi}, we apply the invertible substitution $a \mapsto \xi^{-1} a$ in \eqref{eq:cj57cjccc4} and appeal to the multiplicativity property $f (\xi^{-1} a) = \chi (\xi )^{-1} f (a) $ and the unitarity $\lvert \chi (\xi ) \rvert = 1$.

  For \eqref{eq:cj57cjmbi7}, suppose that $\xi \notin (\mathbb{Z} / q)^\times$.  Then $d := q / (q,\xi)$ is a proper divisor of $q$, and for each element $b$ of the subgroup $K_{q, d}$ as in \eqref{eq:cj57cjzbqc}, we have $\xi b \equiv x \pod{q}$, hence $\psi (\xi a b) = \psi (\xi a)$.  Averaging over such identities in \eqref{eq:cj57cjccc4} and substituting $a \mapsto a b^{-1} $ yields
  \begin{equation*}
    \hat{f} (\xi ) = \frac{1}{q \lvert K_{q, d} \rvert}
    \sum_{a \in \mathbb{Z} / q}
    \psi (\xi a)
    \sum_{b \in K_{q, d}}
    f (a b).
  \end{equation*}
  Each term of this inner sum vanishes unless $a \in (\mathbb{Z} / q)^\times$, in which case that inner sum evaluates to
  \begin{equation*}
    \sum_{b \in K_{q,d}} \chi (a b)
    =
    \chi (a) \sum_{b \in K_{q, d}} \chi (b).
  \end{equation*}
  Since $\chi$ is assumed primitive, it has nontrivial restriction to $K_{q,d}$.  By the orthogonality of characters of finite abelian groups (Lemma \ref{lemma:cj579bytue} below), that restriction is thus orthogonal to the trivial character, hence the inner sum vanishes.  We conclude as required that $\hat{f} (\xi ) = 0$.
\end{proof}

\begin{remark}\label{remark:cj57ckegpb}
  The evaluation of $\tau(\chi)$ for non-primitive $\chi$ can be reduced to the primitive case, see for instance \cite[Lemma 3.1]{MR2061214}.
\end{remark}

\begin{lemma}\label{lemma:cj579bytue}
Let $G$ be a finite abelian group. Let $\chi$ be a nontrivial character of $G$.  Then $\sum_{a \in G} \chi (a) = 0$.
\end{lemma}
\begin{proof}
  Choose $b \in G$ so that $\chi(b) \neq 1$.  Then $S := \sum_{a \in G} \chi(a) = \sum_{a \in G} \chi (a b)$, because the map $a \mapsto a b$ defines a permutation of $G$.  Since $\chi(a b) = \chi(a) \chi(b)$, it follows that $S = \chi(b) S$, which forces $S = 0$ because $\chi(b) \neq 1$.  (For example, if $G$ is cyclic, then the sum in question is a geometric series, and the proof amounts to the standard evaluation of that geometric series.)
\end{proof}

\subsection{Basics on Dirichlet $L$-functions}
(Sorry, just writing the notes fast for now; I'll organize all these notes better at some later point.)

For a Dirichlet character $\chi$ modulo $q$ and a complex number $s$, we define the series
\begin{equation*}
L(s,\chi) := \sum_{n = 1 }^\infty \frac{\chi (n) }{ n^s}.
\end{bibliography*}
This series converges absolutely for $\Re(s) > 1$.  Since $\chi$ is multiplicative (i.e., $\chi (m n) = \chi (m) \chi (n)$), we have the Euler product formula
\begin{equation}\label{eq:cj579fpqu8}
L (s, \chi ) = \prod_p \frac{1}{1 - \chi (p) p^{- s}},
\end{equation}
generalizing that for the zeta function.  Here the product over primes can be restricted to $p \nmid q$, because when $p \mid q$, we have $\chi (p) = 0$.


In discussing Dirichlet $L$-functions, we can often reduce to the case of \emph{primitive} Dirichlet characters, using the following simple observation: if $\chi$ modulo $q$ is induced by $\chi '$ modulo $d$, then
\begin{equation*}
  L (s, \chi ) = L (s, \chi ') \prod_{
    \substack{
      p | q  \\
       p \nmid d
    }
  }
  (1 - p^{- s})^{-1}.
\end{equation*}
\begin{example}
  Suppose that $q = 4$.  Then $(\mathbb{Z} / q)^\times \cong \mathbb{Z} / 2$, so there are two Dirichlet characters modulo $q$: the trivial character $\chi_0$ and the nontrivial character $\chi_1$.  We have
  \begin{equation*}
\chi_0(n) =
\begin{cases}
1 &  \text{ if } n \equiv 1  \pod{2}, \\
0 & \text{ if } n \equiv 0 \pod{2},
\end{cases}
  \end{equation*}
  so
  \begin{align*}
    L(s,\chi_0) &= 1 + \frac{1}{ 3^s } + \frac{1}{5^s } + \frac{1}{7^s } + \dotsb \\
    &= \prod_{p \nmid 2} \frac{1}{1 - p^{- s}} = (1 - 2 ^{-s}) \zeta(s).
  \end{align*}
  On the other hand,
  \begin{equation*}
\chi_1 (n) =
\begin{cases}
1 & \text{ if } n \equiv 1 \pod{4}, \\
-1 & \text{ if } n \equiv 3 \pod{4}, \\
0 & \text{ if } n \equiv 0 \pod{2},
\end{cases}
  \end{equation*}
  hence
  \begin{align*}
    L (s, \chi_1 ) &= 1 - \frac{1}{3^s } + \frac{1}{5^s } - \frac{1}{7^s } + \dotsb \\
    &= \prod_{p \nmid 2} \frac{1}{1 - \chi_1(p) p^{- s}} \\
                   &= \frac{1}{1 + 3^{- s}}
                     \frac{1}{1 - 5^{- s}}
                     \frac{1}{1 + 7^{- s}} \frac{1}{1 + {11}^{- s}}
                     \frac{1}{1 - 13^{- s}} \dotsb.                     
\end{align*}
\end{example}


For $\alpha \notin \mathbb{Z}_{\leq 0}$, the Hurwitz zeta function is defined initially for $\Re(s) > 1$ by
\begin{equation*}
\zeta (s,\alpha) := \sum_{n = 0 }^\infty \frac{1}{(n + \alpha  )^s }.
\end{equation*}
For example, the case $\alpha = 1$ recovers the Riemann zeta function.  Using Euler--Maclaurin summation, one can show that the Hurwitz zeta function continues to a meromorphic function on the complex plane that is holomorphic except for a simple pole at $s = 1$ of residue $1$.  For example, to derive this conclusion in the region $\Re(s) > 0$, one can use that
\begin{equation*}
  \zeta(s,\alpha) = \sum_{n = 0 }^\infty 
    \underbrace
    {
      \left(
        \frac{1}{(n + \alpha )^s } - \int_{x = n}^{n + 1} \frac{d x}{(x + \alpha )^s }
          \right)
}_{
 \ll \frac{s}{(\alpha + n)^{\sigma+1}} 
}
  +
  \underbrace
{
\int_0^\infty \frac{d x}{(x + \alpha)^s }
}_{
= \frac{\alpha^{1 - s }}{ s - 1}
}.
\end{equation*}

For a residue class $a \pod{q}$, with representative $a \in \mathbb{Z}$ chosen so that $0 < a \leq q$, we have
\begin{equation}\label{eq:cj579fmwo8}
  \sum_{
    \substack{
      n = 1  \\
       n \equiv a(q)
    }
  }^\infty \frac{1}{ n^s }
  =
  \sum_{n = 0 }^\infty \frac{1}{(a + q n)^s }
  =
  q^{- s} \zeta\left(s, \frac{a}{q}\right),
\end{equation}
thus for a Dirichlet character $\chi$ modulo $q$,
\begin{equation}\label{eq:cj579b0max}
L(s,\chi) = q^{- s} \sum_{a(q)^*} \chi (a) \zeta \left( s, \frac{a}{q} \right).
\end{equation}
It follows that $L (s, \chi)$ admits a meromorphic continuation to the complex plane whose only possible pole is a simple one at $s= 1$ of residue
\begin{equation*}
q^{- 1} \sum_{a (q) ^*} \chi (a).
\end{equation*}
If $\chi$ is not the trivial character modulo $q$, then the above sum vanishes (Lemma \ref{lemma:cj579bytue}), so $L(s, \chi)$ is in fact holomorphic on the entire complex plane.

We see also from \eqref{eq:cj579b0max}, as in Lemma \ref{lemma:cj56e5ibho}, that for $\Re(s) \geq \eps > 0$, we have
\begin{equation*}
  L (s, \chi ) \ll_{\eps} \left( q (3 + \lvert s \rvert) \right).
\end{equation*}
Using this estimate, we obtain modified forms of the factorization properties established in Proposition \ref{proposition:cj41z9de5r} and Lemma \ref{lemma:cj42xpd5qe}.  Sergey will discuss these points in detail over the coming weeks.  In any event, one reason we often work with the Dirichlet $L$-functions $L(s,\chi)$ rather than the Hurwitz zeta functions as in \eqref{eq:cj579fmwo8} (despite the fact that their spans are similar) is that the multiplicativity of the coefficients yields the Euler product \eqref{eq:cj579fpqu8}, hence a way to say something about prime numbers.

The functional equation comes again from Poisson summation, but now taken modulo $q$.  Recall the usual Poisson summation formula: for a Schwartz function $f$ on $\mathbb{R}$,
\begin{equation*}
\sum_{n \in \mathbb{Z} } f (n) = \sum_{n \in \mathbb{Z} } \hat{f} (n),
\end{equation*}
where
\begin{equation*}
  \hat{f} (\xi ) := \int_{x \in \mathbb{R} } f (x) e (- x \xi ) \, d x,
  \qquad
  e(x) := e^{2 \pi i x}.
\end{equation*}
For an arithmetic progression $a \pod {q}$, we can apply the Poisson summation formula to the Schwartz function $x \mapsto f (a + q x)$ to see that
\begin{align*}
  \sum_{
  \substack{
  n \in \mathbb{Z} :  \\
  n \equiv a (q)
  }
  }
  f (n)
  &=
    \sum_{n \in \mathbb{Z} } f (a + q n)
  \\
  &= \sum_{n \in \mathbb{Z} } \int_{x \in \mathbb{R} } e (- n x ) f (a + q x) \, d x \\
  &= \frac{1}{q} \sum_{n \in \mathbb{Z} }
    e \left( \frac{a n }{q} \right)
    \int_{x \in \mathbb{R} } e \left(- \frac{n x}{q} \right) f (x) \, d x   \\
  &= \frac{1}{q} \sum_{n \in \mathbb{Z} }
    e \left( \frac{a n }{q} \right)
    \hat{f} \left( \frac{n}{q} \right).
\end{align*}

More generally, for any $f _\infty \in \mathcal{S} (\mathbb{R} )$ and $f_q : \mathbb{Z} / q \rightarrow \mathbb{C} $, we have
\begin{equation}\label{eq:cj579gae8a}
  \sum_{n \in \mathbb{Z} } f _\infty (n) f_q (n)
  = \frac{1}{q^{1/2} } \sum_{n \in \mathbb{Z} } \hat{f} _\infty \left( \frac{n}{q} \right) \hat{f}_q (n),
\end{equation}
where
\begin{equation*}
\hat{f}_q (n) := \frac{1}{ q^{1/2} } \sum_{b \in \mathbb{Z} / q} e \left( \frac{b n}{q} \right) f_q (b).
\end{equation*}
(Indeed, the general case of \eqref{eq:cj579gae8a} reduces to the special case where $f_q$ is the characteristic function of $a \pod{q}$, in which case it reduces to the formula given above.)

\begin{remark}\label{remark:cj579g6qey}
  Another way to write \eqref{eq:cj579gae8a} is as follows.  Set $\mathcal{F} f _\infty := \hat{f}_\infty$ as before, and define $\mathcal{F} f_q : q^{-1} \mathbb{Z} / \mathbb{Z} \rightarrow \mathbb{C}$ by
  \begin{equation*}
    \mathcal{F} f_q (b) := \frac{1}{q} \sum_{a \in \mathbb{Z} / q \mathbb{Z} } f_q(a) e(a b).
  \end{equation*}
  Then
  \begin{equation*}
    \sum_{n \in \mathbb{Z} } f _\infty (n) f_q (n)
    = \sum_{n \in q^{-1} \mathbb{Z} } \mathcal{F} f _\infty  (n) \mathcal{F} f_q (n).
  \end{equation*}
\end{remark}
\begin{remark}\label{remark:cj579g6sq5}
More generally, let $q_1, q_2$ be natural numbers.  Then the above discussion applies to $f_\infty \in \mathcal{S}(\mathbb{R})$ and $f_{\fin} : q_1^{-1} \mathbb{Z} / q_2 \mathbb{Z} \rightarrow \mathbb{C}$, where we define $\mathcal{F} f_{\fin} : q_2^{-1} \mathbb{Z} / q_1 \mathbb{Z} \rightarrow \mathbb{C}$ by
  \begin{equation*}
    \mathcal{F} f_{\fin} (b) :=
    \frac{1}{q_2 } \sum_{a \in q_1^{-1} \mathbb{Z} / q_2 \mathbb{Z} } f_{\fin} (a ) e (a b).
  \end{equation*}
  Then
  \begin{equation}\label{eq:cj579g2o7i}
    \sum_{n \in q_1^{-1} \mathbb{Z} } f _\infty (n) f_{\fin} (n)
    = \sum_{n \in q_2 ^{-1} \mathbb{Z} } \mathcal{F} f _\infty  (n) \mathcal{F} f_{\fin} (n).
  \end{equation}
\begin{remark}\label{remark:cj579g604l}
  One can package all of the identities \eqref{eq:cj579g2o7i} together by introducing the adele ring, which may be defined by taking an inverse limit over $q_2$ and then a direct limit over $q_1$, each ordered by divisibility:
  \begin{equation*}
\mathbb{A} := \mathbb{R} \times \varinjlim_{q_1 } \varprojlim_{q_2 } q_1^{-1} \mathbb{Z}  / q_2 \mathbb{Z}.
  \end{equation*}
  It comes with a Schwartz space $\mathcal{S}(\mathbb{A})$, which is spanned by the functions $(x, y) \mapsto f _\infty (x) f_{\fin} (y)$ arising in the above discussion, as well as a Fourier transform $\mathcal{F}$ extending that considered above.  The general form of \eqref{eq:cj579g2o7i} is then that for $f \in \mathcal{S}(\mathbb{A})$, one has
  \begin{equation*}
\sum_{n \in \mathbb{Q} } f (n) = \sum_{n \in \mathbb{Q} } \mathcal{F} (n).
  \end{equation*}
  For details, see any reference on the adeles and Tate's thesis (e.g., \cite{MR1680912}).
\end{remark}

\begin{example}
  Let
  \begin{equation*}
    f_q(n) = 1_{(n, q) = 1} \chi (n)
  \end{equation*}
  be a primitive Dirichlet character $\chi$ modulo $q$ extended by zero to all of $\mathbb{Z} / q$, as usual.  In that case, we see by the proof of Theorem \ref{theorem:cj57ckejar} that
  \begin{equation*}
    \hat{f}_q (n) = 1_{(n,q) = 1} \frac{\tau(\chi) }{ q^{1/2} } \chi^{-1} (n),
  \end{equation*}
  so \eqref{eq:cj579gae8a} specializes to: for each $f \in \mathcal{S}(\mathbb{R})$,
  \begin{equation}\label{eq:cj579g9hcr}
    \sum_{n \in \mathbb{Z} } f (n) \chi (n) = \frac{\tau(\chi )}{ q } \sum_{n \in \mathbb{Z} } \hat{f} \left( \frac{n}{q} \right) \chi^{-1} (n).
  \end{equation}
\end{example}

The identity \eqref{eq:cj579g9hcr} yields the functional equation for the Dirichlet $L$-functions, as we now explain.

\begin{definition}\label{definition:cj579hfk0m}
We say that $\chi$ is \emph{even} (resp.\ \emph{odd}) if $\chi(-1) = 1$ (resp.\ $\chi(-1) = -1$).
\end{definition}

To see this, let us first introduce a dilation factor $y > 0$.  TODO: finish writing this up.






\equation{refs}{} \bibliographystyle{plain}
\end{document}

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Yueke Hu" />
  <meta name="author" content="Paul D. Nelson" />
  <title>Subconvex bounds for U_{n+1}\times U_n in horizontal aspects</title>
  <link rel="stylesheet" href="tex.css">
  <style>
      .my-links-container {
        position: absolute;
        top: 0;
        right: 0;
        padding-right: 20px;
        padding-top: 10px;
      }
      .my-link {
        margin-left: 10px;
      }
      .my-links-container-2 { /* new CSS class for the second row */
        position: absolute;
        top: 40px; /* adjust this value based on the height of your links */
        right: 0;
        padding-right: 20px;
      }
      .my-link-2 {
        margin-left: 10px;
      }

    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    div.abstract {
      margin: 2em 2em 2em 2em;
      text-align: left;
      font-size: 85%;
    }
    div.abstract-title {
      font-weight: bold;
      text-align: center;
      padding: 0;
      margin-bottom: 0.5em;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
    <div class="my-links-container">
2023-09-13 08:00:08
      <a href="p-squared.tex" class="my-link">tex</a>
      <a href="p-squared.pdf" class="my-link">pdf</a>
      <a href="https://github.com/ultronozm/math/commits/main/p-squared.tex" class="my-link">history</a>
      <a href="." class="my-link">home</a>
    </div>
<header id="title-block-header">
<h1 class="title">Subconvex bounds for <span
class="math inline">\(U_{n+1}\times U_n\)</span> in horizontal
aspects</h1>
<p class="author">Yueke Hu</p>
<p class="author">Paul D. Nelson</p>
<div class="abstract">
<div class="abstract-title">Abstract</div>
<p>For <span class="math inline">\(L\)</span>-functions attached to
automorphic representations of unitary groups <span
class="math inline">\(U_{n+1}\times U_n\)</span>, we establish a
subconvex bound valid in certain horizontal aspects, where the set of
ramified places is allowed to vary.</p>
</div>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a>
<ul>
<li><a href="#overview" id="toc-overview">Overview</a></li>
<li><a href="#sec:cj3siudn3c" id="toc-sec:cj3siudn3c">The refined
Gan–Gross–Prasad conjectures</a></li>
<li><a href="#sec:cj4vjf3x2x" id="toc-sec:cj4vjf3x2x">Main
result</a></li>
<li><a href="#sec:cj3v663hcw" id="toc-sec:cj3v663hcw">Some
details</a></li>
<li><a href="#sec:cj4vjryk3u" id="toc-sec:cj4vjryk3u">Related
results</a></li>
<li><a href="#sec:cj4vjf3iqs" id="toc-sec:cj4vjf3iqs">Division of the
proof</a></li>
<li><a href="#sec:cj3ubuyr8u" id="toc-sec:cj3ubuyr8u">Geometric
estimates: the uniform volume bound</a></li>
<li><a href="#sec:cj4t647ljn" id="toc-sec:cj4t647ljn">The approach of
this paper</a></li>
<li><a href="#sec:cj4t64wm4h" id="toc-sec:cj4t64wm4h">Available
treatment in the depth aspect</a>
<ul>
<li><a href="#the-short-spectral-projector-omega"
id="toc-the-short-spectral-projector-omega">The short spectral projector
<span class="math inline">\(\omega\)</span></a></li>
<li><a href="#reductions" id="toc-reductions">Reductions</a></li>
<li><a href="#sec:cj4t69an73" id="toc-sec:cj4t69an73">The near-identity
reduction</a></li>
</ul></li>
<li><a href="#organization-of-this-paper"
id="toc-organization-of-this-paper">Organization of this paper</a></li>
<li><a href="#acknowledgment"
id="toc-acknowledgment">Acknowledgment</a></li>
</ul></li>
<li><a href="#sec:notation" id="toc-sec:notation">Notation</a>
<ul>
<li><a href="#sec:vectors-matrices"
id="toc-sec:vectors-matrices">Vectors and matrices</a></li>
<li><a href="#sec:general-linear-ggp-pairs"
id="toc-sec:general-linear-ggp-pairs">General linear GGP pairs</a></li>
<li><a href="#centralizers" id="toc-centralizers">Centralizers</a></li>
<li><a href="#sec:local-fields-congruence-subgroups"
id="toc-sec:local-fields-congruence-subgroups">Local fields and
congruence subgroups</a></li>
</ul></li>
<li><a href="#sec:cyclic-matrices" id="toc-sec:cyclic-matrices">Cyclic
matrices</a></li>
<li><a href="#sec:20230514080526"
id="toc-sec:20230514080526">Stability</a></li>
<li><a href="#sec:transversality"
id="toc-sec:transversality">Transversality</a>
<ul>
<li><a href="#sec:transversality-statement-results"
id="toc-sec:transversality-statement-results">Statement of
results</a></li>
<li><a href="#Sec:polyEqn" id="toc-Sec:polyEqn">Defining <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> by polynomial
equations</a></li>
<li><a href="#sec:reduction-centralizer"
id="toc-sec:reduction-centralizer">Reduction to the centralizer</a></li>
<li><a href="#sec:analysis-first-derivatives"
id="toc-sec:analysis-first-derivatives">Linear analysis</a></li>
<li><a href="#sec:analysis-second-derivatives"
id="toc-sec:analysis-second-derivatives">Quadratic analysis</a></li>
</ul></li>
<li><a href="#sec:volumebound" id="toc-sec:volumebound">Volume
bounds</a>
<ul>
<li><a href="#sec:cj3v60uw7y" id="toc-sec:cj3v60uw7y">Bounds for
polynomial congruences</a></li>
<li><a href="#sec:norms-distance-functions"
id="toc-sec:norms-distance-functions">Norms and distance
functions</a></li>
<li><a href="#miscellaneous-lemmas"
id="toc-miscellaneous-lemmas">Miscellaneous lemmas</a></li>
<li><a href="#sec:cj3v60wplb" id="toc-sec:cj3v60wplb">Main
result</a></li>
</ul></li>
<li><a href="#Sec:bilinear" id="toc-Sec:bilinear">Bilinear forms
estimates</a></li>
<li><a href="#sec:part-body-paper"
id="toc-sec:part-body-paper">Construction of test vectors</a>
<ul>
<li><a href="#sec:20230516194628"
id="toc-sec:20230516194628">Overview</a></li>
<li><a href="#sec:characters-in-construction-test-vectors"
id="toc-sec:characters-in-construction-test-vectors">Characters</a></li>
<li><a href="#sec:centralizers-characters-J-tau"
id="toc-sec:centralizers-characters-J-tau">Centralizers of
characters</a></li>
<li><a href="#sec:regular-uniform-representations"
id="toc-sec:regular-uniform-representations">Preliminary lemmas
regarding regular parameters</a></li>
<li><a href="#sec:cj3m0c59nb" id="toc-sec:cj3m0c59nb">Some linear
algebra</a></li>
<li><a href="#sec:cj3m0c6a7b" id="toc-sec:cj3m0c6a7b">Parabolic
induction</a></li>
<li><a href="#sec:cj3m0c6cif" id="toc-sec:cj3m0c6cif">Stable pairs of
representations</a></li>
<li><a href="#sec:supercuspidals"
id="toc-sec:supercuspidals">Supercuspidals</a></li>
</ul></li>
<li><a href="#sec:mainlocal" id="toc-sec:mainlocal">Main local
result</a>
<ul>
<li><a href="#statement-of-result"
id="toc-statement-of-result">Statement of result</a></li>
<li><a href="#sec:20230517161735" id="toc-sec:20230517161735">Stability
and matrix coefficients</a></li>
<li><a href="#sec:cj4t6ynizh" id="toc-sec:cj4t6ynizh">Setup for the
proof</a></li>
<li><a href="#sec:proof-main-local-compact"
id="toc-sec:proof-main-local-compact">The proof</a></li>
</ul></li>
<li><a href="#Sec:final" id="toc-Sec:final">Completion of the
proof</a></li>
</ul>
</nav>
<h1 id="introduction">Introduction</h1>
<h2 id="overview">Overview</h2>
<p>This paper concerns the quantitative analysis of automorphic <span
class="math inline">\(L\)</span>-functions on higher rank classical
groups. Recent works on this topic include</p>
<ul>
<li><p>an approach to the analytic test vector problem based on the
orbit method, applied to the asymptotic evaluations of moments
(see <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(Nelson and
Venkatesh 2021)</a>), and</p></li>
<li><p>subconvex bounds on <span
class="math inline">\({\mathop{\mathrm{U}}}_{n+1} \times
{\mathop{\mathrm{U}}}_n\)</span> and <span
class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> (see <a href="#ref-2020arXiv201202187N 2021arXiv210915230N"
class="citation"
data-cites="2020arXiv201202187N 2021arXiv210915230N">(Nelson 2023,
2021)</a> and announcement talks of Marshall).</p></li>
</ul>
<p>These works study sequences of automorphic forms whose ramification
increases inside some <em>fixed</em> finite set of places, a setup known
as the <em>depth</em> aspect.</p>
<p>By a <em>horizontal</em> aspect, we mean one where the set of
ramified places is itself allowed to vary. For example, one can study
Dirichlet characters of conductor <span
class="math inline">\(p^m\)</span> for fixed <span
class="math inline">\(p\)</span> as <span class="math inline">\(m
\rightarrow \infty\)</span> (depth) and for fixed <span
class="math inline">\(m\)</span> as <span class="math inline">\(p
\rightarrow \infty\)</span> (horizontal).</p>
<p>This paper establishes subconvex bounds on <span
class="math inline">\(U_{n +1} \times U_n\)</span> in certain horizontal
aspects. Our results are uniform enough to apply also in the depth
aspect (indeed, as “<span class="math inline">\(p^m \rightarrow
\infty\)</span>”), but this is not the main novelty.</p>
<p>The depth aspect often has a Lie-algebraic flavor, involving tools
such as stationary phase analysis and Taylor approximation. For
instance, the works noted above make heavy use of the exponential map
and Lie algebra for groups such as <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(F)\)</span>, with <span
class="math inline">\(F\)</span> a fixed local field. These techniques
are applied to spectral problems (construction and analysis of test
vectors) and geometric problems (the “volume bound”).</p>
<p>In horizontal aspects, Lie-algebraic techniques are often less
relevant. For this paper, we restrict to “even depth” cases (“<span
class="math inline">\(p^{2 m}\)</span>”) where the spectral analysis can
still be carried out using Lie-algebraic techniques, but the geometric
analysis requires new arguments, of algebro-geometric rather than
Lie-algebraic flavor.</p>
<p>We now describe our main result (Theorem <a
href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>) and the
main ideas of its proof, emphasizing new features encountered in
horizontal aspects.</p>
<h2 id="sec:cj3siudn3c">§1.2. The refined Gan–Gross–Prasad conjectures</h2>
<p>These conjectures, now known in many cases, provide a link between
values of <span class="math inline">\(L\)</span>-functions and integrals
of automorphic forms. The body of this paper addresses the local
problems that arise in estimating such integrals. The link described
here is not otherwise applied in this paper, but provides context for
interpreting our results.</p>
<p>Let <span class="math inline">\(F\)</span> be a number field with
adele ring <span class="math inline">\(\mathbb{A}\)</span>, let <span
class="math inline">\(E/F\)</span> be a quadratic extension, let <span
class="math inline">\(V\)</span> be an <span
class="math inline">\((n+1)\)</span>-dimensional hermitian space over
<span class="math inline">\(E\)</span>, and let <span
class="math inline">\(W\)</span> be an <span
class="math inline">\(n\)</span>-dimensional nondegenerate subspace of
<span class="math inline">\(V\)</span>. Define the pair of unitary
groups <span class="math inline">\((G,H) := (\mathop{\mathrm{U}}(V),
\mathop{\mathrm{U}}(W))\)</span> over <span
class="math inline">\(F\)</span>. Given a pair of cuspidal automorphic
representations <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> of <span
class="math inline">\(G\)</span> and <span
class="math inline">\(H\)</span> that are locally distinguished, one may
attach a branching coefficient <span
class="math inline">\(\mathcal{L}(\pi,\sigma)\)</span> quantifying how
automorphic forms in <span class="math inline">\(\pi\)</span> correlate
against those in <span class="math inline">\(\sigma\)</span>. The
definition depends upon the choice of a finite set <span
class="math inline">\(S\)</span> of places of <span
class="math inline">\(F\)</span>, taken large enough to contain every
place that is archimedean or at which <span
class="math inline">\(\pi\)</span> or <span
class="math inline">\(\sigma\)</span> is ramified, and requires <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> to be (nearly) tempered inside
<span class="math inline">\(S\)</span>. It is characterized by the
following family of identities: for all <span class="math inline">\(v
\in \pi\)</span> and <span class="math inline">\(u \in \sigma\)</span>
that are unramified outside <span class="math inline">\(S\)</span>, and
with suitable normalization of measure, <span id="eq:cj3tfrrhlc" class="math display">\[\label{eq:cj3tfrrhlc}\tag{1.1}
  \left\lvert \int_{H(F) \backslash H(\mathbb{A})} v \bar{u}
   \right\rvert^2
   =
   \mathcal{L}(\pi, \sigma)
  \int_{H(F_S)} \langle h v, v   \rangle \langle u, h u \rangle \, d
h.\]</span> We refer to <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 3.7)</a> for
further details. It has been conjectured by Ichino–Ikeda <a href="#ref-MR2585578"
class="citation" data-cites="MR2585578">(Ichino and Ikeda 2010)</a>
and N. Harris <a href="#ref-MR3159075" class="citation" data-cites="MR3159075">(Harris
2014)</a> that if <span class="math inline">\(S\)</span> is large
enough in the sense recorded in <a href="#ref-MR2585578" class="citation"
data-cites="MR2585578">(Ichino and Ikeda 2010, sec. 1)</a>, then
<span class="math inline">\(\mathcal{L}(\pi,\sigma)\)</span> is given by
a ratio of <span class="math inline">\(L\)</span>-values, namely, with
notation as in <a href="#ref-MR4426741" class="citation"
data-cites="MR4426741">(Beuzart-Plessis, Chaudouard, and Zydor
2022)</a>, <span id="eqn:20230517061322" class="math display">\[\label{eqn:20230517061322}\tag{1.2}
  \mathcal{L}(\pi,\sigma)
  =
  2^{- \beta}
  \frac{L^{(S)}(\pi_E
\otimes  \sigma_E^{\vee},1/2)}{L^{(S)}(\mathop{\mathrm{Ad}}, \pi
\boxtimes {\sigma}^{\vee},1)}
  \Delta_G^{(S)}.\]</span> This expectation has been proved at least
when <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> are tempered at all places <a href="#ref-MR4426741"
class="citation" data-cites="MR4426741">(Beuzart-Plessis, Chaudouard,
and Zydor 2022)</a>.</p>
<h2 id="sec:cj4vjf3x2x">§1.3. Main result</h2>
<p>We establish a subconvex bound on <span
class="math inline">\({\mathop{\mathrm{U}}}_{n+1} \times
{\mathop{\mathrm{U}}}_n\)</span>, with <span
class="math inline">\({\mathop{\mathrm{U}}}_n\)</span> anisotropic, for
pairs <span class="math inline">\((\pi,\sigma)\)</span> whose
ramification concentrates at some (varying) finite place <span
class="math inline">\(\mathfrak{p}\)</span>, provided that the conductor
does not drop, under some local assumptions (e.g., principal series of
even depth). In more detail:</p>
<div id="itemize:cj3ubog35g" class="theorem">
<p><strong>Theorem 1</strong>. <em><span id="theorem:cj3ngw7u2s"
label="theorem:cj3ngw7u2s"></span> Fix <span class="math inline">\(F, E,
G, H\)</span> as in §<a href="#sec:cj3siudn3c" data-reference-type="ref"
data-reference="sec:cj3siudn3c">1.2</a>, as well as a finite set <span
class="math inline">\(S\)</span> of of places of <span
class="math inline">\(F\)</span>, large enough in the sense specified
in <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(Nelson 2023,
sec. 3.6)</a>. Let <span class="math inline">\(\mathcal{F}\)</span>
be a family of tuples <span class="math inline">\((\pi,\sigma,
\mathfrak{p}, \mathfrak{q})\)</span> satisfying the following
conditions:</em></p>
<ol type="a">
<li><p><em><span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> are cuspidal automorphic
representations of <span class="math inline">\(G\)</span> and <span
class="math inline">\(H\)</span>, respectively, having unitary central
characters.</em></p></li>
<li><p><em><span class="math inline">\(\mathfrak{p} \notin S\)</span> is
a non-archimedean place (or prime ideal) of <span
class="math inline">\(F\)</span> at which <span
class="math inline">\(E/F\)</span> splits, so that (see <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, sec.
3.3)</a>) <span class="math display">\[(G(F_\mathfrak{p}),
H(F_\mathfrak{p})) \cong ({\mathop{\mathrm{GL}}}_{n+1}(F_\mathfrak{p}),
{\mathop{\mathrm{GL}}}_n(F_\mathfrak{p})).\]</span></em></p></li>
<li><p><em><span class="math inline">\((\pi,\sigma)\)</span> is locally
distinguished: there is a nonzero <span
class="math inline">\(H(\mathbb{A})\)</span>-invariant functional <span
class="math inline">\(\pi \rightarrow \sigma\)</span>.</em></p></li>
<li><p><em>Inside <span class="math inline">\(S\)</span>, the
representations <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> are tempered, and their depth is
uniformly bounded as <span class="math inline">\((\pi,\sigma)\)</span>
traverses <span class="math inline">\(\mathcal{F}\)</span> (see <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, sec.
1.3)</a>).</em></p></li>
<li><p><em>Outside <span class="math inline">\(S \cup \{\mathfrak{p}
\}\)</span>, the representations <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> are unramified, and <span
class="math inline">\(\sigma\)</span> satisfies a uniform bound towards
Ramanujan at places where <span class="math inline">\(E/F\)</span>
splits: it is <span class="math inline">\(\vartheta\)</span>-tempered at
such places for some fixed <span class="math inline">\(0 \leq \vartheta
&lt; 1/2\)</span> (see <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec.
5.2.1)</a>).</em></p></li>
<li><p><em><span class="math inline">\(\mathfrak{q}\)</span> is a
positive power of the prime ideal <span
class="math inline">\(\mathfrak{p}\)</span>.</em></p></li>
<li><p><em>At <span class="math inline">\(\mathfrak{p}\)</span>, the
representations <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> belong to the principal series and
are induced by characters of conductor dividing <span
class="math inline">\(\mathfrak{q}^2\)</span> for which the local
analytic conductor for <span
class="math inline">\(\mathcal{L}(\pi,\sigma)\)</span> at <span
class="math inline">\(\mathfrak{p}\)</span> is as large as possible
(see <a href="#eqn:cj2dzunqa6" data-reference-type="eqref"
data-reference="eqn:cj2dzunqa6">\((1.6)\)</a> for details, and
Remark <a href="#remark:cj3u9047n5" data-reference-type="ref"
data-reference="remark:cj3u9047n5">1.6</a> for weaker allowable
hypotheses).</em></p></li>
</ol>
<p><em>Assume that <span class="math inline">\(V\)</span> (hence also
<span class="math inline">\(W\)</span>) is positive-definite. In
particular, <span class="math inline">\(H\)</span> is anisotropic, and
at each archimedean place of <span class="math inline">\(F\)</span>, the
groups <span class="math inline">\(G\)</span> and <span
class="math inline">\(H\)</span> are compact.</em></p>
<p><em>Then the branching coefficients <span
class="math inline">\(\mathcal{L}(\pi,\sigma)\)</span>, defined relative
to the set <span class="math inline">\(S \sqcup \{\mathfrak{p}
\}\)</span>, satisfy a subconvex bound (see <a href="#eq:cj3tfrulcn"
data-reference-type="eqref"
data-reference="eq:cj3tfrulcn">\((1.8)\)</a> and <a
href="#eq:cj3ubs6lvw" data-reference-type="eqref"
data-reference="eq:cj3ubs6lvw">\((1.9)\)</a>) as <span
class="math inline">\((\pi,\sigma)\)</span> varies over the family <span
class="math inline">\(\mathcal{F}\)</span>.</em></p>
</div>
<h2 id="sec:cj3v663hcw">§1.4. Some details</h2>
<p>Here we clarify the statement of Theorem <a
href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>. We may
write the local components at the “interesting” place <span
class="math inline">\(\mathfrak{p}\)</span> as the normalized inductions
<span id="eqn:cj2dzujg9c" class="math display">\[\label{eqn:cj2dzujg9c}\tag{1.3}
  \pi_\mathfrak{p}= \chi_1 \boxplus \dotsb \boxplus \chi_{n+1}, \qquad
\sigma_\mathfrak{p}= \eta_1 \boxplus \dotsb \boxplus \eta_n\]</span> for
some characters <span class="math inline">\(\chi_i\)</span> and <span
class="math inline">\(\eta_j\)</span> of <span
class="math inline">\(F_\mathfrak{p}^\times\)</span>. For a character
<span class="math inline">\(\omega\)</span> of <span
class="math inline">\(F_\mathfrak{p}^\times\)</span>, we denote by <span
class="math inline">\(C(\omega)\)</span> the analytic conductor, i.e.,
the absolute norm of the largest integral ideal <span
class="math inline">\(\mathfrak{a}\)</span> in <span
class="math inline">\(F_\mathfrak{p}\)</span> such that <span
class="math inline">\(\omega(x) = 1\)</span> whenever <span
class="math inline">\(x - 1 \in \mathfrak{a}\)</span>. We set <span id="eq:cj3ubsuj6v" class="math display">\[\label{eq:cj3ubsuj6v}\tag{1.4}
T := \text{the absolute norm of } \mathfrak{q}^2.\]</span> With this
notation, the “depth <span
class="math inline">\(\mathfrak{q}^2\)</span>” assumption means <span id="eqn:20230516205128" class="math display">\[\label{eqn:20230516205128}\tag{1.5}
  C(\chi_i) \leq T, \qquad
  C(\eta_j) \leq T,\]</span> while “conductor as large as possible”
means <span id="eqn:cj2dzunqa6" class="math display">\[\label{eqn:cj2dzunqa6}\tag{1.6}
  \prod_{i, j} {C(\chi_i/\eta_j)}^2 = T^{2 n(n+1)},\]</span> which is
equivalent to requiring that for all <span
class="math inline">\(i\)</span> and <span
class="math inline">\(j\)</span>, <span id="eqn:cj3ngvwrm4" class="math display">\[\label{eqn:cj3ngvwrm4}\tag{1.7}
  C(\chi_i / \eta_j) = T.\]</span> We note that this forces <span
class="math inline">\(T\)</span> to be the maximum of the <span
class="math inline">\(C(\chi_i)\)</span> and <span
class="math inline">\(C(\eta_j)\)</span>. “Subconvex bound” means that
<span id="eq:cj3tfrulcn" class="math display">\[\label{eq:cj3tfrulcn}\tag{1.8}
  \mathcal{L}(\pi,\sigma) \leq c_{\mathcal{F}} T^{2 n (n + 1)(1/4 -
\delta_n)}\]</span> for some <span class="math inline">\(c
_{\mathcal{F}} \geq 0\)</span> (resp. <span
class="math inline">\(\delta_n &gt; 0\)</span>) depending only upon
<span class="math inline">\(\mathcal{F}\)</span> (resp. <span
class="math inline">\(n\)</span>). In cases where <span
class="math inline">\(\mathcal{L}(\pi,\sigma)\)</span> is known to
coincide with an <span class="math inline">\(L\)</span>-value (e.g., the
case that <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> are everywhere tempered), the
estimate <a href="#eq:cj3tfrulcn" data-reference-type="eqref"
data-reference="eq:cj3tfrulcn">\((1.8)\)</a> improves upon the
convexity bound, which would assert the same for some <span
class="math inline">\(\delta_n \leq 0\)</span> (see <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, Proof of
Cor 1.2)</a> for details). In the case <span
class="math inline">\(n+1 = 2\)</span>, such an estimate has been known
for a while <a href="#ref-michel-2009" class="citation" data-cites="michel-2009">(Michel and
Venkatesh 2010)</a>. When <span class="math inline">\(n+1 \geq
3\)</span>, such an estimate is new; we will show then that <a
href="#eq:cj3tfrulcn" data-reference-type="eqref"
data-reference="eq:cj3tfrulcn">\((1.8)\)</a> holds for any <span id="eq:cj3ubs6lvw" class="math display">\[\label{eq:cj3ubs6lvw}\tag{1.9}
  \delta_n &lt; \frac{1 - 2 \vartheta }{4 n(n+1) (A + 1 - 2 \vartheta
)},
  \quad
  A := (2 {(n + 1 )}^2 - n) (n + 1),\]</span> with <span
class="math inline">\(\vartheta\)</span> as in assumption <a
href="#itemize:cj3ubog35g" data-reference-type="eqref"
data-reference="itemize:cj3ubog35g">\((e)\)</a> above (and
<span class="math inline">\(c_\mathcal{F}\)</span> allowed to depend
upon <span class="math inline">\(\delta_n\)</span>).</p>
<div id="remark:cj3u9049bv" class="remark">
<p><strong>Remark 2</strong>. We do not address the interesting
challenge of improving the numerical strength of the exponent <a
href="#eq:cj3ubs6lvw" data-reference-type="eqref"
data-reference="eq:cj3ubs6lvw">\((1.9)\)</a>. Several avenues for
doing so were mentioned in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, Rmk 1.4)</a>, many of
which could be pursued in the present context.</p>
</div>
<div id="remark:cj3u9062fs" class="remark">
<p><strong>Remark 3</strong>. The “large conductor” assumption <a
href="#eqn:cj2dzunqa6" data-reference-type="eqref"
data-reference="eqn:cj2dzunqa6">\((1.6)\)</a> is the most serious
one — it is an open problem to give any genuine subconvex bound for
<span class="math inline">\({\mathop{\mathrm{GL}}}_3\)</span> or higher in
any case where the conductor drops (see the final paragraph of <a href="#ref-2021arXiv210915230N"
class="citation" data-cites="2021arXiv210915230N">(Nelson 2021, sec.
1.4)</a> and references).</p>
</div>
<h2 id="sec:cj4vjryk3u">§1.5. Related results</h2>
<p>In talks starting in March 2018, Simon Marshall tentatively announced
results in the direction of Theorem <a href="#theorem:cj3ngw7u2s"
data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>,
introducing important and fundamental ideas, under some additional
assumptions:</p>
<ol type="i">
<li><p><span id="enumerate:20230516210021"
label="enumerate:20230516210021"></span> (Wall-avoidance) For all <span
class="math inline">\(i \neq j\)</span>, one has <span
class="math display">\[C(\chi_i / \chi_j) = T, \qquad C(\eta_i / \eta_j)
= T.\]</span></p></li>
<li><p><span id="enumerate:20230516210903"
label="enumerate:20230516210903"></span> (Depth aspect) <span
class="math inline">\(\mathfrak{p}\)</span> is a <em>fixed</em> (i.e.,
independent of <span class="math inline">\(\mathcal{F}\)</span>)
non-archimedean place.</p></li>
</ol>
<p>An important input to his arguments is a certain <em>volume
bound</em> (see §<a href="#sec:cj3ubuyr8u" data-reference-type="ref"
data-reference="sec:cj3ubuyr8u">1.7</a> and <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 1.5)</a>), which
Marshall announces he can establish assuming <a
href="#enumerate:20230516210021" data-reference-type="eqref"
data-reference="enumerate:20230516210021">\((i)\)</a>
and <a href="#enumerate:20230516210903" data-reference-type="eqref"
data-reference="enumerate:20230516210903">\((ii)\)</a>.</p>
<p>The paper <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023)</a> gave analogues of
Theorem <a href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a> at an
archimedean place <span class="math inline">\(\mathfrak{p}\)</span>
(without assuming “principal series” or “<span
class="math inline">\(E/F\)</span> split at <span
class="math inline">\(\mathfrak{p}\)</span>”). Parts of the proof apply
to the non-archimedean “<span
class="math inline">\(\mathfrak{p}\)</span> fixed” case of Theorem <a
href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>; for
instance, the volume bound <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, Thm 15.2)</a> was
established over any fixed local field, without assuming
wall-avoidance.</p>
<p>In summary, the “<span class="math inline">\(\mathfrak{p}\)</span>
fixed” case of Theorem <a href="#theorem:cj3ngw7u2s"
data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a> — an
estimate like <a href="#eq:cj3tfrulcn" data-reference-type="eqref"
data-reference="eq:cj3tfrulcn">\((1.8)\)</a>, but with <span
class="math inline">\(c_{\mathcal{F}}\)</span> allowed to depend also
upon <span class="math inline">\(\mathfrak{p}\)</span> — is closely
related to existing results. The main novelty here is to allow <span
class="math inline">\(\mathfrak{p}\)</span> to vary.</p>
<div class="remark">
<p><strong>Remark 4</strong>. Strictly speaking, one could quantify the
available arguments to obtain <em>some</em> uniformity, e.g., <a
href="#eq:cj3tfrulcn" data-reference-type="eqref"
data-reference="eq:cj3tfrulcn">\((1.8)\)</a> with <span
class="math inline">\(c_{\mathcal{F}}\)</span> depending polynomially
upon <span class="math inline">\(\mathfrak{p}\)</span>. This yields
subconvexity under a “sufficient depth” restriction, namely, that <span
class="math inline">\(\mathfrak{q} = \mathfrak{p}^m\)</span> with <span
class="math inline">\(m\)</span> large enough in terms of the rank <span
class="math inline">\(n\)</span>. Our main novelty is thus to allow
<span class="math inline">\(\mathfrak{p}\)</span> to vary while <span
class="math inline">\(\mathfrak{q}\)</span> is a small power of <span
class="math inline">\(\mathfrak{p}\)</span>, e.g., <span
class="math inline">\(\mathfrak{q} = \mathfrak{p}\)</span>. Such
“horizontal” cases do not follow from direct quantification.</p>
</div>
<h2 id="sec:cj4vjf3iqs">§1.6. Division of the proof</h2>
<p>Like in previous works, the basic object of study is the integral
<span id="eq:cj3v66d7v4" class="math display">\[\label{eq:cj3v66d7v4}\tag{1.10}
  \int_{[H]} \pi(\omega) v \cdot \overline{u}\]</span> for suitable
vectors <span class="math inline">\(v \in \pi\)</span> and <span
class="math inline">\(u \in \sigma\)</span> and a “convolution kernel”
or “amplifier” <span class="math inline">\(\omega \in
C_c^\infty(G(\mathbb{A}))\)</span>, chosen so that <span
class="math inline">\(\pi(\omega) v\)</span> approximates <span
class="math inline">\(v\)</span>. One seeks to bound the integrals <a
href="#eq:cj3v66d7v4" data-reference-type="eqref"
data-reference="eq:cj3v66d7v4">\((1.10)\)</a> simultaneously</p>
<ul>
<li><p>from below, using <a href="#eq:cj3tfrrhlc"
data-reference-type="eqref"
data-reference="eq:cj3tfrrhlc">\((1.1)\)</a>, in terms of <span
class="math inline">\(\mathcal{L}(\pi,\sigma)\)</span>, and</p></li>
<li><p>from above, by their second moment over “all” <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(v\)</span>, using its “relative trace formula”
expansion <span id="eq:cj3tv4jpta" class="math display">\[\label{eq:cj3tv4jpta}\tag{1.11}
  \int_{x, y \in [H]} \bar{u}(x) u(y) \sum_{\gamma \in G(F)}  \omega
(x^{-1} \gamma y) \, d x \, d y.\]</span></p></li>
</ul>
<p>We work with factorizable vectors <span
class="math inline">\(v\)</span> and <span
class="math inline">\(u\)</span> and a factorizable test function <span
class="math inline">\(\omega\)</span>. Their local components at the
“uninteresting” places are chosen in a soft and general way <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, sec.
5)</a>. The key point is to choose the components <span
class="math inline">\(v_\mathfrak{p}, u_\mathfrak{p}\)</span> and <span
class="math inline">\(\omega_\mathfrak{p}\)</span> at the “interesting”
place and then to establish the required estimates. The proof may be
divided into roughly the following steps (see <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 2)</a> for a more
leisurely overview).</p>
<ol>
<li><p><span id="enumerate:cj3ubymeey"
label="enumerate:cj3ubymeey"></span> For an individual representation
<span class="math inline">\(\pi\)</span> of <span
class="math inline">\(G\)</span>, a construction of vectors <span
class="math inline">\(v \in \pi\)</span> that are
<em>microlocalized</em> with respect to some parameter <span
class="math inline">\(\tau\)</span> <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, sec.
1.7)</a>.</p></li>
<li><p><span id="enumerate:cj3ubymf5o"
label="enumerate:cj3ubymf5o"></span> For a pair <span
class="math inline">\((\pi,\sigma)\)</span> as above, a study of the
pairs of parameters <span class="math inline">\((\tau, \tau_H)\)</span>,
at which microlocalized vectors <span class="math inline">\(v \in
\pi\)</span> and <span class="math inline">\(u \in \sigma\)</span>
exist, that are <em>compatible</em> in the sense that <span
class="math inline">\(\tau\)</span> restricts to <span
class="math inline">\(\tau_H\)</span> <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, secs.
13–14)</a>.</p></li>
<li><p><span id="enumerate:cj3ubymh5v"
label="enumerate:cj3ubymh5v"></span> Spectral estimates: the estimation
(in particular, lower bound) of integrals of matrix coefficients of
microlocalized vectors <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, sec.
18)</a>.</p></li>
<li><p><span id="enumerate:cj3ubymi4d"
label="enumerate:cj3ubymi4d"></span> Geometric estimates, namely the
“volume bound”, which is the key technical problem that arises when
attempting to estimate <a href="#eq:cj3tv4jpta"
data-reference-type="eqref"
data-reference="eq:cj3tv4jpta">\((1.11)\)</a>.</p></li>
</ol>
<p>The first three of these steps adapt readily to the setting of this
paper:</p>
<ol>
<li><p>We are content to impose local conditions that make the
construction of microlocalized vectors particularly concrete (§<a
href="#sec:part-body-paper" data-reference-type="ref"
data-reference="sec:part-body-paper">8</a>).</p></li>
<li><p>The study of compatible parameters was addressed in <a href="#ref-nelson-venkatesh-1"
class="citation" data-cites="nelson-venkatesh-1">(Nelson and Venkatesh
2021, secs. 13–14)</a> over any base field of characteristic zero; we
have found it convenient here to extend that study to a general base
ring (§<a href="#sec:20230514080526" data-reference-type="ref"
data-reference="sec:20230514080526">4</a>), using arguments quite
similar to those in <em>loc. cit.</em></p></li>
<li><p>The spectral estimates proceed in our context as in <a href="#ref-nelson-venkatesh-1"
class="citation" data-cites="nelson-venkatesh-1">(Nelson and Venkatesh
2021, sec. 18)</a>, with simplification.</p></li>
</ol>
<p>The focus of this paper is thus on the geometric estimates, namely,
in establishing a volume bound that is uniform in <span
class="math inline">\(\mathfrak{p}\)</span>. We discuss this further
starting in §<a href="#sec:cj3ubuyr8u" data-reference-type="ref"
data-reference="sec:cj3ubuyr8u">1.7</a>.</p>
<div class="remark">
<p><strong>Remark 5</strong>. The method and ideas employed here have a
long history. We refer to <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 2.6)</a> for an
overview, but emphasize the use of amplification following
Duke–Friedlander–Iwaniec <a href="#ref-MR1942691 DFI94 MR1923476" class="citation"
data-cites="MR1942691 DFI94 MR1923476">(Iwaniec 2002; Duke, Friedlander,
and Iwaniec 1994, 2002)</a>, the systematic study of period integrals
and test vectors following Bernstein–Reznikov <a href="#ref-MR2726097" class="citation"
data-cites="MR2726097">(Bernstein and Reznikov 2010)</a>,
Venkatesh <a href="#ref-venkatesh-2005" class="citation" data-cites="venkatesh-2005">(Venkatesh
2010)</a> and Michel–Venkatesh <a href="#ref-michel-2009" class="citation"
data-cites="michel-2009">(Michel and Venkatesh 2010)</a>, and the
influential papers of Sarnak <a href="#ref-MR780071" class="citation"
data-cites="MR780071">(Sarnak 1985)</a> and Iwaniec–Sarnak <a href="#ref-iwan-sar"
class="citation" data-cites="iwan-sar">(Iwaniec and Sarnak
1995)</a>.</p>
</div>
<div id="remark:cj3u9047n5" class="remark">
<p><strong>Remark 6</strong>. To simplify the statement of Theorem <a
href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a> and focus
on the primary “horizontal” novelty, we assumed that the local
components <span class="math inline">\(\pi_\mathfrak{p}\)</span> and
<span class="math inline">\(\sigma_\mathfrak{p}\)</span> belong to the
principal series. We will actually establish a more general result,
where that assumption is weakened to a more complicated condition: that
<span class="math inline">\(\pi_\mathfrak{p}\)</span> and <span
class="math inline">\(\sigma_\mathfrak{p}\)</span> are “regular at depth
<span class="math inline">\(\mathfrak{q}^2\)</span>” (Definition <a
href="#definition:we-say-that-pi-emphr-at-depth-mathfr-if-there-cycl-regular-depth-parameter-polynomial"
data-reference-type="ref"
data-reference="definition:we-say-that-pi-emphr-at-depth-mathfr-if-there-cycl-regular-depth-parameter-polynomial">8.1</a>),
with the analogue of the “large conductor” assumption <a
href="#eqn:cj3ngvwrm4" data-reference-type="eqref"
data-reference="eqn:cj3ngvwrm4">\((1.7)\)</a> being that the pair
<span class="math inline">\((\pi_\mathfrak{p},
\sigma_\mathfrak{p})\)</span> is “stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>” (Definition <a
href="#definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f"
data-reference-type="ref"
data-reference="definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f">8.6</a>).
We formulate these definitions in terms of what is needed by our
argument (the existence of suitable vectors), and verify (§<a
href="#sec:part-body-paper" data-reference-type="ref"
data-reference="sec:part-body-paper">8</a>) that they are closed under
parabolic induction and apply to certain supercuspidals (e.g.,
characters). We do not exhaustively classify the representations to
which they apply. Giving such a classification is an interesting problem
in the representation theory of supercuspidals that belongs to step <a
href="#enumerate:cj3ubymeey" data-reference-type="eqref"
data-reference="enumerate:cj3ubymeey">\((1)\)</a> in the
proof strategy outlined above. For the other steps <a
href="#enumerate:cj3ubymf5o" data-reference-type="eqref"
data-reference="enumerate:cj3ubymf5o">\((2)\)</a>, <a
href="#enumerate:cj3ubymh5v" data-reference-type="eqref"
data-reference="enumerate:cj3ubymh5v">\((3)\)</a> and <a
href="#enumerate:cj3ubymi4d" data-reference-type="eqref"
data-reference="enumerate:cj3ubymi4d">\((4)\)</a>, our
treatment is general.</p>
</div>
<div id="remark:cj3ubzzdb9" class="remark">
<p><strong>Remark 7</strong>. It would be desirable to generalize
Theorem <a href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a> by removing
the parity condition on the conductor exponent, i.e., by replacing
“<span class="math inline">\(\mathfrak{q}^2\)</span>” with <span
class="math inline">\(\mathfrak{q}\)</span> in the statement, or
equivalently, by allowing <span class="math inline">\(T\)</span> to be
the norm of any ideal (rather than the square an ideal) in the
discussion following Theorem <a href="#theorem:cj3ngw7u2s"
data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>. Such a
generalization seems accessible in the depth aspect, but would require
new ideas in horizontal aspects. The issues touch upon all steps <a
href="#enumerate:cj3ubymeey" data-reference-type="eqref"
data-reference="enumerate:cj3ubymeey">\((1)\)</a>, <a
href="#enumerate:cj3ubymf5o" data-reference-type="eqref"
data-reference="enumerate:cj3ubymf5o">\((2)\)</a>, <a
href="#enumerate:cj3ubymh5v" data-reference-type="eqref"
data-reference="enumerate:cj3ubymh5v">\((3)\)</a> and <a
href="#enumerate:cj3ubymi4d" data-reference-type="eqref"
data-reference="enumerate:cj3ubymi4d">\((4)\)</a> in the
proof strategy outlined above; for instance, in place of the volume
bound, one might need to estimate character sums (see the third
paragraph of <a href="#ref-2021arXiv210915230N" class="citation"
data-cites="2021arXiv210915230N">(Nelson 2021, sec. 1.4)</a> and
references). This seems to us an interesting direction for future
work.</p>
</div>
<div id="remark:cj3ubsydvn" class="remark">
<p><strong>Remark 8</strong>. Using the methods of <a href="#ref-2021arXiv210915230N"
class="citation" data-cites="2021arXiv210915230N">(Nelson 2021)</a>,
it should be possible to extend Theorem <a href="#theorem:cj3ngw7u2s"
data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a> to the
split case <span class="math inline">\(E = F \times F\)</span> and to
Eisenstein series. This would yield subconvex bounds in horizontal
aspects for standard <span class="math inline">\(L\)</span>-functions
away from conductor dropping. Such bounds should apply to character
twists <span class="math inline">\(L(\pi \otimes \chi, \tfrac{1}{2} + i
t)\)</span>, with <span class="math inline">\(\pi\)</span> fixed and
<span class="math inline">\(\chi\)</span> of <em>square</em> conductor.
More generally, it should be possible to establish subconvex bounds for
standard <span class="math inline">\(L\)</span>-functions <span
class="math inline">\(L(\pi,\tfrac{1}{2})\)</span> when <span
class="math inline">\(\pi\)</span> is induced at each finite place from
characters all having the same square conductor. To remove the
squareness assumption would require extending our methods as in
Remark <a href="#remark:cj3ubzzdb9" data-reference-type="ref"
data-reference="remark:cj3ubzzdb9">1.7</a>.</p>
</div>
<div id="remark:cj3u905a9t" class="remark">
<p><strong>Remark 9</strong>. One motivation for studying horizontal
aspects comes from conjectures and results of Lapid–Mao <a href="#ref-MR3267120 MR3619910 MR3649366"
class="citation" data-cites="MR3267120 MR3619910 MR3649366">(Lapid and
Mao 2015, 2017b, 2017a)</a>, which relate quadratic twists of
self-dual standard <span class="math inline">\(L\)</span>-functions on
<span class="math inline">\({\mathop{\mathrm{GL}}}_n\)</span> to Fourier
coefficients of automorphic forms on <span
class="math inline">\({\mathop{\mathrm{Mp}}}_{2n}\)</span>. Estimates for
such coefficients could have applications to representation problems
concerning quadratic forms. The present work does not apply to such
twists due to the squareness restriction in Remark <a
href="#remark:cj3ubsydvn" data-reference-type="ref"
data-reference="remark:cj3ubsydvn">1.8</a>, but may be understood as a
step in that direction.</p>
</div>
<h2 id="sec:cj3ubuyr8u">§1.7. Geometric estimates: the uniform volume
bound</h2>
<p>Continuing the discussion of §<a href="#sec:cj4vjf3iqs"
data-reference-type="ref" data-reference="sec:cj4vjf3iqs">1.6</a>, we
formulate the volume bound below as Problem <a href="#Probleminformal"
data-reference-type="ref" data-reference="Probleminformal">1.10</a>. The
asymptotic determination of <a href="#eq:cj3tv4jpta"
data-reference-type="eqref"
data-reference="eq:cj3tv4jpta">\((1.11)\)</a> reduces to the volume
bound as in previous work (see <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 1.5.3)</a> or §<a
href="#Sec:bilinear" data-reference-type="ref"
data-reference="Sec:bilinear">7</a>). Cases of the volume bound
sufficient for the depth aspect were established in <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023)</a>,
using reductions specific to that aspect (see §<a href="#sec:cj4t64wm4h"
data-reference-type="ref" data-reference="sec:cj4t64wm4h">1.9</a> for
details). We develop a different approach (§<a href="#sec:cj4t647ljn"
data-reference-type="ref" data-reference="sec:cj4t647ljn">1.8</a>) that
gives the volume bound in general, uniformly in <span
class="math inline">\(\mathfrak{p}\)</span>.</p>
<p>The volume bound is a local assertion concerning the “interesting”
place <span class="math inline">\(\mathfrak{p}\)</span>. To simplify
notation, we write simply <span class="math inline">\(G, H\)</span>,
etc., for points over <span
class="math inline">\(F_\mathfrak{p}\)</span>, and drop the subscripts
<span class="math inline">\(\mathfrak{p}\)</span>. Thus, <span
class="math inline">\(F\)</span> now denotes a non-archimedean local
field, arising as the local component “<span
class="math inline">\(F_\mathfrak{p}\)</span>” of the global field
considered above. We write simply <span
class="math inline">\(\mathfrak{p}\)</span> for its maximal ideal, <span
class="math inline">\(\mathfrak{o}\)</span> for its maximal order, and
<span class="math inline">\(q := \left\lvert \mathfrak{o} / \mathfrak{p}
\right\rvert\)</span> for the residue field cardinality. We set <span
class="math display">\[(G,H,M, M_H) = ({\mathop{\mathrm{GL}}}_{n+1}(F),
{\mathop{\mathrm{GL}}}_n(F), {\mathop{\mathrm{Mat}}}_{n+1}(F),
{\mathop{\mathrm{Mat}}}_n(F)),\]</span> where <span
class="math inline">\({\mathop{\mathrm{Mat}}}_n\)</span> means “<span
class="math inline">\(n \times n\)</span> matrices”.</p>
<p>Let <span class="math inline">\(K =
{\mathop{\mathrm{GL}}}_{n+1}(\mathfrak{o}) &lt; G\)</span> denote the
standard maximal compact subgroup. Recall from Theorem <a
href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a> the
positive power <span class="math inline">\(\mathfrak{q}\)</span> of
<span class="math inline">\(\mathfrak{p}\)</span>, with square <span
class="math inline">\(\mathfrak{q}^2\)</span> of norm <span
class="math inline">\(T\)</span>, that controls the depths of the
representations <span class="math inline">\(\pi\)</span> of <span
class="math inline">\(G\)</span> and <span
class="math inline">\(\sigma\)</span> of <span
class="math inline">\(H\)</span> that we consider.</p>
<p>Let <span class="math inline">\(\tau \in M\)</span>, with upper-left
block <span class="math inline">\(\tau_H \in M_H\)</span>. Let <span
class="math inline">\(G_\tau\)</span> and <span
class="math inline">\(H_{\tau_H}\)</span> denote the respective
centralizers of <span class="math inline">\(\tau\)</span> in <span
class="math inline">\(G\)</span> and of <span
class="math inline">\(\tau_H\)</span> in <span
class="math inline">\(H\)</span>. We say that <span
class="math inline">\(\tau\)</span> is <em>stable</em> if it has no
eigenvalues in common with <span class="math inline">\(\tau_H\)</span>
over an algebraic closure, or equivalently, if the characteristic
polynomials of <span class="math inline">\(\tau\)</span> and <span
class="math inline">\(\tau_H\)</span> generate the unit ideal. This is
an avatar for the “large conductor” assumption <a href="#eqn:cj3ngvwrm4"
data-reference-type="eqref"
data-reference="eqn:cj3ngvwrm4">\((1.7)\)</a> (see <a href="#ref-nelson-venkatesh-1"
class="citation" data-cites="nelson-venkatesh-1">(Nelson and Venkatesh
2021, sec. 15)</a>) and is equivalent to the geometric invariant
theory notion of stability (see <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, sec.
14)</a>).</p>
<div id="Probleminformal" class="problem">
<p><strong>Problem 10</strong>. Fix a stable element <span
class="math inline">\(\tau \in M\)</span>. Fix <span
class="math inline">\(a \in G - H Z\)</span>, where <span
class="math inline">\(Z &lt; G\)</span> denotes the center. Give a
nontrivial bound for the volume of the set of all <span
class="math inline">\(y \in H_{\tau_H} \cap K\)</span> for which <span
class="math inline">\(a y\)</span> is congruent modulo <span
class="math inline">\(\mathfrak{q}\)</span> to an element of <span
class="math inline">\(H G_\tau\)</span>.</p>
</div>
<p>Here “nontrivial” means a power saving in <span
class="math inline">\(T\)</span> over the trivial bound, <span
class="math inline">\(\mathop{\mathrm{vol}}(H_{\tau_H} \cap K)\)</span>.
Strictly speaking, we need mild refinements of the problem statement
depending quantitatively upon <span
class="math inline">\(a\)</span>.</p>
<p>A key result of this paper is a solution to this problem (Theorem <a
href="#theorem:volume-bound" data-reference-type="ref"
data-reference="theorem:volume-bound">6.7</a>) that is uniform with
respect to variation of the underlying local field <span
class="math inline">\(F\)</span>. In §<a href="#sec:cj4t647ljn"
data-reference-type="ref" data-reference="sec:cj4t647ljn">1.8</a>, we
summarize the proof. In §<a href="#sec:cj4t64wm4h"
data-reference-type="ref" data-reference="sec:cj4t64wm4h">1.9</a>, we
explain why the depth aspect treatment given in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023)</a> is not
uniform.</p>
<h2 id="sec:cj4t647ljn">§1.8. The approach of this paper</h2>
<p>The volume bound controls elements of <span
class="math inline">\(H_{\tau_H}\)</span> lying close to a certain
subvariety, with “close” quantified by the ideal <span
class="math inline">\(\mathfrak{q}\)</span>. We deduce it from a purely
algebraic statement, Theorem <a href="#theorem:cj2dzotgu8"
data-reference-type="ref" data-reference="theorem:cj2dzotgu8">1.11</a>,
whose informal content is that, among the equations defining that
subvariety, there is at least one whose coefficients are at least as
large as the distance from <span class="math inline">\(a\)</span> to
<span class="math inline">\(H Z\)</span>.</p>
<p>To formulate that algebraic statement, we denote now by <span
class="math inline">\((\mathbf{G}, \mathbf{H}, \mathbf{M},
\mathbf{M}_H)\)</span> the group schemes <span
class="math inline">\(({\mathop{\mathrm{GL}}}_{n+1},
{\mathop{\mathrm{GL}}}_n, {\mathop{\mathrm{Mat}}}_{n+1},
{\mathop{\mathrm{Mat}}}_n)\)</span> of invertible and all square matrices
of the indicated dimensions, and write <span
class="math inline">\(\mathbf{Z}\)</span> for the center of <span
class="math inline">\(\mathbf{G}\)</span>. Let <span
class="math inline">\(R\)</span> be a ring, and let <span
class="math inline">\(\tau \in \mathbf{M}(R)\)</span> satisfy the
following “stability” hypothesis (§<a href="#sec:20230514080526"
data-reference-type="ref" data-reference="sec:20230514080526">4</a>):
the characteristic polynomials of <span
class="math inline">\(\tau\)</span> and its upper-left block <span
class="math inline">\(\tau_H\)</span> generate the unit ideal. Let <span
class="math inline">\(\mathbf{G}_\tau\)</span> and <span
class="math inline">\(\mathbf{H}_{\tau_H}\)</span> denote the
centralizers of <span class="math inline">\(\tau\)</span> and <span
class="math inline">\(\tau_H\)</span>, regarded as subgroup schemes of
<span class="math inline">\(\mathbf{G}\)</span> and <span
class="math inline">\(\mathbf{H}\)</span> defined over <span
class="math inline">\(R\)</span>, and let <span class="math inline">\(a
\in \mathbf{G}(R)\)</span>. For each <span
class="math inline">\(R\)</span>-algebra <span
class="math inline">\(R&#39;\)</span>, we define the following set
(compare with Problem <a href="#Probleminformal"
data-reference-type="ref" data-reference="Probleminformal">1.10</a>):
<span class="math display">\[\mathbf{X}_{\tau,a}(R&#39;) := \left\{ y
\in \mathbf{H}_{\tau_H}(R&#39;) : a y \in \mathbf{H}(R&#39;)
\mathbf{G}_{\tau}(R&#39;) \right\}.\]</span> The stability hypothesis on
<span class="math inline">\(\tau\)</span> turns out to imply that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is naturally a closed
subscheme of <span class="math inline">\(\mathbf{H}_{\tau_H}\)</span>
over <span class="math inline">\(R\)</span>, defined by finitely many
polynomials equations (see Lemma <a
href="#lemma:each-ring-extens-r-r-we-have-begin-mathbfhr-m"
data-reference-type="ref"
data-reference="lemma:each-ring-extens-r-r-we-have-begin-mathbfhr-m">5.8</a>).</p>
<p>It is easy to see that if <span class="math inline">\(a\)</span> lies
in <span class="math inline">\(\mathbf{H}(R) \mathbf{Z}(R)\)</span>,
then <span class="math inline">\(\mathbf{X}_{\tau,a} =
\mathbf{H}_{\tau_H}\)</span> as schemes over <span
class="math inline">\(R\)</span> (i.e., their point sets coincide for
all <span class="math inline">\(R&#39;\)</span>). We establish a
converse:</p>
<div id="theorem:cj2dzotgu8" class="theorem">
<p><strong>Theorem 11</strong> (Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a>).
<em>Assume that <span class="math inline">\(n+1 \geq 3\)</span>, that
<span class="math inline">\(2\)</span> is a unit in <span
class="math inline">\(R\)</span>, and that <span
class="math inline">\(\mathbf{X}_{\tau,a} = \mathbf{H}_{\tau_H}\)</span>
as schemes over <span class="math inline">\(R\)</span>. Then <span
class="math inline">\(a \in \mathbf{H}(R)
\mathbf{Z}(R)\)</span>.</em></p>
</div>
<p>We refer to §<a href="#sec:transversality-statement-results"
data-reference-type="ref"
data-reference="sec:transversality-statement-results">5.1</a> for
refinements and discussion of why the hypotheses are necessary.
Informally, the condition <span
class="math inline">\(\mathbf{X}_{\tau,a} = \mathbf{H}_{\tau_H}\)</span>
says that the defining equations for <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> inside <span
class="math inline">\(\mathbf{H}_{\tau_H}\)</span> are tautological,
i.e., their coefficients are all zero. The informal content of
Theorem <a href="#theorem:cj2dzotgu8" data-reference-type="ref"
data-reference="theorem:cj2dzotgu8">1.11</a> is thus that if <span
class="math inline">\(a \notin \mathbf{H}(R) \mathbf{Z}(R)\)</span>,
then we can find a nonzero (bounded degree) polynomial on <span
class="math inline">\(\mathbf{H}_{\tau_H}\)</span> over <span
class="math inline">\(R\)</span> whose zero locus contains <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span>. This result, applied
in the context of Problem <a href="#Probleminformal"
data-reference-type="ref" data-reference="Probleminformal">1.10</a> with
<span class="math inline">\(R\)</span> a suitable quotient of <span
class="math inline">\(\mathfrak{o}/\mathfrak{q}\)</span>, implies that
the set whose volume we must bound is contained in the locus of a
polynomial whose coefficients are not all too small. The required
uniform volume bound (Theorem <a href="#theorem:volume-bound"
data-reference-type="ref" data-reference="theorem:volume-bound">6.7</a>)
then follows via general bounds for solutions to polynomial congruences
(§<a href="#sec:cj3v60uw7y" data-reference-type="ref"
data-reference="sec:cj3v60uw7y">6.1</a>).</p>
<p>To prove Theorem <a href="#theorem:cj2dzotgu8"
data-reference-type="ref" data-reference="theorem:cj2dzotgu8">1.11</a>, we
apply the assumed equality between <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> and <span
class="math inline">\(\mathbf{H}_{\tau_H}\)</span> first over the ring
of dual numbers <span class="math inline">\(R&#39; =
R[\varepsilon]/(\varepsilon^2)\)</span>, then over <span
class="math inline">\(R&#39;&#39; =
R[\varepsilon_1,\varepsilon_2]/(\varepsilon_1,\varepsilon_2)\)</span>.
We refer to these steps as linear and quadratic analysis, respectively.
They may be understood as studying the consequences of the vanishing of
linear and quadratic coefficients of the defining equations for <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> inside <span
class="math inline">\(\mathbf{H}_{\tau_H}\)</span>. The arguments
sketched below were found after extensive numerical study of these
coefficients,<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> and represent a main novelty of this
paper.</p>
<p>The key case is when <span class="math inline">\(a \in
\mathbf{G}_\tau(R)\)</span>; we must show then that <span
class="math inline">\(a \in \mathbf{Z}(R)\)</span>.</p>
<p>From the linear analysis, we deduce that <span
class="math inline">\(a^2 \in \mathbf{Z}(R)\)</span>. To do so, we
determine the linear coefficients with respect to the basis for <span
class="math inline">\(\mathop{\mathrm{Lie}}(\mathbf{H}_{\tau_H})\)</span>
given by powers of <span class="math inline">\(\tau_H\)</span>, and
observe that they may be related via an upper-triangular substitution to
some invariants of <span class="math inline">\(\tau\)</span> and <span
class="math inline">\(a\)</span> whose vanishing forces <span
class="math inline">\(a^2\)</span> to be central. We refer to §<a
href="#sec:analysis-first-derivatives" data-reference-type="ref"
data-reference="sec:analysis-first-derivatives">5.4</a> for details.
This step of the argument generalizes the approach of <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023)</a>,
recalled below in §<a href="#sec:cj4t64wm4h" data-reference-type="ref"
data-reference="sec:cj4t64wm4h">1.9</a>, which amounts to studying just
the linear coefficient for the central direction in <span
class="math inline">\(\mathop{\mathrm{Lie}}(\mathbf{H}_{\tau_H})\)</span>.</p>
<p>From the quadratic analysis, we construct (Lemma <a
href="#lemma:second-derivatives-yield-homomorphism-property"
data-reference-type="ref"
data-reference="lemma:second-derivatives-yield-homomorphism-property">5.17</a>)
a multiplicative linear map <span
class="math inline">\(\mathop{\mathrm{Lie}}(\mathbf{H}_{\tau_H})
\rightarrow \mathop{\mathrm{Lie}}(\mathbf{G}_{\tau})\)</span>. Our
argument then divides according to whether this map preserves unit
elements (residually). If it does not, then we may apply
multiplicativity in the central direction to see that <span
class="math inline">\(a\)</span> is central. If it does, then we show by
two applications of the linear analysis — first for <span
class="math inline">\(a\)</span> over <span
class="math inline">\(R\)</span>, then for suitable “nearby” <span
class="math inline">\(b \in \mathbf{G}_{\tau}(R&#39;)\)</span> over
<span class="math inline">\(R&#39; :=
R[\varepsilon_2]/(\varepsilon_2^2)\)</span>, with <span
class="math inline">\(a(1+\varepsilon_1\tau_H) \in \mathbf{H}(R&#39;)
b\)</span> — that <span class="math inline">\(\tau\)</span> satisfies a
monic polynomial of degree <span class="math inline">\(2\)</span>,
contrary our assumption <span class="math inline">\(n+1\geq 3\)</span>.
We refer to §<a href="#sec:analysis-second-derivatives"
data-reference-type="ref"
data-reference="sec:analysis-second-derivatives">5.5</a> for
details.</p>
<div class="remark">
<p><strong>Remark 12</strong>. In the depth aspect, we may assume via
the “near identity” reduction (§<a href="#sec:cj4t69an73"
data-reference-type="ref" data-reference="sec:cj4t69an73">1.9.3</a>)
that <span class="math inline">\(a\)</span> is close to the identity.
Then <span class="math inline">\(a^2 \in \mathbf{Z}(R) \implies a \in
\mathbf{Z}(R)\)</span>, so the “linear” part of above argument suffices,
yielding a simpler proof than in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023)</a> of the volume
bound required in the depth aspect (see Remark <a
href="#Remark:recoverLiealgproof" data-reference-type="ref"
data-reference="Remark:recoverLiealgproof">5.14</a>).</p>
</div>
<h2 id="sec:cj4t64wm4h">§1.9. Available treatment in the depth aspect</h2>
<p>We indicate here why the approach to the volume bound given in <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023)</a>
does not apply in horizontal aspects, motivating the approach described
above and pursued in this paper.</p>
<h3 id="the-short-spectral-projector-omega">The short spectral projector
<span class="math inline">\(\omega\)</span></h3>
<p>We construct in §<a href="#sec:cj4t6ynizh" data-reference-type="ref"
data-reference="sec:cj4t6ynizh">9.3</a> a convolution kernel <span
class="math inline">\(\omega \in C_c^\infty(K)\)</span>, the local
component of the global amplifier discussed after <a
href="#eq:cj3v66d7v4" data-reference-type="eqref"
data-reference="eq:cj3v66d7v4">\((1.10)\)</a>. It is supported on a
certain open subgroup <span class="math inline">\(J_\tau &lt;
K\)</span>, and given there by a multiple of a certain character of
<span class="math inline">\(J_\tau\)</span>, depending upon <span
class="math inline">\(\tau\)</span> and some additional data. Roughly,
<span class="math inline">\(J_\tau\)</span> is the inverse image modulo
<span class="math inline">\(\mathfrak{q}\)</span> of the image of <span
class="math inline">\(G_\tau \cap K\)</span>. For example, when <span
class="math inline">\(\tau\)</span> is a (regular) diagonal matrix,
<span class="math inline">\(J_\tau\)</span> consists of elements of
<span class="math inline">\(K\)</span> that are congruent modulo <span
class="math inline">\(\mathfrak{q}\)</span> to the diagonal.</p>
<h3 id="reductions">Reductions</h3>
<p>The depth aspect case of the volume bound (i.e., <span
class="math inline">\(\mathfrak{p}\)</span> fixed) was addressed
in <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(Nelson
2023)</a> following a series of reductions:</p>
<ol type="i">
<li><p><strong>Reduction to the near-identity case</strong>. By <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, sec.
15)</a>, it is not necessary to solve Problem <a
href="#Probleminformal" data-reference-type="ref"
data-reference="Probleminformal">1.10</a> in general — it suffices to
treat the “near-identity” case, where <span
class="math inline">\(a\)</span> lies in an arbitrarily small (but
fixed) neighborhood of the identity (see §<a href="#sec:cj4t69an73"
data-reference-type="ref"
data-reference="sec:cj4t69an73">1.9.3</a>).</p></li>
<li><p><strong>Reduction to the Lie algebra</strong>. The near-identity
case reduces further, via Lie-theoretic arguments <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 16)</a>, to a Lie
algebra problem, where <span
class="math inline">\(\mathop{\mathrm{Lie}}(H_{\tau_H})\)</span> plays
the role of <span class="math inline">\(H_{\tau_H}\)</span>.</p></li>
<li><p><strong>Reduction to central directions</strong>. The Lie algebra
problem concerns certain subspaces of <span
class="math inline">\(\mathop{\mathrm{Lie}}(H_{\tau_H})\)</span>, whose
definition we omit here. The problem is to show that the subspaces are
not the entire space. This problem was addressed in <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, sec.
17)</a> by showing that the subspaces do not contain the
one-dimensional central subspace; in effect, this shows that central
cosets in <span class="math inline">\(H_{\tau_H} \cap K\)</span> suffice
to solve Problem <a href="#Probleminformal" data-reference-type="ref"
data-reference="Probleminformal">1.10</a>.</p></li>
</ol>
<p>These reductions fail in horizontal aspects, for independent
reasons:</p>
<ol type="i">
<li><p>The near-identity reduction in the depth aspect comes from the
freedom to take the convolution kernel <span
class="math inline">\(\omega\)</span> supported close to the identity,
which is unavailable in horizontal aspects (see §<a
href="#sec:cj4t69an73" data-reference-type="ref"
data-reference="sec:cj4t69an73">1.9.3</a>).</p></li>
<li><p>The reduction to the Lie algebra may be adapted beyond the
near-identity case, but the resulting Lie algebra problem is unsolvable:
there are natural families of counterexamples (see Theorem <a
href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>
and Remark <a href="#remark:cj4u2pnri2" data-reference-type="ref"
data-reference="remark:cj4u2pnri2">5.16</a>).</p></li>
<li><p>Central directions do not suffice to solve the general case of
Problem <a href="#Probleminformal" data-reference-type="ref"
data-reference="Probleminformal">1.10</a>; we have again identified
counterexamples (see Remark <a href="#remark:gl6-example"
data-reference-type="ref"
data-reference="remark:gl6-example">5.20</a>).</p></li>
</ol>
<h3 id="sec:cj4t69an73">§1.9.3. The near-identity reduction</h3>
<p>We conclude §<a href="#sec:cj4t64wm4h" data-reference-type="ref"
data-reference="sec:cj4t64wm4h">1.9</a> by explaining the
“near-identity” reduction mentioned above, whose failure in horizontal
aspects motivates why the geometric estimates in this paper are of
“algebro-geometric” rather than “Lie-algebraic” flavor compared to those
in <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(Nelson
2023)</a>.</p>
<p>Fix a small natural number <span class="math inline">\(d\)</span>.
Let <span class="math inline">\(K[d]\)</span> denote the <span
class="math inline">\(d\)</span>th principal congruence subgroup of
<span class="math inline">\(K\)</span>. The convolution kernel <span
class="math inline">\(\omega\)</span> is supported in <span
class="math inline">\(K\)</span>, but not in <span
class="math inline">\(K[1]\)</span>. It projects onto a “short” family:
the integral operator <span class="math inline">\(\pi(\omega)\)</span>
vanishes unless the irreducible representation <span
class="math inline">\(\pi\)</span> lies in such a family. The normalized
restriction <span class="math inline">\(\omega^{[d]}\)</span> of <span
class="math inline">\(\omega\)</span> to <span
class="math inline">\(K[d]\)</span> projects onto a larger family; in
global settings, it is larger by a factor of roughly <span id="eq:cj4t64h1mo" class="math display">\[\label{eq:cj4t64h1mo}\tag{1.12}
  q^{{(n+1)}^2 d}.\]</span></p>
<div class="example">
<p><strong>Example 13</strong>. If <span
class="math inline">\(\tau\)</span> is diagonal, then the operator <span
class="math inline">\(\pi(\omega)\)</span> (resp. <span
class="math inline">\(\pi(\omega^{[d]})\)</span>) vanishes unless <span
class="math inline">\(\pi\)</span> is a principal series representation
<span class="math inline">\(\chi_1 \boxplus \dotsb \boxplus
\chi_{n+1}\)</span> induced by characters <span
class="math inline">\(\chi_j\)</span> of <span
class="math inline">\(F^\times\)</span> having prescribed restrictions
to <span class="math inline">\(\mathfrak{o}^\times\)</span> (resp. to
<span class="math inline">\(1 + \mathfrak{p}^d\)</span>).</p>
</div>
<p>The near-identity reduction arises from the freedom to replace <span
class="math inline">\(\omega\)</span>, supported on <span
class="math inline">\(G_\tau \cap K\)</span>, with <span
class="math inline">\(\omega^{(d)}\)</span>, supported on the smaller
group <span class="math inline">\(G_\tau \cap K[d]\)</span>. We can do
so in the depth aspect, where <span class="math inline">\(q\)</span> is
fixed, because the factors <a href="#eq:cj4t64h1mo"
data-reference-type="eqref"
data-reference="eq:cj4t64h1mo">\((1.12)\)</a> are then
harmless.</p>
<p>In horizontal aspects — where <span class="math inline">\(q\)</span>
is large — such factors ruin the near-identity reduction: any small
power of <span class="math inline">\(q\)</span> saved by amplification
is swamped by the large power of <span class="math inline">\(q\)</span>
in <a href="#eq:cj4t64h1mo" data-reference-type="eqref"
data-reference="eq:cj4t64h1mo">\((1.12)\)</a>, yielding estimates
that fail even to recover convexity. We must thus work with projectors
<span class="math inline">\(\omega\)</span> supported on the full
maximal compact subgroup <span class="math inline">\(K\)</span>.</p>
<h2 id="organization-of-this-paper">Organization of this paper</h2>
<p>This paper consists almost exclusively of local analysis at the
“interesting” place <span class="math inline">\(\mathfrak{p}\)</span>.
It culminates in our main local result, Theorem <a
href="#theorem:main-local-result" data-reference-type="ref"
data-reference="theorem:main-local-result">9.1</a>,
which is a direct analogue of its archimedean counterpart, <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, Theorem
4.2)</a>. The auxiliary arguments of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, secs. 4–6)</a>
(concerning “uninteresting” places, amplification, counting,
etc.) combine with our main local result to yield a subconvex bound,
exactly as in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023)</a>. While our local
analysis is logically self-contained, its global motivation might be
clarified by skimming <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 6)</a>.</p>
<p>We conclude with the detailed breakdown. §<a href="#sec:notation"
data-reference-type="ref" data-reference="sec:notation">2</a>–§<a
href="#sec:cyclic-matrices" data-reference-type="ref"
data-reference="sec:cyclic-matrices">3</a> contain preliminaries. §<a
href="#sec:20230514080526" data-reference-type="ref"
data-reference="sec:20230514080526">4</a> treats “stability” for <span
class="math inline">\(({\mathop{\mathrm{GL}}}_{n+1},
{\mathop{\mathrm{GL}}}_n)\)</span> over a general ring. §<a
href="#sec:transversality" data-reference-type="ref"
data-reference="sec:transversality">5</a> establishes our key algebraic
result (Theorem <a href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a>, or
Theorem <a href="#theorem:cj2dzotgu8" data-reference-type="ref"
data-reference="theorem:cj2dzotgu8">1.11</a> above). §<a
href="#sec:volumebound" data-reference-type="ref"
data-reference="sec:volumebound">6</a> applies that result to derive the
uniform volume bound (Theorem <a href="#theorem:volume-bound"
data-reference-type="ref" data-reference="theorem:volume-bound">6.7</a>),
which we further apply in §<a href="#Sec:bilinear"
data-reference-type="ref" data-reference="Sec:bilinear">7</a> to
estimate bilinear forms relevant for <a href="#eq:cj3tv4jpta"
data-reference-type="eqref"
data-reference="eq:cj3tv4jpta">\((1.11)\)</a>. §<a
href="#sec:part-body-paper" data-reference-type="ref"
data-reference="sec:part-body-paper">8</a> concerns “microlocal
analysis” involving representations <span
class="math inline">\(\pi,\sigma\)</span> and parameters <span
class="math inline">\(\tau,\tau_H\)</span>. §<a href="#sec:mainlocal"
data-reference-type="ref" data-reference="sec:mainlocal">9</a>
establishes our main local result (Theorem <a
href="#theorem:main-local-result" data-reference-type="ref"
data-reference="theorem:main-local-result">9.1</a>),
a uniform non-archimedean analogue of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, Theorem 4.2)</a>. §<a
href="#Sec:final" data-reference-type="ref"
data-reference="Sec:final">10</a> combines our main local result with
the auxiliary arguments of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023)</a> to complete the
proof of Theorem <a href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>.</p>
<h2 id="acknowledgment">Acknowledgment</h2>
<p>Y.H. is supported by the National Key Research and Development
Program of China (No. 2021YFA1000700). P.N. worked on this project while
he was a von Neumann Fellow at the Institute for Advanced Study,
supported by the National Science Foundation under Grant No.
DMS-1926686. The paper was completed while P.N. was a Villum
Investigator based at Aarhus University, supported by a research grant
(VIL54509) from VILLUM FONDEN.</p>
<h1 id="sec:notation">§2. Notation</h1>
<p>We record general notation and conventions, used throughout the
paper.</p>
<h2 id="sec:vectors-matrices">§2.1. Vectors and matrices</h2>
<p>Let <span class="math inline">\(\mathbf{V}\)</span> be a finite free
<span class="math inline">\(\mathbb{Z}\)</span>-module, thus <span
class="math inline">\(\mathbf{V} \cong \mathbb{Z}^n\)</span> for some
<span class="math inline">\(n\)</span>, the <em>rank</em> of <span
class="math inline">\(\mathbf{V}\)</span>. It will occasionally be
convenient to denote the rank instead by <span
class="math inline">\(n+1\)</span>, so that <span
class="math inline">\(n\)</span> refers instead to the rank of a
codimension one submodule (see §<a href="#sec:general-linear-ggp-pairs"
data-reference-type="ref"
data-reference="sec:general-linear-ggp-pairs">2.2</a> below).</p>
<p>We denote by <span class="math inline">\(\mathbf{V}^* =
\mathop{\mathrm{Hom}}(\mathbf{V},\mathbb{Z}) \cong \mathbb{Z}^n\)</span>
the dual module and by <span class="math inline">\(\mathbf{M} :=
\mathop{\mathrm{End}}(\mathbf{V}) \cong
{\mathop{\mathrm{Mat}}}_n(\mathbb{Z})\)</span> the endomorphism ring. We
denote by juxtaposition the natural pairing <span
class="math display">\[\mathbf{V}^* \otimes \mathbf{V} \rightarrow
\mathbb{Z}, \quad \ell \otimes v \mapsto \ell v := \ell(v),\]</span> as
well as the left action, right action and outer product, respectively:
<span class="math display">\[\begin{align}
  &amp;\mathbf{M} \otimes \mathbf{V} \rightarrow \mathbf{V},
\quad   &amp;&amp;a \otimes v \mapsto a v := a(v), \\
  &amp;\mathbf{V}^* \otimes \mathbf{M} \rightarrow \mathbf{V}^*,
\quad  &amp;&amp;\ell \otimes a \mapsto \ell a := [u \mapsto \ell(a(u))]
\\
  &amp;\mathbf{V} \otimes \mathbf{V}^* \rightarrow \mathbf{M}, \quad
&amp;&amp;v \otimes \ell \mapsto v \ell := [u \mapsto \ell(u) v].
\end{align}\]</span> The motivation for the notation is that, by
choosing a basis, we may regard <span
class="math inline">\(\mathbf{V}\)</span> (resp. <span
class="math inline">\(\mathbf{V}^*\)</span>) as spaces of column
(resp. row) vectors and <span class="math inline">\(\mathbf{M}\)</span>
as a space of matrices, in which case the above pairings are given by
matrix multiplication. We use the same notation for the extensions of
these pairings to more general rings given below.</p>
<p>For us, a <em>ring</em> <span class="math inline">\(R\)</span> is a
commutative ring with identity, an <em>algebra</em> or <em>ring
extension</em> <span class="math inline">\(R&#39;\)</span> of <span
class="math inline">\(R\)</span> is a ring map <span
class="math inline">\(R \rightarrow R&#39;\)</span>, and an <em>affine
scheme</em> <span class="math inline">\(\mathbf{X}\)</span> is a functor
that assigns to each ring <span class="math inline">\(R\)</span> a set
<span class="math inline">\(\mathbf{X}(R)\)</span> that functorially
identifies with the set of ring maps <span
class="math inline">\(\mathbb{Z}[\mathbf{X}] \rightarrow R\)</span> for
some ring <span class="math inline">\(\mathbb{Z}[\mathbf{X}]\)</span>,
the <em>coordinate ring</em> of <span
class="math inline">\(\mathbf{X}\)</span>. Affine schemes over <span
class="math inline">\(R\)</span> are defined similarly, but restricting
to <span class="math inline">\(R\)</span>-algebras; the above discussion
then applies upon replacing <span
class="math inline">\(\mathbb{Z}\)</span> with <span
class="math inline">\(R\)</span>.</p>
<p>By abuse of notation, we denote also by <span
class="math inline">\(\mathbf{V}, \mathbf{V}^*\)</span> and <span
class="math inline">\(\mathbf{M}\)</span> the affine group schemes over
<span class="math inline">\(\mathbb{Z}\)</span> given by <span
class="math display">\[\begin{align}
  \mathbf{V}(R) &amp;:= \mathbf{V} \otimes R \cong R^n, \\
  \mathbf{V}^*(R) &amp;:= \mathbf{V}^* \otimes R \cong R^n, \\
  \mathbf{M}(R) &amp;:= {\mathop{\mathrm{End}}}_R(\mathbf{V}(R)) \cong
{\mathop{\mathrm{Mat}}}_n(R).
\end{align}\]</span> The coordinate rings of <span
class="math inline">\(\mathbf{V}, \mathbf{V}^*\)</span> and <span
class="math inline">\(\mathbf{M}\)</span> identify with the polynomial
rings over <span class="math inline">\(\mathbb{Z}\)</span> in <span
class="math inline">\(n, n\)</span> and <span
class="math inline">\(n^2\)</span> variables, respectively, where <span
class="math inline">\(n\)</span> denotes the rank of <span
class="math inline">\(\mathbf{V}\)</span>. We denote by <span
class="math inline">\(\mathbf{G}\)</span> the affine group scheme <span
class="math display">\[\mathbf{G}(R) :=
{\mathop{\mathrm{Aut}}}_R(\mathbf{V}(R)) \cong
{\mathop{\mathrm{GL}}}_n(R),\]</span> whose coordinate ring is obtained
from that of <span class="math inline">\(\mathbf{M}\)</span> by
inverting the determinant.</p>
<p>We denote by <span class="math inline">\(\mathbf{Z}\)</span> the
center of <span class="math inline">\(\mathbf{G}\)</span>, consisting of
scalar matrices: <span class="math display">\[\mathbf{Z}(R) = R^\times
\hookrightarrow \mathbf{G}(R).\]</span></p>
<p>For <span class="math inline">\(g \in \mathbf{G}(R)\)</span>, we
denote by <span class="math inline">\(\mathop{\mathrm{Ad}}(g) :
\mathbf{M}(R) \rightarrow \mathbf{M}(R)\)</span> the conjugation map
<span class="math display">\[\mathop{\mathrm{Ad}}(g) x := g x g
^{-1}.\]</span></p>
<h2 id="sec:general-linear-ggp-pairs">§2.2. General linear GGP pairs</h2>
<p>In some parts of this paper, we consider just one general linear
group <span class="math inline">\(\mathbf{G}\)</span>. In others, we
work with inclusions <span class="math inline">\(\mathbf{H} \leq
\mathbf{G}\)</span> of general linear groups of neighboring rank. We
then use the following notation.</p>
<p>Suppose given <span class="math inline">\(e \in \mathbf{V}\)</span>
and <span class="math inline">\(e^* \in \mathbf{V}^*\)</span> such that
<span class="math inline">\(e^* e= 1\)</span>. We then define the
submodule <span class="math display">\[\mathbf{V}_H := \left\{ v \in
\mathbf{V} : e^* v = 0 \right\},\]</span> which participates in the
direct sum decomposition <span id="eqn:lambda-=-lambda_h-oplus-mathbbz-e-" class="math display">\[\label{eqn:lambda-=-lambda_h-oplus-mathbbz-e-}\tag{2.1}
  \mathbf{V} = \mathbf{V}_H \oplus \mathbb{Z} e,\]</span> <span
class="math display">\[v = (1 -  e e^*) v + (e^* v) e.\]</span> This
extends to any ring. We define affine group schemes <span
class="math display">\[\mathbf{V}_H, \quad \mathbf{V}_H^*, \quad
\mathbf{M}_H, \quad \mathbf{H}\]</span> in terms of <span
class="math inline">\(\mathbf{V}_H\)</span>, by analogy to the
definitions of §<a href="#sec:vectors-matrices"
data-reference-type="ref" data-reference="sec:vectors-matrices">2.1</a>.
These define closed subgroup schemes of <span
class="math inline">\(\mathbf{V}, \mathbf{V}^*, \mathbf{M},
\mathbf{G}\)</span>, respectively.</p>
<p>For any ring <span class="math inline">\(R\)</span>, we denote by
<span class="math inline">\(1_H \in \mathbf{M}_H(R)\)</span> the
identity operator. It is given in terms of the identity operator <span
class="math inline">\(1 \in \mathbf{M}(R)\)</span> by <span
class="math display">\[1_H = 1 - e e^*.\]</span> Given <span
class="math inline">\(\tau \in \mathbf{H}(R)\)</span>, we denote by
<span class="math display">\[\tau_H := 1_H \tau 1_H \in
\mathbf{M}_H(R)\]</span> the element induced by the decomposition <a
href="#eqn:lambda-=-lambda_h-oplus-mathbbz-e-"
data-reference-type="eqref"
data-reference="eqn:lambda-=-lambda_h-oplus-mathbbz-e-">\((2.1)\)</a>.</p>
<div class="example">
<p><strong>Example 14</strong>. Suppose <span
class="math inline">\(\mathbf{V}\)</span> has rank three. Let <span
class="math inline">\(e_1, e_2\)</span> be a basis for <span
class="math inline">\(\mathbf{V}_H\)</span>. Then <span
class="math inline">\(e_1,e_2,e\)</span> is a basis for <span
class="math inline">\(\mathbf{V}\)</span>. Using this basis to identify
<span class="math inline">\(\mathbf{M}\)</span> with the space of <span
class="math inline">\(3 \times 3\)</span> matrices, we have <span
class="math display">\[\mathbf{M}_H =
    \begin{pmatrix}
      \ast &amp; \ast &amp; 0 \\
      \ast &amp; \ast &amp; 0 \\
      0 &amp; 0 &amp; 0 \\
    \end{pmatrix},
    \quad
    \mathbf{H} =
    \begin{pmatrix}
      \ast &amp; \ast &amp; 0 \\
      \ast &amp; \ast &amp; 0 \\
      0 &amp; 0 &amp; 1 \\
    \end{pmatrix},
    \quad
    1_H =
    \begin{pmatrix}
      1 &amp; 0 &amp; 0 \\
      0 &amp; 1 &amp; 0 \\
      0 &amp; 0 &amp; 0 \\
    \end{pmatrix},\]</span> <span class="math display">\[\tau =
    \begin{pmatrix}
      \tau _{11} &amp; \tau _{12} &amp; \tau _{13} \\
      \tau _{21} &amp; \tau _{22} &amp; \tau _{23} \\
      \tau _{31} &amp; \tau _{32} &amp; \tau _{33} \\
    \end{pmatrix}
    \implies
    \tau_H
    =
    \begin{pmatrix}
      \tau _{11} &amp; \tau _{12} &amp; 0 \\
      \tau _{21} &amp; \tau _{22} &amp; 0 \\
      0 &amp; 0 &amp; 0 \\
    \end{pmatrix}.\]</span></p>
</div>
<h2 id="centralizers">Centralizers</h2>
<p>For <span class="math inline">\(\tau \in \mathbf{M}(R)\)</span> or
<span class="math inline">\(\sigma \in \mathbf{M}_{H}(R)\)</span>, we
denote by <span class="math display">\[\mathbf{G}_\tau \leq \mathbf{G},
\quad \mathbf{M}_{\tau} \leq \mathbf{M},
  \quad   \mathbf{H}_{\sigma} \leq \mathbf{H}, \quad
\mathbf{M}_{H,\sigma} \leq \mathbf{M}_H\]</span> the centralizers,
regarded as affine group schemes over <span
class="math inline">\(R\)</span>.</p>
<h2 id="sec:local-fields-congruence-subgroups">§2.4. Local fields and
congruence subgroups</h2>
<p>Let <span class="math inline">\(F\)</span> be a non-archimedean local
field. We denote then by <span class="math display">\[\mathfrak{o},
\qquad \mathfrak{p}, \qquad \varpi \in \mathfrak{p} ,\qquad q = \lvert
\mathfrak{o} / \mathfrak{p}  \rvert\]</span> its ring of integers, its
maximal ideal, a uniformizer, and the cardinality of the residue field.
We denote by <span class="math inline">\(|.|_F\)</span> the normalized
valuation.</p>
<p>For each ideal <span class="math inline">\(\mathfrak{a} \subseteq
\mathfrak{o}\)</span>, we set <span id="eqn:cj3m0de4ie" class="math display">\[\label{eqn:cj3m0de4ie}\tag{2.2}
  K(\mathfrak{a}) := \ker(\mathbf{G}(\mathfrak{o}) \rightarrow
\mathbf{G}(\mathfrak{o}/\mathfrak{a})),
  \quad
  K_H(\mathfrak{a}) := \ker(\mathbf{H}(\mathfrak{o}) \rightarrow
\mathbf{H}(\mathfrak{o}/\mathfrak{a})),\]</span> We sometimes write
simply <span class="math display">\[K := K(\mathfrak{o}) =
\mathbf{G}(\mathfrak{o}), \quad K_H := K_H(\mathfrak{o}) =
\mathbf{H}(\mathfrak{o}),
  \quad
  K_Z := \mathbf{Z}(\mathfrak{o})\]</span> for the standard maximal
compact subgroups of <span class="math inline">\(\mathbf{G}(F)\)</span>,
<span class="math inline">\(\mathbf{H}(F)\)</span> and <span
class="math inline">\(\mathbf{Z}(F)\)</span>, respectively. We equip the
latter groups with the Haar measure that assigns volume one to their
maximal compact subgroups <span class="math inline">\(K _G, K
_H\)</span> and <span class="math inline">\(K _Z\)</span>.</p>
<h1 id="sec:cyclic-matrices">§3. Cyclic matrices</h1>
<p>Let <span class="math inline">\(R\)</span> be a ring. In this
section, we write <span class="math inline">\(V, M, H\)</span>, etc.,
for the set of <span class="math inline">\(R\)</span>-points of the
corresponding bold-faced group schemes.</p>
<p>Let <span class="math inline">\(\tau \in M\)</span>. We denote by
<span class="math display">\[P_\tau(X) = \det(X - \tau) \in
R[X]\]</span> its characteristic polynomial. It is a monic polynomial
whose degree is the rank of <span
class="math inline">\(\mathbf{V}\)</span>. We recall the Cayley–Hamilton
theorem (see <a href="#ref-MR1322960" class="citation" data-cites="MR1322960">(Eisenbud
1995, Theorem 4.3)</a>): <span class="math inline">\(P_\tau(\tau) =
0\)</span>.</p>
<div id="definition:cyclic" class="definition">
<p><strong>Definition 15</strong>. Let <span class="math inline">\(\tau
\in M\)</span>. We say that <span class="math inline">\(v \in V\)</span>
is <em><span class="math inline">\(\tau\)</span>-cyclic</em> if <span
class="math inline">\(R[\tau] v = V\)</span>. We say that <em><span
class="math inline">\(V\)</span> is <span
class="math inline">\(\tau\)</span>-cyclic</em> (or simply that
<em><span class="math inline">\(\tau\)</span> is cyclic</em> when <span
class="math inline">\(V\)</span> is understood, or that <em><span
class="math inline">\(V\)</span> is cyclic</em> when <span
class="math inline">\(\tau\)</span> is understood) if there exists a
<span class="math inline">\(\tau\)</span>-cyclic vector <span
class="math inline">\(v \in V\)</span>.</p>
</div>
<div class="example">
<p><strong>Example 16</strong>. It is clear that any Jordan block is
cyclic.</p>
</div>
<div class="example">
<p><strong>Example 17</strong>. It follows from the Vandermonde
determinant calculation that a diagonal matrix is cyclic when the
pairwise differences between its diagonal entries are invertible.</p>
</div>
<div class="example">
<p><strong>Example 18</strong>. If <span
class="math inline">\(v\)</span> is <span
class="math inline">\(\tau\)</span>-cyclic, then it remains so upon
passing to any ring extension <span
class="math inline">\(R&#39;\)</span> of <span
class="math inline">\(R\)</span>. In particular, the cyclicity of <span
class="math inline">\(\tau\)</span> is preserved under base
extension.</p>
</div>
<div class="example">
<p><strong>Example 19</strong>. Let <span
class="math inline">\(R\)</span> be a local ring. By Nakayama’s lemma,
we can test whether <span class="math inline">\(\tau\)</span> is cyclic
over the residue field. When <span class="math inline">\(R\)</span> is a
field, the structure theorem for modules over the principal ideal domain
<span class="math inline">\(R[X]\)</span> says that <span
class="math inline">\(V\)</span> is isomorphic to a direct sum <span
class="math inline">\(\oplus_i R / (p_i)\)</span>, where <span
class="math inline">\(p_i\)</span> are monic primary polynomials (i.e.,
powers of irreducible polynomials). Then <span
class="math inline">\(\tau\)</span> is cyclic if and only if the <span
class="math inline">\(p_i\)</span> are pairwise relatively prime. For
instance, when <span class="math inline">\(R\)</span> is algebraically
closed, this says that no two Jordan blocks for <span
class="math inline">\(\tau\)</span> have the same eigenvalue.</p>
</div>
<div id="lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-"
class="lemma">
<p><strong>Lemma 20</strong>. Write <span class="math inline">\(n =
\mathop{\mathrm{rank}}(\mathbf{V})\)</span>. Then <span
class="math inline">\(v\)</span> is <span
class="math inline">\(\tau\)</span>-cyclic if and only if the map of
modules <span id="eqn:rn-rightarrow-v" class="math display">\[\label{eqn:rn-rightarrow-v}\tag{3.1}
    R^n \rightarrow V\]</span> <span id="eqn:let-tau-in-c0-through-cn1-sum-cj-tau" class="math display">\[\label{eqn:let-tau-in-c0-through-cn1-sum-cj-tau}\tag{3.2}
    (c_0,\dotsc,c_{n-1})  \mapsto \sum_{j &lt; n} c_j \tau^j v\]</span>
is surjective, in which case it is an isomorphism.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> The first statement follows from the Cayley–Hamilton
theorem, the second from the fact that any surjective map of free
modules of the same finite rank is an isomorphism <a href="#ref-MR1322960" class="citation"
data-cites="MR1322960">(Eisenbud 1995, Corollary 4.4a)</a>. ◻</p>
</span></div>
<p>In particular, each cyclic element <span
class="math inline">\(\tau\)</span> admits a <em>cyclic basis</em> <span
class="math inline">\(e_1, \dotsc, e_n\)</span> such that <span id="eqn:beginpmatrix-0--0--ast-" class="math display">\[\label{eqn:beginpmatrix-0--0--ast-}\tag{3.3}
  \tau e_j = e_{j+1} \text{ for } j &lt; n,
  \quad
  \text{e.g., }
  \tau =
  \begin{pmatrix}
    0 &amp; 0 &amp; \ast \\
    1 &amp; 0 &amp; \ast \\
    0 &amp; 1 &amp; \ast \\
  \end{pmatrix}.\]</span></p>
<div id="lemma:centralizer-description" class="lemma">
<p><strong>Lemma 21</strong>. Let <span class="math inline">\(\tau \in
M\)</span>, and suppose that <span class="math inline">\(v \in
V\)</span> is <span class="math inline">\(\tau\)</span>-cyclic. Then the
map <span class="math display">\[M_\tau \rightarrow V, \qquad x \mapsto
x v\]</span> is an isomorphism of <span
class="math inline">\(R\)</span>-modules. Moreover, <span
class="math display">\[M_\tau = R[\tau] = \left\{ \sum_{j=0}^{n-1} c_j
\tau^j : (c_0,\dotsc,c_{n-1}) \in R^{n} \right\}.\]</span> In
particular, <span class="math inline">\(M_\tau\)</span> is a commutative
<span class="math inline">\(R\)</span>-algebra, and <span
class="math inline">\(G_\tau\)</span> is an abelian group.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Since <span class="math inline">\(V\)</span> is
spanned by the <span class="math inline">\(\tau^j v\)</span> and <span
class="math inline">\(x \tau^j v = \tau^j x v\)</span>, we see that
<span class="math inline">\(x\)</span> is determined by <span
class="math inline">\(x v\)</span>. The map <span
class="math inline">\(M_\tau \rightarrow V\)</span> is thus
injective.</p>
<p>We next verify that <span class="math inline">\(M_\tau =
R[\tau]\)</span>. Let <span class="math inline">\(x \in M_\tau\)</span>.
By Lemma <a
href="#lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-"
data-reference-type="ref"
data-reference="lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-">3.6</a>,
we may choose <span class="math inline">\((c_0,\dotsc,c_{n-1}) \in
R^n\)</span> so that <span class="math inline">\(x v = \sum _{j=0}^{n-1}
c_j \tau^j v\)</span>. By the noted injectivity of <span
class="math inline">\(M_\tau \rightarrow V\)</span>, it follows that
<span class="math inline">\(x = \sum_{j=0}^{n-1} c_j \tau^j\)</span>.
Thus <span class="math inline">\(M_\tau \subseteq R[\tau]\)</span>. The
reverse containment is evident.</p>
<p>The surjectivity of <span class="math inline">\(M_\tau \rightarrow
V\)</span> follows from the identity <span class="math inline">\(M_\tau
= R[\tau]\)</span> and Lemma <a
href="#lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-"
data-reference-type="ref"
data-reference="lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-">3.6</a>. ◻</p>
</span></div>
<div
id="lemma:regular-elements-same-characteristic-polynomial-are-conjugate"
class="lemma">
<p><strong>Lemma 22</strong>. Suppose that <span
class="math inline">\(\tau_1, \tau_2 \in M\)</span> are cyclic elements
with the same characteristic polynomial. Then they are conjugate under
<span class="math inline">\(G\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Let <span
class="math inline">\(e_1^{(j)},\dotsc,e_n^{(j)}\)</span> be a cyclic
basis for <span class="math inline">\(\tau_1\)</span> (resp. <span
class="math inline">\(\tau_2\)</span>). By Cayley–Hamilton, we have
<span class="math inline">\(\tau_j e_n^{(j)} = \sum_{i=1}^{n} c_i
e_i^{(j)}\)</span>, where the coefficients <span
class="math inline">\(c_i \in R\)</span> depend only upon the
characteristic polynomial, hence are the same for <span
class="math inline">\(\tau_1\)</span> and <span
class="math inline">\(\tau_2\)</span>. Let <span class="math inline">\(g
\in G\)</span> be the unique map that sends <span
class="math inline">\(e_i^{(1)}\)</span> to <span
class="math inline">\(e_i^{(2)}\)</span>. Then <span
class="math inline">\(g \tau_1 = \tau_2 g\)</span>, so <span
class="math inline">\(\tau_1\)</span> and <span
class="math inline">\(\tau_2\)</span> are conjugate. ◻</p>
</span></div>
<h1 id="sec:20230514080526">§4. Stability</h1>
<div class="definition">
<p><strong>Definition 23</strong>. Let <span
class="math inline">\(R\)</span> be a ring and <span
class="math inline">\(\tau \in \mathbf{M}(R)\)</span>. We say that <span
class="math inline">\(\tau\)</span> is <em>stable</em> if the vectors
<span class="math inline">\(e\)</span> and <span
class="math inline">\(e^*\)</span> are both <span
class="math inline">\(\tau\)</span>-cyclic. We denote by <span
class="math inline">\(\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span>
the subset of stable elements.</p>
</div>
<div class="remark">
<p><strong>Remark 24</strong>. This condition was studied by
Rallis–Schiffmann <a href="#ref-2007arXiv0705.2168R" class="citation"
data-cites="2007arXiv0705.2168R">(Rallis and Schiffmann 2007)</a>
under the name “regular”, and also in <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, sec.
14)</a>, where it was related (for <span
class="math inline">\(R\)</span> a field of characteristic zero) to the
geometric invariant theory notion of stability. See especially <a href="#ref-2007arXiv0705.2168R"
class="citation" data-cites="2007arXiv0705.2168R">(Rallis and Schiffmann
2007, Thm 6.1)</a> and <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, Lem
14.8)</a>. Many of the results of this section were established
in <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(Nelson and
Venkatesh 2021, secs. 13–14)</a> when <span
class="math inline">\(R\)</span> is a field of characteristic zero, and
in some respects, more systematically and generally (e.g., also for
orthogonal GGP pairs). We have chosen to give short proofs of what we
require, repeating or adapting the arguments of the cited reference. The
adapted arguments could likely be extended to the orthogonal case along
the same lines as in <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, sec.
14)</a>.</p>
</div>
<div id="example:cj3twmtcpz" class="example">
<p><strong>Example 25</strong>. Suppose <span
class="math inline">\(R\)</span> is a local ring, with maximal ideal
<span class="math inline">\(\mathfrak{p}\)</span>. Let <span
class="math inline">\(\tau \in \mathbf{M}(R)\)</span>, with image <span
class="math inline">\(\bar{\tau} \in
\mathbf{M}(R/\mathfrak{p})\)</span>. Nakayama’s lemma implies that <span
class="math inline">\(\tau\)</span> is stable if and only if <span
class="math inline">\(\bar{\tau}\)</span> is stable.</p>
</div>
<p>We denote by <span class="math inline">\(n+1\)</span> the rank of
<span class="math inline">\(\mathbf{V}\)</span>, so that <span
class="math inline">\(n\)</span> is the rank of <span
class="math inline">\(\mathbf{V}_H\)</span>. For a ring <span
class="math inline">\(R\)</span>, we define <span
class="math display">\[\Delta : \mathbf{M}(R) \rightarrow R\]</span>
<span class="math display">\[\Delta(\tau) := \det (e^*, e^* \tau,
\dotsc, e^* \tau ^n ) \det (e, \tau e, \dotsc, \tau ^n e),\]</span>
where <span class="math inline">\(\det(\dotsb)\)</span> denotes the
determinant of the matrix having the indicated row vectors <span
class="math inline">\(e^* \tau^i \in \mathbf{V}^*(R)\)</span> or column
vectors <span class="math inline">\(\tau^j e \in \mathbf{V}(R)\)</span>,
with such vectors realized as <span
class="math inline">\((n+1)\)</span>-tuples using some chosen basis for
the free <span class="math inline">\(\mathbb{Z}\)</span>-module <span
class="math inline">\(\mathbf{V}\)</span>. Choosing a different basis
has the effect of multiplying the two determinants by mutually inverse
factors, hence has no effect on <span
class="math inline">\(\Delta(\tau)\)</span>. This family of maps <span
class="math inline">\(\Delta\)</span> defines a regular function on the
scheme <span class="math inline">\(\mathbf{M}\)</span>. It follows from
Lemma <a href="#lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-"
data-reference-type="ref"
data-reference="lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-">3.6</a>
that <span class="math inline">\(\tau\)</span> is stable if and only if
<span class="math inline">\(\Delta(\tau)\)</span> is a unit in <span
class="math inline">\(R\)</span>. In particular, <span
class="math inline">\(\mathbf{M} _{\mathop{\mathrm{stab}}}\)</span>
defines an open affine subscheme of <span
class="math inline">\(\mathbf{M}\)</span>.</p>
<p>In the remainder of this section, we focus on an individual
(arbitrary) ring <span class="math inline">\(R\)</span> and abbreviate
<span class="math inline">\(V := \mathbf{V}(R), G :=
\mathbf{G}(R)\)</span>, etc.</p>
<p>For <span class="math inline">\(\tau \in M\)</span>, we may form the
characteristic polynomials <span class="math display">\[P_\tau \in R[X]
\quad \text{and} \quad P_{\tau_H} \in R[X].\]</span> These are monic
polynomials of degrees <span class="math inline">\(n+1\)</span> and
<span class="math inline">\(n\)</span>, respectively.</p>
<div id="lemma:let-p-p_h-in-rx-be-monic-polyn-degr-n+1-n-resp-the"
class="lemma">
<p><strong>Lemma 26</strong>. Let <span class="math inline">\(P, P_H \in
R[X]\)</span> be monic polynomials of degrees <span
class="math inline">\(n+1\)</span> and <span
class="math inline">\(n\)</span>, respectively. There exists <span
class="math inline">\(\tau \in M\)</span> such that <span
class="math inline">\(P_{\tau} = P\)</span> and <span
class="math inline">\(P_{\tau_H} = P_H\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> One can deduce the existence of <span
class="math inline">\(\tau\)</span> directly from the spherical property
of <span class="math inline">\(H \hookrightarrow G \times H\)</span>
(see <a href="#ref-nelson-venkatesh-1" class="citation" data-cites="nelson-venkatesh-1">(Nelson and
Venkatesh 2021, sec. 14.6)</a>). For variety of exposition, we record
an “explicit” construction, following <a href="#ref-MR3164988" class="citation"
data-cites="MR3164988">(Zhang 2014, sec. 6.2)</a>. Supposing for
instance that <span class="math inline">\(H = {\mathop{\mathrm{GL}}}_2(R)
\hookrightarrow G = {\mathop{\mathrm{GL}}}_3(R)\)</span>, embedded as the
upper-left block, we take <span class="math display">\[\tau =
    \begin{pmatrix}
      a _1  &amp; 1 &amp; 0 \\
      a _2 &amp; 0 &amp; 1 \\
      b _2  &amp; b _1  &amp; b _0  \\
    \end{pmatrix}.\]</span> The coefficients of <span
class="math inline">\({\operatorname{charpoly}}
{\paren*{\tau_H}}\)</span> are then <span class="math inline">\(\pm
a_j\)</span>, while the coefficients of <span
class="math inline">\({\operatorname{charpoly}} {\paren*{\tau}}\)</span>
are of the form <span class="math inline">\(\pm (b_j + c_j)\)</span>,
where <span class="math inline">\(c_j\)</span> depends upon the <span
class="math inline">\(a_k\)</span> and <span
class="math inline">\(b_l\)</span> for <span
class="math inline">\(l&lt;j\)</span>. By choosing suitable <span
class="math inline">\(a_j\)</span> and <span
class="math inline">\(b_j\)</span> inductively, we may thus arrange that
<span class="math inline">\(\tau\)</span> and <span
class="math inline">\(\tau_H\)</span> have prescribed characteristic
polynomials. ◻</p>
</span></div>
<div id="enumerate:vectors-e-f-are-tau-cyclic.-" class="lemma">
<p><strong>Lemma 27</strong>. <span id="lemma:stability-equivalences"
label="lemma:stability-equivalences"></span> For <span
class="math inline">\(\tau \in M\)</span>, the following are
equivalent.</p>
<ol type="i">
<li><p><span id="enumerate:p_tau-p_tau_h-generate-unit-ideal.-"
label="enumerate:p_tau-p_tau_h-generate-unit-ideal.-"></span> <span
class="math inline">\(P_\tau\)</span> and <span
class="math inline">\(P_{\tau_H}\)</span> generate the unit
ideal.</p></li>
<li><p><span
id="enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-"
label="enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-"></span>
There are no nonzero <span class="math inline">\(\tau\)</span>-invariant
submodules of <span class="math inline">\(V_H\)</span> or of <span
class="math inline">\(V_H^*\)</span>.</p></li>
<li><p><span class="math inline">\(\tau \in
M_{\mathop{\mathrm{stab}}}\)</span>.</p></li>
</ol>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We show first that <a
href="#enumerate:p_tau-p_tau_h-generate-unit-ideal.-"
data-reference-type="eqref"
data-reference="enumerate:p_tau-p_tau_h-generate-unit-ideal.-">\((i)\)</a>
implies <a
href="#enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-"
data-reference-type="eqref"
data-reference="enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-">\((ii)\)</a>.
By assumption, we may write <span class="math inline">\(a P_\tau + b
P_{\tau_H} = 1\)</span> for some <span class="math inline">\(a,b \in
R[X]\)</span>. Since <span class="math inline">\(P_\tau(\tau) =
0\)</span>, it follows that <span class="math inline">\(b(\tau)
P_{\tau_H}(\tau) = 1\)</span>. On the other hand, if <span
class="math inline">\(U\)</span> is a <span
class="math inline">\(\tau\)</span>-invariant submodule of <span
class="math inline">\(V_H\)</span> and <span class="math inline">\(u \in
U\)</span>, then <span class="math inline">\(f(\tau) u = f(\tau_H)
u\)</span> for each <span class="math inline">\(f \in R[x]\)</span>,
hence <span class="math inline">\(P_{\tau_H}(\tau) u =
P_{\tau_H}(\tau_H) u = 0\)</span>. Therefore <span
class="math inline">\(u =0\)</span>, as required.</p>
<p>We show next that <a
href="#enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-"
data-reference-type="eqref"
data-reference="enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-">\((ii)\)</a>
implies <a href="#enumerate:vectors-e-f-are-tau-cyclic.-"
data-reference-type="eqref"
data-reference="enumerate:vectors-e-f-are-tau-cyclic.-">\((iii)\)</a>.
We must check that <span class="math inline">\(e\)</span> and <span
class="math inline">\(e^*\)</span> are <span
class="math inline">\(\tau\)</span>-cyclic. Suppose otherwise that <span
class="math inline">\(R[\tau] e \neq V\)</span> or that <span
class="math inline">\(e^* R[\tau] \neq V^*\)</span>. In the first case,
we set <span class="math inline">\(U := {(R[\tau] e)}^\perp \subseteq
V^*\)</span>; in the second, <span class="math inline">\(U := {(e^* R
[\tau ])}^\perp \subseteq V\)</span>. In either case, we see that <span
class="math inline">\(U\)</span> is a non-zero <span
class="math inline">\(\tau\)</span>-invariant submodule of <span
class="math inline">\(V_H^*\)</span> or <span
class="math inline">\(V_H\)</span>, contrary to <a
href="#enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-"
data-reference-type="eqref"
data-reference="enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-">\((ii)\)</a>.</p>
<p>We show finally that <a
href="#enumerate:vectors-e-f-are-tau-cyclic.-"
data-reference-type="eqref"
data-reference="enumerate:vectors-e-f-are-tau-cyclic.-">\((iii)\)</a>
implies <a href="#enumerate:p_tau-p_tau_h-generate-unit-ideal.-"
data-reference-type="eqref"
data-reference="enumerate:p_tau-p_tau_h-generate-unit-ideal.-">\((i)\)</a>.
Suppose that <span class="math inline">\(\tau\)</span> is stable, but
that the ideal <span class="math inline">\(\mathfrak{a} \subseteq
R[X]\)</span> generated by <span class="math inline">\(P_\tau\)</span>
and <span class="math inline">\(P_{\tau_H}\)</span> is not the unit
ideal (1). Let <span class="math inline">\(\mathfrak{m}\)</span> be a
maximal ideal that contains <span
class="math inline">\(\mathfrak{a}\)</span>, and set <span
class="math inline">\(\mathfrak{p} := R \cap \mathfrak{m}\)</span>. The
stability of <span class="math inline">\(\tau\)</span> and the fact that
<span class="math inline">\(\mathfrak{a} \neq (1)\)</span> are
unaffected by modding out by <span
class="math inline">\(\mathfrak{p}\)</span>, passing to the field of
fractions of <span class="math inline">\(R / \mathfrak{p}\)</span>, and
then passing to the algebraic closure of that field. We thereby reduce
to the case that <span class="math inline">\(R\)</span> is an
algebraically closed field. Then <span
class="math inline">\(P_\tau\)</span> and <span
class="math inline">\(P_{\tau_H}\)</span> share a common root <span
class="math inline">\(c\)</span>. The remainder of the proof closely
follows that of <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, Lemma
14.4)</a>. We may find</p>
<ul>
<li><p>an eigenvector <span class="math inline">\(v \in V_H\)</span> for
<span class="math inline">\(\tau_H\)</span> with eigenvalue <span
class="math inline">\(c\)</span>, and also</p></li>
<li><p>an eigenvector <span class="math inline">\(\ell \in V^*\)</span>
for <span class="math inline">\(\tau\)</span> with eigenvalue <span
class="math inline">\(c\)</span>.</p></li>
</ul>
<p>Then <span id="eqn:ell-cdot-tau-c-cdot-v-=-0.-" class="math display">\[\label{eqn:ell-cdot-tau-c-cdot-v-=-0.-}\tag{4.1}
    \ell \cdot (\tau - c) \cdot v = 0.\]</span> We consider two
cases.</p>
<ul>
<li><p><span class="math inline">\((\tau - c) v = 0\)</span>, so that
<span class="math inline">\(v \in V_H\)</span> is an eigenvector for
<span class="math inline">\(\tau\)</span>.</p></li>
<li><p><span class="math inline">\((\tau - c) v \neq 0\)</span>. Since
<span class="math inline">\((\tau_H - c) v = 0\)</span>, it follows that
<span class="math inline">\(e\)</span> is a multiple of <span
class="math inline">\((\tau - c) v\)</span>, hence by <a
href="#eqn:ell-cdot-tau-c-cdot-v-=-0.-" data-reference-type="eqref"
data-reference="eqn:ell-cdot-tau-c-cdot-v-=-0.-">\((4.1)\)</a>
that <span class="math inline">\(\ell e = 0\)</span>, so that <span
class="math inline">\(\ell \in V_H^*\)</span> is an eigenvector for
<span class="math inline">\(\tau\)</span>.</p></li>
</ul>
<p>In either case, we have produced an eigenvector for <span
class="math inline">\(\tau\)</span> in <span
class="math inline">\(V_H\)</span> or in <span
class="math inline">\(V_H^*\)</span>. Since <span
class="math inline">\(R\)</span> is a field, the orthogonal complement
of that eigenvector defines a proper <span
class="math inline">\(\tau\)</span>-invariant subspace of <span
class="math inline">\(V^*\)</span> (resp. <span
class="math inline">\(V\)</span>) that contains the vector <span
class="math inline">\(e^*\)</span> (resp. <span
class="math inline">\(e\)</span>), contrary to our assumption that that
vector is cyclic. ◻</p>
</span></div>
<div id="lemma:stable-implies-trivial-stabilizer" class="lemma">
<p><strong>Lemma 28</strong>. Let <span class="math inline">\(\tau \in
M_{\mathop{\mathrm{stab}}}\)</span>. Then <span class="math inline">\(H
\cap G_\tau = \{1\}\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> This follows from the fact that <span
class="math inline">\(e\)</span> is <span
class="math inline">\(\tau\)</span>-cyclic and fixed by <span
class="math inline">\(H\)</span>, which shows that if <span
class="math inline">\(h \in H\)</span> commutes with <span
class="math inline">\(\tau\)</span>, then it fixes all of <span
class="math inline">\(V\)</span>, hence <span class="math inline">\(h =
1\)</span>. ◻</p>
</span></div>
<div id="lemma:tau-stable-implies-tauH-cyclic" class="lemma">
<p><strong>Lemma 29</strong>. Let <span class="math inline">\(\tau \in
M_{\mathop{\mathrm{stab}}}\)</span>. Then <span
class="math inline">\(\tau_H\)</span> is cyclic, that is to say, <span
class="math inline">\(V_H\)</span> and, equivalently, <span
class="math inline">\(V_H^*\)</span>, are <span
class="math inline">\(\tau_H\)</span>-cyclic.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We will show that <span
class="math inline">\(V_H^*\)</span> is cyclic; a similar argument
applies to <span class="math inline">\(V_H\)</span>. We will verify more
precisely that <span class="math display">\[\ell : V_H \rightarrow R,
\qquad \ell(v) := e^* \tau v\]</span> defines a <span
class="math inline">\(\tau_H\)</span>-cyclic vector <span
class="math inline">\(\ell \in V_H^*\)</span>, that is to say, <span id="eqn:ell-rtau_h-=-v_h.-" class="math display">\[\label{eqn:ell-rtau_h-=-v_h.-}\tag{4.2}
    \ell R[\tau_H] = V_H^*.\]</span> In verifying this, we may assume
that <span class="math inline">\(R\)</span> is a local ring, and then
(by Nakayama’s lemma) that <span class="math inline">\(R\)</span> is a
field. In that case, if <a href="#eqn:ell-rtau_h-=-v_h.-"
data-reference-type="eqref"
data-reference="eqn:ell-rtau_h-=-v_h.-">\((4.2)\)</a>
fails, then the orthogonal complement of <span
class="math inline">\(\ell R[\tau_H]\)</span> is a nonzero <span
class="math inline">\(\tau_H\)</span>-invariant subspace <span
class="math inline">\(U\)</span> of <span
class="math inline">\(V_H\)</span>. By construction, <span
class="math inline">\(0 = \ell(U) = e^* \tau U\)</span>, so <span
class="math inline">\(\tau|_{U} = \tau_H|_{U}\)</span>. Thus <span
class="math inline">\(U\)</span> is in fact a <span
class="math inline">\(\tau\)</span>-invariant subspace of <span
class="math inline">\(V_H\)</span>, which by part <a
href="#enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-"
data-reference-type="eqref"
data-reference="enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-">\((ii)\)</a>
of Lemma <a href="#lemma:stability-equivalences"
data-reference-type="ref"
data-reference="lemma:stability-equivalences">4.5</a>
yields <span class="math inline">\(U = 0\)</span>, giving the required
contradiction. ◻</p>
</span></div>
<h1 id="sec:transversality">§5. Transversality</h1>
<h2 id="sec:transversality-statement-results">§5.1. Statement of results</h2>
<p>For <span class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span>, <span
class="math inline">\(a \in \mathbf{G}(R)\)</span>, we define a
subfunctor <span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> of
<span class="math inline">\(\mathbf{H}_{\tau_H}\)</span> over <span
class="math inline">\(R\)</span>, as follows: for each ring extension
<span class="math inline">\(R&#39;\)</span> of <span
class="math inline">\(R\)</span>, <span
class="math display">\[\mathbf{X}_{\tau,a}(R&#39;) := \left\{ y \in
\mathbf{H}_{\tau_H}(R&#39;) : a y \in \mathbf{H}(R&#39;)
\mathbf{G}_{\tau}(R&#39;) \right\}.\]</span> As we explain below
(Lemma <a href="#lemma:each-ring-extens-r-r-we-have-begin-mathbfhr-m"
data-reference-type="ref"
data-reference="lemma:each-ring-extens-r-r-we-have-begin-mathbfhr-m">5.8</a>),
it defines a closed subscheme.</p>
<p>We observe that if <span class="math inline">\(a\)</span> lies in
<span class="math inline">\(\mathbf{H}(R) \mathbf{Z}(R)\)</span>, then
<span class="math inline">\(\mathbf{X}_{\tau,a} =
\mathbf{H}_{\tau_H}\)</span>, that is, their point sets coincide for all
ring extensions <span class="math inline">\(R&#39;\)</span> of <span
class="math inline">\(R\)</span>. Indeed, if <span
class="math inline">\(a = h z\)</span> with <span
class="math inline">\((h,z) \in \mathbf{H}(R) \mathbf{Z}(R)\)</span>,
then for each <span class="math inline">\(y \in
\mathbf{H}_{\tau_H}(R&#39;)\)</span>, we have <span
class="math display">\[a y = h z y = (h y) z \in \mathbf{H}(R&#39;)
\mathbf{G}_{\tau}(R&#39;).\]</span> The main result of this section is
the following converse:</p>
<div id="theorem:main-transversality-general-ring" class="theorem">
<p><strong>Theorem 30</strong>. <em>Assume that <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) \geq
3\)</span>. Let <span class="math inline">\(R\)</span> be a ring in
which <span class="math inline">\(2\)</span> is a unit. Let <span
class="math inline">\((\tau,a) \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R) \times \mathbf{G}(R)\)</span>.
Suppose that <span class="math inline">\(\mathbf{X}_{\tau,a} =
\mathbf{H}_{\tau_H}\)</span> (as schemes over <span
class="math inline">\(R\)</span>). Then <span class="math inline">\(a
\in \mathbf{H}(R) \mathbf{Z}(R)\)</span>.</em></p>
</div>
<div class="remark">
<p><strong>Remark 31</strong> (Sharpness with respect to the rank). The
conclusion of Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a> clearly
fails when <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) = 1\)</span>,
since in that case, <span
class="math inline">\(\mathbf{H}_{\tau_H}\)</span> is trivial. The
conclusion may fail also when <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) = 2\)</span>.
For example, take <span class="math inline">\(\mathbf{V} =
\mathbb{Z}^2\)</span> with standard basis <span
class="math inline">\(e_1,e_2\)</span>. Let <span
class="math inline">\(e_1^*,e_2^*\)</span> denote the corresponding dual
basis of <span class="math inline">\(\mathbf{V}^*\)</span>. Take <span
class="math inline">\(e := e_2\)</span> and <span
class="math inline">\(e^* := e_2^*\)</span>, so that <span
class="math display">\[\mathbf{H} =
    \begin{pmatrix}
      \ast &amp; 0 \\
      0 &amp; 1 \\
    \end{pmatrix} \leq \mathbf{G}.\]</span> Take <span
class="math display">\[\tau := a :=
    \begin{pmatrix}
      0 &amp; 1 \\
      1 &amp; 0 \\
    \end{pmatrix}.\]</span> Then for any ring <span
class="math inline">\(R\)</span>, we see that <span
class="math inline">\(a\)</span> does not lie in <span
class="math inline">\(\mathbf{H}(R) \mathbf{Z}(R)\)</span> (although it
does normalize it). On the other hand, for any <span
class="math display">\[y
    =
    \begin{pmatrix}
      y_1 &amp; 0 \\
      0 &amp; 1 \\
    \end{pmatrix}
    \in \mathbf{H}_{\tau_H}(R) = \mathbf{H}(R),\]</span> we have <span
class="math display">\[a y = h b \quad \text{ with }
    h :=
    \begin{pmatrix}
      y_1^{-1} &amp; 0 \\
      0 &amp; 1 \\
    \end{pmatrix} \in \mathbf{H}(R),
    \quad
    b :=
    \begin{pmatrix}
      0 &amp; y_1 \\
      y_1 &amp; 0 \\
    \end{pmatrix} \in \mathbf{G}_\tau(R).\]</span> Thus <span
class="math inline">\(\mathbf{X}_{\tau,a} =
\mathbf{H}_{\tau_H}\)</span>. The proof of Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a> can be
adapted to show that these are essentially the only counterexamples when
<span class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) =
2\)</span>. This discussion suggests that Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a> should
be related to the fact that <span class="math inline">\(\mathbf{H}
\mathbf{Z}\)</span> has trivial normalizer in <span
class="math inline">\(\mathbf{G}\)</span> when <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) \geq
3\)</span>, although we did not spot a direct way to relate the two
conditions.</p>
</div>
<div id="remark:we-have-seen-comp-calc-with-grobn-bases-that-when-"
class="remark">
<p><strong>Remark 32</strong> (Sharpness with respect to the ring). We
have seen by computer calculation with Gröbner bases that when <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) \in
\{3,4\}\)</span>, there exist fields <span
class="math inline">\(R\)</span> of characteristic <span
class="math inline">\(2\)</span> over which there are counterexamples to
the conclusion of Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a>. We see
no reason why such examples should not exist in any rank.</p>
</div>
<p>Theorem <a href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a> is a
consequence of some more precise assertions that we now formulate.</p>
<div id="definition:let-r-be-ring.-let-a-in-mathbfgr-y-in-mathbfx_t-ar"
class="definition">
<p><strong>Definition 33</strong>. Let <span
class="math inline">\(R\)</span> be a ring. We define the extension
rings <span class="math display">\[R&#39; :=
R[\varepsilon]/(\varepsilon^2), \quad
    R&#39;&#39; :=
R[\varepsilon_1,\varepsilon_2]/(\varepsilon_1^2,\varepsilon_2^2),\]</span>
which come with natural maps <span class="math inline">\(R&#39;
\rightarrow R\)</span> and <span class="math inline">\(R&#39;&#39;
\rightarrow R\)</span> obtained by sending <span
class="math inline">\(\varepsilon, \varepsilon_1, \varepsilon_2\)</span>
to zero. For a scheme <span class="math inline">\(\mathbf{X}\)</span>,
we say that <span class="math inline">\(y&#39; \in
\mathbf{X}(R&#39;)\)</span> lies over <span class="math inline">\(y \in
\mathbf{X}(R)\)</span> if <span class="math inline">\(y&#39; \mapsto
y\)</span> under the induced map <span
class="math inline">\(\mathbf{X}(R&#39;) \rightarrow
\mathbf{X}(R)\)</span>, and similarly for <span
class="math inline">\(R&#39;&#39;\)</span>.</p>
<p>Let <span class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span>, <span
class="math inline">\(a \in \mathbf{G}(R)\)</span> and <span
class="math inline">\(y \in \mathbf{X}_{\tau,a}(R)\)</span>.</p>
<ol>
<li><p>We say that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is <em>tangential at
<span class="math inline">\(y\)</span> over <span
class="math inline">\(R\)</span></em> if for all <span
class="math inline">\(y&#39; \in \mathbf{H}_{\tau_H}(R&#39;)\)</span>
lying over <span class="math inline">\(y\)</span>, we have <span
class="math inline">\(y&#39; \in
\mathbf{X}_{\tau,a}(R&#39;)\)</span>.</p></li>
<li><p>We say that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
<em>doubly-tangential at <span class="math inline">\(y\)</span> over
<span class="math inline">\(R\)</span></em> if for all <span
class="math inline">\(y&#39;&#39; \in
\mathbf{H}_{\tau_H}(R&#39;&#39;)\)</span> lying over <span
class="math inline">\(y\)</span>, we have <span
class="math inline">\(y&#39;&#39; \in
\mathbf{X}_{\tau,a}(R&#39;&#39;)\)</span>.</p></li>
</ol>
</div>
<p>The informal content is that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is tangential
(resp. doubly-tangential) at <span class="math inline">\(y\)</span> over
<span class="math inline">\(R\)</span> if the polynomials whose
vanishing defines <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> over <span
class="math inline">\(R\)</span> have the property that their Taylor
series at <span class="math inline">\(y\)</span> vanish to order at
least <span class="math inline">\(2\)</span> (resp. <span
class="math inline">\(3\)</span>).</p>
<div id="theorem:characterization-of-tangential-points" class="theorem">
<p><strong>Theorem 34</strong>. <em>Retain the setting of Definition <a
href="#definition:let-r-be-ring.-let-a-in-mathbfgr-y-in-mathbfx_t-ar"
data-reference-type="ref"
data-reference="definition:let-r-be-ring.-let-a-in-mathbfgr-y-in-mathbfx_t-ar">5.4</a>.
The following are equivalent:</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
tangential at <span class="math inline">\(y\)</span> over <span
class="math inline">\(R\)</span>.</em></p></li>
<li><p><em>For the (unique) elements <span class="math inline">\((h,b)
\in \mathbf{H}(R) \times \mathbf{G}_\tau(R)\)</span> defined by writing
<span class="math inline">\(a y = h b\)</span>, we have <span
class="math inline">\(b^2 \in \mathbf{Z}(R)\)</span>.</em></p></li>
</ol>
</div>
<div
id="theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential"
class="theorem">
<p><strong>Theorem 35</strong>. <em>Retain the setting of Definition <a
href="#definition:let-r-be-ring.-let-a-in-mathbfgr-y-in-mathbfx_t-ar"
data-reference-type="ref"
data-reference="definition:let-r-be-ring.-let-a-in-mathbfgr-y-in-mathbfx_t-ar">5.4</a>.
Assume that</em></p>
<ul>
<li><p><em><span class="math inline">\(2\)</span> is a unit in <span
class="math inline">\(R\)</span>, and</em></p></li>
<li><p><em><span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) \geq
3\)</span>.</em></p></li>
</ul>
<p><em>Then the following are equivalent:</em></p>
<ol type="i">
<li><p><em><span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
doubly-tangential at <span class="math inline">\(y\)</span> over <span
class="math inline">\(R\)</span>.</em></p></li>
<li><p><em>We have <span class="math inline">\(a \in \mathbf{H}(R)
\mathbf{Z}(R)\)</span>.</em></p></li>
</ol>
</div>
<p>Theorem <a
href="#theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential"
data-reference-type="ref"
data-reference="theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential">5.6</a>
implies in particular that, under the hypotheses of Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a>, if
<span class="math inline">\(a \notin \mathbf{H}(R)
\mathbf{Z}(R)\)</span>, then <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> fails to be
doubly-tangential at every point <span class="math inline">\(y \in
\mathbf{X}_{\tau,a}(R)\)</span>. In particular, <span
class="math inline">\(\mathbf{X}_{\tau,a} \neq
\mathbf{H}_{\tau_H}\)</span>, so the conclusion of Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a> holds.
The remainder of this section is devoted to the proofs of Theorems <a
href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>
and <a
href="#theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential"
data-reference-type="ref"
data-reference="theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential">5.6</a>.</p>
<h2 id="Sec:polyEqn">§5.2. Defining <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> by polynomial
equations</h2>
<p>Let <span class="math inline">\(R\)</span> be a ring, and let <span
class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span>. By Lemma <a
href="#lemma:centralizer-description" data-reference-type="ref"
data-reference="lemma:centralizer-description">3.7</a>, the maps <span
class="math display">\[\begin{align}
  &amp;\bullet e : \mathbf{M}_{\tau}(R) \rightarrow \mathbf{V}(R), \quad
&amp;&amp;x \mapsto x e \\
  &amp;e^* \bullet  : \mathbf{M}_{\tau}(R) \rightarrow \mathbf{V}^*(R),
\quad &amp;&amp;x \mapsto e^* x
\end{align}\]</span> are linear isomorphisms (i.e., isomorphisms of
<span class="math inline">\(R\)</span>-modules). We denote by <span
class="math display">\[\begin{align}
  &amp;{[\bullet e]}^{-1} : \mathbf{V}(R) \rightarrow
\mathbf{M}_\tau(R), \quad \\
  &amp;{[e^* \bullet]}^{-1} : \mathbf{V}^*(R) \rightarrow
\mathbf{M}_\tau(R)
\end{align}\]</span> their inverses. These extend to linear
isomorphisms over any ring extension <span
class="math inline">\(R&#39;\)</span> of <span
class="math inline">\(R\)</span>.</p>
<p>We note the following equivariance property:</p>
<div id="lemma:equivariance-property-of-bullet-e-e-star-inverse-maps"
class="lemma">
<p><strong>Lemma 36</strong>. For any <span class="math inline">\(v \in
\mathbf{V}(R)\)</span> (resp. <span class="math inline">\(v^* \in
\mathbf{V}^*(R)\)</span>) and <span class="math inline">\(a \in
\mathbf{G}_{\tau}(R)\)</span>, we have <span
class="math display">\[{[\bullet e]}^{-1}(a v) = a {[\bullet
e]}^{-1}(v), \qquad {[e^* \bullet ]}^{-1}(v^* a) = {[e^*
\bullet]}^{-1}(v^*) a.\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By definition, <span class="math inline">\({[\bullet
e]}^{-1}(v)\)</span> is the unique element of <span
class="math inline">\(\mathbf{M}_\tau(R)\)</span> with <span
class="math inline">\({[\bullet e]}^{-1}(v) e = v\)</span>, while <span
class="math inline">\({[\bullet e]}^{-1}(a v)\)</span> is the unique
element with <span class="math inline">\({[\bullet e]}^{-1}(a v) e = a
v\)</span>. It is clear then that <span class="math inline">\(a
{[\bullet e]}^{-1}(v) = {[\bullet e]}^{-1}(a v)\)</span>. A similar
argument gives the second identity. ◻</p>
</span></div>
<div id="lemma:each-ring-extens-r-r-we-have-begin-mathbfhr-m"
class="lemma">
<p><strong>Lemma 37</strong>. For each ring extension <span
class="math inline">\(R&#39;\)</span> of <span
class="math inline">\(R\)</span>, we have <span id="eqn:mathbfhr-mathbfg_t-=-left-g-in-mathbfgr-:-bull-e-1" class="math display">\[\label{eqn:mathbfhr-mathbfg_t-=-left-g-in-mathbfgr-:-bull-e-1}\tag{5.1}
    \mathbf{H}(R&#39;) \mathbf{G}_\tau(R&#39;) =
    \left\{
      g \in \mathbf{G}(R&#39;) :
      {[e^* \bullet]}^{-1}( e^* g) {[\bullet e]}^{-1}(g^{-1} e)  = 1
    \right\}.\]</span> In particular, <span class="math inline">\(R&#39;
\mapsto \mathbf{H}(R&#39;) \mathbf{G}_\tau(R&#39;)\)</span> defines a
closed subscheme of <span class="math inline">\(\mathbf{G}\)</span> over
<span class="math inline">\(R\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Suppose <span class="math inline">\(g = h b\)</span>
with <span class="math inline">\((h,b) \in \mathbf{H}(R&#39;) \times
\mathbf{G}_\tau(R&#39;)\)</span>. Then <span
class="math inline">\(g^{-1} e = b^{-1} e\)</span> and <span
class="math inline">\(e^* g = e^* b\)</span>, so <span
class="math display">\[{[e^* \bullet]}^{-1}( e^* g) {[\bullet
e]}^{-1}(g^{-1} e) = b b^{-1} = 1.\]</span></p>
<p>Conversely, suppose <span class="math inline">\(g\)</span> belongs to
the right hand side of <a
href="#eqn:mathbfhr-mathbfg_t-=-left-g-in-mathbfgr-:-bull-e-1"
data-reference-type="eqref"
data-reference="eqn:mathbfhr-mathbfg_t-=-left-g-in-mathbfgr-:-bull-e-1">\((5.1)\)</a>,
Then, defining <span class="math inline">\(b, b&#39; \in
\mathbf{M}_{\tau}(R&#39;)\)</span> by <span class="math inline">\(b&#39;
:= {[\bullet e]}^{-1}(g^{-1} e)\)</span> and <span
class="math inline">\(b := {[e^* \bullet]}^{-1}(e^* g)\)</span>, we have
<span class="math inline">\(b&#39; b = 1\)</span>. It follows that <span
class="math inline">\(b \in \mathbf{G}_\tau(R&#39;)\)</span>. Moreover,
<span class="math inline">\(h := g b^{-1}\)</span> satisfies <span
class="math inline">\(h e = e\)</span> and <span
class="math inline">\(e^* h = e^*\)</span>, hence <span
class="math inline">\(h \in \mathbf{H}(R&#39;)\)</span>. ◻</p>
</span></div>
<div id="corollary:let-begin-f-:-mathbfh_t-right-mathbfm_t-"
class="corollary">
<p><strong>Corollary 38</strong>. <em>Let <span class="math display">\[f
: \mathbf{H}_{\tau_H} \rightarrow \mathbf{M}_\tau\]</span> denote the
map of schemes over <span class="math inline">\(R\)</span> defined by
<span class="math display">\[f(y) := {[e^* \bullet]}^{-1}( e^* a y)
{[\bullet e]}^{-1}({(a y)}^{-1} e).\]</span> Then <span
class="math display">\[\mathbf{X}_{\tau, a}(R&#39;)
    =
    \left\{
      y \in \mathbf{H}_{\tau_H}(R&#39;) :
      f(y) = 1
    \right\}.\]</span> In particular, <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> defines a closed
subscheme of <span class="math inline">\(\mathbf{H}_{\tau_H}\)</span>
over <span class="math inline">\(R\)</span>.</em></p>
</div>
<div id="remark:rewrite-defining-equations-for-X-as-polynomials"
class="remark">
<p><strong>Remark 39</strong>. We may rewrite the defining equation
<span class="math inline">\(f(y) = 1\)</span> for <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> using Cramer’s rule
for <span class="math inline">\(y^{-1}\)</span>, as follows: <span
class="math display">\[{[e^* \bullet]}^{-1}( e^* a y) {[\bullet
e]}^{-1}(y^{\mathrm{adj}} a^{-1} e) = \det(y).\]</span> Here <span
class="math inline">\(y^{\mathrm{adj}}\)</span> denotes the adjucate or
cofactor matrix, characterized by the identity <span
class="math inline">\(y y^{\mathrm{adj}} = \det(y)\)</span>. Writing
<span class="math inline">\(n+1 =
\mathop{\mathrm{rank}}(\mathbf{V})\)</span>, so that <span
class="math inline">\(\mathbf{M}_{\tau}\)</span> has rank <span
class="math inline">\(n+1\)</span>, one can see that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is defined by <span
class="math inline">\(n+1\)</span> polynomial equations of degree at
most <span class="math inline">\(n\)</span> in the entries of <span
class="math inline">\(y\)</span>. Indeed, one can parameterize <span
class="math inline">\(\mathbf{H}_{\tau_H}\)</span> using Lemma <a
href="#lemma:centralizer-description" data-reference-type="ref"
data-reference="lemma:centralizer-description">3.7</a> with <span
class="math inline">\(n\)</span> variables, say, <span
class="math inline">\(y_1,\cdots y_n\)</span>. Then</p>
<ul>
<li><p>each entry of the row vector <span class="math inline">\(e^* a
y\)</span> is an affine function of the <span
class="math inline">\(y_i\)</span> (i.e., a linear combination of the
<span class="math inline">\(y_i\)</span> and <span
class="math inline">\(1\)</span>),</p></li>
<li><p>the coefficients of <span class="math inline">\({[e^*
\bullet]}^{-1}( e^* a y)\in \mathbf{M}_\tau\)</span> are likewise affine
functions of the <span class="math inline">\(y_i\)</span>,</p></li>
<li><p>the matrices <span class="math inline">\(y^{\mathrm{adj}},
y^{\mathrm{adj}} a^{-1} e\)</span> and <span
class="math inline">\({[\bullet e]}^{-1}(y^{\mathrm{adj}} a^{-1}
e)\)</span> have entries given by polynomials in the <span
class="math inline">\(y_i\)</span> of total degree at most <span
class="math inline">\(n-1\)</span>, and</p></li>
<li><p><span class="math inline">\(\det(y)\)</span> is a polynomial in
the <span class="math inline">\(y_i\)</span> of total degree <span
class="math inline">\(n\)</span>.</p></li>
</ul>
<p>Finally, the condition <span class="math display">\[{[e^*
\bullet]}^{-1}( e^* a y) {[\bullet e]}^{-1}(y^{\mathrm{adj}} a^{-1} e) =
\det(y)\]</span> is an equality of elements of <span
class="math inline">\(\mathbf{G}_\tau\)</span>, whose <span
class="math inline">\(n+1\)</span> coefficients give rise to <span
class="math inline">\(n+1\)</span> polynomial equations of degree at
most <span class="math inline">\(n\)</span> in the <span
class="math inline">\(y_i\)</span>.</p>
</div>
<h2 id="sec:reduction-centralizer">§5.3. Reduction to the centralizer</h2>
<p>The set <span class="math inline">\(\mathbf{X}_{\tau,a}(R)\)</span>
is empty unless we can find <span class="math inline">\(h \in
\mathbf{H}(R)\)</span> and <span class="math inline">\(y \in
\mathbf{H}_{\tau_H}(R)\)</span> so that <span class="math inline">\(b :=
h a y \in \mathbf{G}_\tau(R)\)</span>. Then for all ring extensions
<span class="math inline">\(R&#39;\)</span> of <span
class="math inline">\(R\)</span>, we have <span
class="math display">\[\mathbf{X}_{\tau,a}(R&#39;) = y
\mathbf{X}_{\tau,b}(R&#39;).\]</span> Furthermore, for each point <span
class="math inline">\(z\in \mathbf{X}_{\tau, b}(R)\)</span>, the
following are equivalent:</p>
<ol>
<li><p><span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
tangential (resp. doubly-tangential) at <span
class="math inline">\(yz\)</span>.</p></li>
<li><p><span class="math inline">\(\mathbf{X}_{\tau,b}\)</span> is
tangential (resp. doubly-tangential) at <span
class="math inline">\(z\)</span>.</p></li>
</ol>
<p>This last equivalence holds in particular for <span
class="math inline">\(z = 1\)</span>, which lies in <span
class="math inline">\(\mathbf{X}_{\tau,b}(R)\)</span> because <span
class="math inline">\(b\)</span> lies in <span
class="math inline">\(\mathbf{G}_\tau(R)\)</span>. In this way, many
questions concerning the <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> may be reduced to the
case <span class="math inline">\(a \in \mathbf{G}_\tau(R)\)</span> and
<span class="math inline">\(y = 1\)</span>.</p>
<div class="definition">
<p><strong>Definition 40</strong>. Given <span class="math inline">\(a
\in \mathbf{G}_\tau(R)\)</span>, we denote by <span
class="math display">\[\mu, \nu : \mathbf{M}_{H,\tau_H}(R) \rightarrow
\mathbf{M}_{\tau}(R)\]</span> the linear maps given by <span
class="math display">\[\mu(u) := {[e^* \bullet]}^{-1}( e^* a u a^{-1}
),\]</span> <span class="math display">\[\nu(u) :=  {[\bullet e]}^{-1}(a
u a^{-1}  e).\]</span></p>
</div>
<p>We may use the equivariance property noted in Lemma <a
href="#lemma:equivariance-property-of-bullet-e-e-star-inverse-maps"
data-reference-type="ref"
data-reference="lemma:equivariance-property-of-bullet-e-e-star-inverse-maps">5.7</a>
to rewrite the map <span class="math inline">\(f\)</span> from
Corollary <a href="#corollary:let-begin-f-:-mathbfh_t-right-mathbfm_t-"
data-reference-type="ref"
data-reference="corollary:let-begin-f-:-mathbfh_t-right-mathbfm_t-">5.9</a>
as <span class="math display">\[f(y) = \mu(y) \nu(y^{-1}).\]</span></p>
<h2 id="sec:analysis-first-derivatives">§5.4. Linear analysis</h2>
<p>In this section, we prove Theorem <a
href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>.
By replacing <span class="math inline">\(a\)</span> with <span
class="math inline">\(a y\)</span>, we may reduce to the case <span
class="math inline">\(y = 1\)</span>. By then replacing <span
class="math inline">\(a\)</span> with <span class="math inline">\(h^{-1}
a\)</span>, we may reduce further to the case that <span
class="math inline">\(a = b \in \mathbf{G}_\tau(R)\)</span>. The
required equivalence then follows from that between <a
href="#itemize:mathbfx_tau-a-has-first-order-tangency-at-1.-"
data-reference-type="eqref"
data-reference="itemize:mathbfx_tau-a-has-first-order-tangency-at-1.-">\((i)\)</a>
and <a href="#itemize:we-have-a2-in-mathbfzr.-"
data-reference-type="eqref"
data-reference="itemize:we-have-a2-in-mathbfzr.-">\((iv)\)</a>
in Proposition <a
href="#lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol"
data-reference-type="ref"
data-reference="lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol">5.12</a>,
below.</p>
<div id="itemize:we-have-a2-in-mathbfzr.-" class="proposition">
<p><strong>Proposition 41</strong>. <em><span
id="lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol"
label="lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol"></span>
Let <span class="math inline">\(R\)</span> be a ring, <span
class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span>, <span
class="math inline">\(a \in \mathbf{G}_\tau(R)\)</span>. The following
are equivalent:</em></p>
<ol type="i">
<li><p><em><span
id="itemize:mathbfx_tau-a-has-first-order-tangency-at-1.-"
label="itemize:mathbfx_tau-a-has-first-order-tangency-at-1.-"></span>
<span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is tangential
at <span class="math inline">\(1\)</span> over <span
class="math inline">\(R\)</span>.</em></p></li>
<li><p><em><span
id="itemize:line-isom-begin-mu-nu-:-mathbfm_h-tau_hr-right-mat"
label="itemize:line-isom-begin-mu-nu-:-mathbfm_h-tau_hr-right-mat"></span>
The maps <span class="math inline">\(\mu\)</span> and <span
class="math inline">\(\nu\)</span> attached to <span
class="math inline">\(a\)</span> as in §<a
href="#sec:reduction-centralizer" data-reference-type="ref"
data-reference="sec:reduction-centralizer">5.3</a> satisfy <span id="eqn:mu-=-nu.-" class="math display">\[\label{eqn:mu-=-nu.-}\tag{5.2}
      \mu = \nu.\]</span></em></p></li>
<li><p><em><span
id="itemize:j-geq-0-define-begin-a_j-:=-e-tauj-e-quad-b_j-:=-e"
label="itemize:j-geq-0-define-begin-a_j-:=-e-tauj-e-quad-b_j-:=-e"></span>
For <span class="math inline">\(j \geq 0\)</span>, define <span
class="math display">\[A_j := e^* a \tau^j e, \quad B_j := e^* a^{-1}
\tau^j e.\]</span> Then <span id="eqn:a_j-a-1-=-b_j-" class="math display">\[\label{eqn:a_j-a-1-=-b_j-}\tag{5.3}
      A_j a^{-1} = B_j a.\]</span></em></p></li>
<li><p><em>We have <span class="math inline">\(a^2 \in
\mathbf{Z}(R)\)</span>.</em></p></li>
</ol>
</div>
<p>The proof uses the following key lemma.</p>
<div id="lemma:there-exist-c_ij-in-rtau-0-leq-i-leq-j-with-c_i-i-"
class="lemma">
<p><strong>Lemma 42</strong>. There exist <span
class="math inline">\(c_{ij} \in M_\tau\)</span> (<span
class="math inline">\(0 \leq i \leq j\)</span>), with <span
class="math inline">\(c_{i i} = 1\)</span>, so that for each <span
class="math inline">\(j \geq 0\)</span>, <span id="eqn:mu-tau_hj--nu-tau_hj--=-sum_i-leq-j-c_i-j--left-a" class="math display">\[\label{eqn:mu-tau_hj--nu-tau_hj--=-sum_i-leq-j-c_i-j--left-a}\tag{5.4}
    \mu  (\tau_H^j ) - \nu (\tau_H^j )
    = \sum_{i \leq j}
    c_{i j }  \left( B_i a - A_i a^{-1} \right).\]</span> Here and
henceforth, we adopt the convention <span
class="math display">\[\tau_H^0 := 1_H.\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We induct on <span class="math inline">\(j\)</span>.
We consider first the case <span class="math inline">\(j = 0\)</span>.
By definition, <span class="math inline">\(\nu(1_H)\)</span> is the
element of <span class="math inline">\(\mathbf{M}_\tau(R)\)</span> such
that <span class="math display">\[\nu(1_H) e = a 1_H a ^{-1} e.\]</span>
Expanding out <span class="math inline">\(1_H = 1 - e e^*\)</span> gives
<span class="math display">\[a 1_H a^{-1} e = e - a e e^* a ^{-1}
e.\]</span> Recognizing <span class="math inline">\(e^* a^{-1}
e\)</span> as the scalar <span class="math inline">\(B_0\)</span>, we
deduce that <span class="math display">\[\nu(1_H) e = (1 - B_0 a)
e.\]</span> Since <span class="math inline">\(1 - B_0 a \in
\mathbf{M}_{\tau}(R)\)</span>, it follows from the definition of <span
class="math inline">\(\nu\)</span> that <span
class="math display">\[\nu(1_H) = 1 - B_0 a.\]</span> A similar argument
gives <span id="eqn:nu1_h-=-1-a_0-a-1.-" class="math display">\[\label{eqn:nu1_h-=-1-a_0-a-1.-}\tag{5.5}
    \mu(1_H) = 1 - A_0 a^{-1}.\]</span> Thus the required identity <a
href="#eqn:mu-tau_hj--nu-tau_hj--=-sum_i-leq-j-c_i-j--left-a"
data-reference-type="eqref"
data-reference="eqn:mu-tau_hj--nu-tau_hj--=-sum_i-leq-j-c_i-j--left-a">\((5.4)\)</a>
holds for <span class="math inline">\(j = 0\)</span> (with <span
class="math inline">\(c_{0 0} = 1\)</span>).</p>
<p>We now aim to verify <a
href="#eqn:mu-tau_hj--nu-tau_hj--=-sum_i-leq-j-c_i-j--left-a"
data-reference-type="eqref"
data-reference="eqn:mu-tau_hj--nu-tau_hj--=-sum_i-leq-j-c_i-j--left-a">\((5.4)\)</a>
for given <span class="math inline">\(j \geq 1\)</span>, assuming that
it holds for all smaller values of <span
class="math inline">\(j\)</span>. We expand <span
class="math display">\[\begin{align}
    \tau_H^j &amp;= (1 - e e^*) \tau (1 - e e^\ast) \tau \dotsb (1 - e
e^*) \tau (1 - e e^*) \\
             &amp;=
               \tau^j - e e^* \tau^j - \tau^j e e^* + \dotsb,
  
\end{align}\]</span> where <span class="math inline">\(\dotsb\)</span>
denotes a linear combination of terms of the form <span id="eqn:tauj_1-e-e-tauj_2-quad-0-leq-j_1-j_2--j-" class="math display">\[\label{eqn:tauj_1-e-e-tauj_2-quad-0-leq-j_1-j_2--j-}\tag{5.6}
    \tau^{j_1} e e^* \tau^{j_2} \quad (0 \leq j_1, j_2 &lt; j)\]</span>
that is symmetric with respect to <span
class="math inline">\(j_1\)</span> and <span
class="math inline">\(j_2\)</span>. For instance, when <span
class="math inline">\(j = 1\)</span>, we have <span
class="math display">\[\dotsb =
    e e^\ast \tau e e^\ast
    =
    e (e^\ast \tau e) e^\ast
    =
    (e^* \tau e) e e^*,\]</span> which is a multiple of the vector <span
class="math inline">\(e e^\ast\)</span> (i.e., <a
href="#eqn:tauj_1-e-e-tauj_2-quad-0-leq-j_1-j_2--j-"
data-reference-type="eqref"
data-reference="eqn:tauj_1-e-e-tauj_2-quad-0-leq-j_1-j_2--j-">\((5.6)\)</a>
with <span class="math inline">\(j_1 = j_2 = 0\)</span>). Arguing like
in the <span class="math inline">\(j=0\)</span> case, we obtain <span id="eqn:20230516005320" class="math display">\[\begin{align}
\label{eqn:20230516005320}\tag{5.7}
    \mu(\tau_H^j) &amp;= \tau^j - A_j a^{-1} - A_0 a^{-1} \tau ^j +
\dotsb, \\  \nonumber
    \nu(\tau_H^j) &amp;= \tau^j - B_j a - B_0 a \tau ^j + \dotsb,
  
\end{align}\]</span> where <span class="math inline">\(\dotsb\)</span>
denotes a linear combination of terms given in the first case by <span
class="math inline">\(A_{j_1} \tau^{j_2} a^{-1}\)</span> and in the
second by <span class="math inline">\(B_{j_1} a \tau^{j_2}\)</span>.
Taking differences, we obtain <span class="math display">\[\mu(\tau_H^j)
- \nu(\tau_H^j) = (B_j a - A_j a^{-1} ) + \tau^j (B_0 a -  A_0 a^{-1}) +
\dotsb,\]</span> where <span class="math inline">\(\dotsb\)</span>
denotes a linear combination of differences <span
class="math display">\[\tau^{j_2} (B_{j_1} a - A_{j_1} a^{-1}).\]</span>
with <span class="math inline">\(j_1,j_2 &lt; j\)</span>. ◻</p>
</span></div>
<div class="proof">
<p><em>Proof of Proposition <a
href="#lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol"
data-reference-type="ref"
data-reference="lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol">5.12</a>.</em>
We check first that <a
href="#itemize:mathbfx_tau-a-has-first-order-tangency-at-1.-"
data-reference-type="eqref"
data-reference="itemize:mathbfx_tau-a-has-first-order-tangency-at-1.-">\((i)\)</a>
is equivalent to <a
href="#itemize:line-isom-begin-mu-nu-:-mathbfm_h-tau_hr-right-mat"
data-reference-type="eqref"
data-reference="itemize:line-isom-begin-mu-nu-:-mathbfm_h-tau_hr-right-mat">\((ii)\)</a>.
For <span class="math inline">\(u \in \mathbf{M}_{H,\tau_H}(R)\)</span>,
set <span class="math display">\[y := 1 + \varepsilon u \in
\mathbf{H}_{\tau_H}(R&#39;).\]</span> Then <span
class="math inline">\(y^{-1} = 1 - \varepsilon u\)</span>, so <span
class="math display">\[{[e^* \bullet]}^{-1}(e^* a y) = a +
\varepsilon{[e^* \bullet]}^{-1}(e^* a u),\]</span> <span
class="math display">\[{[\bullet e]}^{-1} ( {(a y ) }^{-1} e) = a^{-1} -
\varepsilon{[\bullet e]}^{-1} ( u a^{-1} e).\]</span> Multiplying these
together and applying the equivariance properties noted in Lemma <a
href="#lemma:equivariance-property-of-bullet-e-e-star-inverse-maps"
data-reference-type="ref"
data-reference="lemma:equivariance-property-of-bullet-e-e-star-inverse-maps">5.7</a>,
we obtain <span class="math display">\[\begin{align}
    f(y) &amp;= 1 + \varepsilon\left(
           {[e^* \bullet]}^{-1}(e^* a u a^{-1})
           -
           {[\bullet e]}^{-1}(a u a ^{-1} e)
           \right) \\
         &amp;= 1 + \varepsilon\left( \mu(u) - \nu(u) \right).
  
\end{align}\]</span> Thus <span class="math inline">\(f(y) =
1\)</span> for all <span class="math inline">\(u\)</span> if and only if
the identity <a href="#eqn:mu-=-nu.-" data-reference-type="eqref"
data-reference="eqn:mu-=-nu.-">\((5.2)\)</a> holds.</p>
<p>To verify the equivalence between <a
href="#itemize:line-isom-begin-mu-nu-:-mathbfm_h-tau_hr-right-mat"
data-reference-type="eqref"
data-reference="itemize:line-isom-begin-mu-nu-:-mathbfm_h-tau_hr-right-mat">\((ii)\)</a>
and <a
href="#itemize:j-geq-0-define-begin-a_j-:=-e-tauj-e-quad-b_j-:=-e"
data-reference-type="eqref"
data-reference="itemize:j-geq-0-define-begin-a_j-:=-e-tauj-e-quad-b_j-:=-e">\((iii)\)</a>,
observe first that powers <span class="math inline">\(\tau_H^j\)</span>
for <span class="math inline">\(j \geq 0\)</span> span <span
class="math inline">\(\mathbf{M}_{H,\tau_H}(R)\)</span>, so the
identity <a href="#eqn:mu-=-nu.-" data-reference-type="eqref"
data-reference="eqn:mu-=-nu.-">\((5.2)\)</a> is equivalent to the
identity <span id="eqn:mutau_hj-=-nutau_hj-quad-text-all--j-geq-0.-" class="math display">\[\label{eqn:mutau_hj-=-nutau_hj-quad-text-all--j-geq-0.-}\tag{5.8}
    \mu(\tau_H^j) = \nu(\tau_H^j)\]</span> holding for all <span
class="math inline">\(j \geq 0\)</span>. By inductive application of
Lemma <a
href="#lemma:there-exist-c_ij-in-rtau-0-leq-i-leq-j-with-c_i-i-"
data-reference-type="ref"
data-reference="lemma:there-exist-c_ij-in-rtau-0-leq-i-leq-j-with-c_i-i-">5.13</a>,
we see that <a href="#eqn:mutau_hj-=-nutau_hj-quad-text-all--j-geq-0.-"
data-reference-type="eqref"
data-reference="eqn:mutau_hj-=-nutau_hj-quad-text-all--j-geq-0.-">\((5.8)\)</a>
holds for all <span class="math inline">\(j\)</span> if and only if <a
href="#eqn:a_j-a-1-=-b_j-" data-reference-type="eqref"
data-reference="eqn:a_j-a-1-=-b_j-">\((5.3)\)</a> does. The
required equivalence follows.</p>
<p>We verify finally that <a
href="#itemize:j-geq-0-define-begin-a_j-:=-e-tauj-e-quad-b_j-:=-e"
data-reference-type="eqref"
data-reference="itemize:j-geq-0-define-begin-a_j-:=-e-tauj-e-quad-b_j-:=-e">\((iii)\)</a>
and <a href="#itemize:we-have-a2-in-mathbfzr.-"
data-reference-type="eqref"
data-reference="itemize:we-have-a2-in-mathbfzr.-">\((iv)\)</a>
are equivalent. The relation <a href="#eqn:a_j-a-1-=-b_j-"
data-reference-type="eqref"
data-reference="eqn:a_j-a-1-=-b_j-">\((5.3)\)</a> maybe be
rewritten <span class="math display">\[B_j a^2 = A_j 1_G.\]</span> For
notational clarity in what follows, let us choose a basis of <span
class="math inline">\(\mathbf{V}(R)\)</span>, so that we may describe
<span class="math inline">\(a^2\)</span> and <span
class="math inline">\(1_G\)</span> by their matrix entries <span
class="math inline">\(a_{ij}\)</span> and <span
class="math inline">\(\delta_{i j}\)</span>. Let us also define the row
vectors <span class="math inline">\(A = (A _0, \dotsc, A _n )\)</span>
and <span class="math inline">\(B = (B _0, \dotsc, B _n)\)</span>. Then
we further rewrite <span id="eqn:delta_i-j-=-b-a2_ij-.-" class="math display">\[\label{eqn:delta_i-j-=-b-a2_ij-.-}\tag{5.9} {(a^2)}_{ij }
B = \delta_{i j} A.\]</span> Let <span class="math inline">\(P\)</span>
denote the matrix with columns <span class="math inline">\(e, \tau e,
\dotsc, \tau^n e\)</span>. Since <span class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span>, the matrix <span
class="math inline">\(P\)</span> is invertible. We compute <span
class="math display">\[A = e^* a P, \quad  B = e^* a^{-1} P,\]</span>
<span class="math display">\[B P^{-1} a e = e^* e = 1, \quad\]</span>
<span class="math display">\[A P^{-1} a e = e^* a^2 e.\]</span>
Multiplying the relation <a href="#eqn:delta_i-j-=-b-a2_ij-.-"
data-reference-type="eqref"
data-reference="eqn:delta_i-j-=-b-a2_ij-.-">\((5.9)\)</a>
on the right by <span class="math inline">\(P^{-1} a e\)</span> gives
<span class="math display">\[{(a^2)}_{i j} = \delta_{i j} e^* a^2
e,\]</span> hence <span class="math display">\[a^2 = (e^* a^2 e) 1_G \in
\mathbf{Z}(R).\]</span> This shows that <a
href="#itemize:j-geq-0-define-begin-a_j-:=-e-tauj-e-quad-b_j-:=-e"
data-reference-type="eqref"
data-reference="itemize:j-geq-0-define-begin-a_j-:=-e-tauj-e-quad-b_j-:=-e">\((iii)\)</a>
implies <a href="#itemize:we-have-a2-in-mathbfzr.-"
data-reference-type="eqref"
data-reference="itemize:we-have-a2-in-mathbfzr.-">\((iv)\)</a>.
The converse may be verified by reversing the above steps, or directly
from the definitions. ◻</p>
</div>
<div id="Remark:recoverLiealgproof" class="remark">
<p><strong>Remark 43</strong>. The arguments used to establish
Theorem <a href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>
lead to a much simpler proof of the following generalizations of
Theorem <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(Nelson
2023, Theorem 16.3)</a>: <em>for each ring</em> <span
class="math inline">\(R\)</span> <em>with</em> <span
class="math inline">\(2 \in R^\times\)</span><em>, each</em> <span
class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span> <em>and</em> <span
class="math inline">\(x \in \mathbf{M}_\tau(R) - R\)</span><em>, we
have</em> <span id="eqn:x-1_h-notin-mathbfm_hr-+-mathbfm_taur.-" class="math display">\[\label{eqn:x-1_h-notin-mathbfm_hr-+-mathbfm_taur.-}\tag{5.10}
[x,1_H] \notin \mathbf{M}_{H}(R) + \mathbf{M}_{\tau}(R).\]</span> (The
quoted result asserts the same conclusion when <span
class="math inline">\(R\)</span> is a field of characteristic zero.) To
see this, suppose otherwise that <span class="math inline">\([x,1_H] \in
t + \mathbf{M}_H(R)\)</span> for some <span class="math inline">\(t \in
\mathbf{M}_\tau(R)\)</span>. Then <span id="eqn:e-t-=-ex-1_h-quad-t-e-=-x-1_h-e.-" class="math display">\[\label{eqn:e-t-=-ex-1_h-quad-t-e-=-x-1_h-e.-}\tag{5.11}
    e^* t = e^*[x,1_H], \quad t e = [x,1_H] e.\]</span> Using that <span
class="math inline">\(1_H = 1 - e e^*\)</span> and identities like <span
class="math inline">\(e^* x e e^* = e^* (e^* x e)\)</span>, we compute
that <span id="eqn:e-x-1_h-=-e-x-e-x-e-quad-x-1_h-e-=-x" class="math display">\[\label{eqn:e-x-1_h-=-e-x-e-x-e-quad-x-1_h-e-=-x}\tag{5.12}
    e^* [x,1_H] = e^* (x - e^* x e), \quad [x,1_H] e = - (x - e^* x e)
e.\]</span> The stability of <span class="math inline">\(\tau\)</span>
implies that <span class="math inline">\(t \in
\mathbf{M}_{\tau}(R)\)</span> is determined by either of the identities
in <a href="#eqn:e-t-=-ex-1_h-quad-t-e-=-x-1_h-e.-"
data-reference-type="eqref"
data-reference="eqn:e-t-=-ex-1_h-quad-t-e-=-x-1_h-e.-">\((5.11)\)</a>.
Since both factors in <a
href="#eqn:e-x-1_h-=-e-x-e-x-e-quad-x-1_h-e-=-x"
data-reference-type="eqref"
data-reference="eqn:e-x-1_h-=-e-x-e-x-e-quad-x-1_h-e-=-x">\((5.12)\)</a>
lie in <span class="math inline">\(\mathbf{M}_{\tau}(R)\)</span>, it
follows that <span class="math display">\[x - e^* x e = t = - x + e^* x
e,\]</span> which simplifies to <span class="math inline">\(2 x = 2 e^*
x e\)</span>. Since <span class="math inline">\(2 \in R^\times\)</span>,
we deduce that <span class="math inline">\(x = e^* x e \in R\)</span>,
contrary to assumption.</p>
</div>
<div class="remark">
<p><strong>Remark 44</strong>. There are many examples of <span
class="math inline">\(\tau\)</span> for which we have the implication
<span class="math display">\[a \in \mathbf{G}_\tau(R),
    \,
    a^2 \in \mathbf{Z}(R) \implies a \in \mathbf{Z}(R).\]</span> For
instance, this implication holds if <span
class="math inline">\(R\)</span> is a field of characteristic <span
class="math inline">\(\neq 2\)</span> and <span
class="math inline">\(a\)</span> is a cyclic element that is not
semisimple. Theorem <a
href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>
implies that the conclusion of Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a> holds
for such <span class="math inline">\(\tau\)</span>.</p>
</div>
<div id="remark:cj4u2pnri2" class="remark">
<p><strong>Remark 45</strong>. The basic cases where Theorem <a
href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a> on
its own does not suffice to prove Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a> are
when, with respect to some basis, <span
class="math inline">\(\tau\)</span> and <span
class="math inline">\(a\)</span> are both diagonal, the entries of <span
class="math inline">\(a\)</span> equal to <span
class="math inline">\(\pm 1\)</span> but not all the same (cf. Remark <a
href="#remark:gl6-example" data-reference-type="ref"
data-reference="remark:gl6-example">5.20</a>). When <span
class="math inline">\(R\)</span> is a field, the stability assumption
then says that <span class="math inline">\(e\)</span> and <span
class="math inline">\(e^*\)</span> are vectors (with inner product <span
class="math inline">\(e^* e = 1\)</span>) all of whose entries are
nonzero.</p>
</div>
<h2 id="sec:analysis-second-derivatives">§5.5. Quadratic analysis</h2>
<p>Here we prove Theorem <a
href="#theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential"
data-reference-type="ref"
data-reference="theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential">5.6</a>,
following several preparatory lemmas.</p>
<div id="lemma:second-derivatives-yield-homomorphism-property"
class="lemma">
<p><strong>Lemma 46</strong>. Let <span class="math inline">\(R\)</span>
be ring, <span class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span> and <span
class="math inline">\(a \in \mathbf{G}_{\tau}(R)\)</span>. Assume that
<span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
doubly-tangential at <span class="math inline">\(1\)</span> over <span
class="math inline">\(R\)</span>; in particular, it is tangential, so by
Proposition <a
href="#lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol"
data-reference-type="ref"
data-reference="lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol">5.12</a>,
the linear maps <span class="math inline">\(\mu\)</span> and <span
class="math inline">\(\nu\)</span> from §<a
href="#sec:reduction-centralizer" data-reference-type="ref"
data-reference="sec:reduction-centralizer">5.3</a> coincide. Then <span id="eqn:cool-homomorphism-property-u1-u2" class="math display">\[\label{eqn:cool-homomorphism-property-u1-u2}\tag{5.13}
    2 \left( \mu (u _1 u _2 ) - \mu (u _1 ) \mu (u _2 ) \right) = 0
    \quad
    \text{ for all } u_1, u_2 \in \mathbf{M}_{H,\tau_H}(R).\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> With <span class="math inline">\(y := 1 +
\varepsilon_1 u_1 + \varepsilon_2 u_2\)</span>, we see by a short
calculation that <span class="math display">\[y^{-1} = 1 - \varepsilon_1
u_1 - \varepsilon_2 u_2 + 2 \varepsilon_1 \varepsilon_2 u_1
u_2,\]</span> hence <span class="math display">\[\mu (y) = 1 +
\varepsilon_1 \mu (u _1 ) + \varepsilon_2  \mu (u _2 ).\]</span> <span
class="math display">\[\nu(y^{-1})
    = 1 - \varepsilon_1  \nu(u _1 )
    - \varepsilon_2 \nu (u _2 ) + 2 \varepsilon_1 \varepsilon_2 \nu (u
_1 u _2 ),\]</span> By our doubly-tangential hypothesis, we have the
relation <span class="math inline">\(1 = f(y) = \mu(y)
\nu(y^{-1})\)</span>. Expanding this out and using that <span
class="math inline">\(\mu = \nu\)</span> gives <span
class="math display">\[2 \mu (u _1 u _2 )
    =
    \mu  (u _1 ) \mu  (u _2 )
    +
    \mu (u _2 ) \mu (u _1 ).\]</span> The claimed identity follows now
from the commutativity of <span
class="math inline">\(\mathbf{M}_\tau(R)\)</span> (Lemma <a
href="#lemma:centralizer-description" data-reference-type="ref"
data-reference="lemma:centralizer-description">3.7</a>). ◻</p>
</span></div>
<div id="lemma:A0-times-a-minus-A0-vanishes" class="lemma">
<p><strong>Lemma 47</strong>. Under the same hypotheses as Lemma <a
href="#lemma:second-derivatives-yield-homomorphism-property"
data-reference-type="ref"
data-reference="lemma:second-derivatives-yield-homomorphism-property">5.17</a>,
and with <span class="math inline">\(A_0 := e^* a e\)</span> as in
Proposition <a
href="#lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol"
data-reference-type="ref"
data-reference="lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol">5.12</a>,
we have <span id="eqn:2-a_0--a_0-=-0.-" class="math display">\[\label{eqn:2-a_0--a_0-=-0.-}\tag{5.14}
    2 A_0 ( a - A_0) = 0.\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We specialize <a
href="#eqn:cool-homomorphism-property-u1-u2" data-reference-type="eqref"
data-reference="eqn:cool-homomorphism-property-u1-u2">\((5.13)\)</a>
to <span class="math inline">\(u_1 = u_2 = 1_H\)</span>. The identity <a
href="#eqn:nu1_h-=-1-a_0-a-1.-" data-reference-type="eqref"
data-reference="eqn:nu1_h-=-1-a_0-a-1.-">\((5.5)\)</a>
for <span class="math inline">\(\mu = \nu\)</span> gives <span
class="math display">\[\mu(1_H) = 1 - A_0 a^{-1}.\]</span> A short
calculation then gives <span class="math display">\[A_0(a - A_0) = a^2
(\mu(1_H) - {\mu(1_H)}^2).\]</span> The conclusion now follows from <a
href="#eqn:cool-homomorphism-property-u1-u2" data-reference-type="eqref"
data-reference="eqn:cool-homomorphism-property-u1-u2">\((5.13)\)</a>. ◻</p>
</span></div>
<div id="remark:sketch-proof-when-A0-A1-vanish" class="remark">
<p><strong>Remark 48</strong>. We pause to sketch a proof of Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a> in the
special case <span id="eq:cj3szcth5l" class="math display">\[\label{eq:cj3szcth5l}\tag{5.15}
    A_0 = A_1 = 0\]</span> by an argument that seems more illuminating
than the general argument given below. (We note that the hypothesis <a
href="#eq:cj3szcth5l" data-reference-type="eqref"
data-reference="eq:cj3szcth5l">\((5.15)\)</a> excludes the case
<span class="math inline">\(a \in \mathbf{H}(R) \mathbf{Z}(R)\)</span>,
since then <span class="math inline">\(A_0\)</span> is a unit.) Since
<span class="math inline">\(A_0 = 0\)</span>, we have <span
class="math display">\[\mu(1_H) = 1.\]</span> Since <span
class="math inline">\(A_1 = 0\)</span>, we see from the formula <a
href="#eqn:20230516005320" data-reference-type="eqref"
data-reference="eqn:20230516005320">\((5.7)\)</a>
(specialized to <span class="math inline">\(j=1\)</span>) that <span
class="math display">\[\mu(\tau_H) = \tau.\]</span> Since <span
class="math inline">\(2 \notin R^\times\)</span>, we deduce from <a
href="#eqn:cool-homomorphism-property-u1-u2" data-reference-type="eqref"
data-reference="eqn:cool-homomorphism-property-u1-u2">\((5.13)\)</a>
the homomorphism property <span class="math display">\[\mu(u_1) \mu(u_2)
= \mu(u_1 u_2).\]</span> By iterating this and applying the
Cayley–Hamilton theorem to <span class="math inline">\(\tau_H\)</span>,
we obtain <span class="math display">\[0 = \mu(P_{\tau_H}(\tau_H)) =
P_{\tau_H}(\mu(\tau_H)) = P_{\tau_H}(\tau).\]</span> Since <span
class="math inline">\(\tau\)</span> is stable, the characteristic
polynomials <span class="math inline">\(P_\tau\)</span> and <span
class="math inline">\(P_{\tau_H}\)</span> generate the unit ideal
(Lemma <a href="#lemma:stability-equivalences" data-reference-type="ref"
data-reference="lemma:stability-equivalences">4.5</a>),
contradicting the Cayley–Hamilton theorem for <span
class="math inline">\(\tau\)</span>.</p>
</div>
<div id="remark:gl6-example" class="remark">
<p><strong>Remark 49</strong>. The argument sketched in <a
href="#remark:sketch-proof-when-A0-A1-vanish" data-reference-type="ref"
data-reference="remark:sketch-proof-when-A0-A1-vanish">5.19</a>, while
aesthetically pleasing, does not suffice to establish the general case
of Theorem <a href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a>. We
record a counterexample with <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) = 6\)</span>.
Take <span class="math inline">\(R = \mathbb{Q}(\alpha)\)</span> with
<span class="math inline">\(\alpha^2 = 2\)</span>, <span
class="math display">\[\tau = \mathop{\mathrm{diag}}(0,1,2,2 \alpha,1 +
2 \alpha,2 + 2 \alpha),\]</span> <span class="math display">\[e^* =
(1,1,1,1,1,1), \quad e = \tfrac{1}{6} {(1,1,1,1,1,1)}^t,\]</span> <span
class="math display">\[a =
\mathop{\mathrm{diag}}(1,1,1,-1,-1,-1).\]</span> One can verify that
<span class="math inline">\(A_0 =B_0= 0\)</span>, <span
class="math inline">\(A_1 = -\alpha\)</span>, <span
class="math display">\[\mu(1_H) = 1, \quad \mu(\tau_H) =
    \mathop{\mathrm{diag}}\left(
      \alpha, \alpha + 1, \alpha + 2, \alpha, \alpha + 1, \alpha + 2
    \right),\]</span> and that <span
class="math inline">\(P_{\tau_H}(\mu(\tau_H)) = 0\)</span>. We have
checked by computer calculation with Gröbner bases that no similar
examples exist when <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) \in
\{3,4\}\)</span>.</p>
<p>One can also check in this example that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> contains the center
of <span class="math inline">\(\mathbf{H}\)</span>. (Of course, once we
have proved Theorem <a href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a>, we
will know that <span class="math inline">\(\mathbf{X}_{\tau,a}\)</span>
does not contain the full centralizer <span
class="math inline">\(\mathbf{H}_{\tau_H}\)</span>.)</p>
</div>
<p>The following lemma contains the final main idea for the proof of
Theorem <a
href="#theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential"
data-reference-type="ref"
data-reference="theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential">5.6</a>.</p>
<div
id="lemma:let-r-mathfr-be-local-ring-with-2-in-rtim-let-tau-a-in-Z-or-tau-in-rank-two"
class="lemma">
<p><strong>Lemma 50</strong>. Let <span
class="math inline">\((R,\mathfrak{m})\)</span> be a local ring with
<span class="math inline">\(2 \in R^\times\)</span>. Let <span
class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(R)\)</span>, <span
class="math inline">\(a \in \mathbf{G}_{\tau}(R)\)</span>. Assume that
<span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
doubly-tangential at <span class="math inline">\(1\)</span> over <span
class="math inline">\(R\)</span>. Then one of the following is true:</p>
<ol type="i">
<li><p><span class="math inline">\(a \in
\mathbf{Z}(R)\)</span>.</p></li>
<li><p><span class="math inline">\(a \notin \mathbf{Z}(R)\)</span>,
<span class="math inline">\(a^2 \in \mathbf{Z}(R)\)</span> and <span
class="math display">\[\tau \in R a + R \subseteq
\mathbf{M}(R).\]</span></p></li>
</ol>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> The hypotheses of Lemma <a
href="#lemma:A0-times-a-minus-A0-vanishes" data-reference-type="ref"
data-reference="lemma:A0-times-a-minus-A0-vanishes">5.18</a> apply, so the
identity <a href="#eqn:2-a_0--a_0-=-0.-" data-reference-type="eqref"
data-reference="eqn:2-a_0--a_0-=-0.-">\((5.14)\)</a> holds.
The argument divides according to whether <span
class="math inline">\(A_0\)</span> lies in <span
class="math inline">\(\mathfrak{m}\)</span> or not. If <span
class="math inline">\(A_0 \notin \mathfrak{m}\)</span>, so that <span
class="math inline">\(A_0\)</span> is a unit, then from <a
href="#eqn:2-a_0--a_0-=-0.-" data-reference-type="eqref"
data-reference="eqn:2-a_0--a_0-=-0.-">\((5.14)\)</a> and our
assumption <span class="math inline">\(2 \in R^\times\)</span>, we see
that <span class="math inline">\(a \in \mathbf{Z}(R)\)</span>. The
remainder of the proof concerns the case <span class="math inline">\(A_0
\in \mathfrak{m}\)</span>.</p>
<p>By Theorem <a href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>
and our hypothesis that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
(doubly-)tangential at <span class="math inline">\(1\)</span> over <span
class="math inline">\(R\)</span>, we have <span
class="math display">\[a^2 \in \mathbf{Z}(R).\]</span> This hypothesis
further implies that for <span class="math display">\[R&#39; :=
R[\varepsilon] / (\varepsilon^2), \quad
    y := 1 + \varepsilon\tau _H \in
\mathbf{H}_{\tau_H}(R&#39;),\]</span> there exists <span
class="math inline">\((h,b) \in \mathbf{H}(R&#39;) \times
\mathbf{G}_\tau(R&#39;)\)</span> such that <span class="math inline">\(a
y = h b\)</span>. It implies finally that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is tangential at
<span class="math inline">\(y\)</span> over <span
class="math inline">\(R&#39;\)</span>, hence by Theorem <a
href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>
that <span class="math display">\[b^2 \in
\mathbf{Z}(R&#39;).\]</span></p>
<p>We retain the notation <span class="math inline">\(A_j, B_j\)</span>
from Proposition <a
href="#lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol"
data-reference-type="ref"
data-reference="lemma:let-r-be-ring-tau-in-mathbfm_st-a-in-mathbfg_t-fol">5.12</a>.
From the calculation <span class="math display">\[e^* a \tau_H = e^* a
(1 - e e^*) \tau ( 1-  e e^*)
    =  e^* \left( a \tau - A_0 \tau - A_1 + A_0 (e^* \tau e)
\right),\]</span> we see that <span class="math display">\[b = a +
\varepsilon\left(a \tau - A _0 \tau - A _1 + A _0 (e^* \tau
e)\right).\]</span> Squaring this relation gives <span id="eqn:b2-=-a2-+-2-eps-lefta-tau-_0-tau-_1-+-_0-e-tau" class="math display">\[\label{eqn:b2-=-a2-+-2-eps-lefta-tau-_0-tau-_1-+-_0-e-tau}\tag{5.16}
    b^2 = a^2 + 2 \varepsilon a \left(a \tau - A _0 \tau - A _1 + A _0
(e^* \tau e)\right),\]</span> using here that <span
class="math inline">\(a\)</span> and <span
class="math inline">\(\tau\)</span> commute. Using now that both <span
class="math inline">\(a^2\)</span> and <span
class="math inline">\(b^2\)</span> lie in <span
class="math inline">\(\mathbf{Z}(R&#39;)\)</span>, together with our
assumption <span class="math inline">\(2 \in R^\times\)</span>, we
deduce that <span class="math display">\[a (a - A_0) \tau \in R a + R
\subseteq \mathbf{M}(R).\]</span> Using next our assumption <span
class="math inline">\(A_0 \in \mathfrak{m}\)</span>, we see that <span
class="math inline">\(a(a-A_0)\)</span> is invertible. Using again that
<span class="math inline">\(a^2 \in \mathbf{Z}(R)\)</span>, we conclude
that <span class="math inline">\(\tau \in R a + R\)</span>. ◻</p>
</span></div>
<div class="proof">
<p><em>Proof of Theorem <a
href="#theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential"
data-reference-type="ref"
data-reference="theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential">5.6</a>.</em>
We have already noted, at the start of §<a
href="#sec:transversality-statement-results" data-reference-type="ref"
data-reference="sec:transversality-statement-results">5.1</a>, that if
<span class="math inline">\(a \in \mathbf{H}(R) \mathbf{Z}(R)\)</span>,
then <span class="math inline">\(\mathbf{X}_{\tau,a} =
\mathbf{H}_{\tau_H}\)</span>; in particular, <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is doubly-tangential
at <span class="math inline">\(y\)</span> over <span
class="math inline">\(R\)</span>. The converse is the interesting
direction.</p>
<p>Suppose, thus, that <span class="math inline">\(2\)</span> is a unit
in <span class="math inline">\(R\)</span>, <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V}) \geq
3\)</span>, <span class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}\)</span> and <span
class="math inline">\(a \notin\mathbf{H}(R) \mathbf{Z}(R)\)</span>, but
<span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
doubly-tangential at some <span class="math inline">\(y \in
\mathbf{X}_{\tau,a}(R)\)</span> over <span
class="math inline">\(R\)</span>. We aim to derive a contradiction.</p>
<p>By passing to the localization of <span
class="math inline">\(R\)</span> at a prime <span
class="math inline">\(\mathfrak{p}\)</span> for which the image of <span
class="math inline">\(a\)</span> does not lie in <span
class="math inline">\(\mathbf{H}(R_\mathfrak{p})
\mathbf{Z}(R_\mathfrak{p})\)</span>, we may assume that <span
class="math inline">\(R\)</span> is a local ring. We may reduce further
to the case <span class="math inline">\(a \in \mathbf{G}_\tau(R) -
\mathbf{Z}(R)\)</span> and <span class="math inline">\(y=1\)</span>, for
the same reasons as noted at the beginning of §<a
href="#sec:analysis-first-derivatives" data-reference-type="ref"
data-reference="sec:analysis-first-derivatives">5.4</a>.</p>
<p>Since <span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
doubly-tangential at <span class="math inline">\(1\)</span> over <span
class="math inline">\(R\)</span>, we know from Theorem <a
href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>
and Lemma <a
href="#lemma:let-r-mathfr-be-local-ring-with-2-in-rtim-let-tau-a-in-Z-or-tau-in-rank-two"
data-reference-type="ref"
data-reference="lemma:let-r-mathfr-be-local-ring-with-2-in-rtim-let-tau-a-in-Z-or-tau-in-rank-two">5.21</a>
that <span class="math inline">\(a^2 \in \mathbf{Z}(R)\)</span> and
<span class="math inline">\(\tau \in R a + R\)</span>. In particular, we
may find <span class="math inline">\(c_0,c_1,c_2 \in R\)</span> so that
<span class="math inline">\(\tau = c_0 + c_1 a\)</span> and <span
class="math inline">\(a^2 = c_2\)</span>. Then <span
class="math inline">\(\tau ^2 = c _0 ^2 + c _1^2 c _2 + 2 c _0 c _1
a\)</span>, hence <span class="math inline">\(\tau ^2 - 2 c _0 \tau + c
_0 ^2 - c _1 ^2 c _2 =0\)</span>. Since <span
class="math inline">\(\tau\)</span> is stable, the vector <span
class="math inline">\(e\)</span> is <span
class="math inline">\(\tau\)</span>-cyclic, so <span
class="math display">\[\mathbf{V}(R) = R [\tau] e = R e + R \tau
e.\]</span> Since the rank of <span
class="math inline">\(\mathbf{V}\)</span> is <span
class="math inline">\(\geq 3\)</span>, we obtain a contradiction. ◻</p>
</div>
<h1 id="sec:volumebound">§6. Volume bounds</h1>
<p>We now apply the results of §<a href="#sec:transversality"
data-reference-type="ref" data-reference="sec:transversality">5</a> to
deduce a uniform solution to Problem <a href="#Probleminformal"
data-reference-type="ref" data-reference="Probleminformal">1.10</a>.</p>
<h2 id="sec:cj3v60uw7y">§6.1. Bounds for polynomial congruences</h2>
<p>Let <span class="math inline">\(n\)</span> and <span
class="math inline">\(d\)</span> be natural numbers. In §<a
href="#sec:cj3v60uw7y" data-reference-type="ref"
data-reference="sec:cj3v60uw7y">6.1</a>, we use the equivalent notations
<span class="math inline">\(A \ll B\)</span> and <span
class="math inline">\(A = \operatorname{O}(B)\)</span> to denote that
<span class="math inline">\(|A| \leq C |B|\)</span>, where <span
class="math inline">\(C\)</span> depends at most upon <span
class="math inline">\(n\)</span> and <span
class="math inline">\(d\)</span>.</p>
<div id="lemma:hypersurface-count" class="lemma">
<p><strong>Lemma 51</strong>. Let <span class="math inline">\(F\)</span>
be a finite field, of cardinality <span
class="math inline">\(q\)</span>. Let <span class="math inline">\(P \in
F[x_1,\dotsc,x_n]\)</span> be a polynomial of degree at most <span
class="math inline">\(d\)</span> whose coefficients are not all zero.
Then <span class="math display">\[\lvert \{x \in F^n : P(x) = 0\} \rvert
\ll q^{n-1}.\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By the fundamental theorem of algebra, we know that
for all but <span class="math inline">\(\operatorname{O}(1)\)</span>
many <span class="math inline">\(x_1\)</span>, the polynomial that we
get by specializing to that value is nonzero. By iterating this
observation for <span class="math inline">\(x_2, x_3\)</span>, and so
on, we obtain the required estimate. ◻</p>
</span></div>
<div id="enumerate:assume-that-each-y-in-mathc-one-line-or-quadr-tayl"
class="lemma">
<p><strong>Lemma 52</strong>. <span
id="lemma:let-d-geq-0.-supp-given-subs-mathc-subs-mathfr-p"
label="lemma:let-d-geq-0.-supp-given-subs-mathc-subs-mathfr-p"></span>
Let <span class="math inline">\(m\)</span> be a natural number. Suppose
given a subset <span class="math inline">\(\mathcal{D} \subseteq
{(\mathfrak{o}/\mathfrak{p})}^n\)</span> and a polynomial <span
class="math inline">\(P \in
(\mathfrak{o}/\mathfrak{p}^m)[X_1,\dotsc,X_n]\)</span> of degree <span
class="math inline">\(\leq d\)</span>. Let <span
class="math inline">\(\mathcal{D}_m \subseteq
{(\mathfrak{o}/\mathfrak{p}^m)}^n\)</span> denote the inverse image of
<span class="math inline">\(\mathcal{D}\)</span>.</p>
<ol type="i">
<li><p><span
id="enumerate:assume-that-each-y-in-mathc-one-line-tayl-coeff-p-"
label="enumerate:assume-that-each-y-in-mathc-one-line-tayl-coeff-p-"></span>
Assume that for each <span class="math inline">\(y \in
\mathcal{D}_m\)</span>, at least one of the linear Taylor coefficients
for <span class="math inline">\(P\)</span> at <span
class="math inline">\(y\)</span> is a unit. Then <span
class="math display">\[\lvert \left\{ y \in \mathcal{D}_m : P(y) \in
\mathfrak{p}^m \right\} \rvert \ll q^{m n - m}.\]</span></p></li>
<li><p>Assume that for each <span class="math inline">\(y \in
\mathcal{D}_m\)</span>, at least one of the linear or quadratic Taylor
coefficients for <span class="math inline">\(P\)</span> at <span
class="math inline">\(y\)</span> is a unit. Then <span
class="math display">\[\lvert \left\{ y \in \mathcal{D}_m : P(y) \in
\mathfrak{p}^m \right\} \rvert \ll q^{m n - \lceil m/2
\rceil}.\]</span></p></li>
</ol>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> In the case <span class="math inline">\(m=1\)</span>,
either assertion reduces to the hypersurface bound (Lemma <a
href="#lemma:hypersurface-count" data-reference-type="ref"
data-reference="lemma:hypersurface-count">6.1</a>).</p>
<p>The case <span class="math inline">\(m \geq 2\)</span> of part <a
href="#enumerate:assume-that-each-y-in-mathc-one-line-tayl-coeff-p-"
data-reference-type="eqref"
data-reference="enumerate:assume-that-each-y-in-mathc-one-line-tayl-coeff-p-">\((i)\)</a>
reduces via Hensel’s lemma to the case <span class="math inline">\(m =
1\)</span>. Indeed, under the stated assumptions, we have more precisely
that each fiber of <span class="math inline">\(\mathcal{D}_m \rightarrow
\mathcal{D}\)</span> contains at most <span
class="math inline">\(q^{(m-1)(n-1)}\)</span> elements <span
class="math inline">\(y\)</span> for which <span
class="math inline">\(P(y) \in \mathfrak{p}^m\)</span>. To see this,
suppose for instance that the coefficient of <span
class="math inline">\(X_1\)</span> in the Taylor expansion of <span
class="math inline">\(P\)</span> at <span
class="math inline">\(y\)</span> is a unit. We may then use Hensel’s
lemma and the condition <span class="math inline">\(P(y) \in
\mathfrak{p}^m\)</span> to determine <span class="math inline">\(y_1 \in
\mathfrak{o}/\mathfrak{p}^m\)</span> in terms of the other coefficients.
The number of possibilities for each of <span
class="math inline">\(y_2,\dotsc,y_n\)</span> is at most <span
class="math inline">\(q^{m-1}\)</span>, giving the required
estimate.</p>
<p>We turn to part <a
href="#enumerate:assume-that-each-y-in-mathc-one-line-or-quadr-tayl"
data-reference-type="eqref"
data-reference="enumerate:assume-that-each-y-in-mathc-one-line-or-quadr-tayl">\((ii)\)</a>.
The case <span class="math inline">\(m=2\)</span> follows formally from
the case <span class="math inline">\(m=1\)</span>, using that solutions
modulo <span class="math inline">\(\mathfrak{p}^2\)</span> map to
solutions modulo <span class="math inline">\(\mathfrak{p}\)</span>. We
address the cases <span class="math inline">\(m \geq 3\)</span> by
induction. We first observe that if <span class="math inline">\(P(y) \in
\mathfrak{p}^m\)</span>, then certainly <span class="math inline">\(P(y)
\in \mathfrak{p}\)</span>, and the latter condition depends only upon
the class of <span class="math inline">\(y\)</span> modulo <span
class="math inline">\(\mathfrak{p}\)</span>. By the case <span
class="math inline">\(m=1\)</span> that we have already addressed, the
number of such classes is <span class="math inline">\(\ll
q^{n-1}\)</span>. By replacing <span class="math inline">\(P\)</span>
with a translate, we reduce to showing that when <span
class="math inline">\(P(0) \in \mathfrak{p}^m\)</span>, we have <span
class="math display">\[\lvert \left\{ y \in
{(\mathfrak{p}/\mathfrak{p}^m)}^n : P(y) \in \mathfrak{p}^m \right\}
\rvert \ll q^{m n  - \lceil m/2 \rceil - (n-1)}.\]</span> We now
consider two cases separately:</p>
<p>The first is when some linear Taylor coefficient of <span
class="math inline">\(P\)</span> is a unit, say the coefficient of <span
class="math inline">\(X_1\)</span>. Then, arguing as in part <a
href="#enumerate:assume-that-each-y-in-mathc-one-line-tayl-coeff-p-"
data-reference-type="eqref"
data-reference="enumerate:assume-that-each-y-in-mathc-one-line-tayl-coeff-p-">\((i)\)</a>,
we see that the cardinality in question is at most <span
class="math inline">\(q^{(m-1) (n-1)}\)</span>, which is better than the
required estimate because <span class="math inline">\(m - 1 \geq \lceil
m/2 \rceil\)</span> for <span class="math inline">\(m \geq
3\)</span>.</p>
<p>The second is when all linear Taylor coefficients of <span
class="math inline">\(P\)</span> lie in <span
class="math inline">\(\mathfrak{p}\)</span>. We then form the polynomial
<span class="math display">\[Q(y) := \varpi^{-2} P(\varpi y) \in
(\mathfrak{o} / \mathfrak{p}^{m-2})[X_1,\dotsc,X_n]\]</span> and we see
that <span class="math display">\[\lvert \left\{ y \in
{(\mathfrak{p}/\mathfrak{p}^m)}^n : P(y) \in \mathfrak{p}^m \right\}
\rvert
    =
    q^n \lvert \left\{ y \in {(\mathfrak{o}/\mathfrak{p}^{m-2})}^n :
Q(y) \in \mathfrak{p}^{m-2} \right\} \rvert.\]</span> By hypothesis,
some quadratic Taylor coefficient of <span
class="math inline">\(P\)</span> is a unit, hence the same holds for
<span class="math inline">\(Q\)</span>. We may thus apply our inductive
hypothesis to bound the cardinality on the right hand side, giving that
the left hand side satisfies the estimate <span
class="math display">\[\ll q^n q ^{(m- 2) n - \lceil (m-2)/2 \rceil}
    =
    q ^{m n - \lceil m/2 \rceil - (n-1)},\]</span> as required. ◻</p>
</span></div>
<h2 id="sec:norms-distance-functions">§6.2. Norms and distance functions</h2>
<p>For each <span class="math inline">\(m \geq 0\)</span>, we equip the
vector space <span class="math inline">\(F^m\)</span> with the norm
<span
class="math display">\[\left\lvert  (v_1,\dotsc,v_m)  \right\rvert_F :=
\max_{1 \leq j \leq m} \lvert v _j  \rvert_F.\]</span> We apply this
notation more generally to any vector space that comes with a natural
basis, e.g., to the space of <span class="math inline">\(m_1 \times
m_2\)</span> matrices over <span class="math inline">\(F\)</span>.</p>
<p>We choose a basis <span
class="math inline">\(\{e_1,\dotsc,e_n\}\)</span> of <span
class="math inline">\(\mathbf{V}_H(\mathfrak{o})\)</span>, so that <span
class="math inline">\(\{e_1,\dotsc,e_n,e\}\)</span> is a basis of <span
class="math inline">\(\mathbf{V}(\mathfrak{o})\)</span>, and use these
bases to identify <span class="math inline">\(\mathbf{V}(F),
\mathbf{V}^*(F)\)</span> and <span
class="math inline">\(\mathbf{G}(F)\)</span> with matrices over <span
class="math inline">\(F\)</span>. The above notation then applies.</p>
<p>For <span class="math inline">\(h \in \mathbf{G}(F)\)</span>, we
write <span class="math display">\[h =
  \begin{pmatrix}
    a &amp; b \\
    c &amp; d \\
  \end{pmatrix},
  \quad
  h^{-1} =
  \begin{pmatrix}
    a&#39; &amp; b&#39; \\
    c&#39; &amp; d&#39; \\
  \end{pmatrix},\]</span> where <span class="math inline">\(a\)</span>
and <span class="math inline">\(a&#39;\)</span> are <span
class="math inline">\(n \times n\)</span> block matrices, and set <span
class="math display">\[d_H(g) := \min\left(1,
    \max
    \left\{
      \lvert b/d \rvert_F,
      \lvert b&#39;/d&#39; \rvert_F,
      \lvert c/d \rvert_F,
      \lvert c&#39;/d&#39; \rvert_F
    \right\}
  \right).\]</span> This definition differs mildly from that in <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, sec.
4.2)</a>, but agrees up to a constant factor, for reasons explained
there.</p>
<div id="lemma:let-d-geq-0-g-in-k_g-be-such-that-begin-g-in-k_h-k"
class="lemma">
<p><strong>Lemma 53</strong>. Let <span class="math inline">\({\ell}
\geq 0\)</span> and <span class="math inline">\(g \in K\)</span> be such
that <span id="eqn:g-in-k_h-k_z-k_gmathfrakpd.-" class="math display">\[\label{eqn:g-in-k_h-k_z-k_gmathfrakpd.-}\tag{6.1}
    g \in K_H K_Z K(\mathfrak{p}^\ell).\]</span> Then <span
class="math inline">\(d_H(g) \leq q^{-\ell}\)</span>, with equality if
<span class="math inline">\(g \notin K_H K_Z
K(\mathfrak{p}^{\ell+1})\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> This follows readily from the following observation:
for <span class="math inline">\(\ell \geq 1\)</span>, the membership <a
href="#eqn:g-in-k_h-k_z-k_gmathfrakpd.-" data-reference-type="eqref"
data-reference="eqn:g-in-k_h-k_z-k_gmathfrakpd.-">\((6.1)\)</a>
says that <span class="math inline">\(d, d&#39; \in
\mathfrak{o}^\times\)</span> and that at least one <span
class="math inline">\(b\)</span> or <span
class="math inline">\(c\)</span> (and <span
class="math inline">\(b&#39;\)</span> or <span
class="math inline">\(c&#39;\)</span>) lies in <span
class="math inline">\(\mathfrak{p}^{\ell}\)</span>. ◻</p>
</span></div>
<p>In other words, for <span class="math inline">\(g \in K =
\mathbf{G}(\mathfrak{o})\)</span>, the quantity <span
class="math inline">\(d_H(g)\)</span> is the infimum of <span
class="math inline">\(q^{-\ell}\)</span> taken over all <span
class="math inline">\(\ell \geq 0\)</span> for which the image of <span
class="math inline">\(g\)</span> in <span
class="math inline">\(\mathbf{G}(\mathfrak{o}/\mathfrak{p}^{\ell})\)</span>
lies in <span
class="math inline">\(\mathbf{H}(\mathfrak{o}/\mathfrak{p}^{\ell})\mathbf{Z}(\mathfrak{o}/\mathfrak{p}^{\ell})\)</span>.
For example, if the image of <span class="math inline">\(g\)</span> does
not lie in <span class="math inline">\(\mathbf{H}
(\mathfrak{o}/\mathfrak{p})\)</span>, then <span
class="math inline">\(d_H(g) = 1\)</span>, while if <span
class="math inline">\(g\)</span> lies in <span
class="math inline">\(\mathbf{Z}(\mathfrak{o})
\mathbf{H}(\mathfrak{o})\)</span>, then <span
class="math inline">\(d_H(g) = 0\)</span>. We abbreviate <span
class="math display">\[{d_H(g)}^\infty :=
  \begin{cases}
    1 &amp; \text{ if } d_H(a) = 1, \\
    0 &amp;  \text{ if } d_H(a) &lt; 1.
  \end{cases}\]</span> We note that for a nonzero ideal <span
class="math inline">\(\mathfrak{q}\subseteq \mathfrak{p}\)</span> and
<span class="math inline">\(a \in \mathbf{G}(\mathfrak{o}/\mathfrak{q})
- \mathbf{H}(\mathfrak{o}/\mathfrak{q})
\mathbf{Z}(\mathfrak{o}/\mathfrak{q})\)</span>, the quantity <span
class="math inline">\(d_H(a)\)</span> is well-defined.</p>
<h2 id="miscellaneous-lemmas">Miscellaneous lemmas</h2>
<p>Let <span
class="math inline">\((F,\mathfrak{o},\mathfrak{p},q)\)</span> be a
non-archimedean local field, and let <span
class="math inline">\(\mathfrak{q}\subseteq \mathfrak{p}\)</span> be a
nonzero <span class="math inline">\(\mathfrak{o}\)</span>-ideal.</p>
<div id="lemma:supp-char-mathfr-odd.-let-a-in-mathbfgm" class="lemma">
<p><strong>Lemma 54</strong>. Assume that <span
class="math inline">\(q\)</span> is odd. Let <span
class="math inline">\(a \in
\mathbf{G}(\mathfrak{o}/\mathfrak{q})\)</span> such that</p>
<ol type="i">
<li><p>the image of <span class="math inline">\(a\)</span> in <span
class="math inline">\(\mathbf{G}(\mathfrak{o}/\mathfrak{p})\)</span>
lies in <span
class="math inline">\(\mathbf{Z}(\mathfrak{o}/\mathfrak{p})\)</span>,
and</p></li>
<li><p><span class="math inline">\(a^2 \in
\mathbf{Z}(\mathfrak{o}/\mathfrak{q})\)</span>.</p></li>
</ol>
<p>Then <span class="math inline">\(a \in
\mathbf{Z}(\mathfrak{o}/\mathfrak{q})\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Write <span class="math inline">\(\mathfrak{q}=
\mathfrak{p}^m\)</span>. If the conclusion fails, then we may write
<span class="math inline">\(a = \lambda (1 + \varpi^{\ell} x)\)</span>,
where <span class="math inline">\(\lambda \in
{(\mathfrak{o}/\mathfrak{q})}^\times\)</span>, <span
class="math inline">\(1 \leq \ell &lt; m\)</span> and <span
class="math inline">\(x \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> has the property that its
image <span class="math inline">\(\bar{x}\)</span> in <span
class="math inline">\(\mathbf{M}(\mathfrak{o}/\mathfrak{p})\)</span>
does not lie in <span
class="math inline">\(\mathbf{Z}(\mathfrak{o}/\mathfrak{p})\)</span>.
Then <span class="math display">\[\mathbf{Z}(\mathfrak{o}/\mathfrak{q})
\ni a^2 / \lambda^2 = 1 + 2 \varpi^{\ell} x + \varpi^{2 \ell}
x^2.\]</span> Reducing this identity modulo <span
class="math inline">\(\mathfrak{p}^{\ell+1}\)</span> and using that
<span class="math inline">\(2\)</span> is a unit, we deduce that <span
class="math inline">\(\bar{x}\)</span> lies in <span
class="math inline">\(\mathbf{Z}(\mathfrak{o}/\mathfrak{p})\)</span>,
giving the required contradiction. ◻</p>
</span></div>
<p>Recall from Definition <a
href="#definition:let-r-be-ring.-let-a-in-mathbfgr-y-in-mathbfx_t-ar"
data-reference-type="ref"
data-reference="definition:let-r-be-ring.-let-a-in-mathbfgr-y-in-mathbfx_t-ar">5.4</a>
the meaning of “tangential”.</p>
<div id="lemma:supp-char-mathfr-odd.-let-a-in-mathbfgm-not-tangential"
class="lemma">
<p><strong>Lemma 55</strong>. Assume that <span
class="math inline">\(q\)</span> is odd. Let <span
class="math inline">\(a \in \mathbf{G}(\mathfrak{o}/\mathfrak{q}) -
\mathbf{H}(\mathfrak{o}/\mathfrak{q})
\mathbf{Z}(\mathfrak{o}/\mathfrak{q})\)</span> with <span
class="math inline">\(d_H(a) &lt; 1\)</span>. Then for each <span
class="math inline">\(y \in
\mathbf{X}_{\tau,a}(\mathfrak{o}/\mathfrak{q})\)</span>, we have that
<span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is not
tangential at <span class="math inline">\(y\)</span> over <span
class="math inline">\(\mathfrak{o}/\mathfrak{q}\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Suppose otherwise that <span
class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is tangential at
<span class="math inline">\(y\)</span> over <span
class="math inline">\(\mathfrak{o}/\mathfrak{q}\)</span>. Writing <span
class="math inline">\(a y = h b\)</span> with <span
class="math inline">\((h,b) \in \mathbf{H}(\mathfrak{o}/\mathfrak{q})
\times \mathbf{G}_\tau(\mathfrak{o}/\mathfrak{q})\)</span>, it follows
then by Theorem <a href="#theorem:characterization-of-tangential-points"
data-reference-type="ref"
data-reference="theorem:characterization-of-tangential-points">5.5</a>
that <span class="math inline">\(b^2 \in
\mathbf{Z}(\mathfrak{o}/\mathfrak{q})\)</span>. On the other hand, since
<span class="math inline">\(d_H(a) &lt; 1\)</span>, the image <span
class="math inline">\(\bar{a}\)</span> of <span
class="math inline">\(a\)</span> modulo <span
class="math inline">\(\mathfrak{p}\)</span> lies in <span
class="math inline">\(\mathbf{H}(\mathfrak{o}/\mathfrak{p})
\mathbf{Z}(\mathfrak{o}/\mathfrak{p})\)</span>. By the uniqueness of the
decomposition <span class="math inline">\(\bar{a} \bar{y} = \bar{h}
\bar{b}\)</span>, it follows that <span
class="math inline">\(\bar{b}\)</span> lies in <span
class="math inline">\(\mathbf{Z}(\mathfrak{o}/\mathfrak{p})\)</span>. By
Lemma <a href="#lemma:supp-char-mathfr-odd.-let-a-in-mathbfgm"
data-reference-type="ref"
data-reference="lemma:supp-char-mathfr-odd.-let-a-in-mathbfgm">6.4</a>,
it follows that <span class="math inline">\(b \in
\mathbf{Z}(\mathfrak{o}/\mathfrak{q})\)</span>. But then <span
class="math inline">\(a \in \mathbf{H}(\mathfrak{o}/\mathfrak{q})
\mathbf{Z}(\mathfrak{o}/\mathfrak{q})\)</span>, contrary to
assumption. ◻</p>
</span></div>
<div id="lemma:cardinality-centralizer" class="lemma">
<p><strong>Lemma 56</strong>. Let <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> be cyclic. Write <span
class="math inline">\(n\)</span> for the rank of <span
class="math inline">\(\mathbf{V}\)</span>. Then the group <span
class="math inline">\(\mathbf{G}_{\tau}(\mathfrak{o}/\mathfrak{q})\)</span>
has cardinality at least <span class="math inline">\({(1 - q^{-1})}^n
{[\mathfrak{o}:\mathfrak{q}]}^n\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Since <span
class="math inline">\(\mathbf{G}_\tau(\mathfrak{o}/\mathfrak{q}) =
{\left( \mathbf{M}_\tau(\mathfrak{o}/\mathfrak{q}) \twoheadrightarrow
\mathbf{M}_\tau(\mathfrak{o}/\mathfrak{p})
\right)}^{-1}(\mathbf{G}_\tau(\mathfrak{o}/\mathfrak{p}))\)</span>, we
may reduce to the case <span class="math inline">\(\mathfrak{q}=
\mathfrak{p}\)</span>. Since <span class="math inline">\(k :=
\mathfrak{o}/\mathfrak{p}\)</span> is a field, we may appeal to Lemma <a
href="#lemma:centralizer-description" data-reference-type="ref"
data-reference="lemma:centralizer-description">3.7</a> and the structure
theorem for modules over the PID to see that the ring <span
class="math inline">\(\mathbf{M}_\tau(k)\)</span> is isomorphic to a
product of rings <span class="math inline">\(k[X]/(p_i)\)</span>, where
the <span class="math inline">\(p_i\)</span> are primary polynomials
whose degrees sum to <span class="math inline">\(n\)</span>. Let <span
class="math inline">\(d_i\)</span> denote the degree of the irreducible
polyomial of which <span class="math inline">\(p_i\)</span> is a power.
Taking unit groups, we obtain <span class="math inline">\(\lvert
\mathbf{G}_\tau(k) \rvert = q^n \prod_i (1 - q^{-d_i})\)</span>, and the
claim follows from the fact that <span class="math inline">\(\sum_i d_i
\leq n\)</span>. ◻</p>
</span></div>
<h2 id="sec:cj3v60wplb">§6.4. Main result</h2>
<div id="theorem:volume-bound" class="theorem">
<p><strong>Theorem 57</strong>. <em>Let <span
class="math inline">\((F,\mathfrak{o},\mathfrak{p},q)\)</span> be a
non-archimedean local field with <span class="math inline">\(q\)</span>
odd. Let <span class="math inline">\(\mathfrak{q}\subseteq
\mathfrak{p}\)</span> be a nonzero <span
class="math inline">\(\mathfrak{o}\)</span>-ideal. Denote by <span
class="math inline">\(Q := [\mathfrak{o}:\mathfrak{q}]\)</span> its
absolute norm. Set <span class="math display">\[Q^* := q^{\lceil m/2
\rceil} \text{ if } Q = q^m.\]</span> Let <span
class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(\mathfrak{o}/\mathfrak{q})\)</span>
and <span class="math inline">\(a \in
\mathbf{G}(\mathfrak{o}/\mathfrak{q}) -
\mathbf{H}(\mathfrak{o}/\mathfrak{q})
\mathbf{Z}(\mathfrak{o}/\mathfrak{q})\)</span>. Then <span
class="math display">\[\left\lvert
\mathbf{X}_{\tau,a}(\mathfrak{o}/\mathfrak{q}) \right\rvert
    \leq C \left( \frac{1}{1 + Q d_H(a)} + \frac{{d_H(a)}^\infty
}{Q^{*}} \right) \lvert \mathbf{H}_{\tau_H}(\mathfrak{o}/\mathfrak{q})
\rvert,\]</span> where <span class="math inline">\(C \geq 0\)</span>
depends at most upon the rank of <span
class="math inline">\(\mathbf{V}\)</span>.</em></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By Lemma <a href="#lemma:cardinality-centralizer"
data-reference-type="ref"
data-reference="lemma:cardinality-centralizer">6.6</a>, the cardinality
of <span
class="math inline">\(\mathbf{H}_{\tau_H}(\mathfrak{o}/\mathfrak{q})\)</span>
is comparable to <span class="math inline">\(Q^{n}\)</span>, where we
write <span class="math display">\[\mathop{\mathrm{rank}}(\mathbf{V}) =
n+1.\]</span> For this reason, it suffices to establish the modified
estimate obtained by replacing <span class="math inline">\(\lvert
\mathbf{H}_{\tau_H}(\mathfrak{o}/\mathfrak{q}) \rvert\)</span> with
<span class="math inline">\(Q^n\)</span>. Moreover, in view of the
trivial bound <span class="math inline">\(\lvert
\mathbf{X}_{\tau,a}(\mathfrak{o}/\mathfrak{q}) \rvert \leq \lvert
\mathbf{H}_{\tau_H}(\mathfrak{o}/\mathfrak{q}) \rvert\)</span>, it
suffices to show that <span class="math display">\[\left\lvert
\mathbf{X}_{\tau,a}(\mathfrak{o}/\mathfrak{q}) \right\rvert
    \ll
    \left( \frac{1}{Q d_H(a)} + \frac{{d_H(a)}^\infty }{Q^{*}} \right)
Q^n,\]</span> where <span class="math inline">\(\ll\)</span> means
“bounded in magnitude by a scalar depending at most upon the rank of
<span class="math inline">\(\mathbf{V}\)</span>”. We will establish this
separately when <span class="math inline">\(d_H(a) &lt; 1\)</span> and
when <span class="math inline">\(d_H(a) = 1\)</span>.</p>
<p>Recall from Remark <a
href="#remark:rewrite-defining-equations-for-X-as-polynomials"
data-reference-type="ref"
data-reference="remark:rewrite-defining-equations-for-X-as-polynomials">5.10</a>
that <span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is defined
by a system of <span class="math inline">\(n+1\)</span> polynomial
equations in the entries of <span class="math inline">\(y \in
\mathbf{H}_{\tau_H}(\mathfrak{o}/\mathfrak{q})\)</span>, each of degree
at most <span class="math inline">\(n\)</span>.</p>
<p>Consider first the case <span class="math inline">\(d_H(a) &lt;
1\)</span>. Write <span class="math inline">\(Q = q^m\)</span> and <span
class="math inline">\(d_H(a) = q^{-\ell}\)</span>, so that <span
class="math inline">\(1 \leq \ell &lt; m\)</span>. The image of <span
class="math inline">\(a\)</span> lies in <span
class="math inline">\(\mathbf{H}(\mathfrak{o}/\mathfrak{p}^{\ell})
\mathbf{Z}(\mathfrak{o}/\mathfrak{p}^{\ell})\)</span>, thus the defining
polynomial equations are trivial mod <span
class="math inline">\(\mathfrak{p}^{\ell}\)</span>. The image of <span
class="math inline">\(a\)</span> does not lie in <span
class="math inline">\(\mathbf{H}(\mathfrak{o}/\mathfrak{p}^{\ell+1})
\mathbf{Z}(\mathfrak{o}/\mathfrak{p}^{\ell+1})\)</span>, so by Lemma <a
href="#lemma:supp-char-mathfr-odd.-let-a-in-mathbfgm-not-tangential"
data-reference-type="ref"
data-reference="lemma:supp-char-mathfr-odd.-let-a-in-mathbfgm-not-tangential">6.5</a>,
we see that <span class="math inline">\(\mathbf{X}_{\tau,a}\)</span> is
not tangential over <span class="math inline">\(\mathfrak{o} /
\mathfrak{p}^{\ell+1}\)</span> at any <span class="math inline">\(y \in
\mathbf{X}_{\tau,a}(\mathfrak{o}/\mathfrak{p}^{\ell+1})\)</span>. This
implies that at least one of the polynomial equations in our system has
the property that at least one of the linear Taylor coefficients at
<span class="math inline">\(y\)</span> lies in <span
class="math inline">\(\mathfrak{p}^{\ell}-\mathfrak{p}^{\ell+1}\)</span>.
Let us divide that polynomial congruence by <span
class="math inline">\(\varpi^{\ell}\)</span> and view it now as a
polynomial congruence taken modulo <span
class="math inline">\(\mathfrak{p}^{m-\ell}\)</span>. Each solution of
the new congruence corresponds to exactly <span
class="math inline">\(q^{\ell n}\)</span> solutions of the old
congruence, but at least one linear Taylor coefficient for the new
congruence is a unit, so by part <a
href="#enumerate:assume-that-each-y-in-mathc-one-line-tayl-coeff-p-"
data-reference-type="eqref"
data-reference="enumerate:assume-that-each-y-in-mathc-one-line-tayl-coeff-p-">\((i)\)</a>
of Lemma <a
href="#lemma:let-d-geq-0.-supp-given-subs-mathc-subs-mathfr-p"
data-reference-type="ref"
data-reference="lemma:let-d-geq-0.-supp-given-subs-mathc-subs-mathfr-p">6.2</a>
(applied with <span class="math inline">\(\mathcal{D} =
\mathbf{H}_{\tau_H}(\mathfrak{o}/\mathfrak{p})\)</span>), we obtain
<span class="math display">\[\lvert
\mathbf{X}_{\tau,a}(\mathfrak{o}/\mathfrak{q}) \rvert \ll
    q^{\ell n}
    q^{(m-\ell) n - (m-\ell)}
    = Q^{n-1} q^{\ell} = \frac{1}{Q d_H(a)} Q^n,\]</span> as required in
this case.</p>
<p>It remains to consider the case <span class="math inline">\(d_H(a) =
1\)</span>, where our goal bound is now <span
class="math display">\[\lvert
\mathbf{X}_{\tau,a}(\mathfrak{o}/\mathfrak{q}) \rvert \ll
    \frac{1}{Q^*} Q^n.\]</span> We now have that the image of <span
class="math inline">\(a\)</span> does not lie in <span
class="math inline">\(\mathbf{H}(\mathfrak{o}/\mathfrak{p})
\mathbf{Z}(\mathfrak{o}/\mathfrak{p})\)</span>. We may thus apply
Theorem <a
href="#theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential"
data-reference-type="ref"
data-reference="theorem:reta-sett-defin-refd-r-be-ring.-let-mathbfgr-y-mat-doubly-tangential">5.6</a>
to see that for each <span class="math inline">\(y \in
\mathbf{X}_{\tau,a}(\mathfrak{o}/\mathfrak{p})\)</span>, at least one of
the linear or quadratic Taylor coefficients for one of the defining
polynomials for <span class="math inline">\(\mathbf{X}_{\tau,a}\)</span>
is a unit. By part <a
href="#enumerate:assume-that-each-y-in-mathc-one-line-or-quadr-tayl"
data-reference-type="eqref"
data-reference="enumerate:assume-that-each-y-in-mathc-one-line-or-quadr-tayl">\((ii)\)</a>
of Lemma <a
href="#lemma:let-d-geq-0.-supp-given-subs-mathc-subs-mathfr-p"
data-reference-type="ref"
data-reference="lemma:let-d-geq-0.-supp-given-subs-mathc-subs-mathfr-p">6.2</a>,
we deduce the required bound. ◻</p>
</span></div>
<div class="remark">
<p><strong>Remark 58</strong>. For applications to subconvexity
involving a <em>fixed</em> local field of characteristic zero, the
“near-identity reduction” (see §<a href="#sec:cj4t69an73"
data-reference-type="ref" data-reference="sec:cj4t69an73">1.9.3</a>
and <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(Nelson
2023, sec. 15.6)</a>) reduces our task, as far as volume bounds like
in Theorem <a href="#theorem:volume-bound" data-reference-type="ref"
data-reference="theorem:volume-bound">6.7</a> are concerned, to the case
that <span class="math inline">\(a\)</span> is close to the identity
element. In that case, an adequate volume bound follows from <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, Theorem
15.2)</a>. The novelty of Theorem <a href="#theorem:volume-bound"
data-reference-type="ref" data-reference="theorem:volume-bound">6.7</a>
relative to the cited result is its validity for all <span
class="math inline">\(a\)</span> in the maximal compact subgroup,
uniformly in the local field. The restriction to characteristic <span
class="math inline">\(\neq 2\)</span> in Theorem <a
href="#theorem:volume-bound" data-reference-type="ref"
data-reference="theorem:volume-bound">6.7</a> is thus harmless in
applications. With additional work, this restriction could be eliminated
in the case of a non-archimedean local field of characteristic zero and
residue characteristic <span class="math inline">\(2\)</span>, basically
because the proof of Theorem <a
href="#theorem:main-transversality-general-ring"
data-reference-type="ref"
data-reference="theorem:main-transversality-general-ring">5.1</a>
requires only a bounded number of divisions by <span
class="math inline">\(2\)</span>.</p>
<p>There remains the case of a local field of characteristic <span
class="math inline">\(2\)</span>, where the conclusion of Theorem <a
href="#theorem:volume-bound" data-reference-type="ref"
data-reference="theorem:volume-bound">6.7</a> fails for the reasons
indicated in Remark <a
href="#remark:we-have-seen-comp-calc-with-grobn-bases-that-when-"
data-reference-type="ref"
data-reference="remark:we-have-seen-comp-calc-with-grobn-bases-that-when-">5.3</a>.
That case is not relevant for the subconvexity problem over number
fields, but would be relevant for studying moments of <span
class="math inline">\(L\)</span>-functions in horizontal aspects over a
function field of characteristic <span class="math inline">\(2\)</span>.
Estimating such moments thus presents an interesting challenge to which
our results do not apply.</p>
</div>
<h1 id="Sec:bilinear">§7. Bilinear forms estimates</h1>
<p>We now apply the volume bound to estimate bilinear forms relevant
for <a href="#eq:cj3tv4jpta" data-reference-type="eqref"
data-reference="eq:cj3tv4jpta">\((1.11)\)</a>.</p>
<p>Let <span
class="math inline">\((F,\mathfrak{o},\mathfrak{p},\varpi,q)\)</span> be
a non-archimedean local field of odd residue characteristic. Let <span
class="math inline">\(\mathfrak{q}\subseteq \mathfrak{p}\)</span> be a
nonzero <span class="math inline">\(\mathfrak{o}\)</span>-ideal. In this
section, we abbreviate <span class="math display">\[G :=
\mathbf{G}(\mathfrak{o}/\mathfrak{q}),
  \qquad
  H := \mathbf{H}(\mathfrak{o}/\mathfrak{q}),\]</span> etc. Write <span
class="math inline">\(Q := [\mathfrak{o}:\mathfrak{q}]\)</span>, and
define <span class="math inline">\(Q^*\)</span> as in the statement of
Theorem <a href="#theorem:volume-bound" data-reference-type="ref"
data-reference="theorem:volume-bound">6.7</a>. Recall from §<a
href="#sec:norms-distance-functions" data-reference-type="ref"
data-reference="sec:norms-distance-functions">6.2</a> the “distance from
<span class="math inline">\(H Z\)</span>” function <span
class="math inline">\(d_H\)</span>.</p>
<div id="theorem:bilinear-forms-estimate" class="theorem">
<p><strong>Theorem 59</strong>. <em>Let <span class="math inline">\(\tau
\in M_{\mathop{\mathrm{stab}}}\)</span>. Let <span
class="math inline">\(u_1, u_2 : H \rightarrow \mathbb{R}_{\geq
0}\)</span> be nonnegative functions that are right-invariant under
<span class="math inline">\(H_{\tau_H}\)</span>. Let <span
class="math inline">\(\gamma \in G\)</span>. Then the quantity <span id="eqn:i-:=-frac1lv-h-rvert2-sum-_-subst-x-y-in-h-:-" class="math display">\[\label{eqn:i-:=-frac1lv-h-rvert2-sum-_-subst-x-y-in-h-:-}\tag{7.1}
    I :=
    \frac{1}{\lvert H \rvert^2}
    \sum _{
      \substack{
        x, y \in H :  \\
        x ^{-1} \gamma y \in G_\tau
      }
    }
    u_1(x) u_2(y)\]</span> satisfies the trivial bound <span id="eqn:volume-bound-trivial" class="math display">\[\label{eqn:volume-bound-trivial}\tag{7.2}
    I \leq \frac{1}{|H|} \lVert u_1 \rVert_{L^2} \lVert u_2
\rVert_{L^2}\]</span> and, for <span class="math inline">\(\gamma \notin
H Z\)</span>, the refined bound <span id="eqn:volume-bound-refined" class="math display">\[\label{eqn:volume-bound-refined}\tag{7.3}
    I \leq
    \frac{C}{|H|} \left( \frac{1}{1 + Q d_H(\gamma)} +
\frac{{d_H(\gamma)}^\infty }{Q^*} \right) \lVert u_1 \rVert_{L^2} \lVert
u_2 \rVert_{L^2}.\]</span> Here <span class="math inline">\(C\)</span>
depends at most upon <span
class="math inline">\(\mathop{\mathrm{rank}}(\mathbf{V})\)</span>, and
may be taken to be the same constant as in Theorem <a
href="#theorem:volume-bound" data-reference-type="ref"
data-reference="theorem:volume-bound">6.7</a>. The <span
class="math inline">\(L^2\)</span>-norms are defined using the invariant
probability measures.</em></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We closely follow the proof of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, Thm 15.1, Lem
15.3)</a>. By Cauchy–Schwarz, we have <span class="math inline">\(I
\leq \sqrt{I_1 I_2}\)</span>, where <span class="math display">\[I_1
:=\frac{1}{\lvert H \rvert^2}
    \sum _{
      \substack{
        x, y \in H :  \\
        x ^{-1} \gamma y \in G_{\tau}
      }
    }
    {u_1(x)}^2,\]</span> <span class="math display">\[I_2
:=\frac{1}{\lvert H \rvert^2}
    \sum _{
      \substack{
        x, y \in H :  \\
        x ^{-1} \gamma y \in G_{\tau}
      }
    }
    {u_2(y)}^2.\]</span> The set <span
class="math inline">\(G_{\tau}\)</span>, the condition <span
class="math inline">\(\gamma \notin H Z\)</span> and the quantity <span
class="math inline">\(d_H(\gamma)\)</span> are invariant under
inversion, so it will suffice to obtain a suitable estimate for <span
class="math inline">\(I_1\)</span>, as the same argument then applies to
<span class="math inline">\(I_2\)</span>. By definition, <span
class="math display">\[I_1 = \frac{1}{|H|^2} \sum _{x \in H} {u_1(x)}^2
\nu(x),
    \quad
    \nu(x) := \left\lvert \left\{ y \in H : x ^{-1} \gamma y \in
G_{\tau}  \right\} \right\rvert.\]</span> By Lemma <a
href="#lemma:stable-implies-trivial-stabilizer"
data-reference-type="ref"
data-reference="lemma:stable-implies-trivial-stabilizer">4.6</a>, we have
<span class="math inline">\(H \cap G_{\tau} = \{1\}\)</span>, and so
<span class="math inline">\(\nu(x) \in \{0, 1\}\)</span>. Thus <span
class="math display">\[I_1 \leq \frac{1}{|H|} I_1&#39;, \quad
    I_1&#39; := \frac{1}{|H|} \sum _{
      \substack{
        x \in H :  \\
        \gamma ^{-1} x \in H G_{\tau}
      }
    }
    {u_1(x)}^2.\]</span> The trivial bound <span
class="math inline">\(I_1&#39; \leq \lVert u_1 \rVert_{L^2}^2\)</span>,
obtained by dropping the summation condition, yields the first required
estimate <a href="#eqn:volume-bound-trivial" data-reference-type="eqref"
data-reference="eqn:volume-bound-trivial">\((7.2)\)</a>.</p>
<p>For the second required estimate, we appeal to the right <span
class="math inline">\(H_{\tau_H}\)</span>-invariance of <span
class="math inline">\(u_1\)</span> to write <span
class="math display">\[I_1&#39; := \frac{1}{|H|} \sum _{
      x \in H
    }
    {u_1(x)}^2
    \mu(x),
    \quad
    \mu(x) :=
    \frac{
      \left\lvert
        \left\{
          u \in H_{\tau_H} :
          \gamma ^{-1} x u \in H G_{\tau}
        \right\}
      \right\rvert
    }{
      \left\lvert H_{\tau_H}  \right\rvert
    }.\]</span> If <span class="math inline">\(\gamma \notin H
Z\)</span>, then we have <span class="math inline">\(\gamma ^{-1} x
\notin H Z\)</span> and <span class="math inline">\(d_H(\gamma^{-1} x) =
d_H(\gamma)\)</span> for all <span class="math inline">\(x \in
H\)</span>. Estimating <span class="math inline">\(\mu(x)\)</span> via
Theorem <a href="#theorem:volume-bound" data-reference-type="ref"
data-reference="theorem:volume-bound">6.7</a> yields the second
estimate <a href="#eqn:volume-bound-refined" data-reference-type="eqref"
data-reference="eqn:volume-bound-refined">\((7.3)\)</a>. ◻</p>
</span></div>
<h1 id="sec:part-body-paper">§8. Construction of test vectors</h1>
<p>The primary aim of this section is to make Theorem <a
href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a> precise by
specifying the local conditions required at the distinguished place
(Remark <a href="#remark:cj3u9047n5" data-reference-type="ref"
data-reference="remark:cj3u9047n5">1.6</a>). To that end, we define
“stable” pairs of representations of general linear groups
(Definition <a
href="#definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f"
data-reference-type="ref"
data-reference="definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f">8.6</a>);
informally, such representations contain “microlocalized” test vectors
whose localization parameters have no matching eigenvalues. To apply
this definition, we need to check when it holds. Since
representation-theoretic issues are orthogonal to the main novelty of
this paper, we are content here to check that our definition is
preserved under parabolic induction (Example <a
href="#example:cj3m0jsjik" data-reference-type="ref"
data-reference="example:cj3m0jsjik">8.7</a>) and to investigate fully the
case of principal series (Example <a href="#example:20230516204714"
data-reference-type="ref"
data-reference="example:20230516204714">8.8</a>), leaving open the case
of general supercuspidals (see Example <a href="#example:cj3m0jzefl"
data-reference-type="ref" data-reference="example:cj3m0jzefl">8.9</a> for
some special cases).</p>
<p>We note that many of the ideas and results recorded in this section
are well-known in the type theory literature, going back to work of Howe
from the 1970s (see, e.g., <a href="#ref-MR0579176 MR0327982" class="citation"
data-cites="MR0579176 MR0327982">(Howe 1977, 1973)</a> and <a href="#ref-MR2016587"
class="citation" data-cites="MR2016587">(Baruch 2003, sec. 5)</a>).
The cited works would be most relevant to the special cases of our
results where <span class="math inline">\(\tau\)</span> and <span
class="math inline">\(\tau_H\)</span> are diagonalizable, a condition
that corresponds to the “wall-avoidance” hypothesis <a
href="#enumerate:20230516210021" data-reference-type="eqref"
data-reference="enumerate:20230516210021">\((i)\)</a>
mentioned in §<a href="#sec:cj4vjryk3u" data-reference-type="ref"
data-reference="sec:cj4vjryk3u">1.5</a>. Since we do not wish to impose
such hypotheses, we give short proofs of what we need here, without
claiming particular novelty.</p>
<h2 id="sec:20230516194628">§8.1. Overview</h2>
<p>In §<a href="#sec:20230516194628" data-reference-type="ref"
data-reference="sec:20230516194628">8.1</a>, we summarize the main
definitions and results of §<a href="#sec:part-body-paper"
data-reference-type="ref" data-reference="sec:part-body-paper">8</a>;
the remaining subsections are then devoted to the proofs of these
results.</p>
<p>Let <span class="math inline">\(F\)</span> be a non-archimedean local
field, with ring of integers <span
class="math inline">\(\mathfrak{o}\)</span> and maximal ideal <span
class="math inline">\(\mathfrak{p}\)</span>. Let <span
class="math inline">\(\mathfrak{q} \subseteq \mathfrak{p}\)</span> be an
<span class="math inline">\(\mathfrak{o}\)</span>-ideal. Let <span
class="math inline">\(\psi\)</span> be a unitary character of <span
class="math inline">\(\mathfrak{q}\)</span> that is trivial on <span
class="math inline">\(\mathfrak{q}^2\)</span>, but not on <span
class="math inline">\(\mathfrak{p}^{-1}\mathfrak{q}^2\)</span>.</p>
<p>For <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span>, we denote by <span
class="math inline">\(\chi_\tau\)</span> the character of the group
<span class="math inline">\(K(\mathfrak{q})/K(\mathfrak{q}^2)\)</span>
given by <span id="eqn:definition-of-chi-tau-as-psi-of-trace-x-tau" class="math display">\[\label{eqn:definition-of-chi-tau-as-psi-of-trace-x-tau}\tag{8.1}
  \chi _\tau (1 + x) = \psi (\mathop{\mathrm{trace}}(x \tau )).\]</span>
Every character of that group arises in this way.</p>
<p>In what follows, <em>representation</em> always means “complex
representation”. We introduce some terminology concerning
representations <span class="math inline">\(\pi\)</span> of <span
class="math inline">\(\mathbf{G}(\mathfrak{o})\)</span>. We will apply
this terminology also to representations of <span
class="math inline">\(\mathbf{G}(F)\)</span>, through their
restrictions.</p>
<div
id="definition:we-say-that-pi-emphr-at-depth-mathfr-if-there-cycl-regular-depth-parameter-polynomial"
class="definition">
<p><strong>Definition 60</strong>. Let <span
class="math inline">\(\pi\)</span> be a representation of <span
class="math inline">\(\mathbf{G}(\mathfrak{o})\)</span>. We say that
<span class="math inline">\(\pi\)</span> is <em>regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span></em> if there is a cyclic
element <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> (see §<a
href="#sec:cyclic-matrices" data-reference-type="ref"
data-reference="sec:cyclic-matrices">3</a>) such that <span
class="math inline">\(\pi\)</span> contains a nonzero vector <span
class="math inline">\(v\)</span> that transforms under <span
class="math inline">\(K (\mathfrak{q})\)</span> via the character <span
class="math inline">\(\chi_\tau\)</span>, i.e., <span id="eqn:g-v-=-chi_taug-v-quad-text-all--g-in-kmathfrakq.-" class="math display">\[\label{eqn:g-v-=-chi_taug-v-quad-text-all--g-in-kmathfrakq.-}\tag{8.2}
    g v = \chi_\tau(g) v \quad \text{ for all } g \in
K(\mathfrak{q}).\]</span> In that case, we refer to <span
class="math inline">\(\tau\)</span> as a <em>regular parameter for</em>
<span class="math inline">\(\pi\)</span> <em>at depth</em> <span
class="math inline">\(\mathfrak{q}^2\)</span>, to its characteristic
polynomial <span class="math inline">\(P \in
(\mathfrak{o}/\mathfrak{q})[X]\)</span> as a <em>polynomial for</em>
<span class="math inline">\(\pi\)</span> <em>at depth</em> <span
class="math inline">\(\mathfrak{q}^2\)</span>, and to the dimension of
the space of <span class="math inline">\(v\)</span> satisfying <a
href="#eqn:g-v-=-chi_taug-v-quad-text-all--g-in-kmathfrakq.-"
data-reference-type="eqref"
data-reference="eqn:g-v-=-chi_taug-v-quad-text-all--g-in-kmathfrakq.-">\((8.2)\)</a>
as the <em>multiplicity</em> of <span
class="math inline">\(\tau\)</span> or of <span
class="math inline">\(P\)</span> in <span
class="math inline">\(\pi\)</span>. (These notions depend, of course,
upon the choice of <span class="math inline">\(\psi\)</span>.)</p>
</div>
<div id="example:cj2i1fuxey" class="example">
<p><strong>Example 61</strong>. Let <span
class="math inline">\(\chi\)</span> be a character of <span
class="math inline">\({\mathop{\mathrm{GL}}}_1(\mathfrak{o}) =
\mathfrak{o}^\times\)</span>, regarded also as a one-dimensional
representation. We denote by <span class="math display">\[c(\chi)
\subseteq \mathfrak{o}\]</span> the largest ideal <span
class="math inline">\(\mathfrak{a}\)</span> of <span
class="math inline">\(\mathfrak{o}\)</span> for which <span
class="math inline">\(\chi\)</span> has trivial restriction to <span
class="math inline">\(\mathfrak{o}^\times \cap (1 +
\mathfrak{a})\)</span>. It is clear then that <span
class="math display">\[c(\chi) \supseteq \mathfrak{q}^2 \iff
\text{$\chi$ is regular at depth $\mathfrak{q}^2$}.\]</span></p>
</div>
<div id="example:cj2i1fu0az" class="example">
<p><strong>Example 62</strong>. We verify in Proposition <a
href="#proposition:regular-stable-closed-under-parabolic-induction"
data-reference-type="ref"
data-reference="proposition:regular-stable-closed-under-parabolic-induction">8.19</a>
that being regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> is closed under parabolic
induction. That is to say, suppose given a partition <span
class="math inline">\(n = m_1 + \dotsb + m_k\)</span>, corresponding to
a standard parabolic subgroup of <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathfrak{o})\)</span>. For
each <span class="math inline">\(j \in \{1, \dotsc, k\}\)</span>, let
<span class="math inline">\(\pi_j\)</span> be a representation of <span
class="math inline">\({\mathop{\mathrm{GL}}}_{m_j}(\mathfrak{o})\)</span>
that is regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> with polynomial <span
class="math inline">\(P_j\)</span>. Then the same holds for the
parabolic induction of <span class="math inline">\(\pi_1 \otimes \dotsb
\otimes \pi_k\)</span> to <span
class="math inline">\({\mathop{\mathrm{GL}}}_n(\mathfrak{o})\)</span>,
with polynomial at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> given by <span
class="math inline">\(P=\prod\limits_{i} P_i\)</span> (unique if the
<span class="math inline">\(P_i\)</span> are).</p>
</div>
<div id="Example:principalregular" class="example">
<p><strong>Example 63</strong>. By combining Examples <a
href="#example:cj2i1fuxey" data-reference-type="ref"
data-reference="example:cj2i1fuxey">8.2</a> and <a
href="#example:cj2i1fu0az" data-reference-type="ref"
data-reference="example:cj2i1fu0az">8.3</a>, we deduce that a principal
series representation induced by characters <span
class="math inline">\(\chi_i\)</span> with <span
class="math inline">\(c(\chi_i) \supseteq \mathfrak{q}^2\)</span> is
regular at depth <span class="math inline">\(\mathfrak{q}^2\)</span>.
Its unique polynomial at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> is the product of linear
factors <span class="math inline">\(\prod_{i} (X - \xi_i)\)</span>,
where <span class="math inline">\(\xi_i\)</span> is characterized by the
identity <span class="math inline">\(\chi_i(1+y) = \psi(y
\xi_i)\)</span> for all <span class="math inline">\(y \in
\mathfrak{q}\)</span>.</p>
</div>
<div id="Example:supercuspidaloverview" class="example">
<p><strong>Example 64</strong>. We verify in §<a
href="#sec:supercuspidals" data-reference-type="ref"
data-reference="sec:supercuspidals">8.8</a> that certain supercuspidal
representations are regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. We do not determine
precisely which supercuspidal representations are regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>, but it may be possible to
do so using known classifications of the latter (see Remark <a
href="#Rem:supercuspidalclassification" data-reference-type="ref"
data-reference="Rem:supercuspidalclassification">8.27</a>).</p>
</div>
<div id="definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f"
class="definition">
<p><strong>Definition 65</strong>. Let <span
class="math inline">\(m\)</span> and <span
class="math inline">\(n\)</span> be natural numbers. Let <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> be representations of <span
class="math inline">\({\mathop{\mathrm{GL}}}_{n}(\mathfrak{o})\)</span>
and <span
class="math inline">\({\mathop{\mathrm{GL}}}_m(\mathfrak{o})\)</span>. We
say that <span class="math inline">\((\pi,\sigma)\)</span> is <em>stable
at depth</em> <span class="math inline">\(\mathfrak{q}^2\)</span> if</p>
<ul>
<li><p>both <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> are regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>, and</p></li>
<li><p>there are polynomials <span class="math inline">\(P_\pi\)</span>
(resp. <span class="math inline">\(P_\sigma\)</span>) for <span
class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> that generate the unit
ideal of <span
class="math inline">\((\mathfrak{o}/\mathfrak{q})[X]\)</span>.</p></li>
</ul>
</div>
<div id="example:cj3m0jsjik" class="example">
<p><strong>Example 66</strong>. Being stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> is closed under parabolic
induction (Proposition <a
href="#proposition:stable-pairs-closed-under-parabolic-induction"
data-reference-type="ref"
data-reference="proposition:stable-pairs-closed-under-parabolic-induction">8.21</a>):
if <span class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) is induced by some collection of
representations <span class="math inline">\(\pi_i\)</span> (resp. <span
class="math inline">\(\sigma_j\)</span>) of <span
class="math inline">\({\mathop{\mathrm{GL}}}_{n_i}(\mathfrak{o})\)</span>
(resp. <span
class="math inline">\({\mathop{\mathrm{GL}}}_{m_j}(\mathfrak{o})\)</span>)
such that each pair <span
class="math inline">\((\pi_i,\sigma_j)\)</span> is stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>, then the same holds for
<span class="math inline">\((\pi,\sigma)\)</span>.</p>
</div>
<div id="example:20230516204714" class="example">
<p><strong>Example 67</strong>. If <span
class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) is a principal series
representation induced by characters <span
class="math inline">\(\chi_i\)</span> (resp. <span
class="math inline">\(\eta_j\)</span>), then the pair <span
class="math inline">\((\pi,\sigma)\)</span> is stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> provided that for all
relevant indices, <span id="eqn:20230516200125" class="math display">\[\label{eqn:20230516200125}\tag{8.3}
    c(\chi_i) \supseteq \mathfrak{q}^2, \qquad  c(\eta_j) \supseteq
\mathfrak{q}^2,
    \qquad
    c (\chi_i / \eta_j) = \mathfrak{q}^2.\]</span> Assuming the first
two conditions in <a href="#eqn:20230516200125"
data-reference-type="eqref"
data-reference="eqn:20230516200125">\((8.3)\)</a>, the third
condition is equivalent to <span id="eqn:20230516200301" class="math display">\[\label{eqn:20230516200301}\tag{8.4}
    \prod_{i,j} [\mathfrak{o}:c(\chi_i/\eta_j)] =
{[\mathfrak{o}:\mathfrak{q}^2]}^{n(n+1)}.\]</span> The left hand side
may be understood as the conductor of the Rankin–Selberg convolution
<span class="math inline">\(\pi \times \sigma^\vee\)</span>, and the
equality <a href="#eqn:20230516200301" data-reference-type="eqref"
data-reference="eqn:20230516200301">\((8.4)\)</a> may be
understood as an analogue of the “no conductor dropping” or “uniform
growth” conditions considered in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023)</a> and <a href="#ref-2021arXiv210915230N"
class="citation" data-cites="2021arXiv210915230N">(Nelson
2021)</a>.</p>
</div>
<div id="example:cj3m0jzefl" class="example">
<p><strong>Example 68</strong>. When <span
class="math inline">\((\pi,\sigma)\)</span> is a pair of regular
supercuspidal representations of <span
class="math inline">\(({\mathop{\mathrm{GL}}}_{m},{\mathop{\mathrm{GL}}}_{n})\)</span>
as discussed in Example <a href="#Example:supercuspidaloverview"
data-reference-type="ref"
data-reference="Example:supercuspidaloverview">8.5</a> or §<a
href="#sec:supercuspidals" data-reference-type="ref"
data-reference="sec:supercuspidals">8.8</a>, it is automatically stable
when <span class="math inline">\(m\neq n\)</span>; when <span
class="math inline">\(m=n\)</span>, one needs to impose additional
conditions similar to the case of principal series representations (see
Lemma <a href="#Lem:supercuspidalstablepair" data-reference-type="ref"
data-reference="Lem:supercuspidalstablepair">8.28</a>).</p>
</div>
<h2 id="sec:characters-in-construction-test-vectors">§8.2. Characters</h2>
<p>Let <span class="math inline">\(\mathfrak{q}\subseteq
\mathfrak{p}\)</span> be an <span
class="math inline">\(\mathfrak{o}\)</span>-ideal. Let <span
class="math inline">\(\psi : \mathfrak{q}/ \mathfrak{q}^2 \rightarrow
\mathbb{C}^\times\)</span> be a character that is nontrivial on <span
class="math inline">\(\mathfrak{p} ^{-1} \mathfrak{q}^2 /
\mathfrak{q}^2\)</span>. The character <span
class="math inline">\(\psi\)</span> induces an identification <span
class="math display">\[\mathfrak{o} / \mathfrak{q}\xrightarrow{\cong }
\left\{ \text{characters } \mathfrak{q}/ \mathfrak{q}^2 \rightarrow
\mathbb{C} ^\times  \right\},\]</span> <span class="math display">\[\xi
\mapsto \psi(\xi \bullet).\]</span> For a character <span
class="math inline">\(\chi\)</span> of <span class="math inline">\(1 +
\mathfrak{q}\)</span> that is trivial on <span class="math inline">\(1 +
\mathfrak{q}^2\)</span>, we denote by <span
class="math inline">\(\xi_\chi \in \mathfrak{o}/\mathfrak{q}\)</span>
the unique element with <span class="math display">\[\chi(1 + x) =
\psi(\xi_\chi x) \quad \text{ for } x \in \mathfrak{q}.\]</span></p>
<h2 id="sec:centralizers-characters-J-tau">§8.3. Centralizers of
characters</h2>
<p>Given <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span>, we denote by <span
class="math display">\[J_\tau \leq \mathbf{G}(\mathfrak{o})\]</span> the
inverse image of the mod-<span
class="math inline">\(\mathfrak{q}\)</span> centralizer <span
class="math inline">\(\mathbf{G}_\tau(\mathfrak{o}/\mathfrak{q})\)</span>.
It is a subgroup that contains <span
class="math inline">\(K(\mathfrak{q})\)</span>.</p>
<h2 id="sec:regular-uniform-representations">§8.4. Preliminary lemmas
regarding regular parameters</h2>
<div id="lemma:let-p-be-polyn-pi-at-depth-mathfr-let-tau-in-mathb"
class="lemma">
<p><strong>Lemma 69</strong>. Let <span class="math inline">\(P\)</span>
be a polynomial for <span class="math inline">\(\pi\)</span> at depth
<span class="math inline">\(\mathfrak{q}^2\)</span>. Then any cyclic
element <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> whose characteristic
polynomial is <span class="math inline">\(P\)</span> is a regular
parameter for <span class="math inline">\(\pi\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We observe first that the set of regular parameters
for <span class="math inline">\(\pi\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> is invariant under
conjugation by <span
class="math inline">\(\mathbf{G}(\mathfrak{o}/\mathfrak{q})\)</span>.
The conclusion of the lemma then follows from the fact (Lemma <a
href="#lemma:regular-elements-same-characteristic-polynomial-are-conjugate"
data-reference-type="ref"
data-reference="lemma:regular-elements-same-characteristic-polynomial-are-conjugate">3.8</a>)
that any two cyclic elements having the same characteristic polynomial
are conjugate. ◻</p>
</span></div>
<div id="lemma:cj3m0fjios" class="lemma">
<p><strong>Lemma 70</strong>. Let <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> be cyclic. Then <span
class="math inline">\(\ker(\chi_\tau)\)</span> is a normal subgroup of
<span class="math inline">\(J_\tau\)</span>, and the quotient group
<span class="math inline">\(J_\tau / \ker(\chi_\tau)\)</span> is
abelian.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> We verify first that the kernel is normal. Let <span
class="math inline">\(x \in J_\tau\)</span> and <span
class="math inline">\(y \in \ker(\chi_\tau)\)</span>. Then <span
class="math inline">\(x y x^{-1}\)</span> lies in <span
class="math inline">\(K(\mathfrak{q})\)</span> (because <span
class="math inline">\(y\)</span> lies in <span
class="math inline">\(K(\mathfrak{q})\)</span>, which is normal in <span
class="math inline">\(\mathbf{G}(\mathfrak{o})\)</span>) and also in
<span class="math inline">\(\ker(\chi_\tau)\)</span> (because <span
class="math inline">\(x\)</span> commutes with <span
class="math inline">\(\tau\)</span> modulo <span
class="math inline">\(\mathfrak{q}\)</span>).</p>
<p>We verify next that the quotient is abelian. Choose an arbitrary lift
<span class="math inline">\(\tilde{\tau} \in
\mathbf{G}(\mathfrak{o})\)</span> of <span
class="math inline">\(\tau\)</span>. Then, since <span
class="math inline">\(\mathbf{M}_\tau(\mathfrak{o}/\mathfrak{q})\)</span>
consists of polynomials in <span class="math inline">\(\tau\)</span>
(Lemma <a href="#lemma:centralizer-description"
data-reference-type="ref"
data-reference="lemma:centralizer-description">3.7</a>), we see that any
element of <span class="math inline">\(J_\tau\)</span> may be written as
a product <span class="math inline">\(a b\)</span>, where <span
class="math inline">\(a\)</span> is a polynomial in <span
class="math inline">\(\tilde{\tau}\)</span> and <span
class="math inline">\(b\)</span> lies in <span
class="math inline">\(K(\mathfrak{q})\)</span>. The images of such
elements generate the quotient group <span class="math inline">\(J_\tau
/ \ker(\chi_\tau)\)</span>, so to verify that the latter is abelian, we
reduce to checking that any commutator <span
class="math inline">\((a_1,a_2)\)</span> or <span
class="math inline">\((a_1,b_1)\)</span> or <span
class="math inline">\((b_1,b_2)\)</span> lies in <span
class="math inline">\(\ker(\chi_\tau)\)</span>, where the <span
class="math inline">\(a_i\)</span> and <span
class="math inline">\(b_j\)</span> are as before. Indeed, we have <span
class="math inline">\((a_1,a_2) = 1\)</span> (because any two
polynomials in <span class="math inline">\(\tilde{\tau}\)</span> commute
with one another) and <span class="math inline">\(\chi_\tau((a_1,b_1)) =
1\)</span> (because <span class="math inline">\(a_1\)</span> commutes
with <span class="math inline">\(\tau\)</span> modulo <span
class="math inline">\(\mathfrak{q}\)</span>) and <span
class="math inline">\(\chi_\tau((b_1,b_2)) = 1\)</span> (because <span
class="math inline">\(\chi_\tau\)</span> is a character of <span
class="math inline">\(K(\mathfrak{q})\)</span>). ◻</p>
</span></div>
<div
id="lemma:let-tau-in-mathbfm-mathfr--mathfr-be-regul-param-p-extension-chi-tau-to-J-tau"
class="lemma">
<p><strong>Lemma 71</strong>. Let <span class="math inline">\(\tau \in
\mathbf{M} (\mathfrak{o} / \mathfrak{q})\)</span> be a regular parameter
for <span class="math inline">\(\pi\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. Then there is an
extension of <span class="math inline">\(\chi_\tau\)</span> to a
character <span class="math inline">\(\tilde{\chi}_\tau\)</span> of
<span class="math inline">\(J_\tau\)</span> and a nonzero vector <span
class="math inline">\(v \in \pi\)</span> that transforms under <span
class="math inline">\(J_\tau\)</span> via <span
class="math inline">\(\tilde{\chi }_\tau\)</span>. If <span
class="math inline">\(\tau\)</span> occurs with multiplicity one, then
<span class="math inline">\(v\)</span> is unique up to scalar
multiple.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Let <span class="math inline">\(v_0\)</span> be a
nonzero vector in <span class="math inline">\(\pi\)</span> that
transforms under <span class="math inline">\(K(\mathfrak{q})\)</span>
via <span class="math inline">\(\chi_\tau\)</span>. Let <span
class="math inline">\(V\)</span> denote the span of <span
class="math inline">\(v_0\)</span> under <span
class="math inline">\(J_\tau\)</span>. This is a vector space of
dimension at most <span
class="math inline">\([J_\tau:K(\mathfrak{q})]\)</span>, on which <span
class="math inline">\(K(\mathfrak{q}^2)\)</span> acts trivially. By
Lemma <a href="#lemma:cj3m0fjios" data-reference-type="ref"
data-reference="lemma:cj3m0fjios">8.11</a>, the action of <span
class="math inline">\(J_\tau\)</span> on <span
class="math inline">\(V\)</span> factors through that of the quotient
group <span class="math inline">\(J_\tau / \ker(\chi_\tau)\)</span>. The
latter is a finite abelian group, so its action on <span
class="math inline">\(V\)</span> decomposes as a direct sum of
one-dimensional subspaces. Take <span class="math inline">\(v\)</span>
to lie in one of these subspaces, and <span
class="math inline">\(\tilde{\chi}_\tau\)</span> to be the character
describing the eigenvalues for <span
class="math inline">\(J_\tau\)</span> acting on <span
class="math inline">\(v\)</span>. The final assertion is clear. ◻</p>
</span></div>
<div id="example:let-tau-in-mathbfmm-be-cycl-it-defin-char-chi_t-o"
class="example">
<p><strong>Example 72</strong>. Let <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> be cyclic. It defines a
character <span class="math inline">\(\chi_\tau\)</span> of the subgroup
<span class="math inline">\(K(\mathfrak{q})\)</span> of <span
class="math inline">\(J_\tau\)</span>. Suppose given an extension <span
class="math inline">\(\tilde{\chi}_\tau\)</span> of <span
class="math inline">\(\chi_\tau\)</span> to a character of <span
class="math inline">\(J_\tau\)</span>. Let <span
class="math inline">\(\pi\)</span> denote the representation of <span
class="math inline">\(\mathbf{G}(\mathfrak{o})\)</span> induced from
<span class="math inline">\(\tilde{\chi}_\tau\)</span>. Then <span
class="math inline">\(\pi\)</span> is regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>, with regular parameter
<span class="math inline">\(\tau\)</span>. These elementary observations
imply that certain supercuspidal representations satisfy the above
definitions (specifically, those of “odd depth” and “generic inducing
data” — see §<a href="#sec:supercuspidals" data-reference-type="ref"
data-reference="sec:supercuspidals">8.8</a>).</p>
</div>
<h2 id="sec:cj3m0c59nb">§8.5. Some linear algebra</h2>
<p>We record some general lemmas to be applied in the following
subsection. Here we focus on an individual ring <span
class="math inline">\(R\)</span> and abbreviate <span
class="math inline">\(V := \mathbf{V}(R)\)</span>, <span
class="math inline">\(M := \mathbf{M}(R)\)</span>, etc.</p>
<div id="lemma:v-tau-cycl-if-only-if-v-tau-cycl-more-prec-if-vect"
class="lemma">
<p><strong>Lemma 73</strong>. Let <span class="math inline">\(\tau \in
M\)</span>. Then <span class="math inline">\(V\)</span> is <span
class="math inline">\(\tau\)</span>-cyclic if and only if <span
class="math inline">\(V^*\)</span> is <span
class="math inline">\(\tau\)</span>-cyclic. More precisely, if the
vector <span class="math inline">\(v \in V\)</span> is <span
class="math inline">\(\tau\)</span>-cyclic, then functional <span
class="math inline">\(v^* \in V^*\)</span> given by <span
class="math inline">\(\sum c _j \tau ^j v \mapsto c_{n-1}\)</span> is
<span class="math inline">\(\tau\)</span>-cyclic.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> This is the observation that the transpose of a
matrix like <a href="#eqn:beginpmatrix-0--0--ast-"
data-reference-type="eqref"
data-reference="eqn:beginpmatrix-0--0--ast-">\((3.3)\)</a>
is cyclic; we leave it to the reader. ◻</p>
</span></div>
<p>In what follows, by a <em>flag</em> <span class="math inline">\(V_0
\subset \dotsb \subset V_k\)</span> in <span
class="math inline">\(V\)</span>, we mean a sequence of free submodules,
with <span class="math inline">\(V_0 = \{0\}\)</span> and <span
class="math inline">\(V_k = V\)</span>, such that each quotient <span
class="math inline">\(V_j / V_{j-1}\)</span> is also free. We say that
<span class="math inline">\(\tau \in M\)</span> preserves this flag if
<span class="math inline">\(\tau V_j \subseteq V_j\)</span> for each
<span class="math inline">\(j \in \{1, \dotsc, k\}\)</span>.</p>
<div id="lemma:let-v_0-be-free-tau-invar-subm-v.-assume-tau-regul"
class="lemma">
<p><strong>Lemma 74</strong>. Let <span class="math inline">\(\tau \in
M\)</span> be cyclic. Let <span class="math inline">\(V_0 \subset \dotsb
\subset V_k\)</span> be a flag. Suppose that <span
class="math inline">\(\tau\)</span> preserves the flag, so that <span
class="math inline">\(\tau\)</span> induces endomorphisms <span
class="math inline">\(\tau_j \in \mathop{\mathrm{End}}(V_j/
V_{j-1})\)</span>. Then each <span class="math inline">\(\tau_j\)</span>
is cyclic.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By induction, we may reduce to the case <span
class="math inline">\(k = 2\)</span>. It is clear that <span
class="math inline">\(\tau_2\)</span> is cyclic, because the image in
<span class="math inline">\(V/V_1\)</span> of any cyclic vector for
<span class="math inline">\(\tau\)</span> is a cyclic vector for <span
class="math inline">\(\tau_2\)</span>. It remains to show that <span
class="math inline">\(\tau_1\)</span> is cyclic. By Lemma <a
href="#lemma:v-tau-cycl-if-only-if-v-tau-cycl-more-prec-if-vect"
data-reference-type="ref"
data-reference="lemma:v-tau-cycl-if-only-if-v-tau-cycl-more-prec-if-vect">8.14</a>,
we know that <span class="math inline">\(\tau^* \in
\mathop{\mathrm{End}}(V^*)\)</span> is cyclic, and it suffices to show
that <span class="math inline">\(\tau_1^* \in
\mathop{\mathrm{End}}(V_1^*)\)</span> is cyclic. By identifying <span
class="math inline">\(V_1^*\)</span> with the quotient <span
class="math inline">\(V^* / V_1^\perp\)</span>, we reduce to the
previous observation. ◻</p>
</span></div>
<div id="lemma:if-tau-cycl-then-char-polyn-p_tau-gener-annih-idea"
class="lemma">
<p><strong>Lemma 75</strong>. If <span
class="math inline">\(\tau\)</span> is cyclic, then its characteristic
polynomial <span class="math inline">\(P_\tau\)</span> generates the
annihilator ideal <span class="math inline">\(\{f \in R[X] : f(\tau) =
0\}\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Otherwise, let <span class="math inline">\(f\)</span>
be polynomial of minimal degree that is not divisible by <span
class="math inline">\(P_\tau\)</span> and yet for which <span
class="math inline">\(f(\tau) = 0\)</span>. If the degree of <span
class="math inline">\(f\)</span> is less than the rank of <span
class="math inline">\(\mathbf{V}\)</span>, then we obtain a
contradiction from Lemma <a
href="#lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-"
data-reference-type="ref"
data-reference="lemma:v-tau-cycl-if-only-if-map-modul-begin-rn-right-v-">3.6</a>.
Otherwise, we can apply division with remainder using the monic
polynomial <span class="math inline">\(P_\tau\)</span> to contradict the
minimality of <span class="math inline">\(f\)</span>. ◻</p>
</span></div>
<div id="lemma:let-v_1-subs-dotsb-subs-v_k-be-flag-let-tau_j-in-e"
class="lemma">
<p><strong>Lemma 76</strong>. Let <span class="math inline">\(V_1
\subset \dotsb \subset V_k\)</span> be a flag, and let <span
class="math inline">\(\tau_j \in \mathop{\mathrm{End}}(V_j /
V_{j-1})\)</span> be cyclic elements. Then there is a cyclic element
<span class="math inline">\(\tau \in \mathop{\mathrm{End}}(V)\)</span>
that preserves the flag and for which the induced action on <span
class="math inline">\(V_j / V_{j-1}\)</span> is <span
class="math inline">\(\tau_j\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By induction, we may reduce to the case <span
class="math inline">\(k = 2\)</span> and <span class="math inline">\(V_k
= V\)</span>.</p>
<p>We may find a basis <span
class="math inline">\(e_1,\dotsc,e_m\)</span> for <span
class="math inline">\(V_1\)</span> with respect to which <span
class="math inline">\(\tau_1\)</span> is cyclic and a basis <span
class="math inline">\(\bar{f}_1,\dotsc,\bar{f}_n\)</span> for <span
class="math inline">\(V/V_1\)</span> with respect to which <span
class="math inline">\(\tau_2\)</span> is cyclic, i.e., <span
class="math display">\[\tau_1 e_i = e_{i+1}  \quad (i  &lt; m), \qquad
    \tau_2 \bar{f}_j = \bar{f}_{j+1} \quad (j &lt; n).\]</span></p>
<p>By choosing a splitting <span class="math inline">\(V = V_1 \oplus
V_2\)</span>, we identify <span class="math inline">\(\tau_2\)</span>
with an endomorphism of <span class="math inline">\(V_2\)</span>,
extended by zero to <span class="math inline">\(V\)</span>. We then
define <span class="math inline">\(\tau \in
\mathop{\mathrm{End}}(V)\)</span> by taking <span
class="math display">\[\tau e_i = \tau_1 e_{i},
    \qquad
    \tau f_j =
    \tau_2 f_j
    +
    \begin{cases}
      e_1 &amp; \text{ if } j = n, \\
      0 &amp; \text{ otherwise.}
    \end{cases}\]</span> We claim then that <span
class="math inline">\(f_1\)</span> is a cyclic vector for <span
class="math inline">\(\tau\)</span>. Indeed, the set <span
class="math inline">\(\{f_1, \tau f_1, \dotsc, \tau^{n-1} f_1\} = \{f_1,
f_2, \dotsc, f_{n}\}\)</span> spans <span
class="math inline">\(V_2\)</span>, while the set <span
class="math inline">\(\{\tau^n f_1, \dotsc, \tau^{n+m-1} f_1\}\)</span>
is congruent modulo <span class="math inline">\(V_2\)</span> to the
spanning set <span class="math inline">\(\{e_1, \dotsc, e_m\}\)</span>
for <span class="math inline">\(V_1\)</span>. ◻</p>
</span></div>
<div id="lemma:let-r-be-ring.-write-v-:=-mathbfvr-m-:=-mathbfmr-e"
class="lemma">
<p><strong>Lemma 77</strong>. Let <span class="math inline">\(V_1
\subset \dotsb \subset V_k\)</span> be a flag. Let <span
class="math inline">\(\tau \in M\)</span> be a cyclic element that
preserves this flag. Suppose that <span class="math inline">\(g \in
G\)</span> has the following properties:</p>
<ol type="i">
<li><p><span class="math inline">\(\mathop{\mathrm{Ad}}(g) \tau\)</span>
preserves the flag.</p></li>
<li><p>For each <span class="math inline">\(j\)</span>, the induced
actions of <span class="math inline">\(\tau\)</span> and <span
class="math inline">\(\mathop{\mathrm{Ad}}(g) \tau\)</span> on <span
class="math inline">\(V_j / V_{j-1}\)</span> have the same
characteristic polynomial.</p></li>
</ol>
<p>Then <span class="math inline">\(g\)</span> preserves the flag.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By induction, we may reduce to the case <span
class="math inline">\(k = 2\)</span>. Let <span class="math inline">\(v
\in V\)</span> be <span class="math inline">\(\tau\)</span>-cyclic. Then
every element of <span class="math inline">\(V\)</span> may be written
<span class="math inline">\(f(\tau) v\)</span> for some polynomial <span
class="math inline">\(f \in R[X]\)</span>, so it suffices to show that
if <span class="math inline">\(f(\tau) v \in V_1\)</span>, then <span
class="math inline">\(g f(\tau) v \in V_1\)</span>. Suppose, thus, that
<span class="math inline">\(f(\tau) v \in V_1\)</span>. Let <span
class="math inline">\(v_2 \in V/ V_1\)</span> denote the image of <span
class="math inline">\(v\)</span>, and write <span
class="math inline">\(\tau_2 \in \mathop{\mathrm{End}}(V/V_1)\)</span>
for the induced action of <span class="math inline">\(\tau\)</span> on
the quotient. Then <span class="math inline">\(v_2\)</span> is <span
class="math inline">\(\tau_2\)</span>-cyclic and <span
class="math inline">\(f(\tau_2) v_2 = 0\)</span>, hence <span
class="math inline">\(f(\tau_2) = 0\)</span>. It follows that <span
class="math inline">\(f\)</span> is divisible by the characteristic
polynomial of <span class="math inline">\(\tau_2\)</span> (Lemma <a
href="#lemma:if-tau-cycl-then-char-polyn-p_tau-gener-annih-idea"
data-reference-type="ref"
data-reference="lemma:if-tau-cycl-then-char-polyn-p_tau-gener-annih-idea">8.16</a>).
Since the induced action of <span
class="math inline">\(\mathop{\mathrm{Ad}}(g) \tau\)</span> on <span
class="math inline">\(V / V_1\)</span> has the same characteristic
polynomial as <span class="math inline">\(\tau_2\)</span>, it follows
from the Cayley–Hamilton theorem that <span
class="math inline">\(f(\mathop{\mathrm{Ad}}(g) \tau) V \subseteq
V_1\)</span>. But then <span class="math inline">\(g f(\tau) v =
f(\mathop{\mathrm{Ad}}(g) \tau) g v \in V_1\)</span>, as required. ◻</p>
</span></div>
<h2 id="sec:cj3m0c6a7b">§8.6. Parabolic induction</h2>
<p>The following proposition shows that the existence and uniqueness of
localized vectors is preserved by induction. (The “uniqueness”
assertions will not be used here, but might be useful for certain
extensions of the work of this paper.)</p>
<div id="proposition:regular-stable-closed-under-parabolic-induction"
class="proposition">
<p><strong>Proposition 78</strong>. <em>The class of representations of
general linear groups over <span
class="math inline">\(\mathfrak{o}\)</span> that are regular at depth
<span class="math inline">\(\mathfrak{q}^2\)</span> is closed under
parabolic induction. That is to say, writing <span
class="math inline">\(n = \mathop{\mathrm{rank}}(\mathbf{V})\)</span>,
suppose given a partition <span class="math inline">\(n = m_1 + \dotsb +
m_k\)</span>, corresponding to a parabolic subgroup <span
class="math inline">\(\mathbf{P}\)</span> of <span
class="math inline">\(\mathbf{G}\)</span>, together with a collection of
representations <span class="math inline">\(\pi_j\)</span> (<span
class="math inline">\(j = 1, \dotsc, k\)</span>) of <span
class="math inline">\({\mathop{\mathrm{GL}}}_{m_j}(\mathfrak{o})\)</span>
each of which is regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. Then the same holds for
the parabolic induction <span class="math display">\[\pi :=
{\mathop{\mathrm{Ind}}}_{\mathbf{P}(\mathfrak{o})}^{\mathbf{G}(\mathfrak{o})}(\pi_1
\otimes \dotsb \otimes \pi_k).\]</span> Moreover:</em></p>
<ol type="i">
<li><p><em>Every polynomial for <span class="math inline">\(\pi\)</span>
at depth <span class="math inline">\(\mathfrak{q}^2\)</span> is a
product of polynomials for <span
class="math inline">\(\pi_1,\dotsc,\pi_k\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>.</em></p></li>
<li><p><em>For any polynomials <span
class="math inline">\(P_1,\dotsc,P_k\)</span> for <span
class="math inline">\(\pi_1,\dotsc,\pi_k\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>, the product <span
class="math inline">\(P_1 \dotsm P_k\)</span> is a polynomial for <span
class="math inline">\(\pi\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>.</em></p></li>
<li><p><em>If <span class="math inline">\(\pi_i\)</span> admits a unique
polynomial <span class="math inline">\(P_i\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>, and if <span
class="math inline">\(P_i\)</span> occurs with multiplicity one, then
<span class="math inline">\(P_1 \dotsb P_k\)</span> is likewise the
unique polynomial for <span class="math inline">\(\pi\)</span> at depth
<span class="math inline">\(\mathfrak{q}^2\)</span>, and occurs with
multiplicity one.</em></p></li>
</ol>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> For <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span>, let us temporarily write
<span class="math inline">\(\pi^{\tau}\)</span> for the subspace of
<span class="math inline">\(\pi\)</span> on which <span
class="math inline">\(K(\mathfrak{q})\)</span> acts via <span
class="math inline">\(\chi_\tau\)</span>. Similarly, for an <span
class="math inline">\(m_i \times m_i\)</span> matrix <span
class="math inline">\(\tau_i\)</span> over <span
class="math inline">\(\mathfrak{o}/\mathfrak{q}\)</span>, write <span
class="math inline">\(\pi_i^{\tau_i}\)</span> for the associated
subspace of <span class="math inline">\(\pi_i\)</span>. Let us take for
<span class="math inline">\(\mathbf{P}\)</span> the standard
upper-triangular parabolic subgroup associated to the given partition.
Let <span class="math inline">\(\mathbf{U} &lt; \mathbf{P}\)</span>
denote the unipotent radical and <span
class="math inline">\(\mathbf{L}\)</span> the block-diagonal Levi
factor, thus <span class="math inline">\(\mathbf{L} \cong \prod_{i=1}^k
\mathbf{G}_i\)</span>, where each <span
class="math inline">\(\mathbf{G}_i\)</span> is a general linear group of
rank <span class="math inline">\(m_i\)</span>. We may regard <span
class="math display">\[\Pi := \otimes_i \pi_i\]</span> as a
representation of <span
class="math inline">\(\mathbf{L}(\mathfrak{o})\)</span>. We extend it to
a representation of <span
class="math inline">\(\mathbf{P}(\mathfrak{o})\)</span> by letting <span
class="math inline">\(\mathbf{U}(\mathfrak{o})\)</span> act trivially,
and realize <span class="math inline">\(\pi\)</span> as the space of
functions <span class="math inline">\(v : \mathbf{G}(\mathfrak{o})
\rightarrow \Pi\)</span> such that for all <span class="math inline">\(p
\in \mathbf{P}(\mathfrak{o})\)</span>, <span class="math display">\[v(p
g) = \Pi(p) v(g),\]</span> with the action given by right
translation.</p>
<p>By Mackey theory, a basis for <span
class="math inline">\(\pi^\tau\)</span> is indexed by representatives
<span class="math inline">\(g\)</span> for the double quotient <span id="eqn:mathbfp-mathfr-backsl-mathbfgm--kmathfr-cong-mathb" class="math display">\[\label{eqn:mathbfp-mathfr-backsl-mathbfgm--kmathfr-cong-mathb}\tag{8.5}
    \mathbf{P} (\mathfrak{o}) \backslash \mathbf{G}(\mathfrak{o}) /
K(\mathfrak{q})
    \cong \mathbf{P}(\mathfrak{o}/\mathfrak{q}) \backslash
\mathbf{G}(\mathfrak{o}/\mathfrak{q})\]</span> together with a basis for
the space of vectors <span class="math inline">\(t \in \Pi\)</span> such
that the formula <span class="math display">\[v_g (p g h) =
    \begin{cases}
      \chi_\tau(h) \Pi(p) t  &amp; \text{ if } (p,h) \in
\mathbf{P}(\mathfrak{o}) \times K(\mathfrak{q}), \\
      0 &amp; \text{ otherwise}
    \end{cases}\]</span> is well-defined, that is, for which <span
class="math inline">\(p g h = g \implies \chi_\tau(h) \Pi(p) t =
t\)</span>, or equivalently, <span id="eqn:p-in-mathbfpm-times-g-kmathfr-g-1-impl-chi_-tau-p-" class="math display">\[\label{eqn:p-in-mathbfpm-times-g-kmathfr-g-1-impl-chi_-tau-p-}\tag{8.6}
    p \in \mathbf{P}(\mathfrak{o}) \cap  g K(\mathfrak{q}) g^{-1}
    \implies
    \chi_{\mathop{\mathrm{Ad}}(g) \tau }(p) t = \chi_\tau(g^{-1} p g) t
= \Pi(p) t.\]</span> Since <span
class="math inline">\(K(\mathfrak{q})\)</span> is normal in <span
class="math inline">\(\mathbf{G}(\mathfrak{o})\)</span>, we have <span
class="math display">\[\mathbf{P}(\mathfrak{o}) \cap g K(\mathfrak{q})
g^{-1} = K_P(\mathfrak{q}) := \ker (
    \mathbf{P}(\mathfrak{o}) \rightarrow
\mathbf{P}(\mathfrak{o}/\mathfrak{q})
    ).\]</span> Any element <span class="math inline">\(p\)</span> of
the latter may be written uniquely as <span class="math inline">\(p = m
u\)</span>, where <span class="math inline">\((m, u)\)</span> lies in
<span class="math inline">\(K_L(\mathfrak{q}) \times
K_U(\mathfrak{q})\)</span> (with each factor defined like <span
class="math inline">\(K_P(\mathfrak{q})\)</span>). Assuming that the
vector <span class="math inline">\(t\)</span> is nonzero, the
condition <a
href="#eqn:p-in-mathbfpm-times-g-kmathfr-g-1-impl-chi_-tau-p-"
data-reference-type="eqref"
data-reference="eqn:p-in-mathbfpm-times-g-kmathfr-g-1-impl-chi_-tau-p-">\((8.6)\)</a>
is then equivalent to the following pair of assertions.</p>
<ul>
<li><p><span class="math inline">\(\chi_{\mathop{\mathrm{Ad}}(g)
\tau}(u) = 1\)</span> for all <span class="math inline">\(u \in
K_U(\mathfrak{q})\)</span>. Translating this assertion via the trace
pairing, it says that the element <span
class="math inline">\(\mathop{\mathrm{Ad}}(g) \tau\)</span> of <span
class="math inline">\(\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span>
preserves the flag <span class="math inline">\(\mathcal{F}\)</span> in
<span
class="math inline">\(\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> of
which <span
class="math inline">\(\mathbf{P}(\mathfrak{o}/\mathfrak{q})\)</span> is
the stabilizer.</p></li>
<li><p><span class="math inline">\(\Pi(m) t =
\chi_{\mathop{\mathrm{Ad}}(g) \tau}(m) t\)</span> for all <span
class="math inline">\(m \in K_L(\mathfrak{q})\)</span>. Writing <span
class="math inline">\({(\mathop{\mathrm{Ad}}(g) \tau )}_{ii}\)</span>
for the <span class="math inline">\(i\)</span>th block diagonal <span
class="math inline">\(m_i \times m_i\)</span> matrix, this is equivalent
to the condition <span class="math inline">\(t \in \otimes_{i=1}^k
\pi_i^{{(\mathop{\mathrm{Ad}}(g) \tau)}_{i i}}\)</span>.</p></li>
</ul>
<p>In summary, <span id="eqn:pitau--=-oplus_-subst-g-in-mathbfpm-backsl-mathbfg" class="math display">\[\label{eqn:pitau--=-oplus_-subst-g-in-mathbfpm-backsl-mathbfg}\tag{8.7}
    \pi^{\tau } = \oplus_{
      \substack{
        g \in \mathbf{P}(\mathfrak{o}) \backslash
\mathbf{G}(\mathfrak{o}) / K(\mathfrak{q}) :  \\
        \mathop{\mathrm{Ad}}(g) \tau \text{ preserves } \mathcal{F}
      }
    }
    \otimes_{i=1}^k \pi_i^{{(\mathop{\mathrm{Ad}}(g) \tau)}_{i
i}}.\]</span></p>
<p>The matrices <span class="math inline">\({(\mathop{\mathrm{Ad}}(g)
\tau)}_{i i}\)</span> are cyclic, as their images in <span
class="math inline">\(\mathbf{M}_{m_i}(\mathfrak{o}/\mathfrak{q})\)</span>
are cyclic by Lemma <a
href="#lemma:let-v_0-be-free-tau-invar-subm-v.-assume-tau-regul"
data-reference-type="ref"
data-reference="lemma:let-v_0-be-free-tau-invar-subm-v.-assume-tau-regul">8.15</a>.
If the spaces <span
class="math inline">\(\pi_i^{{(\mathop{\mathrm{Ad}}(g) \tau )}_{i
i}}\)</span> are nonzero, then the characteristic polynomial of <span
class="math inline">\({(\mathop{\mathrm{Ad}}(g) \tau )}_{i i}\)</span>
must be a polynomial for <span class="math inline">\(\pi_j\)</span> at
depth <span class="math inline">\(\mathfrak{q}^2\)</span>. Thus every
polynomial for <span class="math inline">\(\pi\)</span> is a product of
polynomials for the <span class="math inline">\(\pi_j\)</span> inside
the ring <span
class="math inline">\((\mathfrak{o}/\mathfrak{q})[X]\)</span>.</p>
<p>Conversely, suppose given polynomials <span
class="math inline">\(P_1, \dotsc, P_k\)</span> for <span
class="math inline">\(\pi_1,\dotsc,\pi_k\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. By Lemma <a
href="#lemma:let-v_1-subs-dotsb-subs-v_k-be-flag-let-tau_j-in-e"
data-reference-type="ref"
data-reference="lemma:let-v_1-subs-dotsb-subs-v_k-be-flag-let-tau_j-in-e">8.17</a>,
there is a cyclic element <span class="math inline">\(\tau\)</span>
which preserves the flag and for which each <span
class="math inline">\(\tau_{ii}\)</span> has characteristic polynomial
<span class="math inline">\(P_i\)</span>. Then the characteristic
polynomial of <span class="math inline">\(\tau\)</span> is <span
class="math inline">\(P_1 \dotsb P_k\)</span>. On the other hand, the
contribution to <a
href="#eqn:pitau--=-oplus_-subst-g-in-mathbfpm-backsl-mathbfg"
data-reference-type="eqref"
data-reference="eqn:pitau--=-oplus_-subst-g-in-mathbfpm-backsl-mathbfg">\((8.7)\)</a>
from <span class="math inline">\(g = 1\)</span> is positive-dimensional,
so <span class="math inline">\(\pi^\tau\)</span> is nonzero. Thus <span
class="math inline">\(P_1 \dotsb P_k\)</span> is a polynomial for <span
class="math inline">\(\pi\)</span>.</p>
<p>It remains to verify the final assertion concerning uniqueness and
multiplicity one. Suppose that <span
class="math inline">\(\pi^\tau\)</span> is nonzero for some cyclic <span
class="math inline">\(\tau \in M\)</span>. By <a
href="#eqn:pitau--=-oplus_-subst-g-in-mathbfpm-backsl-mathbfg"
data-reference-type="eqref"
data-reference="eqn:pitau--=-oplus_-subst-g-in-mathbfpm-backsl-mathbfg">\((8.7)\)</a>,
we may assume (after conjugating <span
class="math inline">\(\tau\)</span> if necessary) that <span
class="math inline">\(\tau\)</span> preserves <span
class="math inline">\(\mathcal{F}\)</span> and that each <span
class="math inline">\(\pi_i^{\tau_{ii}}\)</span> is nonzero. By
hypothesis, the characteristic polynomial of <span
class="math inline">\(\tau_{ii}\)</span> is <span
class="math inline">\(P_i\)</span> and <span
class="math inline">\(\pi_i^{\tau_{ii}}\)</span> is one-dimensional.
Moreover, by Lemma <a
href="#lemma:let-r-be-ring.-write-v-:=-mathbfvr-m-:=-mathbfmr-e"
data-reference-type="ref"
data-reference="lemma:let-r-be-ring.-write-v-:=-mathbfvr-m-:=-mathbfmr-e">8.18</a>
(applied over <span class="math inline">\(R = \mathfrak{o} /
\mathfrak{q}\)</span>), the only <span class="math inline">\(g \in
\mathbf{G}(\mathfrak{o})\)</span> for which <span
class="math inline">\(\mathop{\mathrm{Ad}}(g) \tau\)</span> preserves
<span class="math inline">\(\mathcal{F}\)</span> and <span
class="math inline">\({(\mathop{\mathrm{Ad}}(g) \tau)}_{ii}\)</span> has
characteristic polynomial <span class="math inline">\(P_i\)</span> lie
in the trivial double coset. Thus <a
href="#eqn:pitau--=-oplus_-subst-g-in-mathbfpm-backsl-mathbfg"
data-reference-type="eqref"
data-reference="eqn:pitau--=-oplus_-subst-g-in-mathbfpm-backsl-mathbfg">\((8.7)\)</a>
reduces to the one-dimensional summand <span
class="math inline">\(\otimes_{i=1}^k \pi_i^{\tau_{ii}}\)</span>. This
proves that <span class="math inline">\(P_1 \dotsb P_k\)</span> is the
unique polynomial for <span class="math inline">\(\pi\)</span> and
occurs with multiplicity one. ◻</p>
</span></div>
<h2 id="sec:cj3m0c6cif">§8.7. Stable pairs of representations</h2>
<p>Recall that in Definition <a
href="#definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f"
data-reference-type="ref"
data-reference="definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f">8.6</a>,
we defined when a pair of representations <span
class="math inline">\((\pi,\sigma)\)</span> is stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>.</p>
<div id="example:stable-pairs-of-characters" class="example">
<p><strong>Example 79</strong>. Let <span
class="math inline">\(\chi\)</span> and <span
class="math inline">\(\eta\)</span> be characters of <span
class="math inline">\(\mathfrak{o}^\times =
{\mathop{\mathrm{GL}}}_1(\mathfrak{o})\)</span>. Then the pair <span
class="math inline">\((\chi,\eta)\)</span> is stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> precisely when <span
class="math inline">\(\chi\)</span> and <span
class="math inline">\(\eta\)</span> have conductor dividing <span
class="math inline">\(\mathfrak{q}^2\)</span> and the ratio <span
class="math inline">\(\chi/\eta\)</span> has conductor exactly <span
class="math inline">\(\mathfrak{q}^2\)</span>. In verifying this, we
observe that <span class="math inline">\(\chi(x) / \eta (x) = \psi (x
(\xi_\chi - \xi_\eta ))\)</span>, which is nontrivial for some <span
class="math inline">\(x \in \mathfrak{p}^{-1} \mathfrak{q}^2\)</span>
precisely when <span class="math inline">\(\xi_\chi - \xi_\eta\)</span>
is a unit, or equivalently, when the polynomials <span
class="math inline">\(X - \xi_\chi\)</span> and <span
class="math inline">\(X - \xi_\eta\)</span> generate the unit ideal in
<span class="math inline">\((\mathfrak{o} /
\mathfrak{q})[X]\)</span>.</p>
</div>
<div id="proposition:stable-pairs-closed-under-parabolic-induction"
class="proposition">
<p><strong>Proposition 80</strong>. <em>The class of pairs of
representations <span class="math inline">\((\pi,\sigma)\)</span> that
are stable at depth <span class="math inline">\(\mathfrak{q}^2\)</span>
is closed under parabolic induction, in the following sense. Suppose
given a finite collection of representations <span
class="math inline">\(\pi_i\)</span> and <span
class="math inline">\(\sigma_j\)</span>, where each pair <span
class="math inline">\((\pi_i,\sigma_j)\)</span> is stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. Let <span
class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) denote the parabolic induction of
the <span class="math inline">\(\pi_i\)</span> (resp. <span
class="math inline">\(\sigma_j\)</span>), as in Proposition <a
href="#proposition:regular-stable-closed-under-parabolic-induction"
data-reference-type="ref"
data-reference="proposition:regular-stable-closed-under-parabolic-induction">8.19</a>.
Then the pair <span class="math inline">\((\pi,\sigma)\)</span> is
likewise stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>.</em></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> This reduces to Proposition <a
href="#proposition:regular-stable-closed-under-parabolic-induction"
data-reference-type="ref"
data-reference="proposition:regular-stable-closed-under-parabolic-induction">8.19</a>
and the following observation: given finite collections of polynomials
<span class="math inline">\(\{P_i\}\)</span> and <span
class="math inline">\(\{Q_j\}\)</span> in <span
class="math inline">\((\mathfrak{o} / \mathfrak{q})[X]\)</span> such
that each pair <span class="math inline">\((P_i,Q_j)\)</span> generates
the unit ideal, the same holds for the pair <span
class="math inline">\((P,Q)\)</span> given by <span
class="math inline">\(P := \prod_i P_i\)</span> and <span
class="math inline">\(Q := \prod_j Q_j\)</span>. (To see this, write
<span class="math inline">\(1 = a_i P_i + b_j Q_j\)</span> and observe
that <span class="math inline">\(\prod_{i,j} (a_i P_i + b_j
Q_j)\)</span> lies in the ideal generated by <span
class="math inline">\(P\)</span> and <span
class="math inline">\(Q\)</span>.) ◻</p>
</span></div>
<div class="example">
<p><strong>Example 81</strong>. Let <span
class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) be a principal series
representation induced by characters <span
class="math inline">\(\chi_i\)</span> (resp. <span
class="math inline">\(\eta_j\)</span>), each of conductor dividing <span
class="math inline">\(\mathfrak{q}^2\)</span>. Suppose that each ratio
<span class="math inline">\(\chi_i / \eta_j\)</span> has conductor <span
class="math inline">\(\mathfrak{q}^2\)</span>. Then <span
class="math inline">\((\pi,\sigma)\)</span> is stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. In verifying this, we may
reduce via Proposition <a
href="#proposition:stable-pairs-closed-under-parabolic-induction"
data-reference-type="ref"
data-reference="proposition:stable-pairs-closed-under-parabolic-induction">8.21</a>
to the case of a pair of characters <span
class="math inline">\((\chi,\eta)\)</span> discussed in Example <a
href="#example:stable-pairs-of-characters" data-reference-type="ref"
data-reference="example:stable-pairs-of-characters">8.20</a>.</p>
</div>
<h2 id="sec:supercuspidals">§8.8. Supercuspidals</h2>
<p>We verify that the above terminology applies to certain supercuspidal
representations of <span class="math inline">\(\mathbf{G}(F)\)</span>.
We do not aim here for an exhaustive treatment, as
representation-theoretic issues are not the focus of this paper.</p>
<p>Write <span class="math inline">\(n := \dim(V)\)</span>. Let <span
class="math inline">\(\tau \in \mathbf{M}(\mathfrak{o})\)</span> be such
that the <span class="math inline">\(F\)</span>-subalgebra <span
class="math display">\[E := F[\tau] \subseteq \mathbf{M}(F)\]</span> is
a field extension of <span class="math inline">\(F\)</span> having the
largest possibly degree, namely <span class="math inline">\(n\)</span>.
Let <span class="math display">\[\eta : E^\times \rightarrow
\mathbb{C}^\times\]</span> be a character. We consider the following
special case:</p>
<div id="enumerate:d1bc2d5fbd54" class="Assumption">
<p><strong>Assumption 82</strong>. <span id="Assumption:supercuspidal"
label="Assumption:supercuspidal"></span> The element <span
class="math inline">\(\tau\)</span> satisfies the following
conditions:</p>
<ol>
<li><p>The image <span class="math inline">\(\overline{\tau}\)</span> of
<span class="math inline">\(\tau\)</span> in <span
class="math inline">\(\mathbf{M}(\mathfrak{o}/\mathfrak{p})\)</span>
also generates a degree <span class="math inline">\(n\)</span> extension
of the residue field. In particular, <span
class="math inline">\(\det(\tau)\in
\mathfrak{o}^\times\)</span>.</p></li>
<li><p>For each <span class="math inline">\(e \in E^\times \cap K
(\mathfrak{q})\)</span>, we have the compatibility condition <span
class="math display">\[\eta(e) = \psi(\mathop{\mathrm{trace}}(\tau
(e-1))).\]</span></p></li>
</ol>
</div>
<p>Recall that <span class="math inline">\(\psi : \mathfrak{q}/
\mathfrak{q}^2 \rightarrow \mathbb{C}^\times\)</span> is a character
nontrivial on <span class="math inline">\(\mathfrak{p} ^{-1}
\mathfrak{q}^2 / \mathfrak{q}^2\)</span>. As <span
class="math inline">\(\tau\)</span> normalizes <span
class="math inline">\(K(\mathfrak{q})\)</span>, so does <span
class="math inline">\(E^\times\)</span>. The subgroup <span
class="math display">\[J_E := E^\times K(\mathfrak{q})\]</span> is
well-defined. It admits the character <span class="math inline">\(\chi :
J_E \rightarrow \mathbb{C}^\times\)</span> defined by the formula <span id="Eq:chi" class="math display">\[\label{Eq:chi}\tag{8.8}
  \chi(e g) := \eta(e) \psi(\mathop{\mathrm{trace}}(\tau (g-1))) \quad
\text{ for } (e,g) \in E^\times \times K(\mathfrak{q}).\]</span></p>
<div id="Remark:assumption1" class="remark">
<p><strong>Remark 83</strong>. The assumption <a
href="#enumerate:d1bc2d5fbd54" data-reference-type="eqref"
data-reference="enumerate:d1bc2d5fbd54">\((1)\)</a>
implies that <span class="math inline">\(E\)</span> is an unramified
extension of <span class="math inline">\(F\)</span>. It also implies
that any nonzero element in <span
class="math inline">\(\mathbf{V}(\mathfrak{o}/\mathfrak{p})\)</span> is
cyclic with respect to the image <span
class="math inline">\(\overline{\tau}\)</span> of <span
class="math inline">\(\tau\)</span> in <span
class="math inline">\(\mathbf{M}(\mathfrak{o}/\mathfrak{p})\)</span>, as
<span
class="math inline">\(\mathbf{V}(\mathfrak{o}/\mathfrak{p})\)</span> is
then a one-dimensional vector space over the field <span
class="math inline">\((\mathfrak{o}/\mathfrak{p})[\overline{\tau}]
\subseteq \mathbf{M}(\mathfrak{o}/\mathfrak{p})\)</span>.</p>
</div>
<div id="lemma:d1bfac67927b" class="lemma">
<p><strong>Lemma 84</strong>. The compact induction <span
class="math display">\[\pi :={\mathop{\mathrm{ind}}}_{J_E}^{\mathbf{G}(F)}
\chi\]</span> is an irreducible supercuspidal representation of <span
class="math inline">\(\mathbf{G}(F)\)</span>.</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> For the notations as above, the pair <span
class="math inline">\((J_E, \chi)\)</span> is a maximal type in the
sense of <span class="citation"
data-cites="BK">(<strong>BK?</strong>)</span>. Thus by <span
class="citation" data-cites="BK">(<strong>BK?</strong>)</span>, the
representation <span class="math inline">\(\pi\)</span> constructed
above is a supercuspidal representation. ◻</p>
</span></div>
<div id="Lem:supercuspidalregular" class="lemma">
<p><strong>Lemma 85</strong>. The representation <span
class="math inline">\(\pi\)</span> constructed in Lemma <a
href="#lemma:d1bfac67927b" data-reference-type="ref"
data-reference="lemma:d1bfac67927b">8.25</a> is regular at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>, with regular parameter
given by <span class="math inline">\(\tau\)</span> modulo <span
class="math inline">\(\mathfrak{q}\)</span> (see §<a
href="#sec:20230516194628" data-reference-type="ref"
data-reference="sec:20230516194628">8.1</a> for definitions).</p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By definition of compact induction, there exists an
element <span class="math inline">\(v\in \pi\)</span> which identifies
with <span class="math inline">\(\chi\)</span> on <span
class="math inline">\(J_E\)</span> and vanishes elsewhere. In particular
<span class="math inline">\(J_E\)</span> acts on <span
class="math inline">\(v\)</span> by <span
class="math inline">\(\chi\)</span>, and so <span
class="math inline">\(K(\mathfrak{q})\subset J_E\)</span> acts on <span
class="math inline">\(v\)</span> by <span
class="math inline">\(\chi_\tau\)</span> as in Definition <a
href="#definition:we-say-that-pi-emphr-at-depth-mathfr-if-there-cycl-regular-depth-parameter-polynomial"
data-reference-type="ref"
data-reference="definition:we-say-that-pi-emphr-at-depth-mathfr-if-there-cycl-regular-depth-parameter-polynomial">8.1</a>.</p>
<p>The element <span class="math inline">\(\tau\)</span> is also cyclic
in the sense of Definition <a href="#definition:cyclic"
data-reference-type="ref" data-reference="definition:cyclic">3.1</a>, by
Remark <a href="#Remark:assumption1" data-reference-type="ref"
data-reference="Remark:assumption1">8.24</a> above. Thus <span
class="math inline">\(\tau\)</span> is a regular parameter for <span
class="math inline">\(\pi\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. ◻</p>
</span></div>
<div id="Rem:supercuspidalclassification" class="remark">
<p><strong>Remark 86</strong>. We expect that one could verify that
every supercuspidal representation with “odd integral depth” and
“generic induction datum” arises via Lemma <a href="#lemma:d1bfac67927b"
data-reference-type="ref" data-reference="lemma:d1bfac67927b">8.25</a>.
Here “depth” should be understood according to the conventions of <span
class="citation"
data-cites="moyUnrefinedMinimalKtypes1994">(<strong>moyUnrefinedMinimalKtypes1994?</strong>)</span>,
while by “generic induction datum”, we mean that the parameter <span
class="math inline">\(\beta\)</span> associated to a simple type
contained in <span class="math inline">\(\pi\)</span> (see <span
class="citation" data-cites="BK">(<strong>BK?</strong>)</span>)
generates a field extension of <span class="math inline">\(F\)</span> of
maximal degree, and that <span class="math inline">\(\beta\)</span> is
minimal in the sense of <span class="citation"
data-cites="BK">(<strong>BK?</strong>)</span>. For the above
construction, if <span class="math inline">\(\mathfrak{q}=
\mathfrak{p}^k\)</span>, then the “depth” is <span
class="math inline">\(2k - 1\)</span>, while we may take <span
class="math inline">\(\beta\)</span> to be <span
class="math inline">\(\varpi^{- 2k + 1} \tau\)</span>.</p>
</div>
<div id="Lem:supercuspidalstablepair" class="lemma">
<p><strong>Lemma 87</strong>. Let <span
class="math inline">\(m,n\)</span> be positive integers, and let <span
class="math inline">\(\pi, \sigma\)</span> be regular supercuspidal
representations of <span
class="math inline">\({\mathop{\mathrm{GL}}}_{m},{\mathop{\mathrm{GL}}}_{n}\)</span>
at depth <span class="math inline">\(\mathfrak{q}^2\)</span>,
constructed above in terms of parameters <span
class="math inline">\(\tau_\pi\)</span> and <span
class="math inline">\(\tau_\sigma\)</span>. We consider the following
two cases:</p>
<ul>
<li><p>Case <span class="math inline">\(m\neq n\)</span>.</p></li>
<li><p>Case <span class="math inline">\(m=n\)</span>. Then the degree
<span class="math inline">\(n\)</span> inert field extensions generated
by <span class="math inline">\(\tau_\pi\)</span> and <span
class="math inline">\(\tau_\sigma\)</span> can be identified, uniquely
up to the action of <span
class="math inline">\(\mathop{\mathrm{Gal}}(E/F) \cong
\mathop{\mathrm{Gal}}(k_E/k_F)\)</span>. We suppose that the images of
<span class="math inline">\(\tau_\pi\)</span> and <span
class="math inline">\(\tau_\sigma\)</span> in the residue field <span
class="math inline">\(k_E\)</span> of <span
class="math inline">\(E\)</span> satisfy <span
class="math display">\[\overline{\tau}_\sigma-\overline{\tau}_\pi^\iota\neq
0\]</span> for all <span class="math inline">\(\iota \in
\mathop{\mathrm{Gal}}(k_E/k_F)\)</span>.</p></li>
</ul>
<p>Then, in either case, the pair <span
class="math inline">\((\pi,\sigma)\)</span> is stable at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. Furthermore, the local
analytic conductor of the Rankin–Selberg pair <span
class="math inline">\(\pi\times \sigma\)</span> is <span id="eq:cj3u9x1ked" class="math display">\[\label{eq:cj3u9x1ked}\tag{8.9}
    C (\pi\times
\sigma)={[\mathfrak{o}:\mathfrak{q}]}^{2mn}.\]</span></p>
</div>
<p>Note that <a href="#eq:cj3u9x1ked" data-reference-type="eqref"
data-reference="eq:cj3u9x1ked">\((8.9)\)</a> generalizes the
conductor formula given in Example <a
href="#example:stable-pairs-of-characters" data-reference-type="ref"
data-reference="example:stable-pairs-of-characters">8.20</a>, which
concerns the special case of characters (i.e., <span
class="math inline">\(m = n = 1\)</span>).</p>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Let <span class="math inline">\(P_\pi,
P_\sigma\)</span> be the polynomials for <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. By Assumption <a
href="#Assumption:supercuspidal" data-reference-type="ref"
data-reference="Assumption:supercuspidal">8.23</a>,
part <a href="#enumerate:d1bc2d5fbd54" data-reference-type="eqref"
data-reference="enumerate:d1bc2d5fbd54">\((1)\)</a>,
they are irreducible polynomials of degrees <span
class="math inline">\(m\)</span> and <span
class="math inline">\(n\)</span>. When <span class="math inline">\(m\neq
n\)</span>, they necessarily generate the unit ideal.</p>
<p>When <span class="math inline">\(m=n\)</span>, the assumption on
<span
class="math inline">\(\overline\tau_\pi,\overline\tau_\sigma\)</span>
implies that the images <span class="math inline">\(\overline{P}_\pi,
\overline{P}_\sigma\)</span> of <span
class="math inline">\(P_\pi,P_\sigma\)</span> mod <span
class="math inline">\(\mathfrak{p}\)</span> satisfy <span
class="math inline">\((\overline{P}_\pi,
\overline{P}_\sigma)=1\)</span>. By Nakayama’s lemma, we then have <span
class="math inline">\((P_\pi,P_\sigma)=1\)</span>.</p>
<p>By Definition <a
href="#definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f"
data-reference-type="ref"
data-reference="definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f">8.6</a>
and Lemma <a href="#Lem:supercuspidalregular" data-reference-type="ref"
data-reference="Lem:supercuspidalregular">8.26</a>, we deduce that the
pair <span class="math inline">\((\pi,\sigma)\)</span> is stable at
depth <span class="math inline">\(\mathfrak{q}^2\)</span>.</p>
<p>The conductor formula follows readily from <a href="#ref-MR1606410" class="citation"
data-cites="MR1606410">(Bushnell, Henniart, and Kutzko 1998, Theorem
6.5(ii))</a>. Indeed, observe first that <span
class="math inline">\(\pi,\sigma\)</span> are “completely distinct” in
the sense of <a href="#ref-MR1606410" class="citation" data-cites="MR1606410">(Bushnell,
Henniart, and Kutzko 1998, sec. 6.2)</a>, so the cited result is
applicable. The ramification indices <span
class="math inline">\(e_i\)</span> there are all <span
class="math inline">\(1\)</span> in our case. The claimed conductor
formula follows by writing <span
class="math inline">\(\mathfrak{q}=\mathfrak{p}^k\)</span> and taking
<span class="math inline">\(m=2k-1\)</span> in <a href="#ref-MR1606410" class="citation"
data-cites="MR1606410">(Bushnell, Henniart, and Kutzko 1998, Theorem
6.5(ii))</a>. ◻</p>
</span></div>
<div class="remark">
<p><strong>Remark 88</strong>. Note that the additional condition in the
<span class="math inline">\(m=n\)</span> case is necessary, as the
conductor would otherwise be smaller. It is the analogue of the
condition we imposed for a pair of characters in Example <a
href="#example:stable-pairs-of-characters" data-reference-type="ref"
data-reference="example:stable-pairs-of-characters">8.20</a>.</p>
</div>
<h1 id="sec:mainlocal">§9. Main local result</h1>
<p>In this section, we retain the general notation and conventions of
§<a href="#sec:notation" data-reference-type="ref"
data-reference="sec:notation">2</a>, and denote by <span
class="math inline">\(n+1\)</span> the rank of <span
class="math inline">\(\mathbf{V}\)</span>. We use the notation <span
class="math inline">\(A \ll B\)</span> to denote that <span
class="math inline">\(\lvert A \rvert \leq C \lvert B \rvert\)</span>,
where <span class="math inline">\(C\)</span> depends at most upon <span
class="math inline">\(n\)</span>. We write <span class="math inline">\(A
\asymp B\)</span> to denote that <span class="math inline">\(A \ll B \ll
A\)</span>.</p>
<p>Let <span
class="math inline">\((F,\mathfrak{o},\mathfrak{p},\varpi,q)\)</span> be
a non-archimedean local field, with associated data as in §<a
href="#sec:local-fields-congruence-subgroups" data-reference-type="ref"
data-reference="sec:local-fields-congruence-subgroups">2.4</a>.</p>
<h2 id="statement-of-result">Statement of result</h2>
<p>The following may be understood as a non-archimedean analogue,
uniform with respect to variation of the local field, of the archimedean
result <a href="#ref-2020arXiv201202187N" class="citation" data-cites="2020arXiv201202187N">(Nelson
2023, Thm 4.2)</a>. It encapsulates the local results needed to prove
Theorem <a href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>.</p>
<div id="enumerate:20230517165012" class="theorem">
<p><strong>Theorem 89</strong>. <em><span id="theorem:main-local-result"
label="theorem:main-local-result"></span> Let <span
class="math inline">\(\mathfrak{q}\subseteq \mathfrak{p}\)</span> be a
nonzero <span class="math inline">\(\mathfrak{o}\)</span>-ideal. Denote
by <span class="math inline">\(Q := [\mathfrak{o}:\mathfrak{q}]\)</span>
its absolute norm.</em></p>
<p><em>Let <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> be representations of <span
class="math inline">\(\mathbf{G}(F)\)</span> and <span
class="math inline">\(\mathbf{H}(F)\)</span> equipped with inner
products <span class="math inline">\(\langle , \rangle\)</span>
invariant by <span class="math inline">\(K(\mathfrak{q})\)</span> and
<span class="math inline">\(K_H(\mathfrak{q})\)</span>, respectively.
Assume that the pair <span class="math inline">\((\pi,\sigma)\)</span>
is stable at depth <span class="math inline">\(\mathfrak{q}^2\)</span>
(Definition <a
href="#definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f"
data-reference-type="ref"
data-reference="definition:let-pi-sigma-be-repr-pair-gener-line-groups-over-f">8.6</a>).
Then there exists</em></p>
<ul>
<li><p><em>a unit vector <span class="math inline">\(v \in
\pi\)</span>,</em></p></li>
<li><p><em>a self-adjoint idempotent <span class="math inline">\(\omega
\in C_c^\infty(K)\)</span> with <span class="math inline">\(\pi(\omega)
v = v\)</span>,</em></p></li>
<li><p><em>a compact open subgroup <span
class="math inline">\(J_H\)</span> of <span
class="math inline">\(K_H\)</span>, and</em></p></li>
<li><p><em>a unit vector <span class="math inline">\(u \in
\sigma\)</span> that is a <span
class="math inline">\(J_H\)</span>-eigenvector,</em></p></li>
</ul>
<p><em>with the following properties.</em></p>
<p><em>Let <span class="math inline">\(\pi|_{Z} : \mathbf{Z}(F)
\rightarrow \mathop{\mathrm{U}}(1)\)</span> denote the central character
of <span class="math inline">\(\pi\)</span>. Define <span
class="math display">\[\omega ^\sharp (g) := \int _{z \in \mathbf{Z}(F)
} \pi|_{Z} (z) \omega (z g ) \, d z.\]</span></em></p>
<ol type="i">
<li><p><em><span id="enumerate:20230517151810"
label="enumerate:20230517151810"></span> We have <span id="eqn:sum-_v-in-mathc-mathc-pif-v-otim-u-gg-q-n2-" class="math display">\[\label{eqn:sum-_v-in-mathc-mathc-pif-v-otim-u-gg-q-n2-}\tag{9.1}
      \int _{h \in \mathbf{H}(F)} \langle h v, v \rangle \langle u, h u
\rangle \, d h \asymp Q^{-n^2},\]</span> where the integrand is
compactly-supported, hence converges absolutely.</em></p></li>
<li><p><em><span id="enumerate:20230517151812"
label="enumerate:20230517151812"></span> We have <span id="eqn:int-_mathbfhf-lvert-f-sharp-rvert-ll-q-n.-" class="math display">\[\label{eqn:int-_mathbfhf-lvert-f-sharp-rvert-ll-q-n.-}\tag{9.2}
      \int _{\mathbf{H}(F)} \lvert \omega ^\sharp  \rvert \ll Q
^{n}.\]</span></em></p></li>
<li><p><em>Let <span class="math inline">\(\Psi_1, \Psi_2 : K_H
\rightarrow \mathbb{C}\)</span> be functions satisfying <span
class="math display">\[\lvert \Psi_j(g z) \rvert = \left\lvert \Psi_j(g)
\right\rvert \text{ for all } (g,z) \in K_H \times  J_H.\]</span> Let
<span class="math display">\[\gamma \in \mathbf{G}(F) - \mathbf{H}(F)
\mathbf{Z}(F).\]</span> Then <span id="eqn:int-_x-y-in-k_h-leftlv-psi_1x-psi_2y-omega-sharp-x" class="math display">\[\label{eqn:int-_x-y-in-k_h-leftlv-psi_1x-psi_2y-omega-sharp-x}\tag{9.3}
      \int _{x, y \in K_H} \left\lvert \Psi_1(x) \Psi_2(y) \omega
^\sharp (x ^{-1} \gamma y) \right\rvert
      \ll
      Q^n
      \left( \frac{1}{1 + Q d_H(\gamma)} +
\frac{{d_H(\gamma)}^{\infty}}{Q^*} \right)
      \lVert \Psi_1 \rVert_{L^2}    
      \lVert \Psi_2 \rVert_{L^2}.\]</span> Here the notation <span
class="math inline">\(d_H(\gamma)\)</span> and <span
class="math inline">\(d_H(\gamma)^\infty\)</span> is as in §<a
href="#sec:norms-distance-functions" data-reference-type="ref"
data-reference="sec:norms-distance-functions">6.2</a>, while <span
class="math inline">\(Q^*\)</span> is as in the statement of Theorem <a
href="#theorem:volume-bound" data-reference-type="ref"
data-reference="theorem:volume-bound">6.7</a>.</em></p></li>
</ol>
</div>
<p>The proof is given in §<a href="#sec:proof-main-local-compact"
data-reference-type="ref"
data-reference="sec:proof-main-local-compact">9.4</a>, following some
preliminaries.</p>
<h2 id="sec:20230517161735">§9.2. Stability and matrix coefficients</h2>
<p>Here we adapt some arguments from <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, sec.
19)</a> to the non-archimedean setting, where they simplify
considerably.</p>
<div id="enumerate:cj3twlzxgy" class="lemma">
<p><strong>Lemma 90</strong>. <span
id="lemma:matrix-coefficients-and-stability-one-rep"
label="lemma:matrix-coefficients-and-stability-one-rep"></span> Let
<span class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(\mathfrak{o}/\mathfrak{q})\)</span>.</p>
<ol type="i">
<li><p><span id="enumerate:cj3twlzoes"
label="enumerate:cj3twlzoes"></span> Let <span
class="math inline">\(\pi\)</span> be a representation of <span
class="math inline">\(\mathbf{G}(\mathfrak{o})\)</span>, equipped with a
<span class="math inline">\(K(\mathfrak{q})\)</span>-invariant inner
product <span class="math inline">\(\langle , \rangle\)</span>, and let
<span class="math inline">\(v \in \pi\)</span> be a vector that
transforms under <span class="math inline">\(K(\mathfrak{q})\)</span>
according to <span class="math inline">\(\chi_\tau\)</span>. Then for
<span class="math inline">\(h \in \mathbf{H}(\mathfrak{o})\)</span>, we
have <span id="eqn:20230516004612" class="math display">\[\label{eqn:20230516004612}\tag{9.4}
      \langle h v, v \rangle = 0 \quad \text{unless } h \in
K_H(\mathfrak{q}).\]</span></p></li>
<li><p>Let <span class="math inline">\(\pi\)</span> be a representation
of <span class="math inline">\(\mathbf{G}(F)\)</span> satisfying the
same hypotheses as above. Then <a href="#eqn:20230516004612"
data-reference-type="eqref"
data-reference="eqn:20230516004612">\((9.4)\)</a> holds for
<span class="math inline">\(h \in \mathbf{H}(F)\)</span>.</p></li>
</ol>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> The group <span id="eqn:kmathfrakq-cap-h-kmathfrakq-h-1-subseteq-k_g-intersection-where-u-goes" class="math display">\[\label{eqn:kmathfrakq-cap-h-kmathfrakq-h-1-subseteq-k_g-intersection-where-u-goes}\tag{9.5}
    K(\mathfrak{q}) \cap h K(\mathfrak{q}) h^{-1} \subseteq K\]</span>
acts on <span class="math inline">\(h v\)</span> by the character <span
class="math inline">\(\chi_\tau(h^{-1} \bullet h)\)</span> and on <span
class="math inline">\(v\)</span> by <span
class="math inline">\(\chi_\tau\)</span>, so by orthogonality of
characters, it suffices to show that whenever <span
class="math inline">\(h \notin K_H(\mathfrak{q})\)</span>, there exists
<span class="math inline">\(u\)</span> in the intersection <a
href="#eqn:kmathfrakq-cap-h-kmathfrakq-h-1-subseteq-k_g-intersection-where-u-goes"
data-reference-type="eqref"
data-reference="eqn:kmathfrakq-cap-h-kmathfrakq-h-1-subseteq-k_g-intersection-where-u-goes">\((9.5)\)</a>
such that <span class="math display">\[\chi_\tau (h ^{-1} u h) \neq \chi
_\tau (u).\]</span> We consider two cases.</p>
<ol type="i">
<li><p>If <span class="math inline">\(h \in
\mathbf{H}(\mathfrak{o})\)</span>, then <span
class="math inline">\(\chi_\tau(h ^{-1} u h) =
\chi_{\mathop{\mathrm{Ad}}(h) \tau}(u)\)</span>, and <span
class="math inline">\(K(\mathfrak{q}) = h K(\mathfrak{q})
h^{-1}\)</span>. For this reason, it suffices to show that <span
class="math inline">\(\mathop{\mathrm{Ad}}(h) \tau \equiv \tau
\mod\mathfrak{q}\)</span> if and only if <span class="math inline">\(h
\in K_H(\mathfrak{q})\)</span>. This is the content of Lemma <a
href="#lemma:stable-implies-trivial-stabilizer"
data-reference-type="ref"
data-reference="lemma:stable-implies-trivial-stabilizer">4.6</a>.</p></li>
<li><p>The case <span class="math inline">\(h \in \mathbf{H}(F) -
\mathbf{H}(\mathfrak{o})\)</span> is addressed by Lemma <a
href="#lemma:let-tau-in-barm_st-h-in-mathbfhf-mathbfhm-then-the"
data-reference-type="ref"
data-reference="lemma:let-tau-in-barm_st-h-in-mathbfhf-mathbfhm-then-the">9.3</a>,
below.</p></li>
</ol>
<p> ◻</p>
</span></div>
<div id="lemma:let-tau-in-barm_st-h-in-mathbfhf-mathbfhm-then-the"
class="lemma">
<p><strong>Lemma 91</strong>. Let <span class="math inline">\(\tau \in
\mathbf{M}_{\mathop{\mathrm{stab}}}(\mathfrak{o}/\mathfrak{q})\)</span>
and <span class="math inline">\(h \in \mathbf{H}(F) -
\mathbf{H}(\mathfrak{o})\)</span>. Then there exists <span
class="math inline">\(u \in K(\mathfrak{q}) \cap h K(\mathfrak{q})
h^{-1}\)</span> such that <span id="eqn:k1-cap-h-k1-h-1-" class="math display">\[\label{eqn:k1-cap-h-k1-h-1-}\tag{9.6}
    \chi_\tau(h ^{-1} u h) \neq \chi _\tau (u).\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> The proof is an adaptation of <a href="#ref-nelson-venkatesh-1" class="citation"
data-cites="nelson-venkatesh-1">(Nelson and Venkatesh 2021, Lemma
19.7)</a>. We will show more precisely that there exists <span
class="math display">\[u \in K(\mathfrak{q}^2) \cap h K(\mathfrak{q}) h
^{-1}\]</span> such that <span class="math inline">\(\chi _\tau (h ^{-1}
u h) \neq 1\)</span>. This suffices in view of the fact that <span
class="math inline">\(\chi_\tau(u) = 1\)</span>.</p>
<p>We choose a basis <span class="math inline">\(e_1,\dotsc,e_n\)</span>
for <span class="math inline">\(\mathbf{V}_H(\mathfrak{o})\)</span>. We
denote by <span class="math inline">\(A_H\)</span> the subgroup of <span
class="math inline">\(\mathbf{H}(F)\)</span> diagonalized by this basis.
Let <span class="math inline">\(A_H^+\)</span> denote the subgroup
consisting of diagonal matrices whose entries are integral powers of the
uniformizer <span class="math inline">\(\varpi\)</span> of <span
class="math inline">\(\mathfrak{p}\)</span>.</p>
<p>We first reduce to the special case that <span
class="math inline">\(h \in A_H^+ - K_H\)</span>. To that end, we apply
the Cartan decomposition to write <span class="math display">\[h = k_1 a
k_2,\]</span> where <span class="math inline">\(k_1, k_2 \in
K_H\)</span> and <span class="math inline">\(a \in A_H^+ - K_H\)</span>.
Then <span class="math display">\[\chi_\tau(h^{-1} u h) =
\chi_{\mathop{\mathrm{Ad}}(k_2) \tau}(a^{-1} k_1^{-1} u k_1 a),\]</span>
<span class="math display">\[K(\mathfrak{q}^2) \cap h K(\mathfrak{q})
h^{-1}
    =
    K(\mathfrak{q}^2) \cap k_1 a K(\mathfrak{q})
a^{-1}k_1^{-1}.\]</span> We observe that <span
class="math inline">\(\mathop{\mathrm{Ad}}(k_2) \tau\)</span> satisfies
the same hypotheses as <span class="math inline">\(\tau\)</span>.
Suppose we can find some <span class="math inline">\(u \in
K(\mathfrak{q}^2) \cap a K(\mathfrak{q}) a^{-1}\)</span> so that <span
class="math display">\[\chi_{\mathop{\mathrm{Ad}}(k_2) \tau}(a^{-1} u a)
\neq 1.\]</span> Then, setting <span class="math display">\[u&#39; :=
k_1 u k_1^{-1} \in K(\mathfrak{q}^2) \cap h K(\mathfrak{q})
h^{-1},\]</span> we obtain <span class="math display">\[\chi_\tau(h^{-1}
u&#39; h) = \chi_{\mathop{\mathrm{Ad}}(k_2) \tau}(a^{-1} u a ) \neq
1,\]</span> as required.</p>
<p>Thus, let <span class="math inline">\(a \in A_H^+ - K_H\)</span>.
Consider the adjoint action of <span class="math inline">\(a\)</span> on
<span class="math inline">\(\mathbf{M}(F)\)</span>. Since <span
class="math inline">\(a \notin K_H\)</span>, there are nontrivial
weights for this action. Suppose for instance that there are positive
weights (an identical argument will apply if there are negative
weights). By conjugating <span class="math inline">\(a\)</span> by a
permutation matrix (as we may, by the preceding argument), we may assume
that the largest diagonal coordinate of <span
class="math inline">\(a\)</span>, say <span
class="math inline">\(\varpi^{-\ell}\)</span> with <span
class="math inline">\(\ell \geq 1\)</span>, appears in components <span
class="math inline">\(1, \dotsc, m\)</span>, where <span
class="math inline">\(m \geq 1\)</span>. If we use the partition <span
class="math display">\[n+1 = m + (n -m) + 1\]</span> to describe <span
class="math inline">\(\mathbf{M}(F)\)</span> as a space of <span
class="math inline">\(3 \times 3\)</span> block matrices, then we may
describe the weight spaces for <span class="math inline">\(a\)</span> as
follows: <span class="math display">\[\begin{pmatrix}
      0 &amp; + &amp; + \\
      - &amp; \ast &amp; \ast \\
      - &amp; \ast &amp; \ast \\
    \end{pmatrix}\]</span> Here the symbol <span
class="math inline">\(0\)</span> indicates where <span
class="math inline">\(a\)</span> acts trivially, while <span
class="math inline">\(+\)</span> (resp. <span
class="math inline">\(-\)</span>) describe <span
class="math inline">\(\mathfrak{o}\)</span>-submodules <span
class="math display">\[\mathbf{M}_{\pm} \subseteq \mathbf{M}\]</span>
such that for <span class="math inline">\(x \in
\mathbf{M}_{\pm}(F)\)</span>, we have <span
class="math display">\[a^{-1} x a = \varpi^{\pm \ell } x;\]</span>
asterisks denote some unspecified combination of trivial, positive and
negative weights. We obtain in particular subspaces <span
class="math display">\[\bar{M}_{\pm } :=
\mathbf{M}_{\pm}(\mathfrak{o}/\mathfrak{q}) \subseteq \bar{M} =
\mathbf{M}(\mathfrak{o}/\mathfrak{q}).\]</span></p>
<p>Let <span class="math inline">\(\tau_+ \in \bar{M}_+\)</span> denote
the component of <span class="math inline">\(\tau \in \bar{M}\)</span>.
We claim that <span class="math inline">\(\tau_+\)</span> is nonzero
modulo <span class="math inline">\(\mathfrak{p}\)</span>, i.e., that
<span class="math inline">\(\tau\)</span> modulo <span
class="math inline">\(\mathfrak{p}\)</span> is not of the form <span
class="math display">\[\begin{pmatrix}
      \ast &amp; 0 &amp; 0 \\
      \ast &amp; \ast &amp; \ast \\
      \ast &amp; \ast &amp; \ast \\
    \end{pmatrix}.\]</span> Indeed, if it were, then <span
class="math inline">\(\tau\)</span> modulo <span
class="math inline">\(\mathfrak{p}\)</span> would stabilize an <span
class="math inline">\(m\)</span>-dimensional subspace of <span
class="math inline">\(\bar{V}_H^*\)</span> modulo <span
class="math inline">\(\mathfrak{p}\)</span>. This contradicts the
characterization <a
href="#enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-"
data-reference-type="eqref"
data-reference="enumerate:there-are-no-nontr-tau-invar-subsp-v_h-or-v_h.-">\((ii)\)</a>
of stability recorded in Lemma <a href="#lemma:stability-equivalences"
data-reference-type="ref"
data-reference="lemma:stability-equivalences">4.5</a>,
noting that <span class="math inline">\(\tau\)</span> modulo <span
class="math inline">\(\mathfrak{p}\)</span> is likewise stable
(Example <a href="#example:cj3twmtcpz" data-reference-type="ref"
data-reference="example:cj3twmtcpz">4.3</a>).</p>
<p>The trace pairing puts <span class="math inline">\(M_+\)</span> and
<span class="math inline">\(M_-\)</span> in duality, so that for each
<span class="math inline">\(x \in M_-\)</span>, we have <span id="eq:cj3twm8wr8" class="math display">\[\label{eq:cj3twm8wr8}\tag{9.7}
    \mathop{\mathrm{trace}}(x \tau) = \mathop{\mathrm{trace}}(x
\tau_+).\]</span> Since <span class="math inline">\(\tau_+\)</span> is
nonzero modulo <span class="math inline">\(\mathfrak{p}\)</span>, we may
find such an <span class="math inline">\(x\)</span> for which <span id="eqn:tracex-tau-in-o-minus-p" class="math display">\[\label{eqn:tracex-tau-in-o-minus-p}\tag{9.8}
    \mathop{\mathrm{trace}}(x \tau_+) \in \mathfrak{o} -
\mathfrak{p}.\]</span> Let <span class="math inline">\(t \in
\mathfrak{p} ^{-1} \mathfrak{q}^2 - \mathfrak{q}^2\)</span>, to be
determined later, and take <span class="math display">\[u := 1 +
\varpi^{\ell} t x.\]</span> We note that, since <span
class="math inline">\(\ell \geq 1\)</span>, we have <span id="eqn:u-in-kmathfrakq2" class="math display">\[\label{eqn:u-in-kmathfrakq2}\tag{9.9}
    u \in K(\mathfrak{q}^2).\]</span> On the other hand, <span id="eqn:a-1-u" class="math display">\[\label{eqn:a-1-u}\tag{9.10}
    a^{-1} u a = 1 + t x \in K(\mathfrak{p}^{-1} \mathfrak{q}^2)
\subseteq K(\mathfrak{q}),\]</span> while <span
class="math display">\[\chi_\tau(a^{-1} u a) = \chi_\tau(1 + t x) =
\psi(\mathop{\mathrm{trace}}(t x \tau )).\]</span> By <a
href="#eq:cj3twm8wr8" data-reference-type="eqref"
data-reference="eq:cj3twm8wr8">\((9.7)\)</a> and <a
href="#eqn:tracex-tau-in-o-minus-p" data-reference-type="eqref"
data-reference="eqn:tracex-tau-in-o-minus-p">\((9.8)\)</a>,
we have <span class="math inline">\(t \mathop{\mathrm{trace}}( x \tau)
\in \mathfrak{p}^{-1} \mathfrak{q}^2 - \mathfrak{q}^2\)</span>. By
choosing <span class="math inline">\(t\)</span> suitably, we may thus
arrange that <span id="eqn:chi_taua-1-u" class="math display">\[\label{eqn:chi_taua-1-u}\tag{9.11}
    \chi_\tau(a^{-1} u a) = \psi(t \mathop{\mathrm{trace}}(x \tau)) \neq
1.\]</span> The required conclusion is then immediate from <a
href="#eqn:u-in-kmathfrakq2" data-reference-type="eqref"
data-reference="eqn:u-in-kmathfrakq2">\((9.9)\)</a>, <a
href="#eqn:a-1-u" data-reference-type="eqref"
data-reference="eqn:a-1-u">\((9.10)\)</a> and <a
href="#eqn:chi_taua-1-u" data-reference-type="eqref"
data-reference="eqn:chi_taua-1-u">\((9.11)\)</a>. ◻</p>
</span></div>
<div id="enumerate:cj3twly3hj" class="lemma">
<p><strong>Lemma 92</strong>. <span
id="lemma:let-pi-sigma-be-pair-repr-mathbfgm-mathbfhm-test-vectors-stable-pairs"
label="lemma:let-pi-sigma-be-pair-repr-mathbfgm-mathbfhm-test-vectors-stable-pairs"></span>
Let <span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> be representations of <span
class="math inline">\(\mathbf{G}(\mathfrak{o})\)</span> and <span
class="math inline">\(\mathbf{H}(\mathfrak{o})\)</span>, respectively,
such that the pair <span class="math inline">\((\pi,\sigma)\)</span> is
stable at depth <span class="math inline">\(\mathfrak{q}^2\)</span>.</p>
<ol type="i">
<li><p>There is a stable element <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> such that <span
class="math inline">\(\tau\)</span> (resp. <span
class="math inline">\(\tau_H\)</span>) is a regular parameter for <span
class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>.</p></li>
<li><p><span id="enumerate:cj3twlwnkr"
label="enumerate:cj3twlwnkr"></span> Suppose <span
class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) is equipped with an inner product
<span class="math inline">\(\langle , \rangle\)</span> invariant by
<span class="math inline">\(K(\mathfrak{q})\)</span> (resp. <span
class="math inline">\(K_H(\mathfrak{q})\)</span>). Let <span
class="math inline">\(\tau\)</span> be any element as above. Let <span
class="math inline">\(v\)</span> (resp. <span
class="math inline">\(u\)</span>) be unit vectors that transform under
<span class="math inline">\(K(\mathfrak{q})\)</span> (resp. <span
class="math inline">\(K_H(\mathfrak{q})\)</span>) according to <span
class="math inline">\(\chi_\tau\)</span> (resp. <span
class="math inline">\(\chi_{\tau_H}\)</span>). Then <span id="eq:cj3twlxge3" class="math display">\[\label{eq:cj3twlxge3}\tag{9.12}
      \int_{h \in \mathbf{H}(\mathfrak{o})} \langle h v, v \rangle
\langle u, h u \rangle \, d h
      = \mathop{\mathrm{vol}}(K_H(\mathfrak{q})).\]</span></p></li>
<li><p>Retaining the hypotheses of <a href="#enumerate:cj3twlwnkr"
data-reference-type="eqref"
data-reference="enumerate:cj3twlwnkr">\((ii)\)</a>, if
<span class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> arise as restrictions of
representations of <span class="math inline">\(\mathbf{G}(F)\)</span>
and <span class="math inline">\(\mathbf{H}(F)\)</span>, then the
formula <a href="#eq:cj3twlxge3" data-reference-type="eqref"
data-reference="eq:cj3twlxge3">\((9.12)\)</a> remains valid after
extending the integral to <span
class="math inline">\(\mathbf{H}(F)\)</span>.</p></li>
</ol>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> Let <span class="math inline">\(P_\pi\)</span> and
<span class="math inline">\(P_\sigma\)</span> be polynomials for <span
class="math inline">\(\pi\)</span> and <span
class="math inline">\(\sigma\)</span> at depth <span
class="math inline">\(\mathfrak{q}^2\)</span> that generate the unit
ideal. By Lemma <a
href="#lemma:let-p-p_h-in-rx-be-monic-polyn-degr-n+1-n-resp-the"
data-reference-type="ref"
data-reference="lemma:let-p-p_h-in-rx-be-monic-polyn-degr-n+1-n-resp-the">4.4</a>,
there exists <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> such that <span
class="math inline">\(P_{\tau} = P_{\pi}\)</span> and <span
class="math inline">\(P_{\tau_H} = P_{\sigma}\)</span>. By Lemma <a
href="#lemma:stability-equivalences" data-reference-type="ref"
data-reference="lemma:stability-equivalences">4.5</a>,
<span class="math inline">\(\tau\)</span> is stable, and in particular,
cyclic. By Lemma <a href="#lemma:tau-stable-implies-tauH-cyclic"
data-reference-type="ref"
data-reference="lemma:tau-stable-implies-tauH-cyclic">4.7</a>, <span
class="math inline">\(\tau_H \in
\mathbf{M}_H(\mathfrak{o}/\mathfrak{q})\)</span> is cyclic. By Lemma <a
href="#lemma:let-p-be-polyn-pi-at-depth-mathfr-let-tau-in-mathb"
data-reference-type="ref"
data-reference="lemma:let-p-be-polyn-pi-at-depth-mathfr-let-tau-in-mathb">8.10</a>,
it follows that <span class="math inline">\(\tau\)</span> (resp. <span
class="math inline">\(\tau_H\)</span>) is a regular parameter for <span
class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>.</p>
<p>For the second assertion <a href="#enumerate:cj3twlwnkr"
data-reference-type="eqref"
data-reference="enumerate:cj3twlwnkr">\((ii)\)</a>
concerning the matrix coefficient integral, we apply part <a
href="#enumerate:cj3twlzoes" data-reference-type="eqref"
data-reference="enumerate:cj3twlzoes">\((i)\)</a> of
Lemma <a href="#lemma:matrix-coefficients-and-stability-one-rep"
data-reference-type="ref"
data-reference="lemma:matrix-coefficients-and-stability-one-rep">9.2</a>
to truncate that integral to <span class="math inline">\(h \in
K_H(\mathfrak{q})\)</span>, where the integrand evaluates to <span
class="math display">\[\chi_\tau(h) {\chi_{\tau_H}(h)}^{-1} =
1.\]</span> For the final assertion <a href="#enumerate:cj3twly3hj"
data-reference-type="eqref"
data-reference="enumerate:cj3twly3hj">\((iii)\)</a>, we
argue similarly using part <a href="#enumerate:cj3twlzxgy"
data-reference-type="eqref"
data-reference="enumerate:cj3twlzxgy">\((ii)\)</a> of
Lemma <a href="#lemma:matrix-coefficients-and-stability-one-rep"
data-reference-type="ref"
data-reference="lemma:matrix-coefficients-and-stability-one-rep">9.2</a>. ◻</p>
</span></div>
<h2 id="sec:cj4t6ynizh">§9.3. Setup for the proof</h2>
<p>We retain the hypotheses of Theorem <a
href="#theorem:main-local-result" data-reference-type="ref"
data-reference="theorem:main-local-result">9.1</a>.
By Lemma <a
href="#lemma:let-pi-sigma-be-pair-repr-mathbfgm-mathbfhm-test-vectors-stable-pairs"
data-reference-type="ref"
data-reference="lemma:let-pi-sigma-be-pair-repr-mathbfgm-mathbfhm-test-vectors-stable-pairs">9.4</a>,
we obtain a stable element <span class="math inline">\(\tau \in
\mathbf{M}(\mathfrak{o}/\mathfrak{q})\)</span> such that <span
class="math inline">\(\tau\)</span> (resp. <span
class="math inline">\(\tau_H\)</span>) is a regular parameter for <span
class="math inline">\(\pi\)</span> (resp. <span
class="math inline">\(\sigma\)</span>) at depth <span
class="math inline">\(\mathfrak{q}^2\)</span>. By Lemma <a
href="#lemma:let-tau-in-mathbfm-mathfr--mathfr-be-regul-param-p-extension-chi-tau-to-J-tau"
data-reference-type="ref"
data-reference="lemma:let-tau-in-mathbfm-mathfr--mathfr-be-regul-param-p-extension-chi-tau-to-J-tau">8.12</a>,
we may find unit vectors <span class="math inline">\(v \in \pi\)</span>
and <span class="math inline">\(u \in \sigma\)</span> that transform
under <span class="math inline">\(J_\tau\)</span> and <span
class="math inline">\(J_{\tau_H}\)</span> by characters <span
class="math inline">\(\tilde{\chi}_\tau\)</span> and <span
class="math inline">\(\tilde{\chi}_{\tau_H}\)</span> that extend <span
class="math inline">\(\chi_\tau\)</span> and <span
class="math inline">\(\chi_{\tau_H}\)</span>, respectively. We set <span
class="math inline">\((J_G, J_H, \chi_G, \chi_H) := (J_\tau, J_{\tau_H},
\tilde{\chi}_\tau, \tilde{\chi}_{\tau_H})\)</span> and <span
class="math display">\[\omega := {\mathop{\mathrm{vol}}(J_G)}^{-1}
\chi_G^{-1} \in C_c^\infty(K),\]</span> so that <span
class="math inline">\(\pi(\omega)\)</span> is a self-adjoint idempotent
with <span class="math inline">\(\pi(\omega) v = v\)</span>.</p>
<p>We pause to clarify the shape of the function <span
class="math inline">\(\omega ^\sharp\)</span>.</p>
<div
id="lemma:g-in-mathbfgf-we-have-begin-lvert-f-sharp-g-rvert-clarify-f-sharp"
class="lemma">
<p><strong>Lemma 93</strong>. For <span class="math inline">\(g \in
\mathbf{G}(F)\)</span>, we have <span class="math display">\[\lvert
\omega ^\sharp (g) \rvert \ll {\mathop{\mathrm{vol}}(J_G)}^{-1} 1 _{g
\in \mathbf{Z}(F) J_G}.\]</span></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> By definition, <span class="math display">\[\omega
^\sharp (g) = \int _{z \in \mathbf{Z}(F)} \pi|_{Z}(z) \omega(z g) \, d
z.\]</span> The function <span class="math inline">\(\omega\)</span> is
supported on <span class="math inline">\(J_G\)</span> and has <span
class="math inline">\(L^\infty\)</span>-norm <span
class="math inline">\({\mathop{\mathrm{vol}}(J_G)}^{-1}\)</span>. It
follows that if <span class="math inline">\(g \notin \mathbf{Z}(F)
J_G\)</span>, then <span class="math inline">\(\omega ^\sharp
(g)\)</span> vanishes. We have <span class="math inline">\(Z(\mathbf{F})
\cap J_G = K_Z\)</span>, so the set of <span
class="math inline">\(z\)</span> for which <span
class="math inline">\(\omega(z g) \neq 0\)</span> is a <span
class="math inline">\(K_Z\)</span>-coset, and so has volume <span
class="math inline">\(\ll 1\)</span>. We have assumed that <span
class="math inline">\(\pi\)</span> is unitary, so <span
class="math inline">\(\lvert \pi|_{Z} (z) \rvert = 1\)</span>. The
stated estimate follows from these observations and the triangle
inequality. ◻</p>
</span></div>
<h2 id="sec:proof-main-local-compact">§9.4. The proof</h2>
<p>We now verify each numbered assertion in turn.</p>
<ol type="i">
<li><p>We see from Lemmas <a
href="#lemma:matrix-coefficients-and-stability-one-rep"
data-reference-type="ref"
data-reference="lemma:matrix-coefficients-and-stability-one-rep">9.2</a>
and <a
href="#lemma:let-pi-sigma-be-pair-repr-mathbfgm-mathbfhm-test-vectors-stable-pairs"
data-reference-type="ref"
data-reference="lemma:let-pi-sigma-be-pair-repr-mathbfgm-mathbfhm-test-vectors-stable-pairs">9.4</a>
that the integrand in <a
href="#eqn:sum-_v-in-mathc-mathc-pif-v-otim-u-gg-q-n2-"
data-reference-type="eqref"
data-reference="eqn:sum-_v-in-mathc-mathc-pif-v-otim-u-gg-q-n2-">\((9.1)\)</a>
is supported on <span class="math inline">\(h \in
K_H(\mathfrak{q})\)</span> and the integral evaluates to <span
class="math inline">\(\mathop{\mathrm{vol}}(K_H(\mathfrak{q})) \asymp
Q^{-n^2}\)</span>, as required.</p></li>
<li><p>By Lemma <a
href="#lemma:g-in-mathbfgf-we-have-begin-lvert-f-sharp-g-rvert-clarify-f-sharp"
data-reference-type="ref"
data-reference="lemma:g-in-mathbfgf-we-have-begin-lvert-f-sharp-g-rvert-clarify-f-sharp">9.5</a>,
we have <span id="eqn:int-_mathbfhf-lvert-f-sharp-rvert-ll-frac1v-int-_h" class="math display">\[\label{eqn:int-_mathbfhf-lvert-f-sharp-rvert-ll-frac1v-int-_h}\tag{9.13}
    \int _{\mathbf{H}(F)} \lvert \omega ^\sharp  \rvert \ll
    \frac{1}{\mathop{\mathrm{vol}}(J_G)}
    \int _{h \in \mathbf{H}(F)} 1 _{\mathbf{Z}(F) J_G }(h) \, d
h.\]</span> We must verify that the above is <span
class="math inline">\(\ll Q^n\)</span>. Suppose <span
class="math inline">\(h \in \mathbf{H}(F)\)</span> may be written <span
class="math inline">\(h = z g\)</span> with <span
class="math inline">\((z, g ) \in \mathbf{Z} (F) \times J _G\)</span>.
Then <span class="math display">\[z^{-1} h \in J_G \cap \mathbf{H}(F)
\mathbf{Z}(F) = J_G \cap K_H K_Z
    = (J_G \cap K_H)K_Z,\]</span> since <span class="math inline">\(K_Z
\subseteq J_G\)</span>. By Lemma <a
href="#lemma:stable-implies-trivial-stabilizer"
data-reference-type="ref"
data-reference="lemma:stable-implies-trivial-stabilizer">4.6</a>, we have
<span class="math display">\[J_G \cap K_H = K_H(\mathfrak{q}).\]</span>
We have <span id="eqn:volj_g-=-k_g-:-j_g-1-asymp-qn+12-n+1-=-qnn+1.-vol-J-G" class="math display">\[\label{eqn:volj_g-=-k_g-:-j_g-1-asymp-qn+12-n+1-=-qnn+1.-vol-J-G}\tag{9.14}
{\mathop{\mathrm{vol}}(J_G)}^{-1}
\mathop{\mathrm{vol}}(K_H(\mathfrak{q}))
    = \frac{[K : J_G]}{[K_H : K_H(\mathfrak{q})]} \asymp
\frac{Q^{{(n+1)}^2 - (n+1)}}{Q^{n^2}} = Q^{n}.\]</span> The required
estimate follows.</p></li>
<li><p>We are given <span class="math inline">\(\Psi_1, \Psi_2 : K_H
\rightarrow \mathbb{C}\)</span> whose magnitudes are right-invariant by
<span class="math inline">\(J_{\tau_H}\)</span>, and <span
class="math inline">\(\gamma \in \mathbf{G}(F) - \mathbf{H}(F)
\mathbf{Z}(F)\)</span>. We must verify that <span id="eqn:i_1-:=-int-_x-y-in-k_h-leftlv-psi_1x-psi_2y-f-shar-task" class="math display">\[\label{eqn:i_1-:=-int-_x-y-in-k_h-leftlv-psi_1x-psi_2y-f-shar-task}\tag{9.15}
    I_1 := \int _{x, y \in K_H} \left\lvert \Psi_1(x) \Psi_2(y) \omega
^\sharp (x ^{-1} \gamma y) \right\rvert
    \ll \Delta Q^n \lVert \Psi_1 \rVert_{L^2} \lVert \Psi_2
\rVert_{L^2},\]</span> where <span class="math inline">\(\Delta\)</span>
is the parenthetical quantity on the right hand side of <a
href="#eqn:int-_x-y-in-k_h-leftlv-psi_1x-psi_2y-omega-sharp-x"
data-reference-type="eqref"
data-reference="eqn:int-_x-y-in-k_h-leftlv-psi_1x-psi_2y-omega-sharp-x">\((9.3)\)</a>.
By the bound for <span class="math inline">\(\omega ^\sharp\)</span>
recorded in Lemma <a
href="#lemma:g-in-mathbfgf-we-have-begin-lvert-f-sharp-g-rvert-clarify-f-sharp"
data-reference-type="ref"
data-reference="lemma:g-in-mathbfgf-we-have-begin-lvert-f-sharp-g-rvert-clarify-f-sharp">9.5</a>,
we see that the left hand side of <a
href="#eqn:i_1-:=-int-_x-y-in-k_h-leftlv-psi_1x-psi_2y-f-shar-task"
data-reference-type="eqref"
data-reference="eqn:i_1-:=-int-_x-y-in-k_h-leftlv-psi_1x-psi_2y-f-shar-task">\((9.15)\)</a>
vanishes unless there exists <span class="math inline">\(z \in
\mathbf{Z}(F)\)</span> so that <span class="math display">\[z \gamma \in
K_H J_G K_H \subseteq K.\]</span> Replacing <span
class="math inline">\(\gamma\)</span> by <span
class="math inline">\(z^{-1} \gamma\)</span> has no effect on either
side of the desired estimate, so we may suppose that <span
class="math inline">\(\gamma \in K\)</span>. Then, since <span
class="math inline">\(x,y \in K_H \subseteq K\)</span> and <span
class="math inline">\(\mathbf{Z}(F) J_G \cap K = J_G\)</span>, we have
<span class="math display">\[\lvert \omega ^\sharp (x ^{-1} \gamma y)
\rvert \ll {\mathop{\mathrm{vol}}(J_G)}^{-1} 1 _{x ^{-1} \gamma y \in
J_G}.\]</span> The integral <span class="math inline">\(I_1\)</span>
descends to the quotient <span class="math display">\[\bar{H} := K_H /
K_H(\mathfrak{q}).\]</span> For <span
class="math inline">\(j=1,2\)</span>, let <span
class="math inline">\(u_j : \bar{H} \rightarrow \mathbb{R}_{\geq
0}\)</span> denote the function induced by <span
class="math inline">\(\lvert \Psi_j \rvert\)</span>. By definition, the
image of <span class="math inline">\(J_G\)</span> in <span
class="math inline">\(K / K(\mathfrak{q})\)</span> is the centralizer of
<span class="math inline">\(\tau\)</span>. The integral <span
class="math inline">\(I_1\)</span> thus satisfies <span
class="math display">\[I_1 \ll {\mathop{\mathrm{vol}}(J_G)}^{-1}
I,\]</span> where <span class="math inline">\(I\)</span> is the
integral <a href="#eqn:i-:=-frac1lv-h-rvert2-sum-_-subst-x-y-in-h-:-"
data-reference-type="eqref"
data-reference="eqn:i-:=-frac1lv-h-rvert2-sum-_-subst-x-y-in-h-:-">\((7.1)\)</a>
defined in the statement of Theorem <a
href="#theorem:bilinear-forms-estimate" data-reference-type="ref"
data-reference="theorem:bilinear-forms-estimate">7.1</a>, which gives
<span class="math display">\[I \ll \Delta \lvert \bar{H} \rvert^{-1}
\lVert u_1 \rVert _{L^2} \lVert u_2 \rVert_{L^2}.\]</span> The required
estimate for <span class="math inline">\(I_1\)</span> follows now
from <a
href="#eqn:volj_g-=-k_g-:-j_g-1-asymp-qn+12-n+1-=-qnn+1.-vol-J-G"
data-reference-type="eqref"
data-reference="eqn:volj_g-=-k_g-:-j_g-1-asymp-qn+12-n+1-=-qnn+1.-vol-J-G">\((9.14)\)</a>.</p></li>
</ol>
<h1 id="Sec:final">§10. Completion of the proof</h1>
<p>We now deduce our main result Theorem <a href="#theorem:cj3ngw7u2s"
data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>, from our
main local result, Theorem <a href="#theorem:main-local-result"
data-reference-type="ref"
data-reference="theorem:main-local-result">9.1</a>.
The deduction is exactly as in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 6)</a>, so we
will be brief. We denote in what follows by <span
class="math inline">\(\mathbb{Z}_{\mathfrak{l}} \leq
F_{\mathfrak{l}}\)</span> the ring of integers in the completion of
<span class="math inline">\(F\)</span> at a finite place <span
class="math inline">\(\mathfrak{l}\)</span>.</p>
<div id="proposition:20230517165122" class="proposition">
<p><strong>Proposition 94</strong>. <em>Fix <span
class="math inline">\(\alpha &gt; 0\)</span> and <span
class="math inline">\(\varepsilon&gt; 0\)</span>. Retain the setting of
Theorem <a href="#theorem:cj3ngw7u2s" data-reference-type="ref"
data-reference="theorem:cj3ngw7u2s">1.1</a>; in
particular, <span class="math inline">\(F\)</span> is a number field,
<span class="math inline">\((G,H) = (\mathop{\mathrm{U}}(V),
\mathop{\mathrm{U}}(W))\)</span> is a pair of unitary groups attached to
a nondegenerate codimension one inclusion <span class="math inline">\(W
\hookrightarrow V\)</span> of positive-definite hermitian spaces over
<span class="math inline">\(F\)</span>, <span
class="math inline">\(S\)</span> is a large enough finite set of places,
<span class="math inline">\((\pi,\sigma,\mathfrak{p},\mathfrak{q}) \in
\mathcal{F}\)</span>, <span class="math inline">\(T\)</span> is the
absolute norm of <span class="math inline">\(\mathfrak{q}^2\)</span>,
and <span class="math inline">\(\vartheta \in [0,1/2)\)</span> is such
that <span class="math inline">\(\sigma\)</span> is <span
class="math inline">\(\vartheta\)</span>-tempered at every finite place
<span class="math inline">\(\mathfrak{l}\notin S \cup
\{\mathfrak{p}\}\)</span> that splits in <span
class="math inline">\(E\)</span>. Set <span class="math inline">\(L :=
T^{\alpha}\)</span>. Let <span class="math inline">\(\omega \in
C_c^\infty(G(\mathbb{Z}_\mathfrak{p}))\)</span> and <span
class="math inline">\(J_H \leq H(\mathbb{Z}_\mathfrak{p})\)</span> be as
in Theorem <a href="#theorem:main-local-result"
data-reference-type="ref"
data-reference="theorem:main-local-result">9.1</a>
applied to <span
class="math inline">\((\pi_\mathfrak{p},\sigma_\mathfrak{p})\)</span>.
There exists <span class="math inline">\(c &gt; 0\)</span>, depending
only upon <span class="math inline">\(\alpha\)</span> and <span
class="math inline">\((G,H,S)\)</span>, with the following property. For
<span class="math inline">\(j=0,\dotsc,n+1\)</span>, let <span
class="math inline">\(\Delta_j\)</span> denote the infimum of all
nonnegative quantities with the following property: for all <span
class="math inline">\(u_1, u_2 \in
L^2(H(\mathbb{Z}_\mathfrak{p}))\)</span> of unit norm that transform on
the right under <span class="math inline">\(J_H\)</span> via some
unitary character, and all <span class="math inline">\(\gamma \in
G(F_\mathfrak{p})\)</span> with <span
class="math inline">\(d_{H_\mathfrak{p}}(\gamma) \geq c L^{-j}\)</span>,
we have <span id="eqn:20230517152904" class="math display">\[\label{eqn:20230517152904}\tag{10.1}
    \int_{x, y \in H(\mathbb{Z}_\mathfrak{p})}
    \left\lvert
      u_1(x)
      u_2(y)
      \omega^\sharp (x^{-1} \gamma y )
    \right\rvert
    \, d x \, d y
    \leq T^{n / 2} \Delta_j.\]</span> Then <span
class="math display">\[\begin{align}
    \frac{\mathcal{L} (\pi,\sigma)}{T^{n(n+1)/2 + \varepsilon}}
    &amp;\ll
      \sum _{j=1}^{n+1}
      \left(
      L^{-(1-2 \vartheta) j}
      +
      L^{(2 {(n+1)}^2 - n)j}
      \Delta_j
      \right)\\
    &amp;\quad +
      L^{-1}
      \sum _{j=0}^{n+1}
      \left(
      L^{-(1-2 \vartheta) j}
      +
      L^{(2 {(n+1)}^2 - n )j}
      \Delta_j
      \right),
  
\end{align}\]</span> where the meaning of <span
class="math inline">\(\ll\)</span> is “bounded in magnitude up to a
factor depending only upon <span
class="math inline">\((\mathcal{F},\alpha,\varepsilon,
\vartheta)\)</span>”.</em></p>
</div>
<div class="proof"><p>
<a href="#" class="toggle-proof"><em data-default-text="Proof." data-folded-text="Proof. (...)">Proof.</em></a>
<span class="proof-content"> This follows from the arguments of <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, sec.
6)</a>, applied with <span class="math inline">\(Q=T^{1/2}\)</span>.
The positive-definiteness assumption is used in two ways: so that the
quotient <span class="math inline">\(H(F) \backslash
H(\mathbb{A})\)</span> is compact, and so that each of the groups <span
class="math inline">\(G\)</span> and <span
class="math inline">\(H\)</span> are compact at infinity. This last
property is used in applying <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, Lem 5.1)</a>.</p>
<p>In more detail, we repeat <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, secs. 6.1–6.4)</a>
verbatim (omitting the adjective “archimedean” in a couple places — this
property is never used). In the first line of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, sec. 6.5.1)</a>, we
observe that the integrand in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, (6.5))</a> is now
invariant merely under <span
class="math inline">\(\prod_{\mathfrak{l}\notin S \cup \{\mathfrak{p}\}}
H(\mathbb{Z}_\mathfrak{l})\)</span>, rather than the larger group <span
class="math inline">\(\prod_{\mathfrak{l}\notin S}
H(\mathbb{Z}_\mathfrak{l})\)</span>. (This is because of a difference in
conventions: in <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023)</a>, <span
class="math inline">\(S\)</span> contains the interesting place, while
here, it does not.) In the subsequent estimates, we accordingly replace
the factorizable neighborhood <span
class="math inline">\(\Theta_S\)</span> with <span
class="math display">\[\Theta_{S \cup \{\mathfrak{p}\}} := \Theta_S
H(\mathbb{Z}_\mathfrak{p}).\]</span> The remainder of <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, secs.
6.5.1–6.5.2)</a> is unchanged. The integral on the left hand side
of <a href="#eqn:20230517152904" data-reference-type="eqref"
data-reference="eqn:20230517152904">\((10.1)\)</a> arises
naturally following the proof<a href="#fn2" class="footnote-ref"
id="fnref2" role="doc-noteref"><sup>2</sup></a> of <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, Lem
6.7)</a>. We feed the resulting estimate into the summary of <a href="#ref-2020arXiv201202187N"
class="citation" data-cites="2020arXiv201202187N">(Nelson 2023, sec.
6.6)</a> to obtain the stated bound. ◻</p>
</span></div>
<p>We now apply Theorem <a href="#theorem:main-local-result"
data-reference-type="ref"
data-reference="theorem:main-local-result">9.1</a>,
part <a href="#enumerate:20230517165012" data-reference-type="eqref"
data-reference="enumerate:20230517165012">\((iii)\)</a>
to see that the quantities <span class="math inline">\(\Delta_j\)</span>
as in Proposition <a href="#proposition:20230517165122"
data-reference-type="ref"
data-reference="proposition:20230517165122">10.1</a> satisfy <span id="eqn:20230517165322" class="math display">\[\label{eqn:20230517165322}\tag{10.2}
  \Delta_j \ll \frac{L^j}{T^{1/2}} + \frac{1}{R },\]</span> where <span
class="math inline">\(R\)</span> is given by <span
class="math display">\[T = q^{2 m} \implies R = q^{\lceil m/2
\rceil}.\]</span> In particular, <span class="math inline">\(R\)</span>
satisfies the slightly wasteful estimate <span class="math inline">\(R
\geq T^{1/4}\)</span>. Substituting this estimate into the right hand
side of the bound stated in Proposition <a
href="#proposition:20230517165122" data-reference-type="ref"
data-reference="proposition:20230517165122">10.1</a>, we see that two
terms dominate, giving <span id="eqn:20230517170454" class="math display">\[\label{eqn:20230517170454}\tag{10.3}
  \frac{\mathcal{L}(\pi,\sigma)}{ T^{n (n + 1 )/2 + \varepsilon}}
  \ll
  L^{-(1 - 2 \vartheta )} + L^{(2 {(n + 1 )}^2 - n ) (n+1)} \left(
\frac{L^{n+1}}{ T^{1/2} }
    + \frac{1}{T^{1/4} }\right).\]</span> Expanding the right hand side
as a sum of three terms, the first and third terms are equal if <span
class="math display">\[L^{- (1 - 2 \vartheta )}
  =
  L^{(2 {(n + 1 )}^2 - n ) (n+1)}
  \frac{1}{T^{1/4} },\]</span> or equivalently, <span
class="math display">\[\alpha = \frac{1}{4 ( A + 1 - 2 \vartheta)},
\quad A := (2 {(n + 1 )}^2 - n ) (n + 1).\]</span> We then have <span
class="math inline">\(A \geq n+1\)</span>, hence <span
class="math inline">\((n+1) \alpha \leq 1/4\)</span>, so the second term
on the right hand side of <a href="#eqn:20230517170454"
data-reference-type="eqref"
data-reference="eqn:20230517170454">\((10.3)\)</a> is
dominated by the third term. The estimate <a href="#eqn:20230517170454"
data-reference-type="eqref"
data-reference="eqn:20230517170454">\((10.3)\)</a> thus
simplifies to the required bound <span
class="math display">\[\frac{\mathcal{L}(\pi,\sigma)}{ T^{n (n + 1 )/2 +
\varepsilon}}
  \ll
  T^{-\delta}, \quad
  \delta := \frac{1 - 2 \vartheta }{4 (A + 1 - 2 \vartheta
)}.\]</span></p>
<div id="refs" class="references csl-bib-body hanging-indent"
role="list">
<div id="ref-MR2016587" class="csl-entry" role="listitem">
Baruch, Ehud Moshe. 2003. <span>“Bessel Functions for <span>GL</span>(3)
over a <span><span class="math inline">\(p\)</span></span>-Adic
Field.”</span> <em>Pacific J. Math.</em> 211 (1): 1–33. <a
href="https://doi.org/10.2140/pjm.2003.211.1">https://doi.org/10.2140/pjm.2003.211.1</a>.
</div>
<div id="ref-MR2726097" class="csl-entry" role="listitem">
Bernstein, Joseph, and Andre Reznikov. 2010. <span>“Subconvexity Bounds
for Triple <span><span class="math inline">\(L\)</span></span>-Functions
and Representation Theory.”</span> <em>Ann. Of Math. (2)</em> 172 (3):
1679–1718. <a
href="https://doi.org/10.4007/annals.2010.172.1679">https://doi.org/10.4007/annals.2010.172.1679</a>.
</div>
<div id="ref-MR4426741" class="csl-entry" role="listitem">
Beuzart-Plessis, Raphaël, Pierre-Henri Chaudouard, and Michał Zydor.
2022. <span>“The Global
<span>G</span>an-<span>G</span>ross-<span>P</span>rasad Conjecture for
Unitary Groups: The Endoscopic Case.”</span> <em>Publ. Math. Inst.
Hautes Études Sci.</em> 135: 183–336. <a
href="https://doi.org/10.1007/s10240-021-00129-1">https://doi.org/10.1007/s10240-021-00129-1</a>.
</div>
<div id="ref-MR1606410" class="csl-entry" role="listitem">
Bushnell, Colin J., Guy M. Henniart, and Philip C. Kutzko. 1998.
<span>“Local <span>R</span>ankin-<span>S</span>elberg Convolutions for
<span><span class="math inline">\({\rm GL}_n\)</span></span>: Explicit
Conductor Formula.”</span> <em>J. Amer. Math. Soc.</em> 11 (3): 703–30.
<a
href="https://doi.org/10.1090/S0894-0347-98-00270-7">https://doi.org/10.1090/S0894-0347-98-00270-7</a>.
</div>
<div id="ref-DFI94" class="csl-entry" role="listitem">
Duke, W., J. B. Friedlander, and H. Iwaniec. 1994. <span>“Bounds for
Automorphic <span><span
class="math inline">\(L\)</span></span>-Functions.
<span>II</span>.”</span> <em>Invent. Math.</em> 115 (2): 219–39.
</div>
<div id="ref-MR1923476" class="csl-entry" role="listitem">
———. 2002. <span>“The Subconvexity Problem for <span>A</span>rtin
<span><span class="math inline">\(L\)</span></span>-Functions.”</span>
<em>Invent. Math.</em> 149 (3): 489–577. <a
href="https://doi.org/10.1007/s002220200223">https://doi.org/10.1007/s002220200223</a>.
</div>
<div id="ref-MR1322960" class="csl-entry" role="listitem">
Eisenbud, David. 1995. <em>Commutative Algebra</em>. Vol. 150. Graduate
Texts in Mathematics. Springer-Verlag, New York. <a
href="https://doi.org/10.1007/978-1-4612-5350-1">https://doi.org/10.1007/978-1-4612-5350-1</a>.
</div>
<div id="ref-MR3159075" class="csl-entry" role="listitem">
Harris, R. Neal. 2014. <span>“The Refined
<span>G</span>ross-<span>P</span>rasad Conjecture for Unitary
Groups.”</span> <em>Int. Math. Res. Not. IMRN</em>, no. 2: 303–89.
</div>
<div id="ref-MR0327982" class="csl-entry" role="listitem">
Howe, Roger E. 1973. <span>“On the Principal Series of <span><span
class="math inline">\({\rm Gl}\sb{n}\)</span></span> over <span><span
class="math inline">\(p\)</span></span>-Adic Fields.”</span> <em>Trans.
Amer. Math. Soc.</em> 177: 275–86. <a
href="https://doi.org/10.2307/1996596">https://doi.org/10.2307/1996596</a>.
</div>
<div id="ref-MR0579176" class="csl-entry" role="listitem">
———. 1977. <span>“Kirillov Theory for Compact <span><span
class="math inline">\(p\)</span></span>-Adic Groups.”</span> <em>Pacific
J. Math.</em> 73 (2): 365–81. <a
href="http://projecteuclid.org/euclid.pjm/1102810616">http://projecteuclid.org/euclid.pjm/1102810616</a>.
</div>
<div id="ref-MR2585578" class="csl-entry" role="listitem">
Ichino, Atsushi, and Tamutsu Ikeda. 2010. <span>“On the Periods of
Automorphic Forms on Special Orthogonal Groups and the
<span>G</span>ross-<span>P</span>rasad Conjecture.”</span> <em>Geom.
Funct. Anal.</em> 19 (5): 1378–1425. <a
href="https://doi.org/10.1007/s00039-009-0040-4">https://doi.org/10.1007/s00039-009-0040-4</a>.
</div>
<div id="ref-MR1942691" class="csl-entry" role="listitem">
Iwaniec, Henryk. 2002. <em>Spectral Methods of Automorphic Forms</em>.
Second. Vol. 53. Graduate Studies in Mathematics. Providence, RI:
American Mathematical Society.
</div>
<div id="ref-iwan-sar" class="csl-entry" role="listitem">
Iwaniec, Henryk, and Peter Sarnak. 1995. <span>“<span><span
class="math inline">\(L^\infty\)</span></span> Norms of Eigenfunctions
of Arithmetic Surfaces.”</span> <em>Ann. Of Math. (2)</em> 141 (2):
301–20. <a
href="https://doi.org/10.2307/2118522">https://doi.org/10.2307/2118522</a>.
</div>
<div id="ref-MR3267120" class="csl-entry" role="listitem">
Lapid, Erez, and Zhengyu Mao. 2015. <span>“A Conjecture on
<span>W</span>hittaker-<span>F</span>ourier Coefficients of Cusp
Forms.”</span> <em>J. Number Theory</em> 146: 448–505. <a
href="https://doi.org/10.1016/j.jnt.2013.10.003">https://doi.org/10.1016/j.jnt.2013.10.003</a>.
</div>
<div id="ref-MR3649366" class="csl-entry" role="listitem">
———. 2017a. <span>“On an Analogue of the
<span>I</span>chino-<span>I</span>keda Conjecture for
<span>W</span>hittaker Coefficients on the Metaplectic Group.”</span>
<em>Algebra Number Theory</em> 11 (3): 713–65. <a
href="https://doi.org/10.2140/ant.2017.11.713">https://doi.org/10.2140/ant.2017.11.713</a>.
</div>
<div id="ref-MR3619910" class="csl-entry" role="listitem">
———. 2017b. <span>“Whittaker-<span>F</span>ourier Coefficients of Cusp
Forms on <span><span class="math inline">\(\widetilde{\rm
Sp}_n\)</span></span>: Reduction to a Local Statement.”</span> <em>Amer.
J. Math.</em> 139 (1): 1–55. <a
href="https://doi.org/10.1353/ajm.2017.0000">https://doi.org/10.1353/ajm.2017.0000</a>.
</div>
<div id="ref-michel-2009" class="csl-entry" role="listitem">
Michel, Philippe, and Akshay Venkatesh. 2010. <span>“The Subconvexity
Problem for <span><span class="math inline">\({\rm
GL}_2\)</span></span>.”</span> <em>Publ. Math. Inst. Hautes Études
Sci.</em>, no. 111: 171–271. <a
href="https://doi.org/10.1007/s10240-010-0025-8">https://doi.org/10.1007/s10240-010-0025-8</a>.
</div>
<div id="ref-2021arXiv210915230N" class="csl-entry" role="listitem">
Nelson, Paul D. 2021. <span>“<span class="nocase">Bounds for standard
<span><span
class="math inline">\(L\)</span></span>-functions</span>.”</span>
<em>arXiv e-Prints</em>, September, arXiv:2109.15230. <a
href="https://arxiv.org/abs/2109.15230">https://arxiv.org/abs/2109.15230</a>.
</div>
<div id="ref-2020arXiv201202187N" class="csl-entry" role="listitem">
———. 2023. <span>“Spectral Aspect Subconvex Bounds for <span><span
class="math inline">\(U_{n+1} \times U_n\)</span></span>.”</span>
<em>Invent. Math.</em> 232 (3): 1273–1438. <a
href="https://doi.org/10.1007/s00222-023-01180-x">https://doi.org/10.1007/s00222-023-01180-x</a>.
</div>
<div id="ref-nelson-venkatesh-1" class="csl-entry" role="listitem">
Nelson, Paul D., and A. Venkatesh. 2021. <span>“<span class="nocase">The
orbit method and analysis of automorphic forms</span>.”</span> <em>Acta
Math.</em> 226 (1): 1–209.
</div>
<div id="ref-2007arXiv0705.2168R" class="csl-entry" role="listitem">
Rallis, S., and G. Schiffmann. 2007. <span>“<span
class="nocase">Multiplicity one Conjectures</span>.”</span> <em>ArXiv
e-Prints</em>, May. <a
href="https://arxiv.org/abs/0705.2168">https://arxiv.org/abs/0705.2168</a>.
</div>
<div id="ref-MR780071" class="csl-entry" role="listitem">
Sarnak, Peter. 1985. <span>“Fourth Moments of
<span>G</span>rössencharakteren Zeta Functions.”</span> <em>Comm. Pure
Appl. Math.</em> 38 (2): 167–78. <a
href="https://doi.org/10.1002/cpa.3160380204">https://doi.org/10.1002/cpa.3160380204</a>.
</div>
<div id="ref-venkatesh-2005" class="csl-entry" role="listitem">
Venkatesh, Akshay. 2010. <span>“Sparse Equidistribution Problems, Period
Bounds and Subconvexity.”</span> <em>Ann. Of Math. (2)</em> 172 (2):
989–1094. <a
href="https://doi.org/10.4007/annals.2010.172.989">https://doi.org/10.4007/annals.2010.172.989</a>.
</div>
<div id="ref-MR3164988" class="csl-entry" role="listitem">
Zhang, Wei. 2014. <span>“Automorphic Period and the Central Value of
<span>R</span>ankin-<span>S</span>elberg
<span>L</span>-Function.”</span> <em>J. Amer. Math. Soc.</em> 27 (2):
541–612. <a
href="https://doi.org/10.1090/S0894-0347-2014-00784-0">https://doi.org/10.1090/S0894-0347-2014-00784-0</a>.
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>using SAGE <span class="citation"
data-cites="sage2023">(<strong>sage2023?</strong>)</span> (and its
components Singular <span class="citation"
data-cites="DGPS">(<strong>DGPS?</strong>)</span> and GiNaC) and Emacs
Calc<a href="#fnref1" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>We note that the statement of <a href="#ref-2020arXiv201202187N" class="citation"
data-cites="2020arXiv201202187N">(Nelson 2023, Lem 6.7)</a> contains
a regrettable typo, introduced in the final revision: <span
class="math inline">\({d_{H_\mathfrak{q}}(\gamma)}^{-1/2}\)</span>
should be <span
class="math inline">\({d_{H_\mathfrak{q}}(\gamma)}^{-1}\)</span>. This
does not affect the present argument.<a href="#fnref2"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<script>
document.querySelectorAll(".toggle-proof").forEach(function(toggle) {
  toggle.addEventListener("click", function(e) {
    e.preventDefault();
    const content = this.nextElementSibling;
    const em = this.querySelector('em');
    if (window.getComputedStyle(content).display === "none") {
      content.style.display = "inline";
      em.textContent = em.dataset.defaultText;
    } else {
      content.style.display = "none";
      em.textContent = em.dataset.foldedText;
    }
  });
});
</script>
<script>
document.querySelector("#toggle-all-proofs").addEventListener("click", function(e) {
  e.preventDefault();
  const proofs = document.querySelectorAll(".proof-content");
  proofs.forEach(function(proof) {
    const proofToggle = proof.previousElementSibling;
    if (window.getComputedStyle(proof).display === "none") {
      proof.style.display = "inline";
      proofToggle.innerHTML = `<em>${proofToggle.dataset.defaultText}</em>`;
    } else {
      proof.style.display = "none";
      proofToggle.innerHTML = `<em>${proofToggle.dataset.foldedText}</em>`;
    }
  });
});
</script>

<script src="https://giscus.app/client.js"
        data-repo="Ultronozm/math"
        data-repo-id="R_kgDOJlhjqQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOJlhjqc4CWo21"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</body>
</html>

\documentclass[reqno]{amsart} \input{common.tex}

\begin{document}

\title{Aarhus Automorphic Forms Summer School}

\begin{abstract}
  Notes in progress on lectures taking place there.
\end{abstract}

\section{Gebhard Boeckle's lectures}
\subsection{Galois representations and congruences}

We first discuss profinite groups.  Let $G$ be a topological group.

\begin{theorem}
  The following are equivalent:
  \begin{enumerate}[(a)]
  \item\label{enumerate:cq6r3e8dsb} $G$ is compact, Hausdorff, and totally disconnected.
  \item\label{enumerate:cq6r3e8eqf} $G$ is compact, and admits a neighborhood basis of the identity by open normal subgroups.
  \item\label{enumerate:cq6r3e8f6g} There is a directed poset $I$ and an inverse system $(G_i)$ of finite (discrete) groups such that $G = \varprojlim_I G_i$.
  \end{enumerate}
\end{theorem}
We say that $G$ is \emph{profinite} if the above conditions hold.  The topology on $\varprojlim G_i$ is that obtained by regarding it as a closed subgroup of the product $\prod G_i$.

Constructions:
\begin{enumerate}[(a)]
\item\label{enumerate:cq6r3e8b0y} If $G$ is discrete, then we equip it with the profinite topology $G^{\mathrm{pf}} := \varprojlim G / N$, where $N$ runs over the finite index subgroups.
\item\label{enumerate:cq6r3e8cou} If $G = \varprojlim G_i$ is profinite, then
  \begin{enumerate}[(i)]
  \item\label{enumerate:cq6r3fehbe} The abelianization is given by
    \begin{equation*}
      G^{\mathrm{ab}} = G / \overline{[G, G]} = \varprojlim G_i^{\mathrm{ab}},
    \end{equation*}
    and in particular, is profinite.
  \item\label{enumerate:cq6r3feivc} For $H$ finite, write $H_p$ for its maximal $p$-group quotient.  Then
    \begin{equation*}
      G_p = \varprojlim(G_i)_p
    \end{equation*}
    is a pro-$p$-group (and in particular, profinite).
  \item\label{enumerate:cq6r3fej61} If $N \leq G$ is closed and normal, then $G /N$ is profinite.
  \end{enumerate}
\end{enumerate}

\begin{example}
  \begin{enumerate}[(a)]
  \item\label{enumerate:cq6r3fjkt4} Let $F$ be a field.  Set $G_F := \Aut_F(F^{\mathrm{sep}}) = \Gal(F^{\mathrm{sep}} / F)$ profinite.  Define the poset
    \begin{equation*}
      \mathcal{I}_F := \left\{ L \subseteq F^{\mathrm{sep}} : L \supseteq F \text{ finite Galois}, \subseteq \right\}.      
    \end{equation*}
    Then
    \begin{equation*}
      G_F \xrightarrow{\cong} \varprojlim_{L \in \mathcal{I}_F} \Gal(L / F).
    \end{equation*}
  \item\label{enumerate:cq6r3fm1jw} Let $F' \subseteq F^{\mathrm{sep}}$ be a normal extension of $F$.  Then $G_{F'} \leq G_F$ is closed and normal.  We may thus write
    \begin{equation*}
      \Gal(F ' / F) \cong G_F / G_{F'} = \lim_{
        \substack{
          L \in \mathcal{I}_F,  \\
          L \subseteq F'          
        }
      }
      \Gal(L /F).
    \end{equation*}
  \item\label{enumerate:cq6r3fm4tn} Let $\mathbb{N}$ denote the natural numbers, ordered by divisibility.  Then
    \begin{equation*}
      \hat{\mathbb{Z}} = \varprojlim \mathbb{Z} / n = \prod_{p} \mathbb{Z}_p,
    \end{equation*}
    where the last step is the Chinese remainder theorem.  We sometimes need a slight modification:
    \begin{equation*}
      \hat{\mathbb{Z}}^{(p)} = \varprojlim_{p \nmid n} \mathbb{Z} / n = \prod_{\ell \text{ prime}, \\ \ell \neq p } \mathbb{Z}_{\ell}.
    \end{equation*}

    Let's fix some notation:
    \begin{enumerate}
    \item\label{enumerate:cq6r3f3t8d} Let $K$ be a number field, $\mathcal{O}_K$ its ring of integers.  Let $\mathrm{P l}_K = \mathrm{P l}_K^\infty \sqcup \mathrm{P l}_K^{\mathrm{fin}}$ denote the set of places $v$ of $K$.  Let $v$ be a finite place.  We may then attach to it a maximal ideal $\mathfrak{q}_v$ of $\mathcal{O}_K$, giving a bijection
      \begin{equation*}
        \mathrm{P l}_K^{\mathrm{fin}} \leftrightarrow \operatorname{Max}(\mathcal{O}_K).
      \end{equation*}
      We may form the residue field $k_v := \mathcal{O}_K / \mathfrak{q}_v$.  We denote $q_v$ for the cardinality of $k_v$.  We write $\operatorname{char}(v)$ for the characteristic of $k_v$.  We denote by $\mathcal{O}_v = \varprojlim \mathcal{O} / \mathfrak{q}_v^n$, with fraction field $K_v$.  Also, we have a short exact sequence
      \begin{equation*}
        1 \rightarrow I_v \rightarrow G_v := \Gal_{K_v} \rightarrow \Gal_{k_v} \rightarrow 1.
      \end{equation*}
      A topological generator for $\Gal_{k_v}$ is given by
      \begin{equation*}
        \mathrm{Fr}_v : \alpha \mapsto \alpha^{q_v}.
      \end{equation*}
      We denote by $\mathrm{Frob}_v \in G_v$ some lift of $\mathrm{Fr}_v$.

      We write $S_\infty := \mathrm{P l}_K^\infty$ for the set of archimedean places, so that $K \otimes_{\mathbb{Q}} \mathbb{R} \cong \prod_{v \in S_\infty} K_v$.  For a rational prime $p$, we write $S_p$ for the set of places $v$ of $K$ such that $v \mid p$.
    \item We also need some local analogues for $E \supseteq \mathbb{Q}_p$ a $p$-adic field.  Let $\mathcal{O} = \mathcal{O}_E$ denote the ring of integers, $\pi = \pi_E$ a uniformizer, and $\mathbb{F} = \mathcal{O}_E / \pi$ the residue field, with $q = \# \mathbb{F}$.  Then $E \supseteq \mathbb{Q}_q = \mathbb{Q}_p[\zeta_{q - 1}] \supseteq \mathbb{Q}_p$.  We have $W(\mathbb{F}) = \mathbb{Z}_q = \mathbb{Z}_p[\zeta_{q - 1}]$.
    \end{enumerate}

    Contiuing the examples, which may serve as exercises:
    
  \item\label{enumerate:cq6r3g5d9c} Let $\zeta_t$ be a primitive $t$th root of $1$.  For $k$ a finite field, we have $G_k \cong \hat{\mathbb{Z}} = \overline{\langle \mathrm{Fr}_k \rangle}$, where $\mathrm{Fr}_k : \alpha \mapsto \alpha^{\lvert k \rvert}$.
  \item\label{enumerate:cq6r3g5e7y} Let $E \supseteq \mathbb{Q}_p$ (finite extension).  Then $G_E$ (Jannsen--Wingberg for $p \geq 2$).  Local class field theory: the Artin map $E^\times \rightarrow G_E^{\mathrm{ab}}$ is a continuous inclusion with dense image.  Writing $E^\times = \pi_E^{\mathbb{Z}} \times \mathcal{O}_E^\times = \pi_E^{\mathbb{Z}} \times \mathbb{F}^\times \times \mathcal{U}_E^1$.  Since the units are known to be a finitely generated $\mathbb{Z}_p$-module, we get as a corollary that
    \begin{equation*}
      \Hom_{\mathrm{cts}}(G_E, \mathbb{F}_p) = H^1_{\mathrm{cts}}(G_E, \mathbb{F}_p)
    \end{equation*}
    is finite.
  \item\label{enumerate:cq6r3g5cxb} We turn to the case of a number field $K$.  We fix an embedding $K^{\mathrm{sep}} \subseteq K_v^{\mathrm{sep}}$ for each place $v$, which gives an embedding of Galois groups $G_v \rightarrow G_K$.  For $S \subseteq \mathrm{P l}_K$ finite, we write
    \begin{equation*}
      K_S := \left\{ \alpha \in K^{\mathrm{sep}} : K(\alpha) \text{ is unramified outside } S \right\},
    \end{equation*}
    which is a normal (typically infinite) extension of $K$.  We write
    \begin{equation*}
      G_{K, S} := \Gal(K_S / K) = G_K / G_{K_S}
    \end{equation*}
    for its Galois group.  We remark that if we take $v \notin S$, then since $v$ does not ramify in $K_S$, we know that the map $G_v \rightarrow G_{K, S}$ factors via the quotient $G_v / I_v \cong G_{k_v}$, so that $\mathrm{Frob}_v \in G_{K, S}$ is independent of the choice of lift.  On the other hand, if $v \in S$, then we might ask whether the map $G_v \hookrightarrow G_{K, S}$ (see the work of Cheniever--Clozel).  The structure of $G_{K, S}$ is unknown, but global class field theory describes $G_{K, S}^{\mathrm{ab}}$.  A corollary is that
    \begin{equation*}
      H^{1}_{\mathrm{cts}}(G_{K, S}, \mathbb{F}_p) = \Hom_{\mathrm{cts}}(G_{K, S}, \mathbb{F}_p)
    \end{equation*}
    is finite whenever $S$ is finite.  (One can appeal to Hermite--Minkowski, or class field theory.)
  \item\label{enumerate:cq6r3g5bmp} Consider the tame quotient of $G_E$, for $E \supseteq \mathbb{Q}_p$.  Given $E \supseteq \mathbb{Q}_p$, we form the tower of extensions $E^{\mathrm{tame}} / E^{\mathrm{unr}} / E$, where
    \begin{equation*}
      E^{\mathrm{unr}} = \cup \left\{ E(\zeta_n) : p \nmid n \right\},
    \end{equation*}
    \begin{equation*}
      E^{\mathrm{tame}} = \cup \left\{ E^{\mathrm{unr}}(\sqrt[n]{\pi_E}) : p \nmid n \right\}.
    \end{equation*}
    It's a fact that $G_E^{\mathrm{tame}}$ may be expressed as the profinite completion of $\langle s t : s t s^{-1} = t^q \rangle$.
  \end{enumerate}
\end{example}
We finally come to \textbf{Galois representations}.  They will typically be called $\rho : G \rightarrow \mathrm{GL}_n(A)$, where $G$ is a topological group, $A$ is a topological ring, and $\rho$ is a continuous map.  The topology on $\mathrm{GL}_n(A)$ is the subspace topology coming from embedding inside $M_n(A) \times A$ via $g \mapsto(g, \det(g)^{-1})$, for instance.  We call $\rho$ a Galois representation if $G = G_F$ for some field $F$.  The main examples of interest for $A$ will be $\mathbb{C}$, finite fields, and $p$-adic fields, to interpolate $\mathrm{C N L}_{\mathcal{O}}$ (complete Noetherian local $\mathcal{O}$-algebras).

\begin{exercise}
  Let $G$ be profinite, and $\rho$ as above.
  \begin{enumerate}[(a)]
  \item If $A = \mathbb{C}$, then $\rho(G)$ is finite.
  \item If $A = \overline{\mathcal{O}_p}$, then there is a finite extension $E \supseteq \mathbb{Q}_p$ such that $\rho(G) \subseteq \mathrm{GL}_n(E)$ up to conjugation.
  \item\label{enumerate:cq6r3j15cy} If $A = E \supseteq \mathbb{Q}_p$ (finite extension), then after conjugation, we can assume that $\rho(G) \subseteq \mathrm{GL}_n(\mathcal{O})$.
  \end{enumerate}
\end{exercise}
In case \eqref{enumerate:cq6r3j15cy}, we have a $G$-stable lattice $\Lambda \cong \mathcal{O}^n \subseteq E^n$.  We can apply reduction $\mathcal{O} \rightarrow \mathbb{F}$.  This gives a reduction
\begin{equation*}
  \overline{\rho}_\Lambda : G \rightarrow \mathrm{GL}_n(\mathbb{F}).
\end{equation*}
Let's use the notation $\mathrm{c p}_\alpha$ for the characteristic polynomial of $\alpha \in M_n(A)$.
\begin{theorem}
  \begin{enumerate}[(a)]
  \item Given a representation $r : G \rightarrow \mathrm{GL}_n(\mathbb{F})$.  Then there exists a semisimple representation $r^{\mathrm{ss}} : G \rightarrow \mathrm{GL}_n(\mathbb{F})$ such that $\mathrm{c p}_r = \mathrm{c p}_{r^{\mathrm{ss}}}$ (Brauer--Nesbitt), where $r^{\mathrm{ss}}$ is unique up to isomorphism.
  \item We have $\mathrm{c p}_{\rho} \in \mathcal{O}[X]$ and $\mathrm{c p}_{\bar{\rho}_\Lambda} \in \mathbb{F}[X]$, independent of $\Lambda$.
  \end{enumerate}
\end{theorem}
\begin{theorem}
  For $\rho, \rho ' : G_{K, S} \rightarrow \mathrm{GL}_n(E)$ semisimple, we have that $\rho \sim \rho '$ (conjugate) if and only if  for all $v \in \mathrm{P l}_K^{\mathrm{fin}} \setminus S$, we have
  \begin{equation*}
    \mathrm{c p}_{\rho(\Frob_v)} = \mathrm{c p}_{\rho '(\Frob_v)}.
  \end{equation*}
\end{theorem}
\begin{example}
  \begin{enumerate}
  \item\label{enumerate:cq6r3ki8zp} $p$-adic cyclotomic character $\chi_p^{\mathrm{cyc}} : G_{\mathbb{Q}} \rightarrow \mathbb{Z}_p^\times$.  We have
    \begin{equation*}
      G_{\mathbb{Q}} \circlearrowright \mu_{p^n} = \left\langle \zeta_{p^n} \right\rangle \cong \mathbb{Z} / p^n,
    \end{equation*}
    $(\mathbb{Z} / p^n)^\times = \Aut_{\mathbb{Z}}(\mathbb{Z} / p^n)$.
    \textbf{Facts}:
    \begin{itemize}
    \item $\chi_p^{\mathrm{cyc}} \mid_{G_K}$: unramified outside $S_p \cup S_\infty$.
    \item $\chi_p^{\mathrm{cyc}}(\Frob_v) = q_v \in \mathbb{Z}_p^\times$.
    \end{itemize}
  \item\label{enumerate:cq6r3ki7yl} The Tate module of an elliptic curve $\mathcal{E}_{/ K}$.  We again have $G_K \circlearrowright \mathcal{E}[p^n](\bar{K}) \cong(\mathbb{Z} / p^n)^{\oplus 2}$, which gives rise to $G_K \rightarrow \mathrm{GL}_2(\mathbb{Z} / p^n)$.  In the limit, we get
    \begin{equation*}
      \rho_{\mathcal{E}, p} : G_K \rightarrow \mathrm{GL}_2(\mathbb{Z}_p) \hookrightarrow \mathrm{GL}_2(\mathbb{Q}_p).
    \end{equation*}
    \textbf{Facts}:
    \begin{itemize}
    \item $\rho_{\mathcal{E},p}$ is unramified outside $S_\infty \cup S_p \cup \mathrm{Bad}$.
    \item For $v$ outside those places, we have
      \begin{equation*}
        \mathrm{c p}_{\rho_{\mathcal{E}, p}}(\Frob_v) = X^2 - a_v(\mathcal{E}) X + q_v,
      \end{equation*}
      where
      \begin{equation*}
        a_v := \# \mathcal{E}(k_v).
      \end{equation*}
      This shows the geometric meaning of Frobenius.
    \end{itemize}
  \item\label{enumerate:cq6sj47m05} Let $f = q + \sum_{n \geq 2} a_n q^n$ be the $q$-expansion of a cuspidal Hecke eigenform $f \in S_k(N, \eps)$, $k \geq 1$, $\eps :(\mathbb{Z} / N)^\times \rightarrow \mathbb{C}^\times$.
    \begin{theorem}
      \begin{enumerate}[(a)]
      \item\label{enumerate:cq6sj5bs5p} $E_f = \mathbb{Q}(a_n : n \geq 1)$ is a number field, with $a_n \in \mathcal{O}_{E_f}$ for all $n$.
      \item\label{enumerate:cq6sj5bt7j} (Eichler--Shimura, Deligne, Deligne--Serre) For all finite places $\lambda$ of $E_f$ (with $E_\lambda$ the completion of $\lambda$ and $p$ the characteristic of $k_\lambda$) there exists an absolutely irreducible representation
        \begin{equation*}
          \rho_{f, \lambda} : G_{\mathbb{Q}, N \cup \{p, \infty\}} \rightarrow \mathrm{GL}_2(\bar{E}_\lambda)
        \end{equation*}
        and for all primes $\ell \nmid N p$, we have the relation that we just saw in Chris's talk:
        \begin{equation*}
          \mathrm{c p}_{\rho_{f , \lambda}}(\mathrm{Frob}_{\ell}) = X^2 - a_{\ell} X + \eps(\ell) \ell^{k - 1}.
        \end{equation*}
      \end{enumerate}
    \end{theorem}
    This characterizes the representation  and maybe gives the main link to Galois representation.
  \end{enumerate}
\end{example}

Now, we want to study congruences.  To do this, we first go from
\begin{itemize}
\item cusp forms that start life over the complex numbers on the upper half plane, to
\item Fourier coefficients, that live over the integers.
\end{itemize}
(For simplicity, assume that nebentypus is trivial: $\eps = 1$.)  Let $S_k(N, \mathbb{Z})$ denote the set of all $f = \sum_{n \geq 1} a_n q^n$ such that $a_n \in \mathbb{Z}$ for all $n$.
\begin{fact}
  $S_k(N, \mathbb{Z})$ is a $\mathbb{Z}$-module of rank equal to $\dim_{\mathbb{C}} S_k(N)$.
\end{fact}
For any ring $A$, we have
\begin{equation*}
  \underline{S}_{A} = S_k(N, \mathbb{Z}) \otimes_{\mathbb{Z}} A \circlearrowleft \mathbb{T}_A = \mathbb{T}(N, A).
\end{equation*}

\begin{definition}
  For Hecke eigenforms $f = \sum a_n q^n$ and $g = b_n q^n \in S_k(N, \bar{\mathbb{Z}}_p)$, we say that $f \equiv g \pmod{p}$ if the following equivalent conditions hold:
  \begin{itemize}
  \item for all primes $\ell \nmid N p$, we have $a_{\ell} \equiv b_{\ell} \pmod{\mathfrak{m}_{\overline{\mathbb{Z}_p}}}$.
  \item $\rho_f \equiv \rho_g \pmod{\mathfrak{m} \bar{\mathbb{Z}}_p}$ as maps $G_{\mathbb{Q}} \rightarrow \mathrm{GL}_2(\bar{\mathbb{F}}_p)$.
  \end{itemize}
\end{definition}
We pass to the same Hecke algebra.  Let $\mathbb{T}_A '$ denote the subalgebra of $\mathbb{T}_A$ generated by $T_{\ell}$ for all $\ell \nmid N$.  This is acted on by $\underline{S}_A$.
\begin{fact}
  We have bijections between the following:
  \begin{itemize}
  \item $\mathbb{T} '$-Hecke eigensystems of forms in $S_k(N)$.
  \item $\Hom_{\mathbb{C}}(\mathbb{T}_{\mathbb{C}}', \mathbb{C})$.
  \item $\Hom_{\mathcal{O}}(\mathbb{T}_{\mathcal{O}}', \mathcal{O})$, where we choose $E$ large enough with $\mathbb{C} \supseteq \bar{\mathbb{Q}} \subseteq \bar{\mathbb{Q}}_p \supseteq E \supseteq \mathcal{O}$, where $\mathcal{O}$ always denotes the ring of integers of $E$.
  \end{itemize}
  We also have a bijection between
  \begin{itemize}
  \item $\Hom_{\mathcal{O}}(\mathbb{T}_{\mathcal{O}}, \mathbb{F})$, and
  \item The set of $\bar{\rho} : G_{\mathbb{Q}} \rightarrow \mathrm{GL}_2(\mathbb{F})$ that are semisimple reductions from some $\rho_f$, with $f \in S_k(N)$.
  \end{itemize}
  $\mathbb{T} '$ is a finite free $\mathcal{O}$-algebra.  For any $\bar{\rho}$, we get a maximal ideal $\mathfrak{m}_{\bar{\rho}} \subseteq \mathbb{T} '_{\mathcal{O}}$.  For a given $\bar{\rho}$, if we take
  \begin{equation*}
    (\mathbb{T}_{\mathcal{O}}')_{\mathfrak{m}_{\bar{\rho}}},
  \end{equation*}
  then this is the relevant Hecke algebra for understanding the forms congruent to $\bar{\rho}$.
\end{fact}
\begin{theorem}[Carayol, Serre]
  Assume that $\bar{\rho}$ is absolutely irreducible.  Then there exists a continuous representation
  \begin{equation}\label{eq:cq6sj6h73f}
    \rho_{\bar{\rho}}^{\mathrm{mod}} : G_{\mathbb{Q}, N \cup \{p, \infty\}} \rightarrow \mathrm{GL}_2 \left((\mathbb{T}_0 ')_{\mathfrak{m}_{\bar{\rho}}} \right)
  \end{equation}
  ``built'' from the $\rho_f$, for $f \in S_k(N, \bar{\mathbb{Z}}_p)$, with $\rho_f \equiv \bar{\rho}$ modulo $\mathfrak{m}_{\bar{\mathbb{Z}}_p}$.
\end{theorem}
(One can write down a characteristic polynomial, similar to the above.)  Maybe one should also say that
\begin{equation}\label{eq:cq6sj6d3yn}
  \left( \mathbb{T} '_{\mathcal{O}} \right)_{\mathfrak{m}_{\bar{\rho}}} \subseteq \prod_{f, \rho_f \equiv \bar{\rho}} \mathcal{O},
\end{equation}
where the left hand side is generated by all the
\begin{equation*}
  \left\{ \trace \rho_f(\Frob_{\ell}) : \rho_f \equiv \bar{\rho}, \ell \nmid N p \right\}.
\end{equation*}
Now, is the inclusion \eqref{eq:cq6sj6d3yn} strict?  If you take twice the same form, then you get twice the same value.

\textbf{Vision of Mazur}?  Can $\rho_{\bar{\rho}}^{\mathrm{mod}}$ be characterized purely in terms of ``Galois'' theory, maybe at least once $\bar{\rho}$ is given?  You need to start somewhere.  Start with the mod $p$ representation.  Then there's a sort of $p$-adic representation \eqref{eq:cq6sj6h73f} that you get here, which sees all forms congruent to $\bar{\rho}$.  Can you see this sort of thing from a purely Galois-theoretic perspective?  This might have been the starting point for the study of deformations of Galois representations.  Mazur maybe had one example in mind: Hida had just written down his Hida families, which are much bigger than things of fixed weight and level.

Let's now turn to \emph{deformation functors}.  In many ways, what we're doing now at the beginning is very formal, and maybe in the next lecture it gets a bit more Galois-theoretic.  Let $G$ be a profinite group -- think of some global Galois group.  Let $E \supseteq \mathcal{O} \rightarrow \mathbb{F}$ be a local field, with uniformizer $\pi$ and residue field cardinality $q$.  In what natural category do these $\mathcal{O}$-algebras $\mathbb{T}_{\mathcal{O}}'$ live?
\begin{definition}
  $\mathrm{C N L }_{\mathcal{O}}$ is the category of complete noetherian $\mathcal{O}$-algebras $(A, \mathfrak{m}_{A})$ with residue field $\mathbb{F}$ and with local homomorphisms.
\end{definition}
Typical rings: $\mathcal{O} [[ X_1, \dotsc, X_r\rrbracket / I$.  Some structure theorem tells you that this is all you can get.  There is a finite subcategory
\begin{equation*}
  \mathrm{Ar}_{\mathcal{O}} \subseteq \mathrm{C N L}_{\mathcal{O}}
\end{equation*}
consisting of Artin objects.

\begin{question}
  For $\bar{\rho} : G \rightarrow \mathrm{GL}_n(\mathbb{F})$, when is the functor
  \begin{equation*}
    D_{\bar{\rho}} : \mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set}
  \end{equation*}
  \begin{equation*}
    (A, \mathfrak{m}_A) \mapsto \left\{ \rho_A : G \rightarrow \mathrm{GL}_n(A) \mid \rho \mod{ \mathfrak{m}_A } \equiv \bar{\rho}\right\} / \sim
  \end{equation*}
  representable by $R_{\bar{\rho}} \in \mathrm{C N L}_{\mathcal{O}}$?
\end{question}
To fill in some terminology:
\begin{definition}
  \begin{enumerate}[(a)]
  \item For $A \in \mathrm{C N L}_{\mathcal{O}}$, set
    \begin{equation*}
      F_A := \Hom_{\mathrm{C N L}_{\mathcal{O}}}(A, \bullet) : \mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set}.
    \end{equation*}
  \item Say that a functor $F : \mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set}$ is
    \begin{enumerate}[(i)]
    \item \emph{representable} if there exists $A \in \mathrm{C N L }_{\mathcal{O}}$ such that $F \cong F_A$, and
    \item \emph{continuous} if for all $(A, \mathfrak{m}_A) \in \mathrm{C N L}_{\mathcal{O}}$, the map $F(A) \rightarrow \lim_{n} F(A / \mathfrak{m}_A^n)$ is an isomorphism.
    \end{enumerate}
  \end{enumerate}
\end{definition}
\begin{exercise}
  \begin{enumerate}[(a)]
  \item The fiber product of the diagram $\Delta$ given by
    \begin{equation*}
      \begin{CD}
        @. B \\
        @. @V{\psi}VV \\
        A @>{\varphi}>> C
      \end{CD}
    \end{equation*}
    inside $\mathrm{A r}_{\mathcal{O}}$ is
    \begin{equation*}
      \left\{(a, b) \in A \times B \mid \varphi(a) \equiv \psi(b) \right\}.
    \end{equation*}
  \item $\mathrm{C N L}_{\mathcal{O}}$ "has no fiber products".
  \end{enumerate}
\end{exercise}
\begin{exercise}
  Suppose $F = F_A$ for $A \in \mathrm{C N L}_{\mathcal{O}}$.  Then
  \begin{enumerate}[(a)]
  \item $F(\mathbb{F}) = \{\ast\}$, and $F$ is continuous.
  \item The Mayer--Vietoris property (MV) holds for $F$, i.e., for all diagrams $\Delta$, the induced map $(\ast)_\Delta$ is bijective, where
    \begin{equation*}
      (\ast)_\Delta : F(A \times_{C} B) \rightarrow F(A) \times_{F(C)} F(B),
    \end{equation*}
    where on the right hand side, we take the fiber product in $\mathrm{Set}$.
  \end{enumerate}
\end{exercise}
\begin{notation}
  \begin{itemize}
  \item $\mathbb{F}[\eps] := \mathbb{F}[X] /(X^2)$.
  \item Call $\varphi : A \twoheadrightarrow A '$ in $\mathrm{CNL}_{\mathcal{O}}$ \emph{small} if $\mathfrak{m}_{A'} \cdot(\ker(\varphi)) = 0$.  (e.g., $\mathbb{F}[\eps] \rightarrow \mathbb{F}$)
  \item For $F : \mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set}$, define the $T_F := F(\mathbb{F}[\eps])$, the \emph{tangent space} of $F$.
  \end{itemize}
\end{notation}
You can translate this back into rings.  Here are some more exercises:
\begin{exercise}
  If the functor $F$ satisfies
  \begin{itemize}
  \item $F(\mathbb{F}) = \{\ast\}$, and
  \item $(\ast)_{T_F} : F(\mathbb{F}[\eps] \times_{\mathbb{F}} \mathbb{F}[\eps]) \rightarrow T_F \times T_F$ is bijective,
  \end{itemize}
  then $T_F$ is an $\mathbb{F}$-vector space.
\end{exercise}
\begin{example}
  For $F = F_A$, we have
  \begin{equation*}
    T_F = \Hom_{\mathrm{C N L}_{\mathcal{O}}}(A, \mathbb{F}[\eps]) = \Hom_{\mathbb{F} } \left( \mathfrak{m}_A /(\mathfrak{m}_{A}^2 , \pi), \mathbb{F} \right) =: T_A.
  \end{equation*}
\end{example}
\begin{exercise}
  For $\varphi : A \rightarrow B$ in $\mathrm{C N L}_{\mathcal{O}}$, the map $\varphi$ is surjective if and only if $T_\varphi : T_B \rightarrow T_A$ is injective.
\end{exercise}
\begin{theorem}[Grothendieck]
  Suppose $F : \mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set}$ is continuous, satisfies $F(\mathbb{F}) = \{\ast\}$, the MV-property holds, and $\dim_{\mathbb{F}} T_F < \infty$.  Then $F$ is representable.
\end{theorem}
\begin{remark}
  For this last theorem, there are simplifications by Schlessinger, \emph{Functors of Artin rings}.  Schlessinger realized that these axioms of Grothendieck may be hard to verify in concrete situations, so he gave a simple (but somewhat long) list of axioms to verify.  See Mazur '87, and Gouvêa's survey.
\end{remark}
Let's now turn to \emph{Galois deformations functors}.  We have our usual
\begin{equation*}
  \bar{\rho} : G \rightarrow \mathrm{GL}_n(\mathbb{F}).
\end{equation*}
We can do something about the conjugation.

\begin{equation*}
  \Gamma_n(A) := \ker \left( \mathrm{GL}_n(A) \rightarrow \mathrm{GL}_n(\mathbb{F}) \right).
\end{equation*}
We define the \emph{lifting} and \emph{deformation} functors
\begin{equation*}
  D_{\bar{\rho}}^{\square}, \, D_{\bar{\rho}} : \mathrm{C N L}_{\mathcal{O}} \rightarrow \mathrm{Set},
\end{equation*}
\begin{equation*}
  (A, \mathfrak{m}_A) \mapsto \left\{ \rho_A : G \rightarrow \mathrm{GL}_n(A) \mid \rho_A \equiv \bar{\rho} \mod{\mathfrak{m}_A} \right\}
\end{equation*}
(``lifting functor'' or ``framed deformation functor''), and where for $D_{\bar{\rho}}$, we take things modulo $\Gamma_n(A)$-conjugacy (i.e., ``deformations are lifts modulo conjugacy'').

\begin{theorem}
  Suppose $\Phi_\rho$ holds, i.e., $\# \Hom(G, \mathbb{F}_p) < \infty$.  Then:
  \begin{enumerate}[(a)]
  \item $D_{\bar{\rho}}$ always has a ``hull''.
  \item If $\End_G(\bar{\rho}) = \mathbb{F}$, then $D_{\bar{\rho}}$ is representable (uses Schlessinger).  This gives rise to $R_{\bar{\rho}}$.
  \item\label{enumerate:cq6skams6j} (Always) $D_{\bar{\rho}}^{\square}$ is representable (Kisin, Magid--Lubotzki).  Gives rise to $R_{\bar{\rho}}^{\square}$.
  \end{enumerate}
\end{theorem}

Here \eqref{enumerate:cq6skams6j} is an exercise you can do.

\begin{example}
  Take $n = 1$.  Le $\bar{\rho} : G \rightarrow \mathrm{GL}_1(\mathbb{F}) = \mathbb{F}^\times$.  \textbf{Fact} (Teichmüller lift): there exists $\hat{\rho} : G \rightarrow \mathrm{GL}_1(W(\mathbb{F}))$, a lift of $\bar{\rho}$ such that $\hat{\rho}(G) \xrightarrow{\mathrm{red}} \bar{\rho}(G)$.
\end{example}
\begin{exercise}
  Suppose that $\Hom_{\mathrm{cts}}(G^{\mathrm{ab}}, \mathbb{F})$ is finite.  Then the universal deformation ring $R_{\bar{\rho}}$ (which for $n = 1$ is the same as the universal lifting ring $R_{\bar{\rho}}^{\square}$)  is isomorphic to
  \begin{equation*}
    \mathcal{O} [[(G^{\mathrm{ab}})_p \rrbracket = \varprojlim
    \mathcal{O} \left[(G^{\mathrm{a b}})_p \right].    
  \end{equation*}
  The universal lifting is
  \begin{equation*}
    \hat{\rho} \otimes \left( G \rightarrow(G^{\mathrm{a b}})_p
      \hookrightarrow
      \mathcal{O} [[(G^{\mathrm{a b}})_p \rrbracket^\times.
    \right)
  \end{equation*}
\end{exercise}
Special cases:
\begin{enumerate}[(i)]
\item\label{enumerate:cq6skmixcf} $G = G_F$, $F \supseteq \mathbb{Q}_p$ finite extension, then by local class field theory,
  \begin{equation*}
    (G^{\mathrm{a b}})_p \cong \mu_{p^\infty}(F) \times \mathbb{Z}^{1 +[F : \mathbb{Q}_p]}.
  \end{equation*}
\item\label{enumerate:cq6skmix6w} $G = G_{K, S}$, $S \supseteq S_{\mathfrak{p}}$ finite, then global class field theory gives
  \begin{equation*}
    (G^{\mathrm{a b}})_p \cong \frac{A_{K, S}}{\text{finite $p$-group}}
    \times \mathbb{Z}_p^{r_2 + \delta},
  \end{equation*}
  where $r_2$ denotes the number of complex places and $\delta = \delta_{K, p}$ is the \emph{Leopoldt defect}, which the Leopoldt conjecture says is zero.
\end{enumerate}

We turn to cohomology.  For $\bar{\rho} : G \rightarrow \mathrm{GL}_n(\mathbb{F})$, define
\begin{equation*}
  \ad_{\bar{\rho}} = M_{n \times n}(\mathbb{F})
\end{equation*}
with the ``adjoint action'': for $g \in A$ and $\alpha \in M_{n \times n}$, we take
\begin{equation*}
  g \cdot \alpha := \bar{\rho}(g) \cdot \alpha \cdot \bar{\rho}(g)^{-1}.
\end{equation*}
(We remark that $\ad_{\bar{\rho}} \cong \bar{\rho} \otimes \bar{\rho}^\vee$.)
\begin{proposition}
  \begin{enumerate}[(a)]
  \item We have $T_{D_\rho^{\square}} = D_{\bar{\rho}}^{\square}(\mathbb{F}[\eps]) \xleftarrow{\cong} Z^1(G, \ad_{\bar{\rho}})$, where the map sends a cocycle $c : G \rightarrow \ad_{\bar{\rho}}$ to
    \begin{equation*}
      \rho_c : g \mapsto(1 + \eps c(g)) \bar{\rho}(g).
    \end{equation*}
  \item The above map induces an isomorphism $H^1(G, \ad \bar{\rho}) \xrightarrow{\cong} T_{D_{\bar{\rho}}}$.
  \item We have $\dim B^1(G, \ad_{\bar{\rho}}) = h^2 - h^0(G, \ad_{\bar{\rho}})$.  (We use the notation $h^i := \dim H^i$ and $z^i = \dim Z^i$.)
  \end{enumerate}
\end{proposition}
\begin{corollary}
  For $r = h^1(G, \ad_{\bar{\rho}})$, $r^{\square} = z^1(G, \ad_{\bar{\rho}})$, we have surjections
  \begin{equation*}
    \mathcal{O} [[ X_1, \dotsc, X_r \rrbracket \rightarrow R_{\bar{\rho}}
  \end{equation*}
  and
  \begin{equation*}
    \mathcal{O} [[ X_1, \dotsc, X_{r^{\square}} \rrbracket \rightarrow R_{\bar{\rho}}^{\square},
  \end{equation*}
  and $r$, $r^{\square}$ are optimal.
\end{corollary}
What's the relevance of $H^2$?  Let $\varphi : A^1 \rightarrow A$ be a small extension, and let $I := \ker(\varphi)$.
\begin{question}
  Is the map $D_{\bar{\rho}}(A') \rightarrow D_{\bar{\rho}}(A)$ surjective?
\end{question}
Let $\rho_A : G \rightarrow \mathrm{GL}_n(A)$ be as in the right hand side.
\begin{fact}
  There exists a set-theoretic lift $\rho ' : G \rightarrow \mathrm{GL}_n(A')$ of $\rho_A$ (i.e., $\varphi \circ \rho ' = \rho_A$).
\end{fact}
\begin{definition}
  Set
  \begin{equation*}
    c_{\rho '} : G \times G \rightarrow \ad_{\bar{\rho}} \otimes_{\mathbb{F}} I,
  \end{equation*}
  \begin{equation*}
    (g, h) \mapsto(\rho '(g, h) \cdot \rho '(h)^{-1} \cdot \rho '(g)^{-1}),
  \end{equation*}
  where this last quantity lies in $1 + M_{n \times n}(I)$.  We note that $(\ad_{\bar{\rho}} \otimes_{\mathbb{F}} I) \cong M_{n \times n}(I)$.  To get back, subtract $1$.
\end{definition}
\begin{proposition}
  \begin{enumerate}[(a)]
  \item\label{enumerate:cq6sknji3b} $c_{\rho '} \in Z^2(G, \ad_{\bar{\rho}} \otimes I)$, $\mathrm{Obs}(\rho_A, \varphi) =[ c_{\rho '} ] \in H^2(G, \ad_{\bar{\rho}} \otimes I)$ is independent of $\rho '$!
  \item\label{enumerate:cq6sknjiey} We have $\mathrm{Obs}(\rho_A, \varphi) = 0$ if and only if there exists $\rho_{A'} \in D_{\bar{\rho}}(A')$ lifting $\rho$.
  \end{enumerate}
\end{proposition}
We give a proof of \eqref{enumerate:cq6sknjiey}.  If $c_{\rho '} = \partial^2 f$ for some $f : G \rightarrow \ad_{\bar{\rho}} \otimes I$, then you can check that if you take your $\rho '$ and multiply it on the left with $1 + f$, we get an element $(1 + f) \rho ' : G \rightarrow \mathrm{GL}_n(A')$ that is a lift of $\rho_A$ (to $D_{\bar{\rho}}^{\square}(A')$).

Mazur observed that you can do something with this obstruction theory: you can prove something more about these projections on the top line here.  But you have a very coarse control over the kernel ideal $I$ of the surjection.
\begin{theorem}
  Consider $\mathcal{R}  = \mathcal{O} [[  X_1, \dotsc, X_r \rrbracket$ projecting via something called $\pi$ to $R_{\bar{\rho}}$ ($r = h'(G, \ad_{\bar{\rho}} 1)$), with kernel $J$.  Then
  \begin{equation*}
    \mathcal{R} / \mathfrak{m}_{\mathcal{R}} J \rightarrow R_{\bar{\rho}}
  \end{equation*}
  is small with kernel $J / \mathfrak{m}_{\mathcal{R}} J$, and
  \begin{equation*}
    \mathrm{o b} : \Hom(J / \mathfrak{m}_R J, \mathbb{F}) \cong H^2(G, \ad_{\bar{\rho}}),
  \end{equation*}
  \begin{equation*}
    \psi \mapsto(1 \otimes \psi) \operatorname{o b s} \left( \rho_{\bar{\rho}}^{\mathrm{univ}}, \pi \right)
  \end{equation*}
  is injective!
\end{theorem}

\begin{corollary}
  With $r, r^{\square}$ from above and $s = h^2(G, \ad_{\bar{\rho}})$ have presentations $R_{\bar{\rho}} := \mathcal{O} [[ x_1, \dotsc, x_{r^{\square}} ]] /(f_1, \dotsc, f_s)$.
\end{corollary}
\begin{definition}[ad hoc]
  The \emph{expected cohomological dimension} is
  \begin{equation*}
    \operatorname{e c d} \operatorname{i m}(\bar{\rho}) = z^1(G, \ad_{\bar{\rho}}) - h^2(G, \ad_{\bar{\rho}}) = h^2 - \sum_{i = 0}^2(-1)^{i} h^i(G, \ad \bar{\rho}). 
  \end{equation*}
\end{definition}
\begin{proposition}
  If
  \begin{equation}\label{eq:cq6skreori}
    \dim_{\mathrm{\operatorname{s}}} R \frac{\square}{\rho} / \pi \leq \mathrm{ec dim(\bar{\rho})},
  \end{equation}
  then $R_{\bar{\rho}}^{\square}$ is $0$-flat, of relative dimension $\operatorname{e c dim}(\bar{\rho})$ over $\mathcal{O}$, and a complete intersection.
\end{proposition}
\begin{example}
  \begin{enumerate}[(a)]
  \item $G = G_F$, where $F \supseteq \mathbb{Q}_{\ell}$ is finite and $\ell \neq p$.  Then \eqref{eq:cq6skreori} holds.  $\mathrm{e c dim} = 4^2$.
  \item $G = G_F$, $F \supseteq \mathbb{Q}_p$.  Then \eqref{eq:cq6skreori} holds and each $\operatorname{ec dim} = n^2(1 +[F : \mathbb{Q}_p])$.
  \item If $G = G_{K, S}$, then we have many examples for \eqref{eq:cq6skreori} if $k$ is not totally real, $k$ is totaly odd, and $\bar{\rho}$ is totally odd, and $n \geq 2$.  (Have to be careful.  Use that $S \supseteq S_\infty \cup S_p sup \dotsb$)
  \item We have
    \begin{equation*}
      \dim_{\mathrm{Krull}} R_{\bar{\rho}}^n / \pi \leq \operatorname{ecdim}(\bar{\rho})
    \end{equation*}
    for $G = G_{K, S}$, with $G$ and $G_{K, S}$, if and only if $\delta = 0$.
  \end{enumerate}
\end{example}
\begin{remark}
  To avoid the reliance on $\delta = 0$ (often) by fixing a lift $\mu : G \rightarrow \mathcal{O}^\times$.
\end{remark}

\emph{Mazur's vision}: for $v \in S$, define ``geometric'' subfunctors $D_v^{\square} \subseteq D_{\bar{\rho} / G_{K, v}}^{\square}$ and the pullback in $(\underline{S} =(\bar{\rho}, S,(D_v^0)_{v \in S}))$ to get a diagram involving, for $G = G_{k , S}$,
\begin{equation*}
  D_{\bar{\rho}}^{\square} \rightarrow \sqcup_{v \in S} D_{\bar{\rho} \mid G_v}^{\square}
\end{equation*}
and
\begin{equation*}
  D_{\underline{S}}^{\square} \rightarrow \sqcup_{v \in S} D_v^{\square}.
\end{equation*}

Removing frames at right point, we get a
\begin{equation*}
  R_{\mathcal{I}} \twoheadleftarrow R_{\bar{\rho}}.
\end{equation*}

\begin{question}
  Can we choose $\mathcal{I}$ in such a way that some natural map
  \begin{equation*}
    R_{\rho} \rightarrow \mathbb{T}_k(N, \eps, \mathcal{O})_{\mathfrak{m}_{\bar{\rho}}}
  \end{equation*}
  is an isomorphism?
\end{question}
\part{Chris Skinner's lectures}
\textbf{Integral representations, Euler systems, and multiplicity one}.

My choice of these topics is motivated by my interest in special values of $L$-functions, and in particular problems like the BSD conjecture.  We'll focus on some representation theory, that plays a role in both the analytic and the algebraic sides of these problems.  You can possibly view this as a bridge between the talks at the start and at the end of the week.

Let's start by talking about \emph{integral representations}.  It's helpful to think
\begin{equation*}
  \text{$L$-function} =
  \int_{\text{symmetric space } X}
  (\text{automorphic form}),
\end{equation*}
where perhaps the automorphic form starts on some larger symmetric space $Y \supseteq X$.  This is useful because it's our main tool for studying $L$-functions.

The next part of my title is \emph{Euler systems}.  This is going to seem like something different.  What are Euler systems?  One starts off with a continuous action
\begin{equation*}
  G_k = \Gal(\bar{k} / k) \circlearrowright V,
\end{equation*}
where $V$ is a $\mathbb{Q}_p$-space of finite dimension (with $\mathbb{Q}_p$ acting linearly and continuously).  At least conjecturally, there's a fairly general framework for producing such $V$ from automorphic forms or representations.  This Galois representation captures something about the automorphic form that can be expressed in terms of the $L$-function.  All of these things are thus related to one another, even if they are frequently encountered separately.  Here $V$ often stabilizes in a $\mathbb{Z}_p$-submodule (lattice), which might yield a good exercise for later.  An Euler system is a collection of classes in Galois cohomology $c_F \in H^1(F, T)$, where $F / k$ are certain abelian extensions of $k$ satisfying certain compatibilities: for $F' \supseteq F$,
\begin{equation*}
  \operatorname{cores}_{F' / F}(c_{F '}) = ? c_F,
\end{equation*}
where $?$ often seems the local Euler factors of $V$ (or some $L$-function attached to $V$, depending upon the setting).

Both of these settings have been useful for exploring special values of $L$-functions (Kolyvagin, Gross--Zagier, ...).  What we'll focus on in these lectures is the role that multiplicity one plays in seeing these $L$-functions and in producing these Euler systems.  We'll see that they essentially play the same role, which is further evidence for what people say, to the effect that Euler systems are some sort of algebraic incarnation of $L$-functions.

What do we mean by ``multiplicity one''?  One frequently encounters this term in the theory of automorphic forms, in various guises:
\begin{enumerate}
\item\label{enumerate:cq6r3ndbhy} Uniqueness of a representation in some space of functions, e.g.:
  \begin{enumerate}[(a)]
  \item\label{enumerate:cq6r3m96yd} A cuspidal automorphic representation of $\mathrm{GL}_2$ shows up with multiplicity one $L^2(\mathrm{GL}_2(k) \backslash \mathrm{GL}_2(\mathbb{A}_k))$.
  \item\label{enumerate:cq6r3m98gf} Uniqueness of (local) Whittaker models for $\mathrm{GL}_2$.
  \end{enumerate}
\item\label{enumerate:cq6r3ndama} Uniqueness of some (invariant) linear functional: for $H \leq G$ and $\pi$ a representation of $G$,
  \begin{equation*}
    \dim \Hom_H(\pi, \mathbb{C}) \leq 1.
  \end{equation*}
  Or, for $\sigma$ a representation of $H$, as the assertion that $\dim \Hom_H(\pi, \sigma) \leq 1$.
\end{enumerate}
The first examples can be understood in terms of the latter.  The latter will be a useful framework for us.

Let's now turn to integral representations and give some examples.  The first integral representation we see is that of the Riemann zeta function.  Let
\begin{equation}\label{eq:cq6r3qe33m}
  \psi(t) = \sum_{n = 1}^\infty e^{- \pi n^2 t}.
\end{equation}
Then for $\Re s$ sufficiently large,
\begin{equation}\label{eq:cq6r3p0tmc}
  \int_0^\infty \psi(t) t^{\frac{1}{2} s - 1} \, d t
  = \pi^{- s/2} \Gamma(\tfrac{s}{2}) \zeta(s).
\end{equation}
We see this by bringing the summation outside the integral.  This gives a Mellin transform.

What's the automorphic side of this?  If we look at, for $\tau = x + i y$,
\begin{equation*}
  \theta(\tau) = \sum_{n \in \mathbb{Z}} e^{- 2 \pi i n^2 \tau}.
\end{equation*}
This is an automorphic form, and we have
\begin{equation*}
  (\tfrac{1}{2}(\theta(i y) - 1)) = \psi(2 y),
\end{equation*}
so \eqref{eq:cq6r3p0tmc} is an integral representation for the Riemann zeta function coming from the symmetric space for a torus embedded inside $\mathrm{GL}_2$.  One has similar integral representations for the Dirichlet $L$-functions.  (No multiplicity one that we can see thus far.)

This gets souped up in the work of Hecke and Iwasawa--Tate, which inspired how automorphic $L$-functions have been studied subsequently.  Let's recall how that goes.  Let $k$ be a number field.  We have the adeles $\mathbb{A}_k$ and the ideles $\mathbb{A}_k^\times$.  We have a Hecke character
\begin{equation*}
  \chi : k^\times \backslash \mathbb{A}_k^\times \rightarrow \mathbb{C}^\times,
\end{equation*}
which factors as a product $\chi = \prod \chi_v$ of characters $\chi_v : k_v^\times \rightarrow \mathbb{C}^\times$ indexed by the places $v$ of $k$.  (This is of course very useful, but is specific for $\mathrm{GL}_1$, and so obscures some of the more general features.)  Let $\phi \in \mathcal{S}(\mathbb{A})$ be a Schwartz function, which could also be a product $\phi = \prod \phi_v$ of local Schwartz functions $\phi_v \in \mathcal{S}(k_v)$.  We recall that this means that
\begin{itemize}
\item when $v$ is finite, $\phi_v$ is smooth and compactly-supported, and
\item when $v$ is archimedean, all derivatives decay faster than any polynomial, e.g., $e^{- \pi t^2}$.
\end{itemize}
Furthermore, $\phi_v = 1_{\mathcal{O}_{k_v}}$ for almost all finite $v$.  We then form
\begin{equation*}
  \theta(x) = \sum_{\alpha \in k} \phi(\alpha x).
\end{equation*}
(It's a good exercise to see how to specialize this to obtain something like \eqref{eq:cq6r3qe33m}.)  We then form the integral
\begin{equation*}
  \int_{k^\times \backslash \mathbb{A}_k^\times} \chi(x) \lvert x \rvert^s \theta(x) \,d^\times x.
\end{equation*}
These integrals converge absolutely for $\Re s$ sufficiently large and unfold in the usual way, giving
(at least for $\chi$ not a power of the absolute value, so that we don't need to worry about the contribution of $\alpha = 0$)
\begin{equation*}
  \int_{\mathbb{A}_k^\times} \chi(x) \lvert x \rvert^s \phi(x) \, d x.
\end{equation*}
If $\phi = \prod \phi_v$, then these factor further as
\begin{equation}\label{eq:cq6r32qpe5}
  \prod \int_{k_v^\times} \chi_v(x) \lvert x \rvert_v^s \phi_v(x) \, d x.
\end{equation}
One can show that the local integrals at non-archimedean places are rational functions, form the greatest common divisor of their denominators, and this turns out to be the way you can define the local $L$-function.  This is Tate's thesis.  We haven't yet really made any reference to multiplicity one.  This shows up when you try to generalize to other settings.

We may think of $\mathbb{A}_k^\times$ as $\mathrm{GL}_1(\mathbb{A}_k)$.  Let's now consider $\mathrm{GL}_n(\mathbb{A}_k)$.  We discuss Godement--Jacquet theory, which is a generalization of what Tate did to $\mathrm{GL}_n$.  Let $\pi$ be a cuspidal automorphic representation (by convention, irreducible).  Abstractly, this is isomorphic to a restricted tensor product $\otimes \pi_v$ of irreducible local representations $\pi_v$ of $\mathrm{GL}_n(k_v)$.  We can thus identify an element $\varphi \in \pi$ with a sum of tensor products of vectors (although, unlike in the case of characters, it will not pointwise be a product of local functions).  Now, mimicking what was done before, we take a Schwartz function $\phi \in \mathcal{S}(M_n(\mathbb{A}_k))$, and form a theta function
\begin{equation*}
  \theta(x)
  =
  \sum_{\alpha \in M_n(k)}
  \phi(\alpha x).
\end{equation*}
We then form
\begin{equation*}
  \int_{\mathrm{GL}_n(k) \backslash \mathrm{GL}_n(\mathbb{A}_k)}
  \varphi(x) \lvert \det(x) \rvert^s \theta(x) \,d^\times x.
\end{equation*}
This unfolds to
\begin{equation*}
  \int_{\mathrm{GL}_n(\mathbb{A})} \varphi(x) \lvert \det x \rvert^s \phi(x) \, d^\times x.
\end{equation*}
But does it factor?  Not obviously.

Let's now form
\begin{equation*}
  \theta(h, g) = \sum_{\alpha \in M_n(k)} \phi(h^{-1} \alpha g)
\end{equation*}
and consider
\begin{equation*}
  \int_{[\mathrm{GL}_n]} \varphi(g) \lvert \det g \rvert^s \theta(h, g) \, d g.
\end{equation*}
This is now automorphic as a function of $h$, so we can decompose it with respect to the automorphic spectrum.  To compute the coefficients in that decomposition, we consider, for $\tilde{\varphi}$ in the contragredient (or dual) $\tilde{\pi}$ of $\pi$, the iterated integral
\begin{equation*}
  \int_{[\mathrm{GL}_n^1]}
  \left(  \int_{[\mathrm{GL}_n]} \varphi(g) \lvert \det g \rvert^s \theta(h, g) \, d g \right)
  \tilde{\varphi}(h) \, d h,
\end{equation*}
where $\mathrm{GL}_n^1$ means either that we mod out by the center or that we restrict to $\lvert \det \rvert = 1$.  Then, reordering terms and unfolding, we obtain
\begin{equation*}
  \int_{\mathrm{GL}_n(\mathbb{A})} \phi(g) \lvert \det g \rvert^s
  \left( \int_{[\mathrm{GL}_n^1]} \tilde{\varphi}(h)
    \varphi(h g) \,d h
  \right) \, d g.
\end{equation*}
We can understand the parenthetical inner integral as
\begin{equation*}
  \langle \tilde{\varphi}, \pi(g) \varphi \rangle,
\end{equation*}
where
\begin{equation*}
  \langle \varphi_1, \varphi_2 \rangle = \int_{[\mathrm{GL}_n^1]} \varphi_1(h) \varphi_2(h) \, d h.
\end{equation*}
This pairing defines a $G$-invariant functional $\langle , \rangle :  \tilde{\pi} \times \pi \rightarrow \mathbb{C}$, which is locally unique, hence factors as a product of local invariant functionals $\langle , \rangle_v : \tilde{\pi}_v \times \pi_v \rightarrow \mathbb{C}$, thus
\begin{equation*}
  \langle , \rangle =(\ast) \prod_v \langle , \rangle_v.
\end{equation*}
The leading constant $(\ast)$ will depend upon our normalizations of the local and global integrals, and our normalization of the comparison between $\pi$ and $\otimes \pi_v$.

This is the first example where multiplicity one shows up in what we've discussed.  In the afternoon talk, we'll very quickly describe a few other automorphic $L$-function settings where we see multiplicity one, and then start to move to the Euler system side of things.

\textbf{Afternoon talk}.

Factoring the integral is only one step towards understanding the $L$-functions.  The next thing one needs to do is to compute these local integrals.  This of course seems more tractable than working globally, which is the point.  For instance, in the Iwasawa--Tate setting, when all of the data is unramified (meaning $\chi_v$ is an unramified character and $\phi_v$ is the characteristic function of the ring of integers), then the local factor in \eqref{eq:cq6r32qpe5} is easy to compute, and gives a local zeta function.  This is more complicated in the Godement--Jacquet setting, but still doable.  Then in the ramified situations, there is the question of how to choose good vectors so that one gets the $L$-function on the nose.  This is useful for many of the applications that the speaker makes of these kinds of functions.  In some settings it's still much of an art and there are lots of interesting questions.

Let's turn to Rankin--Selberg convolutions.  We'll begin classically, say with holomorphic modular eigenforms $f$ and $g$ of weights $k_f \geq k_g$, say of level $1$, i.e., on $\mathrm{SL}_2(\mathbb{Z})$.  Write
\begin{equation*}
  f = \sum a_n q^n, \qquad g = \sum b_n q^n.
\end{equation*}
We'll consider the Dirichlet series
\begin{equation}\label{eq:cq6r32z05j}
  \sum_n \overline{a_n} b_n n^{- s}.
\end{equation}
The integral representation is
\begin{equation}\label{eq:cq6r32zyac}
  \int_{\mathrm{SL}_2(\mathbb{Z}) \backslash \mathbb{H}} \overline{f(\tau)} g(\tau)
  E_k(\tau, s)
  y^{k_f}
  \, d \vol(\tau),
\end{equation}
where $k := k_f - k_g$ and
\begin{equation}\label{eq:cq6r320zyb}
  E_k(\tau, s)
  := \sum_{\gamma \in
    \begin{pmatrix}
      \ast      & \ast \\
      0             & \ast \\
    \end{pmatrix} \backslash \mathrm{SL}_2(\mathbb{Z})}
  j(\gamma, \tau)^{- k} \lvert y(\gamma(\tau)) \rvert^k.
\end{equation}
The way you get from \eqref{eq:cq6r32zyac} to \eqref{eq:cq6r32z05j} is to unfold the sum in \eqref{eq:cq6r320zyb} with the integral in \eqref{eq:cq6r32zyac}, which yields an integral over $
\begin{pmatrix}
  \ast  & \ast \\
  0     & \ast \\
\end{pmatrix} \backslash \mathbb{H}$.  This is a nice exercise if you haven't done it.

What does this have to do with multiplicity one?  Maybe we try to set this up a bit more automorphically.  Let $\pi_1$ and $\pi_2$ be cuspidal automorphic representations of $\mathrm{GL}_2(\mathbb{A}_k)$.  Let $\chi_1, \chi_2$ be Hecke characters $\chi_i : k^\times \backslash \mathbb{A}_k^\times \rightarrow \mathbb{C}$ such that $\chi_1 \chi_2 =(\chi_{\pi_1} \chi_{\pi_2})^{-1}$.  Let $I_s(\chi_1, \chi_2)$ denote the space of functions $f : \mathrm{GL}_2(\mathbb{A}) \rightarrow \mathbb{C}$ that are smooth (meaning the usual thing at archimedean places and ``fixed by an open subgroup'' at finite places) and ``$K$-finite'' and satisfying
\begin{equation*}
  f_s \left(
    \begin{pmatrix}
      a & b \\
      0 & d \\
    \end{pmatrix} g \right) =
  \chi_1(a) \chi_2(d)
  \left\lvert \frac{a}{d} \right\rvert^{s + \frac{1}{2}}
  f_s(g).
\end{equation*}
We then define an Eisenstein series by averaging:
\begin{equation*}
  E(f_s, g) := \sum_{\gamma \in B(\mathbb{Q}) \backslash \mathrm{GL}_2(\mathbb{Q})} f_s(\gamma g).
\end{equation*}
The Rankin--Selberg integral is now just the integral
\begin{equation*}
  \int_{[\mathrm{GL}_2]} \varphi_1(g) \varphi_2(g) E(f_s, g) \, d g.
\end{equation*}
We can unfold this to obtain
\begin{equation*}
  \int_{Z(\mathbb{A})B(\mathbb{Q}) \backslash \mathrm{GL}_2(\mathbb{A})} \varphi_1(g) \varphi_2(g) f_s(g) \, d g.
\end{equation*}
Let's replace $\varphi_i$ by its Whittaker expansion
\begin{equation*}
  \varphi_1(g) = \sum_{a \in k^\times} W_{\psi} \left(
    \begin{pmatrix}
      a      &  \\
             & 1 \\
    \end{pmatrix} g \right).
\end{equation*}
Then, unfolding a bit further, we arrive at
\begin{equation*}
  \int_{Z(\mathbb{A}) N(\mathbb{A}) \backslash \mathrm{GL}_2(\mathbb{A})} W_{\psi}(g) \varphi_2(g) f_s(g) \, d g
  =
  \int_{Z(\mathbb{A}) N(\mathbb{A}) \backslash \mathrm{GL}_2(\mathbb{A})}
  W_\psi(g) W_{\bar{\psi}} '(g) f_s(g) \, d g,
\end{equation*}
where $W_{\psi}'$ is the Whittaker function for $\varphi_2$ with respect to the conjugate character.  This last integrand is a product of local functions, so the integral factors, assuming that all vectors in our representations are pure tensors.

Where's the multiplicity one?  It's hidden, because, just like in the case of $\mathrm{GL}_1$ characters, we have taken for one of our automorphic forms something particularly special, namely an Eisenstein series.  The picture that might be better is, to give something slightly more complicated, there's something called the \textbf{triple product integral}.  Now we'll take $\varphi_i \in \pi_i$ for $i = 1, 2, 3$, where it'll be slightly simpler to assume that at least one is cuspidal.  Look at the function
\begin{equation*}
  \int_{[Z \backslash \mathrm{GL}_2]}
  \varphi_1(g) \varphi_2(g) \varphi_3(g) \, d g.
\end{equation*}
This integral defines a trilinear form on the product of the three representations that is invariant by the diagonal action of $\mathrm{GL}_2(\mathbb{A})$, or equivalently, a $\mathrm{GL}_2(\mathbb{A})$-invariant functional $\Lambda$ on the tensor product $\pi_1 \otimes \pi_2 \otimes \pi_3$, i.e, an element
\begin{equation*}
  \Lambda \in \Hom_{\mathrm{GL}_2(\mathbb{A})}(\pi_1 \otimes \pi_2 \otimes \pi_3, \mathbb{C}).
\end{equation*}
This space is one-dimensional, as are its local avatars:
\begin{equation*}
  \dim \Hom_{\mathrm{GL}_2(k_v)}(\pi_{1, v} \otimes \pi_{2, v} \otimes \pi_{3, v}) \leq 1.
\end{equation*}
We can thus factor $\Lambda = \prod \Lambda_v$, where each $\Lambda_v \in \Hom_{\mathrm{GL}_2(k_v)}(\pi_{1, v} \otimes \pi_{2, v} \otimes \pi_{3, v})$.  Suppose $v$ is a place for which $\pi_{i, v}$ is unramified for each $i$.  Then we can take
\begin{equation*}
  \Lambda_v =
  \int_{Z N(k_v) \backslash \mathrm{GL}_2(k_v)}
  W_{\psi_v} W_{\overline{\psi_v}}(g) f_v(g) \, d g.
\end{equation*}
Here, locally, we're realizing the unramified representation $\pi_{3, v}$ as an induced representation $\pi_{3, v} = \pi_v(\chi_{1, v}, \chi_{2, v})$.  We didn't unfold to this computation; this was all local.

There's one more example we'd like to emphasize: \emph{toric integrals}.  Let $K /k$ be a quadratic extension.  We can then think of $K$ as a two-dimensional $k$-space, which gives a way to identify
\begin{equation*}
  {\mathrm{GL}_2}{/ k} \cong \Aut_k(K) \hookleftarrow K^\times.
\end{equation*}
We might for simplicity that $\pi$ is a cuspidal automorphic representation of $\mathrm{GL}_2(\mathbb{A}_k)$, and let $\varphi \in \pi$ be a cusp form.  Let $\chi : K^\times \backslash \mathbb{A}_{K}^\times \rightarrow \mathbb{C}^\times$ be a Hecke character for our extension.  Let's assume that $\chi \mid_{\mathbb{A}_k^\times} = \chi_\pi^{-1}$, i.e., the restriction is the inverse of the central character.  We are then going to think of the integral
\begin{equation*}
  \int_{\mathbb{A}_k^\times K^\times \backslash \mathbb{A}_K^\times} \varphi(t) \chi(t) \,d^\times t
\end{equation*}
as defining an element of the space $\Hom_{\mathbb{A}_k^\times}(\pi, \mathbb{C}(\chi^{-1}))$, which has dimensional $\leq 1$.  Such integrals will thus factor as prodcuts of local linear functionals.

Some of these can be computed quickly in terms of integrals we already know.  Suppose $\pi_v$ is unramified and $v$ splits in $K /k$.  Then
\begin{equation*}
  K_v^\times = k_v^\times \times k_v^\times \cong \left\{
    \begin{pmatrix}
      a      &  \\
                                                                              & b \\
    \end{pmatrix} \right\} \subseteq \mathrm{GL}_2(k).
\end{equation*}
We may thus identify $\chi_v$ with a pair of characters $(\chi_{1, v}, \chi_{2, v})$.  We can define the local functional
\begin{equation*}
  \int_{k_v^\times} W_\psi
  \begin{pmatrix}
    t    &  \\
                                                                      & 1 \\
  \end{pmatrix} \chi_{1, v}(t) \,d^\times t,
\end{equation*}
which defines an element of $\Hom_{K_v^\times}(\pi_v, \mathbb{C}(\chi_v^{-1}))$.  For unramified data, this evaluates to $L(\pi_v, \chi_{1, v})$.  It turns out that (Waldspurger's formula)
\begin{equation*}
  \left\lvert \int \varphi(t) \chi(t) \,d^\times y \right\rvert^2 \sim L(\mathrm{B C}_{K/k}(\pi) \otimes \chi, \tfrac{1}{2}).
\end{equation*}
There's a similar relation in the triple product case, which we can guess using the Rankin--Selberg unfolding that we saw earlier.

\begin{remark}
  This doesn't make sense for general arguments other than $s = \tfrac{1}{2}$, except in some form when $\varphi$ is an Eisenstein series (``formula of Damerell'').  One needs to be able to vary $\varphi$ (or $\chi$) in a family, preserving the central character compatibility condition.
\end{remark}

All of these examples are special cases of the Gan--Gross--Prasad conjectures, which we'll hear more about later in the week.

We'll now begin by giving one example of an Euler system.  Tomorrow, we'll explore this in greater generality and more detail.  The simplest case is that of cyclotomic units.  Let $F$ be a number field or a local field.  Kummer theory gives an isomorphism
\begin{equation*}
  F^\times / F^{\times N} \rightarrow H^1(F, \mu_N),
\end{equation*}
as follows.  Let $\alpha \in F^\times$.  Choose an $n$th root $\alpha^{1/N}$.  The ambiguity in this choice is an element of $\mu_N$, i.e., an $n$th root of unity.  For any $\sigma \in G_F$, we can look at $\sigma(\alpha^{1/N}) / \alpha^{1/N}$.  Since the numerator and denominator are both $N$th roots of $1$, the ratio must lie in $\mu_N$.  This gives us a way of constructing elements of $H^1$ very concretely.  The classes we obtain are unramified away from $N \alpha$.

Let's now restrict ourselves to the field $\mathbb{Q}[\mu_N]$.  Restrict the above map to the unit group of that field:
\begin{equation*}
  \mathcal{O}_{\mathbb{Q}[\mu_N]}^\times \rightarrow H^1(\mathbb{Q}(\mu_N), \mu_{p^n}).
\end{equation*}
Taking inverse limits, we obtain, with $\mathbb{Z}_p(1) = \varprojlim\mu_{p^n}$ (where the Galois group acts via the cyclotomic character), a map
\begin{equation*}
  \mathcal{O}_{\mathbb{Q}[\mu_N]}^\times \otimes \mathbb{Z}_p \rightarrow H^1(\mathbb{Q}(\mu_N), \mathbb{Z}_p(1)).
\end{equation*}
Thus, for any $(a, N) = 1$, we get , say with $\zeta_N = e^{2 \pi i / N}$,
\begin{equation*}
  \frac{\zeta_N^a - 1}{\zeta_N - 1} \mapsto z_N,
\end{equation*}
say.  If we look at the corestriction
\begin{equation*}
  \operatorname{cores}_{\mathbb{Q}[\mu_{N \ell}] / \mathbb{Q}[\mu_N]}(z_{N \ell}) =
  \begin{cases}
    z_N    
    & \text{ if } \ell \mid N \\
    (1 - \mathrm{Fr}_{\ell}^{-1}) z_N
                                                                                     & \text{ if } \ell \nmid N.
  \end{cases}
\end{equation*}
We look at
\begin{equation*}
  \det \left( 1 - \mathrm{Fr}_{\ell}^{-1} X \mid \mathbb{Z}_p(1)^\ast \right) \mid X = \mathrm{Fr}_{\ell}^{-1}.
\end{equation*}


Some idea for checking this: $(\mathbb{Z} / \ell \mathbb{Z})^\times \subset(\mathbb{Z} / \ell N \mathbb{Z})^\times \cong \Gal(\mathbb{Q}(\mu_{N \ell}) / \mathbb{Q} )$, where the last map sends $a \mapsto \sigma_\alpha(\zeta_{N \ell}) = \zeta_{N \ell}^a$.

\begin{remark}
  Given $f$ a holomorphic modular form, say of weight $2$, we have $\omega_f = f(\tau) \, d \tau \in H^0(X, \Omega_X^1) \subseteq H^1(X, \mathbb{C})$.  Then $\lVert f \rVert^2 = \int_X\omega_f \wedge \overline{\omega_f}$.

  Similarly, for $X \hookrightarrow X \times X \times X$, we get some particular values of the Rankin--Selberg convolution by looking at $\int_X \overline{\omega_f} \wedge \omega_g \wedge \omega_{E_k}$.  Then from the rational structure on cohomology, one can get something like rational structure on the $L$-values.
\end{remark}

\begin{remark}
  Let's talk about the corestriction map in this setting.  Abstractly, it's a map
  \begin{equation*}
    H^1(\mathbb{Q}[\mu_{N \ell}], \mathbb{Z}_p(1)) \rightarrow H^1(\mathbb{Q}[\mu_N], \mathbb{Z}_p(1)).
  \end{equation*}
  How are we going to understand this?  We could of course write it down at the level of cocycles, or something.  But what's it's really doing is that if we restrict back, i.e., compose with the restriction map
  \begin{equation}\label{eq:cq6r4knx6r}
    H^1(\mathbb{Q}[\mu_N], \mathbb{Z}_p(1)) \rightarrow H^1(\mathbb{Q}[\mu_{N \ell}], \mathbb{Z}_p(1)),
  \end{equation}
  then the composition is just the trace map, given by
  \begin{equation*}
    \sum_{\sigma \in \Gal(\mathbb{Q}[\mu_{N \ell}] / \mathbb{Q}[\mu_N])} \sigma.
  \end{equation*}
  The restriction map \eqref{eq:cq6r4knx6r} is actually an injection because there are no Galois invariants of $\mathbb{Z}_p(1)$.

  Also, we have the Kummer map
  \begin{equation*}
    \mathbb{Q}[\mu_{N \ell}]^\times \xrightarrow{\mathrm{Kummer}} H^1(\mathbb{Q}[\mu_{N \ell}], \mathbb{Z}_p(1)).
  \end{equation*}
  And this construction is Galois-invariant.  We have the trace map $\alpha \mapsto \prod_\sigma \sigma(\alpha)$ from $\mathbb{Q}[\mu_{N \ell}]^\times \rightarrow \mathbb{Q}[\mu_N]^\times$.  We claim that this induces the corestriction map via the Kummer map.  This remains the case when we tensor with $\mathbb{Z}_p$.

  So when we're dealing with corestriction, what we really want to understand is what is the norm of the particular $\alpha$ that we're working with.

  All of this is fairly formal applied to a specific setting.  The Kummer map is also a connecting map in a long exact sequence of Galois cohomology, associated to
  \begin{equation*}
    0 \rightarrow \mu_{p^n} \rightarrow \bar{F}^\times \xrightarrow{\alpha \mapsto \alpha^{p^n}} \bar{F}^\times \rightarrow 0.
  \end{equation*}
  From the formal stuff, we have an arithmetic question.  We take
  \begin{equation*}
    \alpha = \frac{\zeta_{N \ell}^a - 1}{\zeta_{N \ell} - 1},
  \end{equation*}
  and we want to know, what is the norm of this element?  Look at
  \begin{equation*}
    \operatorname{norm}_{\mathbb{Q}(\mu_{N \ell}) / \mathbb{Q}(\mu_N)}(\alpha).
  \end{equation*}
  We have
  \begin{equation*}
    \Gal(\mathbb{Q}(\mu_{N \ell}) / \mathbb{Q}(\mu_N))
    \subseteq \Gal(\mathbb{Q}(\mu_{N \ell}) / \mathbb{Q})
    \cong(\mathbb{Z} / N \ell)^\times,
  \end{equation*}
  The subgroup here will be identified with congruence classes $b$ satisfying $b \equiv 1 \pmod{N}$.  The last isomorphism is given by $\sigma_c \mapsto c$, where $\sigma_c(\zeta_{N \ell}) = \zeta_{N \ell}^c$.  Now, suppose for instance that $\ell \nmid N$.  Then $\zeta_{N \ell}^{b \ell} = \zeta_N^b = \zeta_N$.  As $b \in(\mathbb{Z} / N \ell )^\times$ runs over $\ell - 1$ residue classes modulo $\equiv 1 \pmod{N}$, then $\zeta_{N \ell}^b$ runs over $\ell$th roots of $\zeta_N$, but excluding $\zeta_N^{\ell^{-1}}$.  A short calculation then gives the claim corestriction formula.  In the other case where $\ell \mid N$, $b$ runs over $\ell$ classes, and we get the other answer.
\end{remark}

We're going to continue our discussion of Euler systems.  We turn to the example given by Heegner points.  Let $K / \mathbb{Q}$ be an imaginary quadratic field, with ring of integers $\mathcal{O}_K$.  Let $N$ be a positive integer such that all primes $\ell \mid N$ split in $K /\mathbb{Q}$.  We take
\begin{equation*}
  X_0(N) = \Gamma_0(N) \backslash[\mathfrak{h} \sqcup \mathbb{P}^1(\mathbb{Q})],
\end{equation*}
and write $\tau \in \mathfrak{h}$.  This classifies elliptic curves together with an isogeny of order $N$, e.g.,
\begin{equation*}
  E := \mathbb{C} / \mathbb{Z} \oplus \mathbb{Z} \tau \rightarrow E' :=  \mathbb{C} / \tfrac{1}{N}(\mathbb{Z} + N \tau \mathbb{Z}) \cong \mathbb{C} / \mathbb{Z} + N \tau \mathbb{Z},
\end{equation*}
whose kernel is $\tfrac{1}{N} \mathbb{Z} / \mathbb{Z}$.

We're going to produce some points on $X_0(N)$.  Let $c$ be positive integer.  We can have an order
\begin{equation*}
  \mathcal{O}_c := \mathbb{Z} + c \mathcal{O}_K \subseteq \mathcal{O}_K.
\end{equation*}
This gives us a lattice inside the complex numbers (having chosen a complex embedding of $K$).  We can then form the quotient $\mathbb{C} / \mathcal{O}_c$.  To produce a lattice that is slightly larger, we will use that each $\ell \mid N$ splits to \emph{choose} an ideal $\mathfrak{n} \subseteq \mathcal{O}_K$ such that $\mathcal{O}_K / \mathfrak{n} \cong \mathbb{Z} / N \mathbb{Z}$.  We then obtain an isogeny of elliptic curves
\begin{equation*}
  \left[ \mathbb{C} / \mathcal{O}_c \rightarrow \mathbb{C} / \mathfrak{n}^{-1} \mathcal{O}_c \right] \in X_0(N)(K[c]),
\end{equation*}
where $K[c]$ denotes the \emph{ring class field} of $K$ of conductor $c$.  To explain what this means, we introduce some notation.  For a module $M$, write $\hat{M} := M \otimes \hat{\mathbb{Z}}$, where $\hat{\mathbb{Z}} = \prod_{\ell} \mathbb{Z}_{\ell}$.  (For instance, if $M$ is a $\mathbb{Q}$-module, then we may also write $\hat{M}$ as $M \otimes_{\mathbb{Q}} \mathbb{A}_f$.)  Class field theory tells us that
\begin{equation*}
  \Pic(\mathcal{O}_c) = K^\times \backslash \hat{K}^\times / \hat{\mathcal{O}}_c^\times \xrightarrow{\mathrm{rec}} \Gal(K[c] / K),
\end{equation*}
\begin{equation*}
  [\mathfrak{b}] \mapsto \sigma_{\mathfrak{b}}.
\end{equation*}
More generally, for any fractional ideal $\mathfrak{a}$ of $\mathcal{O}_c$, we get a point
\begin{equation*}
  x_{c}(\mathfrak{a}) := \left[ \mathbb{C} / \mathfrak{a} \rightarrow \mathbb{C} / \mathfrak{n}^{-1} \mathfrak{a} \right] \in X_0(N)(K[c]).
\end{equation*}
The action of $\Gal(K[c] / K)$ on $X_0(N)(K[c])$ on these points is described by the relation
\begin{equation}\label{eq:cq6sjz7g2n}
  \sigma_{\mathfrak{b}} x_c(\mathfrak{a}) = x_c(\mathfrak{b}^{-1} \mathfrak{a}).
\end{equation}
This is the content of CM theory.

Now we're going to look at the divisors
\begin{equation*}
  y_c(\mathfrak{a}) := x_c(\mathfrak{a}) - \infty
\end{equation*}
obtained by subtracting off the cusp at infinity, which is defined over $\mathbb{Q}$.  This difference defines an element of the Jacobian $J_0(N) := \Jac(X_0(N))$, defined over $K[c]$.  The Jacobian is an abelian variety.  For abelian varieties, there is a construction very similar to Kummer theory that gives us an analogue of the Kummer map defined yesterday,
\begin{equation*}
  J_0(N)(K[c]) \rightarrow H^1(K[c], J_0(N)[p^m]),
\end{equation*}
where $J_0(N)[p^m]$ is the $p^m$-torsion subgroup of the Jacobian.  The map is defined as follows.  Given $y \in J_0(N)(K[c])$, let us choose $y '$ so that $p^m y' = y$.  We send this to the class of the cocycle $\sigma \mapsto \sigma(y') - y'$.  Applying this map to  $y_c(\mathfrak{a})$ gives us a cohomology class
\begin{equation*}
  z_c(\mathfrak{a}) \in H^1(K[c], J_0(N)[p^m]).
\end{equation*}
In the special case where $\mathfrak{a} = \mathcal{O}_c$, we drop it from the notation and write simply $z_c$.

Suppose now that $\ell \nmid c D_K N$.  Then we're going to look at what happens when we take the point $z_{c \ell}$ (attached as above to the order $\mathcal{O}_{c \ell}$) and form the norm
\begin{equation*}
  \sum_{\sigma \in \Gal(K[c \ell] / K[c])} \sigma z_{c \ell}.
\end{equation*}
We can write this as the sum
\begin{equation*}
  \sum_{\mathfrak{b} \in \ker(\Pic \mathcal{O}_{c \ell} \rightarrow \Pic \mathcal{O}_c)} \sigma_{\mathfrak{b}} z_{c \ell}.
\end{equation*}
We can in turn rewrite $\sigma_{\mathfrak{b}} z_{c \ell}$ as $\sum_{\mathfrak{b}} y_{c \ell}(\mathfrak{b}^{-1}) - \infty$, summing over the same $\mathfrak{b}$ as before.  Now, how many $\mathfrak{b}$'s are there, and what is this sum?

Suppose that $\ell$ is inert in $K$.  Comparing what happens with $c$ and $c \ell$, we get
\begin{equation*}
  \frac{(\mathcal{O}_K \otimes \mathbb{Z}_{\ell})^\times}{((\mathbb{Z} + \ell \mathcal{O}_K) \otimes \mathbb{Z}_{\ell})^\times},
\end{equation*}
which is cyclic of order $\ell + 1$.  Now, $\mathfrak{b}$ lying in the kernel of the above map means that $\mathfrak{b} \mathcal{O}_c$ is a principal ideal, say $\beta \mathcal{O}_c$ with $\beta \in K^\times$.  If we look at $\beta \mathfrak{b}^{-1} \mathcal{O}_c$, then we see that inside $\mathcal{O}_c$, it has index $\ell$.  As $\mathfrak{b}$ varies, this exhausts all lattices of index $\ell$.  By definition of the Hecke operator $T_{\ell}$, we see that
\begin{equation*}
  \sum_{\mathfrak{b}} \left( y_{c \ell}(\mathfrak{b}^{-1}) - \infty \right) = T_{\ell}(y_c - \infty).
\end{equation*}
Under the Kummer map, this tells us that
\begin{equation*}
  \operatorname{cor}_{K[c \ell] / K[c]} z_{c \ell}
  = T_{\ell} z_c.  
\end{equation*}

Kolyvagin used these relations as follows.
\begin{equation*}
  y_K = \trace_{K[1] / K} y_1 \in J_0(N)(K) \xrightarrow{\phi_E} E(K),
\end{equation*}
where $E$ is an elliptic curve of conductor $N$ with a modular parametrization $\phi_N : X_0(N) \rightarrow E$ sending $\infty$ to $0$.  Using relations, Kolyvagin could show that if the point is not torsion, then the rank of the elliptic curve is $1$.  Around the same time, Gross--Zagier showed that the Néron--Tate height of this point is nonzero if and only if $L$-function for $E/K$ vanishes exactly to order one.  This gave some of the first theoretical evidence for the Birch and Swinnerton-Dyer conjecture.  This was a spectacular application by Kolyvagin that got people interested in Euler systems.

You can also run Kolyvagin's argument in another way.  You can look at the primes $\ell$ that are \emph{split} in $K$, say $\ell = \lambda \bar{\lambda}$.  Then
\begin{equation*}
  \frac{(\mathcal{O}_K \otimes \mathbb{Z}_{\ell})^\times}{((\mathbb{Z} + \ell \mathcal{O}_K) \otimes \mathbb{Z}_{\ell})^\times}
  =
  \frac{\mathcal{O}_\lambda^\times \times \mathcal{O}_{\bar{\lambda}}^\times}{\{(a, b) : a \equiv b(\ell)\}},
\end{equation*}
where the numerator is really $\mathbb{Z}_{\ell}^\times \times \mathbb{Z}_{\ell}^\times$.  Arguing as above, we're no longer summing over all the lattices, but instead we miss two of them: $\lambda \mathcal{O}_c$ and $\bar{\lambda} \mathcal{O}_c$.  One obtains
\begin{equation*}
  \sum_{\mathfrak{b}} (y_{c \ell}(\mathfrak{b}^{-1}) - \infty )
  =
  T_{\ell}(y_c - \infty)
  - (\mathrm{Fr}_\lambda^{-1} + \mathrm{Fr}_{\bar{\lambda}}^{-1})(y_c - \infty).
\end{equation*}
(The inverses come from \eqref{eq:cq6sjz7g2n}.)

Work of the speaker and Jetchev and Wan used the split primes to do something like what Kolyvagin did.

Let $\mathfrak{c} = \lambda_1 \dotsb \lambda_r$ be a squarefree product of ideals $\lambda_i \nmid N D_K$ of degree $1$ in $K$, with $\lambda_i =\overline{\lambda_i}$.  Let $c$ be the integer such that $(c) = \mathfrak{c} \cap \mathbb{Z}$.  Let $z(\mathfrak{c})$ be basically the class that we were just analyzing, but let's modify it slightly:
\begin{equation}\label{eq:cq6sj3hg5b}
  z(\mathfrak{c}) := \prod_{i = 1}^r \left( - \mathrm{Fr}_{\lambda_i} \right) z_c \in H^1(K[c], T_p J_0(N)),
\end{equation}
where $T_p J_0(N) = \varprojlim J_0(N)[p^m]$.  We obtain now, for $\lambda \mid \ell$,

\begin{equation}\label{eq:cq6sj0iiz3}
  \operatorname{cores}_{K[c \ell] / K[c]} z(\mathfrak{c} \lambda) = \left( \mathrm{Fr}_\lambda^{- 2} - T_{\ell} \mathrm{Fr}_\lambda^{-1} + 1 \right) z(\mathfrak{c}).
\end{equation}
Let's think about this last expression in terms of the Hecke polynomial $X^2 - T_{\ell} X + \ell$.  You can see that if we evaluate this at $\lambda^{-1}$, we almost get the quantity appearing on the right hand side of \eqref{eq:cq6sj0iiz3}:
\begin{equation*}
  (X^2 - T_{\ell} X + \ell) \mid_{X = \mathrm{Fr}_\lambda^{-1}}.
\end{equation*}
They are congruent modulo $\ell - 1$, which is $N(\lambda) - 1$.  When working with Euler systems, it's acceptable to work with congruences modulo $\ell - 1$.  There's a general way to massage those classes so that they give the relations on the nose, but there's no need to do so.  Later, we'll pose a question that will suggest that this comparison is a feature of some integral representation theory, once we see where these norm relations come from in those terms.  In any event, once you have these relations, you can take these objects and run Kolyvagin's argument and reprove Kolyvagin's theorem.

We next want to explain how to set up the construction of the Kolyvagin system in such a way that some representation theory naturally shows up, with this Galois relation \eqref{eq:cq6sj0iiz3} showing up as something like a Hecke module, which in turn is closely related to representation theory.  The argument we're going to give generalizes quite significantly, for instance, it produces an Euler system in the sense of these split primes for the diagonal cycles coming from the arithmetic Gan--Gross--Prasad settings, and one can generalize Kolyvagin's statement to a rank one statement about Selmer groups for certain Rankin--Selberg convolutions of $\mathrm{GL}_n \times\mathrm{GL}_{n + 1}$.  With Euler systems, we're trying to bound the orders of Selmer groups of elliptic curves, something like $H^1_f(\mathbb{Q}, E[p^N])$, where the subscript $f$ denotes some sort of Block--Kato condition coming from the geometry of the elliptic curve.  One way to bound a Selmer group like this is to use global duality to give classes in the arithmetic dual, i.e., $H_f^1(\mathbb{Q}, E[p^N]^\ast )$, where
\begin{equation}\label{eq:cq6sj3fh1h}
  E[p^N]^\ast = \Hom(E[p^N], \mathbb{Q}_p / \mathbb{Z}_p(1)).
\end{equation}
Here one wants to allow ramification at good primes $\ell$, chosen to capture the orders of classes that we want to control.  One can then reduce to looking at
\begin{equation}\label{eq:cq6sj3eqsx}
  H^1_{\mathrm{ur}}(\mathbb{Q}_{\ell}, E[p^N]).
\end{equation}
The local duality relates this to $H^1(I_{\ell}, E[p^N]^\ast)^{G_{\mathbb{Q}_{\ell}}}$.  So if we can produce a class in the latter that is highly ramified (of large order), then we can force the class in \eqref{eq:cq6sj3eqsx} to have small order.  That, in a nutshell, is how Selmer groups are bounded.  The whole trick is to produce ramified classes in \eqref{eq:cq6sj3fh1h} that you can measure the size of in some way.  Now, producing things that are provably ramified is a hard problem.  There are few cases where we can do this.  It's much easier to check that something is unramified (think of the criterion of Néron--Ogg--Shafarevich or something like that).  What Kolyvagin's argument does is, he says well, let's start off with classes \eqref{eq:cq6sj3hg5b} that are over ramified extensions.  If they are truly over that ramified extension and not, say, defined over some extension with less ramification, then Kolyvagin can use that to produce ramified classes, and it is exactly these relations \eqref{eq:cq6sj0iiz3} that allow him to understand how ramified these classes actually are.  These norm relations are thus crucial for producing ramified classes with controlled or measurable ramification.  That's sort of the algebra background for why one is interested in Euler systems.

We'll now describe a more representation-theoretic picture that produces these Kolyvagin classes.  Recall the situation.  We have the modular curve $X_0(N)$ and the Heegner point $x_c \in X_0(N)(K[c])$, corresponding to an isogeny $[\mathbb{C} / \mathcal{O}_c \rightarrow \mathbb{C} / \mathfrak{n} \mathcal{O}_c]$.  The modular curve is a curve defined over $\mathbb{Q}$, so we can think of this point as defining a map
\begin{equation*}
  \Spec K[c] \rightarrow X_0(N).
\end{equation*}
We can base our curve to a curve over $K[c]$, yielding the following map of varieties over $K [c]$:
\begin{equation*}
  \Spec K[c] \xrightarrow{x_c} X_0(N) \times \Spec K[c].
\end{equation*}
The left hand side has dimension $0$, while the right hand side has dimension $1$.  There is thus a cycle class map
\begin{equation*}
  H^0(\Spec K[c])
  \xrightarrow{\mathrm{cyc}}
  H^{2}(X_0(N) / \Spec K[c], \mathbb{Z}_p(1)).
\end{equation*}
(In general, the exponent is $2 d$, where $d$ is the codimension.)

This is a single point.  What we did before was to take the difference between two points,
\begin{equation}\label{eq:cq6s0hup34}
  \operatorname{cyc}(x_c) - \operatorname{cyc}(\infty) \in
  H^2(X_0(N) \times \Spec K[c], \mathbb{Z}_p(1))_0,
\end{equation}
but it's now homologically trivial in the sense that if we pass to the algebraic closure, i.e., we consider the degree map
\begin{equation*}
  H^2(X_0(N) \times \Spec K[c], \mathbb{Z}_p(1))_0
  \xrightarrow{\deg}
  H^2(X_0(N) \times \Spec \bar{K}[c], \mathbb{Z}_p(1))_0
  \cong \mathbb{Z}_p
\end{equation*}
which the difference \eqref{eq:cq6s0hup34} lies in the kernel of, then we obtain the element
\begin{equation*}
  y_c \in
  H^1(K[c], H^1(X_0(N) / \bar{K}, \mathbb{Z}_p(1)))
  =H^1(K[c], T_p J_0(N)).
\end{equation*}

Now, we don't want to keep tracking the field of definition, so let's think of $x_c$ as a map over $K$.  Starting with
\begin{equation*}
  \Spec K[c](\bar{K})
  = \left\{ \sigma : K[c] \hookrightarrow \bar{K} \right\} \simeq \Gal(K[c] / K)
  = K^\times \backslash \hat{K}^\times / \hat{\mathcal{O}}_c^\times,
\end{equation*}
we can think of
\begin{equation*}
  H^0(K^\times \backslash \hat{K}^\times / \hat{\mathcal{O}}_c^\times)
  \xrightarrow{\mathrm{cyc}}
  H^2(X_0(N) \times K^\times \backslash \hat{K}^\times / \hat{\mathcal{O}}_c^\times,
  \mathbb{Z}_p(1)).
\end{equation*}
There is an action of $\Gal(K[c] / K)$ on $X_0(N) \times K^\times \backslash \hat{K}^\times / \hat{\mathcal{O}}_c^\times$ that we may reinterpret as multiplication by $\hat{K}^\times$.

Now, let's take an embedding $K \hookrightarrow M_2(\mathbb{Q})$ such that $\mathcal{O}_K = K \cap M_2(\mathbb{Z})$.  This induces $K^\times \hookrightarrow \mathrm{GL}_2(\mathbb{Q})$.  We fix $\tau_0 \in \mathfrak{h}$ such that $\Stab_{\mathrm{GL}_2^+(\mathbb{Q})}(\tau) = K^\times$.  For a compact open subgroup $U$ of $\mathrm{GL}_2(\mathbb{A}_f)$, we set
\begin{equation*}
  X_U := \mathrm{GL}_2(\mathbb{Q}) \backslash[\mathfrak{h}^{\pm, \ast} \times \mathrm{GL}_2(\mathbb{A}_f) / U],
\end{equation*}
where $\ast$ means ``add the cusps'' so as to obtain a compactification.    The above contains the set of ``CM points''
\begin{equation*}
  \left\{[\tau_0, g] : g \in \mathrm{GL}_2(\mathbb{A}_f) \right\},
\end{equation*}
which comes with with an action of $\hat{K}^\times$ via the reciprocity map $\hat{K}^\times \xrightarrow{\mathrm{rec}} G_K^{\mathrm{ab}}$ defined by
\begin{equation*}
  \operatorname{rec}(\alpha)[\tau_0, g]
  =[\tau_0, \alpha g].
\end{equation*}
We might as well take
\begin{equation*}
  U = U_0(N) = \mathrm{GL}_2(\hat{\mathbb{Z}}) \cap
  \begin{pmatrix}
    \ast    & \ast \\
    N \ast            &  \ast \\
  \end{pmatrix}.
\end{equation*}

In that case, $x_c =[\tau_0, g_c]$ for a particular choice of $g_c$.

This is the classical picture of Heegner points.  We're going to change the picture just a little bit.  Think
\begin{equation*}
  K^\times \rightarrow G = \frac{\mathrm{GL}_2 \times K^\times}{\mathbb{Q}^\times}.
\end{equation*}
(The right hand side may be thought of as $\mathrm{GU}(1, 1)$, if you'd like.)  We get
\begin{equation*}
  X_{U_0(N)} \rightarrow
  \mathrm{S h}_G(U) := G(\mathbb{Q}) \backslash G(\mathbb{A}) / K_\infty U, \quad U := U_0(N) \times V.
\end{equation*}
There is a map
\begin{equation*}
  \mathrm{S h}_G(U) \rightarrow \hat{\mathbb{Q}}^\times K^\times \backslash \hat{K}^\times / V.
\end{equation*}









\bibliography{refs}{} \bibliographystyle{plain}
\end{document}
